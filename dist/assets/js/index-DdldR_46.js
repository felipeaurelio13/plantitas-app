const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Settings-auvpcn4G.js","assets/js/query-D9cK7eLy.js","assets/js/vendor-ohv-86MT.js","assets/js/router-Lz5I7iQY.js","assets/js/ui-BW4tJjqg.js","assets/js/supabase-ChG5PfJU.js","assets/js/Auth-BeOrtEuB.js"])))=>i.map(i=>d[i]);
var hk=Object.defineProperty;var fk=(t,e,r)=>e in t?hk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Nr=(t,e,r)=>fk(t,typeof e!="symbol"?e+"":e,r);import{j as d,u as ad,a as Ei,b as __,Q as E_,c as T_}from"./query-D9cK7eLy.js";import{a as Jm,b as H,r as w,d as mk,e as Fi}from"./vendor-ohv-86MT.js";import{c as pk,_ as ep}from"./supabase-ChG5PfJU.js";import{u as ar,a as A_,L as gk,O as yk,b as tp,B as vk,R as Iv,c as sn,N as Vh}from"./router-Lz5I7iQY.js";import{A as ke,m as L,X as Ui,I as S_,T as _n,C as Jr,a as Ai,L as ya,P as rp,b as Kn,c as np,H as Qc,B as Ho,S as bk,W as xk,d as I_,R as Ni,e as er,f as va,D as gl,g as P_,E as wk,h as If,M as yl,i as C_,j as _k,k as Ek,l as Tk,n as Ak,U as k_,o as N_,p as Sk,q as Ik,r as j_,s as O_,t as Pk,u as sd,v as R_,w as Jc,x as D_,y as Ck,z as Pv,F as ip,G as M_,J as L_,K as Cv,N as kk,O as $_,Q as ap,V as V_,Y as Nk,Z as jk,_ as Ok,$ as Rk,a0 as Dk,a1 as kv,a2 as Mk,a3 as Lk,a4 as z_,a5 as F_,a6 as U_,a7 as $k,a8 as Vk}from"./ui-BW4tJjqg.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Pf={},Nv=Jm;Pf.createRoot=Nv.createRoot,Pf.hydrateRoot=Nv.hydrateRoot;const jv=t=>{let e;const r=new Set,n=(c,u)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const m=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,i,o);return o},zk=t=>t?jv(t):jv,Fk=t=>t;function Uk(t,e=Fk){const r=H.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return H.useDebugValue(r),r}const Ov=t=>{const e=zk(t),r=n=>Uk(e,n);return Object.assign(r,e),r},sp=t=>t?Ov(t):Ov;var B_=Symbol.for("immer-nothing"),Rv=Symbol.for("immer-draftable"),Ar=Symbol.for("immer-state");function Gr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Es=Object.getPrototypeOf;function Aa(t){return!!t&&!!t[Ar]}function Gn(t){return t?H_(t)||Array.isArray(t)||!!t[Rv]||!!t.constructor?.[Rv]||ld(t)||cd(t):!1}var Bk=Object.prototype.constructor.toString();function H_(t){if(!t||typeof t!="object")return!1;const e=Es(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Bk}function eu(t,e){od(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function od(t){const e=t[Ar];return e?e.type_:Array.isArray(t)?1:ld(t)?2:cd(t)?3:0}function Cf(t,e){return od(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function W_(t,e,r){const n=od(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function Hk(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ld(t){return t instanceof Map}function cd(t){return t instanceof Set}function aa(t){return t.copy_||t.base_}function kf(t,e){if(ld(t))return new Map(t);if(cd(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=H_(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ar];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Es(t),n)}else{const n=Es(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function op(t,e=!1){return ud(t)||Aa(t)||!Gn(t)||(od(t)>1&&(t.set=t.add=t.clear=t.delete=Wk),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>op(n,!0))),t}function Wk(){Gr(2)}function ud(t){return Object.isFrozen(t)}var qk={};function Sa(t){const e=qk[t];return e||Gr(0,t),e}var Wo;function q_(){return Wo}function Kk(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Dv(t,e){e&&(Sa("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Nf(t){jf(t),t.drafts_.forEach(Gk),t.drafts_=null}function jf(t){t===Wo&&(Wo=t.parent_)}function Mv(t){return Wo=Kk(Wo,t)}function Gk(t){const e=t[Ar];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Lv(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ar].modified_&&(Nf(e),Gr(4)),Gn(t)&&(t=tu(e,t),e.parent_||ru(e,t)),e.patches_&&Sa("Patches").generateReplacementPatches_(r[Ar].base_,t,e.patches_,e.inversePatches_)):t=tu(e,r,[]),Nf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==B_?t:void 0}function tu(t,e,r){if(ud(e))return e;const n=e[Ar];if(!n)return eu(e,(i,a)=>$v(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return ru(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),eu(a,(o,l)=>$v(t,n,i,o,l,r,s)),ru(t,i,!1),r&&t.patches_&&Sa("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function $v(t,e,r,n,i,a,s){if(Aa(i)){const o=a&&e&&e.type_!==3&&!Cf(e.assigned_,n)?a.concat(n):void 0,l=tu(t,i,o);if(W_(r,n,l),Aa(l))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Gn(i)&&!ud(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;tu(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&ru(t,i)}}function ru(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&op(e,r)}function Yk(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:q_(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=lp;r&&(i=[n],a=qo);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var lp={get(t,e){if(e===Ar)return t;const r=aa(t);if(!Cf(r,e))return Zk(t,r,e);const n=r[e];return t.finalized_||!Gn(n)?n:n===zh(t.base_,e)?(Fh(t),t.copy_[e]=Rf(n,t)):n},has(t,e){return e in aa(t)},ownKeys(t){return Reflect.ownKeys(aa(t))},set(t,e,r){const n=K_(aa(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=zh(aa(t),e),a=i?.[Ar];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Hk(r,i)&&(r!==void 0||Cf(t.base_,e)))return!0;Fh(t),Of(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return zh(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Fh(t),Of(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=aa(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gr(11)},getPrototypeOf(t){return Es(t.base_)},setPrototypeOf(){Gr(12)}},qo={};eu(lp,(t,e)=>{qo[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});qo.deleteProperty=function(t,e){return qo.set.call(this,t,e,void 0)};qo.set=function(t,e,r){return lp.set.call(this,t[0],e,r,t[0])};function zh(t,e){const r=t[Ar];return(r?aa(r):t)[e]}function Zk(t,e,r){const n=K_(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function K_(t,e){if(!(e in t))return;let r=Es(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Es(r)}}function Of(t){t.modified_||(t.modified_=!0,t.parent_&&Of(t.parent_))}function Fh(t){t.copy_||(t.copy_=kf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Xk=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(l=a,...c){return s.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Gr(6),n!==void 0&&typeof n!="function"&&Gr(7);let i;if(Gn(e)){const a=Mv(this),s=Rf(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Nf(a):jf(a)}return Dv(a,n),Lv(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===B_&&(i=void 0),this.autoFreeze_&&op(i,!0),n){const a=[],s=[];Sa("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Gr(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,l=>e(l,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Gn(t)||Gr(8),Aa(t)&&(t=Un(t));const e=Mv(this),r=Rf(t,void 0);return r[Ar].isManual_=!0,jf(e),r}finishDraft(t,e){const r=t&&t[Ar];(!r||!r.isManual_)&&Gr(9);const{scope_:n}=r;return Dv(n,e),Lv(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Sa("Patches").applyPatches_;return Aa(t)?n(t,e):this.produce(t,i=>n(i,e))}};function Rf(t,e){const r=ld(t)?Sa("MapSet").proxyMap_(t,e):cd(t)?Sa("MapSet").proxySet_(t,e):Yk(t,e);return(e?e.scope_:q_()).drafts_.push(r),r}function Un(t){return Aa(t)||Gr(10,t),G_(t)}function G_(t){if(!Gn(t)||ud(t))return t;const e=t[Ar];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=kf(t,e.scope_.immer_.useStrictShallowCopy_)}else r=kf(t,!0);return eu(r,(n,i)=>{W_(r,n,G_(i))}),e&&(e.finalized_=!1),r}var Sr=new Xk,Se=Sr.produce;Sr.produceWithPatches.bind(Sr);Sr.setAutoFreeze.bind(Sr);Sr.setUseStrictShallowCopy.bind(Sr);Sr.applyPatches.bind(Sr);Sr.createDraft.bind(Sr);Sr.finishDraft.bind(Sr);const Qk=()=>{};var Vv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Jk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],l=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},Z_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,s||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Y_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Jk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||c==null||h==null)throw new eN;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const v=c<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class eN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tN=function(t){const e=Y_(t);return Z_.encodeByteArray(e,!0)},nu=function(t){return tN(t).replace(/\./g,"")},X_=function(t){try{return Z_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nN=()=>rN().__FIREBASE_DEFAULTS__,iN=()=>{if(typeof process>"u"||typeof Vv>"u")return;const t=Vv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},aN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&X_(t[1]);return e&&JSON.parse(e)},dd=()=>{try{return Qk()||nN()||iN()||aN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Q_=t=>dd()?.emulatorHosts?.[t],J_=t=>{const e=Q_(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},eE=()=>dd()?.config,tE=t=>dd()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[nu(JSON.stringify(r)),nu(JSON.stringify(s)),""].join(".")}const Oo={};function oN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Oo))Oo[e]?t.emulator.push(e):t.prod.push(e);return t}function lN(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let zv=!1;function up(t,e){if(typeof window>"u"||typeof document>"u"||!$a(window.location.host)||Oo[t]===e||Oo[t]||zv)return;Oo[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=oN().prod.length>0;function s(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{zv=!0,s()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=lN(n),p=r("text"),v=document.getElementById(p)||document.createElement("span"),b=r("learnmore"),g=document.getElementById(b)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;o(E),u(g,b);const j=c();l(T,_),E.append(T,v,g,j),document.body.appendChild(E)}a?(v.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function uN(){const t=dd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mN(){const t=tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function pN(){return!uN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gN(){try{return typeof indexedDB=="object"}catch{return!1}}function yN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vN="FirebaseError";class Pn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=vN,Object.setPrototypeOf(this,Pn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vl.prototype.create)}}class vl{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?bN(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Pn(i,o,n)}}function bN(t,e){return t.replace(xN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const xN=/\{\$([^}]+)}/g;function wN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ia(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(Fv(a)&&Fv(s)){if(!Ia(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Fv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bl(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function To(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Ao(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function _N(t,e){const r=new EN(t,e);return r.subscribe.bind(r)}class EN{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");TN(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Uh),i.error===void 0&&(i.error=Uh),i.complete===void 0&&(i.complete=Uh);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function TN(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Uh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class ji{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AN=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new sN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IN(e))try{this.getOrInitializeService({instanceIdentifier:sa})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=sa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sa){return this.instances.has(e)}getOptions(e=sa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:SN(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sa){return this.component?this.component.multipleInstances?e:sa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function SN(t){return t===sa?void 0:t}function IN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new AN(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const CN={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},kN=xe.INFO,NN={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},jN=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=NN[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dp{constructor(e){this.name=e,this._logLevel=kN,this._logHandler=jN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const ON=(t,e)=>e.some(r=>t instanceof r);let Uv,Bv;function RN(){return Uv||(Uv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DN(){return Bv||(Bv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nE=new WeakMap,Df=new WeakMap,iE=new WeakMap,Bh=new WeakMap,hp=new WeakMap;function MN(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Si(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&nE.set(r,t)}).catch(()=>{}),hp.set(e,t),e}function LN(t){if(Df.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});Df.set(t,e)}let Mf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Df.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Si(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $N(t){Mf=t(Mf)}function VN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Hh(this),e,...r);return iE.set(n,e.sort?e.sort():[e]),Si(n)}:DN().includes(t)?function(...e){return t.apply(Hh(this),e),Si(nE.get(this))}:function(...e){return Si(t.apply(Hh(this),e))}}function zN(t){return typeof t=="function"?VN(t):(t instanceof IDBTransaction&&LN(t),ON(t,RN())?new Proxy(t,Mf):t)}function Si(t){if(t instanceof IDBRequest)return MN(t);if(Bh.has(t))return Bh.get(t);const e=zN(t);return e!==t&&(Bh.set(t,e),hp.set(e,t)),e}const Hh=t=>hp.get(t);function FN(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Si(s);return n&&s.addEventListener("upgradeneeded",l=>{n(Si(s.result),l.oldVersion,l.newVersion,Si(s.transaction),l)}),r&&s.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const UN=["get","getKey","getAll","getAllKeys","count"],BN=["put","add","delete","clear"],Wh=new Map;function Hv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wh.get(e))return Wh.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=BN.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||UN.includes(r)))return;const a=async function(s,...o){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Wh.set(e,a),a}$N(t=>({...t,get:(e,r,n)=>Hv(e,r)||t.get(e,r,n),has:(e,r)=>!!Hv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(WN(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function WN(t){return t.getComponent()?.type==="VERSION"}const Lf="@firebase/app",Wv="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new dp("@firebase/app"),qN="@firebase/app-compat",KN="@firebase/analytics-compat",GN="@firebase/analytics",YN="@firebase/app-check-compat",ZN="@firebase/app-check",XN="@firebase/auth",QN="@firebase/auth-compat",JN="@firebase/database",ej="@firebase/data-connect",tj="@firebase/database-compat",rj="@firebase/functions",nj="@firebase/functions-compat",ij="@firebase/installations",aj="@firebase/installations-compat",sj="@firebase/messaging",oj="@firebase/messaging-compat",lj="@firebase/performance",cj="@firebase/performance-compat",uj="@firebase/remote-config",dj="@firebase/remote-config-compat",hj="@firebase/storage",fj="@firebase/storage-compat",mj="@firebase/firestore",pj="@firebase/ai",gj="@firebase/firestore-compat",yj="firebase",vj="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f="[DEFAULT]",bj={[Lf]:"fire-core",[qN]:"fire-core-compat",[GN]:"fire-analytics",[KN]:"fire-analytics-compat",[ZN]:"fire-app-check",[YN]:"fire-app-check-compat",[XN]:"fire-auth",[QN]:"fire-auth-compat",[JN]:"fire-rtdb",[ej]:"fire-data-connect",[tj]:"fire-rtdb-compat",[rj]:"fire-fn",[nj]:"fire-fn-compat",[ij]:"fire-iid",[aj]:"fire-iid-compat",[sj]:"fire-fcm",[oj]:"fire-fcm-compat",[lj]:"fire-perf",[cj]:"fire-perf-compat",[uj]:"fire-rc",[dj]:"fire-rc-compat",[hj]:"fire-gcs",[fj]:"fire-gcs-compat",[mj]:"fire-fst",[gj]:"fire-fst-compat",[pj]:"fire-vertex","fire-js":"fire-js",[yj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=new Map,xj=new Map,Vf=new Map;function qv(t,e){try{t.container.addComponent(e)}catch(r){Yn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Pa(t){const e=t.name;if(Vf.has(e))return Yn.debug(`There were multiple attempts to register component ${e}.`),!1;Vf.set(e,t);for(const r of iu.values())qv(r,t);for(const r of xj.values())qv(r,t);return!0}function hd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function wr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ii=new vl("app","Firebase",wj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ji("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ii.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=vj;function aE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:$f,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ii.create("bad-app-name",{appName:String(i)});if(r||(r=eE()),!r)throw Ii.create("no-options");const a=iu.get(i);if(a){if(Ia(r,a.options)&&Ia(n,a.config))return a;throw Ii.create("duplicate-app",{appName:i})}const s=new PN(i);for(const l of Vf.values())s.addComponent(l);const o=new _j(r,n,s);return iu.set(i,o),o}function fp(t=$f){const e=iu.get(t);if(!e&&t===$f&&eE())return aE();if(!e)throw Ii.create("no-app",{appName:t});return e}function fn(t,e,r){let n=bj[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yn.warn(s.join(" "));return}Pa(new ji(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej="firebase-heartbeat-database",Tj=1,Ko="firebase-heartbeat-store";let qh=null;function sE(){return qh||(qh=FN(Ej,Tj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ko)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ii.create("idb-open",{originalErrorMessage:t.message})})),qh}async function Aj(t){try{const r=(await sE()).transaction(Ko),n=await r.objectStore(Ko).get(oE(t));return await r.done,n}catch(e){if(e instanceof Pn)Yn.warn(e.message);else{const r=Ii.create("idb-get",{originalErrorMessage:e?.message});Yn.warn(r.message)}}}async function Kv(t,e){try{const n=(await sE()).transaction(Ko,"readwrite");await n.objectStore(Ko).put(e,oE(t)),await n.done}catch(r){if(r instanceof Pn)Yn.warn(r.message);else{const n=Ii.create("idb-set",{originalErrorMessage:r?.message});Yn.warn(n.message)}}}function oE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj=1024,Ij=30;class Pj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new kj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Gv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Ij){const i=Nj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Gv(),{heartbeatsToSend:r,unsentEntries:n}=Cj(this._heartbeatsCache.heartbeats),i=nu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Yn.warn(e),""}}}function Gv(){return new Date().toISOString().substring(0,10)}function Cj(t,e=Sj){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),Yv(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Yv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class kj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gN()?yN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Aj(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Kv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Yv(t){return nu(JSON.stringify({version:2,heartbeats:t})).length}function Nj(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jj(t){Pa(new ji("platform-logger",e=>new HN(e),"PRIVATE")),Pa(new ji("heartbeat",e=>new Pj(e),"PRIVATE")),fn(Lf,Wv,t),fn(Lf,Wv,"esm2020"),fn("fire-js","")}jj("");var Oj="firebase",Rj="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(Oj,Rj,"app");function lE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Dj=lE,cE=new vl("auth","Firebase",lE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=new dp("@firebase/auth");function Mj(t,...e){au.logLevel<=xe.WARN&&au.warn(`Auth (${Va}): ${t}`,...e)}function $c(t,...e){au.logLevel<=xe.ERROR&&au.error(`Auth (${Va}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,...e){throw mp(t,...e)}function mn(t,...e){return mp(t,...e)}function uE(t,e,r){const n={...Dj(),[e]:r};return new vl("auth","Firebase",n).create(e,{appName:t.name})}function Bn(t){return uE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mp(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return cE.create(t,...e)}function ce(t,e,...r){if(!t)throw mp(e,...r)}function $n(t){const e="INTERNAL ASSERTION FAILED: "+t;throw $c(e),new Error(e)}function Zn(t,e){t||$n(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(){return typeof self<"u"&&self.location?.href||""}function Lj(){return Zv()==="http:"||Zv()==="https:"}function Zv(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $j(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Lj()||hN()||"connection"in navigator)?navigator.onLine:!0}function Vj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,r){this.shortDelay=e,this.longDelay=r,Zn(r>e,"Short delay should be less than long delay!"),this.isMobile=cN()||fN()}get(){return $j()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Uj=new xl(3e4,6e4);function Bi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Hi(t,e,r,n,i={}){return hE(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=bl({key:t.config.apiKey,...s}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...a};return dN()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&$a(t.emulatorConfig.host)&&(c.credentials="include"),dE.fetch()(await fE(t,t.config.apiHost,r,o),c)})}async function hE(t,e,r){t._canInitEmulator=!1;const n={...zj,...e};try{const i=new Hj(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw uc(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw uc(t,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw uc(t,"email-already-in-use",s);if(l==="USER_DISABLED")throw uc(t,"user-disabled",s);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw uE(t,u,c);en(t,u)}}catch(i){if(i instanceof Pn)throw i;en(t,"network-request-failed",{message:String(i)})}}async function wl(t,e,r,n,i={}){const a=await Hi(t,e,r,n,i);return"mfaPendingCredential"in a&&en(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function fE(t,e,r,n){const i=`${e}${r}?${n}`,a=t,s=a.config.emulator?pp(t.config,i):`${t.config.apiScheme}://${i}`;return Fj.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function Bj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Hj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(mn(this.auth,"network-request-failed")),Uj.get())})}}function uc(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=mn(t,e,n);return i.customData._tokenResponse=r,i}function Xv(t){return t!==void 0&&t.enterprise!==void 0}class Wj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Bj(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function qj(t,e){return Hi(t,"GET","/v2/recaptchaConfig",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kj(t,e){return Hi(t,"POST","/v1/accounts:delete",e)}async function su(t,e){return Hi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Gj(t,e=!1){const r=dr(t),n=await r.getIdToken(e),i=gp(n);ce(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:n,authTime:Ro(Kh(i.auth_time)),issuedAtTime:Ro(Kh(i.iat)),expirationTime:Ro(Kh(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Kh(t){return Number(t)*1e3}function gp(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return $c("JWT malformed, contained fewer than 3 sections"),null;try{const i=X_(r);return i?JSON.parse(i):($c("Failed to decode base64 JWT payload"),null)}catch(i){return $c("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qv(t){const e=gp(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Pn&&Yj(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Yj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ro(this.lastLoginAt),this.creationTime=Ro(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ou(t){const e=t.auth,r=await t.getIdToken(),n=await Go(t,su(e,{idToken:r}));ce(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?mE(i.providerUserInfo):[],s=Qj(t.providerData,a),o=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!s?.length,c=o?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ff(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function Xj(t){const e=dr(t);await ou(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Qj(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function mE(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jj(t,e){const r=await hE(t,{},async()=>{const n=bl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=await fE(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&$a(t.emulatorConfig.host)&&(l.credentials="include"),dE.fetch()(s,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function eO(t,e){return Hi(t,"POST","/v2/accounts:revokeToken",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const r=Qv(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await Jj(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new ps;return n&&(ce(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(ce(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(ce(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ps,this.toJSON())}_performRefresh(){return $n("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Zj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ff(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Go(this,this.stsTokenManager.getToken(this.auth,e));return ce(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Gj(this,e)}reload(){return Xj(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ou(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wr(this.auth.app))return Promise.reject(Bn(this.auth));const e=await this.getIdToken();return await Go(this,Kj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,s=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:b}=r;ce(h&&b,e,"internal-error");const g=ps.fromJSON(this.name,b);ce(typeof h=="string",e,"internal-error"),di(n,e.name),di(i,e.name),ce(typeof m=="boolean",e,"internal-error"),ce(typeof p=="boolean",e,"internal-error"),di(a,e.name),di(s,e.name),di(o,e.name),di(l,e.name),di(c,e.name),di(u,e.name);const _=new Zr({uid:h,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:a,tenantId:o,stsTokenManager:g,createdAt:c,lastLoginAt:u});return v&&Array.isArray(v)&&(_.providerData=v.map(T=>({...T}))),l&&(_._redirectEventId=l),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new ps;i.updateFromServerResponse(r);const a=new Zr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ou(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ce(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?mE(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,o=new ps;o.updateFromIdToken(n);const l=new Zr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Ff(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv=new Map;function Vn(t){Zn(t instanceof Function,"Expected a class definition");let e=Jv.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}pE.type="NONE";const e0=pE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vc(t,e,r){return`firebase:${t}:${e}:${r}`}class gs{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Vc(this.userKey,i.apiKey,a),this.fullPersistenceKey=Vc("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await su(this.auth,{idToken:e}).catch(()=>{});return r?Zr._fromGetAccountInfoResponse(this.auth,r,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new gs(Vn(e0),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=i[0]||Vn(e0);const s=Vc(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(s);if(u){let h;if(typeof u=="string"){const m=await su(e,{idToken:u}).catch(()=>{});if(!m)break;h=await Zr._fromGetAccountInfoResponse(e,m,u)}else h=Zr._fromJSON(e,u);c!==a&&(o=h),a=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new gs(a,e,n):(a=l[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(s)}catch{}})),new gs(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(wE(e))return"Blackberry";if(_E(e))return"Webos";if(yE(e))return"Safari";if((e.includes("chrome/")||vE(e))&&!e.includes("edge/"))return"Chrome";if(xE(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function gE(t=tr()){return/firefox\//i.test(t)}function yE(t=tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vE(t=tr()){return/crios\//i.test(t)}function bE(t=tr()){return/iemobile/i.test(t)}function xE(t=tr()){return/android/i.test(t)}function wE(t=tr()){return/blackberry/i.test(t)}function _E(t=tr()){return/webos/i.test(t)}function yp(t=tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tO(t=tr()){return yp(t)&&!!window.navigator?.standalone}function rO(){return mN()&&document.documentMode===10}function EE(t=tr()){return yp(t)||xE(t)||_E(t)||wE(t)||/windows phone/i.test(t)||bE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t,e=[]){let r;switch(t){case"Browser":r=t0(tr());break;case"Worker":r=`${t0(tr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Va}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const l=e(a);s(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iO(t,e={}){return Hi(t,"GET","/v2/passwordPolicy",Bi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO=6;class sO{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??aO,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new r0(this),this.idTokenSubscription=new r0(this),this.beforeStateQueue=new nO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Vn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await gs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await su(this,{idToken:e}),n=await Zr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(wr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===s)&&o?.user&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ou(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Vj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wr(this.app))return Promise.reject(Bn(this));const r=e?dr(e):null;return r&&ce(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wr(this.app)?Promise.reject(Bn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wr(this.app)?Promise.reject(Bn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iO(this),r=new sO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vl("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await eO(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Vn(e)||this._popupRedirectResolver;ce(r,this,"argument-error"),this.redirectPersistenceManager=await gs.create(this,[Vn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{s=!0,l()}}else{const l=e.addObserver(r);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Mj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function za(t){return dr(t)}class r0{constructor(e){this.auth=e,this.observer=null,this.addObserver=_N(r=>this.observer=r)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lO(t){fd=t}function AE(t){return fd.loadJS(t)}function cO(){return fd.recaptchaEnterpriseScript}function uO(){return fd.gapiScript}function dO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class hO{constructor(){this.enterprise=new fO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class fO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const mO="recaptcha-enterprise",SE="NO_RECAPTCHA";class pO{constructor(e){this.type=mO,this.auth=za(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{qj(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new Wj(l);return a.tenantId==null?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,s(c.siteKey)}}).catch(l=>{o(l)})})}function i(a,s,o){const l=window.grecaptcha;Xv(l)?l.enterprise.ready(()=>{l.enterprise.execute(a,{action:e}).then(c=>{s(c)}).catch(()=>{s(SE)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hO().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&Xv(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let l=cO();l.length!==0&&(l+=o),AE(l).then(()=>{i(o,a,s)}).catch(c=>{s(c)})}}).catch(o=>{s(o)})})}}async function n0(t,e,r,n=!1,i=!1){const a=new pO(t);let s;if(i)s=SE;else try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Uf(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await n0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await n0(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gO(t,e){const r=hd(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Ia(a,e??{}))return i;en(i,"already-initialized")}return r.initialize({options:e})}function yO(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Vn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function vO(t,e,r){const n=za(t);ce(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=IE(e),{host:s,port:o}=bO(e),l=o===null?"":`:${o}`,c={url:`${a}//${s}${l}/`},u=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ce(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ce(Ia(c,n.config.emulator)&&Ia(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,$a(s)?(cp(`${a}//${s}${l}`),up("Auth",!0)):xO()}function IE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bO(t){const e=IE(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:i0(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:i0(s)}}}function i0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return $n("not implemented")}_getIdTokenResponse(e){return $n("not implemented")}_linkToIdToken(e,r){return $n("not implemented")}_getReauthenticationResolver(e){return $n("not implemented")}}async function wO(t,e){return Hi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e){return wl(t,"POST","/v1/accounts:signInWithPassword",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EO(t,e){return wl(t,"POST","/v1/accounts:signInWithEmailLink",Bi(t,e))}async function TO(t,e){return wl(t,"POST","/v1/accounts:signInWithEmailLink",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends vp{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Yo(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Yo(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uf(e,r,"signInWithPassword",_O);case"emailLink":return EO(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Uf(e,n,"signUpPassword",wO);case"emailLink":return TO(e,{idToken:r,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ys(t,e){return wl(t,"POST","/v1/accounts:signInWithIdp",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AO="http://localhost";class Ca extends vp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Ca(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):en("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const s=new Ca(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return ys(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ys(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ys(e,r)}buildRequest(){const e={requestUri:AO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=bl(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function IO(t){const e=To(Ao(t)).link,r=e?To(Ao(e)).deep_link_id:null,n=To(Ao(t)).deep_link_id;return(n?To(Ao(n)).link:null)||n||r||e||t}class bp{constructor(e){const r=To(Ao(e)),n=r.apiKey??null,i=r.oobCode??null,a=SO(r.mode??null);ce(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=IO(e);try{return new bp(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(){this.providerId=Ls.PROVIDER_ID}static credential(e,r){return Yo._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=bp.parseLink(r);return ce(n,"argument-error"),Yo._fromEmailAndCode(e,n.code,n.tenantId)}}Ls.PROVIDER_ID="password";Ls.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ls.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l extends PE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends _l{constructor(){super("facebook.com")}static credential(e){return Ca._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends _l{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Ca._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bi.credential(r,n)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends _l{constructor(){super("github.com")}static credential(e){return Ca._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com";xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends _l{constructor(){super("twitter.com")}static credential(e,r){return Ca._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return wi.credential(r,n)}catch{return null}}}wi.TWITTER_SIGN_IN_METHOD="twitter.com";wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PO(t,e){return wl(t,"POST","/v1/accounts:signUp",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Zr._fromIdTokenResponse(e,n,i),s=a0(n);return new ka({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=a0(n);return new ka({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function a0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends Pn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,lu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new lu(e,r,n,i)}}function CE(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?lu._fromErrorAndOperation(t,a,e,n):a})}async function CO(t,e,r=!1){const n=await Go(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ka._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e,r=!1){const{auth:n}=t;if(wr(n.app))return Promise.reject(Bn(n));const i="reauthenticate";try{const a=await Go(t,CE(n,i,e,t),r);ce(a.idToken,n,"internal-error");const s=gp(a.idToken);ce(s,n,"internal-error");const{sub:o}=s;return ce(t.uid===o,n,"user-mismatch"),ka._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&en(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(t,e,r=!1){if(wr(t.app))return Promise.reject(Bn(t));const n="signIn",i=await CE(t,n,e),a=await ka._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function NO(t,e){return kE(za(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NE(t){const e=za(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function jO(t,e,r){if(wr(t.app))return Promise.reject(Bn(t));const n=za(t),s=await Uf(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",PO).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&NE(t),l}),o=await ka._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function OO(t,e,r){return wr(t.app)?Promise.reject(Bn(t)):NO(dr(t),Ls.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&NE(t),n})}function RO(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function DO(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function MO(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function LO(t){return dr(t).signOut()}const cu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(cu,"1"),this.storage.removeItem(cu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=1e3,VO=10;class OE extends jE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=EE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,l)=>{this.notifyListeners(s,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);rO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,VO):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},$O)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}OE.type="LOCAL";const zO=OE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE extends jE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}RE.type="SESSION";const DE=RE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new md(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async c=>c(r.origin,a)),l=await FO(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}md.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,l)=>{const c=xp("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function BO(t){pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function HO(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WO(){return navigator?.serviceWorker?.controller||null}function qO(){return ME()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="firebaseLocalStorageDb",KO=1,uu="firebaseLocalStorage",$E="fbase_key";class El{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function pd(t,e){return t.transaction([uu],e?"readwrite":"readonly").objectStore(uu)}function GO(){const t=indexedDB.deleteDatabase(LE);return new El(t).toPromise()}function Bf(){const t=indexedDB.open(LE,KO);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(uu,{keyPath:$E})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(uu)?e(n):(n.close(),await GO(),e(await Bf()))})})}async function s0(t,e,r){const n=pd(t,!0).put({[$E]:e,value:r});return new El(n).toPromise()}async function YO(t,e){const r=pd(t,!1).get(e),n=await new El(r).toPromise();return n===void 0?null:n.value}function o0(t,e){const r=pd(t,!0).delete(e);return new El(r).toPromise()}const ZO=800,XO=3;class VE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>XO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ME()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=md._getInstance(qO()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await HO(),!this.activeServiceWorker)return;this.sender=new UO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bf();return await s0(e,cu,"1"),await o0(e,cu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>s0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>YO(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>o0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=pd(i,!1).getAll();return new El(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ZO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}VE.type="LOCAL";const QO=VE;new xl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(t,e){return e?Vn(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends vp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ys(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ys(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ys(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function eR(t){return kE(t.auth,new wp(t),t.bypassAuthState)}function tR(t){const{auth:e,user:r}=t;return ce(r,e,"internal-error"),kO(r,new wp(t),t.bypassAuthState)}async function rR(t){const{auth:e,user:r}=t;return ce(r,e,"internal-error"),CO(r,new wp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eR;case"linkViaPopup":case"linkViaRedirect":return rR;case"reauthViaPopup":case"reauthViaRedirect":return tR;default:en(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=new xl(2e3,1e4);class ds extends zE{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ds.currentPopupAction&&ds.currentPopupAction.cancel(),ds.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=xp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ds.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nR.get())};e()}}ds.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR="pendingRedirect",zc=new Map;class aR extends zE{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=zc.get(this.auth._key());if(!e){try{const n=await sR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}zc.set(this.auth._key(),e)}return this.bypassAuthState||zc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sR(t,e){const r=cR(e),n=lR(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function oR(t,e){zc.set(t._key(),e)}function lR(t){return Vn(t._redirectPersistence)}function cR(t){return Vc(iR,t.config.apiKey,t.name)}async function uR(t,e,r=!1){if(wr(t.app))return Promise.reject(Bn(t));const n=za(t),i=JO(n,e),s=await new aR(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR=10*60*1e3;class hR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fR(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!FE(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(mn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dR&&this.cachedEventUids.clear(),this.cachedEventUids.has(l0(e))}saveEventToCache(e){this.cachedEventUids.add(l0(e)),this.lastProcessedEventTime=Date.now()}}function l0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function FE({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function fR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mR(t,e={}){return Hi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gR=/^https?/;async function yR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mR(t);for(const r of e)try{if(vR(r))return}catch{}en(t,"unauthorized-domain")}function vR(t){const e=zf(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!gR.test(r))return!1;if(pR.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=new xl(3e4,6e4);function c0(){const t=pn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function xR(t){return new Promise((e,r)=>{function n(){c0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{c0(),r(mn(t,"network-request-failed"))},timeout:bR.get()})}if(pn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pn().gapi?.load)n();else{const i=dO("iframefcb");return pn()[i]=()=>{gapi.load?n():r(mn(t,"network-request-failed"))},AE(`${uO()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw Fc=null,e})}let Fc=null;function wR(t){return Fc=Fc||xR(t),Fc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R=new xl(5e3,15e3),ER="__/auth/iframe",TR="emulator/auth/iframe",AR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function IR(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?pp(e,TR):`https://${t.config.authDomain}/${ER}`,n={apiKey:e.apiKey,appName:t.name,v:Va},i=SR.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${bl(n).slice(1)}`}async function PR(t){const e=await wR(t),r=pn().gapi;return ce(r,t,"internal-error"),e.open({where:document.body,url:IR(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:AR,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=mn(t,"network-request-failed"),o=pn().setTimeout(()=>{a(s)},_R.get());function l(){pn().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kR=500,NR=600,jR="_blank",OR="http://localhost";class u0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function RR(t,e,r,n=kR,i=NR){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...CR,width:n.toString(),height:i.toString(),top:a,left:s},c=tr().toLowerCase();r&&(o=vE(c)?jR:r),gE(c)&&(e=e||OR,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(tO(c)&&o!=="_self")return DR(e||"",o),new u0(null);const h=window.open(e||"",o,u);ce(h,t,"popup-blocked");try{h.focus()}catch{}return new u0(h)}function DR(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR="__/auth/handler",LR="emulator/auth/handler",$R=encodeURIComponent("fac");async function d0(t,e,r,n,i,a){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Va,eventId:i};if(e instanceof PE){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",wN(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof _l){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${$R}=${encodeURIComponent(l)}`:"";return`${VR(t)}?${bl(o).slice(1)}${c}`}function VR({config:t}){return t.emulator?pp(t,LR):`https://${t.authDomain}/${MR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gh="webStorageSupport";class zR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=DE,this._completeRedirectFn=uR,this._overrideRedirectResult=oR}async _openPopup(e,r,n,i){Zn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await d0(e,r,n,zf(),i);return RR(e,a,xp())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await d0(e,r,n,zf(),i);return BO(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Zn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await PR(e),n=new hR(e);return r.register("authEvent",i=>(ce(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Gh,{type:Gh},i=>{const a=i?.[0]?.[Gh];a!==void 0&&r(!!a),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=yR(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return EE()||yE()||yp()}}const FR=zR;var h0="@firebase/auth",f0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HR(t){Pa(new ji("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;ce(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TE(t)},c=new oO(n,i,a,l);return yO(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Pa(new ji("auth-internal",e=>{const r=za(e.getProvider("auth").getImmediate());return(n=>new UR(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(h0,f0,BR(t)),fn(h0,f0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=5*60,qR=tE("authIdTokenMaxAge")||WR;let m0=null;const KR=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>qR)return;const i=r?.token;m0!==i&&(m0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function GR(t=fp()){const e=hd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=gO(t,{popupRedirectResolver:FR,persistence:[QO,zO,DE]}),n=tE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=KR(a.toString());DO(r,s,()=>s(r.currentUser)),RO(r,o=>s(o))}}const i=Q_("auth");return i&&vO(r,`http://${i}`),r}function YR(){return document.getElementsByTagName("head")?.[0]??document}lO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=mn("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",YR().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HR("Browser");var p0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pi,UE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,A){function P(){}P.prototype=A.prototype,S.D=A.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(O,N,C){for(var k=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)k[Q-2]=arguments[Q];return A.prototype[N].apply(O,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,A,P){P||(P=0);var O=Array(16);if(typeof A=="string")for(var N=0;16>N;++N)O[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;16>N;++N)O[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=S.g[0],P=S.g[1],N=S.g[2];var C=S.g[3],k=A+(C^P&(N^C))+O[0]+3614090360&4294967295;A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[1]+3905402710&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[2]+606105819&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[3]+3250441966&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[4]+4118548399&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[5]+1200080426&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[6]+2821735955&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[7]+4249261313&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[8]+1770035416&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[9]+2336552879&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[10]+4294925233&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[11]+2304563134&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[12]+1804603682&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[13]+4254626195&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[14]+2792965006&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[15]+1236535329&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(N^C&(P^N))+O[1]+4129170786&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[6]+3225465664&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[11]+643717713&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[0]+3921069994&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[5]+3593408605&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[10]+38016083&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[15]+3634488961&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[4]+3889429448&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[9]+568446438&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[14]+3275163606&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[3]+4107603335&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[8]+1163531501&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[13]+2850285829&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[2]+4243563512&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[7]+1735328473&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[12]+2368359562&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(P^N^C)+O[5]+4294588738&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[8]+2272392833&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[11]+1839030562&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[14]+4259657740&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[1]+2763975236&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[4]+1272893353&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[7]+4139469664&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[10]+3200236656&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[13]+681279174&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[0]+3936430074&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[3]+3572445317&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[6]+76029189&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[9]+3654602809&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[12]+3873151461&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[15]+530742520&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[2]+3299628645&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(N^(P|~C))+O[0]+4096336452&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[7]+1126891415&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[14]+2878612391&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[5]+4237533241&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[12]+1700485571&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[3]+2399980690&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[10]+4293915773&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[1]+2240044497&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[8]+1873313359&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[15]+4264355552&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[6]+2734768916&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[13]+1309151649&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[4]+4149444226&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[11]+3174756917&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[2]+718787259&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[9]+3951481745&4294967295,S.g[0]=S.g[0]+A&4294967295,S.g[1]=S.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+C&4294967295}n.prototype.u=function(S,A){A===void 0&&(A=S.length);for(var P=A-this.blockSize,O=this.B,N=this.h,C=0;C<A;){if(N==0)for(;C<=P;)i(this,S,C),C+=this.blockSize;if(typeof S=="string"){for(;C<A;)if(O[N++]=S.charCodeAt(C++),N==this.blockSize){i(this,O),N=0;break}}else for(;C<A;)if(O[N++]=S[C++],N==this.blockSize){i(this,O),N=0;break}}this.h=N,this.o+=A},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var A=1;A<S.length-8;++A)S[A]=0;var P=8*this.o;for(A=S.length-8;A<S.length;++A)S[A]=P&255,P/=256;for(this.u(S),S=Array(16),A=P=0;4>A;++A)for(var O=0;32>O;O+=8)S[P++]=this.g[A]>>>O&255;return S};function a(S,A){var P=o;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=A(S)}function s(S,A){this.h=A;for(var P=[],O=!0,N=S.length-1;0<=N;N--){var C=S[N]|0;O&&C==A||(P[N]=C,O=!1)}this.g=P}var o={};function l(S){return-128<=S&&128>S?a(S,function(A){return new s([A|0],0>A?-1:0)}):new s([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return g(c(-S));for(var A=[],P=1,O=0;S>=P;O++)A[O]=S/P|0,P*=4294967296;return new s(A,0)}function u(S,A){if(S.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S.charAt(0)=="-")return g(u(S.substring(1),A));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=c(Math.pow(A,8)),O=h,N=0;N<S.length;N+=8){var C=Math.min(8,S.length-N),k=parseInt(S.substring(N,N+C),A);8>C?(C=c(Math.pow(A,C)),O=O.j(C).add(c(k))):(O=O.j(P),O=O.add(c(k)))}return O}var h=l(0),m=l(1),p=l(16777216);t=s.prototype,t.m=function(){if(b(this))return-g(this).m();for(var S=0,A=1,P=0;P<this.g.length;P++){var O=this.i(P);S+=(0<=O?O:4294967296+O)*A,A*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(v(this))return"0";if(b(this))return"-"+g(this).toString(S);for(var A=c(Math.pow(S,6)),P=this,O="";;){var N=j(P,A).g;P=_(P,N.j(A));var C=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=N,v(P))return C+O;for(;6>C.length;)C="0"+C;O=C+O}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function v(S){if(S.h!=0)return!1;for(var A=0;A<S.g.length;A++)if(S.g[A]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=_(this,S),b(S)?-1:v(S)?0:1};function g(S){for(var A=S.g.length,P=[],O=0;O<A;O++)P[O]=~S.g[O];return new s(P,~S.h).add(m)}t.abs=function(){return b(this)?g(this):this},t.add=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0,N=0;N<=A;N++){var C=O+(this.i(N)&65535)+(S.i(N)&65535),k=(C>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);O=k>>>16,C&=65535,k&=65535,P[N]=k<<16|C}return new s(P,P[P.length-1]&-2147483648?-1:0)};function _(S,A){return S.add(g(A))}t.j=function(S){if(v(this)||v(S))return h;if(b(this))return b(S)?g(this).j(g(S)):g(g(this).j(S));if(b(S))return g(this.j(g(S)));if(0>this.l(p)&&0>S.l(p))return c(this.m()*S.m());for(var A=this.g.length+S.g.length,P=[],O=0;O<2*A;O++)P[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<S.g.length;N++){var C=this.i(O)>>>16,k=this.i(O)&65535,Q=S.i(N)>>>16,oe=S.i(N)&65535;P[2*O+2*N]+=k*oe,T(P,2*O+2*N),P[2*O+2*N+1]+=C*oe,T(P,2*O+2*N+1),P[2*O+2*N+1]+=k*Q,T(P,2*O+2*N+1),P[2*O+2*N+2]+=C*Q,T(P,2*O+2*N+2)}for(O=0;O<A;O++)P[O]=P[2*O+1]<<16|P[2*O];for(O=A;O<2*A;O++)P[O]=0;return new s(P,0)};function T(S,A){for(;(S[A]&65535)!=S[A];)S[A+1]+=S[A]>>>16,S[A]&=65535,A++}function E(S,A){this.g=S,this.h=A}function j(S,A){if(v(A))throw Error("division by zero");if(v(S))return new E(h,h);if(b(S))return A=j(g(S),A),new E(g(A.g),g(A.h));if(b(A))return A=j(S,g(A)),new E(g(A.g),A.h);if(30<S.g.length){if(b(S)||b(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,O=A;0>=O.l(S);)P=R(P),O=R(O);var N=D(P,1),C=D(O,1);for(O=D(O,2),P=D(P,2);!v(O);){var k=C.add(O);0>=k.l(S)&&(N=N.add(P),C=k),O=D(O,1),P=D(P,1)}return A=_(S,N.j(A)),new E(N,A)}for(N=h;0<=S.l(A);){for(P=Math.max(1,Math.floor(S.m()/A.m())),O=Math.ceil(Math.log(P)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),C=c(P),k=C.j(A);b(k)||0<k.l(S);)P-=O,C=c(P),k=C.j(A);v(C)&&(C=m),N=N.add(C),S=_(S,k)}return new E(N,S)}t.A=function(S){return j(this,S).h},t.and=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)&S.i(O);return new s(P,this.h&S.h)},t.or=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)|S.i(O);return new s(P,this.h|S.h)},t.xor=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)^S.i(O);return new s(P,this.h^S.h)};function R(S){for(var A=S.g.length+1,P=[],O=0;O<A;O++)P[O]=S.i(O)<<1|S.i(O-1)>>>31;return new s(P,S.h)}function D(S,A){var P=A>>5;A%=32;for(var O=S.g.length-P,N=[],C=0;C<O;C++)N[C]=0<A?S.i(C+P)>>>A|S.i(C+P+1)<<32-A:S.i(C+P);return new s(N,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,UE=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=u,Pi=s}).apply(typeof p0<"u"?p0:typeof self<"u"?self:typeof window<"u"?window:{});var dc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BE,So,HE,Uc,Hf,WE,qE,KE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,x){return f==Array.prototype||f==Object.prototype||(f[y]=x.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof dc=="object"&&dc];for(var y=0;y<f.length;++y){var x=f[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(f,y){if(y)e:{var x=n;f=f.split(".");for(var I=0;I<f.length-1;I++){var M=f[I];if(!(M in x))break e;x=x[M]}f=f[f.length-1],I=x[f],y=y(I),y!=I&&y!=null&&e(x,f,{configurable:!0,writable:!0,value:y})}}function a(f,y){f instanceof String&&(f+="");var x=0,I=!1,M={next:function(){if(!I&&x<f.length){var $=x++;return{value:y($,f[$]),done:!1}}return I=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(f){return f||function(){return a(this,function(y,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function l(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function c(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function u(f,y,x){return f.call.apply(f.bind,arguments)}function h(f,y,x){if(!f)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,I),f.apply(y,M)}}return function(){return f.apply(y,arguments)}}function m(f,y,x){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,y){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function v(f,y){function x(){}x.prototype=y.prototype,f.aa=y.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(I,M,$){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return y.prototype[M].apply(I,W)}}function b(f){const y=f.length;if(0<y){const x=Array(y);for(let I=0;I<y;I++)x[I]=f[I];return x}return[]}function g(f,y){for(let x=1;x<arguments.length;x++){const I=arguments[x];if(l(I)){const M=f.length||0,$=I.length||0;f.length=M+$;for(let W=0;W<$;W++)f[M+W]=I[W]}else f.push(I)}}class _{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function j(f){return j[" "](f),f}j[" "]=function(){};var R=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(f,y,x){for(const I in f)y.call(x,f[I],I,f)}function S(f,y){for(const x in f)y.call(void 0,f[x],x,f)}function A(f){const y={};for(const x in f)y[x]=f[x];return y}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(f,y){let x,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(x in I)f[x]=I[x];for(let $=0;$<P.length;$++)x=P[$],Object.prototype.hasOwnProperty.call(I,x)&&(f[x]=I[x])}}function N(f){var y=1;f=f.split(":");const x=[];for(;0<y&&f.length;)x.push(f.shift()),y--;return f.length&&x.push(f.join(":")),x}function C(f){o.setTimeout(()=>{throw f},0)}function k(){var f=ye;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,x){const I=oe.get();I.set(y,x),this.h?this.h.next=I:this.g=I,this.h=I}}var oe=new _(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,he=!1,ye=new Q,Ue=()=>{const f=o.Promise.resolve(void 0);ee=()=>{f.then(se)}};var se=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(x){C(x)}var y=oe;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}he=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var rt=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const x=()=>{};o.addEventListener("test",x,y),o.removeEventListener("test",x,y)}catch{}return f}();function ze(f,y){if(J.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(R){e:{try{j(y.nodeName);var M=!0;break e}catch{}M=!1}M||(y=null)}}else x=="mouseover"?y=f.fromElement:x=="mouseout"&&(y=f.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Fe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&ze.aa.h.call(this)}}v(ze,J);var Fe={2:"touch",3:"pen",4:"mouse"};ze.prototype.h=function(){ze.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Pr="closure_listenable_"+(1e6*Math.random()|0),rn=0;function G(f,y,x,I,M){this.listener=f,this.proxy=null,this.src=y,this.type=x,this.capture=!!I,this.ha=M,this.key=++rn,this.da=this.fa=!1}function de(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function be(f){this.src=f,this.g={},this.h=0}be.prototype.add=function(f,y,x,I,M){var $=f.toString();f=this.g[$],f||(f=this.g[$]=[],this.h++);var W=dt(f,y,I,M);return-1<W?(y=f[W],x||(y.fa=!1)):(y=new G(y,this.src,$,!!I,M),y.fa=x,f.push(y)),y};function B(f,y){var x=y.type;if(x in f.g){var I=f.g[x],M=Array.prototype.indexOf.call(I,y,void 0),$;($=0<=M)&&Array.prototype.splice.call(I,M,1),$&&(de(y),f.g[x].length==0&&(delete f.g[x],f.h--))}}function dt(f,y,x,I){for(var M=0;M<f.length;++M){var $=f[M];if(!$.da&&$.listener==y&&$.capture==!!x&&$.ha==I)return M}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),vt={};function bt(f,y,x,I,M){if(Array.isArray(y)){for(var $=0;$<y.length;$++)bt(f,y[$],x,I,M);return null}return x=Bl(x),f&&f[Pr]?f.K(y,x,c(I)?!!I.capture:!1,M):rr(f,y,x,!1,I,M)}function rr(f,y,x,I,M,$){if(!y)throw Error("Invalid event type");var W=c(M)?!!M.capture:!!M,Me=nn(f);if(Me||(f[Te]=Me=new be(f)),x=Me.add(y,x,I,W,$),x.proxy)return x;if(I=Zi(),x.proxy=I,I.src=f,I.listener=x,f.addEventListener)rt||(M=W),M===void 0&&(M=!1),f.addEventListener(y.toString(),I,M);else if(f.attachEvent)f.attachEvent(Ul(y.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Zi(){function f(x){return y.call(f.src,f.listener,x)}const y=nr;return f}function Cr(f,y,x,I,M){if(Array.isArray(y))for(var $=0;$<y.length;$++)Cr(f,y[$],x,I,M);else I=c(I)?!!I.capture:!!I,x=Bl(x),f&&f[Pr]?(f=f.i,y=String(y).toString(),y in f.g&&($=f.g[y],x=dt($,x,I,M),-1<x&&(de($[x]),Array.prototype.splice.call($,x,1),$.length==0&&(delete f.g[y],f.h--)))):f&&(f=nn(f))&&(y=f.g[y.toString()],f=-1,y&&(f=dt(y,x,I,M)),(x=-1<f?y[f]:null)&&Xs(x))}function Xs(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[Pr])B(y.i,f);else{var x=f.type,I=f.proxy;y.removeEventListener?y.removeEventListener(x,I,f.capture):y.detachEvent?y.detachEvent(Ul(x),I):y.addListener&&y.removeListener&&y.removeListener(I),(x=nn(y))?(B(x,f),x.h==0&&(x.src=null,y[Te]=null)):de(f)}}}function Ul(f){return f in vt?vt[f]:vt[f]="on"+f}function nr(f,y){if(f.da)f=!0;else{y=new ze(y,this);var x=f.listener,I=f.ha||f.src;f.fa&&Xs(f),f=x.call(I,y)}return f}function nn(f){return f=f[Te],f instanceof be?f:null}var Qs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bl(f){return typeof f=="function"?f:(f[Qs]||(f[Qs]=function(y){return f.handleEvent(y)}),f[Qs])}function at(){q.call(this),this.i=new be(this),this.M=this,this.F=null}v(at,q),at.prototype[Pr]=!0,at.prototype.removeEventListener=function(f,y,x,I){Cr(this,f,y,x,I)};function Ot(f,y){var x,I=f.F;if(I)for(x=[];I;I=I.F)x.push(I);if(f=f.M,I=y.type||y,typeof y=="string")y=new J(y,f);else if(y instanceof J)y.target=y.target||f;else{var M=y;y=new J(I,f),O(y,M)}if(M=!0,x)for(var $=x.length-1;0<=$;$--){var W=y.g=x[$];M=Xi(W,I,!0,y)&&M}if(W=y.g=f,M=Xi(W,I,!0,y)&&M,M=Xi(W,I,!1,y)&&M,x)for($=0;$<x.length;$++)W=y.g=x[$],M=Xi(W,I,!1,y)&&M}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var x=f.g[y],I=0;I<x.length;I++)de(x[I]);delete f.g[y],f.h--}}this.F=null},at.prototype.K=function(f,y,x,I){return this.i.add(String(f),y,!1,x,I)},at.prototype.L=function(f,y,x,I){return this.i.add(String(f),y,!0,x,I)};function Xi(f,y,x,I){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var M=!0,$=0;$<y.length;++$){var W=y[$];if(W&&!W.da&&W.capture==x){var Me=W.listener,Mt=W.ha||W.src;W.fa&&B(f.i,W),M=Me.call(Mt,I)!==!1&&M}}return M&&!I.defaultPrevented}function Qa(f,y,x){if(typeof f=="function")x&&(f=m(f,x));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function Nn(f){f.g=Qa(()=>{f.g=null,f.i&&(f.i=!1,Nn(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class Hl extends q{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Nn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(f){q.call(this),this.h=f,this.g={}}v(kr,q);var Wl=[];function ql(f){D(f.g,function(y,x){this.g.hasOwnProperty(x)&&Xs(y)},f),f.g={}}kr.prototype.N=function(){kr.aa.N.call(this),ql(this)},kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ja=o.JSON.stringify,Kl=o.JSON.parse,Sh=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Qi(){}Qi.prototype.h=null;function Wr(f){return f.h||(f.h=f.i())}function Gl(){}var Ji={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function es(){J.call(this,"d")}v(es,J);function ts(){J.call(this,"c")}v(ts,J);var le={},st=null;function ot(){return st=st||new at}le.La="serverreachability";function qt(f){J.call(this,le.La,f)}v(qt,J);function an(f){const y=ot();Ot(y,new qt(y))}le.STAT_EVENT="statevent";function ht(f,y){J.call(this,le.STAT_EVENT,f),this.stat=y}v(ht,J);function Re(f){const y=ot();Ot(y,new ht(y,f))}le.Ma="timingevent";function ea(f,y){J.call(this,le.Ma,f),this.size=y}v(ea,J);function Rt(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function Yl(f,y,x,I,M,$){f.info(function(){if(f.g)if($)for(var W="",Me=$.split("&"),Mt=0;Mt<Me.length;Mt++){var Ie=Me[Mt].split("=");if(1<Ie.length){var Kt=Ie[0];Ie=Ie[1];var Gt=Kt.split("_");W=2<=Gt.length&&Gt[1]=="type"?W+(Kt+"="+Ie+"&"):W+(Kt+"=redacted&")}}else W=null;else W=$;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+y+`
`+x+`
`+W})}function jn(f,y,x,I,M,$,W){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+y+`
`+x+`
`+$+" "+W})}function ta(f,y,x,I){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+qC(f,x)+(I?" "+I:"")})}function WC(f,y){f.info(function(){return"TIMEOUT: "+y})}Dt.prototype.info=function(){};function qC(f,y){if(!f.g)return y;if(!y)return null;try{var x=JSON.parse(y);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var I=x[f];if(!(2>I.length)){var M=I[1];if(Array.isArray(M)&&!(1>M.length)){var $=M[0];if($!="noop"&&$!="stop"&&$!="close")for(var W=1;W<M.length;W++)M[W]=""}}}}return Ja(x)}catch{return y}}var Zl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Uy={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ih;function Xl(){}v(Xl,Qi),Xl.prototype.g=function(){return new XMLHttpRequest},Xl.prototype.i=function(){return{}},Ih=new Xl;function li(f,y,x,I){this.j=f,this.i=y,this.l=x,this.R=I||1,this.U=new kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new By}function By(){this.i=null,this.g="",this.h=!1}var Hy={},Ph={};function Ch(f,y,x){f.L=1,f.v=tc(On(y)),f.m=x,f.P=!0,Wy(f,null)}function Wy(f,y){f.F=Date.now(),Ql(f),f.A=On(f.v);var x=f.A,I=f.R;Array.isArray(I)||(I=[String(I)]),av(x.i,"t",I),f.C=0,x=f.j.J,f.h=new By,f.g=Ev(f.j,x?y:null,!f.m),0<f.O&&(f.M=new Hl(m(f.Y,f,f.g),f.O)),y=f.U,x=f.g,I=f.ca;var M="readystatechange";Array.isArray(M)||(M&&(Wl[0]=M.toString()),M=Wl);for(var $=0;$<M.length;$++){var W=bt(x,M[$],I||y.handleEvent,!1,y.h||y);if(!W)break;y.g[W.key]=W}y=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),an(),Yl(f.i,f.u,f.A,f.l,f.R,f.m)}li.prototype.ca=function(f){f=f.target;const y=this.M;y&&Rn(f)==3?y.j():this.Y(f)},li.prototype.Y=function(f){try{if(f==this.g)e:{const Gt=Rn(this.g);var y=this.g.Ba();const is=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||hv(this.g)))){this.J||Gt!=4||y==7||(y==8||0>=is?an(3):an(2)),kh(this);var x=this.g.Z();this.X=x;t:if(qy(this)){var I=hv(this.g);f="";var M=I.length,$=Rn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ra(this),Js(this);var W="";break t}this.h.i=new o.TextDecoder}for(y=0;y<M;y++)this.h.h=!0,f+=this.h.i.decode(I[y],{stream:!($&&y==M-1)});I.length=0,this.h.g+=f,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=x==200,jn(this.i,this.u,this.A,this.l,this.R,Gt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Mt=this.g;if((Me=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Me)){var Ie=Me;break t}}Ie=null}if(x=Ie)ta(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Nh(this,x);else{this.o=!1,this.s=3,Re(12),ra(this),Js(this);break e}}if(this.P){x=!0;let qr;for(;!this.J&&this.C<W.length;)if(qr=KC(this,W),qr==Ph){Gt==4&&(this.s=4,Re(14),x=!1),ta(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==Hy){this.s=4,Re(15),ta(this.i,this.l,W,"[Invalid Chunk]"),x=!1;break}else ta(this.i,this.l,qr,null),Nh(this,qr);if(qy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||W.length!=0||this.h.h||(this.s=1,Re(16),x=!1),this.o=this.o&&x,!x)ta(this.i,this.l,W,"[Invalid Chunked Response]"),ra(this),Js(this);else if(0<W.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Lh(Kt),Kt.M=!0,Re(11))}}else ta(this.i,this.l,W,null),Nh(this,W);Gt==4&&ra(this),this.o&&!this.J&&(Gt==4?bv(this.j,this):(this.o=!1,Ql(this)))}else uk(this.g),x==400&&0<W.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),ra(this),Js(this)}}}catch{}finally{}};function qy(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function KC(f,y){var x=f.C,I=y.indexOf(`
`,x);return I==-1?Ph:(x=Number(y.substring(x,I)),isNaN(x)?Hy:(I+=1,I+x>y.length?Ph:(y=y.slice(I,I+x),f.C=I+x,y)))}li.prototype.cancel=function(){this.J=!0,ra(this)};function Ql(f){f.S=Date.now()+f.I,Ky(f,f.I)}function Ky(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(m(f.ba,f),y)}function kh(f){f.B&&(o.clearTimeout(f.B),f.B=null)}li.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(WC(this.i,this.A),this.L!=2&&(an(),Re(17)),ra(this),this.s=2,Js(this)):Ky(this,this.S-f)};function Js(f){f.j.G==0||f.J||bv(f.j,f)}function ra(f){kh(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,ql(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Nh(f,y){try{var x=f.j;if(x.G!=0&&(x.g==f||jh(x.h,f))){if(!f.K&&jh(x.h,f)&&x.G==3){try{var I=x.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)oc(x),ac(x);else break e;Mh(x),Re(18)}}else x.za=M[1],0<x.za-x.T&&37500>M[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rt(m(x.Za,x),6e3));if(1>=Zy(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else ia(x,11)}else if((f.K||x.g==f)&&oc(x),!T(y))for(M=x.Da.g.parse(y),y=0;y<M.length;y++){let Ie=M[y];if(x.T=Ie[0],Ie=Ie[1],x.G==2)if(Ie[0]=="c"){x.K=Ie[1],x.ia=Ie[2];const Kt=Ie[3];Kt!=null&&(x.la=Kt,x.j.info("VER="+x.la));const Gt=Ie[4];Gt!=null&&(x.Aa=Gt,x.j.info("SVER="+x.Aa));const is=Ie[5];is!=null&&typeof is=="number"&&0<is&&(I=1.5*is,x.L=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const qr=f.g;if(qr){const cc=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cc){var $=I.h;$.g||cc.indexOf("spdy")==-1&&cc.indexOf("quic")==-1&&cc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Oh($,$.h),$.h=null))}if(I.D){const $h=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;$h&&(I.ya=$h,Be(I.I,I.D,$h))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),I=x;var W=f;if(I.qa=_v(I,I.J?I.ia:null,I.W),W.K){Xy(I.h,W);var Me=W,Mt=I.L;Mt&&(Me.I=Mt),Me.B&&(kh(Me),Ql(Me)),I.g=W}else yv(I);0<x.i.length&&sc(x)}else Ie[0]!="stop"&&Ie[0]!="close"||ia(x,7);else x.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?ia(x,7):Dh(x):Ie[0]!="noop"&&x.l&&x.l.ta(Ie),x.v=0)}}an(4)}catch{}}var GC=class{constructor(f,y){this.g=f,this.map=y}};function Gy(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Yy(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Zy(f){return f.h?1:f.g?f.g.size:0}function jh(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function Oh(f,y){f.g?f.g.add(y):f.h=y}function Xy(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}Gy.prototype.cancel=function(){if(this.i=Qy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Qy(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const x of f.g.values())y=y.concat(x.D);return y}return b(f.i)}function YC(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var y=[],x=f.length,I=0;I<x;I++)y.push(f[I]);return y}y=[],x=0;for(I in f)y[x++]=f[I];return y}function ZC(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var y=[];f=f.length;for(var x=0;x<f;x++)y.push(x);return y}y=[],x=0;for(const I in f)y[x++]=I;return y}}}function Jy(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var x=ZC(f),I=YC(f),M=I.length,$=0;$<M;$++)y.call(void 0,I[$],x&&x[$],f)}var ev=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function XC(f,y){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var I=f[x].indexOf("="),M=null;if(0<=I){var $=f[x].substring(0,I);M=f[x].substring(I+1)}else $=f[x];y($,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function na(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof na){this.h=f.h,Jl(this,f.j),this.o=f.o,this.g=f.g,ec(this,f.s),this.l=f.l;var y=f.i,x=new ro;x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),tv(this,x),this.m=f.m}else f&&(y=String(f).match(ev))?(this.h=!1,Jl(this,y[1]||"",!0),this.o=eo(y[2]||""),this.g=eo(y[3]||"",!0),ec(this,y[4]),this.l=eo(y[5]||"",!0),tv(this,y[6]||"",!0),this.m=eo(y[7]||"")):(this.h=!1,this.i=new ro(null,this.h))}na.prototype.toString=function(){var f=[],y=this.j;y&&f.push(to(y,rv,!0),":");var x=this.g;return(x||y=="file")&&(f.push("//"),(y=this.o)&&f.push(to(y,rv,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(to(x,x.charAt(0)=="/"?ek:JC,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",to(x,rk)),f.join("")};function On(f){return new na(f)}function Jl(f,y,x){f.j=x?eo(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function ec(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function tv(f,y,x){y instanceof ro?(f.i=y,nk(f.i,f.h)):(x||(y=to(y,tk)),f.i=new ro(y,f.h))}function Be(f,y,x){f.i.set(y,x)}function tc(f){return Be(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function eo(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function to(f,y,x){return typeof f=="string"?(f=encodeURI(f).replace(y,QC),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function QC(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var rv=/[#\/\?@]/g,JC=/[#\?:]/g,ek=/[#\?]/g,tk=/[#\?@]/g,rk=/#/g;function ro(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function ci(f){f.g||(f.g=new Map,f.h=0,f.i&&XC(f.i,function(y,x){f.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=ro.prototype,t.add=function(f,y){ci(this),this.i=null,f=rs(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(y),this.h+=1,this};function nv(f,y){ci(f),y=rs(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function iv(f,y){return ci(f),y=rs(f,y),f.g.has(y)}t.forEach=function(f,y){ci(this),this.g.forEach(function(x,I){x.forEach(function(M){f.call(y,M,I,this)},this)},this)},t.na=function(){ci(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),x=[];for(let I=0;I<y.length;I++){const M=f[I];for(let $=0;$<M.length;$++)x.push(y[I])}return x},t.V=function(f){ci(this);let y=[];if(typeof f=="string")iv(this,f)&&(y=y.concat(this.g.get(rs(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)y=y.concat(f[x])}return y},t.set=function(f,y){return ci(this),this.i=null,f=rs(this,f),iv(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function av(f,y,x){nv(f,y),0<x.length&&(f.i=null,f.g.set(rs(f,y),b(x)),f.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var x=0;x<y.length;x++){var I=y[x];const $=encodeURIComponent(String(I)),W=this.V(I);for(I=0;I<W.length;I++){var M=$;W[I]!==""&&(M+="="+encodeURIComponent(String(W[I]))),f.push(M)}}return this.i=f.join("&")};function rs(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function nk(f,y){y&&!f.j&&(ci(f),f.i=null,f.g.forEach(function(x,I){var M=I.toLowerCase();I!=M&&(nv(this,I),av(this,M,x))},f)),f.j=y}function ik(f,y){const x=new Dt;if(o.Image){const I=new Image;I.onload=p(ui,x,"TestLoadImage: loaded",!0,y,I),I.onerror=p(ui,x,"TestLoadImage: error",!1,y,I),I.onabort=p(ui,x,"TestLoadImage: abort",!1,y,I),I.ontimeout=p(ui,x,"TestLoadImage: timeout",!1,y,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else y(!1)}function ak(f,y){const x=new Dt,I=new AbortController,M=setTimeout(()=>{I.abort(),ui(x,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:I.signal}).then($=>{clearTimeout(M),$.ok?ui(x,"TestPingServer: ok",!0,y):ui(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(M),ui(x,"TestPingServer: error",!1,y)})}function ui(f,y,x,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(x)}catch{}}function sk(){this.g=new Sh}function ok(f,y,x){const I=x||"";try{Jy(f,function(M,$){let W=M;c(M)&&(W=Ja(M)),y.push(I+$+"="+encodeURIComponent(W))})}catch(M){throw y.push(I+"type="+encodeURIComponent("_badmap")),M}}function rc(f){this.l=f.Ub||null,this.j=f.eb||!1}v(rc,Qi),rc.prototype.g=function(){return new nc(this.l,this.j)},rc.prototype.i=function(f){return function(){return f}}({});function nc(f,y){at.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(nc,at),t=nc.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,io(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,no(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,io(this)),this.g&&(this.readyState=3,io(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sv(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function sv(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?no(this):io(this),this.readyState==3&&sv(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,no(this))},t.Qa=function(f){this.g&&(this.response=f,no(this))},t.ga=function(){this.g&&no(this)};function no(f){f.readyState=4,f.l=null,f.j=null,f.v=null,io(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=y.next();return f.join(`\r
`)};function io(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(nc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function ov(f){let y="";return D(f,function(x,I){y+=I,y+=":",y+=x,y+=`\r
`}),y}function Rh(f,y,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=ov(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):Be(f,y,x))}function nt(f){at.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(nt,at);var lk=/^https?$/i,ck=["POST","PUT"];t=nt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ih.g(),this.v=this.o?Wr(this.o):Wr(Ih),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch($){lv(this,$);return}if(f=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)x.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const $ of I.keys())x.set($,I.get($));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),M=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(ck,y,void 0))||I||M||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,W]of x)this.g.setRequestHeader($,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{dv(this),this.u=!0,this.g.send(f),this.u=!1}catch($){lv(this,$)}};function lv(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,cv(f),ic(f)}function cv(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),ic(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ic(this,!0)),nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?uv(this):this.bb())},t.bb=function(){uv(this)};function uv(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Rn(f)!=4||f.Z()!=2)){if(f.u&&Rn(f)==4)Qa(f.Ea,0,f);else if(Ot(f,"readystatechange"),Rn(f)==4){f.h=!1;try{const W=f.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var I;if(I=W===0){var M=String(f.D).match(ev)[1]||null;!M&&o.self&&o.self.location&&(M=o.self.location.protocol.slice(0,-1)),I=!lk.test(M?M.toLowerCase():"")}x=I}if(x)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var $=2<Rn(f)?f.g.statusText:""}catch{$=""}f.l=$+" ["+f.Z()+"]",cv(f)}}finally{ic(f)}}}}function ic(f,y){if(f.g){dv(f);const x=f.g,I=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Ot(f,"ready");try{x.onreadystatechange=I}catch{}}}function dv(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Rn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Rn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),Kl(y)}};function hv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function uk(f){const y={};f=(f.g&&2<=Rn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(T(f[I]))continue;var x=N(f[I]);const M=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=y[M]||[];y[M]=$,$.push(x)}S(y,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ao(f,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||y}function fv(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ao("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ao("baseRetryDelayMs",5e3,f),this.cb=ao("retryDelaySeedMs",1e4,f),this.Wa=ao("forwardChannelMaxRetries",2,f),this.wa=ao("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Gy(f&&f.concurrentRequestLimit),this.Da=new sk,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=fv.prototype,t.la=8,t.G=1,t.connect=function(f,y,x,I){Re(0),this.W=f,this.H=y||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.I=_v(this,null,this.W),sc(this)};function Dh(f){if(mv(f),f.G==3){var y=f.U++,x=On(f.I);if(Be(x,"SID",f.K),Be(x,"RID",y),Be(x,"TYPE","terminate"),so(f,x),y=new li(f,f.j,y),y.L=2,y.v=tc(On(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=y.v,x=!0),x||(y.g=Ev(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Ql(y)}wv(f)}function ac(f){f.g&&(Lh(f),f.g.cancel(),f.g=null)}function mv(f){ac(f),f.u&&(o.clearTimeout(f.u),f.u=null),oc(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function sc(f){if(!Yy(f.h)&&!f.s){f.s=!0;var y=f.Ga;ee||Ue(),he||(ee(),he=!0),ye.add(y,f),f.B=0}}function dk(f,y){return Zy(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(m(f.Ga,f,y),xv(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const M=new li(this,this.j,f);let $=this.o;if(this.S&&($?($=A($),O($,this.S)):$=this.S),this.m!==null||this.O||(M.H=$,$=null),this.P)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=gv(this,M,y),x=On(this.I),Be(x,"RID",f),Be(x,"CVER",22),this.D&&Be(x,"X-HTTP-Session-Id",this.D),so(this,x),$&&(this.O?y="headers="+encodeURIComponent(String(ov($)))+"&"+y:this.m&&Rh(x,this.m,$)),Oh(this.h,M),this.Ua&&Be(x,"TYPE","init"),this.P?(Be(x,"$req",y),Be(x,"SID","null"),M.T=!0,Ch(M,x,null)):Ch(M,x,y),this.G=2}}else this.G==3&&(f?pv(this,f):this.i.length==0||Yy(this.h)||pv(this))};function pv(f,y){var x;y?x=y.l:x=f.U++;const I=On(f.I);Be(I,"SID",f.K),Be(I,"RID",x),Be(I,"AID",f.T),so(f,I),f.m&&f.o&&Rh(I,f.m,f.o),x=new li(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),y&&(f.i=y.D.concat(f.i)),y=gv(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Oh(f.h,x),Ch(x,I,y)}function so(f,y){f.H&&D(f.H,function(x,I){Be(y,I,x)}),f.l&&Jy({},function(x,I){Be(y,I,x)})}function gv(f,y,x){x=Math.min(f.i.length,x);var I=f.l?m(f.l.Na,f.l,f):null;e:{var M=f.i;let $=-1;for(;;){const W=["count="+x];$==-1?0<x?($=M[0].g,W.push("ofs="+$)):$=0:W.push("ofs="+$);let Me=!0;for(let Mt=0;Mt<x;Mt++){let Ie=M[Mt].g;const Kt=M[Mt].map;if(Ie-=$,0>Ie)$=Math.max(0,M[Mt].g-100),Me=!1;else try{ok(Kt,W,"req"+Ie+"_")}catch{I&&I(Kt)}}if(Me){I=W.join("&");break e}}}return f=f.i.splice(0,x),y.D=f,I}function yv(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;ee||Ue(),he||(ee(),he=!0),ye.add(y,f),f.v=0}}function Mh(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(m(f.Fa,f),xv(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,vv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),ac(this),vv(this))};function Lh(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function vv(f){f.g=new li(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=On(f.qa);Be(y,"RID","rpc"),Be(y,"SID",f.K),Be(y,"AID",f.T),Be(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Be(y,"TO",f.ja),Be(y,"TYPE","xmlhttp"),so(f,y),f.m&&f.o&&Rh(y,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=tc(On(y)),x.m=null,x.P=!0,Wy(x,f)}t.Za=function(){this.C!=null&&(this.C=null,ac(this),Mh(this),Re(19))};function oc(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function bv(f,y){var x=null;if(f.g==y){oc(f),Lh(f),f.g=null;var I=2}else if(jh(f.h,y))x=y.D,Xy(f.h,y),I=1;else return;if(f.G!=0){if(y.o)if(I==1){x=y.m?y.m.length:0,y=Date.now()-y.F;var M=f.B;I=ot(),Ot(I,new ea(I,x)),sc(f)}else yv(f);else if(M=y.s,M==3||M==0&&0<y.X||!(I==1&&dk(f,y)||I==2&&Mh(f)))switch(x&&0<x.length&&(y=f.h,y.i=y.i.concat(x)),M){case 1:ia(f,5);break;case 4:ia(f,10);break;case 3:ia(f,6);break;default:ia(f,2)}}}function xv(f,y){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*y}function ia(f,y){if(f.j.info("Error code "+y),y==2){var x=m(f.fb,f),I=f.Xa;const M=!I;I=new na(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Jl(I,"https"),tc(I),M?ik(I.toString(),x):ak(I.toString(),x)}else Re(2);f.G=0,f.l&&f.l.sa(y),wv(f),mv(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function wv(f){if(f.G=0,f.ka=[],f.l){const y=Qy(f.h);(y.length!=0||f.i.length!=0)&&(g(f.ka,y),g(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function _v(f,y,x){var I=x instanceof na?On(x):new na(x);if(I.g!="")y&&(I.g=y+"."+I.g),ec(I,I.s);else{var M=o.location;I=M.protocol,y=y?y+"."+M.hostname:M.hostname,M=+M.port;var $=new na(null);I&&Jl($,I),y&&($.g=y),M&&ec($,M),x&&($.l=x),I=$}return x=f.D,y=f.ya,x&&y&&Be(I,x,y),Be(I,"VER",f.la),so(f,I),I}function Ev(f,y,x){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new nt(new rc({eb:x})):new nt(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Tv(){}t=Tv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function lc(){}lc.prototype.g=function(f,y){return new gr(f,y)};function gr(f,y){at.call(this),this.g=new fv(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!T(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new ns(this)}v(gr,at),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Dh(this.g)},gr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=Ja(f),f=x);y.i.push(new GC(y.Ya++,f)),y.G==3&&sc(y)},gr.prototype.N=function(){this.g.l=null,delete this.j,Dh(this.g),delete this.g,gr.aa.N.call(this)};function Av(f){es.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const x in y){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}v(Av,es);function Sv(){ts.call(this),this.status=1}v(Sv,ts);function ns(f){this.g=f}v(ns,Tv),ns.prototype.ua=function(){Ot(this.g,"a")},ns.prototype.ta=function(f){Ot(this.g,new Av(f))},ns.prototype.sa=function(f){Ot(this.g,new Sv)},ns.prototype.ra=function(){Ot(this.g,"b")},lc.prototype.createWebChannel=lc.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,KE=function(){return new lc},qE=function(){return ot()},WE=le,Hf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zl.NO_ERROR=0,Zl.TIMEOUT=8,Zl.HTTP_ERROR=6,Uc=Zl,Uy.COMPLETE="complete",HE=Uy,Gl.EventType=Ji,Ji.OPEN="a",Ji.CLOSE="b",Ji.ERROR="c",Ji.MESSAGE="d",at.prototype.listen=at.prototype.K,So=Gl,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,BE=nt}).apply(typeof dc<"u"?dc:typeof self<"u"?self:typeof window<"u"?window:{});const g0="@firebase/firestore",y0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na=new dp("@firebase/firestore");function os(){return Na.logLevel}function Y(t,...e){if(Na.logLevel<=xe.DEBUG){const r=e.map(_p);Na.debug(`Firestore (${$s}): ${t}`,...r)}}function Xn(t,...e){if(Na.logLevel<=xe.ERROR){const r=e.map(_p);Na.error(`Firestore (${$s}): ${t}`,...r)}}function Ts(t,...e){if(Na.logLevel<=xe.WARN){const r=e.map(_p);Na.warn(`Firestore (${$s}): ${t}`,...r)}}function _p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,GE(t,n,r)}function GE(t,e,r){let n=`FIRESTORE (${$s}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Xn(n),new Error(n)}function Ne(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||GE(e,i,n)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Pn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ZR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Xt.UNAUTHENTICATED))}shutdown(){}}class XR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class QR{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ne(this.o===void 0,42304);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ci,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ci)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ne(typeof n.accessToken=="string",31837,{l:n}),new YE(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new Xt(e)}}class JR{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class e2{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new JR(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class v0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t2{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ne(this.o===void 0,3512);const n=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new v0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ne(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new v0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=r2(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function we(t,e){return t<e?-1:t>e?1:0}function Wf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return Yh(i)===Yh(a)?we(i,a):Yh(i)?1:-1}return we(t.length,e.length)}const n2=55296,i2=57343;function Yh(t){const e=t.charCodeAt(0);return e>=n2&&e<=i2}function As(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="__name__";class ln{constructor(e,r,n){r===void 0?r=0:r>e.length&&ue(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ue(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ln.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ln?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=ln.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return we(e.length,r.length)}static compareSegments(e,r){const n=ln.isNumericId(e),i=ln.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?ln.extractNumericId(e).compare(ln.extractNumericId(r)):Wf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}}class Xe extends ln{construct(e,r,n){return new Xe(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new re(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Xe(r)}static emptyPath(){return new Xe([])}}const a2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ft extends ln{construct(e,r,n){return new Ft(e,r,n)}static isValidIdentifier(e){return a2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ft.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===b0}static keyField(){return new Ft([b0])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new re(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new re(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new re(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ft(r)}static emptyPath(){return new Ft([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Xe.fromString(e))}static fromName(e){return new ae(Xe.fromString(e).popFirst(5))}static empty(){return new ae(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Xe.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s2(t,e,r){if(!r)throw new re(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function o2(t,e,r,n){if(e===!0&&n===!0)throw new re(U.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function x0(t){if(!ae.isDocumentKey(t))throw new re(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ZE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Tp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function Zo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Tp(t);throw new re(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t,e){const r={typeString:t};return e&&(r.value=e),r}function Tl(t,e){if(!ZE(t))throw new re(U.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new re(U.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0=-62135596800,_0=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*_0);return new qe(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<w0)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_0}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Tl(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-w0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:pt("string",qe._jsonSchemaVersion),seconds:pt("number"),nanoseconds:pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new qe(0,0))}static max(){return new fe(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=-1;function l2(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(n===1e9?new qe(r+1,0):new qe(r,n));return new Oi(i,ae.empty(),e)}function c2(t){return new Oi(t.readTime,t.key,Xo)}class Oi{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Oi(fe.min(),ae.empty(),Xo)}static max(){return new Oi(fe.max(),ae.empty(),Xo)}}function u2(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ae.comparator(t.documentKey,e.documentKey),r!==0?r:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class h2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==d2)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new F((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof F?r:F.resolve(r)}catch(r){return F.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):F.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):F.reject(r)}static resolve(e){return new F((r,n)=>{r(e)})}static reject(e){return new F((r,n)=>{n(e)})}static waitFor(e){return new F((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},l=>n(l))}),s=!0,a===i&&r()})}static or(e){let r=F.resolve(!1);for(const n of e)r=r.next(i=>i?F.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new F((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(u=>{s[c]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new F((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function f2(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function zs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=-1;function yd(t){return t==null}function du(t){return t===0&&1/t==-1/0}function m2(t){return typeof t=="number"&&Number.isInteger(t)&&!du(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE="";function p2(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=E0(e)),e=g2(t.get(r),e);return E0(e)}function g2(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case XE:r+="";break;default:r+=a}}return r}function E0(t){return t+XE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Fa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function QE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,r){this.comparator=e,this.root=r||Vt.EMPTY}insert(e,r){return new Qe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new Qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hc(this.root,e,this.comparator,!1)}getReverseIterator(){return new hc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hc(this.root,e,this.comparator,!0)}}class hc{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Vt.RED,this.left=i??Vt.EMPTY,this.right=a??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Vt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Vt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new A0(this.data.getIterator())}getIteratorFrom(e){return new A0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new At(this.comparator);return r.data=e,r}}class A0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.fields=e,e.sort(Ft.comparator)}static empty(){return new Xr([])}unionWith(e){let r=new At(Ft.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return As(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new JE("Invalid base64 string: "+a):a}}(e);return new Bt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Bt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const y2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ri(t){if(Ne(!!t,39018),typeof t=="string"){let e=0;const r=y2.exec(t);if(Ne(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:lt(t.seconds),nanos:lt(t.nanos)}}function lt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Di(t){return typeof t=="string"?Bt.fromBase64String(t):Bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="server_timestamp",t1="__type__",r1="__previous_value__",n1="__local_write_time__";function Sp(t){return(t?.mapValue?.fields||{})[t1]?.stringValue===e1}function vd(t){const e=t.mapValue.fields[r1];return Sp(e)?vd(e):e}function Qo(t){const e=Ri(t.mapValue.fields[n1].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{constructor(e,r,n,i,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const hu="(default)";class Jo{constructor(e,r){this.projectId=e,this.database=r||hu}static empty(){return new Jo("","")}get isDefaultDatabase(){return this.database===hu}isEqual(e){return e instanceof Jo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1="__type__",b2="__max__",fc={mapValue:{}},a1="__vector__",fu="value";function Mi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sp(t)?4:w2(t)?9007199254740991:x2(t)?10:11:ue(28295,{value:t})}function En(t,e){if(t===e)return!0;const r=Mi(t);if(r!==Mi(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qo(t).isEqual(Qo(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Ri(i.timestampValue),o=Ri(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Di(i.bytesValue).isEqual(Di(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return lt(i.geoPointValue.latitude)===lt(a.geoPointValue.latitude)&&lt(i.geoPointValue.longitude)===lt(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return lt(i.integerValue)===lt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=lt(i.doubleValue),o=lt(a.doubleValue);return s===o?du(s)===du(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return As(t.arrayValue.values||[],e.arrayValue.values||[],En);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(T0(s)!==T0(o))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(o[l]===void 0||!En(s[l],o[l])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function el(t,e){return(t.values||[]).find(r=>En(r,e))!==void 0}function Ss(t,e){if(t===e)return 0;const r=Mi(t),n=Mi(e);if(r!==n)return we(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=lt(a.integerValue||a.doubleValue),l=lt(s.integerValue||s.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return S0(t.timestampValue,e.timestampValue);case 4:return S0(Qo(t),Qo(e));case 5:return Wf(t.stringValue,e.stringValue);case 6:return function(a,s){const o=Di(a),l=Di(s);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),l=s.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=we(o[c],l[c]);if(u!==0)return u}return we(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=we(lt(a.latitude),lt(s.latitude));return o!==0?o:we(lt(a.longitude),lt(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return I0(t.arrayValue,e.arrayValue);case 10:return function(a,s){const o=a.fields||{},l=s.fields||{},c=o[fu]?.arrayValue,u=l[fu]?.arrayValue,h=we(c?.values?.length||0,u?.values?.length||0);return h!==0?h:I0(c,u)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===fc.mapValue&&s===fc.mapValue)return 0;if(a===fc.mapValue)return 1;if(s===fc.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=s.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=Wf(l[h],u[h]);if(m!==0)return m;const p=Ss(o[l[h]],c[u[h]]);if(p!==0)return p}return we(l.length,u.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:r})}}function S0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const r=Ri(t),n=Ri(e),i=we(r.seconds,n.seconds);return i!==0?i:we(r.nanos,n.nanos)}function I0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=Ss(r[i],n[i]);if(a)return a}return we(r.length,n.length)}function Is(t){return qf(t)}function qf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Ri(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Di(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=qf(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${qf(r.fields[s])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function Bc(t){switch(Mi(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vd(t);return e?16+Bc(e):16;case 5:return 2*t.stringValue.length;case 6:return Di(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Bc(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Fa(n.fields,(a,s)=>{i+=a.length+Bc(s)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function Kf(t){return!!t&&"integerValue"in t}function Ip(t){return!!t&&"arrayValue"in t}function P0(t){return!!t&&"nullValue"in t}function C0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hc(t){return!!t&&"mapValue"in t}function x2(t){return(t?.mapValue?.fields||{})[i1]?.stringValue===a1}function Do(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Do(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Do(t.arrayValue.values[r]);return e}return{...t}}function w2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===b2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Hc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Do(r)}setAll(e){let r=Ft.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=Do(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());Hc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return En(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Hc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Fa(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Dr(Do(this.value))}}function s1(t){const e=[];return Fa(t.fields,(r,n)=>{const i=new Ft([r]);if(Hc(n)){const a=s1(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Qt(e,0,fe.min(),fe.min(),fe.min(),Dr.empty(),0)}static newFoundDocument(e,r,n,i){return new Qt(e,1,r,fe.min(),n,i,0)}static newNoDocument(e,r){return new Qt(e,2,r,fe.min(),fe.min(),Dr.empty(),0)}static newUnknownDocument(e,r){return new Qt(e,3,r,fe.min(),fe.min(),Dr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,r){this.position=e,this.inclusive=r}}function k0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=ae.comparator(ae.fromName(s.referenceValue),r.key):n=Ss(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function N0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!En(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r="asc"){this.field=e,this.dir=r}}function _2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{}class _t extends o1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new T2(e,r,n):r==="array-contains"?new I2(e,n):r==="in"?new P2(e,n):r==="not-in"?new C2(e,n):r==="array-contains-any"?new k2(e,n):new _t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new A2(e,n):new S2(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ss(r,this.value)):r!==null&&Mi(this.value)===Mi(r)&&this.matchesComparison(Ss(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tn extends o1{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Tn(e,r)}matches(e){return l1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function l1(t){return t.op==="and"}function c1(t){return E2(t)&&l1(t)}function E2(t){for(const e of t.filters)if(e instanceof Tn)return!1;return!0}function Gf(t){if(t instanceof _t)return t.field.canonicalString()+t.op.toString()+Is(t.value);if(c1(t))return t.filters.map(e=>Gf(e)).join(",");{const e=t.filters.map(r=>Gf(r)).join(",");return`${t.op}(${e})`}}function u1(t,e){return t instanceof _t?function(n,i){return i instanceof _t&&n.op===i.op&&n.field.isEqual(i.field)&&En(n.value,i.value)}(t,e):t instanceof Tn?function(n,i){return i instanceof Tn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&u1(s,i.filters[o]),!0):!1}(t,e):void ue(19439)}function d1(t){return t instanceof _t?function(r){return`${r.field.canonicalString()} ${r.op} ${Is(r.value)}`}(t):t instanceof Tn?function(r){return r.op.toString()+" {"+r.getFilters().map(d1).join(" ,")+"}"}(t):"Filter"}class T2 extends _t{constructor(e,r,n){super(e,r,n),this.key=ae.fromName(n.referenceValue)}matches(e){const r=ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class A2 extends _t{constructor(e,r){super(e,"in",r),this.keys=h1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class S2 extends _t{constructor(e,r){super(e,"not-in",r),this.keys=h1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function h1(t,e){return(e.arrayValue?.values||[]).map(r=>ae.fromName(r.referenceValue))}class I2 extends _t{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Ip(r)&&el(r.arrayValue,this.value)}}class P2 extends _t{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&el(this.value.arrayValue,r)}}class C2 extends _t{constructor(e,r){super(e,"not-in",r)}matches(e){if(el(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!el(this.value.arrayValue,r)}}class k2 extends _t{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Ip(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>el(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function j0(t,e=null,r=[],n=[],i=null,a=null,s=null){return new N2(t,e,r,n,i,a,s)}function Pp(t){const e=ge(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Gf(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),yd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Is(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Is(n)).join(",")),e.Te=r}return e.Te}function Cp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!_2(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!u1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!N0(t.startAt,e.startAt)&&N0(t.endAt,e.endAt)}function Yf(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function j2(t,e,r,n,i,a,s,o){return new bd(t,e,r,n,i,a,s,o)}function kp(t){return new bd(t)}function O0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function O2(t){return t.collectionGroup!==null}function Mo(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new At(Ft.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new pu(a,n))}),r.has(Ft.keyField().canonicalString())||e.Ie.push(new pu(Ft.keyField(),n))}return e.Ie}function gn(t){const e=ge(t);return e.Ee||(e.Ee=R2(e,Mo(t))),e.Ee}function R2(t,e){if(t.limitType==="F")return j0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new pu(i.field,a)});const r=t.endAt?new mu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new mu(t.startAt.position,t.startAt.inclusive):null;return j0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Zf(t,e,r){return new bd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function xd(t,e){return Cp(gn(t),gn(e))&&t.limitType===e.limitType}function f1(t){return`${Pp(gn(t))}|lt:${t.limitType}`}function ls(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>d1(i)).join(", ")}]`),yd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Is(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Is(i)).join(",")),`Target(${n})`}(gn(t))}; limitType=${t.limitType})`}function wd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ae.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Mo(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,l){const c=k0(s,o,l);return s.inclusive?c<=0:c<0}(n.startAt,Mo(n),i)||n.endAt&&!function(s,o,l){const c=k0(s,o,l);return s.inclusive?c>=0:c>0}(n.endAt,Mo(n),i))}(t,e)}function D2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function m1(t){return(e,r)=>{let n=!1;for(const i of Mo(t)){const a=M2(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function M2(t,e,r){const n=t.field.isKeyField()?ae.comparator(e.key,r.key):function(a,s,o){const l=s.data.field(a),c=o.data.field(a);return l!==null&&c!==null?Ss(l,c):ue(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Fa(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return QE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=new Qe(ae.comparator);function Qn(){return L2}const p1=new Qe(ae.comparator);function Io(...t){let e=p1;for(const r of t)e=e.insert(r.key,r);return e}function g1(t){let e=p1;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ua(){return Lo()}function y1(){return Lo()}function Lo(){return new Ua(t=>t.toString(),(t,e)=>t.isEqual(e))}const $2=new Qe(ae.comparator),V2=new At(ae.comparator);function Ee(...t){let e=V2;for(const r of t)e=e.add(r);return e}const z2=new At(we);function F2(){return z2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:du(e)?"-0":e}}function v1(t){return{integerValue:""+t}}function U2(t,e){return m2(e)?v1(e):Np(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this._=void 0}}function B2(t,e,r){return t instanceof gu?function(i,a){const s={fields:{[t1]:{stringValue:e1},[n1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Sp(a)&&(a=vd(a)),a&&(s.fields[r1]=a),{mapValue:s}}(r,e):t instanceof tl?x1(t,e):t instanceof rl?w1(t,e):function(i,a){const s=b1(i,a),o=R0(s)+R0(i.Ae);return Kf(s)&&Kf(i.Ae)?v1(o):Np(i.serializer,o)}(t,e)}function H2(t,e,r){return t instanceof tl?x1(t,e):t instanceof rl?w1(t,e):r}function b1(t,e){return t instanceof yu?function(n){return Kf(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class gu extends _d{}class tl extends _d{constructor(e){super(),this.elements=e}}function x1(t,e){const r=_1(e);for(const n of t.elements)r.some(i=>En(i,n))||r.push(n);return{arrayValue:{values:r}}}class rl extends _d{constructor(e){super(),this.elements=e}}function w1(t,e){let r=_1(e);for(const n of t.elements)r=r.filter(i=>!En(i,n));return{arrayValue:{values:r}}}class yu extends _d{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function R0(t){return lt(t.integerValue||t.doubleValue)}function _1(t){return Ip(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function W2(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof tl&&i instanceof tl||n instanceof rl&&i instanceof rl?As(n.elements,i.elements,En):n instanceof yu&&i instanceof yu?En(n.Ae,i.Ae):n instanceof gu&&i instanceof gu}(t.transform,e.transform)}class q2{constructor(e,r){this.version=e,this.transformResults=r}}class Hn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Hn}static exists(e){return new Hn(void 0,e)}static updateTime(e){return new Hn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ed{}function E1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new A1(t.key,Hn.none()):new Al(t.key,t.data,Hn.none());{const r=t.data,n=Dr.empty();let i=new At(Ft.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new Ba(t.key,n,new Xr(i.toArray()),Hn.none())}}function K2(t,e,r){t instanceof Al?function(i,a,s){const o=i.value.clone(),l=M0(i.fieldTransforms,a,s.transformResults);o.setAll(l),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ba?function(i,a,s){if(!Wc(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=M0(i.fieldTransforms,a,s.transformResults),l=a.data;l.setAll(T1(i)),l.setAll(o),a.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function $o(t,e,r,n){return t instanceof Al?function(a,s,o,l){if(!Wc(a.precondition,s))return o;const c=a.value.clone(),u=L0(a.fieldTransforms,l,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ba?function(a,s,o,l){if(!Wc(a.precondition,s))return o;const c=L0(a.fieldTransforms,l,s),u=s.data;return u.setAll(T1(a)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return Wc(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function G2(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=b1(n.transform,i||null);a!=null&&(r===null&&(r=Dr.empty()),r.set(n.field,a))}return r||null}function D0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&As(n,i,(a,s)=>W2(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Al extends Ed{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ba extends Ed{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function T1(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function M0(t,e,r){const n=new Map;Ne(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,H2(s,o,r[i]))}return n}function L0(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,B2(a,s,e))}return n}class A1 extends Ed{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Y2 extends Ed{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&K2(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=$o(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=$o(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=y1();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const l=E1(s,o);l!==null&&n.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ee())}isEqual(e){return this.batchId===e.batchId&&As(this.mutations,e.mutations,(r,n)=>D0(r,n))&&As(this.baseMutations,e.baseMutations,(r,n)=>D0(r,n))}}class jp{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ne(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return $2}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new jp(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Ae;function J2(t){switch(t){case U.OK:return ue(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function S1(t){if(t===void 0)return Xn("GRPC error has no .code"),U.UNKNOWN;switch(t){case mt.OK:return U.OK;case mt.CANCELLED:return U.CANCELLED;case mt.UNKNOWN:return U.UNKNOWN;case mt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case mt.INTERNAL:return U.INTERNAL;case mt.UNAVAILABLE:return U.UNAVAILABLE;case mt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case mt.NOT_FOUND:return U.NOT_FOUND;case mt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case mt.ABORTED:return U.ABORTED;case mt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case mt.DATA_LOSS:return U.DATA_LOSS;default:return ue(39323,{code:t})}}(Ae=mt||(mt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new Pi([4294967295,4294967295],0);function $0(t){const e=eD().encode(t),r=new UE;return r.update(e),new Uint8Array(r.digest())}function V0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Pi([r,n],0),new Pi([i,a],0)]}class Op{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Po(`Invalid padding: ${r}`);if(n<0)throw new Po(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Po(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Po(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Pi.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Pi.fromNumber(n)));return i.compare(tD)===1&&(i=new Pi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=$0(e),[n,i]=V0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new Op(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=$0(e),[n,i]=V0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Po extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Sl.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Td(fe.min(),i,new Qe(we),Qn(),Ee())}}class Sl{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Sl(n,r,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class I1{constructor(e,r){this.targetId=e,this.Ce=r}}class P1{constructor(e,r,n=Bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class z0{constructor(){this.ve=0,this.Fe=F0(),this.Me=Bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),r=Ee(),n=Ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ue(38017,{changeType:a})}}),new Sl(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=F0()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class rD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qn(),this.Je=mc(),this.He=mc(),this.Ye=new Qe(we)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(Yf(a))if(n===0){const s=new ae(a.path);this.et(r,s,Qt.newNoDocument(s,fe.min()))}else Ne(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),l=o?this.ct(o,e,s):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=Di(n).toUint8Array()}catch(l){if(l instanceof JE)return Ts("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Op(s,i,a)}catch(l){return Ts(l instanceof Po?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&Yf(o.target)){const l=new ae(o.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,Qt.newNoDocument(l,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=Ee();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new Td(e,r,this.Ye,this.je,n);return this.je=Qn(),this.Je=mc(),this.He=mc(),this.Ye=new Qe(we),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new z0,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new At(we),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new At(we),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Y("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new z0),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function mc(){return new Qe(ae.comparator)}function F0(){return new Qe(ae.comparator)}const nD={asc:"ASCENDING",desc:"DESCENDING"},iD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aD={and:"AND",or:"OR"};class sD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Xf(t,e){return t.useProto3Json||yd(e)?e:{value:e}}function vu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function C1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function oD(t,e){return vu(t,e.toTimestamp())}function yn(t){return Ne(!!t,49232),fe.fromTimestamp(function(r){const n=Ri(r);return new qe(n.seconds,n.nanos)}(t))}function Rp(t,e){return Qf(t,e).canonicalString()}function Qf(t,e){const r=function(i){return new Xe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function k1(t){const e=Xe.fromString(t);return Ne(D1(e),10190,{key:e.toString()}),e}function Jf(t,e){return Rp(t.databaseId,e.path)}function Zh(t,e){const r=k1(e);if(r.get(1)!==t.databaseId.projectId)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ae(j1(r))}function N1(t,e){return Rp(t.databaseId,e)}function lD(t){const e=k1(t);return e.length===4?Xe.emptyPath():j1(e)}function em(t){return new Xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function j1(t){return Ne(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function U0(t,e,r){return{name:Jf(t,e),fields:r.value.mapValue.fields}}function cD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(Ne(u===void 0||typeof u=="string",58123),Bt.fromBase64String(u||"")):(Ne(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Bt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(c){const u=c.code===void 0?U.UNKNOWN:S1(c.code);return new re(u,c.message||"")}(s);r=new P1(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Zh(t,n.document.name),a=yn(n.document.updateTime),s=n.document.createTime?yn(n.document.createTime):fe.min(),o=new Dr({mapValue:{fields:n.document.fields}}),l=Qt.newFoundDocument(i,a,s,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new qc(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Zh(t,n.document),a=n.readTime?yn(n.readTime):fe.min(),s=Qt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new qc([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Zh(t,n.document),a=n.removedTargetIds||[];r=new qc([],a,i,null)}else{if(!("filter"in e))return ue(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new Q2(i,a),o=n.targetId;r=new I1(o,s)}}return r}function uD(t,e){let r;if(e instanceof Al)r={update:U0(t,e.key,e.value)};else if(e instanceof A1)r={delete:Jf(t,e.key)};else if(e instanceof Ba)r={update:U0(t,e.key,e.data),updateMask:bD(e.fieldMask)};else{if(!(e instanceof Y2))return ue(16599,{Vt:e.type});r={verify:Jf(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof gu)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof tl)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof rl)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof yu)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw ue(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:oD(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ue(27497)}(t,e.precondition)),r}function dD(t,e){return t&&t.length>0?(Ne(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?yn(i.updateTime):yn(a);return s.isEqual(fe.min())&&(s=yn(a)),new q2(s,i.transformResults||[])}(r,e))):[]}function hD(t,e){return{documents:[N1(t,e.path)]}}function fD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=N1(t,i);const a=function(c){if(c.length!==0)return R1(Tn.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:cs(m.field),direction:gD(m.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=Xf(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:i}}function mD(t){let e=lD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ne(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=O1(h);return m instanceof Tn&&c1(m)?m.getFilters():[m]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(m=>function(v){return new pu(us(v.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,yd(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new mu(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new mu(p,m)}(r.endAt)),j2(e,i,s,a,o,"F",l,c)}function pD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function O1(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=us(r.unaryFilter.field);return _t.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=us(r.unaryFilter.field);return _t.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=us(r.unaryFilter.field);return _t.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=us(r.unaryFilter.field);return _t.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(r){return _t.create(us(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Tn.create(r.compositeFilter.filters.map(n=>O1(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(r.compositeFilter.op))}(t):ue(30097,{filter:t})}function gD(t){return nD[t]}function yD(t){return iD[t]}function vD(t){return aD[t]}function cs(t){return{fieldPath:t.canonicalString()}}function us(t){return Ft.fromServerFormat(t.fieldPath)}function R1(t){return t instanceof _t?function(r){if(r.op==="=="){if(C0(r.value))return{unaryFilter:{field:cs(r.field),op:"IS_NAN"}};if(P0(r.value))return{unaryFilter:{field:cs(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(C0(r.value))return{unaryFilter:{field:cs(r.field),op:"IS_NOT_NAN"}};if(P0(r.value))return{unaryFilter:{field:cs(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(r.field),op:yD(r.op),value:r.value}}}(t):t instanceof Tn?function(r){const n=r.getFilters().map(i=>R1(i));return n.length===1?n[0]:{compositeFilter:{op:vD(r.op),filters:n}}}(t):ue(54877,{filter:t})}function bD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function D1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r,n,i,a=fe.min(),s=fe.min(),o=Bt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ti(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.yt=e}}function wD(t){const e=mD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(){this.Cn=new ED}addToCollectionParentIndex(e,r){return this.Cn.add(r),F.resolve()}getCollectionParents(e,r){return F.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return F.resolve()}deleteFieldIndex(e,r){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,r){return F.resolve()}getDocumentsMatchingTarget(e,r){return F.resolve(null)}getIndexType(e,r){return F.resolve(0)}getFieldIndexes(e,r){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,r){return F.resolve(Oi.min())}getMinOffsetFromCollectionGroup(e,r){return F.resolve(Oi.min())}updateCollectionGroup(e,r,n){return F.resolve()}updateIndexEntries(e,r){return F.resolve()}}class ED{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new At(Xe.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new At(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},M1=41943040;class cr{static withCacheSize(e){return new cr(e,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cr.DEFAULT_COLLECTION_PERCENTILE=10,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cr.DEFAULT=new cr(M1,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cr.DISABLED=new cr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ps(0)}static cr(){return new Ps(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="LruGarbageCollector",TD=1048576;function W0([t,e],[r,n]){const i=we(t,r);return i===0?we(e,n):i}class AD{constructor(e){this.Ir=e,this.buffer=new At(W0),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();W0(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class SD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(H0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){zs(r)?Y(H0,"Ignoring IndexedDB error during garbage collection: ",r):await Vs(r)}await this.Vr(3e5)})}}class ID{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return F.resolve(gd.ce);const n=new AD(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(B0)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),B0):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),os()<=xe.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function PD(t,e){return new ID(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.changes=new Ua(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Qt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?F.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&$o(n.mutation,i,Xr.empty(),qe.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ee()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ee()){const i=ua();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=Io();return a.forEach((o,l)=>{s=s.insert(o,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=ua();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ee()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=Qn();const s=Lo(),o=function(){return Lo()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ba)?a=a.insert(c.key,c):u!==void 0?(s.set(c.key,u.mutation.getFieldMask()),$o(u.mutation,c,u.mutation.getFieldMask(),qe.now())):s.set(c.key,Xr.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,u)=>s.set(c,u)),r.forEach((c,u)=>o.set(c,new kD(u,s.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Lo();let i=new Qe((s,o)=>s-o),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Xr.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(i.get(o.batchId)||Ee()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=y1();u.forEach(m=>{if(!a.has(m)){const p=E1(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return F.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ae.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):O2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):F.resolve(ua());let o=Xo,l=a;return s.next(c=>F.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?F.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,Ee())).next(u=>({batchId:o,changes:g1(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ae(r)).next(n=>{let i=Io();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=Io();return this.indexManager.getCollectionParents(e,a).next(o=>F.forEach(o,l=>{const c=function(h,m){return new bd(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((h,m)=>{s=s.insert(h,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((l,c)=>{const u=c.getKey();s.get(u)===null&&(s=s.insert(u,Qt.newInvalidDocument(u)))});let o=Io();return s.forEach((l,c)=>{const u=a.get(l);u!==void 0&&$o(u.mutation,c,Xr.empty(),qe.now()),wd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return F.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:yn(i.createTime)}}(r)),F.resolve()}getNamedQuery(e,r){return F.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:wD(i.bundledQuery),readTime:yn(i.readTime)}}(r)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.overlays=new Qe(ae.comparator),this.qr=new Map}getOverlay(e,r){return F.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ua();return F.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),F.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),F.resolve()}getOverlaysForCollection(e,r,n){const i=ua(),a=r.length+1,s=new ae(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&i.set(l.getKey(),l)}return F.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Qe((c,u)=>c-u);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=ua(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=ua(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return F.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new X2(r,n));let a=this.qr.get(r);a===void 0&&(a=Ee(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.Qr=new At(It.$r),this.Ur=new At(It.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new It(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new It(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1);let a=Ee();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new It(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class It{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ae.comparator(e.key,r.key)||we(e.Yr,r.Yr)}static Kr(e,r){return we(e.Yr,r.Yr)||ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new At(It.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Z2(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new It(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return F.resolve(s)}lookupMutationBatch(e,r){return F.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return F.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Ap:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new It(r,0),i=new It(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),F.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new At(we);return r.forEach(i=>{const a=new It(i,0),s=new It(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),F.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;ae.isDocumentKey(a)||(a=a.child(""));const s=new It(new ae(a),0);let o=new At(we);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)},s),F.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ne(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return F.forEach(r.mutations,i=>{const a=new It(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new It(r,0),i=this.Zr.firstAfterOrEqual(n);return F.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e){this.ri=e,this.docs=function(){return new Qe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return F.resolve(n?n.document.mutableCopy():Qt.newInvalidDocument(r))}getEntries(e,r){let n=Qn();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Qt.newInvalidDocument(i))}),F.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Qn();const s=r.path,o=new ae(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||u2(c2(u),n)<=0||(i.has(u.key)||wd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return F.resolve(a)}getAllFromCollectionGroup(e,r,n,i){ue(9500)}ii(e,r){return F.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new LD(this)}getSize(e){return F.resolve(this.size)}}class LD extends CD{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),F.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(e){this.persistence=e,this.si=new Ua(r=>Pp(r),Cp),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Dp,this.targetCount=0,this.ai=Ps.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),F.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ps(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,F.resolve()}updateTargetData(e,r){return this.Pr(r),F.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),F.waitFor(a).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return F.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),F.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),F.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),F.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return F.resolve(n)}containsKey(e,r){return F.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.ui={},this.overlays={},this.ci=new gd(0),this.li=!1,this.li=!0,this.hi=new RD,this.referenceDelegate=e(this),this.Pi=new $D(this),this.indexManager=new _D,this.remoteDocumentCache=function(i){return new MD(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new xD(r),this.Ii=new jD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new OD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new DD(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Y("MemoryPersistence","Starting transaction:",e);const i=new VD(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return F.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class VD extends h2{constructor(e){super(),this.currentSequenceNumber=e}}class Mp{constructor(e){this.persistence=e,this.Ri=new Dp,this.Vi=null}static mi(e){return new Mp(e)}get fi(){if(this.Vi)return this.Vi;throw ue(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),F.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),F.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),F.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,n=>{const i=ae.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return F.or([()=>F.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class bu{constructor(e,r){this.persistence=e,this.pi=new Ua(n=>p2(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=PD(this,r)}static mi(e,r){return new bu(e,r)}Ei(){}di(e){return F.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return F.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?F.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,fe.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Bc(e.data.value)),r}br(e,r,n){return F.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return F.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ee(),i=Ee();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Lp(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return pN()?8:f2(tr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new zD;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(os()<=xe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",ls(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(os()<=xe.DEBUG&&Y("QueryEngine","Query:",ls(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(os()<=xe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",ls(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gn(r))):F.resolve())}ys(e,r){if(O0(r))return F.resolve(null);let n=gn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Zf(r,null,"F"),n=gn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=Ee(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,s,l.readTime)?this.ys(e,Zf(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,i){return O0(r)||i.isEqual(fe.min())?F.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?F.resolve(null):(os()<=xe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ls(r)),this.vs(e,s,r,l2(i,Xo)).next(o=>o))})}Ds(e,r){let n=new At(m1(e));return r.forEach((i,a)=>{wd(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return os()<=xe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",ls(r)),this.ps.getDocumentsMatchingQuery(e,r,Oi.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="LocalStore",UD=3e8;class BD{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Qe(we),this.xs=new Ua(a=>Pp(a),Cp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ND(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function HD(t,e,r,n){return new BD(t,e,r,n)}async function $1(t,e){const r=ge(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let l=Ee();for(const c of i){s.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:s,addedBatchIds:o}))})})}function WD(t,e){const r=ge(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,m=h.keys();let p=F.resolve();return m.forEach(v=>{p=p.next(()=>u.getEntry(l,v)).next(b=>{const g=c.docVersions.get(v);Ne(g!==null,48541),b.version.compareTo(g)<0&&(h.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),u.addEntry(b)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ee();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function V1(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function qD(t,e){const r=ge(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const m=i.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Bt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(b,g,_){return b.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=UD?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,u)&&o.push(r.Pi.updateTargetData(a,p))});let l=Qn(),c=Ee();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(KD(a,s,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!n.isEqual(fe.min())){const u=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return F.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=i,a))}function KD(t,e,r){let n=Ee(),i=Ee();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=Qn();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(o,l.readTime),s=s.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(o,l)):Y($p,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:s,qs:i}})}function GD(t,e){const r=ge(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Ap),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function YD(t,e){const r=ge(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,F.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ti(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function tm(t,e,r){const n=ge(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!zs(s))throw s;Y($p,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function q0(t,e,r){const n=ge(t);let i=fe.min(),a=Ee();return n.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,u){const h=ge(l),m=h.xs.get(u);return m!==void 0?F.resolve(h.Ms.get(m)):h.Pi.getTargetData(c,u)}(n,s,gn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:fe.min(),r?a:Ee())).next(o=>(ZD(n,D2(e),o),{documents:o,Qs:a})))}function ZD(t,e,r){let n=t.Os.get(e)||fe.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class K0{constructor(){this.activeTargetIds=F2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XD{constructor(){this.Mo=new K0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new K0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0="ConnectivityMonitor";class Y0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(G0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(G0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pc=null;function rm(){return pc===null?pc=function(){return 268435456+Math.round(2147483648*Math.random())}():pc++,"0x"+pc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh="RestConnection",JD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class eM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===hu?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=rm(),o=this.zo(e,r.toUriEncodedString());Y(Xh,`Sending RPC '${e}' ${s}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,a);const{host:c}=new URL(o),u=$a(c);return this.Jo(e,o,l,n,u).then(h=>(Y(Xh,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Ts(Xh,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$s}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=JD[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class rM extends eM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=rm();return new Promise((o,l)=>{const c=new BE;c.setWithCredentials(!0),c.listenOnce(HE.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Uc.NO_ERROR:const h=c.getResponseJson();Y(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Uc.TIMEOUT:Y(Yt,`RPC '${e}' ${s} timed out`),l(new re(U.DEADLINE_EXCEEDED,"Request time out"));break;case Uc.HTTP_ERROR:const m=c.getStatus();if(Y(Yt,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p?.error;if(v&&v.status&&v.message){const b=function(_){const T=_.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(T)>=0?T:U.UNKNOWN}(v.status);l(new re(b,v.message))}else l(new re(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new re(U.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Y(Yt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Y(Yt,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",u,n,15)})}T_(e,r,n){const i=rm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=KE(),o=qE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");Y(Yt,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=s.createWebChannel(u,l);this.I_(h);let m=!1,p=!1;const v=new tM({Yo:g=>{p?Y(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(m||(Y(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Y(Yt,`RPC '${e}' stream ${i} sending:`,g),h.send(g))},Zo:()=>h.close()}),b=(g,_,T)=>{g.listen(_,E=>{try{T(E)}catch(j){setTimeout(()=>{throw j},0)}})};return b(h,So.EventType.OPEN,()=>{p||(Y(Yt,`RPC '${e}' stream ${i} transport opened.`),v.o_())}),b(h,So.EventType.CLOSE,()=>{p||(p=!0,Y(Yt,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))}),b(h,So.EventType.ERROR,g=>{p||(p=!0,Ts(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,g.name,"Message:",g.message),v.a_(new re(U.UNAVAILABLE,"The operation could not be completed")))}),b(h,So.EventType.MESSAGE,g=>{if(!p){const _=g.data[0];Ne(!!_,16349);const T=_,E=T?.error||T[0]?.error;if(E){Y(Yt,`RPC '${e}' stream ${i} received error:`,E);const j=E.status;let R=function(A){const P=mt[A];if(P!==void 0)return S1(P)}(j),D=E.message;R===void 0&&(R=U.INTERNAL,D="Unknown error status: "+j+" with message "+E.message),p=!0,v.a_(new re(R,D)),h.close()}else Y(Yt,`RPC '${e}' stream ${i} received:`,_),v.u_(_)}}),b(o,WE.STAT_EVENT,g=>{g.stat===Hf.PROXY?Y(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===Hf.NOPROXY&&Y(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Qh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){return new sD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="PersistentStream";class F1{constructor(e,r,n,i,a,s,o,l){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new z1(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===U.RESOURCE_EXHAUSTED?(Xn(r.toString()),Xn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new re(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(Z0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Y(Z0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nM extends F1{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=cD(this.serializer,e),n=function(a){if(!("targetChange"in a))return fe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?fe.min():s.readTime?yn(s.readTime):fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=em(this.serializer),r.addTarget=function(a,s){let o;const l=s.target;if(o=Yf(l)?{documents:hD(a,l)}:{query:fD(a,l).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=C1(a,s.resumeToken);const c=Xf(a,s.expectedCount);c!==null&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(fe.min())>0){o.readTime=vu(a,s.snapshotVersion.toTimestamp());const c=Xf(a,s.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=pD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=em(this.serializer),r.removeTarget=e,this.q_(r)}}class iM extends F1{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=dD(e.writeResults,e.commitTime),n=yn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=em(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>uD(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{}class sM extends aM{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,Qf(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new re(U.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,Qf(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(U.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class oM{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xn(r),this.aa=!1):Y("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja="RemoteStore";class lM{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ha(this)&&(Y(ja,"Restarting streams for network reachability change."),await async function(l){const c=ge(l);c.Ea.add(4),await Il(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Sd(c)}(this))})}),this.Ra=new oM(n,i)}}async function Sd(t){if(Ha(t))for(const e of t.da)await e(!0)}async function Il(t){for(const e of t.da)await e(!1)}function U1(t,e){const r=ge(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Up(r)?Fp(r):Fs(r).O_()&&zp(r,e))}function Vp(t,e){const r=ge(t),n=Fs(r);r.Ia.delete(e),n.O_()&&B1(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ha(r)&&r.Ra.set("Unknown"))}function zp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fs(t).Y_(e)}function B1(t,e){t.Va.Ue(e),Fs(t).Z_(e)}function Fp(t){t.Va=new rD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fs(t).start(),t.Ra.ua()}function Up(t){return Ha(t)&&!Fs(t).x_()&&t.Ia.size>0}function Ha(t){return ge(t).Ea.size===0}function H1(t){t.Va=void 0}async function cM(t){t.Ra.set("Online")}async function uM(t){t.Ia.forEach((e,r)=>{zp(t,e)})}async function dM(t,e){H1(t),Up(t)?(t.Ra.ha(e),Fp(t)):t.Ra.set("Unknown")}async function hM(t,e,r){if(t.Ra.set("Online"),e instanceof P1&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Y(ja,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xu(t,n)}else if(e instanceof qc?t.Va.Ze(e):e instanceof I1?t.Va.st(e):t.Va.tt(e),!r.isEqual(fe.min()))try{const n=await V1(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.Ia.get(c);u&&a.Ia.set(c,u.withResumeToken(l.resumeToken,s))}}),o.targetMismatches.forEach((l,c)=>{const u=a.Ia.get(l);if(!u)return;a.Ia.set(l,u.withResumeToken(Bt.EMPTY_BYTE_STRING,u.snapshotVersion)),B1(a,l);const h=new Ti(u.target,l,c,u.sequenceNumber);zp(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Y(ja,"Failed to raise snapshot:",n),await xu(t,n)}}async function xu(t,e,r){if(!zs(e))throw e;t.Ea.add(1),await Il(t),t.Ra.set("Offline"),r||(r=()=>V1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(ja,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Sd(t)})}function W1(t,e){return e().catch(r=>xu(t,r,e))}async function Id(t){const e=ge(t),r=Li(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ap;for(;fM(e);)try{const i=await GD(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,mM(e,i)}catch(i){await xu(e,i)}q1(e)&&K1(e)}function fM(t){return Ha(t)&&t.Ta.length<10}function mM(t,e){t.Ta.push(e);const r=Li(t);r.O_()&&r.X_&&r.ea(e.mutations)}function q1(t){return Ha(t)&&!Li(t).x_()&&t.Ta.length>0}function K1(t){Li(t).start()}async function pM(t){Li(t).ra()}async function gM(t){const e=Li(t);for(const r of t.Ta)e.ea(r.mutations)}async function yM(t,e,r){const n=t.Ta.shift(),i=jp.from(n,e,r);await W1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Id(t)}async function vM(t,e){e&&Li(t).X_&&await async function(n,i){if(function(s){return J2(s)&&s!==U.ABORTED}(i.code)){const a=n.Ta.shift();Li(n).B_(),await W1(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Id(n)}}(t,e),q1(t)&&K1(t)}async function X0(t,e){const r=ge(t);r.asyncQueue.verifyOperationInProgress(),Y(ja,"RemoteStore received new credentials");const n=Ha(r);r.Ea.add(3),await Il(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Sd(r)}async function bM(t,e){const r=ge(t);e?(r.Ea.delete(2),await Sd(r)):e||(r.Ea.add(2),await Il(r),r.Ra.set("Unknown"))}function Fs(t){return t.ma||(t.ma=function(r,n,i){const a=ge(r);return a.sa(),new nM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:cM.bind(null,t),t_:uM.bind(null,t),r_:dM.bind(null,t),H_:hM.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Up(t)?Fp(t):t.Ra.set("Unknown")):(await t.ma.stop(),H1(t))})),t.ma}function Li(t){return t.fa||(t.fa=function(r,n,i){const a=ge(r);return a.sa(),new iM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:pM.bind(null,t),r_:vM.bind(null,t),ta:gM.bind(null,t),na:yM.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Id(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(ja,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new Bp(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hp(t,e){if(Xn("AsyncQueue",`${e}: ${t}`),zs(t))return new re(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{static emptySet(e){return new vs(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ae.comparator(r.key,n.key):(r,n)=>ae.comparator(r.key,n.key),this.keyedMap=Io(),this.sortedSet=new Qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof vs)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new vs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(){this.ga=new Qe(ae.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ue(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Cs{constructor(e,r,n,i,a,s,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Cs(e,r,vs.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wM{constructor(){this.queries=J0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ge(r),a=i.queries;i.queries=J0(),a.forEach((s,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new re(U.ABORTED,"Firestore shutting down"))}}function J0(){return new Ua(t=>f1(t),xd)}async function _M(t,e){const r=ge(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new xM,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=Hp(s,`Initialization of query '${ls(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&Wp(r)}async function EM(t,e){const r=ge(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function TM(t,e){const r=ge(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&Wp(r)}function AM(t,e,r){const n=ge(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function Wp(t){t.Ca.forEach(e=>{e.next()})}var nm,eb;(eb=nm||(nm={})).Ma="default",eb.Cache="cache";class SM{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Cs(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Cs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.key=e}}class Y1{constructor(e){this.key=e}}class IM{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=m1(e),this.tu=new vs(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Q0,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const m=i.get(u),p=wd(this.query,h)?h:null,v=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;m&&p?m.data.isEqual(p.data)?v!==b&&(n.track({type:3,doc:p}),g=!0):this.su(m,p)||(n.track({type:2,doc:p}),g=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),g=!0):m&&!p&&(n.track({type:1,doc:m}),g=!0,(l||c)&&(o=!0)),g&&(p?(s=s.add(p),a=b?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(p,v){const b=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Rt:g})}};return b(p)-b(v)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,s.length!==0||c?{snapshot:new Cs(this.query,e.tu,a,s,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Q0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Y1(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new G1(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ee();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Cs.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const qp="SyncEngine";class PM{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class CM{constructor(e){this.key=e,this.hu=!1}}class kM{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ua(o=>f1(o),xd),this.Iu=new Map,this.Eu=new Set,this.du=new Qe(ae.comparator),this.Au=new Map,this.Ru=new Dp,this.Vu={},this.mu=new Map,this.fu=Ps.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function NM(t,e,r=!0){const n=tT(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await Z1(n,e,r,!0),i}async function jM(t,e){const r=tT(t);await Z1(r,e,!0,!1)}async function Z1(t,e,r,n){const i=await YD(t.localStore,gn(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await OM(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&U1(t.remoteStore,i),o}async function OM(t,e,r,n,i){t.pu=(h,m,p)=>async function(b,g,_,T){let E=g.view.ru(_);E.Cs&&(E=await q0(b.localStore,g.query,!1).then(({documents:S})=>g.view.ru(S,E)));const j=T&&T.targetChanges.get(g.targetId),R=T&&T.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(E,b.isPrimaryClient,j,R);return rb(b,g.targetId,D.au),D.snapshot}(t,h,m,p);const a=await q0(t.localStore,e,!0),s=new IM(e,a.Qs),o=s.ru(a.documents),l=Sl.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=s.applyChanges(o,t.isPrimaryClient,l);rb(t,r,c.au);const u=new PM(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function RM(t,e,r){const n=ge(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!xd(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await tm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Vp(n.remoteStore,i.targetId),im(n,i.targetId)}).catch(Vs)):(im(n,i.targetId),await tm(n.localStore,i.targetId,!0))}async function DM(t,e){const r=ge(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Vp(r.remoteStore,n.targetId))}async function MM(t,e,r){const n=BM(t);try{const i=await function(s,o){const l=ge(s),c=qe.now(),u=o.reduce((p,v)=>p.add(v.key),Ee());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Qn(),b=Ee();return l.Ns.getEntries(p,u).next(g=>{v=g,v.forEach((_,T)=>{T.isValidDocument()||(b=b.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(g=>{h=g;const _=[];for(const T of o){const E=G2(T,h.get(T.key).overlayedDocument);E!=null&&_.push(new Ba(T.key,E,s1(E.value.mapValue),Hn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,_,o)}).next(g=>{m=g;const _=g.applyToLocalDocumentSet(h,b);return l.documentOverlayCache.saveOverlays(p,g.batchId,_)})}).then(()=>({batchId:m.batchId,changes:g1(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,l){let c=s.Vu[s.currentUser.toKey()];c||(c=new Qe(we)),c=c.insert(o,l),s.Vu[s.currentUser.toKey()]=c}(n,i.batchId,r),await Pl(n,i.changes),await Id(n.remoteStore)}catch(i){const a=Hp(i,"Failed to persist write");r.reject(a)}}async function X1(t,e){const r=ge(t);try{const n=await qD(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Ne(s.hu,14607):i.removedDocuments.size>0&&(Ne(s.hu,42227),s.hu=!1))}),await Pl(r,n,e)}catch(n){await Vs(n)}}function tb(t,e,r){const n=ge(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const l=ge(s);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(o)&&(c=!0)}),c&&Wp(l)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function LM(t,e,r){const n=ge(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new Qe(ae.comparator);s=s.insert(a,Qt.newNoDocument(a,fe.min()));const o=Ee().add(a),l=new Td(fe.min(),new Map,new Qe(we),s,o);await X1(n,l),n.du=n.du.remove(a),n.Au.delete(e),Kp(n)}else await tm(n.localStore,e,!1).then(()=>im(n,e,r)).catch(Vs)}async function $M(t,e){const r=ge(t),n=e.batch.batchId;try{const i=await WD(r.localStore,e);J1(r,n,null),Q1(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Pl(r,i)}catch(i){await Vs(i)}}async function VM(t,e,r){const n=ge(t);try{const i=await function(s,o){const l=ge(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Ne(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);J1(n,e,r),Q1(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Pl(n,i)}catch(i){await Vs(i)}}function Q1(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function J1(t,e,r){const n=ge(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function im(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||eT(t,n)})}function eT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Vp(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Kp(t))}function rb(t,e,r){for(const n of r)n instanceof G1?(t.Ru.addReference(n.key,e),zM(t,n)):n instanceof Y1?(Y(qp,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||eT(t,n.key)):ue(19791,{wu:n})}function zM(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Y(qp,"New document in limbo: "+r),t.Eu.add(n),Kp(t))}function Kp(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ae(Xe.fromString(e)),n=t.fu.next();t.Au.set(n,new CM(r)),t.du=t.du.insert(r,n),U1(t.remoteStore,new Ti(gn(kp(r.path)),n,"TargetPurposeLimboResolution",gd.ce))}}async function Pl(t,e,r){const n=ge(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{s.push(n.pu(l,e,r).then(c=>{if((c||r)&&n.isPrimaryClient){const u=c?!c.fromCache:r?.targetChanges.get(l.targetId)?.current;n.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);const u=Lp.As(l.targetId,c);a.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(l,c){const u=ge(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>F.forEach(c,m=>F.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>F.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!zs(h))throw h;Y($p,"Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),v=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,b)}}}(n.localStore,a))}async function FM(t,e){const r=ge(t);if(!r.currentUser.isEqual(e)){Y(qp,"User change. New user:",e.toKey());const n=await $1(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new re(U.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Pl(r,n.Ls)}}function UM(t,e){const r=ge(t),n=r.Au.get(e);if(n&&n.hu)return Ee().add(n.key);{let i=Ee();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}function tT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=X1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=UM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LM.bind(null,e),e.Pu.H_=TM.bind(null,e.eventManager),e.Pu.yu=AM.bind(null,e.eventManager),e}function BM(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$M.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VM.bind(null,e),e}class wu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ad(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return HD(this.persistence,new FD,e.initialUser,this.serializer)}Cu(e){return new L1(Mp.mi,this.serializer)}Du(e){return new XD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wu.provider={build:()=>new wu};class HM extends wu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ne(this.persistence.referenceDelegate instanceof bu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new SD(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?cr.withCacheSize(this.cacheSizeBytes):cr.DEFAULT;return new L1(n=>bu.mi(n,r),this.serializer)}}class am{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>tb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=FM.bind(null,this.syncEngine),await bM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new wM}()}createDatastore(e){const r=Ad(e.databaseInfo.databaseId),n=function(a){return new rM(a)}(e.databaseInfo);return function(a,s,o,l){return new sM(a,s,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new lM(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>tb(this.syncEngine,r,0),function(){return Y0.v()?new Y0:new QD}())}createSyncEngine(e,r){return function(i,a,s,o,l,c,u){const h=new kM(i,a,s,o,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ge(r);Y(ja,"RemoteStore shutting down."),n.Ea.add(5),await Il(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}am.provider={build:()=>new am};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i="FirestoreClient";class qM{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=Ep.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Y($i,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Y($i,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Hp(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Jh(t,e){t.asyncQueue.verifyOperationInProgress(),Y($i,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await $1(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nb(t,e){t.asyncQueue.verifyOperationInProgress();const r=await KM(t);Y($i,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>X0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>X0(e.remoteStore,i)),t._onlineComponents=e}async function KM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y($i,"Using user provided OfflineComponentProvider");try{await Jh(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ts("Error using user provided cache. Falling back to memory cache: "+r),await Jh(t,new wu)}}else Y($i,"Using default OfflineComponentProvider"),await Jh(t,new HM(void 0));return t._offlineComponents}async function rT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y($i,"Using user provided OnlineComponentProvider"),await nb(t,t._uninitializedComponentsProvider._online)):(Y($i,"Using default OnlineComponentProvider"),await nb(t,new am))),t._onlineComponents}function GM(t){return rT(t).then(e=>e.syncEngine)}async function YM(t){const e=await rT(t),r=e.eventManager;return r.onListen=NM.bind(null,e.syncEngine),r.onUnlisten=RM.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=jM.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=DM.bind(null,e.syncEngine),r}function ZM(t,e,r={}){const n=new Ci;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new WM({next:m=>{u.Nu(),s.enqueueAndForget(()=>EM(a,h));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new re(U.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new re(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new SM(kp(o.path),u,{includeMetadataChanges:!0,qa:!0});return _M(a,h)}(await YM(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="firestore.googleapis.com",ab=!0;class sb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iT,this.ssl=ab}else this.host=e.host,this.ssl=e.ssl??ab;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=M1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TD)throw new re(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nT(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Gp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new ZR;switch(n.type){case"firstParty":return new e2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new re(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=ib.get(r);n&&(Y("ComponentProvider","Removing Datastore"),ib.delete(r),n.terminate())}(this),Promise.resolve()}}function XM(t,e,r,n={}){t=Zo(t,Gp);const i=$a(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(cp(`https://${o}`),up("Firestore",!0)),a.host!==iT&&a.host!==o&&Ts("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:i,emulatorOptions:n};if(!Ia(l,s)&&(t._setSettings(l),n.mockUserToken)){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=Xt.MOCK_USER;else{c=rE(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new re(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Xt(h)}t._authCredentials=new XR(new YE(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yp(this.firestore,e,this._query)}}class Ct{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ct(this.firestore,e,this._key)}toJSON(){return{type:Ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Tl(r,Ct._jsonSchema))return new Ct(e,n||null,new ae(Xe.fromString(r.referencePath)))}}Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:pt("string",Ct._jsonSchemaVersion),referencePath:pt("string")};class nl extends Yp{constructor(e,r,n){super(e,r,kp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new ae(e))}withConverter(e){return new nl(this.firestore,e,this._path)}}function ob(t,e,...r){if(t=dr(t),arguments.length===1&&(e=Ep.newId()),s2("doc","path",e),t instanceof Gp){const n=Xe.fromString(e,...r);return x0(n),new Ct(t,null,new ae(n))}{if(!(t instanceof Ct||t instanceof nl))throw new re(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Xe.fromString(e,...r));return x0(n),new Ct(t.firestore,t instanceof nl?t.converter:null,new ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb="AsyncQueue";class cb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new z1(this,"async_queue_retry"),this._c=()=>{const n=Qh();n&&Y(lb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Qh();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Qh();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ci;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!zs(e))throw e;Y(lb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Xn("INTERNAL UNHANDLED ERROR: ",ub(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Bp.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:ub(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function ub(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Zp extends Gp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new cb,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cb(e),this._firestoreClient=void 0,await e}}}function QM(t,e){const r=typeof t=="object"?t:fp(),n=typeof t=="string"?t:hu,i=hd(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=J_("firestore");a&&XM(i,...a)}return i}function aT(t){if(t._terminated)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||JM(t),t._firestoreClient}function JM(t){const e=t._freezeSettings(),r=function(i,a,s,o){return new v2(i,a,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,nT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new qM(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(Bt.fromBase64String(e))}catch(r){throw new re(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Mr(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Tl(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:pt("string",Mr._jsonSchemaVersion),bytes:pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new re(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new re(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new re(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vn._jsonSchemaVersion}}static fromJSON(e){if(Tl(e,vn._jsonSchema))return new vn(e.latitude,e.longitude)}}vn._jsonSchemaVersion="firestore/geoPoint/1.0",vn._jsonSchema={type:pt("string",vn._jsonSchemaVersion),latitude:pt("number"),longitude:pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:bn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Tl(e,bn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new bn(e.vectorValues);throw new re(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bn._jsonSchemaVersion="firestore/vectorValue/1.0",bn._jsonSchema={type:pt("string",bn._jsonSchemaVersion),vectorValues:pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL=/^__.*__$/;class tL{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ba(e,this.data,this.fieldMask,r,this.fieldTransforms):new Al(e,this.data,r,this.fieldTransforms)}}function oT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ac:t})}}class Qp{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return _u(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oT(this.Ac)&&eL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class rL{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ad(e)}Cc(e,r,n,i=!1){return new Qp({Ac:e,methodName:r,Dc:n,path:Ft.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nL(t){const e=t._freezeSettings(),r=Ad(t._databaseId);return new rL(t._databaseId,!!e.ignoreUndefinedProperties,r)}function iL(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);dT("Data must be an object, but it was:",s,n);const o=cT(n,s);let l,c;if(a.merge)l=new Xr(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=aL(e,h,r);if(!s.contains(m))throw new re(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);oL(u,m)||u.push(m)}l=new Xr(u),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new tL(new Dr(o),l,c)}function lT(t,e){if(uT(t=dr(t)))return dT("Unsupported field value:",e,t),cT(t,e);if(t instanceof sT)return function(n,i){if(!oT(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let l=lT(o,i.wc(s));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return U2(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=qe.fromDate(n);return{timestampValue:vu(i.serializer,a)}}if(n instanceof qe){const a=new qe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vu(i.serializer,a)}}if(n instanceof vn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Mr)return{bytesValue:C1(i.serializer,n._byteString)};if(n instanceof Ct){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Rp(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof bn)return function(s,o){return{mapValue:{fields:{[i1]:{stringValue:a1},[fu]:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return Np(o.serializer,c)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Tp(n)}`)}(t,e)}function cT(t,e){const r={};return QE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fa(t,(n,i)=>{const a=lT(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function uT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof vn||t instanceof Mr||t instanceof Ct||t instanceof sT||t instanceof bn)}function dT(t,e,r){if(!uT(r)||!ZE(r)){const n=Tp(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function aL(t,e,r){if((e=dr(e))instanceof Xp)return e._internalPath;if(typeof e=="string")return hT(t,e);throw _u("Field path arguments must be of type string or ",t,!1,void 0,r)}const sL=new RegExp("[~\\*/\\[\\]]");function hT(t,e,r){if(e.search(sL)>=0)throw _u(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Xp(...e.split("."))._internalPath}catch{throw _u(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function _u(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${n}`),s&&(l+=` in document ${i}`),l+=")"),new re(U.INVALID_ARGUMENT,o+t+l)}function oL(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(mT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class lL extends fT{data(){return super.data()}}function mT(t,e){return typeof e=="string"?hT(t,e):e instanceof Xp?e._internalPath:e._delegate._internalPath}class cL{convertValue(e,r="none"){switch(Mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Di(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Fa(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){const r=e.fields?.[fu].arrayValue?.values?.map(n=>lt(n.doubleValue));return new bn(r)}convertGeoPoint(e){return new vn(lt(e.latitude),lt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=vd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Qo(e));default:return null}}convertTimestamp(e){const r=Ri(e);return new qe(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Xe.fromString(e);Ne(D1(n),9688,{name:e});const i=new Jo(n.get(1),n.get(3)),a=new ae(n.popFirst(5));return i.isEqual(r)||Xn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Co{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ba extends fT{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Kc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(mT("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=ba._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}ba._jsonSchemaVersion="firestore/documentSnapshot/1.0",ba._jsonSchema={type:pt("string",ba._jsonSchemaVersion),bundleSource:pt("string","DocumentSnapshot"),bundleName:pt("string"),bundle:pt("string")};class Kc extends ba{data(e={}){return super.data(e)}}class Vo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Co(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Kc(this._firestore,this._userDataWriter,n.key,n,new Co(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new re(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const l=new Kc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Co(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new Kc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Co(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:dL(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ep.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function dL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t){t=Zo(t,Ct);const e=Zo(t.firestore,Zp);return ZM(aT(e),t._key).then(r=>pL(e,t,r))}Vo._jsonSchemaVersion="firestore/querySnapshot/1.0",Vo._jsonSchema={type:pt("string",Vo._jsonSchemaVersion),bundleSource:pt("string","QuerySnapshot"),bundleName:pt("string"),bundle:pt("string")};class fL extends cL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,r)}}function db(t,e,r){t=Zo(t,Ct);const n=Zo(t.firestore,Zp),i=uL(t.converter,e);return mL(n,[iL(nL(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Hn.none())])}function mL(t,e){return function(n,i){const a=new Ci;return n.asyncQueue.enqueueAndForget(async()=>MM(await GM(n),i,a)),a.promise}(aT(t),e)}function pL(t,e,r){const n=r.docs.get(e._key),i=new fL(t);return new ba(t,i,e._key,n,new Co(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){$s=i})(Va),Pa(new ji("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new Zp(new QR(n.getProvider("auth-internal")),new t2(s,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(c.options.projectId,u)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),fn(g0,y0,e),fn(g0,y0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="firebasestorage.googleapis.com",gL="storageBucket",yL=2*60*1e3,vL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn extends Pn{constructor(e,r,n=0){super(ef(e),`Firebase Storage: ${r} (${ef(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Cn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ef(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var An;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(An||(An={}));function ef(t){return"storage/"+t}function bL(){const t="An unknown error occurred, please check the error payload for server response.";return new Cn(An.UNKNOWN,t)}function xL(){return new Cn(An.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function wL(){return new Cn(An.CANCELED,"User canceled the upload/download.")}function _L(t){return new Cn(An.INVALID_URL,"Invalid URL '"+t+"'.")}function EL(t){return new Cn(An.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function hb(t){return new Cn(An.INVALID_ARGUMENT,t)}function gT(){return new Cn(An.APP_DELETED,"The Firebase app was deleted.")}function TL(t){return new Cn(An.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qr.makeFromUrl(e,r)}catch{return new Qr(e,"")}if(n.path==="")return n;throw EL(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const s="(/(.*))?$",o=new RegExp("^gs://"+i+s,"i"),l={bucket:1,path:3};function c(j){j.path_=decodeURIComponent(j.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},b=r===pT?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",_=new RegExp(`^https?://${b}/${i}/${g}`,"i"),E=[{regex:o,indices:l,postModify:a},{regex:p,indices:v,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let j=0;j<E.length;j++){const R=E[j],D=R.regex.exec(e);if(D){const S=D[R.indices.bucket];let A=D[R.indices.path];A||(A=""),n=new Qr(S,A),R.postModify(n);break}}if(n==null)throw _L(e);return n}}class AL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SL(t,e,r){let n=1,i=null,a=null,s=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,e.apply(null,g))}function h(g){i=setTimeout(()=>{i=null,t(p,l())},g)}function m(){a&&clearTimeout(a)}function p(g,..._){if(c){m();return}if(g){m(),u.call(null,g,..._);return}if(l()||s){m(),u.call(null,g,..._);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let v=!1;function b(g){v||(v=!0,m(),!c&&(i!==null?(g||(o=2),clearTimeout(i),h(0)):g||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,b(!0)},r),b}function IL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PL(t){return t!==void 0}function fb(t,e,r,n){if(n<e)throw hb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw hb(`Invalid value for '${t}'. Expected ${r} or less.`)}function CL(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var Eu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Eu||(Eu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NL{constructor(e,r,n,i,a,s,o,l,c,u,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,b)=>{this.resolve_=v,this.reject_=b,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new gc(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const s=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const o=a.getErrorCode()===Eu.NO_ERROR,l=a.getStatus();if(!o||kL(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===Eu.ABORT;n(!1,new gc(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new gc(c,a))})},r=(n,i)=>{const a=this.resolve_,s=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());PL(l)?a(l):a()}catch(l){s(l)}else if(o!==null){const l=bL();l.serverResponse=o.getErrorText(),this.errorCallback_?s(this.errorCallback_(o,l)):s(l)}else if(i.canceled){const l=this.appDelete_?gT():wL();s(l)}else{const l=xL();s(l)}};this.canceled_?r(!1,new gc(!1,null,!0)):this.backoffId_=SL(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&IL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gc{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function jL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function OL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function RL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function DL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function ML(t,e,r,n,i,a,s=!0,o=!1){const l=CL(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return RL(u,e),jL(u,r),OL(u,a),DL(u,n),new NL(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function $L(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,r){this._service=e,r instanceof Qr?this._location=r:this._location=Qr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Tu(e,r)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $L(this._location.path)}get storage(){return this._service}get parent(){const e=LL(this._location.path);if(e===null)return null;const r=new Qr(this._location.bucket,e);return new Tu(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw TL(e)}}function mb(t,e){const r=e?.[gL];return r==null?null:Qr.makeFromBucketSpec(r,t)}function VL(t,e,r,n={}){t.host=`${e}:${r}`;const i=$a(e);i&&(cp(`https://${t.host}/b`),up("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:rE(a,t.app.options.projectId))}class zL{constructor(e,r,n,i,a,s=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=s,this._bucket=null,this._host=pT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yL,this._maxUploadRetryTime=vL,this._requests=new Set,i!=null?this._bucket=Qr.makeFromBucketSpec(i,this._host):this._bucket=mb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=mb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){fb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){fb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Tu(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new AL(gT());{const s=ML(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const pb="@firebase/storage",gb="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="storage";function FL(t=fp(),e){t=dr(t);const n=hd(t,yT).getImmediate({identifier:e}),i=J_("storage");return i&&UL(n,...i),n}function UL(t,e,r,n={}){VL(t,e,r,n)}function BL(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new zL(r,n,i,e,Va)}function HL(){Pa(new ji(yT,BL,"PUBLIC").setMultipleInstances(!0)),fn(pb,gb,""),fn(pb,gb,"esm2020")}HL();const WL={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},Pd=aE(WL);console.log("Firebase app initialized:",Pd);const ko=GR(Pd);console.log("Firebase auth instance:",ko);const yb=QM(Pd);FL(Pd);const kn=sp((t,e)=>({user:null,initialized:!1,isLoading:!1,error:null,initialize:()=>{MO(ko,async r=>{try{if(r){console.log("[AUTH STORE] User authenticated:",r.uid);const n=ob(yb,"profiles",r.uid),i=await hL(n);if(i.exists()){const a=i.data();t(Se(s=>{s.user={id:r.uid,...a},s.initialized=!0,s.error=null,s.isLoading=!1}))}else{const a={id:r.uid,email:r.email,fullName:null,avatarUrl:null,preferences:{}};await db(n,a),t(Se(s=>{s.user=a,s.initialized=!0,s.error=null,s.isLoading=!1}))}}else t(Se(n=>{n.user=null,n.initialized=!0,n.error=null,n.isLoading=!1}))}catch(n){console.error("[AUTH STORE] Error in auth state change:",n),t(Se(i=>{i.error=n instanceof Error?n.message:"Error de autenticacin",i.initialized=!0,i.isLoading=!1}))}})},signIn:async(r,n)=>{try{t(Se(i=>{i.isLoading=!0,i.error=null})),console.log("[AUTH STORE] Attempting sign in with email:",r),await OO(ko,r,n)}catch(i){throw console.error("[AUTH STORE] Sign in error:",i),t(Se(a=>{a.error=i.message||"Error al iniciar sesin",a.isLoading=!1})),i}},signUp:async(r,n,i,a)=>{try{if(t(Se(l=>{l.isLoading=!0,l.error=null})),i&&n!==i)throw new Error("Las contraseas no coinciden");const o=(await jO(ko,r,n)).user;if(o){const l={id:o.uid,email:o.email,fullName:a||null,avatarUrl:null,preferences:{}},c=ob(yb,"profiles",o.uid);await db(c,l)}else throw new Error("Error al crear el usuario")}catch(s){throw console.error("[AUTH STORE] Sign up error:",s),t(Se(o=>{o.error=s.message||"Error al crear la cuenta",o.isLoading=!1})),s}},signOut:async()=>{try{t(Se(r=>{r.isLoading=!0,r.error=null})),await LO(ko)}catch(r){throw console.error("[AUTH STORE] Sign out error:",r),t(Se(n=>{n.error=r.message||"Error al cerrar sesin",n.isLoading=!1})),r}},clearError:()=>{t(Se(r=>{r.error=null}))}})),jr={initialization:{timeout:5e3,retryAttempts:2,retryDelay:1e3,emergencyFallbackTimeout:8e3},performance:{trackInitialization:!0,slowConnectionThreshold:3e3,performanceLogging:!1},ui:{showProgressIndicator:!0,progressSteps:["Conectando...","Verificando sesin...","Cargando perfil...","Inicializando..."],minLoadingTime:500}};class qL{constructor(){Nr(this,"metrics");this.metrics={startTime:Date.now(),retryCount:0,errors:[],success:!1,isSlowConnection:!1,emergencyFallbackUsed:!1}}recordRetry(e){this.metrics.retryCount++,e&&this.metrics.errors.push(e)}recordError(e){this.metrics.errors.push(e)}recordSuccess(){this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime,this.metrics.success=!0,this.metrics.isSlowConnection=this.metrics.duration>jr.performance.slowConnectionThreshold}recordEmergencyFallback(){this.metrics.emergencyFallbackUsed=!0,this.metrics.endTime||(this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime)}getMetrics(){return{...this.metrics}}logPerformance(){}}const KL=()=>{const{user:t,initialized:e,initialize:r}=kn(),[n,i]=w.useState({initialized:!1,loading:!1,error:null,progress:{step:0,message:jr.ui.progressSteps[0]},retryCount:0,emergencyFallbackUsed:!1}),a=w.useRef(null),s=w.useRef({}),o=w.useRef(!1),l=b=>{b<jr.ui.progressSteps.length&&i(g=>({...g,progress:{step:b,message:jr.ui.progressSteps[b]}}))},c=()=>{Object.values(s.current).forEach(b=>{b&&clearTimeout(b)}),s.current={}},u=()=>{a.current&&(a.current.recordSuccess(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,error:null})),c()},h=(b,g=!0)=>{a.current&&a.current.recordError(b),i(_=>({..._,error:b,loading:!g})),g&&n.retryCount<jr.initialization.retryAttempts&&m()},m=()=>{const b=n.retryCount+1;a.current&&a.current.recordRetry(`Retry attempt ${b}`),i(g=>({...g,retryCount:b,progress:{step:0,message:`Reintentando... (${b}/${jr.initialization.retryAttempts})`}})),s.current.retry=setTimeout(()=>{v()},jr.initialization.retryDelay)},p=()=>{n.emergencyFallbackUsed||(console.warn("[Auth] Emergency fallback triggered - forcing app render"),a.current&&(a.current.recordEmergencyFallback(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,emergencyFallbackUsed:!0,error:"Inicializacin lenta - continuando..."})),c())},v=async()=>{i(b=>({...b,loading:!0,error:null})),l(1);try{jr.performance.trackInitialization&&!a.current&&(a.current=new qL),l(2),await r(),l(3),jr.ui.minLoadingTime>0&&await new Promise(b=>setTimeout(b,jr.ui.minLoadingTime)),u()}catch(b){const g=b instanceof Error?b.message:"Error de inicializacin";h(g)}};return w.useEffect(()=>{if(!o.current){if(o.current=!0,e){u();return}return s.current.primary=setTimeout(()=>{n.initialized||h("Timeout de inicializacin",!0)},jr.initialization.timeout),s.current.emergency=setTimeout(()=>{n.initialized||p()},jr.initialization.emergencyFallbackTimeout),v(),()=>{c()}}},[]),w.useEffect(()=>{e&&!n.initialized&&u()},[e,n.initialized]),{...n,user:t,metrics:a.current?.getMetrics()}};function GL(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const YL=t=>{switch(t){case"success":return QL;case"info":return e4;case"warning":return JL;case"error":return t4;default:return null}},ZL=Array(12).fill(0),XL=({visible:t,className:e})=>H.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},H.createElement("div",{className:"sonner-spinner"},ZL.map((r,n)=>H.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),QL=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),JL=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),e4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),t4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),r4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},H.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),n4=()=>{const[t,e]=H.useState(document.hidden);return H.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let sm=1;class i4{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,a=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:sm++,s=this.toasts.find(l=>l.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(l=>l.id===a?(this.publish({...l,...e,id:a,title:n}),{...l,...e,id:a,dismissible:o,title:n}):l):this.addToast({title:n,...i,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let a=n!==void 0,s;const o=i.then(async c=>{if(s=["resolve",c],H.isValidElement(c))a=!1,this.create({id:n,type:"default",message:c});else if(s4(c)&&!c.ok){a=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${c.status}`):r.error,m=typeof r.description=="function"?await r.description(`HTTP error! status: ${c.status}`):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(c instanceof Error){a=!1;const h=typeof r.error=="function"?await r.error(c):r.error,m=typeof r.description=="function"?await r.description(c):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(r.success!==void 0){a=!1;const h=typeof r.success=="function"?await r.success(c):r.success,m=typeof r.description=="function"?await r.description(c):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:m,...v})}}).catch(async c=>{if(s=["reject",c],r.error!==void 0){a=!1;const u=typeof r.error=="function"?await r.error(c):r.error,h=typeof r.description=="function"?await r.description(c):r.description,p=typeof u=="object"&&!H.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:h,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),l=()=>new Promise((c,u)=>o.then(()=>s[0]==="reject"?u(s[1]):c(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:l}:Object.assign(n,{unwrap:l})},this.custom=(e,r)=>{const n=r?.id||sm++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const or=new i4,a4=(t,e)=>{const r=e?.id||sm++;return or.addToast({title:t,...e,id:r}),r},s4=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",o4=a4,l4=()=>or.toasts,c4=()=>or.getActiveToasts(),vT=Object.assign(o4,{success:or.success,info:or.info,warning:or.warning,error:or.error,custom:or.custom,message:or.message,promise:or.promise,dismiss:or.dismiss,loading:or.loading},{getHistory:l4,getToasts:c4});GL("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function yc(t){return t.label!==void 0}const u4=3,d4="24px",h4="16px",vb=4e3,f4=356,m4=14,p4=45,g4=200;function on(...t){return t.filter(Boolean).join(" ")}function y4(t){const[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}const v4=t=>{var e,r,n,i,a,s,o,l,c;const{invert:u,toast:h,unstyled:m,interacting:p,setHeights:v,visibleToasts:b,heights:g,index:_,toasts:T,expanded:E,removeToast:j,defaultRichColors:R,closeButton:D,style:S,cancelButtonStyle:A,actionButtonStyle:P,className:O="",descriptionClassName:N="",duration:C,position:k,gap:Q,expandByDefault:oe,classNames:X,icons:ee,closeButtonAriaLabel:he="Close toast"}=t,[ye,Ue]=H.useState(null),[se,q]=H.useState(null),[J,rt]=H.useState(!1),[ze,Fe]=H.useState(!1),[Pr,rn]=H.useState(!1),[G,de]=H.useState(!1),[be,B]=H.useState(!1),[dt,Te]=H.useState(0),[vt,bt]=H.useState(0),rr=H.useRef(h.duration||C||vb),Zi=H.useRef(null),Cr=H.useRef(null),Xs=_===0,Ul=_+1<=b,nr=h.type,nn=h.dismissible!==!1,Qs=h.className||"",Bl=h.descriptionClassName||"",at=H.useMemo(()=>g.findIndex(le=>le.toastId===h.id)||0,[g,h.id]),Ot=H.useMemo(()=>{var le;return(le=h.closeButton)!=null?le:D},[h.closeButton,D]),Xi=H.useMemo(()=>h.duration||C||vb,[h.duration,C]),Qa=H.useRef(0),Nn=H.useRef(0),Hl=H.useRef(0),kr=H.useRef(null),[Wl,ql]=k.split("-"),Ja=H.useMemo(()=>g.reduce((le,st,ot)=>ot>=at?le:le+st.height,0),[g,at]),Kl=n4(),Sh=h.invert||u,Qi=nr==="loading";Nn.current=H.useMemo(()=>at*Q+Ja,[at,Ja]),H.useEffect(()=>{rr.current=Xi},[Xi]),H.useEffect(()=>{rt(!0)},[]),H.useEffect(()=>{const le=Cr.current;if(le){const st=le.getBoundingClientRect().height;return bt(st),v(ot=>[{toastId:h.id,height:st,position:h.position},...ot]),()=>v(ot=>ot.filter(qt=>qt.toastId!==h.id))}},[v,h.id]),H.useLayoutEffect(()=>{if(!J)return;const le=Cr.current,st=le.style.height;le.style.height="auto";const ot=le.getBoundingClientRect().height;le.style.height=st,bt(ot),v(qt=>qt.find(ht=>ht.toastId===h.id)?qt.map(ht=>ht.toastId===h.id?{...ht,height:ot}:ht):[{toastId:h.id,height:ot,position:h.position},...qt])},[J,h.title,h.description,v,h.id,h.jsx,h.action,h.cancel]);const Wr=H.useCallback(()=>{Fe(!0),Te(Nn.current),v(le=>le.filter(st=>st.toastId!==h.id)),setTimeout(()=>{j(h)},g4)},[h,j,v,Nn]);H.useEffect(()=>{if(h.promise&&nr==="loading"||h.duration===1/0||h.type==="loading")return;let le;return E||p||Kl?(()=>{if(Hl.current<Qa.current){const qt=new Date().getTime()-Qa.current;rr.current=rr.current-qt}Hl.current=new Date().getTime()})():(()=>{rr.current!==1/0&&(Qa.current=new Date().getTime(),le=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),Wr()},rr.current))})(),()=>clearTimeout(le)},[E,p,h,nr,Kl,Wr]),H.useEffect(()=>{h.delete&&(Wr(),h.onDismiss==null||h.onDismiss.call(h,h))},[Wr,h.delete]);function Gl(){var le;if(ee?.loading){var st;return H.createElement("div",{className:on(X?.loader,h==null||(st=h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":nr==="loading"},ee.loading)}return H.createElement(XL,{className:on(X?.loader,h==null||(le=h.classNames)==null?void 0:le.loader),visible:nr==="loading"})}const Ji=h.icon||ee?.[nr]||YL(nr);var es,ts;return H.createElement("li",{tabIndex:0,ref:Cr,className:on(O,Qs,X?.toast,h==null||(e=h.classNames)==null?void 0:e.toast,X?.default,X?.[nr],h==null||(r=h.classNames)==null?void 0:r[nr]),"data-sonner-toast":"","data-rich-colors":(es=h.richColors)!=null?es:R,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":J,"data-promise":!!h.promise,"data-swiped":be,"data-removed":ze,"data-visible":Ul,"data-y-position":Wl,"data-x-position":ql,"data-index":_,"data-front":Xs,"data-swiping":Pr,"data-dismissible":nn,"data-type":nr,"data-invert":Sh,"data-swipe-out":G,"data-swipe-direction":se,"data-expanded":!!(E||oe&&J),style:{"--index":_,"--toasts-before":_,"--z-index":T.length-_,"--offset":`${ze?dt:Nn.current}px`,"--initial-height":oe?"auto":`${vt}px`,...S,...h.style},onDragEnd:()=>{rn(!1),Ue(null),kr.current=null},onPointerDown:le=>{le.button!==2&&(Qi||!nn||(Zi.current=new Date,Te(Nn.current),le.target.setPointerCapture(le.pointerId),le.target.tagName!=="BUTTON"&&(rn(!0),kr.current={x:le.clientX,y:le.clientY})))},onPointerUp:()=>{var le,st,ot;if(G||!nn)return;kr.current=null;const qt=Number(((le=Cr.current)==null?void 0:le.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),an=Number(((st=Cr.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ht=new Date().getTime()-((ot=Zi.current)==null?void 0:ot.getTime()),Re=ye==="x"?qt:an,ea=Math.abs(Re)/ht;if(Math.abs(Re)>=p4||ea>.11){Te(Nn.current),h.onDismiss==null||h.onDismiss.call(h,h),q(ye==="x"?qt>0?"right":"left":an>0?"down":"up"),Wr(),de(!0);return}else{var Rt,Dt;(Rt=Cr.current)==null||Rt.style.setProperty("--swipe-amount-x","0px"),(Dt=Cr.current)==null||Dt.style.setProperty("--swipe-amount-y","0px")}B(!1),rn(!1),Ue(null)},onPointerMove:le=>{var st,ot,qt;if(!kr.current||!nn||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;const ht=le.clientY-kr.current.y,Re=le.clientX-kr.current.x;var ea;const Rt=(ea=t.swipeDirections)!=null?ea:y4(k);!ye&&(Math.abs(Re)>1||Math.abs(ht)>1)&&Ue(Math.abs(Re)>Math.abs(ht)?"x":"y");let Dt={x:0,y:0};const Yl=jn=>1/(1.5+Math.abs(jn)/20);if(ye==="y"){if(Rt.includes("top")||Rt.includes("bottom"))if(Rt.includes("top")&&ht<0||Rt.includes("bottom")&&ht>0)Dt.y=ht;else{const jn=ht*Yl(ht);Dt.y=Math.abs(jn)<Math.abs(ht)?jn:ht}}else if(ye==="x"&&(Rt.includes("left")||Rt.includes("right")))if(Rt.includes("left")&&Re<0||Rt.includes("right")&&Re>0)Dt.x=Re;else{const jn=Re*Yl(Re);Dt.x=Math.abs(jn)<Math.abs(Re)?jn:Re}(Math.abs(Dt.x)>0||Math.abs(Dt.y)>0)&&B(!0),(ot=Cr.current)==null||ot.style.setProperty("--swipe-amount-x",`${Dt.x}px`),(qt=Cr.current)==null||qt.style.setProperty("--swipe-amount-y",`${Dt.y}px`)}},Ot&&!h.jsx&&nr!=="loading"?H.createElement("button",{"aria-label":he,"data-disabled":Qi,"data-close-button":!0,onClick:Qi||!nn?()=>{}:()=>{Wr(),h.onDismiss==null||h.onDismiss.call(h,h)},className:on(X?.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(ts=ee?.close)!=null?ts:r4):null,(nr||h.icon||h.promise)&&h.icon!==null&&(ee?.[nr]!==null||h.icon)?H.createElement("div",{"data-icon":"",className:on(X?.icon,h==null||(i=h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Gl():null,h.type!=="loading"?Ji:null):null,H.createElement("div",{"data-content":"",className:on(X?.content,h==null||(a=h.classNames)==null?void 0:a.content)},H.createElement("div",{"data-title":"",className:on(X?.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?H.createElement("div",{"data-description":"",className:on(N,Bl,X?.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),H.isValidElement(h.cancel)?h.cancel:h.cancel&&yc(h.cancel)?H.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||A,onClick:le=>{yc(h.cancel)&&nn&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,le),Wr())},className:on(X?.cancelButton,h==null||(l=h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,H.isValidElement(h.action)?h.action:h.action&&yc(h.action)?H.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:le=>{yc(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,le),!le.defaultPrevented&&Wr())},className:on(X?.actionButton,h==null||(c=h.classNames)==null?void 0:c.actionButton)},h.action.label):null)};function bb(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function b4(t,e){const r={};return[t,e].forEach((n,i)=>{const a=i===1,s=a?"--mobile-offset":"--offset",o=a?h4:d4;function l(c){["top","right","bottom","left"].forEach(u=>{r[`${s}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(c=>{n[c]===void 0?r[`${s}-${c}`]=o:r[`${s}-${c}`]=typeof n[c]=="number"?`${n[c]}px`:n[c]}):l(o)}),r}const x4=H.forwardRef(function(e,r){const{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:o,className:l,offset:c,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:v,visibleToasts:b=u4,toastOptions:g,dir:_=bb(),gap:T=m4,icons:E,containerAriaLabel:j="Notifications"}=e,[R,D]=H.useState([]),S=H.useMemo(()=>Array.from(new Set([i].concat(R.filter(se=>se.position).map(se=>se.position)))),[R,i]),[A,P]=H.useState([]),[O,N]=H.useState(!1),[C,k]=H.useState(!1),[Q,oe]=H.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=H.useRef(null),ee=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),he=H.useRef(null),ye=H.useRef(!1),Ue=H.useCallback(se=>{D(q=>{var J;return(J=q.find(rt=>rt.id===se.id))!=null&&J.delete||or.dismiss(se.id),q.filter(({id:rt})=>rt!==se.id)})},[]);return H.useEffect(()=>or.subscribe(se=>{if(se.dismiss){requestAnimationFrame(()=>{D(q=>q.map(J=>J.id===se.id?{...J,delete:!0}:J))});return}setTimeout(()=>{mk.flushSync(()=>{D(q=>{const J=q.findIndex(rt=>rt.id===se.id);return J!==-1?[...q.slice(0,J),{...q[J],...se},...q.slice(J+1)]:[se,...q]})})})}),[R]),H.useEffect(()=>{if(h!=="system"){oe(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?oe("dark"):oe("light")),typeof window>"u")return;const se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:q})=>{oe(q?"dark":"light")})}catch{se.addListener(({matches:J})=>{try{oe(J?"dark":"light")}catch(rt){console.error(rt)}})}},[h]),H.useEffect(()=>{R.length<=1&&N(!1)},[R]),H.useEffect(()=>{const se=q=>{var J;if(a.every(Fe=>q[Fe]||q.code===Fe)){var ze;N(!0),(ze=X.current)==null||ze.focus()}q.code==="Escape"&&(document.activeElement===X.current||(J=X.current)!=null&&J.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),H.useEffect(()=>{if(X.current)return()=>{he.current&&(he.current.focus({preventScroll:!0}),he.current=null,ye.current=!1)}},[X.current]),H.createElement("section",{ref:r,"aria-label":`${j} ${ee}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((se,q)=>{var J;const[rt,ze]=se.split("-");return R.length?H.createElement("ol",{key:se,dir:_==="auto"?bb():_,tabIndex:-1,ref:X,className:l,"data-sonner-toaster":!0,"data-sonner-theme":Q,"data-y-position":rt,"data-x-position":ze,style:{"--front-toast-height":`${((J=A[0])==null?void 0:J.height)||0}px`,"--width":`${f4}px`,"--gap":`${T}px`,...v,...b4(c,u)},onBlur:Fe=>{ye.current&&!Fe.currentTarget.contains(Fe.relatedTarget)&&(ye.current=!1,he.current&&(he.current.focus({preventScroll:!0}),he.current=null))},onFocus:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,he.current=Fe.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{C||N(!1)},onDragEnd:()=>N(!1),onPointerDown:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||k(!0)},onPointerUp:()=>k(!1)},R.filter(Fe=>!Fe.position&&q===0||Fe.position===se).map((Fe,Pr)=>{var rn,G;return H.createElement(v4,{key:Fe.id,icons:E,index:Pr,toast:Fe,defaultRichColors:m,duration:(rn=g?.duration)!=null?rn:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:n,visibleToasts:b,closeButton:(G=g?.closeButton)!=null?G:o,interacting:C,position:se,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:Ue,toasts:R.filter(de=>de.position==Fe.position),heights:A.filter(de=>de.position==Fe.position),setHeights:P,expandByDefault:s,gap:T,expanded:O,swipeDirections:e.swipeDirections})})):null}))});class w4{constructor(){Nr(this,"listeners",new Set)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}success(e,r,n){this.emit({type:"success",title:e,message:r,duration:n})}error(e,r,n){this.emit({type:"error",title:e,message:r,duration:n})}warning(e,r,n){this.emit({type:"warning",title:e,message:r,duration:n})}info(e,r,n){this.emit({type:"info",title:e,message:r,duration:n})}}const Cd=new w4,bT=w.createContext(void 0),Us=()=>{const t=w.useContext(bT);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},_4=t=>{switch(t){case"success":return d.jsx(Ai,{size:20,className:"text-green-500"});case"error":return d.jsx(Jr,{size:20,className:"text-red-500"});case"warning":return d.jsx(_n,{size:20,className:"text-yellow-500"});case"info":return d.jsx(S_,{size:20,className:"text-blue-500"})}},E4=t=>{switch(t){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800";case"warning":return"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800";case"info":return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800"}},T4=({children:t})=>{const[e,r]=w.useState([]),n=w.useCallback(s=>{const o=`toast-${Date.now()}-${Math.random()}`,l={id:o,duration:5e3,...s};r(c=>[...c,l]),l.duration!==0&&setTimeout(()=>{i(o)},l.duration)},[]);w.useEffect(()=>Cd.subscribe(o=>{n(o)}),[n]);const i=w.useCallback(s=>{r(o=>o.filter(l=>l.id!==s))},[]),a=w.useCallback(()=>{r([])},[]);return d.jsxs(bT.Provider,{value:{toasts:e,addToast:n,removeToast:i,clearToasts:a},children:[t,d.jsx(A4,{})]})},A4=()=>{const{toasts:t,removeToast:e}=Us();return d.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:d.jsx(ke,{children:t.map(r=>d.jsx(L.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{type:"spring",damping:25,stiffness:300},className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${E4(r.type)}`,role:"alert","aria-live":"assertive",tabIndex:0,children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"flex-shrink-0 mt-0.5",children:_4(r.type)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.title}),r.message&&d.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r.message})]}),d.jsx("button",{onClick:()=>e(r.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Cerrar notificacin",children:d.jsx(Ui,{size:16})})]})},r.id))})})},gi={QUERY:{STALE_TIME:{MEDIUM:1e3*60*15},GC_TIME:{MEDIUM:1e3*60*30,LONG:1e3*60*60},RETRY:{COUNT:1,DELAY:1e3}}},oo={measureTime:async(t,e)=>typeof e=="function"?await e():e,markStart:t=>{},markEnd:t=>{},debounce:(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(void 0,n),e)}},throttle:(t,e)=>{let r;return(...n)=>{r||(t.apply(void 0,n),r=!0,setTimeout(()=>r=!1,e))}}},S4=()=>(w.useEffect(()=>{},[]),{measureTime:oo.measureTime,markStart:oo.markStart,markEnd:oo.markEnd,debounce:oo.debounce,throttle:oo.throttle}),I4=()=>{const t=()=>{const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`),typeof CSS<"u"&&CSS.supports&&CSS.supports("padding","env(safe-area-inset-top)")?(document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-bottom","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)")):(document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-bottom","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px"))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(t,100)}),"visualViewport"in window&&window.visualViewport?.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),"visualViewport"in window&&window.visualViewport?.removeEventListener("resize",t)}};const P4=()=>{const[t,e]=w.useState({isOnline:navigator.onLine});return w.useEffect(()=>{const r=()=>{const o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e({isOnline:navigator.onLine,connectionType:o?.type,effectiveType:o?.effectiveType,downlink:o?.downlink,rtt:o?.rtt})},n=()=>{console.log("[Network] Connection restored"),r()},i=()=>{console.log("[Network] Connection lost"),r()},a=()=>{console.log("[Network] Connection changed"),r()};r(),window.addEventListener("online",n),window.addEventListener("offline",i);const s=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return s&&s.addEventListener("change",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i),s&&s.removeEventListener("change",a)}},[]),t},C4=()=>{const t=P4();return{...t,quality:(()=>{if(!t.isOnline)return"offline";if(t.effectiveType)switch(t.effectiveType){case"4g":return"fast";case"3g":return"slow";case"2g":return"slow";case"slow-2g":return"slow";default:return"fast"}return t.downlink!==void 0?t.downlink>1.5?"fast":"slow":"fast"})()}},k4=()=>{const[t,e]=w.useState(!1);C4();const{user:r,initialized:n}=kn();return null},N4=()=>{},Jp=(t,e)=>{console.error(`[CRITICAL][${t}]`,e),console.warn("Production error detected:",{context:t,error:e})};function xT(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=xT(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Le(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=xT(t))&&(n&&(n+=" "),n+=e);return n}const eg="-",j4=t=>{const e=R4(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(eg);return o[0]===""&&o.length!==1&&o.shift(),wT(o,e)||O4(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},wT=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?wT(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(eg);return e.validators.find(({validator:s})=>s(a))?.classGroupId},xb=/^\[(.+)\]$/,O4=t=>{if(xb.test(t)){const e=xb.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},R4=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return M4(Object.entries(t.classGroups),r).forEach(([a,s])=>{om(s,n,a,e)}),n},om=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:wb(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(D4(i)){om(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{om(s,wb(e,a),r,n)})})},wb=(t,e)=>{let r=t;return e.split(eg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},D4=t=>t.isThemeGetter,M4=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,L4=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},_T="!",$4=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let c=0,u=0,h;for(let g=0;g<o.length;g++){let _=o[g];if(c===0){if(_===i&&(n||o.slice(g,g+a)===e)){l.push(o.slice(u,g)),u=g+a;continue}if(_==="/"){h=g;continue}}_==="["?c++:_==="]"&&c--}const m=l.length===0?o:o.substring(u),p=m.startsWith(_T),v=p?m.substring(1):m,b=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},V4=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},z4=t=>({cache:L4(t.cacheSize),parseClassName:$4(t),...j4(t)}),F4=/\s+/,U4=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(F4);let o="";for(let l=s.length-1;l>=0;l-=1){const c=s[l],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=r(c);let v=!!p,b=n(v?m.substring(0,p):m);if(!b){if(!v){o=c+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=c+(o.length>0?" "+o:o);continue}v=!1}const g=V4(u).join(":"),_=h?g+_T:g,T=_+b;if(a.includes(T))continue;a.push(T);const E=i(b,v);for(let j=0;j<E.length;++j){const R=E[j];a.push(_+R)}o=c+(o.length>0?" "+o:o)}return o};function B4(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=ET(e))&&(n&&(n+=" "),n+=r);return n}const ET=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=ET(t[n]))&&(r&&(r+=" "),r+=e);return r};function H4(t,...e){let r,n,i,a=s;function s(l){const c=e.reduce((u,h)=>h(u),t());return r=z4(c),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=U4(l,r);return i(l,u),u}return function(){return a(B4.apply(null,arguments))}}const He=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},TT=/^\[(?:([a-z-]+):)?(.+)\]$/i,W4=/^\d+\/\d+$/,q4=new Set(["px","full","screen"]),K4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,G4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Y4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Z4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,X4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Dn=t=>bs(t)||q4.has(t)||W4.test(t),hi=t=>Bs(t,"length",a$),bs=t=>!!t&&!Number.isNaN(Number(t)),tf=t=>Bs(t,"number",bs),lo=t=>!!t&&Number.isInteger(Number(t)),Q4=t=>t.endsWith("%")&&bs(t.slice(0,-1)),ve=t=>TT.test(t),fi=t=>K4.test(t),J4=new Set(["length","size","percentage"]),e$=t=>Bs(t,J4,AT),t$=t=>Bs(t,"position",AT),r$=new Set(["image","url"]),n$=t=>Bs(t,r$,o$),i$=t=>Bs(t,"",s$),co=()=>!0,Bs=(t,e,r)=>{const n=TT.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},a$=t=>G4.test(t)&&!Y4.test(t),AT=()=>!1,s$=t=>Z4.test(t),o$=t=>X4.test(t),l$=()=>{const t=He("colors"),e=He("spacing"),r=He("blur"),n=He("brightness"),i=He("borderColor"),a=He("borderRadius"),s=He("borderSpacing"),o=He("borderWidth"),l=He("contrast"),c=He("grayscale"),u=He("hueRotate"),h=He("invert"),m=He("gap"),p=He("gradientColorStops"),v=He("gradientColorStopPositions"),b=He("inset"),g=He("margin"),_=He("opacity"),T=He("padding"),E=He("saturate"),j=He("scale"),R=He("sepia"),D=He("skew"),S=He("space"),A=He("translate"),P=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",ve,e],C=()=>[ve,e],k=()=>["",Dn,hi],Q=()=>["auto",bs,ve],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>["start","end","center","between","around","evenly","stretch"],ye=()=>["","0",ve],Ue=()=>["auto","avoid","all","avoid-page","page","left","right","column"],se=()=>[bs,ve];return{cacheSize:500,separator:":",theme:{colors:[co],spacing:[Dn,hi],blur:["none","",fi,ve],brightness:se(),borderColor:[t],borderRadius:["none","","full",fi,ve],borderSpacing:C(),borderWidth:k(),contrast:se(),grayscale:ye(),hueRotate:se(),invert:ye(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[Q4,hi],inset:N(),margin:N(),opacity:se(),padding:C(),saturate:se(),scale:se(),sepia:ye(),skew:se(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[fi]}],"break-after":[{"break-after":Ue()}],"break-before":[{"break-before":Ue()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),ve]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lo,ve]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",lo,ve]}],"grid-cols":[{"grid-cols":[co]}],"col-start-end":[{col:["auto",{span:["full",lo,ve]},ve]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[co]}],"row-start-end":[{row:["auto",{span:[lo,ve]},ve]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...he()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...he(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...he(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ve,e]}],"min-w":[{"min-w":[ve,e,"min","max","fit"]}],"max-w":[{"max-w":[ve,e,"none","full","min","max","fit","prose",{screen:[fi]},fi]}],h:[{h:[ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",fi,hi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tf]}],"font-family":[{font:[co]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",bs,tf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Dn,ve]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Dn,hi]}],"underline-offset":[{"underline-offset":["auto",Dn,ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),t$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",e$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},n$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:X()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Dn,ve]}],"outline-w":[{outline:[Dn,hi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Dn,hi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",fi,i$]}],"shadow-color":[{shadow:[co]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",fi,ve]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:se()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:se()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[lo,ve]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Dn,hi,tf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},c$=H4(l$),ST=void 0,u$=void 0;throw new Error("Missing Supabase environment variables");const Et=pk(ST,u$,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"plantitas-app"}},realtime:{timeout:1e4}}),d$=Object.freeze(Object.defineProperty({__proto__:null,supabase:Et,supabaseUrl:ST},Symbol.toStringTag,{value:"Module"}));function Oe(...t){return c$(Le(t))}const wt={auth:"/auth",dashboard:"/",camera:"/camera",settings:"/settings",gardenChat:"/garden-chat",plantDetail:t=>`/plant/${t}`,plantChat:t=>`/plant/${t}/chat`},gt={toDashboard:()=>wt.dashboard,toCamera:()=>wt.camera,toSettings:()=>wt.settings,toGardenChat:()=>wt.gardenChat,toPlantDetail:t=>wt.plantDetail(t),toPlantChat:t=>wt.plantChat(t),toAuth:()=>wt.auth},h$=(t,e)=>t===e?!0:e===wt.dashboard?t==="/"||t.startsWith("/plant/"):e===wt.gardenChat?t===wt.gardenChat||t.includes("/chat")||t.includes("/garden-chat"):e===wt.settings?t.startsWith("/settings"):!1;let vc;const f$=new Uint8Array(16);function m$(){if(!vc&&(vc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vc(f$)}const Lt=[];for(let t=0;t<256;++t)Lt.push((t+256).toString(16).slice(1));function p$(t,e=0){return Lt[t[e+0]]+Lt[t[e+1]]+Lt[t[e+2]]+Lt[t[e+3]]+"-"+Lt[t[e+4]]+Lt[t[e+5]]+"-"+Lt[t[e+6]]+Lt[t[e+7]]+"-"+Lt[t[e+8]]+Lt[t[e+9]]+"-"+Lt[t[e+10]]+Lt[t[e+11]]+Lt[t[e+12]]+Lt[t[e+13]]+Lt[t[e+14]]+Lt[t[e+15]]}const g$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_b={randomUUID:g$};function y$(t,e,r){if(_b.randomUUID&&!t)return _b.randomUUID();t=t||{};const n=t.random||(t.rng||m$)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,p$(n)}const IT=5,v$=IT*1024*1024,PT=t=>{if(!t||typeof t!="string")throw new Error("URL de imagen invlida");const e=t.split(",")[1];if(!e)throw new Error("Formato de imagen invlido");const r=e.length*3/4;if(r>v$){const n=(r/1048576).toFixed(1);throw new Error(`La imagen es demasiado grande (${n}MB). El lmite mximo es ${IT}MB. Por favor, usa una imagen ms pequea.`)}console.log(`[imageService] Image size validation passed: ${(r/(1024*1024)).toFixed(2)}MB`)},b$=t=>{if(!t||typeof t!="string")throw new Error("Invalid data URL: input is not a string");if(!t.startsWith("data:"))throw new Error('Invalid data URL: does not start with "data:"');const e=t.split(",");if(e.length!==2)throw new Error("Invalid data URL: incorrect format");const r=e[0].match(/:(.*?);/);if(!r)throw new Error("Invalid data URL: could not extract MIME type");const n=r[1];if(!n.startsWith("image/"))throw new Error(`Invalid data URL: not an image MIME type (${n})`);try{const i=atob(e[1]);let a=i.length;const s=new Uint8Array(a);for(;a--;)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}catch(i){throw new Error(`Invalid data URL: failed to decode base64 data - ${i instanceof Error?i.message:"Unknown error"}`)}},CT=async(t,e,r)=>{try{PT(t);const n=b$(t),i=n.type.split("/")[1],a=`${r}/${y$()}.${i}`,{error:s}=await Et.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(s)throw console.error("Error uploading image to Supabase Storage:",s),new Error(`Storage error: ${s.message}`);const{data:o}=Et.storage.from(e).getPublicUrl(a);if(!o||!o.publicUrl)throw new Error("Could not get public URL for uploaded image.");return o.publicUrl}catch(n){throw console.error("Failed to upload image:",n),n instanceof Error?new Error(`Image upload failed: ${n.message}`):new Error("An unknown error occurred during image upload.")}};function z(t,e,r){function n(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(t),e(o,l);for(const u in s.prototype)u in o||Object.defineProperty(o,u,{value:s.prototype[u].bind(o)});o._zod.constr=s,o._zod.def=l}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var l;const c=r?.Parent?new a:this;n(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}class il extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const kT={};function Oa(t){return kT}function x$(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function w$(t,e){return typeof e=="bigint"?e.toString():e}function NT(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function tg(t){return t==null}function rg(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function _$(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}function Ge(t,e,r){Object.defineProperty(t,e,{get(){{const n=r();return t[e]=n,n}},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function ng(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function uo(t){return JSON.stringify(t)}const jT=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function lm(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const E$=NT(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function cm(t){if(lm(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(lm(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const T$=new Set(["string","number","symbol"]);function kd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Wa(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function ne(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function A$(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const S$={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function I$(t,e){const r={},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Wa(t,{...t._zod.def,shape:r,checks:[]})}function P$(t,e){const r={...t._zod.def.shape},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Wa(t,{...t._zod.def,shape:r,checks:[]})}function C$(t,e){if(!cm(e))throw new Error("Invalid input to extend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return ng(this,"shape",n),n},checks:[]};return Wa(t,r)}function k$(t,e){return Wa(t,{...t._zod.def,get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return ng(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function N$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in n))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=t?new t({type:"optional",innerType:n[a]}):n[a])}else for(const a in n)i[a]=t?new t({type:"optional",innerType:n[a]}):n[a];return Wa(e,{...e._zod.def,shape:i,checks:[]})}function j$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=new t({type:"nonoptional",innerType:n[a]}))}else for(const a in n)i[a]=new t({type:"nonoptional",innerType:n[a]});return Wa(e,{...e._zod.def,shape:i,checks:[]})}function zo(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function ig(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function bc(t){return typeof t=="string"?t:t?.message}function Ra(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=bc(t.inst?._zod.def?.error?.(t))??bc(e?.error?.(t))??bc(r.customError?.(t))??bc(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function ag(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function al(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}const OT=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,w$,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},RT=z("$ZodError",OT),DT=z("$ZodError",OT,{Parent:Error});function O$(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function R$(t,e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(r(s));else{let o=n,l=0;for(;l<s.path.length;){const c=s.path[l];l===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(t),n}const D$=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new il;if(s.issues.length){const o=new(i?.Err??t)(s.issues.map(l=>Ra(l,a,Oa())));throw jT(o,i?.callee),o}return s.value},M$=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new(i?.Err??t)(s.issues.map(l=>Ra(l,a,Oa())));throw jT(o,i?.callee),o}return s.value},MT=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new il;return a.issues.length?{success:!1,error:new(t??RT)(a.issues.map(s=>Ra(s,i,Oa())))}:{success:!0,data:a.value}},L$=MT(DT),LT=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>Ra(s,i,Oa())))}:{success:!0,data:a.value}},$$=LT(DT),V$=/^[cC][^\s-]{8,}$/,z$=/^[0-9a-z]+$/,F$=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,U$=/^[0-9a-vA-V]{20}$/,B$=/^[A-Za-z0-9]{27}$/,H$=/^[a-zA-Z0-9_-]{21}$/,W$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,q$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Eb=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,K$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,G$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Y$(){return new RegExp(G$,"u")}const Z$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,X$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Q$=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,J$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,e5=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,$T=/^[A-Za-z0-9_-]*$/,t5=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,r5=/^\+(?:[0-9]){6,14}[0-9]$/,VT="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",n5=new RegExp(`^${VT}$`);function zT(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function i5(t){return new RegExp(`^${zT(t)}$`)}function a5(t){const e=zT({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${VT}T(?:${n})$`)}const s5=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},o5=/^\d+$/,l5=/^-?\d+(?:\.\d+)?/i,c5=/true|false/i,u5=/^[^A-Z]*$/,d5=/^[^a-z]*$/,hr=z("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),FT={number:"number",bigint:"bigint",object:"date"},UT=z("$ZodCheckLessThan",(t,e)=>{hr.init(t,e);const r=FT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),BT=z("$ZodCheckGreaterThan",(t,e)=>{hr.init(t,e);const r=FT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),h5=z("$ZodCheckMultipleOf",(t,e)=>{hr.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):_$(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),f5=z("$ZodCheckNumberFormat",(t,e)=>{hr.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=S$[e.format];t._zod.onattach.push(s=>{const o=s._zod.bag;o.format=e.format,o.minimum=i,o.maximum=a,r&&(o.pattern=o5)}),t._zod.check=s=>{const o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:n,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}o<i&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:t})}}),m5=z("$ZodCheckMaxLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const s=ag(i);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),p5=z("$ZodCheckMinLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const s=ag(i);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),g5=z("$ZodCheckLengthEquals",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const s=ag(i),o=a>e.length;n.issues.push({origin:s,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Nd=z("$ZodCheckStringFormat",(t,e)=>{var r,n;hr.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),y5=z("$ZodCheckRegex",(t,e)=>{Nd.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),v5=z("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=u5),Nd.init(t,e)}),b5=z("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=d5),Nd.init(t,e)}),x5=z("$ZodCheckIncludes",(t,e)=>{hr.init(t,e);const r=kd(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),w5=z("$ZodCheckStartsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`^${kd(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),_5=z("$ZodCheckEndsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`.*${kd(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),E5=z("$ZodCheckOverwrite",(t,e)=>{hr.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class T5{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(s=>s),i=Math.min(...n.map(s=>s.length-s.trimStart().length)),a=n.map(s=>s.slice(i)).map(s=>" ".repeat(this.indent*2)+s);for(const s of a)this.content.push(s)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const A5={major:4,minor:0,patch:5},Je=z("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=A5;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,s,o)=>{let l=zo(a),c;for(const u of s){if(u._zod.def.when){if(!u._zod.def.when(a))continue}else if(l)continue;const h=a.issues.length,m=u._zod.check(a);if(m instanceof Promise&&o?.async===!1)throw new il;if(c||m instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await m,a.issues.length!==h&&(l||(l=zo(a,h)))});else{if(a.issues.length===h)continue;l||(l=zo(a,h))}}return c?c.then(()=>a):a};t._zod.run=(a,s)=>{const o=t._zod.parse(a,s);if(o instanceof Promise){if(s.async===!1)throw new il;return o.then(l=>i(l,n,s))}return i(o,n,s)}}t["~standard"]={validate:i=>{try{const a=L$(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return $$(t,i).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),sg=z("$ZodString",(t,e)=>{Je.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??s5(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Ze=z("$ZodStringFormat",(t,e)=>{Nd.init(t,e),sg.init(t,e)}),S5=z("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=q$),Ze.init(t,e)}),I5=z("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Eb(n))}else e.pattern??(e.pattern=Eb());Ze.init(t,e)}),P5=z("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=K$),Ze.init(t,e)}),C5=z("$ZodURL",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{try{const n=r.value,i=new URL(n),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t5.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),k5=z("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Y$()),Ze.init(t,e)}),N5=z("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=H$),Ze.init(t,e)}),j5=z("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=V$),Ze.init(t,e)}),O5=z("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=z$),Ze.init(t,e)}),R5=z("$ZodULID",(t,e)=>{e.pattern??(e.pattern=F$),Ze.init(t,e)}),D5=z("$ZodXID",(t,e)=>{e.pattern??(e.pattern=U$),Ze.init(t,e)}),M5=z("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=B$),Ze.init(t,e)}),L5=z("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=a5(e)),Ze.init(t,e)}),$5=z("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=n5),Ze.init(t,e)}),V5=z("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=i5(e)),Ze.init(t,e)}),z5=z("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=W$),Ze.init(t,e)}),F5=z("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Z$),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),U5=z("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=X$),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),B5=z("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Q$),Ze.init(t,e)}),H5=z("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=J$),Ze.init(t,e),t._zod.check=r=>{const[n,i]=r.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function HT(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const W5=z("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=e5),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{HT(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function q5(t){if(!$T.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return HT(r)}const K5=z("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=$T),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{q5(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),G5=z("$ZodE164",(t,e)=>{e.pattern??(e.pattern=r5),Ze.init(t,e)});function Y5(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const Z5=z("$ZodJWT",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{Y5(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),WT=z("$ZodNumber",(t,e)=>{Je.init(t,e),t._zod.pattern=t._zod.bag.pattern??l5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),X5=z("$ZodNumber",(t,e)=>{f5.init(t,e),WT.init(t,e)}),Q5=z("$ZodBoolean",(t,e)=>{Je.init(t,e),t._zod.pattern=c5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),J5=z("$ZodUnknown",(t,e)=>{Je.init(t,e),t._zod.parse=r=>r}),eV=z("$ZodNever",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),tV=z("$ZodDate",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function Tb(t,e,r){t.issues.length&&e.issues.push(...ig(r,t.issues)),e.value[r]=t.value}const rV=z("$ZodArray",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let s=0;s<i.length;s++){const o=i[s],l=e.element._zod.run({value:o,issues:[]},n);l instanceof Promise?a.push(l.then(c=>Tb(c,r,s))):Tb(l,r,s)}return a.length?Promise.all(a).then(()=>r):r}});function xc(t,e,r){t.issues.length&&e.issues.push(...ig(r,t.issues)),e.value[r]=t.value}function Ab(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...ig(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}const nV=z("$ZodObject",(t,e)=>{Je.init(t,e);const r=NT(()=>{const h=Object.keys(e.shape);for(const p of h)if(!(e.shape[p]instanceof Je))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const m=A$(e.shape);return{shape:e.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(m)}});Ge(t._zod,"propValues",()=>{const h=e.shape,m={};for(const p in h){const v=h[p]._zod;if(v.values){m[p]??(m[p]=new Set);for(const b of v.values)m[p].add(b)}}return m});const n=h=>{const m=new T5(["shape","payload","ctx"]),p=r.value,v=T=>{const E=uo(T);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};m.write("const input = payload.value;");const b=Object.create(null);let g=0;for(const T of p.keys)b[T]=`key_${g++}`;m.write("const newResult = {}");for(const T of p.keys)if(p.optionalKeys.has(T)){const E=b[T];m.write(`const ${E} = ${v(T)};`);const j=uo(T);m.write(`
        if (${E}.issues.length) {
          if (input[${j}] === undefined) {
            if (${j} in input) {
              newResult[${j}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${j}, ...iss.path] : [${j}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${j} in input) newResult[${j}] = undefined;
        } else {
          newResult[${j}] = ${E}.value;
        }
        `)}else{const E=b[T];m.write(`const ${E} = ${v(T)};`),m.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${uo(T)}, ...iss.path] : [${uo(T)}]
          })));`),m.write(`newResult[${uo(T)}] = ${E}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const _=m.compile();return(T,E)=>_(h,T,E)};let i;const a=lm,s=!kT.jitless,l=s&&E$.value,c=e.catchall;let u;t._zod.parse=(h,m)=>{u??(u=r.value);const p=h.value;if(!a(p))return h.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),h;const v=[];if(s&&l&&m?.async===!1&&m.jitless!==!0)i||(i=n(e.shape)),h=i(h,m);else{h.value={};const E=u.shape;for(const j of u.keys){const R=E[j],D=R._zod.run({value:p[j],issues:[]},m),S=R._zod.optin==="optional"&&R._zod.optout==="optional";D instanceof Promise?v.push(D.then(A=>S?Ab(A,h,j,p):xc(A,h,j))):S?Ab(D,h,j,p):xc(D,h,j)}}if(!c)return v.length?Promise.all(v).then(()=>h):h;const b=[],g=u.keySet,_=c._zod,T=_.def.type;for(const E of Object.keys(p)){if(g.has(E))continue;if(T==="never"){b.push(E);continue}const j=_.run({value:p[E],issues:[]},m);j instanceof Promise?v.push(j.then(R=>xc(R,h,E))):xc(j,h,E)}return b.length&&h.issues.push({code:"unrecognized_keys",keys:b,input:p,inst:t}),v.length?Promise.all(v).then(()=>h):h}});function Sb(t,e,r,n){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(a=>Ra(a,n,Oa())))}),e}const iV=z("$ZodUnion",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ge(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ge(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Ge(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>rg(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let i=!1;const a=[];for(const s of e.options){const o=s._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)a.push(o),i=!0;else{if(o.issues.length===0)return o;a.push(o)}}return i?Promise.all(a).then(s=>Sb(s,r,t,n)):Sb(a,r,t,n)}}),aV=z("$ZodIntersection",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),s=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||s instanceof Promise?Promise.all([a,s]).then(([l,c])=>Ib(r,l,c)):Ib(r,a,s)}});function um(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(cm(t)&&cm(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const s=um(t[a],e[a]);if(!s.valid)return{valid:!1,mergeErrorPath:[a,...s.mergeErrorPath]};i[a]=s.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],s=um(i,a);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Ib(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),zo(t))return t;const n=um(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const sV=z("$ZodEnum",(t,e)=>{Je.init(t,e);const r=x$(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>T$.has(typeof n)).map(n=>typeof n=="string"?kd(n):n.toString()).join("|")})$`),t._zod.parse=(n,i)=>{const a=n.value;return t._zod.values.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:t}),n}}),oV=z("$ZodTransform",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(s=>(r.value=s,r));if(i instanceof Promise)throw new il;return r.value=i,r}}),lV=z("$ZodOptional",(t,e)=>{Je.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${rg(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),cV=z("$ZodNullable",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${rg(r.source)}|null)$`):void 0}),Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),uV=z("$ZodDefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Pb(a,e)):Pb(i,e)}});function Pb(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const dV=z("$ZodPrefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),hV=z("$ZodNonOptional",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Cb(a,t)):Cb(i,t)}});function Cb(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const fV=z("$ZodCatch",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(s=>Ra(s,n,Oa()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>Ra(a,n,Oa()))},input:r.value}),r.issues=[]),r)}}),mV=z("$ZodPipe",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>e.in._zod.values),Ge(t._zod,"optin",()=>e.in._zod.optin),Ge(t._zod,"optout",()=>e.out._zod.optout),Ge(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>kb(a,e,n)):kb(i,e,n)}});function kb(t,e,r){return zo(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}const pV=z("$ZodReadonly",(t,e)=>{Je.init(t,e),Ge(t._zod,"propValues",()=>e.innerType._zod.propValues),Ge(t._zod,"values",()=>e.innerType._zod.values),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(Nb):Nb(i)}});function Nb(t){return t.value=Object.freeze(t.value),t}const gV=z("$ZodCustom",(t,e)=>{hr.init(t,e),Je.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>jb(a,r,n,t));jb(i,r,n,t)}});function jb(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(al(i))}}class yV{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function vV(){return new yV}const wc=vV();function bV(t,e){return new t({type:"string",...ne(e)})}function xV(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ne(e)})}function Ob(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ne(e)})}function wV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ne(e)})}function _V(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ne(e)})}function EV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ne(e)})}function TV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ne(e)})}function AV(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ne(e)})}function SV(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ne(e)})}function IV(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ne(e)})}function PV(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ne(e)})}function CV(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ne(e)})}function kV(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ne(e)})}function NV(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ne(e)})}function jV(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ne(e)})}function OV(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ne(e)})}function RV(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ne(e)})}function DV(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ne(e)})}function MV(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ne(e)})}function LV(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ne(e)})}function $V(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ne(e)})}function VV(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ne(e)})}function zV(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ne(e)})}function FV(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ne(e)})}function UV(t,e){return new t({type:"string",format:"date",check:"string_format",...ne(e)})}function BV(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ne(e)})}function HV(t,e){return new t({type:"string",format:"duration",check:"string_format",...ne(e)})}function WV(t,e){return new t({type:"number",checks:[],...ne(e)})}function qV(t,e){return new t({type:"number",coerce:!0,checks:[],...ne(e)})}function KV(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ne(e)})}function GV(t,e){return new t({type:"boolean",...ne(e)})}function YV(t){return new t({type:"unknown"})}function ZV(t,e){return new t({type:"never",...ne(e)})}function XV(t,e){return new t({type:"date",...ne(e)})}function Rb(t,e){return new UT({check:"less_than",...ne(e),value:t,inclusive:!1})}function Gc(t,e){return new UT({check:"less_than",...ne(e),value:t,inclusive:!0})}function Db(t,e){return new BT({check:"greater_than",...ne(e),value:t,inclusive:!1})}function Yc(t,e){return new BT({check:"greater_than",...ne(e),value:t,inclusive:!0})}function Mb(t,e){return new h5({check:"multiple_of",...ne(e),value:t})}function qT(t,e){return new m5({check:"max_length",...ne(e),maximum:t})}function Au(t,e){return new p5({check:"min_length",...ne(e),minimum:t})}function KT(t,e){return new g5({check:"length_equals",...ne(e),length:t})}function QV(t,e){return new y5({check:"string_format",format:"regex",...ne(e),pattern:t})}function JV(t){return new v5({check:"string_format",format:"lowercase",...ne(t)})}function e6(t){return new b5({check:"string_format",format:"uppercase",...ne(t)})}function t6(t,e){return new x5({check:"string_format",format:"includes",...ne(e),includes:t})}function r6(t,e){return new w5({check:"string_format",format:"starts_with",...ne(e),prefix:t})}function n6(t,e){return new _5({check:"string_format",format:"ends_with",...ne(e),suffix:t})}function Cl(t){return new E5({check:"overwrite",tx:t})}function i6(t){return Cl(e=>e.normalize(t))}function a6(){return Cl(t=>t.trim())}function s6(){return Cl(t=>t.toLowerCase())}function o6(){return Cl(t=>t.toUpperCase())}function l6(t,e,r){return new t({type:"array",element:e,...ne(r)})}function c6(t,e,r){return new t({type:"custom",check:"custom",fn:e,...ne(r)})}const u6=z("ZodISODateTime",(t,e)=>{L5.init(t,e),et.init(t,e)});function d6(t){return FV(u6,t)}const h6=z("ZodISODate",(t,e)=>{$5.init(t,e),et.init(t,e)});function f6(t){return UV(h6,t)}const m6=z("ZodISOTime",(t,e)=>{V5.init(t,e),et.init(t,e)});function p6(t){return BV(m6,t)}const g6=z("ZodISODuration",(t,e)=>{z5.init(t,e),et.init(t,e)});function y6(t){return HV(g6,t)}const GT=(t,e)=>{RT.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>R$(t,r)},flatten:{value:r=>O$(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},v6=z("ZodError",GT),jd=z("ZodError",GT,{Parent:Error}),b6=D$(jd),x6=M$(jd),w6=MT(jd),_6=LT(jd),ut=z("ZodType",(t,e)=>(Je.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Wa(t,r,n),t.brand=()=>t,t.register=(r,n)=>(r.add(t,n),t),t.parse=(r,n)=>b6(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>w6(t,r,n),t.parseAsync=async(r,n)=>x6(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>_6(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(m3(r,n)),t.superRefine=r=>t.check(p3(r)),t.overwrite=r=>t.check(Cl(r)),t.optional=()=>zb(t),t.nullable=()=>Fb(t),t.nullish=()=>zb(Fb(t)),t.nonoptional=r=>s3(t,r),t.array=()=>_e(t),t.or=r=>Z6([t,r]),t.and=r=>Q6(t,r),t.transform=r=>Ub(t,e3(r)),t.default=r=>n3(t,r),t.prefault=r=>a3(t,r),t.catch=r=>l3(t,r),t.pipe=r=>Ub(t,r),t.readonly=()=>d3(t),t.describe=r=>{const n=t.clone();return wc.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return wc.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return wc.get(t);const n=t.clone();return wc.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),YT=z("_ZodString",(t,e)=>{sg.init(t,e),ut.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(QV(...n)),t.includes=(...n)=>t.check(t6(...n)),t.startsWith=(...n)=>t.check(r6(...n)),t.endsWith=(...n)=>t.check(n6(...n)),t.min=(...n)=>t.check(Au(...n)),t.max=(...n)=>t.check(qT(...n)),t.length=(...n)=>t.check(KT(...n)),t.nonempty=(...n)=>t.check(Au(1,...n)),t.lowercase=n=>t.check(JV(n)),t.uppercase=n=>t.check(e6(n)),t.trim=()=>t.check(a6()),t.normalize=(...n)=>t.check(i6(...n)),t.toLowerCase=()=>t.check(s6()),t.toUpperCase=()=>t.check(o6())}),E6=z("ZodString",(t,e)=>{sg.init(t,e),YT.init(t,e),t.email=r=>t.check(xV(T6,r)),t.url=r=>t.check(AV(A6,r)),t.jwt=r=>t.check(zV(z6,r)),t.emoji=r=>t.check(SV(S6,r)),t.guid=r=>t.check(Ob(Lb,r)),t.uuid=r=>t.check(wV(_c,r)),t.uuidv4=r=>t.check(_V(_c,r)),t.uuidv6=r=>t.check(EV(_c,r)),t.uuidv7=r=>t.check(TV(_c,r)),t.nanoid=r=>t.check(IV(I6,r)),t.guid=r=>t.check(Ob(Lb,r)),t.cuid=r=>t.check(PV(P6,r)),t.cuid2=r=>t.check(CV(C6,r)),t.ulid=r=>t.check(kV(k6,r)),t.base64=r=>t.check(LV(L6,r)),t.base64url=r=>t.check($V($6,r)),t.xid=r=>t.check(NV(N6,r)),t.ksuid=r=>t.check(jV(j6,r)),t.ipv4=r=>t.check(OV(O6,r)),t.ipv6=r=>t.check(RV(R6,r)),t.cidrv4=r=>t.check(DV(D6,r)),t.cidrv6=r=>t.check(MV(M6,r)),t.e164=r=>t.check(VV(V6,r)),t.datetime=r=>t.check(d6(r)),t.date=r=>t.check(f6(r)),t.time=r=>t.check(p6(r)),t.duration=r=>t.check(y6(r))});function K(t){return bV(E6,t)}const et=z("ZodStringFormat",(t,e)=>{Ze.init(t,e),YT.init(t,e)}),T6=z("ZodEmail",(t,e)=>{P5.init(t,e),et.init(t,e)}),Lb=z("ZodGUID",(t,e)=>{S5.init(t,e),et.init(t,e)}),_c=z("ZodUUID",(t,e)=>{I5.init(t,e),et.init(t,e)}),A6=z("ZodURL",(t,e)=>{C5.init(t,e),et.init(t,e)}),S6=z("ZodEmoji",(t,e)=>{k5.init(t,e),et.init(t,e)}),I6=z("ZodNanoID",(t,e)=>{N5.init(t,e),et.init(t,e)}),P6=z("ZodCUID",(t,e)=>{j5.init(t,e),et.init(t,e)}),C6=z("ZodCUID2",(t,e)=>{O5.init(t,e),et.init(t,e)}),k6=z("ZodULID",(t,e)=>{R5.init(t,e),et.init(t,e)}),N6=z("ZodXID",(t,e)=>{D5.init(t,e),et.init(t,e)}),j6=z("ZodKSUID",(t,e)=>{M5.init(t,e),et.init(t,e)}),O6=z("ZodIPv4",(t,e)=>{F5.init(t,e),et.init(t,e)}),R6=z("ZodIPv6",(t,e)=>{U5.init(t,e),et.init(t,e)}),D6=z("ZodCIDRv4",(t,e)=>{B5.init(t,e),et.init(t,e)}),M6=z("ZodCIDRv6",(t,e)=>{H5.init(t,e),et.init(t,e)}),L6=z("ZodBase64",(t,e)=>{W5.init(t,e),et.init(t,e)}),$6=z("ZodBase64URL",(t,e)=>{K5.init(t,e),et.init(t,e)}),V6=z("ZodE164",(t,e)=>{G5.init(t,e),et.init(t,e)}),z6=z("ZodJWT",(t,e)=>{Z5.init(t,e),et.init(t,e)}),og=z("ZodNumber",(t,e)=>{WT.init(t,e),ut.init(t,e),t.gt=(n,i)=>t.check(Db(n,i)),t.gte=(n,i)=>t.check(Yc(n,i)),t.min=(n,i)=>t.check(Yc(n,i)),t.lt=(n,i)=>t.check(Rb(n,i)),t.lte=(n,i)=>t.check(Gc(n,i)),t.max=(n,i)=>t.check(Gc(n,i)),t.int=n=>t.check($b(n)),t.safe=n=>t.check($b(n)),t.positive=n=>t.check(Db(0,n)),t.nonnegative=n=>t.check(Yc(0,n)),t.negative=n=>t.check(Rb(0,n)),t.nonpositive=n=>t.check(Gc(0,n)),t.multipleOf=(n,i)=>t.check(Mb(n,i)),t.step=(n,i)=>t.check(Mb(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Da(t){return WV(og,t)}const F6=z("ZodNumberFormat",(t,e)=>{X5.init(t,e),og.init(t,e)});function $b(t){return KV(F6,t)}const U6=z("ZodBoolean",(t,e)=>{Q5.init(t,e),ut.init(t,e)});function ZT(t){return GV(U6,t)}const B6=z("ZodUnknown",(t,e)=>{J5.init(t,e),ut.init(t,e)});function Vb(){return YV(B6)}const H6=z("ZodNever",(t,e)=>{eV.init(t,e),ut.init(t,e)});function W6(t){return ZV(H6,t)}const q6=z("ZodDate",(t,e)=>{tV.init(t,e),ut.init(t,e),t.min=(n,i)=>t.check(Yc(n,i)),t.max=(n,i)=>t.check(Gc(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function xn(t){return XV(q6,t)}const K6=z("ZodArray",(t,e)=>{rV.init(t,e),ut.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Au(r,n)),t.nonempty=r=>t.check(Au(1,r)),t.max=(r,n)=>t.check(qT(r,n)),t.length=(r,n)=>t.check(KT(r,n)),t.unwrap=()=>t.element});function _e(t,e){return l6(K6,t,e)}const G6=z("ZodObject",(t,e)=>{nV.init(t,e),ut.init(t,e),Ge(t,"shape",()=>e.shape),t.keyof=()=>De(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Vb()}),t.loose=()=>t.clone({...t._zod.def,catchall:Vb()}),t.strict=()=>t.clone({...t._zod.def,catchall:W6()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>C$(t,r),t.merge=r=>k$(t,r),t.pick=r=>I$(t,r),t.omit=r=>P$(t,r),t.partial=(...r)=>N$(XT,t,r[0]),t.required=(...r)=>j$(QT,t,r[0])});function Ce(t,e){const r={type:"object",get shape(){return ng(this,"shape",{...t}),this.shape},...ne(e)};return new G6(r)}const Y6=z("ZodUnion",(t,e)=>{iV.init(t,e),ut.init(t,e),t.options=e.options});function Z6(t,e){return new Y6({type:"union",options:t,...ne(e)})}const X6=z("ZodIntersection",(t,e)=>{aV.init(t,e),ut.init(t,e)});function Q6(t,e){return new X6({type:"intersection",left:t,right:e})}const dm=z("ZodEnum",(t,e)=>{sV.init(t,e),ut.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const s of n)if(r.has(s))a[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new dm({...e,checks:[],...ne(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const s of n)if(r.has(s))delete a[s];else throw new Error(`Key ${s} not found in enum`);return new dm({...e,checks:[],...ne(i),entries:a})}});function De(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new dm({type:"enum",entries:r,...ne(e)})}const J6=z("ZodTransform",(t,e)=>{oV.init(t,e),ut.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=a=>{if(typeof a=="string")r.issues.push(al(a,r.value,e));else{const s=a;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!0),r.issues.push(al(s))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function e3(t){return new J6({type:"transform",transform:t})}const XT=z("ZodOptional",(t,e)=>{lV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function zb(t){return new XT({type:"optional",innerType:t})}const t3=z("ZodNullable",(t,e)=>{cV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Fb(t){return new t3({type:"nullable",innerType:t})}const r3=z("ZodDefault",(t,e)=>{uV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function n3(t,e){return new r3({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const i3=z("ZodPrefault",(t,e)=>{dV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function a3(t,e){return new i3({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const QT=z("ZodNonOptional",(t,e)=>{hV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function s3(t,e){return new QT({type:"nonoptional",innerType:t,...ne(e)})}const o3=z("ZodCatch",(t,e)=>{fV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function l3(t,e){return new o3({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const c3=z("ZodPipe",(t,e)=>{mV.init(t,e),ut.init(t,e),t.in=e.in,t.out=e.out});function Ub(t,e){return new c3({type:"pipe",in:t,out:e})}const u3=z("ZodReadonly",(t,e)=>{pV.init(t,e),ut.init(t,e)});function d3(t){return new u3({type:"readonly",innerType:t})}const h3=z("ZodCustom",(t,e)=>{gV.init(t,e),ut.init(t,e)});function f3(t){const e=new hr({check:"custom"});return e._zod.check=t,e}function m3(t,e={}){return c6(h3,t,e)}function p3(t){const e=f3(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(al(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(al(i))}},t(r.value,r)));return e}function dn(t){return qV(og,t)}const JT=Ce({type:De(["overwatering","underwatering","pest","disease","nutrient","light","other"]),severity:De(["low","medium","high"]),description:K().min(1),treatment:K().min(1)}),eA=Ce({overallHealth:De(["excellent","good","fair","poor"]),issues:_e(JT),recommendations:_e(K()),moistureLevel:dn().min(0).max(100),growthStage:De(["seedling","juvenile","mature","flowering","dormant"]),confidence:dn().min(0).max(100)}),tA=Ce({wateringFrequency:dn().positive(),sunlightRequirement:De(["low","medium","high"]),humidityPreference:De(["low","medium","high"]),temperatureRange:Ce({min:dn(),max:dn()}),fertilizingFrequency:dn().positive(),soilType:K().min(1),specialCare:_e(K()).optional()}),rA=Ce({traits:_e(K()).min(1),communicationStyle:De(["cheerful","wise","dramatic","calm","playful"]),catchphrases:_e(K()),moodFactors:Ce({health:dn().min(0).max(1),care:dn().min(0).max(1),attention:dn().min(0).max(1)})}),g3=Ce({species:K(),commonName:K(),variety:K().nullable().optional(),confidence:dn().min(0).max(100),generalDescription:K().min(20),funFacts:_e(K()),plantEnvironment:De(["interior","exterior","ambos"]),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]),health:eA,careProfile:tA,personality:rA}),nA=Ce({type:De(["info","warning","tip","alert"]),title:K(),message:K()}),y3=_e(nA),v3=Object.freeze(Object.defineProperty({__proto__:null,AIAnalysisResponseSchema:g3,CareProfileSchema:tA,HealthAnalysisSchema:eA,HealthIssueSchema:JT,InsightResponseSchema:y3,InsightSchema:nA,PlantPersonalitySchema:rA},Symbol.toStringTag,{value:"Module"})),{HealthAnalysisSchema:b3,CareProfileSchema:x3,PlantPersonalitySchema:w3,InsightResponseSchema:_3}=v3,E3=Ce({id:K().min(1,"Image ID is required"),url:K().url("Must be a valid URL"),timestamp:xn(),healthAnalysis:b3.optional(),isProfileImage:ZT()}),T3=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","plant","system"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),emotion:De(["alegre","triste","enojado","neutral","juguetn","agradecido","happy","sad","excited","worried","grateful"]).optional(),context:Ce({insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),A3=Ce({id:K().min(1,"Notification ID is required"),type:De(["watering","fertilizing","health_check","general"]),title:K().min(1,"Title is required"),message:K().min(1,"Message is required"),priority:De(["low","medium","high"]),scheduledFor:xn(),completed:ZT()}),S3=Ce({id:K().uuid(),name:K(),species:K(),variety:K().optional(),nickname:K().optional(),description:K().optional(),funFacts:_e(K()).optional(),location:K(),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),dateAdded:xn(),lastWatered:xn().optional(),lastFertilized:xn().optional(),images:_e(E3),healthScore:Da().min(0).max(100),careProfile:x3,personality:w3,chatHistory:_e(T3),notifications:_e(A3)}),I3=Ce({id:K().min(1,"Plant ID is required"),name:K().min(1,"Plant name is required"),nickname:K().optional(),species:K().min(1,"Species is required"),location:K().min(1,"Location is required"),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),healthScore:Da().min(0).max(100),profileImageUrl:K().url().optional(),lastWatered:xn().optional(),wateringFrequency:Da().positive().optional()});Ce({content:K(),emotion:De(["alegre","triste","enojado","neutral","juguetn","agradecido","happy","sad","excited","worried","grateful"]),mood:K().optional()});Ce({changes:_e(K()),healthImprovement:Da(),recommendations:_e(K()),newHealthScore:Da().min(0).max(100)});S3.omit({id:!0,dateAdded:!0,chatHistory:!0,notifications:!0}).partial({images:!0,healthScore:!0,careProfile:!0,personality:!0});Ce({fullName:K().min(3,"El nombre debe tener al menos 3 caracteres"),email:K().email("Email invlido"),password:K().min(6,"La contrasea debe tener al menos 6 caracteres"),confirmPassword:K().min(6)}).refine(t=>t.password===t.confirmPassword,{message:"Las contraseas no coinciden",path:["confirmPassword"]});Ce({email:K().email(),password:K().min(1,"Password is required")});const P3=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","ai"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),context:Ce({plantsAnalyzed:_e(K()).optional(),queryType:De(["general","health_analysis","care_comparison","disease_prevention","growth_tracking"]).optional(),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),C3=Ce({totalPlants:Da(),plantsData:_e(I3),averageHealthScore:Da(),commonIssues:_e(K()),careScheduleSummary:Ce({needsWatering:_e(K()),needsFertilizing:_e(K()),healthConcerns:_e(K())}),environmentalFactors:Ce({locations:_e(K()),lightConditions:_e(K()),humidityNeeds:_e(K())})});Ce({id:K().uuid(),userId:K().uuid(),messages:_e(P3),createdAt:xn(),updatedAt:xn(),context:C3.optional()});Ce({content:K().min(1),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()});const k3=async t=>{try{const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e?.access_token)throw console.error("User session not available:",r),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:n,error:i}=await Et.functions.invoke("generate-plant-insights",{body:{plant:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i)throw new Error(`Failed to generate insights: ${i.message}`);return _3.parse(n)}catch(e){throw console.error("[insightService] Error generating insights:",e),e instanceof v6?new Error(`Invalid data structure for insights: ${e.message}`):e}},iA=async t=>{PT(t);const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e)throw new Error("User must be authenticated to analyze images");const{data:n,error:i}=await Et.functions.invoke("analyze-image",{body:{imageDataUrl:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i){if(console.error("Error invoking analyze-image function:",i),i.message?.includes("unsupported image"))throw new Error("La imagen no es vlida. Por favor, asegrate de que sea una foto clara de una planta.");if(i.message?.includes("OpenAI API key"))throw new Error("Servicio de anlisis temporalmente no disponible. Intenta de nuevo ms tarde.");const a=i.context?.msg?JSON.parse(i.context.msg).error:i.message;throw new Error(`Failed to analyze image: ${a}`)}if(n&&n.error)throw console.error("Image analysis failed with a specific error:",n.error),new Error(n.error);return n},Bb=async(t,e)=>{const r="clido, simptico, motivador, y con un toque de humor ligero",n=(t.images||[]).map(m=>({url:m.url,timestamp:m.timestamp instanceof Date?m.timestamp.toISOString():m.timestamp,...m.healthAnalysis?{healthAnalysis:m.healthAnalysis}:{}})).sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());let i=[];try{i=await k3(t)}catch(m){console.warn("[generatePlantResponse] No se pudieron generar insights para la planta:",m),i=[]}const a={...t,images:n},{data:{session:s},error:o}=await Et.auth.getSession();if(o||!s?.access_token)throw console.error("User session not available:",o),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:l,error:c}=await Et.functions.invoke("generate-plant-response",{body:{plant:a,userMessage:e,tonePersona:r,insights:i},headers:{Authorization:`Bearer ${s.access_token}`}});if(c)throw console.error("Error calling generate-plant-response function:",c),new Error("Failed to generate plant response: "+c.message);const u=(l?.content||"").toLowerCase();return(!l?.content||u.includes("no s")||u.includes("no tengo informacin")||u.includes("no puedo ayudarte")||u.length<20)&&Cd.warning("Respuesta genrica","La respuesta de la planta fue muy genrica o poco til. Intenta preguntar de otra forma o proporciona ms detalles."),{...l,insights:l?.insights||i||[],suggestedActions:l?.suggestedActions||[]}},N3=async(t,e)=>{const{data:{session:r},error:n}=await Et.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:i,error:a}=await Et.functions.invoke("complete-plant-info",{body:{species:t,commonName:e},headers:{Authorization:`Bearer ${r.access_token}`}});if(a)throw console.error(" [API] Error en complete-plant-info function:",a),new Error("Failed to complete plant info: "+a.message);const s=["interior","exterior","ambos"],o=["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"];return{plantEnvironment:s.includes(i.plantEnvironment)?i.plantEnvironment:"interior",lightRequirements:o.includes(i.lightRequirements)?i.lightRequirements:"luz_indirecta",description:i.description||void 0,funFacts:Array.isArray(i.funFacts)?i.funFacts:void 0}},ho=(t,e,r,n)=>({id:t.id,name:t.name,species:t.species,variety:t.variety||void 0,nickname:t.nickname||void 0,description:t.description||void 0,funFacts:t.fun_facts||[],location:t.location,plantEnvironment:t.plant_environment,lightRequirements:t.light_requirements,dateAdded:new Date(t.date_added),lastWatered:t.last_watered?new Date(t.last_watered):void 0,lastFertilized:t.last_fertilized?new Date(t.last_fertilized):void 0,images:e,healthScore:t.health_score||85,careProfile:t.care_profile,personality:t.personality,chatHistory:r,notifications:n});class lg{constructor(e=Et){Nr(this,"supabase");this.supabase=e}async getUserPlantSummaries(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          care_profile
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;let i=new Map;if(r.length>0){const s=r.map(c=>c.id),{data:o,error:l}=await this.supabase.from("plant_images").select("plant_id, url").in("plant_id",s).eq("is_profile_image",!0);l?console.warn("[plantService] Error fetching profile images:",l):i=new Map((o||[]).map(c=>[c.plant_id,c.url]))}return r.map(s=>({id:s.id,name:s.name,nickname:s.nickname||void 0,species:s.species,location:s.location,plantEnvironment:s.plant_environment,lightRequirements:s.light_requirements,healthScore:s.health_score||85,profileImageUrl:i.get(s.id),lastWatered:s.last_watered?new Date(s.last_watered):void 0,wateringFrequency:s.care_profile?.wateringFrequency}))}catch(r){throw console.error("Error fetching plant summaries:",r),r}}async getUserPlants(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return r.map(a=>{const s=(a.plant_images||[]).map(c=>({id:c.id,url:c.url,timestamp:new Date(c.created_at),healthAnalysis:c.health_analysis,isProfileImage:c.is_profile_image||!1})),o=(a.chat_messages||[]).map(c=>({id:c.id,sender:c.sender,content:c.content,timestamp:new Date(c.created_at),emotion:c.emotion})),l=(a.plant_notifications||[]).map(c=>({id:c.id,type:c.type,title:c.title,message:c.message,priority:c.priority||"medium",scheduledFor:new Date(c.scheduled_for),completed:c.completed||!1}));return ho(a,s,o,l)})}catch(r){throw console.error("Error fetching plants:",r),r}}async getPlantById(e,r){try{const{data:n,error:i}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("id",e).eq("user_id",r).single();if(i){if(i.code==="PGRST116")return null;throw i}if(!n)return null;const a=(n.plant_images||[]).map(l=>({id:l.id,url:l.url,timestamp:new Date(l.created_at),healthAnalysis:l.health_analysis,isProfileImage:l.is_profile_image||!1})),s=(n.chat_messages||[]).map(l=>({id:l.id,sender:l.sender,content:l.content,timestamp:new Date(l.created_at),emotion:l.emotion})),o=(n.plant_notifications||[]).map(l=>({id:l.id,type:l.type,title:l.title,message:l.message,priority:l.priority||"medium",scheduledFor:new Date(l.scheduled_for),completed:l.completed||!1}));return ho(n,a,s,o)}catch(n){throw console.error("Error fetching plant by ID:",n),n}}async addPlantFromAnalysis(e,r,n){try{console.log("[PlantService] Iniciando anlisis IA...");const i=await iA(r);console.log("[PlantService] Resultado IA:",i);const a={name:i.commonName,species:i.species,description:i.generalDescription,funFacts:i.funFacts,variety:i.variety??void 0,nickname:i.commonName,location:n,plantEnvironment:i.plantEnvironment,lightRequirements:i.lightRequirements,dateAdded:new Date,healthScore:i.health.confidence,careProfile:i.careProfile,personality:i.personality};console.log("[PlantService] Payload a createPlant:",a);const s=await this.createPlant(a,e);return console.log("[PlantService] Planta creada:",s),(async()=>{let o=!1,l=!1;try{console.log(`[PlantService] Starting image upload for plant ${s.id}`);const c=await CT(r,"plant-images",`${e}/${s.id}`);console.log("[PlantService] Imagen subida:",c),await this.addPlantImage(s.id,{url:c,timestamp:new Date,isProfileImage:!0,healthAnalysis:i.health},e),o=!0,console.log(`[PlantService] Image upload completed for plant ${s.id}`)}catch(c){console.error(`[PlantService] Image upload failed for plant ${s.id}:`,c),alert("Error subiendo imagen: "+(c instanceof Error?c.message:JSON.stringify(c)))}try{console.log(`[PlantService] Starting chat initialization for plant ${s.id}`);const c=await Bb(s,"Hola! Acabo de llegar. Cmo te llamas?");console.log("[PlantService] Respuesta IA chat:",c),await this.addChatMessage(s.id,{sender:"plant",content:c.content,timestamp:new Date,emotion:c.emotion},e),l=!0,console.log(`[PlantService] Chat initialization completed for plant ${s.id}`)}catch(c){console.error(`[PlantService] Chat initialization failed for plant ${s.id}:`,c),alert("Error inicializando chat: "+(c instanceof Error?c.message:JSON.stringify(c)))}o&&l?console.log(`[PlantService] All background tasks for plant ${s.id} completed successfully.`):(o||l)&&console.log(`[PlantService] Background tasks for plant ${s.id} partially completed.`)})().catch(o=>{console.error(`[PlantService] Error during background tasks for plant ${s.id}:`,o),alert("Error en tareas de fondo: "+(o instanceof Error?o.message:JSON.stringify(o)))}),s}catch(i){throw console.error("Error adding plant from analysis:",i),alert("Error creando planta: "+(i instanceof Error?i.message:JSON.stringify(i))),i}}async createPlant(e,r){try{const n={user_id:r,name:e.name,species:e.species,variety:e.variety||null,nickname:e.nickname||null,description:e.description||null,fun_facts:e.funFacts||null,location:e.location,plant_environment:e.plantEnvironment||null,light_requirements:e.lightRequirements||null,date_added:e.dateAdded.toISOString(),last_watered:null,last_fertilized:null,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,updated_at:null};console.log("[PlantService] Payload a Supabase:",n);const{data:i,error:a}=await this.supabase.from("plants").insert(n).select("*").single();if(console.log("[PlantService] Respuesta Supabase:",i,a),a)throw console.error("Supabase error:",{message:a.message,details:a.details,code:a.code}),alert("Error Supabase: "+a.message),new Error(`Supabase error creating plant: ${a.message}`);if(!i)throw alert("No se pudo crear la planta en la base de datos, no se devolvieron datos."),new Error("Failed to create plant in the database, no data returned.");return ho(i,[],[],[])}catch(n){throw console.error("Error creating plant:",n),alert("Error creando planta: "+(n instanceof Error?n.message:JSON.stringify(n))),n}}async updatePlantInfo(e,r,n){try{const i={};n.plantEnvironment!==void 0&&(i.plant_environment=n.plantEnvironment),n.lightRequirements!==void 0&&(i.light_requirements=n.lightRequirements),n.description!==void 0&&(i.description=n.description),n.funFacts!==void 0&&(i.fun_facts=n.funFacts);const{data:a,error:s}=await this.supabase.from("plants").update(i).eq("id",e).eq("user_id",r).select("*").single();if(s)throw console.error("Supabase error updating plant:",s),new Error(`Error updating plant: ${s.message}`);if(!a)throw new Error("Plant not found or not updated.");return ho(a,[],[],[])}catch(i){throw console.error("Error updating plant info:",i),i}}async updatePlantHealthScore(e,r,n,i,a){try{console.log(" [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await this.supabase.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error(" [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log(" [DB] Actualizando anlisis de salud en imagen:",a);const{error:o}=await this.supabase.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn(" [DB] Error actualizando anlisis en imagen:",o)}console.log(" [DB] Health score actualizado exitosamente")}catch(s){throw console.error(" [DB] Error en updatePlantHealthScore:",s),s}}async updatePlant(e,r){try{const n={name:e.name,species:e.species,variety:e.variety,nickname:e.nickname,description:e.description,fun_facts:e.funFacts,location:e.location,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,last_watered:e.lastWatered?.toISOString(),last_fertilized:e.lastFertilized?.toISOString()},{data:i,error:a}=await this.supabase.from("plants").update(n).eq("id",e.id).eq("user_id",r).select().single();if(a)throw a;return ho(i,e.images,e.chatHistory,e.notifications)}catch(n){throw console.error("Error updating plant:",n),n}}async deletePlant(e,r){try{const{error:n}=await this.supabase.from("plants").delete().eq("id",e).eq("user_id",r);if(n)throw n}catch(n){throw console.error("Error deleting plant:",n),n}}async sendChatMessageAndGetResponse(e,r,n){const i=await this.addChatMessage(e.id,r,n),a=await Bb(e,r.content),s={};a.insights&&(s.insights=a.insights),a.suggestedActions&&(s.suggestedActions=a.suggestedActions);const o={sender:"plant",content:a.content,emotion:a.emotion,timestamp:new Date,...Object.keys(s).length>0?{context:s}:{}},l=await this.addChatMessage(e.id,o,n);return[i,l]}async addChatMessage(e,r,n){try{const i={plant_id:e,user_id:n,sender:r.sender,content:r.content,emotion:r.emotion||null};r.context&&(i.context=r.context);const{data:a,error:s}=await this.supabase.from("chat_messages").insert(i).select().single();if(s)throw console.error(" Supabase error:",s),s;return{id:a.id,sender:a.sender,content:a.content,timestamp:new Date(a.created_at),emotion:a.emotion,context:a.context||void 0}}catch(i){throw console.error("Error adding chat message:",i),i}}async addPlantImage(e,r,n){try{const i=r.url;let a="";try{const c=new URL(i).pathname.split("/"),u=c.findIndex(h=>h==="object");u!==-1&&u+2<c.length&&(a=c.slice(u+2).join("/"))}catch{console.warn("Could not extract storage path from URL:",i),a=`${n}/${e}/${Date.now()}.jpg`}const{data:s,error:o}=await this.supabase.from("plant_images").insert({plant_id:e,user_id:n,url:i,storage_path:a,is_profile_image:r.isProfileImage,health_analysis:r.healthAnalysis}).select().single();if(o)throw o;if(!s.url)throw new Error("Image URL not returned from database.");return{id:s.id,url:s.url,timestamp:new Date(s.created_at),isProfileImage:s.is_profile_image||!1,healthAnalysis:s.health_analysis}}catch(i){throw console.error("Error adding plant image:",i),new Error(`Image upload failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async setProfileImage(e,r,n){try{await this.supabase.from("plant_images").update({is_profile_image:!1}).eq("plant_id",e).eq("user_id",n);const{error:i}=await this.supabase.from("plant_images").update({is_profile_image:!0}).eq("id",r).eq("user_id",n);if(i)throw i}catch(i){throw console.error("Error setting profile image:",i),i}}async deleteImage(e,r){try{const{data:n,error:i}=await this.supabase.from("plant_images").select("storage_path").eq("id",e).eq("user_id",r).single();if(i)throw i;n?.storage_path&&await this.supabase.storage.from("plant-images").remove([n.storage_path]);const{error:a}=await this.supabase.from("plant_images").delete().eq("id",e).eq("user_id",r);if(a)throw a}catch(n){throw console.error("Error deleting image:",n),n}}}const hs=new lg(Et);class j3{constructor(){Nr(this,"cache",new Map);Nr(this,"CACHE_DURATIONS",{GARDEN_CONTEXT:5*60*1e3,GARDEN_SUMMARY:3*60*1e3,SUGGESTED_QUESTIONS:10*60*1e3,PLANT_DATA:2*60*1e3})}getCacheKey(e,r){return`${e}:${r}`}isValidCache(e){return e?Date.now()<e.expiresAt:!1}getCachedData(e){const r=this.cache.get(e);return this.isValidCache(r)?r.data:(r&&this.cache.delete(e),null)}setCachedData(e,r,n){const i={data:r,timestamp:Date.now(),expiresAt:Date.now()+n};this.cache.set(e,i),console.log(`[GardenCache] Cache SET for key: ${e}, expires in ${n/1e3}s`)}getGardenContext(e){const r=this.getCacheKey(e,"garden_context");return this.getCachedData(r)}setGardenContext(e,r){const n=this.getCacheKey(e,"garden_context");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_CONTEXT)}getGardenSummary(e){const r=this.getCacheKey(e,"garden_summary");return this.getCachedData(r)}setGardenSummary(e,r){const n=this.getCacheKey(e,"garden_summary");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_SUMMARY)}getSuggestedQuestions(e){const r=this.getCacheKey(e,"suggested_questions");return this.getCachedData(r)}setSuggestedQuestions(e,r){const n=this.getCacheKey(e,"suggested_questions");this.setCachedData(n,r,this.CACHE_DURATIONS.SUGGESTED_QUESTIONS)}getPlantData(e){const r=this.getCacheKey(e,"plant_data");return this.getCachedData(r)}setPlantData(e,r){const n=this.getCacheKey(e,"plant_data");this.setCachedData(n,r,this.CACHE_DURATIONS.PLANT_DATA)}invalidateCache(e,r){r?r.forEach(n=>{const i=this.getCacheKey(e,n);this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)}):Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>{this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)})}invalidateOnPlantChange(e){console.log("[GardenCache] Plant data changed, invalidating related caches"),this.invalidateCache(e,["garden_context","garden_summary","plant_data","suggested_questions"])}getCacheStats(e){const r=Array.from(this.cache.keys()),n=r.filter(s=>s.startsWith(`${e}:`));let i=0,a=0;return n.forEach(s=>{const o=this.cache.get(s);o&&(this.isValidCache(o)?i++:a++)}),{totalEntries:r.length,userEntries:n.length,validEntries:i,expiredEntries:a}}cleanup(){const e=Date.now(),r=[];this.cache.forEach((n,i)=>{e>=n.expiresAt&&r.push(i)}),r.forEach(n=>{this.cache.delete(n)}),r.length>0&&console.log(`[GardenCache] Cleaned up ${r.length} expired entries`)}clearAll(){this.cache.size,this.cache.clear()}}const Fo=new j3;typeof window<"u"&&setInterval(()=>{Fo.cleanup()},5*60*1e3);const fo=new lg,mo={isLoading:!1,error:null},Wn=sp((t,e)=>({plants:[],operationStates:{add:{...mo},update:{...mo},delete:{...mo},addImage:{...mo},chat:{...mo}},selectedPlantId:null,getOperationState:r=>e().operationStates[r],getPlantById:r=>e().plants.find(n=>n.id===r),setPlant:r=>{t(Se(n=>{const i=n.plants.findIndex(a=>a.id===r.id);i!==-1?n.plants[i]=r:n.plants.push(r)}))},addPlant:async(r,n,i)=>{t(Se(a=>{a.operationStates.add.isLoading=!0,a.operationStates.add.error=null,a.operationStates.add.lastOperation="addPlant"}));try{const a=await fo.addPlantFromAnalysis(i,r,n);return t(Se(s=>{s.plants.unshift(a),s.operationStates.add.isLoading=!1})),Fo.invalidateOnPlantChange(i),a}catch(a){const s=a instanceof Error?a.message:"Failed to add plant";throw t(Se(o=>{o.operationStates.add.isLoading=!1,o.operationStates.add.error=s})),a}},updatePlant:async(r,n)=>{t(Se(i=>{i.operationStates.update.isLoading=!0,i.operationStates.update.error=null,i.operationStates.update.lastOperation=`updatePlant-${r.id}`}));try{const i=await fo.updatePlant(r,n);t(Se(a=>{const s=a.plants.findIndex(o=>o.id===i.id);s!==-1&&(a.plants[s]=i),a.operationStates.update.isLoading=!1})),Fo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to update plant";throw t(Se(s=>{s.operationStates.update.isLoading=!1,s.operationStates.update.error=a})),i}},deletePlant:async(r,n)=>{t(Se(i=>{i.operationStates.delete.isLoading=!0,i.operationStates.delete.error=null,i.operationStates.delete.lastOperation=`deletePlant-${r}`}));try{await fo.deletePlant(r,n),t(Se(i=>{i.plants=i.plants.filter(a=>a.id!==r),i.operationStates.delete.isLoading=!1})),Fo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to delete plant";throw t(Se(s=>{s.operationStates.delete.isLoading=!1,s.operationStates.delete.error=a})),i}},addChatMessage:async(r,n,i)=>{t(Se(o=>{o.operationStates.chat.isLoading=!0,o.operationStates.chat.error=null,o.operationStates.chat.lastOperation=`addChatMessage-${r}`}));const a=e().getPlantById(r);if(!a){t(Se(o=>{o.operationStates.chat.isLoading=!1,o.operationStates.chat.error="Plant not found to add message"}));return}const s={id:`temp-user-${Date.now()}`,sender:"user",content:n,timestamp:new Date};t(Se(o=>{o.plants.find(l=>l.id===r)?.chatHistory.push(s)}));try{const[o,l]=await fo.sendChatMessageAndGetResponse(a,{sender:"user",content:n,timestamp:s.timestamp},i);t(Se(c=>{const u=c.plants.find(h=>h.id===r);u&&(u.chatHistory=[...u.chatHistory.filter(h=>h.id!==s.id),o,l]),c.operationStates.chat.isLoading=!1}))}catch(o){const l=o instanceof Error?o.message:"Failed to send message";t(Se(c=>{c.operationStates.chat.isLoading=!1,c.operationStates.chat.error=l}))}},addPlantImage:async(r,n,i)=>{t(Se(a=>{a.operationStates.addImage.isLoading=!0,a.operationStates.addImage.error=null,a.operationStates.addImage.lastOperation=`addImage-${r}`}));try{const a=await fo.addPlantImage(r,{url:n,timestamp:new Date,isProfileImage:!1},i);t(Se(s=>{const o=s.plants.find(l=>l.id===r);o&&o.images.push(a),s.operationStates.addImage.isLoading=!1}))}catch(a){const s=a instanceof Error?a.message:"Failed to add image";throw t(Se(o=>{o.operationStates.addImage.isLoading=!1,o.operationStates.addImage.error=s})),a}},selectPlant:r=>t({selectedPlantId:r}),clearError:r=>{t(Se(r?n=>{n.operationStates[r].error=null}:n=>{Object.keys(n.operationStates).forEach(i=>{n.operationStates[i].error=null})}))},clearPlants:()=>t({plants:[],selectedPlantId:null})}));class O3{async updatePlantHealthDiagnosis(e){if(!e.images||e.images.length===0)throw new Error("Esta planta no tiene imgenes para analizar. Toma una foto primero.");const r=[...e.images].sort((a,s)=>s.timestamp.getTime()-a.timestamp.getTime())[0],{data:{session:n},error:i}=await Et.auth.getSession();if(i||!n?.access_token)throw console.error(" [Health] User session not available:",i),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");try{const a=await fetch(r.url,{method:"HEAD"});if(!a.ok)throw new Error(`Imagen no accesible: ${a.status}`)}catch(a){throw console.error(" [Health] Error verificando acceso a imagen:",a),new Error("La imagen de la planta no est disponible. Intenta tomar una nueva foto.")}console.log(" [Health] Llamando a update-health-diagnosis...");try{const{data:a,error:s}=await Et.functions.invoke("update-health-diagnosis",{body:{imageUrl:r.url,plantName:e.name,species:e.species},headers:{Authorization:`Bearer ${n.access_token}`}});if(s)throw console.error(" [Health] Error en funcin update-health-diagnosis:",s),new Error(`Error en anlisis: ${s.message}`);if(!a||!a.overallHealth)throw console.error(" [Health] Datos incompletos del anlisis:",a),new Error("El anlisis no devolvi informacin de salud vlida.");console.log(" [Health] Anlisis de salud completado exitosamente:",{overallHealth:a.overallHealth,confidence:a.confidence,issuesCount:a.issues?.length||0,recommendationsCount:a.recommendations?.length||0});const l={excellent:95,good:80,fair:60,poor:30}[a.overallHealth]||a.confidence||60;return console.log(" [Health] Nuevo score de salud calculado:",{overallHealth:a.overallHealth,numericScore:l,confidence:a.confidence}),{healthScore:l,healthAnalysis:a,updatedImage:{...r,healthAnalysis:a}}}catch(a){console.error(" [Health] Error en diagnstico primario:",a),console.log(" [Health] Intentando anlisis de fallback...");try{if(r.healthAnalysis&&r.healthAnalysis.overallHealth){console.log(" [Health] Usando anlisis existente de la imagen");const s=r.healthAnalysis;return{healthScore:{excellent:95,good:80,fair:60,poor:30}[s.overallHealth]||60,healthAnalysis:s,updatedImage:r}}}catch(s){console.error(" [Health] Error en fallback:",s)}throw new Error("No se pudo actualizar el diagnstico de salud. Verifica tu conexin a internet e intenta nuevamente.")}}async updatePlantHealthScore(e,r,n,i,a){try{console.log(" [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await Et.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error(" [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log(" [DB] Actualizando anlisis de salud en imagen:",a);const{error:o}=await Et.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn(" [DB] Error actualizando anlisis en imagen:",o)}console.log(" [DB] Health score actualizado exitosamente")}catch(s){throw console.error(" [DB] Error en updatePlantHealthScore:",s),s}}}const Hb=new O3,Od=()=>{const t=ad(),{addPlant:e,updatePlant:r,deletePlant:n}=Wn.getState(),a=kn(h=>h.user)?.id,{addToast:s}=Us(),o=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");const{imageDataUrl:m,location:p}=h;return e(m,p,a)},onSuccess:h=>{t.invalidateQueries({queryKey:["plants",a]})},onError:h=>{console.error("Failed to create plant:",h)}}),l=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return r(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.map(p=>p.id===h.id?h:p)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:h=>{t.invalidateQueries({queryKey:["plants",a]})}}),c=Ei({mutationFn:async({plant:h,userId:m})=>{console.log(" [Mutation] Iniciando actualizacin de diagnstico...");const p=await Hb.updatePlantHealthDiagnosis(h);return await Hb.updatePlantHealthScore(h.id,m,p.healthScore,p.healthAnalysis,p.updatedImage.id),console.log(" [Mutation] Diagnstico actualizado exitosamente"),p},onSuccess:(h,{plant:m})=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",m.id]}),s({type:"success",title:"Diagnstico Actualizado",message:`Nuevo estado de salud: ${h.healthScore}%`})},onError:h=>{console.error(" [Mutation] Error actualizando diagnstico:",h),s({type:"error",title:"Error en Diagnstico",message:h.message})}}),u=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return n(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.filter(p=>p.id!==h)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:()=>{t.invalidateQueries({queryKey:["plants",a]})}});return{createPlant:o.mutate,isCreatingPlant:o.isPending,updatePlant:l.mutate,isUpdatingPlant:l.isPending,updatePlantHealthMutation:c.mutate,isUpdatingPlantHealth:c.isPending,deletePlant:u.mutate,isDeletingPlant:u.isPending}},R3=()=>{const[t,e]=w.useState(!1),r=ar(),{createPlant:n,isCreatingPlant:i}=Od();w.useEffect(()=>{const o=l=>{l.key==="Escape"&&e(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]);const a=[{id:"camera",icon:Kn,label:"Tomar Foto",color:"bg-blue-500",action:()=>{e(!1),r(gt.toCamera())}},{id:"gallery",icon:np,label:"Galera",color:"bg-purple-500",action:()=>s()}],s=w.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async l=>{const c=l.target.files?.[0];if(c){const u=new FileReader;u.onload=async h=>{const m=h.target?.result;if(m){e(!1);const p=new Promise((v,b)=>{n({imageDataUrl:m,location:"Interior"},{onSuccess:g=>{g?.id&&r(gt.toPlantDetail(g.id)),v(g)},onError:g=>{console.error("Failed to create plant:",g),b(g)}})});vT.promise(p,{loading:"Analizando imagen... La IA est trabajando.",success:v=>`Planta "${v.name}" creada con xito!`,error:v=>`Error: ${v.message}`})}},u.readAsDataURL(c)}},o.click()},[n,r]);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative flex items-center",children:[d.jsx(L.button,{onClick:()=>e(!t),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},disabled:i,"aria-label":t?"Cerrar men":"Agregar planta","aria-expanded":t,children:d.jsx(ke,{mode:"wait",children:i?d.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:d.jsx(ya,{className:"w-6 h-6 animate-spin"})},"loading"):d.jsx(L.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:t?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:d.jsx(rp,{className:"w-6 h-6"})},"plus")})}),t&&d.jsx(L.span,{initial:{opacity:0,x:10},animate:{opacity:1,x:16},exit:{opacity:0,x:10},transition:{duration:.2},className:"ml-3 px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-xs font-medium shadow-md whitespace-nowrap z-50",children:"Agregar planta"})]}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:a.map((o,l)=>d.jsxs(L.button,{onClick:o.action,className:`w-12 h-12 ${o.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:l*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(a.length-l)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":o.label,children:[d.jsx(o.icon,{className:"w-5 h-5"}),d.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:d.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[o.label,d.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},o.id))})}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)})})]})},D3=[{icon:Qc,path:wt.dashboard,label:"Inicio",description:"Tu jardn personal"},{icon:Ho,path:wt.gardenChat,label:"Chat IA",description:"Asistente de plantas"},{icon:bk,path:wt.settings,label:"Ajustes",description:"Configuracin"}],M3=()=>{const t=A_(),e=t.pathname.startsWith("/plant/");return d.jsxs(d.Fragment,{children:[d.jsx("nav",{className:"safe-bottom fixed bottom-0 left-0 right-0 z-50 glass-enhanced border-t border-contrast","data-tour":"bottom-navigation",children:d.jsx("div",{className:"flex justify-around items-center h-20 max-w-lg mx-auto px-2",children:D3.map(r=>{const n=h$(t.pathname,r.path);return d.jsx(L.div,{className:"relative flex-1 h-full",whileTap:{scale:.92},whileHover:{scale:1.02},children:d.jsxs(gk,{to:r.path,className:Oe("touch-target relative flex flex-col items-center justify-center w-full h-full rounded-2xl transition-all duration-200","focus-contrast",n?"text-primary-700 dark:text-primary-400":"text-neutral-700 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400"),"aria-label":`${r.label} - ${r.description}`,...n?{"aria-current":"page"}:{},...r.path===wt.gardenChat?{"data-tour":"chat-tab"}:{},children:[d.jsx(ke,{children:n&&d.jsx(L.div,{layoutId:"nav-background",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:400,damping:30},className:"absolute inset-1 bg-primary-500/10 dark:bg-primary-400/10 rounded-xl"})}),d.jsx(L.div,{animate:{scale:n?1.1:1,y:n?-2:0},transition:{duration:.2},className:Oe("relative z-10",n?"text-[#2A7F3E]":"text-[#888]"),children:d.jsx(r.icon,{size:24,strokeWidth:n?2.5:2,className:"drop-shadow-sm"})}),d.jsx(L.span,{animate:{scale:n?1.05:1,fontWeight:n?600:500},transition:{duration:.2},className:"text-xs mt-1 relative z-10",children:r.label}),d.jsx(ke,{children:n&&d.jsx(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1},className:"absolute left-1/2 -translate-x-1/2 w-1 h-1 bg-primary-500 dark:bg-primary-400 rounded-full mt-1.5"})})]})},r.path)})})}),!e&&d.jsx("div",{className:"fixed bottom-20 sm:bottom-24 right-4 sm:right-6 z-40","data-tour":"add-plant-fab",children:d.jsx(R3,{})})]})},L3=()=>{const[t,e]=w.useState(navigator.onLine);return w.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t},$3=()=>{const t=L3();return d.jsxs(ke,{children:[!t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",children:d.jsx("div",{className:"bg-red-500 text-white px-4 py-2 text-center text-sm font-medium",children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(xk,{size:16}),d.jsx("span",{children:"Sin conexin - Modo offline"})]})})}),t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",onAnimationComplete:()=>{setTimeout(()=>{const e=document.querySelector("[data-online-indicator]");e&&e.remove()},2e3)},children:d.jsx("div",{className:"bg-green-500 text-white px-4 py-2 text-center text-sm font-medium","data-online-indicator":!0,children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(I_,{size:16}),d.jsx("span",{children:"Conexin restaurada"})]})})})]})},V3="1.0.0",z3="2025-08-09T03:54:37.628Z",F3="9 de agosto de 2025, 03:54",da={name:"Plantitas",version:V3,buildDate:F3,buildTimestamp:z3,author:"Felipe Aurelio",repository:"https://github.com/felipeaurelio13/plantitas-app"},U3=()=>`${da.name} v${da.version} (${da.buildDate})`,B3=({className:t="",showVersion:e=!0,showBuildInfo:r=!1})=>d.jsxs("footer",{className:`text-center py-4 text-sm text-muted-foreground ${t}`,children:[e&&d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-foreground",children:da.name}),d.jsx("p",{className:"text-xs opacity-75",children:U3()})]}),r&&d.jsxs("div",{className:"mt-2 text-xs opacity-50",children:[d.jsxs("p",{children:["Build: ",da.buildTimestamp]}),d.jsxs("p",{children:["Repo: ",da.repository]})]}),d.jsx("div",{className:"mt-2 text-xs opacity-60",children:d.jsxs("p",{children:[" 2024 ",da.author,". Todos los derechos reservados."]})})]});function H3(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var a;const s=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(i))!=null?a:null;return o instanceof Promise?o.then(s):s(o)},setItem:(i,a)=>r.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>r.removeItem(i)}}const hm=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return hm(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return hm(n)(r)}}}},W3=(t,e)=>(r,n,i)=>{let a={storage:H3(()=>localStorage),partialize:b=>b,version:0,merge:(b,g)=>({...g,...b}),...e},s=!1;const o=new Set,l=new Set;let c=a.storage;if(!c)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},n,i);const u=()=>{const b=a.partialize({...n()});return c.setItem(a.name,{state:b,version:a.version})},h=i.setState;i.setState=(b,g)=>{h(b,g),u()};const m=t((...b)=>{r(...b),u()},n,i);i.getInitialState=()=>m;let p;const v=()=>{var b,g;if(!c)return;s=!1,o.forEach(T=>{var E;return T((E=n())!=null?E:m)});const _=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(b=n())!=null?b:m))||void 0;return hm(c.getItem.bind(c))(a.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==a.version){if(a.migrate){const E=a.migrate(T.state,T.version);return E instanceof Promise?E.then(j=>[!0,j]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var E;const[j,R]=T;if(p=a.merge(R,(E=n())!=null?E:m),r(p,!0),j)return u()}).then(()=>{_?.(p,void 0),p=n(),s=!0,l.forEach(T=>T(p))}).catch(T=>{_?.(void 0,T)})};return i.persist={setOptions:b=>{a={...a,...b},b.storage&&(c=b.storage)},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>s,onHydrate:b=>(o.add(b),()=>{o.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},a.skipHydration||v(),p||m},q3=W3,K3=sp()(q3((t,e)=>({isDark:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1,toggleTheme:()=>{const{isDark:r}=e(),n=!r;t({isDark:n}),rf(n),"vibrate"in navigator&&navigator.vibrate(50)},setTheme:r=>{t({isDark:r}),rf(r)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t&&rf(t.isDark)}})),rf=t=>{if(typeof window>"u")return;const e=t?"dark":"light";document.documentElement.setAttribute("data-theme",e),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},G3=()=>{const t=A_(),{isDark:e}=K3(),r=t.pathname==="/camera",n=()=>{const a={"/":"Pgina de inicio - Tu jardn personal","/camera":"Cmara - Agregar nueva planta","/chat":"Chat con IA - Asistente de plantas","/garden-chat":"Chat del jardn - Consultas generales","/settings":"Configuracin - Ajustes de la aplicacin"},s=t.pathname.includes("/plant/")?"/plant":t.pathname,o=a[s]||a[t.pathname]||"Pgina",l=document.createElement("div");l.setAttribute("aria-live","polite"),l.setAttribute("aria-atomic","true"),l.setAttribute("class","sr-only"),l.textContent=`Navegando a ${o}`,document.body.appendChild(l),setTimeout(()=>{document.body.removeChild(l)},1e3)};w.useEffect(()=>{n()},[t.pathname]),w.useEffect(()=>{const a=e?"dark":"light";document.documentElement.setAttribute("data-theme",a)},[e]);const i=()=>d.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only fixed top-4 left-4 z-50 bg-primary-600 text-white px-4 py-2 rounded-md font-medium transition-all duration-200 focus:shadow-lg",onFocus:a=>{a.currentTarget.scrollIntoView({behavior:"smooth"})},children:"Saltar al contenido principal"});return d.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[d.jsx(i,{}),d.jsx("h1",{className:"sr-only",children:"Plantitas - Aplicacin de cuidado de plantas"}),d.jsx("main",{id:"main-content",role:"main","aria-label":"Contenido principal",className:"pb-28 min-h-screen focus:outline-none",tabIndex:-1,children:d.jsx(ke,{mode:"wait",children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"w-full h-full",children:d.jsx(yk,{})},t.pathname)})}),d.jsx("aside",{role:"complementary","aria-label":"Informacin de estado",children:d.jsx($3,{})}),!r&&d.jsx("nav",{role:"navigation","aria-label":"Navegacin inferior",children:d.jsx(M3,{})}),!r&&d.jsx(B3,{className:"mt-auto pt-4 pb-20",showVersion:!0,showBuildInfo:!1}),d.jsx("style",{children:`
        @media (prefers-contrast: high) {
          :root {
            --color-background: #000000;
            --color-surface: #111111;
            --color-text-primary: #ffffff;
            --color-text-secondary: #ffffff;
            --color-border: #ffffff;
            --color-accent: #00ff00;
          }
        }

        @media (prefers-reduced-motion: reduce) {
          * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Screen reader only utility */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .sr-only.focus\\:not-sr-only:focus {
          position: static;
          width: auto;
          height: auto;
          padding: inherit;
          margin: inherit;
          overflow: visible;
          clip: auto;
          white-space: normal;
        }

        /* Enhanced focus indicators */
        *:focus-visible {
          outline: 3px solid var(--color-accent) !important;
          outline-offset: 2px !important;
          border-radius: 4px;
        }

        /* High contrast focus ring */
        @media (prefers-contrast: high) {
          *:focus-visible {
            outline: 4px solid #00ff00 !important;
            outline-offset: 3px !important;
          }
        }
      `})]})};class Y3 extends w.Component{constructor(r){super(r);Nr(this,"handleReload",()=>{window.location.reload()});Nr(this,"handleGoHome",()=>{window.location.href="/plantitas-app/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n});const i={userAgent:navigator.userAgent,platform:navigator.platform,isOnline:navigator.onLine,viewport:{width:window.innerWidth,height:window.innerHeight},url:window.location.href,timestamp:new Date().toISOString()};console.error("[ErrorBoundary] Error caught:",{error:r.message,stack:r.stack,errorInfo:n,mobileInfo:i}),console.warn("[ErrorBoundary] Production error detected:",{message:r.message,mobile:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:d.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-md w-full",children:d.jsxs("div",{className:"glass-effect rounded-2xl p-8 text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:d.jsx(_n,{size:32,className:"text-red-500"})}),d.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Oops! Algo sali mal"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. No te preocupes, tus plantas estn seguras."}),!1,d.jsxs("div",{className:"space-y-3",children:[d.jsxs("button",{onClick:this.handleReload,className:"w-full px-4 py-3 bg-primary-500 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(Ni,{size:18}),d.jsx("span",{children:"Recargar Pgina"})]}),d.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-4 py-3 bg-gray-600 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(Qc,{size:18}),d.jsx("span",{children:"Ir al Inicio"})]})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-4",children:"Si el problema persiste, intenta limpiar el cach del navegador."})]})})}):this.props.children}}const Z3=()=>{const t=kn(e=>e.user);return __({queryKey:["plants",t?.id],queryFn:async()=>t?hs.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:gi.QUERY.STALE_TIME.MEDIUM,gcTime:gi.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]})},Wb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,qb=Le,cg=(t,e)=>r=>{var n;if(e?.variants==null)return qb(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,s=Object.keys(i).map(c=>{const u=r?.[c],h=a?.[c];if(u===null)return null;const m=Wb(u)||Wb(h);return i[c][m]}),o=r&&Object.entries(r).reduce((c,u)=>{let[h,m]=u;return m===void 0||(c[h]=m),c},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...a,...o}[b]):{...a,...o}[b]===g})?[...c,h,m]:c},[]);return qb(t,s,l,r?.class,r?.className)},X3=cg("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),Ir=H.forwardRef(({className:t,variant:e,size:r,radius:n,interactive:i,hover:a=!1,loading:s=!1,children:o,ariaLabel:l,...c},u)=>d.jsx(L.div,{whileHover:i&&!s?{scale:a?1.02:1.01,y:a?-4:-2}:void 0,whileTap:i&&!s?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe(X3({variant:e,size:r,radius:n,interactive:i}),s&&"animate-pulse",t),ref:u,...c,children:s?d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));Ir.displayName="Card";const Rd=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex flex-col space-y-1.5 pb-4",t),...e}));Rd.displayName="CardHeader";const ug=H.forwardRef(({className:t,...e},r)=>d.jsx("h3",{ref:r,className:Oe("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",t),...e}));ug.displayName="CardTitle";const Q3=H.forwardRef(({className:t,...e},r)=>d.jsx("p",{ref:r,className:Oe("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",t),...e}));Q3.displayName="CardDescription";const Jn=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("",t),...e}));Jn.displayName="CardContent";const aA=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",t),...e}));aA.displayName="CardFooter";const po=new Set,Ec=new Map,dg=({src:t,alt:e,className:r="",fallback:n,onLoad:i,onError:a,priority:s=!1,sizes:o="(max-width: 768px) 100vw, 50vw",srcSet:l,blurDataUrl:c})=>{const[u,h]=w.useState(()=>po.has(t)),[m,p]=w.useState(!1),[v,b]=w.useState(s),g=w.useRef(null),_=w.useRef(null);w.useEffect(()=>{if(s)return;const j=new IntersectionObserver(([R])=>{R.isIntersecting&&(b(!0),j.disconnect())},{rootMargin:"50px",threshold:.1});return _.current&&j.observe(_.current),()=>j.disconnect()},[s]),w.useEffect(()=>{if(s&&!po.has(t)&&!Ec.has(t)){const j=new Image;j.src=t,j.onload=()=>{po.add(t),Ec.set(t,j)},j.onerror=()=>{Ec.delete(t)},Ec.set(t,j)}},[t,s]);const T=w.useCallback(()=>{po.add(t),h(!0),i?.()},[i,t]),E=w.useCallback(()=>{po.delete(t),p(!0),a?.()},[a,t]);return m&&n?d.jsx(d.Fragment,{children:n}):m?d.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 flex items-center justify-center ${r}`,children:d.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})}):d.jsxs("div",{ref:_,className:`relative overflow-hidden ${r}`,style:{backgroundColor:"#f0f0f0"},children:[c&&d.jsx("img",{src:c,alt:"",className:"absolute inset-0 w-full h-full object-cover",style:{filter:"blur(10px)",transform:"scale(1.1)",opacity:u?0:1,transition:"opacity 0.3s ease-in-out"},"aria-hidden":"true"}),d.jsx(ke,{children:!u&&!c&&d.jsx(L.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"})}),v&&d.jsx(L.img,{ref:g,src:t,srcSet:l,alt:e,className:`w-full h-full object-cover ${u?"opacity-100":"opacity-0"}`,loading:s?"eager":"lazy",decoding:"async",fetchPriority:s?"high":"low",sizes:o,onLoad:T,onError:E,initial:{opacity:0},animate:{opacity:u?1:0},transition:{duration:.15},style:{transition:"opacity 0.3s ease-in-out, filter 0.3s ease-in-out",filter:u?"blur(0)":"blur(2px)"}})]})},sA=w.memo(({score:t,healthStatus:e,showDetailedStatus:r=!0,size:n="medium",animated:i=!0})=>{const s={small:{barWidth:"w-16",barHeight:"h-1.5",textSize:"text-xs",iconSize:"w-3 h-3",gap:"gap-1"},medium:{barWidth:"w-24",barHeight:"h-2",textSize:"text-xs",iconSize:"w-4 h-4",gap:"gap-2"},large:{barWidth:"w-32",barHeight:"h-3",textSize:"text-sm",iconSize:"w-5 h-5",gap:"gap-3"}}[n],o=()=>{const c=`${s.iconSize} mr-1`;return t>=80?d.jsx(er,{className:`${c} text-green-400`}):t>=60?d.jsx(va,{className:`${c} text-yellow-400`}):t>=40?d.jsx(gl,{className:`${c} text-orange-400`}):d.jsx(_n,{className:`${c} text-red-400`})};return d.jsxs("div",{className:`flex items-center ${s.gap} w-full`,children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[d.jsx("div",{className:`relative ${s.barWidth} ${s.barHeight} bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden`,children:i?d.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}}):d.jsx("div",{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,style:{width:`${t}%`}})}),d.jsxs("span",{className:`${s.textSize} font-semibold text-neutral-500 dark:text-neutral-400`,children:[t,"%"]})]}),r&&d.jsxs("div",{className:`flex items-center ${s.gap.replace("gap-","gap-1")} ${s.textSize} px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700`,children:[o(),d.jsx("span",{className:e.textColor,children:e.status})]})]})});sA.displayName="PlantHealthIndicator";const J3=t=>{const e=ar(),r=ad(),n=w.useMemo(()=>{const u=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,h=t.lastWatered?Math.floor((new Date().getTime()-new Date(t.lastWatered).getTime())/(24*60*60*1e3)):0,m=t.healthScore>=80,p=ez(t.healthScore,u,h);return{needsWatering:u,isFavorite:m,daysSinceWatered:h,healthStatus:p}},[t.lastWatered,t.wateringFrequency,t.healthScore]),i=w.useCallback(async()=>{try{await r.prefetchQuery({queryKey:["plant",t.id],queryFn:async()=>{const{supabase:u}=await ep(async()=>{const{supabase:p}=await Promise.resolve().then(()=>d$);return{supabase:p}},void 0),{data:h,error:m}=await u.from("plants").select(`
              *,
              plant_images(*)
            `).eq("id",t.id).single();if(m)throw m.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la informacin de la planta.");return h},staleTime:5*60*1e3})}catch(u){console.warn("Failed to prefetch plant data:",u)}},[t.id,r]),a=w.useCallback(()=>{e(gt.toPlantDetail(t.id))},[e,t.id]),s=w.useCallback(()=>{e(gt.toPlantChat(t.id))},[e,t.id]),o=w.useCallback(()=>{a()},[a]),l=w.useCallback(()=>{i()},[i]);return{state:n,actions:{handleClick:o,handleMouseEnter:l,prefetchPlantData:i,navigateToPlant:a,navigateToChat:s},plant:t}};function ez(t,e,r){let n;if(t>=80?n={color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",status:"Excelente",priority:"low"}:t>=60?n={color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",status:"Buena",priority:"medium"}:n={color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",status:"Atencin",priority:"high"},e){if(r>7)return{...n,color:"bg-red-400",textColor:"text-red-700 dark:text-red-300",status:"Necesita agua urgente",priority:"high"};if(r>3)return{...n,color:"bg-orange-400",textColor:"text-orange-700 dark:text-orange-300",status:"Necesita agua",priority:"medium"}}return n}const tz=t=>({src:t.profileImageUrl||"/placeholder-plant.jpg",alt:`${t.name} - ${t.species}`,className:"w-full h-48 object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),rz=t=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Math.min(t*.1,.5)},whileHover:{y:-4,transition:{duration:.2}},whileTap:{scale:.98,transition:{duration:.1}}}),oA=w.memo(({plant:t,index:e})=>{const{state:r,actions:n}=J3(t),{needsWatering:i,isFavorite:a,healthStatus:s}=r,{handleClick:o,handleMouseEnter:l}=n,c=tz(t),u=rz(e);return d.jsx(L.div,{...u,className:"group",children:d.jsxs(Ir,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:o,onMouseEnter:l,className:"overflow-hidden border border-green-200/60 hover:border-green-300/80 dark:hover:border-green-600 transition-all duration-300 p-4 mb-4 shadow-sm hover:shadow-lg hover:shadow-green-100/30 bg-white/80 backdrop-blur-sm",children:[d.jsx(Rd,{className:"pb-2 flex-shrink-0 space-y-0",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[d.jsx(dg,{...c,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",priority:e<4,sizes:"(max-width: 768px) 20vw, 10vw",fallback:d.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:d.jsx(va,{size:24})})}),d.jsx(ke,{children:a&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(P_,{size:12,className:"text-white fill-current"})})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:d.jsx(gl,{size:12,className:"text-white"})})})})]}),d.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[d.jsx(ug,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),d.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),d.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:d.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:[" ",t.location]})})]})]})}),d.jsxs(Jn,{className:"pt-2 pb-0",children:[d.jsx(sA,{score:t.healthScore,healthStatus:s,size:"medium",animated:!0}),t.healthScore<40&&d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[d.jsx(_n,{className:"w-3 h-3 mr-1","aria-label":"Atencin"}),"Atencin!"]}),d.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),d.jsx(L.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});oA.displayName="PlantCard";function pe({className:t,...e}){return d.jsx("div",{className:Oe("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",t),...e})}const nz=()=>d.jsxs(Ir,{variant:"elevated",size:"default",className:"overflow-hidden",children:[d.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[d.jsx(pe,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs(Rd,{className:"p-0",children:[d.jsx(pe,{className:"h-6 w-3/4"}),d.jsx(pe,{className:"h-4 w-1/2 mt-2"})]}),d.jsx(Jn,{className:"p-0 mt-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(pe,{className:"w-16 h-1.5"}),d.jsx(pe,{className:"w-8 h-3"})]})})]})]}),d.jsx(aA,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:d.jsxs("div",{className:"flex justify-between items-center w-full",children:[d.jsx(pe,{className:"h-4 w-1/3"}),d.jsx(pe,{className:"w-8 h-8 rounded"})]})})]}),iz=cg("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),me=H.forwardRef(({className:t,variant:e,size:r,fullWidth:n,loading:i=!1,leftIcon:a,rightIcon:s,children:o,disabled:l,...c},u)=>{const h=l||i;return d.jsxs(L.button,{whileTap:h?void 0:{scale:.96},whileHover:h?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:Oe(iz({variant:e,size:r,fullWidth:n,className:t})),disabled:h,ref:u,...c,children:[i&&d.jsx(L.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),a&&!i&&d.jsx("span",{className:"mr-2 -ml-1",children:a}),d.jsx("span",{className:Oe("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(m=>typeof m=="string"||typeof m=="number"||H.isValidElement(m)):typeof o=="string"||typeof o=="number"||H.isValidElement(o)?o:null}),s&&d.jsx("span",{className:"ml-2 -mr-1",children:s})]})});me.displayName="Button";const az=cg("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Dd=H.forwardRef(({className:t,variant:e,size:r,state:n,label:i,helperText:a,errorMessage:s,successMessage:o,leftIcon:l,rightIcon:c,loading:u=!1,showPasswordToggle:h=!1,floatingLabel:m=!1,type:p,disabled:v,value:b,defaultValue:g,..._},T)=>{const[E,j]=w.useState(!1),[R,D]=w.useState(!1),[S,A]=w.useState(b||g||""),P=w.useRef(null),O=w.useCallback(he=>{P.current=he,typeof T=="function"?T(he):T&&(T.current=he)},[T]),N=s?"error":o?"success":n,C=!!S||E,k=h?R?"text":"password":p;w.useEffect(()=>{b!==void 0&&A(b)},[b]);const Q=he=>{j(!0),_.onFocus?.(he)},oe=he=>{j(!1),_.onBlur?.(he)},X=he=>{A(he.target.value),_.onChange?.(he)},ee=()=>{P.current?.focus()};return d.jsxs("div",{className:"w-full",children:[d.jsxs("div",{className:"relative",children:[i&&!m&&d.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),d.jsxs("div",{className:"relative",children:[l&&d.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:l}),i&&m&&d.jsx(L.label,{onClick:ee,animate:{scale:C?.85:1,y:C?-24:0,x:C?4:l?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",C&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),d.jsx("input",{ref:O,type:k,value:S,disabled:v||u,className:Oe(az({variant:e,size:r,state:N}),l&&"pl-10",(c||h||u)&&"pr-10",m&&C&&"pt-6 pb-2",(!r||r==="default")&&"py-[12px]","placeholder-[#777]",t),style:{..._.style},onFocus:Q,onBlur:oe,onChange:X,..._}),d.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[u&&d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:d.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!u&&N==="error"&&d.jsx(Jr,{className:"w-4 h-4 text-error-500"}),!u&&N==="success"&&d.jsx(Ai,{className:"w-4 h-4 text-success-500"}),h&&!u&&d.jsx("button",{type:"button",onClick:()=>D(!R),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:R?d.jsx(wk,{className:"w-4 h-4"}):d.jsx(If,{className:"w-4 h-4"})}),c&&!u&&d.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:c})]})]}),d.jsx(ke,{children:E&&d.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:Oe("absolute inset-0 rounded-xl pointer-events-none",N==="error"&&"ring-2 ring-error-500/20",N==="success"&&"ring-2 ring-success-500/20",N==="default"&&"ring-2 ring-primary-500/20")})})]}),d.jsx(ke,{mode:"wait",children:(a||s||o)&&d.jsxs(L.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[s&&d.jsxs(d.Fragment,{children:[d.jsx(Jr,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),d.jsx("span",{className:"text-error-600 dark:text-error-400",children:s})]}),o&&!s&&d.jsxs(d.Fragment,{children:[d.jsx(Ai,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),d.jsx("span",{className:"text-success-600 dark:text-success-400",children:o})]}),a&&!s&&!o&&d.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:a})]})})]})});Dd.displayName="Input";const sz={default:ya,ai:N_,camera:Kn,upload:k_,download:Ak,sync:Tk,search:Ek,save:_k,delete:C_,chat:yl},oz={sm:{icon:"w-4 h-4",text:"text-sm",gap:"gap-2"},md:{icon:"w-5 h-5",text:"text-base",gap:"gap-3"},lg:{icon:"w-6 h-6",text:"text-lg",gap:"gap-4"}},lz=({message:t,type:e="default",size:r="md",className:n=""})=>{const i=sz[e],a=oz[r];return d.jsxs("div",{className:`flex items-center justify-center ${a.gap} ${n}`,children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"flex-shrink-0",children:d.jsx(i,{className:`${a.icon} text-primary-500`})}),d.jsx("span",{className:`${a.text} text-gray-600 dark:text-gray-400 font-medium`,children:t})]})},cz={LoadingPlants:t=>d.jsx(lz,{message:"Cargando tu jardn...",type:"default",...t})},fm=({children:t,content:e,position:r="top",delay:n=300,disabled:i=!1,className:a=""})=>{const[s,o]=w.useState(!1),[l,c]=w.useState({x:0,y:0}),u=w.useRef(null),h=w.useRef(),m=()=>{i||(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(u.current){const g=u.current.getBoundingClientRect(),_=window.pageYOffset||document.documentElement.scrollTop,T=window.pageXOffset||document.documentElement.scrollLeft;let E,j;switch(r){case"top":E=g.left+T+g.width/2,j=g.top+_-8;break;case"bottom":E=g.left+T+g.width/2,j=g.bottom+_+8;break;case"left":E=g.left+T-8,j=g.top+_+g.height/2;break;case"right":E=g.right+T+8,j=g.top+_+g.height/2;break;default:E=g.left+T+g.width/2,j=g.top+_-8}c({x:E,y:j}),o(!0)}},n))},p=()=>{h.current&&clearTimeout(h.current),o(!1)};w.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const v=()=>{const g="absolute z-[9999] px-2 py-1 text-xs font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-md shadow-lg pointer-events-none max-w-xs";switch(r){case"top":return`${g} -translate-x-1/2 -translate-y-full`;case"bottom":return`${g} -translate-x-1/2`;case"left":return`${g} -translate-x-full -translate-y-1/2`;case"right":return`${g} -translate-y-1/2`;default:return`${g} -translate-x-1/2 -translate-y-full`}},b=()=>{const g="absolute w-2 h-2 bg-gray-900 dark:bg-gray-700 transform rotate-45";switch(r){case"top":return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`;case"bottom":return`${g} left-1/2 -translate-x-1/2 -top-1`;case"left":return`${g} top-1/2 -translate-y-1/2 left-full -translate-x-1/2`;case"right":return`${g} top-1/2 -translate-y-1/2 -left-1`;default:return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`}};return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:u,onMouseEnter:m,onMouseLeave:p,onFocus:m,onBlur:p,className:`inline-block ${a}`,children:t}),typeof document<"u"&&Jm.createPortal(d.jsx(ke,{children:s&&d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:v(),style:{left:l.x,top:l.y},children:[e,d.jsx("div",{className:b()})]})}),document.body)]})},uz={network:{icon:I_,color:"text-orange-500",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Verificar conexin",action:"help"}]},validation:{icon:_n,color:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-800",defaultActions:[{label:"Corregir",action:"retry"}]},server:{icon:_n,color:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Reportar problema",action:"help"}]},unknown:{icon:Sk,color:"text-gray-500",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800",defaultActions:[{label:"Reintentar",action:"retry"}]}},dz=({title:t,message:e,type:r="unknown",onRetry:n,onDismiss:i,actions:a,className:s=""})=>{const o=uz[r],l=o.icon,c=h=>{switch(h){case"retry":n?.();break;case"help":console.log("Help requested for error type:",r);break}},u=()=>a?a.map((h,m)=>d.jsx(me,{variant:h.variant||"outline",size:"sm",onClick:h.onClick,children:h.label},m)):o.defaultActions.map((h,m)=>d.jsxs(me,{variant:m===0?"primary":"outline",size:"sm",onClick:()=>c(h.action),disabled:h.action==="retry"&&!n,children:[h.action==="retry"&&d.jsx(Ni,{className:"w-4 h-4 mr-1"}),h.action==="help"&&d.jsx(Ik,{className:"w-4 h-4 mr-1"}),h.label]},m));return d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
        ${o.bgColor} 
        ${o.borderColor} 
        border rounded-lg p-4 
        ${s}
      `,children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:`${o.color} flex-shrink-0 mt-0.5`,children:d.jsx(l,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:t}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e}),d.jsx("div",{className:"flex flex-wrap gap-2",children:u()})]}),i&&d.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar error",children:d.jsx(Ui,{className:"w-4 h-4"})})]})})},hz={LoadingPlantsError:t=>d.jsx(dz,{type:"server",title:"Error al Cargar Plantas",message:"No se pudieron cargar tus plantas. Intenta refrescar la pgina.",...t})},fz=({isOpen:t,onComplete:e,onSkip:r,steps:n})=>{const[i,a]=w.useState(0),[s,o]=w.useState(null),[l,c]=w.useState({x:0,y:0}),u=n[i],h=i===n.length-1,m=i===0;w.useEffect(()=>{if(!t||!u?.target)return;const g=document.querySelector(u.target);if(g){o(g);const _=g.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,E=window.pageXOffset||document.documentElement.scrollLeft;let j,R;switch(u.position){case"top":j=_.left+E+_.width/2,R=_.top+T-20;break;case"bottom":j=_.left+E+_.width/2,R=_.bottom+T+20;break;case"left":j=_.left+E-20,R=_.top+T+_.height/2;break;case"right":j=_.right+E+20,R=_.top+T+_.height/2;break;default:j=window.innerWidth/2,R=window.innerHeight/2}c({x:j,y:R}),g.scrollIntoView({behavior:"smooth",block:"center"})}else o(null),c({x:window.innerWidth/2,y:window.innerHeight/2})},[t,u,i]);const p=()=>{h?e():a(g=>g+1)},v=()=>{m||a(g=>g-1)},b=()=>{if(!u?.position||u.position==="center")return"-translate-x-1/2 -translate-y-1/2";switch(u.position){case"top":return"-translate-x-1/2 -translate-y-full";case"bottom":return"-translate-x-1/2";case"left":return"-translate-x-full -translate-y-1/2";case"right":return"-translate-y-1/2";default:return"-translate-x-1/2 -translate-y-1/2"}};return t?d.jsx(ke,{children:d.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60"}),s&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute pointer-events-none",style:{left:s.getBoundingClientRect().left+window.pageXOffset,top:s.getBoundingClientRect().top+window.pageYOffset,width:s.getBoundingClientRect().width,height:s.getBoundingClientRect().height,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(34, 197, 94, 0.5)",borderRadius:"8px"}}),d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 max-w-sm ${b()}`,style:{left:l.x,top:l.y},children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(er,{className:"w-5 h-5 text-green-500"}),d.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["Paso ",i+1," de ",n.length]})]}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Omitir tour",children:d.jsx(Ui,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:u.title}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:u.description})]}),u.action&&d.jsx("div",{className:"mb-4",children:d.jsx(me,{variant:"outline",size:"sm",onClick:u.action.onClick,className:"w-full",children:u.action.label})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs(me,{variant:"ghost",size:"sm",onClick:v,disabled:m,className:"flex items-center gap-1",children:[d.jsx(j_,{className:"w-4 h-4"}),"Anterior"]}),d.jsx("div",{className:"flex gap-1",children:n.map((g,_)=>d.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${_===i?"bg-green-500":_<i?"bg-green-300":"bg-gray-300"}`},_))}),d.jsxs(me,{size:"sm",onClick:p,className:"flex items-center gap-1",children:[h?"Finalizar":"Siguiente",!h&&d.jsx(O_,{className:"w-4 h-4"})]})]}),d.jsx("div",{className:"mt-4 text-center",children:d.jsx("button",{onClick:r,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Omitir tour"})})]})]})}):null},Tc="1.0.0",Kb="plantitas-onboarding-state",mz=()=>{const t=ar(),[e,r]=w.useState(()=>{try{const u=localStorage.getItem(Kb);if(u){const h=JSON.parse(u);return h.currentVersion!==Tc?{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tc}:h}}catch(u){console.warn("Error loading onboarding state:",u)}return{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tc}});w.useEffect(()=>{try{localStorage.setItem(Kb,JSON.stringify(e))}catch(u){console.warn("Error saving onboarding state:",u)}},[e]);const n=u=>{r(h=>({...h,...u}))};return{state:e,shouldShowTour:()=>!e.hasCompletedTour,completeTour:()=>{n({hasCompletedTour:!0})},markFirstPlantAdded:()=>{n({hasAddedFirstPlant:!0})},markChatUsed:()=>{n({hasUsedChat:!0})},resetOnboarding:()=>{r({hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tc})},getTourSteps:()=>[{id:"welcome",title:"Bienvenido a Plantitas! ",description:"Tu asistente personal para el cuidado de plantas. Te ayudaremos a mantener tus plantas saludables y felices.",position:"center"},{id:"add-plant",title:"Agrega tu primera planta",description:"Usa el botn flotante para tomar una foto de tu planta. Nuestra IA la identificar automticamente.",target:'[data-tour="add-plant-fab"]',position:"left",action:{label:"Ir a cmara",onClick:()=>t(gt.toCamera())}},{id:"navigation",title:"Navegacin principal",description:"Usa la navegacin inferior para moverte entre el jardn, chat IA y configuraciones.",target:'[data-tour="bottom-navigation"]',position:"top"},{id:"chat-ai",title:"Chat con IA experta",description:"Haz preguntas sobre cuidado de plantas, identificacin o cualquier duda que tengas.",target:'[data-tour="chat-tab"]',position:"top",action:{label:"Probar chat",onClick:()=>t(gt.toGardenChat())}},{id:"search-filter",title:"Busca y organiza",description:"Usa la bsqueda y filtros para encontrar rpidamente tus plantas cuando tengas muchas.",target:'[data-tour="search-input"]',position:"bottom"},{id:"complete",title:"Listo para empezar! ",description:"Ya conoces lo bsico. Comienza agregando tu primera planta y explorando todas las funciones!",position:"center"}]}},Gb=({type:t,title:e,message:r,onDismiss:n,autoHide:i=!1,duration:a=8e3,actions:s})=>{const[o,l]=w.useState(!0),c=ar();w.useEffect(()=>{if(i&&a>0){const v=setTimeout(()=>{l(!1),n?.()},a);return()=>clearTimeout(v)}},[i,a,n]);const u=()=>{l(!1),n?.()};if(!o)return null;const m={suggestion:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",accent:"text-purple-600 dark:text-purple-400",icon:N_},tip:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",accent:"text-blue-600 dark:text-blue-400",icon:er},welcome:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",accent:"text-green-600 dark:text-green-400",icon:yl}}[t],p=m.icon;return d.jsx(ke,{children:d.jsxs(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:`
          ${m.bg} ${m.border}
          border rounded-lg p-4 shadow-md backdrop-blur-sm
          relative overflow-hidden
        `,children:[d.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 opacity-10",children:d.jsx(p,{className:"w-full h-full"})}),d.jsxs("div",{className:"relative flex items-start gap-3",children:[d.jsx("div",{className:`${m.accent} flex-shrink-0 mt-0.5`,children:d.jsx(p,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:`${m.accent} text-sm font-semibold mb-1`,children:e}),d.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-3",children:r}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s?s.map((v,b)=>d.jsx(me,{size:"sm",variant:v.variant||"outline",onClick:v.onClick,className:"text-xs",children:v.label},b)):d.jsxs(me,{size:"sm",variant:"outline",onClick:()=>c(gt.toGardenChat()),className:"text-xs flex items-center gap-1",children:["Probar Chat IA",d.jsx(Pk,{className:"w-3 h-3"})]})})]}),n&&d.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar sugerencia",children:d.jsx(Ui,{className:"w-4 h-4"})})]}),i&&a>0&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10",children:d.jsx(L.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:a/1e3,ease:"linear"},className:`h-full ${m.accent.replace("text-","bg-")}`})})]})})},pz=()=>{const[t,e]=w.useState(()=>{try{const a=localStorage.getItem("dismissed-ai-highlights");return a?JSON.parse(a):[]}catch{return[]}});return{dismissHighlight:a=>{const s=[...t,a];e(s);try{localStorage.setItem("dismissed-ai-highlights",JSON.stringify(s))}catch(o){console.warn("Error saving dismissed highlights:",o)}},shouldShowHighlight:a=>!t.includes(a),resetHighlights:()=>{e([]);try{localStorage.removeItem("dismissed-ai-highlights")}catch(a){console.warn("Error resetting highlights:",a)}}}},gz=()=>{const t=ar();return d.jsxs(L.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6 max-w-lg mx-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[d.jsxs(L.div,{className:"relative w-32 h-32 mb-8",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[d.jsx(R_,{className:"absolute top-2 left-2 w-10 h-10 text-sky-400 opacity-60"}),d.jsx(sd,{className:"w-32 h-32 text-green-500"}),d.jsx(gl,{className:"absolute bottom-2 right-2 w-12 h-12 text-blue-400 opacity-70"})]}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"Comienza tu jardn digital!"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-lg leading-relaxed",children:"Aade tu primera planta tomando una foto y deja que nuestra IA la identifique y te ayude a cuidarla."}),d.jsxs("div",{className:"mb-8 space-y-3 text-left",children:[d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Identificacin automtica con IA"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Recordatorios de riego personalizados"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Chat con asistente experto en plantas"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[d.jsxs(me,{size:"lg",onClick:()=>t(gt.toCamera()),className:"flex-1",children:[d.jsx(rp,{className:"mr-2"}),"Tomar Foto"]}),d.jsx(fm,{content:"Explora las funciones de chat IA para aprender sobre plantas",children:d.jsxs(me,{size:"lg",variant:"outline",onClick:()=>t(gt.toGardenChat()),className:"flex-1",children:[d.jsx(yl,{className:"mr-2"}),"Explorar Chat IA"]})})]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6",children:" Tip: Toma fotos con buena iluminacin para mejores resultados"})]})},yz=()=>{const{data:t=[],isLoading:e,error:r}=Z3(),[n,i]=w.useState(""),[a,s]=w.useState("name"),{shouldShowTour:o,completeTour:l,getTourSteps:c}=mz(),{shouldShowHighlight:u,dismissHighlight:h}=pz(),m=w.useMemo(()=>[...t].filter(p=>p.name.toLowerCase().includes(n.toLowerCase())||p.species.toLowerCase().includes(n.toLowerCase())).sort((p,v)=>{switch(a){case"health":return(v.healthScore||0)-(p.healthScore||0);case"lastWatered":return(v.lastWatered?.getTime()||0)-(p.lastWatered?.getTime()||0);default:return p.name.localeCompare(v.name)}}),[t,n,a]);return e?d.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[d.jsxs("header",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardn"}),d.jsx(cz.LoadingPlants,{size:"sm"})]}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((p,v)=>d.jsx(nz,{},v))})]}):r?d.jsx("div",{className:"flex justify-center items-center min-h-[50vh] p-4",children:d.jsx(hz.LoadingPlantsError,{onRetry:()=>window.location.reload(),className:"max-w-md"})}):d.jsxs("div",{className:"container-spacing element-spacing bg-gradient-to-br from-green-50/30 via-white to-emerald-50/20 min-h-screen",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx("header",{className:"flex items-center justify-between border-b border-green-100/50 bg-white/70 backdrop-blur-sm pb-4 mb-6 rounded-xl px-4 py-3 shadow-sm shadow-green-100/20",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(fm,{content:"Tu jardn personal de plantas",children:d.jsx(sd,{size:20,strokeWidth:2,className:"text-[#2A7F3E] flex-shrink-0"})}),d.jsx("h1",{className:"font-semibold text-[28px] leading-[1.2] text-[#222]",children:"Mi Jardn"}),d.jsx(fm,{content:`Tienes ${t.length} ${t.length===1?"planta registrada":"plantas registradas"} en tu jardn`,children:d.jsxs("span",{className:"ml-2 bg-[#E0F2E9]/50 text-[#2A7F3E] text-sm font-medium rounded-full px-[6px] py-[2px] cursor-help",children:[t.length," ",t.length===1?"planta":"plantas"]})})]})}),t.length>0&&u("dashboard-ai-welcome")&&d.jsx("div",{className:"mb-4",children:d.jsx(Gb,{type:"welcome",title:"Tu asistente IA est disponible!",message:"Haz preguntas sobre el cuidado de tus plantas, identifica problemas o descubre nuevos consejos.",onDismiss:()=>h("dashboard-ai-welcome"),autoHide:!0,duration:1e4})}),t.length>=3&&u("dashboard-ai-tips")&&d.jsx("div",{className:"mb-4",children:d.jsx(Gb,{type:"tip",title:"Consejo del jardinero experto",message:"Con varias plantas, puedes preguntarme sobre rutinas de cuidado personalizadas para optimizar tu tiempo.",onDismiss:()=>h("dashboard-ai-tips"),autoHide:!0,duration:12e3})}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 mt-6 mb-6",children:[d.jsx(Dd,{type:"text",placeholder:"Buscar por nombre o especie...",value:n,onChange:p=>i(p.target.value),className:"max-w-md w-full mx-auto","data-tour":"search-input"}),d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsxs("select",{value:a,onChange:p=>s(p.target.value),className:"appearance-none bg-white border border-green-300 rounded-[8px] px-4 py-2 h-10 text-green-700 font-medium shadow-sm focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors duration-150 w-full pr-8",style:{borderWidth:"1px"},children:[d.jsx("option",{value:"name",children:"Ordenar por Nombre"}),d.jsx("option",{value:"health",children:"Ordenar por Salud"}),d.jsx("option",{value:"lastWatered",children:"Ordenar por Riego"})]}),d.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-green-400 text-base",children:""})]})]}),d.jsx(ke,{children:m.length>0?d.jsx(L.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.01,delayChildren:0}}},children:m.map((p,v)=>d.jsx(oA,{plant:p,index:Math.min(v,8)},p.id))}):d.jsx(gz,{})}),d.jsx(fz,{isOpen:o()&&t.length===0,onComplete:l,onSkip:l,steps:c()})]})};function mm(t){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function fr(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Tt(t){fr(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||mm(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var vz={};function bz(){return vz}function Su(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function Yb(t){fr(1,arguments);var e=Tt(t);return e.setHours(0,0,0,0),e}var xz=864e5;function wz(t,e){fr(2,arguments);var r=Yb(t),n=Yb(e),i=r.getTime()-Su(r),a=n.getTime()-Su(n);return Math.round((i-a)/xz)}function Zc(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function _z(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function Zb(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function Ez(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=Zb(r,n),a=Math.abs(wz(r,n));r.setDate(r.getDate()-i*a);var s=+(Zb(r,n)===-i),o=i*(a-s);return o===0?0:o}function Tz(t,e){return fr(2,arguments),Tt(t).getTime()-Tt(e).getTime()}var Az={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},Sz="trunc";function Iz(t){return Az[Sz]}function Pz(t){fr(1,arguments);var e=Tt(t);return e.setHours(23,59,59,999),e}function Cz(t){fr(1,arguments);var e=Tt(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function kz(t){fr(1,arguments);var e=Tt(t);return Pz(e).getTime()===Cz(e).getTime()}function Nz(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=Zc(r,n),a=Math.abs(_z(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=Zc(r,n)===-i;kz(Tt(t))&&a===1&&Zc(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function jz(t,e,r){fr(2,arguments);var n=Tz(t,e)/1e3;return Iz()(n)}var Oz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Rz=function(e,r,n){var i,a=Oz[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function xs(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var Dz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Mz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Lz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$z={date:xs({formats:Dz,defaultWidth:"full"}),time:xs({formats:Mz,defaultWidth:"full"}),dateTime:xs({formats:Lz,defaultWidth:"full"})},Vz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zz=function(e,r,n,i){return Vz[e]};function cn(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}var c=t.argumentCallback?t.argumentCallback(e):e;return i[c]}}var Fz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Uz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Bz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Hz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Wz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},qz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Kz=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Gz={ordinalNumber:Kz,era:cn({values:Fz,defaultWidth:"wide"}),quarter:cn({values:Uz,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:cn({values:Bz,defaultWidth:"wide"}),day:cn({values:Hz,defaultWidth:"wide"}),dayPeriod:cn({values:Wz,defaultWidth:"wide",formattingValues:qz,defaultFormattingWidth:"wide"})};function un(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?Zz(o,function(h){return h.test(s)}):Yz(o,function(h){return h.test(s)}),c;c=t.valueCallback?t.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var u=e.slice(s.length);return{value:c,rest:u}}}function Yz(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function Zz(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function lA(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var Xz=/^(\d+)(th|st|nd|rd)?/i,Qz=/\d+/i,Jz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},eF={any:[/^b/i,/^(a|c)/i]},tF={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rF={any:[/1/i,/2/i,/3/i,/4/i]},nF={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},iF={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aF={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sF={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},oF={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},lF={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},cF={ordinalNumber:lA({matchPattern:Xz,parsePattern:Qz,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:Jz,defaultMatchWidth:"wide",parsePatterns:eF,defaultParseWidth:"any"}),quarter:un({matchPatterns:tF,defaultMatchWidth:"wide",parsePatterns:rF,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:nF,defaultMatchWidth:"wide",parsePatterns:iF,defaultParseWidth:"any"}),day:un({matchPatterns:aF,defaultMatchWidth:"wide",parsePatterns:sF,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:oF,defaultMatchWidth:"any",parsePatterns:lF,defaultParseWidth:"any"})},uF={code:"en-US",formatDistance:Rz,formatLong:$z,formatRelative:zz,localize:Gz,match:cF,options:{weekStartsOn:0,firstWeekContainsDate:1}};function cA(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function dF(t){return cA({},t)}var Xb=1440,hF=2520,nf=43200,fF=86400;function mF(t,e,r){var n,i;fr(2,arguments);var a=bz(),s=(n=(i=r?.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:uF;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=Zc(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var l=cA(dF(r),{addSuffix:!!r?.addSuffix,comparison:o}),c,u;o>0?(c=Tt(e),u=Tt(t)):(c=Tt(t),u=Tt(e));var h=jz(u,c),m=(Su(u)-Su(c))/1e3,p=Math.round((h-m)/60),v;if(p<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):p===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",p,l);if(p<45)return s.formatDistance("xMinutes",p,l);if(p<90)return s.formatDistance("aboutXHours",1,l);if(p<Xb){var b=Math.round(p/60);return s.formatDistance("aboutXHours",b,l)}else{if(p<hF)return s.formatDistance("xDays",1,l);if(p<nf){var g=Math.round(p/Xb);return s.formatDistance("xDays",g,l)}else if(p<fF)return v=Math.round(p/nf),s.formatDistance("aboutXMonths",v,l)}if(v=Nz(u,c),v<12){var _=Math.round(p/nf);return s.formatDistance("xMonths",_,l)}else{var T=v%12,E=Math.floor(v/12);return T<3?s.formatDistance("aboutXYears",E,l):T<9?s.formatDistance("overXYears",E,l):s.formatDistance("almostXYears",E+1,l)}}function uA(t,e){return fr(1,arguments),mF(t,Date.now(),e)}const pF=async t=>{const{data:e,error:r}=await Et.from("plants").select(`
      *,
      plant_images(*)
    `).eq("id",t).single();if(r)throw console.error(`Error fetching plant ${t}:`,r),r.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la informacin de la planta.");const n=e;return{id:n.id,name:n.name,species:n.species,description:n.description??void 0,funFacts:n.fun_facts??void 0,variety:n.variety??void 0,nickname:n.nickname??void 0,location:n.location,plantEnvironment:n.plant_environment,lightRequirements:n.light_requirements,dateAdded:new Date(n.date_added),lastWatered:n.last_watered?new Date(n.last_watered):void 0,lastFertilized:n.last_fertilized?new Date(n.last_fertilized):void 0,healthScore:n.health_score??0,careProfile:n.care_profile,personality:n.personality,images:n.plant_images.map(i=>({id:i.id,url:i.url??"",timestamp:new Date(i.created_at),isProfileImage:i.is_profile_image??!1,healthAnalysis:i.health_analysis})),chatHistory:[],notifications:[]}},hg=t=>{const{data:e,isLoading:r,error:n}=__({queryKey:["plant",t],queryFn:async()=>pF(t),enabled:!!t,staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1}),i=Wn(o=>o.setPlant),a=Wn(o=>o.selectPlant);w.useEffect(()=>(e&&(i(e),a(e.id)),()=>{a(null)}),[e,i,a]);const s=w.useMemo(()=>{if(!e)return[];const o=[];if(!e.images||e.images.length===0)return o;const l=e.images.map(c=>c.healthAnalysis?.confidence||null).filter(c=>c!==null);if(l.length>=3){const c=l.slice(-3);if(c[0]>c[1]&&c[1]>c[2]){const u=c[0]-c[2];o.push({type:"warning",title:"Tendencia de Salud a la Baja",message:`La salud de tu planta ha disminuido un ${u.toFixed(0)}% en las ltimas revisiones.`})}}if(e.lastWatered&&e.careProfile){const c=Ez(new Date,new Date(e.lastWatered)),u=e.careProfile.wateringFrequency;c>u&&o.push({type:"tip",title:"Consejo de Riego",message:`Han pasado ${c} das desde el ltimo riego. El intervalo recomendado es de ${u} das.`})}return o},[e]);return{plant:e,insights:s,loading:r,error:n?.message||null}},gF=()=>{const t=ad(),r=kn(o=>o.user)?.id,{addToast:n}=Us(),i=Ei({mutationFn:async({plantId:o,imageDataUrl:l,note:c})=>{if(!r)throw new Error("User not authenticated");console.log(" [Image] Iniciando proceso de subida de imagen..."),console.log(" [Image] Analizando imagen con IA...");const u=await iA(l);console.log(" [Image] Subiendo imagen a Storage...");const h=await CT(l,"plant-images",`${r}/${o}`);console.log(" [Image] Guardando registro en base de datos...");const m=await hs.addPlantImage(o,{url:h,timestamp:new Date,isProfileImage:!1,healthAnalysis:u.health},r);return u.health?.confidence&&(console.log(" [Image] Actualizando health score de la planta..."),await hs.updatePlantHealthScore(o,r,u.health.confidence,u.health,m.id)),console.log(" [Image] Proceso completado exitosamente"),{image:m,analysis:u,note:c}},onSuccess:(o,l)=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",l.plantId]});const{setPlant:c}=Wn.getState(),u=Wn.getState().getPlantById(l.plantId);if(u){const h={...u,images:[...u.images,o.image],healthScore:o.analysis.health?.confidence||u.healthScore};c(h)}n({type:"success",title:"Nueva imagen aadida",message:`Anlisis completado. Salud actual: ${o.analysis.health?.confidence?.toFixed(0)||"N/A"}%`})},onError:o=>{console.error(" [Image] Error en proceso de subida:",o),n({type:"error",title:"Error al agregar imagen",message:o.message})}}),a=Ei({mutationFn:async({plantId:o,imageId:l})=>{if(!r)throw new Error("User not authenticated");return console.log(" [Profile] Cambiando imagen de perfil..."),await hs.setProfileImage(o,l,r),{plantId:o,imageId:l}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen de perfil actualizada",message:"La imagen principal de la planta ha sido cambiada"})},onError:o=>{n({type:"error",title:"Error al cambiar imagen de perfil",message:o.message})}}),s=Ei({mutationFn:async({plantId:o,imageId:l})=>{if(!r)throw new Error("User not authenticated");return console.log(" [Image] Eliminando imagen..."),await hs.deleteImage(l,r),{plantId:o,imageId:l}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen eliminada",message:"La imagen ha sido eliminada de tu planta"})},onError:o=>{n({type:"error",title:"Error al eliminar imagen",message:o.message})}});return{addPlantImage:i.mutate,isAddingImage:i.isPending,setProfileImage:a.mutate,isSettingProfileImage:a.isPending,deleteImage:s.mutate,isDeletingImage:s.isPending}};function yF({images:t}){const[e,r]=w.useState(null);if(!t||t.length===0)return d.jsx(Ir,{className:"mt-4",children:d.jsx(Jn,{className:"pt-6",children:d.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[d.jsx(Kn,{className:"w-12 h-12 text-muted-foreground mb-4"}),d.jsx("p",{className:"text-muted-foreground",children:"No hay imgenes para esta planta todava."}),d.jsx("p",{className:"text-sm text-muted-foreground/70 mt-2",children:"Agrega algunas fotos para seguir su progreso!"})]})})});const n=[...t].sort((l,c)=>new Date(c.timestamp).getTime()-new Date(l.timestamp).getTime()),i=l=>{r(l)},a=()=>{r(null)},s=l=>{if(e===null)return;const c=l==="prev"?(e-1+n.length)%n.length:(e+1)%n.length;r(c)},o=l=>(l instanceof Date?l:new Date(l)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"});return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold tracking-tight flex items-center",children:[d.jsx(Kn,{className:"w-5 h-5 mr-2 text-primary"}),"Galera de Imgenes"]}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," foto",n.length!==1?"s":""]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((l,c)=>d.jsxs(L.div,{className:"aspect-square relative rounded-[8px] overflow-hidden cursor-pointer group w-[80px] h-[80px]",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(c),children:[d.jsx(dg,{src:l.url,alt:`Imagen de planta del ${o(l.timestamp)}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 rounded-[8px]"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:d.jsx("div",{className:"flex items-center text-white text-xs gap-2",children:d.jsxs("span",{className:"flex items-center",children:[d.jsx(Jc,{className:"w-3 h-3 mr-1"}),o(l.timestamp)]})})})}),l.isProfileImage&&d.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full font-medium",children:"Principal"})]},l.id))}),d.jsx(ke,{children:e!==null&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a,children:d.jsxs(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:l=>l.stopPropagation(),children:[d.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(Ui,{className:"w-6 h-6"})}),n.length>1&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>s("prev"),className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(j_,{className:"w-6 h-6"})}),d.jsx("button",{onClick:()=>s("next"),className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(O_,{className:"w-6 h-6"})})]}),d.jsx("img",{src:n[e].url,alt:`Imagen de planta del ${o(n[e].timestamp)}`,className:"max-w-full max-h-full object-contain rounded-lg"}),d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-black/50 text-white p-4 rounded-lg backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Jc,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm",children:o(n[e].timestamp)})]}),d.jsxs("span",{className:"text-sm text-white/70",children:[e+1," de ",n.length]})]}),d.jsx("div",{className:"mt-2 text-sm flex items-center gap-2",children:(()=>{const l=n[e].healthAnalysis;if(!l)return d.jsx("span",{className:"italic text-white/60",children:"Sin anlisis"});let c="",u="Excelente";switch(l.overallHealth){case"excellent":c="",u="Excelente";break;case"good":c="",u="Buena";break;case"fair":c="",u="Regular";break;case"poor":c="",u="Baja";break;default:c="",u=l.overallHealth}let h;const m={excellent:95,good:80,fair:60,poor:30};return l.overallHealth&&m[l.overallHealth]?h=m[l.overallHealth]:typeof l.confidence=="number"&&(h=l.confidence<=1?l.confidence*100:l.confidence),d.jsxs("span",{children:["Salud: ",d.jsx("span",{className:"font-semibold",children:u})," ",d.jsx("span",{children:c}),h!==void 0&&d.jsxs("span",{className:"ml-2",children:["(",Math.round(h),"%)"]})]})})()}),n[e].isProfileImage&&d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:"Imagen Principal"})})]})]})})})]})}const vF=new lg,bF=()=>{const[t,e]=w.useState(!1),r=ad(),n=kn(o=>o.user),{addToast:i}=Us(),a=Ei({mutationFn:async({plantId:o,species:l,commonName:c})=>{if(!n)throw new Error("User not authenticated");e(!0),i({type:"info",title:" Completando informacin",message:`Consultando IA para ${c||l}...`,duration:3e3});try{const u=await N3(l,c);return await vF.updatePlantInfo(o,n.id,{plantEnvironment:u.plantEnvironment,lightRequirements:u.lightRequirements,description:u.description,funFacts:u.funFacts})}catch(u){throw console.error(" [COMPLETAR IA] Error durante el proceso:",u),u}finally{e(!1)}},onSuccess:o=>{console.log(" [COMPLETAR IA] Refrescando datos en cache..."),i({type:"success",title:" Informacin completada!",message:`Se agregaron datos de ambiente y luz para ${o.name}`,duration:5e3}),r.invalidateQueries({queryKey:["plant",o.id]}),r.invalidateQueries({queryKey:["plants"]}),console.log(" [COMPLETAR IA] Cache actualizado correctamente")},onError:o=>{console.error(" [COMPLETAR IA] Error final en la operacin:",o),i({type:"error",title:" Error al completar informacin",message:"No se pudo obtener los datos de IA. Intenta de nuevo.",duration:7e3}),e(!1)}});return{completeInfo:(o,l,c)=>a.mutate({plantId:o,species:l,commonName:c}),isCompleting:t||a.isPending,error:a.error,isSuccess:a.isSuccess}},xF=({isOpen:t,onClose:e,onConfirm:r,title:n,description:i,confirmText:a="Confirmar",cancelText:s="Cancelar",variant:o="warning",isLoading:l=!1,preview:c})=>{const h={danger:{iconColor:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",confirmColor:"destructive"},warning:{iconColor:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",confirmColor:"warning"},info:{iconColor:"text-blue-500",bgColor:"bg-blue-50 dark:bg-blue-900/20",confirmColor:"primary"}}[o];return d.jsx(ke,{children:t&&d.jsx(d.Fragment,{children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:m=>m.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[d.jsx("div",{className:"p-6 pb-4",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:`${h.bgColor} p-3 rounded-full flex-shrink-0`,children:d.jsx(_n,{className:`w-6 h-6 ${h.iconColor}`})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:n}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:i})]}),d.jsx("button",{onClick:e,disabled:l,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar dilogo",children:d.jsx(Ui,{className:"w-5 h-5"})})]})}),c&&d.jsx("div",{className:"px-6 pb-4",children:d.jsx("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50",children:c})}),d.jsxs("div",{className:"px-6 pb-6 flex gap-3 justify-end",children:[d.jsx(me,{variant:"outline",onClick:e,disabled:l,className:"min-w-[80px]",children:s}),d.jsx(me,{variant:h.confirmColor,onClick:r,disabled:l,loading:l,className:"min-w-[80px]",children:a})]})]})})})})},wF=({plant:t,variant:e="primary",size:r="sm",showLabel:n=!0,className:i=""})=>{const{updatePlantHealthMutation:a,isUpdatingPlantHealth:s}=Od(),o=kn(p=>p.user),{addToast:l}=Us(),{plant:c}=hg(t.id),u=async()=>{if(!o?.id){l({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnstico"});return}if(!c){l({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log(" [Button] Actualizando diagnstico para:",t.name),a({plant:c,userId:o.id})},h=d.jsxs(d.Fragment,{children:[s?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(Ni,{size:r.includes("icon")?16:14})}):d.jsx(D_,{size:r.includes("icon")?16:14}),n&&!r.includes("icon")&&d.jsx("span",{className:"ml-2 text-xs",children:s?"Analizando...":"Analizar"})]}),m=r.includes("icon");return d.jsx(me,{onClick:u,disabled:s||!c,size:r,variant:e,className:i,"aria-label":m?`Actualizar diagnstico de salud para ${t.name}`:void 0,title:m?`Actualizar diagnstico de salud para ${t.name}`:void 0,children:h})},_F=({plant:t})=>{const e=ar(),[r,n]=w.useState(!1),[i,a]=w.useState(!1),{deletePlant:s,isDeletingPlant:o}=Od(),{completeInfo:l,isCompleting:c}=bF(),{scrollY:u}=Ck(),h=Pv(u,[0,300],[0,150]),m=Pv(u,[0,200],[1,.3]),p=t.images?.find(C=>C.isProfileImage)||t.images?.[0],v=!t.plantEnvironment||!t.lightRequirements,b=()=>{a(!0),n(!1)},g=()=>{s(t.id,{onSuccess:()=>{e("/")}})},_=()=>{console.log(" [UI] Usuario solicit completar informacin con IA"),console.log(" [UI] Datos de la planta:",{id:t.id,nombre:t.name,especie:t.species,ambienteActual:t.plantEnvironment||"No especificado",luzActual:t.lightRequirements||"No especificado"}),n(!1),a(!0)},T=()=>{console.log(" [UI] Usuario confirm el completado automtico"),a(!1),l(t.id,t.species,t.name)},E=()=>{console.log(" [UI] Usuario cancel el completado automtico"),a(!1)},j=C=>(C instanceof Date?C:new Date(C)).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),R=C=>{switch(C){case"interior":return d.jsx(Qc,{className:"w-4 h-4 mr-2"});case"exterior":return d.jsx(Cv,{className:"w-4 h-4 mr-2"});case"ambos":return d.jsxs(d.Fragment,{children:[d.jsx(Qc,{className:"w-3 h-3 mr-1"}),d.jsx(Cv,{className:"w-3 h-3 mr-1"})]});default:return null}},D=C=>{switch(C){case"interior":return"Interior";case"exterior":return"Exterior";case"ambos":return"Interior/Exterior";default:return null}},S=C=>{switch(C){case"poca_luz":return d.jsx(kk,{className:"w-4 h-4 mr-2"});case"luz_indirecta":return d.jsx(va,{className:"w-4 h-4 mr-2 opacity-60"});case"luz_directa_parcial":return d.jsx(va,{className:"w-4 h-4 mr-2 opacity-80"});case"pleno_sol":return d.jsx(va,{className:"w-4 h-4 mr-2"});default:return null}},A=C=>{switch(C){case"poca_luz":return"Poca luz";case"luz_indirecta":return"Luz indirecta";case"luz_directa_parcial":return"Sol parcial";case"pleno_sol":return"Pleno sol";default:return null}},P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},O={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:120}}},N={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6}}};return w.useEffect(()=>{const C=()=>n(!1);if(r)return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[r]),d.jsxs(L.div,{className:"relative h-96 w-full overflow-hidden",variants:P,initial:"hidden",animate:"visible",children:[d.jsx(L.div,{className:"absolute inset-0 scale-110",style:{y:h,opacity:m},children:p?d.jsx(dg,{src:p.url,alt:t.name,className:"h-full w-full object-cover"}):d.jsx("div",{className:"h-full w-full bg-gradient-to-br from-green-400 via-green-500 to-green-600",children:d.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})})}),d.jsxs(L.div,{className:"absolute inset-0",variants:N,children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,0.6)] to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/30"}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background/60 to-transparent"})]}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top z-20",children:d.jsxs(L.div,{className:"flex items-center justify-between",variants:O,children:[d.jsx(me,{"aria-label":"Volver atrs",variant:"ghost",size:"icon",onClick:()=>e("/"),className:"bg-black/30 text-white backdrop-blur-lg rounded-full border border-white/20 hover:bg-black/50 transition-all duration-300",children:d.jsx(ip,{size:20})}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("div",{className:"relative",children:[d.jsx(me,{"aria-label":"Ms opciones",variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),n(k=>!k)},className:"bg-neutral-800/90 text-white backdrop-blur-lg rounded-full border border-neutral-600 hover:bg-neutral-700 transition-all duration-300 dark:bg-neutral-200/90 dark:text-neutral-900 dark:border-neutral-400 dark:hover:bg-neutral-300",children:d.jsx(M_,{size:20})}),d.jsx(ke,{children:r&&d.jsx(L.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 mt-2 w-48 origin-top-right rounded-xl bg-background/95 backdrop-blur-lg shadow-xl ring-1 ring-black/10 focus:outline-none z-30 border border-border/50",onClick:C=>C.stopPropagation(),children:d.jsxs("div",{className:"py-2",children:[v&&d.jsxs("button",{onClick:_,disabled:c,className:"flex w-full items-center px-4 py-3 text-sm text-contrast-high hover:bg-contrast-surface transition-colors rounded-lg mx-2",children:[c?d.jsx(ya,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(er,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:c?"Completando...":"Completar con IA"})]}),d.jsx("div",{className:"flex w-full items-center px-2 py-1",children:d.jsx(wF,{plant:t,variant:"outline",size:"sm",showLabel:!0,className:"w-full"})}),d.jsxs("button",{onClick:b,disabled:o,className:"flex w-full items-center px-4 py-3 text-sm text-error-600 dark:text-error-500 hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors rounded-lg mx-2 font-medium",children:[o?d.jsx(ya,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(C_,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:o?"Eliminando...":"Eliminar planta"})]})]})})})]})})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom z-10",children:d.jsxs(L.div,{className:"space-y-4",variants:O,children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(L.h1,{className:"text-[24px] font-bold text-white drop-shadow-lg",variants:O,children:t.nickname||t.name}),d.jsx(L.p,{className:"text-[16px] text-white/90 font-medium",variants:O,children:t.species})]}),d.jsxs(L.div,{className:"flex flex-wrap gap-2 pt-2 max-h-32 overflow-y-auto",variants:O,children:[t.location&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(L_,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm font-medium",children:t.location})]}),t.dateAdded&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(Jc,{className:"w-4 h-4 mr-2"}),d.jsxs("span",{className:"text-sm font-medium",children:["Desde ",j(t.dateAdded)]})]}),t.plantEnvironment&&D(t.plantEnvironment)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[R(t.plantEnvironment),d.jsx("span",{className:"text-sm font-medium",children:D(t.plantEnvironment)})]}),t.lightRequirements&&A(t.lightRequirements)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[S(t.lightRequirements),d.jsx("span",{className:"text-sm font-medium",children:A(t.lightRequirements)})]}),t.images&&t.images.length>0&&d.jsx("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:d.jsxs("span",{className:"text-sm font-medium",children:[t.images.length," foto",t.images.length!==1?"s":""]})})]})]})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:E,children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:C=>C.stopPropagation(),className:"bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[d.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:d.jsx(er,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Completar con IA"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Informacin automtica"})]})]}),d.jsxs("div",{className:"space-y-3 mb-6",children:[d.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"Quieres que la IA complete la informacin faltante de esta planta?"}),d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:""}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:""}),d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.species})]})]}),d.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d.jsx("p",{className:"font-medium mb-1",children:"La IA agregar:"}),d.jsxs("ul",{className:"space-y-1",children:[d.jsx("li",{children:" Ambiente recomendado (interior/exterior)"}),d.jsx("li",{children:" Necesidades de luz especficas"})]})]})]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx(me,{variant:"outline",onClick:E,className:"flex-1",disabled:c,children:"Cancelar"}),d.jsx(me,{onClick:T,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",disabled:c,children:c?d.jsxs(d.Fragment,{children:[d.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Completando..."]}):d.jsxs(d.Fragment,{children:[d.jsx(er,{className:"w-4 h-4 mr-2"}),"Completar"]})})]})]})})}),d.jsx(xF,{isOpen:i,onClose:()=>a(!1),onConfirm:g,title:"Eliminar Planta",description:`Ests seguro de que quieres eliminar "${t.nickname||t.name}"? Esta accin es irreversible y se perdern todos los datos, fotos y mensajes de chat asociados.`,confirmText:"Eliminar Definitivamente",cancelText:"Cancelar",variant:"danger",isLoading:o,preview:d.jsxs("div",{className:"flex items-center gap-3",children:[p&&d.jsx("img",{src:p.url,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[t.species,"  ",t.images?.length||0," fotos"]})]})]})})]})},EF=({plant:t})=>{const{careProfile:e,personality:r}=t;if(!e)return d.jsx("div",{className:"bg-background p-6 rounded-lg shadow-lg w-full text-center",children:d.jsx("p",{className:"text-muted-foreground",children:"No hay perfil de cuidados disponible para esta planta."})});const n=[{icon:d.jsx(gl,{size:20,strokeWidth:2,color:"#555"}),label:"RIEGO",value:`Cada ${e.wateringFrequency} das`},{icon:d.jsx(va,{size:20,strokeWidth:2,color:"#555"}),label:"LUZ SOLAR",value:e.sunlightRequirement},{icon:d.jsx(R_,{size:20,strokeWidth:2,color:"#555"}),label:"HUMEDAD",value:e.humidityPreference},{icon:d.jsx($_,{size:20,strokeWidth:2,color:"#555"}),label:"TEMPERATURA IDEAL",value:`${e.temperatureRange.min}C - ${e.temperatureRange.max}C`},{icon:d.jsx(er,{size:20,strokeWidth:2,color:"#555"}),label:"FERTILIZACIN",value:`Cada ${e.fertilizingFrequency} das`},{icon:d.jsx(ap,{size:20,strokeWidth:2,color:"#555"}),label:"TIPO DE SUELO",value:e.soilType}];return d.jsxs("div",{className:"w-full",style:{lineHeight:"1.4"},children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-6 mb-4",style:{gap:"24px 16px"},children:n.map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start",children:[d.jsxs("div",{className:"flex items-center mb-1",children:[i.icon,d.jsx("span",{className:"ml-2 text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:i.label})]}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i.value})]},a))}),e.specialCare&&e.specialCare.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Cuidados Especiales"}),d.jsx("ul",{className:"list-none pl-0 ml-4",style:{lineHeight:"1.5"},children:e.specialCare.map((i,a)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:""}),d.jsx("span",{className:"text-[14px] text-[#444]",children:i})]},a))})]}),d.jsx("hr",{className:"my-6",style:{border:"none",borderTop:"1px solid #EEE",margin:"24px 0"}}),r&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx(Ho,{size:20,strokeWidth:2,color:"#555",className:"mr-2"}),d.jsx("span",{className:"text-[18px] font-semibold text-[#333]",children:"Personalidad de la Planta"})]}),r.communicationStyle&&d.jsx("div",{className:Array.isArray(r.communicationStyle)&&r.communicationStyle.length>1?"grid grid-cols-2 gap-x-4 mb-3":"flex justify-center mb-3",children:(Array.isArray(r.communicationStyle)?r.communicationStyle:[r.communicationStyle]).map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start mb-2",children:[d.jsx("span",{className:"text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:"ESTILO"}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i})]},a))}),r.catchphrases&&r.catchphrases.length>0&&d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mb-2",children:"Frases Tpicas"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:r.catchphrases.map((i,a)=>d.jsx("span",{className:"inline-block bg-[#F0FDF6] text-[#046A38] text-[14px] px-2 py-1 rounded-[4px] font-medium",style:{padding:"4px 8px",marginRight:8,marginBottom:8},children:i},a))})]})]})]})},TF=({funFacts:t})=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsxs(L.div,{className:"bg-white/0 dark:bg-transparent p-3 sm:p-4 w-full",variants:e,initial:"hidden",animate:"visible",children:[t&&t.length>0&&d.jsxs(L.div,{variants:r,children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-full mr-4",children:d.jsx(er,{className:"w-6 h-6 text-yellow-500"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Datos Curiosos"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Descubre cosas increbles sobre esta planta"})]})]}),d.jsx("div",{className:"grid gap-4",children:t.map((n,i)=>d.jsxs(L.div,{className:"group flex items-start bg-yellow-500/5 hover:bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 transition-all duration-300 hover:shadow-md",variants:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[d.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:d.jsxs("div",{className:"relative",children:[d.jsx(V_,{className:"w-5 h-5 text-yellow-500 group-hover:text-yellow-600 transition-colors"}),d.jsx("div",{className:"absolute -inset-2 bg-yellow-500/20 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pulse"})]})}),d.jsx("p",{className:"text-foreground/90 leading-relaxed font-medium group-hover:text-foreground transition-colors",children:n})]},i))})]}),(!t||t.length===0)&&d.jsx(L.div,{className:"mt-8 flex items-center justify-center p-6 bg-muted/30 rounded-xl border border-dashed border-muted-foreground/20",variants:r,children:d.jsxs("div",{className:"text-center",children:[d.jsx(er,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),d.jsx("p",{className:"text-muted-foreground font-medium",children:"No hay datos curiosos disponibles"}),d.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"Pronto agregaremos informacin interesante!"})]})})]})},AF=()=>d.jsx(sd,{className:"w-5 h-5 text-[#EF9A9A]","aria-label":"Problema de hoja seca"}),SF=({analysis:t})=>{if(!t)return null;const e=t.issues&&t.issues.length>0;return d.jsxs("div",{className:"w-full",role:"region","aria-label":"Anlisis de salud de la planta",style:{lineHeight:"1.4"},children:[e?d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[16px] text-[#333] mt-3",children:"Problemas Detectados"}),d.jsxs("p",{className:"mb-2 text-[14px] text-[#D32F2F] font-medium",style:{marginTop:12,marginBottom:8},children:[t.issues.length," problema",t.issues.length!==1?"s":""," detectado",t.issues.length!==1?"s":""]}),d.jsx("ul",{className:"",children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start",style:{marginBottom:n<t.issues.length-1?16:0,paddingBottom:n<t.issues.length-1?16:0,borderBottom:n<t.issues.length-1?"1px solid #EEE":"none"},children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center mt-1",children:AF()}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"font-semibold text-[15px] text-[#333]",children:r.type}),d.jsx("p",{className:"text-[14px] text-[#555] mt-1",children:r.description})]})]},n))}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Tratamientos Sugeridos"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:""}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r.treatment})]},n))})]})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[d.jsx("span",{className:"text-4xl mb-2",role:"img","aria-label":"Planta saludable",children:""}),d.jsx(Nk,{className:"w-12 h-12 text-green-500 mb-3","aria-label":"Todo en orden"}),d.jsxs("h4",{className:"font-semibold text-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:["Todo en orden!",d.jsx("span",{className:"text-base","aria-hidden":"true",children:""})]}),d.jsx("p",{className:"text-muted-foreground",children:"El anlisis inicial no detect problemas de salud significativos."})]}),t.recommendations&&t.recommendations.length>0&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Recomendaciones Adicionales"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.recommendations.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:""}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r})]},n))})]})]})};var Md={},dA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(dA);var fg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(fg);var mg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(mg);var Ld={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const c=r[a];o?c==="\\"&&a+1<i?(a++,s+=r[a]):c===o?o="":s+=c:l?c==='"'||c==="'"?o=c:c==="]"?(l=!1,n.push(s),s=""):s+=c:c==="["?(l=!0,s&&(n.push(s),s="")):c==="."?s&&(n.push(s),s=""):s+=c,a++}return s&&n.push(s),n}t.toPath=e})(Ld);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dA,r=fg,n=mg,i=Ld;function a(o,l,c){if(o==null)return c;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?r.isDeepKey(l)?a(o,i.toPath(l),c):c:u}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const u=o[l];return u===void 0?c:u}default:{if(Array.isArray(l))return s(o,l,c);if(Object.is(l?.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?c:u}}}function s(o,l,c){if(l.length===0)return c;let u=o;for(let h=0;h<l.length;h++){if(u==null||e.isUnsafeProperty(l[h]))return c;u=u[l[h]]}return u===void 0?c:u}t.get=a})(Md);var IF=Md.get;const Ma=Fi(IF);var hA={exports:{}},Ve={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pg=Symbol.for("react.transitional.element"),gg=Symbol.for("react.portal"),$d=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),zd=Symbol.for("react.profiler"),Fd=Symbol.for("react.consumer"),Ud=Symbol.for("react.context"),Bd=Symbol.for("react.forward_ref"),Hd=Symbol.for("react.suspense"),Wd=Symbol.for("react.suspense_list"),qd=Symbol.for("react.memo"),Kd=Symbol.for("react.lazy"),PF=Symbol.for("react.view_transition"),CF=Symbol.for("react.client.reference");function Ur(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case pg:switch(t=t.type,t){case $d:case zd:case Vd:case Hd:case Wd:case PF:return t;default:switch(t=t&&t.$$typeof,t){case Ud:case Bd:case Kd:case qd:return t;case Fd:return t;default:return e}}case gg:return e}}}Ve.ContextConsumer=Fd;Ve.ContextProvider=Ud;Ve.Element=pg;Ve.ForwardRef=Bd;Ve.Fragment=$d;Ve.Lazy=Kd;Ve.Memo=qd;Ve.Portal=gg;Ve.Profiler=zd;Ve.StrictMode=Vd;Ve.Suspense=Hd;Ve.SuspenseList=Wd;Ve.isContextConsumer=function(t){return Ur(t)===Fd};Ve.isContextProvider=function(t){return Ur(t)===Ud};Ve.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===pg};Ve.isForwardRef=function(t){return Ur(t)===Bd};Ve.isFragment=function(t){return Ur(t)===$d};Ve.isLazy=function(t){return Ur(t)===Kd};Ve.isMemo=function(t){return Ur(t)===qd};Ve.isPortal=function(t){return Ur(t)===gg};Ve.isProfiler=function(t){return Ur(t)===zd};Ve.isStrictMode=function(t){return Ur(t)===Vd};Ve.isSuspense=function(t){return Ur(t)===Hd};Ve.isSuspenseList=function(t){return Ur(t)===Wd};Ve.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===$d||t===zd||t===Vd||t===Hd||t===Wd||typeof t=="object"&&t!==null&&(t.$$typeof===Kd||t.$$typeof===qd||t.$$typeof===Ud||t.$$typeof===Fd||t.$$typeof===Bd||t.$$typeof===CF||t.getModuleId!==void 0)};Ve.typeOf=Ur;hA.exports=Ve;var kF=hA.exports,Lr=t=>t===0?0:t>0?1:-1,Vr=t=>typeof t=="number"&&t!=+t,ha=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,te=t=>(typeof t=="number"||t instanceof Number)&&!Vr(t),Sn=t=>te(t)||typeof t=="string",NF=0,sl=t=>{var e=++NF;return"".concat(t||"").concat(e)},Vi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!te(e)&&typeof e!="string")return n;var a;if(ha(e)){if(r==null)return n;var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return Vr(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},fA=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},go=(t,e)=>te(t)&&te(e)?r=>t+r*(e-t):()=>e;function mA(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Ma(n,e))===r)}var ct=t=>t===null||typeof t>"u",yg=t=>ct(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),jF=["viewBox","children"],OF=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Qb=["points","pathLength"],af={svg:jF,polygon:Qb,polyline:Qb},vg=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],bg=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(w.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{vg.includes(i)&&(n[i]=a=>r[i](r,a))}),n},RF=(t,e,r)=>n=>(t(e,r,n),null),DF=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];vg.includes(i)&&typeof a=="function"&&(n||(n={}),n[i]=RF(a,e,r))}),n},Jb=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",ex=null,sf=null,pA=t=>{if(t===ex&&Array.isArray(sf))return sf;var e=[];return w.Children.forEach(t,r=>{ct(r)||(kF.isFragment(r)?e=e.concat(pA(r.props.children)):e.push(r))}),sf=e,ex=t,e};function gA(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>Jb(i)):n=[Jb(e)],pA(t).forEach(i=>{var a=Ma(i,"type.displayName")||Ma(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var yA=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,MF=(t,e,r,n)=>{var i,a=(i=n&&af?.[n])!==null&&i!==void 0?i:[];return e.startsWith("data-")||typeof t!="function"&&(n&&a.includes(e)||OF.includes(e))||r&&vg.includes(e)},Ke=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;MF((s=n)===null||s===void 0?void 0:s[a],a,e,r)&&(i[a]=n[a])}),i},LF=["children","width","height","viewBox","className","style","title","desc"];function pm(){return pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pm.apply(null,arguments)}function $F(t,e){if(t==null)return{};var r,n,i=VF(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function VF(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vA=w.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:l,desc:c}=t,u=$F(t,LF),h=a||{width:n,height:i,x:0,y:0},m=Le("recharts-surface",s);return w.createElement("svg",pm({},Ke(u,!0,"svg"),{className:m,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),w.createElement("title",null,l),w.createElement("desc",null,c),r)}),zF=["children","className"];function gm(){return gm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gm.apply(null,arguments)}function FF(t,e){if(t==null)return{};var r,n,i=UF(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function UF(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zi=w.forwardRef((t,e)=>{var{children:r,className:n}=t,i=FF(t,zF),a=Le("recharts-layer",n);return w.createElement("g",gm({className:a},Ke(i,!0),{ref:e}),r)}),BF=w.createContext(null);function it(t){return function(){return t}}const ym=Math.PI,vm=2*ym,oa=1e-6,HF=vm-oa;function bA(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function WF(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return bA;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class qF{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?bA:WF(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=n-e,c=i-r,u=s-e,h=o-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>oa)if(!(Math.abs(h*l-c*u)>oa)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-s,v=i-o,b=l*l+c*c,g=p*p+v*v,_=Math.sqrt(b),T=Math.sqrt(m),E=a*Math.tan((ym-Math.acos((b+m-g)/(2*_*T)))/2),j=E/T,R=E/_;Math.abs(j-1)>oa&&this._append`L${e+j*u},${r+j*h}`,this._append`A${a},${a},0,0,${+(h*p>u*v)},${this._x1=e+R*l},${this._y1=r+R*c}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),l=n*Math.sin(i),c=e+o,u=r+l,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>oa||Math.abs(this._y1-u)>oa)&&this._append`L${c},${u}`,n&&(m<0&&(m=m%vm+vm),m>HF?this._append`A${n},${n},0,1,${h},${e-o},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=u}`:m>oa&&this._append`A${n},${n},0,${+(m>=ym)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function xA(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new qF(e)}function xg(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function wA(t){this._context=t}wA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Gd(t){return new wA(t)}function _A(t){return t[0]}function EA(t){return t[1]}function TA(t,e){var r=it(!0),n=null,i=Gd,a=null,s=xA(o);t=typeof t=="function"?t:t===void 0?_A:it(t),e=typeof e=="function"?e:e===void 0?EA:it(e);function o(l){var c,u=(l=xg(l)).length,h,m=!1,p;for(n==null&&(a=i(p=s())),c=0;c<=u;++c)!(c<u&&r(h=l[c],c,l))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(h,c,l),+e(h,c,l));if(p)return a=null,p+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:it(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:it(+l),o):e},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:it(!!l),o):r},o.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),o):i},o.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),o):n},o}function Ac(t,e,r){var n=null,i=it(!0),a=null,s=Gd,o=null,l=xA(c);t=typeof t=="function"?t:t===void 0?_A:it(+t),e=typeof e=="function"?e:it(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?EA:it(+r);function c(h){var m,p,v,b=(h=xg(h)).length,g,_=!1,T,E=new Array(b),j=new Array(b);for(a==null&&(o=s(T=l())),m=0;m<=b;++m){if(!(m<b&&i(g=h[m],m,h))===_)if(_=!_)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=m-1;v>=p;--v)o.point(E[v],j[v]);o.lineEnd(),o.areaEnd()}_&&(E[m]=+t(g,m,h),j[m]=+e(g,m,h),o.point(n?+n(g,m,h):E[m],r?+r(g,m,h):j[m]))}if(T)return o=null,T+""||null}function u(){return TA().defined(i).curve(s).context(a)}return c.x=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),n=null,c):t},c.x0=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),c):t},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:it(+h),c):n},c.y=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),r=null,c):e},c.y0=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),c):e},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:it(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(r)},c.lineX1=function(){return u().x(n).y(e)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:it(!!h),c):i},c.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),c):s},c.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),c):a},c}class AA{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function KF(t){return new AA(t,!0)}function GF(t){return new AA(t,!1)}function Iu(){}function Pu(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function SA(t){this._context=t}SA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Pu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Pu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function YF(t){return new SA(t)}function IA(t){this._context=t}IA.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Pu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ZF(t){return new IA(t)}function PA(t){this._context=t}PA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Pu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function XF(t){return new PA(t)}function CA(t){this._context=t}CA.prototype={areaStart:Iu,areaEnd:Iu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function QF(t){return new CA(t)}function tx(t){return t<0?-1:1}function rx(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(tx(a)+tx(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function nx(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function of(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function Cu(t){this._context=t}Cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:of(this,this._t0,nx(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,of(this,nx(this,r=rx(this,t,e)),r);break;default:of(this,this._t0,r=rx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function kA(t){this._context=new NA(t)}(kA.prototype=Object.create(Cu.prototype)).point=function(t,e){Cu.prototype.point.call(this,e,t)};function NA(t){this._context=t}NA.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function JF(t){return new Cu(t)}function eU(t){return new kA(t)}function jA(t){this._context=t}jA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=ix(t),i=ix(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ix(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function tU(t){return new jA(t)}function Yd(t,e){this._context=t,this._t=e}Yd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function rU(t){return new Yd(t,.5)}function nU(t){return new Yd(t,0)}function iU(t){return new Yd(t,1)}function ks(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function bm(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function aU(t,e){return t[e]}function sU(t){const e=[];return e.key=t,e}function oU(){var t=it([]),e=bm,r=ks,n=aU;function i(a){var s=Array.from(t.apply(this,arguments),sU),o,l=s.length,c=-1,u;for(const h of a)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(h,s[o].key,c,a)]).data=h;for(o=0,u=xg(e(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:it(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:it(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?bm:typeof a=="function"?a:it(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??ks,i):r},i}function lU(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}ks(t,e)}}function cU(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}ks(t,e)}}function uU(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,l=0,c=0;o<s;++o){for(var u=t[e[o]],h=u[n][1]||0,m=u[n-1][1]||0,p=(h-m)/2,v=0;v<o;++v){var b=t[e[v]],g=b[n][1]||0,_=b[n-1][1]||0;p+=g-_}l+=h,c+=p*h}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,ks(t,e)}}var OA={},RA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}t.uniqBy=e})(RA);var wg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(wg);var DA={},Zd={},MA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(MA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MA;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Zd);var LA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(LA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zd,r=LA;function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(DA);var $A={},VA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Md;function r(n){return function(i){return e.get(i,n)}}t.property=r})(VA);var zA={},lf={},cf={},_g={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(_g);var Eg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(Eg);var Xd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(Xd);var ax;function dU(){return ax||(ax=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Tg(),r=_g,n=Eg,i=Xd;function a(h,m,p){return typeof p!="function"?e.isMatch(h,m):s(h,m,function v(b,g,_,T,E,j){const R=p(b,g,_,T,E,j);return R!==void 0?!!R:s(b,g,v,j)},new Map)}function s(h,m,p,v){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,p,v);case"function":return Object.keys(m).length>0?s(h,{...m},p,v):i.eq(h,m);default:return r.isObject(h)?typeof m=="string"?m==="":!0:i.eq(h,m)}}function o(h,m,p,v){if(m==null)return!0;if(Array.isArray(m))return c(h,m,p,v);if(m instanceof Map)return l(h,m,p,v);if(m instanceof Set)return u(h,m,p,v);const b=Object.keys(m);if(h==null)return b.length===0;if(b.length===0)return!0;if(v&&v.has(m))return v.get(m)===h;v&&v.set(m,h);try{for(let g=0;g<b.length;g++){const _=b[g];if(!n.isPrimitive(h)&&!(_ in h)||m[_]===void 0&&h[_]!==void 0||m[_]===null&&h[_]!==null||!p(h[_],m[_],_,h,m,v))return!1}return!0}finally{v&&v.delete(m)}}function l(h,m,p,v){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,g]of m.entries()){const _=h.get(b);if(p(_,g,b,h,m,v)===!1)return!1}return!0}function c(h,m,p,v){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let g=0;g<m.length;g++){const _=m[g];let T=!1;for(let E=0;E<h.length;E++){if(b.has(E))continue;const j=h[E];let R=!1;if(p(j,_,g,h,m,v)&&(R=!0),R){b.add(E),T=!0;break}}if(!T)return!1}return!0}function u(h,m,p,v){return m.size===0?!0:h instanceof Set?c([...h],[...m],p,v):!1}t.isMatchWith=a,t.isSetMatch=u}(cf)),cf}var sx;function Tg(){return sx||(sx=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dU();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r}(lf)),lf}var FA={},Ag={},Sg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Sg);var Qd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(Qd);var Jd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",c="[object Set]",u="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",v="[object Error]",b="[object DataView]",g="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",j="[object BigUint64Array]",R="[object Int8Array]",D="[object Int16Array]",S="[object Int32Array]",A="[object BigInt64Array]",P="[object Float32Array]",O="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=u,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=j,t.booleanTag=i,t.dataViewTag=b,t.dateTag=o,t.errorTag=v,t.float32ArrayTag=P,t.float64ArrayTag=O,t.functionTag=h,t.int16ArrayTag=D,t.int32ArrayTag=S,t.int8ArrayTag=R,t.mapTag=l,t.numberTag=n,t.objectTag=p,t.regexpTag=e,t.setTag=c,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=T,t.uint32ArrayTag=E,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=_})(Jd);var UA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(UA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sg,r=Qd,n=Jd,i=Eg,a=UA;function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,m,p=new Map,v=void 0){const b=v?.(u,h,m,p);if(b!=null)return b;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[_,T]of u)g.set(_,o(T,_,m,p,v));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const _ of u)g.add(o(_,void 0,m,p,v));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(a.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),l(g,u,m,p,v),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),l(g,u,m,p,v),g}if(u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),l(g,u,m,p,v),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,l(g,u,m,p,v),g}if(typeof u=="object"&&c(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),l(g,u,m,p,v),g}return u}function l(u,h,m=u,p,v){const b=[...Object.keys(h),...e.getSymbols(h)];for(let g=0;g<b.length;g++){const _=b[g],T=Object.getOwnPropertyDescriptor(u,_);(T==null||T.writable)&&(u[_]=o(h[_],_,m,p,v))}}function c(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=l})(Ag);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(FA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Tg(),r=FA;function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(zA);var BA={},HA={},WA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag,r=Jd;function n(i,a){return e.cloneDeepWith(i,(s,o,l,c)=>{const u=a?.(s,o,l,c);if(u!=null)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i?.valueOf());return e.copyProperties(h,i),h}case r.argumentsTag:{const h={};return e.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(WA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WA;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(HA);var qA={},Ig={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(Ig);var KA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qd;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(KA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=fg,r=Ig,n=KA,i=Ld;function a(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?l=i.toPath(o):l=[o],l.length===0)return!1;let c=s;for(let u=0;u<l.length;u++){const h=l[u];if((c==null||!Object.hasOwn(c,h))&&!((Array.isArray(c)||n.isArguments(c))&&r.isIndex(h)&&h<c.length))return!1;c=c[h]}return!0}t.has=a})(qA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Tg(),r=mg,n=HA,i=Md,a=qA;function s(o,l){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(c){const u=i.get(c,o);return u===void 0?a.has(c,o):l===void 0?u===void 0:e.isMatch(u,l)}}t.matchesProperty=s})(BA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=wg,r=VA,n=zA,i=BA;function a(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=a})($A);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RA,r=wg,n=DA,i=$A;function a(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),i.iteratee(o)):[]}t.uniqBy=a})(OA);var hU=OA.uniqBy;const ox=Fi(hU);function fU(t,e,r){return e===!0?ox(t,r):typeof e=="function"?ox(t,e):t}var GA={exports:{}},YA={},ZA={exports:{}},XA={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ns=w;function mU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pU=typeof Object.is=="function"?Object.is:mU,gU=Ns.useState,yU=Ns.useEffect,vU=Ns.useLayoutEffect,bU=Ns.useDebugValue;function xU(t,e){var r=e(),n=gU({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return vU(function(){i.value=r,i.getSnapshot=e,uf(i)&&a({inst:i})},[t,r,e]),yU(function(){return uf(i)&&a({inst:i}),t(function(){uf(i)&&a({inst:i})})},[t]),bU(r),r}function uf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!pU(t,r)}catch{return!0}}function wU(t,e){return e()}var _U=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?wU:xU;XA.useSyncExternalStore=Ns.useSyncExternalStore!==void 0?Ns.useSyncExternalStore:_U;ZA.exports=XA;var EU=ZA.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eh=w,TU=EU;function AU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var SU=typeof Object.is=="function"?Object.is:AU,IU=TU.useSyncExternalStore,PU=eh.useRef,CU=eh.useEffect,kU=eh.useMemo,NU=eh.useDebugValue;YA.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=PU(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kU(function(){function l(p){if(!c){if(c=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,SU(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var c=!1,u,h,m=r===void 0?null:r;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,r,n,i]);var o=IU(t,a[0],a[1]);return CU(function(){s.hasValue=!0,s.value=o},[o]),NU(o),o};GA.exports=YA;var jU=GA.exports,Pg=w.createContext(null),OU=t=>t,sr=()=>{var t=w.useContext(Pg);return t?t.store.dispatch:OU},Xc=()=>{},RU=()=>Xc,DU=(t,e)=>t===e;function ie(t){var e=w.useContext(Pg);return jU.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:RU,e?e.store.getState:Xc,e?e.store.getState:Xc,e?t:Xc,DU)}function MU(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function LU(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function $U(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var lx=t=>Array.isArray(t)?t:[t];function VU(t){const e=Array.isArray(t[0])?t[0]:t;return $U(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function zU(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var FU=class{constructor(t){this.value=t}deref(){return this.value}},UU=typeof WeakRef<"u"?WeakRef:FU,BU=0,cx=1;function Sc(){return{s:BU,v:void 0,o:null,p:null}}function QA(t,e={}){let r=Sc();const{resultEqualityCheck:n}=e;let i,a=0;function s(){let o=r;const{length:l}=arguments;for(let h=0,m=l;h<m;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let v=o.o;v===null&&(o.o=v=new WeakMap);const b=v.get(p);b===void 0?(o=Sc(),v.set(p,o)):o=b}else{let v=o.p;v===null&&(o.p=v=new Map);const b=v.get(p);b===void 0?(o=Sc(),v.set(p,o)):o=b}}const c=o;let u;if(o.s===cx)u=o.v;else if(u=t.apply(null,arguments),a++,n){const h=i?.deref?.()??i;h!=null&&n(h,u)&&(u=h,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new UU(u):u}return c.s=cx,c.v=u,u}return s.clearCache=()=>{r=Sc(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function HU(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,s=0,o,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),MU(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:m=[],argsMemoize:p=QA,argsMemoizeOptions:v=[]}=u,b=lx(m),g=lx(v),_=VU(i),T=h(function(){return a++,c.apply(null,arguments)},...b),E=p(function(){s++;const R=zU(_,arguments);return o=T.apply(null,R),o},...g);return Object.assign(E,{resultFunc:c,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var V=HU(QA),WU=Object.assign((t,e=V)=>{LU(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>WU}),JA={},eS={},tS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=e(n),o=e(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};t.compareValues=r})(tS);var rS={},Cg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Cg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cg,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}t.isKey=i})(rS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=tS,r=rS,n=Ld;function i(a,s,o,l){if(a==null)return[];o=l?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const c=(p,v)=>{let b=p;for(let g=0;g<v.length&&b!=null;++g)b=b[v[g]];return b},u=(p,v)=>v==null||p==null?v:typeof p=="object"&&"key"in p?Object.hasOwn(v,p.key)?v[p.key]:c(v,p.path):typeof p=="function"?p(v):Array.isArray(p)?c(v,p):typeof v=="object"?v[p]:v,h=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(v=>u(v,p))})).slice().sort((p,v)=>{for(let b=0;b<h.length;b++){const g=e.compareValues(p.criteria[b],v.criteria[b],o[b]);if(g!==0)return g}return 0}).map(p=>p.original)}t.orderBy=i})(eS);var nS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),s=(o,l)=>{for(let c=0;c<o.length;c++){const u=o[c];Array.isArray(u)&&l<a?s(u,l+1):i.push(u)}};return s(r,0),i}t.flatten=e})(nS);var kg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ig,r=Zd,n=_g,i=Xd;function a(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&e.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?i.eq(l[o],s):!1}t.isIterateeCall=a})(kg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eS,r=nS,n=kg;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(a,r.flatten(s),["asc"])}t.sortBy=i})(JA);var qU=JA.sortBy;const th=Fi(qU);var iS=t=>t.legend.settings,KU=t=>t.legend.size,GU=t=>t.legend.payload;V([GU,iS],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?th(n,r):n});var Ic=1;function YU(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-e.height)>Ic||Math.abs(s.left-e.left)>Ic||Math.abs(s.top-e.top)>Ic||Math.abs(s.width-e.width)>Ic)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function $t(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var ZU=typeof Symbol=="function"&&Symbol.observable||"@@observable",ux=ZU,df=()=>Math.random().toString(36).substring(7).split("").join("."),XU={INIT:`@@redux/INIT${df()}`,REPLACE:`@@redux/REPLACE${df()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${df()}`},ku=XU;function Ng(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function aS(t,e,r){if(typeof t!="function")throw new Error($t(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($t(1));return r(aS)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,l=!1;function c(){s===a&&(s=new Map,a.forEach((g,_)=>{s.set(_,g)}))}function u(){if(l)throw new Error($t(3));return i}function h(g){if(typeof g!="function")throw new Error($t(4));if(l)throw new Error($t(5));let _=!0;c();const T=o++;return s.set(T,g),function(){if(_){if(l)throw new Error($t(6));_=!1,c(),s.delete(T),a=null}}}function m(g){if(!Ng(g))throw new Error($t(7));if(typeof g.type>"u")throw new Error($t(8));if(typeof g.type!="string")throw new Error($t(17));if(l)throw new Error($t(9));try{l=!0,i=n(i,g)}finally{l=!1}return(a=s).forEach(T=>{T()}),g}function p(g){if(typeof g!="function")throw new Error($t(10));n=g,m({type:ku.REPLACE})}function v(){const g=h;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error($t(11));function T(){const j=_;j.next&&j.next(u())}return T(),{unsubscribe:g(T)}},[ux](){return this}}}return m({type:ku.INIT}),{dispatch:m,subscribe:h,getState:u,replaceReducer:p,[ux]:v}}function QU(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:ku.INIT})>"u")throw new Error($t(12));if(typeof r(void 0,{type:ku.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function sS(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{QU(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],m=r[h],p=s[h],v=m(p,o);if(typeof v>"u")throw o&&o.type,new Error($t(14));c[h]=v,l=l||v!==p}return l=l||n.length!==Object.keys(s).length,l?c:s}}function Nu(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function JU(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error($t(15))};const s={getState:i.getState,dispatch:(l,...c)=>a(l,...c)},o=t.map(l=>l(s));return a=Nu(...o)(i.dispatch),{...i,dispatch:a}}}function oS(t){return Ng(t)&&"type"in t&&typeof t.type=="string"}function lS(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var e9=lS(),t9=lS,r9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Nu:Nu.apply(null,arguments)};function zr(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Er(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>oS(n)&&n.type===t,r}var cS=class No extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,No.prototype)}static get[Symbol.species](){return No}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new No(...e[0].concat(this)):new No(...e.concat(this))}};function dx(t){return Gn(t)?Se(t,()=>{}):t}function Pc(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function n9(t){return typeof t=="boolean"}var i9=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new cS;return r&&(n9(r)?s.push(e9):s.push(t9(r.extraArgument))),s},a9="RTK_autoBatch",hx=t=>e=>{setTimeout(e,t)},s9=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:hx(10):t.type==="callback"?t.queueNotification:hx(t.timeout),c=()=>{s=!1,a&&(a=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),m=n.subscribe(h);return o.add(u),()=>{m(),o.delete(u)}},dispatch(u){try{return i=!u?.meta?.[a9],a=!i,a&&(s||(s=!0,l(c))),n.dispatch(u)}finally{i=!0}}})},o9=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new cS(t);return n&&i.push(s9(typeof n=="object"?n:void 0)),i};function l9(t){const e=i9(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Ng(r))o=sS(r);else throw new Error(Er(1));let l;typeof n=="function"?l=n(e):l=e();let c=Nu;i&&(c=r9({trace:!1,...typeof i=="object"&&i}));const u=JU(...l),h=o9(u);let m=typeof s=="function"?s(h):h();const p=c(...m);return aS(o,a,p)}function uS(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Er(28));if(o in e)throw new Error(Er(29));return e[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function c9(t){return typeof t=="function"}function u9(t,e){let[r,n,i]=uS(e),a;if(c9(t))a=()=>dx(t());else{const o=dx(t);a=()=>o}function s(o=a(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,h)=>{if(h)if(Aa(u)){const p=h(u,l);return p===void 0?u:p}else{if(Gn(u))return Se(u,m=>h(m,l));{const m=h(u,l);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},o)}return s.getInitialState=a,s}var d9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",h9=(t=21)=>{let e="",r=t;for(;r--;)e+=d9[Math.random()*64|0];return e},f9=Symbol.for("rtk-slice-createasyncthunk");function m9(t,e){return`${t}/${e}`}function p9({creators:t}={}){const e=t?.asyncThunk?.[f9];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Er(11));const s=(typeof n.reducers=="function"?n.reducers(y9()):n.reducers)||{},o=Object.keys(s),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(E,j){const R=typeof E=="string"?E:E.type;if(!R)throw new Error(Er(12));if(R in l.sliceCaseReducersByType)throw new Error(Er(13));return l.sliceCaseReducersByType[R]=j,c},addMatcher(E,j){return l.sliceMatchers.push({matcher:E,reducer:j}),c},exposeAction(E,j){return l.actionCreators[E]=j,c},exposeCaseReducer(E,j){return l.sliceCaseReducersByName[E]=j,c}};o.forEach(E=>{const j=s[E],R={reducerName:E,type:m9(i,E),createNotation:typeof n.reducers=="function"};b9(j)?w9(R,j,c,e):v9(R,j,c)});function u(){const[E={},j=[],R=void 0]=typeof n.extraReducers=="function"?uS(n.extraReducers):[n.extraReducers],D={...E,...l.sliceCaseReducersByType};return u9(n.initialState,S=>{for(let A in D)S.addCase(A,D[A]);for(let A of l.sliceMatchers)S.addMatcher(A.matcher,A.reducer);for(let A of j)S.addMatcher(A.matcher,A.reducer);R&&S.addDefaultCase(R)})}const h=E=>E,m=new Map,p=new WeakMap;let v;function b(E,j){return v||(v=u()),v(E,j)}function g(){return v||(v=u()),v.getInitialState()}function _(E,j=!1){function R(S){let A=S[E];return typeof A>"u"&&j&&(A=Pc(p,R,g)),A}function D(S=h){const A=Pc(m,j,()=>new WeakMap);return Pc(A,S,()=>{const P={};for(const[O,N]of Object.entries(n.selectors??{}))P[O]=g9(N,S,()=>Pc(p,S,g),j);return P})}return{reducerPath:E,getSelectors:D,get selectors(){return D(R)},selectSlice:R}}const T={name:i,reducer:b,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g,..._(a),injectInto(E,{reducerPath:j,...R}={}){const D=j??a;return E.inject({reducerPath:D,reducer:b},R),{...T,..._(D,!0)}}};return T}}function g9(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var Br=p9();function y9(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function v9({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!x9(n))throw new Error(Er(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?zr(t,s):zr(t))}function b9(t){return t._reducerDefinitionType==="asyncThunk"}function x9(t){return t._reducerDefinitionType==="reducerWithPrepare"}function w9({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Er(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:l,settled:c,options:u}=r,h=i(t,a,u);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(e,{fulfilled:s||Cc,pending:o||Cc,rejected:l||Cc,settled:c||Cc})}function Cc(){}var _9="task",dS="listener",hS="completed",jg="cancelled",E9=`task-${jg}`,T9=`task-${hS}`,xm=`${dS}-${jg}`,A9=`${dS}-${hS}`,rh=class{constructor(t){Nr(this,"name","TaskAbortError");Nr(this,"message");this.code=t,this.message=`${_9} ${jg} (reason: ${t})`}},Og=(t,e)=>{if(typeof t!="function")throw new TypeError(Er(32))},ju=()=>{},fS=(t,e=ju)=>(t.catch(e),t),mS=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),xa=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},wa=t=>{if(t.aborted){const{reason:e}=t;throw new rh(e)}};function pS(t,e){let r=ju;return new Promise((n,i)=>{const a=()=>i(new rh(t.reason));if(t.aborted){a();return}r=mS(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=ju})}var S9=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof rh?"cancelled":"rejected",error:r}}finally{e?.()}},Ou=t=>e=>fS(pS(t,e).then(r=>(wa(t),r))),gS=t=>{const e=Ou(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:ws}=Object,fx={},nh="listenerMiddleware",I9=(t,e)=>{const r=n=>mS(t,()=>xa(n,t.reason));return(n,i)=>{Og(n);const a=new AbortController;r(a);const s=S9(async()=>{wa(t),wa(a.signal);const o=await n({pause:Ou(a.signal),delay:gS(a.signal),signal:a.signal});return wa(a.signal),o},()=>xa(a,T9));return i?.autoJoin&&e.push(s.catch(ju)),{result:Ou(t)(s),cancel(){xa(a,E9)}}}},P9=(t,e)=>{const r=async(n,i)=>{wa(e);let a=()=>{};const o=[new Promise((l,c)=>{let u=t({predicate:n,effect:(h,m)=>{m.unsubscribe(),l([h,m.getState(),m.getOriginalState()])}});a=()=>{u(),c()}})];i!=null&&o.push(new Promise(l=>setTimeout(l,i,null)));try{const l=await pS(e,Promise.race(o));return wa(e),l}finally{a()}};return(n,i)=>fS(r(n,i))},yS=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=zr(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Er(21));return Og(a),{predicate:i,type:e,effect:a}},vS=ws(t=>{const{type:e,predicate:r,effect:n}=yS(t);return{id:h9(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Er(22))}}},{withTypes:()=>vS}),mx=(t,e)=>{const{type:r,effect:n,predicate:i}=yS(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},wm=t=>{t.pending.forEach(e=>{xa(e,xm)})},C9=t=>()=>{t.forEach(wm),t.clear()},px=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},bS=ws(zr(`${nh}/add`),{withTypes:()=>bS}),k9=zr(`${nh}/removeAll`),xS=ws(zr(`${nh}/remove`),{withTypes:()=>xS}),N9=(...t)=>{console.error(`${nh}/error`,...t)},kl=(t={})=>{const e=new Map,{extra:r,onError:n=N9}=t;Og(n);const i=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&wm(u)}),a=u=>{const h=mx(e,u)??vS(u);return i(h)};ws(a,{withTypes:()=>a});const s=u=>{const h=mx(e,u);return h&&(h.unsubscribe(),u.cancelActive&&wm(h)),!!h};ws(s,{withTypes:()=>s});const o=async(u,h,m,p)=>{const v=new AbortController,b=P9(a,v.signal),g=[];try{u.pending.add(v),await Promise.resolve(u.effect(h,ws({},m,{getOriginalState:p,condition:(_,T)=>b(_,T).then(Boolean),take:b,delay:gS(v.signal),pause:Ou(v.signal),extra:r,signal:v.signal,fork:I9(v.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((_,T,E)=>{_!==v&&(xa(_,xm),E.delete(_))})},cancel:()=>{xa(v,xm),u.pending.delete(v)},throwIfCancelled:()=>{wa(v.signal)}})))}catch(_){_ instanceof rh||px(n,_,{raisedBy:"effect"})}finally{await Promise.all(g),xa(v,A9),u.pending.delete(v)}},l=C9(e);return{middleware:u=>h=>m=>{if(!oS(m))return h(m);if(bS.match(m))return a(m.payload);if(k9.match(m)){l();return}if(xS.match(m))return s(m.payload);let p=u.getState();const v=()=>{if(p===fx)throw new Error(Er(23));return p};let b;try{if(b=h(m),e.size>0){const g=u.getState(),_=Array.from(e.values());for(const T of _){let E=!1;try{E=T.predicate(m,g,p)}catch(j){E=!1,px(n,j,{raisedBy:"predicate"})}E&&o(T,m,u,v)}}}finally{p=fx}return b},startListening:a,stopListening:s,clearListeners:l}};function Er(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var j9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},wS=Br({name:"chartLayout",initialState:j9,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:O9,setLayout:R9,setChartSize:D9,setScale:M9}=wS.actions,L9=wS.reducer;function gx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gx(Object(r),!0).forEach(function(n){$9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $9(t,e,r){return(e=V9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V9(t){var e=z9(t,"string");return typeof e=="symbol"?e:e+""}function z9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ru=Math.PI/180,F9=t=>t*180/Math.PI,Ut=(t,e,r,n)=>({x:t+Math.cos(-Ru*n)*r,y:e+Math.sin(-Ru*n)*r}),U9=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},B9=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},H9=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,s=B9({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,l=Math.acos(o);return n>a&&(l=2*Math.PI-l),{radius:s,angle:F9(l),angleInRadian:l}},W9=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},q9=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return t+s*360},K9=(t,e)=>{var{x:r,y:n}=t,{radius:i,angle:a}=H9({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(i<s||i>o||i===0)return null;var{startAngle:l,endAngle:c}=W9(e),u=a,h;if(l<=c){for(;u>c;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=c}else{for(;u>l;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=l}return h?yx(yx({},e),{},{radius:i,angle:q9(u,e)}):null};function vx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vx(Object(r),!0).forEach(function(n){G9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function G9(t,e,r){return(e=Y9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y9(t){var e=Z9(t,"string");return typeof e=="symbol"?e:e+""}function Z9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e,r){return ct(t)||ct(e)?r:Sn(e)?Ma(t,e,r):typeof e=="function"?e(t):r}var X9=(t,e,r,n,i)=>{var a,s=-1,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,u=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,m=void 0;if(Lr(u-c)!==Lr(h-u)){var p=[];if(Lr(h-u)===Lr(i[1]-i[0])){m=h;var v=u+i[1]-i[0];p[0]=Math.min(v,(v+c)/2),p[1]=Math.max(v,(v+c)/2)}else{m=c;var b=h+i[1]-i[0];p[0]=Math.min(u,(b+u)/2),p[1]=Math.max(u,(b+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(t>g[0]&&t<=g[1]||t>=p[0]&&t<=p[1]){({index:s}=r[l]);break}}else{var _=Math.min(c,h),T=Math.max(c,h);if(t>(_+u)/2&&t<=(T+u)/2){({index:s}=r[l]);break}}}else if(e){for(var E=0;E<o;E++)if(E===0&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E>0&&E<o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E===o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2){({index:s}=e[E]);break}}return s},Q9=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&te(t[a]))return Rr(Rr({},t),{},{[a]:t[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&te(t[s]))return Rr(Rr({},t),{},{[s]:t[s]+(i||0)})}return t},Wi=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",_S=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var i,a,s=t.map(o=>(o.coordinate===e&&(i=!0),o.coordinate===r&&(a=!0),o.coordinate));return i||s.push(e),a||s.push(r),s},ES=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:o,isCategorical:l,categoricalDomain:c,tickCount:u,ticks:h,niceTicks:m,axisType:p}=t;if(!s)return null;var v=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,b=i==="category"&&s.bandwidth?s.bandwidth()/v:0;if(b=p==="angleAxis"&&a&&a.length>=2?Lr(a[0]-a[1])*2*b:b,h||m){var g=(h||m||[]).map((_,T)=>{var E=n?n.indexOf(_):_;return{coordinate:s(E)+b,value:_,offset:b,index:T}});return g.filter(_=>!Vr(_.coordinate))}return l&&c?c.map((_,T)=>({coordinate:s(_)+b,value:_,index:T,offset:b})):s.ticks&&u!=null?s.ticks(u).map((_,T)=>({coordinate:s(_)+b,value:_,offset:b,index:T})):s.domain().map((_,T)=>({coordinate:s(_)+b,value:n?n[_]:_,index:T,offset:b}))},bx=1e-4,J9=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-bx,a=Math.max(n[0],n[1])+bx,s=t(e[0]),o=t(e[r-1]);(s<i||s>a||o<i||o>a)&&t.domain([e[0],e[r-1]])}},eB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0,s=0;s<e;++s){var o=Vr(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1]):(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1])}},tB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0;a<e;++a){var s=Vr(t[a][r][1])?t[a][r][0]:t[a][r][1];s>=0?(t[a][r][0]=i,t[a][r][1]=i+s,i=t[a][r][1]):(t[a][r][0]=0,t[a][r][1]=0)}},rB={sign:eB,expand:lU,none:ks,silhouette:cU,wiggle:uU,positive:tB},nB=(t,e,r)=>{var n=rB[r],i=oU().keys(e).value((a,s)=>+Tr(a,s,0)).order(bm).offset(n);return i(t)};function iB(t){return t==null?void 0:String(t)}function xx(t){var{axis:e,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!ct(i[e.dataKey])){var o=mA(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var l=Tr(i,ct(s)?e.dataKey:s);return ct(l)?null:e.scale(l)}var aB=t=>{var e=t.flat(2).filter(te);return[Math.min(...e),Math.max(...e)]},sB=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],oB=(t,e,r)=>{if(t!=null)return sB(Object.keys(t).reduce((n,i)=>{var a=t[i],{stackedData:s}=a,o=s.reduce((l,c)=>{var u=aB(c.slice(e,r+1));return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},wx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_x=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_m=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=th(e,u=>u.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var l=i[s],c=i[s-1];a=Math.min((l.coordinate||0)-(c.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function Ex(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Rr(Rr({},e),{},{dataKey:r,payload:n,value:i,name:a})}function TS(t,e){if(t)return String(t);if(typeof e=="string")return e}function lB(t,e,r,n,i){if(r==="horizontal"||r==="vertical"){var a=t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height;return a?{x:t,y:e}:null}return n?K9({x:t,y:e},n):null}var cB=(t,e,r,n)=>{var i=e.find(c=>c&&c.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:i.coordinate};if(t==="centric"){var a=i.coordinate,{radius:s}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:l}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},uB=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ni=t=>t.layout.width,ii=t=>t.layout.height,dB=t=>t.layout.scale,AS=t=>t.layout.margin,Rg=V(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Dg=V(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),hB="data-recharts-item-index",fB="data-recharts-item-data-key",ih=60;function Tx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tx(Object(r),!0).forEach(function(n){mB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mB(t,e,r){return(e=pB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pB(t){var e=gB(t,"string");return typeof e=="symbol"?e:e+""}function gB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yB=t=>t.brush.height,Ht=V([ni,ii,AS,yB,Rg,Dg,iS,KU],(t,e,r,n,i,a,s,o)=>{var l=a.reduce((v,b)=>{var{orientation:g}=b;if(!b.mirror&&!b.hide){var _=typeof b.width=="number"?b.width:ih;return mi(mi({},v),{},{[g]:v[g]+_})}return v},{left:r.left||0,right:r.right||0}),c=i.reduce((v,b)=>{var{orientation:g}=b;return!b.mirror&&!b.hide?mi(mi({},v),{},{[g]:Ma(v,"".concat(g))+b.height}):v},{top:r.top||0,bottom:r.bottom||0}),u=mi(mi({},c),l),h=u.bottom;u.bottom+=n,u=Q9(u,s,o);var m=t-u.left-u.right,p=e-u.top-u.bottom;return mi(mi({brushBottom:h},u),{},{width:Math.max(m,0),height:Math.max(p,0)})}),vB=V(Ht,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),SS=V(ni,ii,(t,e)=>({x:0,y:0,width:t,height:e})),bB=w.createContext(null),mr=()=>w.useContext(bB)!=null,ah=t=>t.brush,sh=V([ah,Ht,AS],(t,e,r)=>({height:t.height,x:te(t.x)?t.x:e.left,y:te(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:te(t.width)?t.width:e.width})),Mg=()=>{var t,e=mr(),r=ie(vB),n=ie(sh),i=(t=ie(ah))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},xB={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},IS=()=>{var t;return(t=ie(Ht))!==null&&t!==void 0?t:xB},PS=()=>ie(ni),CS=()=>ie(ii),tt=t=>t.layout.layoutType,Lg=()=>ie(tt),wB={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},kS=Br({name:"legend",initialState:wB,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Un(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:ZJ,setLegendSettings:XJ,addLegendPayload:_B,removeLegendPayload:EB}=kS.actions,TB=kS.reducer;function Em(){return Em=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Em.apply(null,arguments)}function Ax(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ax(Object(r),!0).forEach(function(n){AB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ax(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AB(t,e,r){return(e=SB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SB(t){var e=IB(t,"string");return typeof e=="symbol"?e:e+""}function IB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PB(t){return Array.isArray(t)&&Sn(t[0])&&Sn(t[1])?t.join(" ~ "):t}var CB=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:c,label:u,labelFormatter:h,accessibilityLayer:m=!1}=t,p=()=>{if(a&&a.length){var R={padding:0,margin:0},D=(o?th(a,o):a).map((S,A)=>{if(S.type==="none")return null;var P=S.formatter||s||PB,{value:O,name:N}=S,C=O,k=N;if(P){var Q=P(O,N,S,A,a);if(Array.isArray(Q))[C,k]=Q;else if(Q!=null)C=Q;else return null}var oe=hf({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:oe},Sn(k)?w.createElement("span",{className:"recharts-tooltip-item-name"},k):null,Sn(k)?w.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,w.createElement("span",{className:"recharts-tooltip-item-value"},C),w.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:R},D)}return null},v=hf({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=hf({margin:0},i),g=!ct(u),_=g?u:"",T=Le("recharts-default-tooltip",l),E=Le("recharts-tooltip-label",c);g&&h&&a!==void 0&&a!==null&&(_=h(u,a));var j=m?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",Em({className:T,style:v},j),w.createElement("p",{className:E,style:b},w.isValidElement(_)?_:"".concat(_)),p())},yo="recharts-tooltip-wrapper",kB={visibility:"hidden"};function NB(t){var{coordinate:e,translateX:r,translateY:n}=t;return Le(yo,{["".concat(yo,"-right")]:te(r)&&e&&te(e.x)&&r>=e.x,["".concat(yo,"-left")]:te(r)&&e&&te(e.x)&&r<e.x,["".concat(yo,"-bottom")]:te(n)&&e&&te(e.y)&&n>=e.y,["".concat(yo,"-top")]:te(n)&&e&&te(e.y)&&n<e.y})}function Sx(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=t;if(a&&te(a[n]))return a[n];var u=r[n]-o-(i>0?i:0),h=r[n]+i;if(e[n])return s[n]?u:h;var m=l[n];if(m==null)return 0;if(s[n]){var p=u,v=m;return p<v?Math.max(h,m):Math.max(u,m)}if(c==null)return 0;var b=h+o,g=m+c;return b>g?Math.max(u,m):Math.max(h,m)}function jB(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function OB(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:l}=t,c,u,h;return s.height>0&&s.width>0&&r?(u=Sx({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=Sx({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=jB({translateX:u,translateY:h,useTranslate3d:o})):c=kB,{cssProperties:c,cssClasses:NB({translateX:u,translateY:h,coordinate:r})}}function Ix(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ix(Object(r),!0).forEach(function(n){Tm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ix(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tm(t,e,r){return(e=RB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RB(t){var e=DB(t,"string");return typeof e=="symbol"?e:e+""}function DB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MB extends w.PureComponent{constructor(){super(...arguments),Tm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Tm(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:l,offset:c,position:u,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:v,lastBoundingBox:b,innerRef:g,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:E}=OB({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:c,position:u,reverseDirection:h,tooltipBox:{height:b.height,width:b.width},useTranslate3d:m,viewBox:p}),j=_?{}:kc(kc({transition:l&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),R=kc(kc({},j),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},v);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:R,ref:g},a)}}var LB=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Nl={isSsr:LB()},NS=()=>ie(t=>t.rootProps.accessibilityLayer);function tn(t){return Number.isFinite(t)}function Du(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Am(){return Am=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Am.apply(null,arguments)}function Px(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Cx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Px(Object(r),!0).forEach(function(n){$B(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Px(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $B(t,e,r){return(e=VB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VB(t){var e=zB(t,"string");return typeof e=="symbol"?e:e+""}function zB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kx={curveBasisClosed:ZF,curveBasisOpen:XF,curveBasis:YF,curveBumpX:KF,curveBumpY:GF,curveLinearClosed:QF,curveLinear:Gd,curveMonotoneX:JF,curveMonotoneY:eU,curveNatural:tU,curveStep:rU,curveStepAfter:iU,curveStepBefore:nU},Nc=t=>tn(t.x)&&tn(t.y),vo=t=>t.x,bo=t=>t.y,FB=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(yg(t));return(r==="curveMonotone"||r==="curveBump")&&e?kx["".concat(r).concat(e==="vertical"?"Y":"X")]:kx[r]||Gd},UB=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,s=FB(e,i),o=a?r.filter(Nc):r,l;if(Array.isArray(n)){var c=a?n.filter(h=>Nc(h)):n,u=o.map((h,m)=>Cx(Cx({},h),{},{base:c[m]}));return i==="vertical"?l=Ac().y(bo).x1(vo).x0(h=>h.base.x):l=Ac().x(vo).y1(bo).y0(h=>h.base.y),l.defined(Nc).curve(s),l(u)}return i==="vertical"&&te(n)?l=Ac().y(bo).x1(vo).x0(n):te(n)?l=Ac().x(vo).y1(bo).y0(n):l=TA().x(vo).y(bo),l.defined(Nc).curve(s),l(o)},jS=t=>{var{className:e,points:r,path:n,pathRef:i}=t;if((!r||!r.length)&&!n)return null;var a=r&&r.length?UB(t):n;return w.createElement("path",Am({},Ke(t,!1),bg(t),{className:Le("recharts-curve",e),d:a===null?void 0:a,ref:i}))},BB=["x","y","top","left","width","height","className"];function Sm(){return Sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Sm.apply(null,arguments)}function Nx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function HB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nx(Object(r),!0).forEach(function(n){WB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WB(t,e,r){return(e=qB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qB(t){var e=KB(t,"string");return typeof e=="symbol"?e:e+""}function KB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GB(t,e){if(t==null)return{};var r,n,i=YB(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function YB(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var ZB=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),XB=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=t,l=GB(t,BB),c=HB({x:e,y:r,top:n,left:i,width:a,height:s},l);return!te(e)||!te(r)||!te(a)||!te(s)||!te(n)||!te(i)?null:w.createElement("path",Sm({},Ke(c,!0),{className:Le("recharts-cross",o),d:ZB(e,r,a,s,n,i)}))};function QB(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function jx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jx(Object(r),!0).forEach(function(n){e8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function e8(t,e,r){return(e=t8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t8(t){var e=r8(t,"string");return typeof e=="symbol"?e:e+""}function r8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qa(t,e){var r=JB({},t),n=e,i=Object.keys(e),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var OS={},RS={},DS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}t.isPlainObject=e})(DS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=DS,r=Sg,n=Qd,i=Jd,a=Xd;function s(c,u,h){return o(c,u,void 0,void 0,void 0,void 0,h)}function o(c,u,h,m,p,v,b){const g=b(c,u,h,m,p,v);if(g!==void 0)return g;if(typeof c==typeof u)switch(typeof c){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return c===u;case"number":return c===u||Object.is(c,u);case"function":return c===u;case"object":return l(c,u,v,b)}return l(c,u,v,b)}function l(c,u,h,m){if(Object.is(c,u))return!0;let p=n.getTag(c),v=n.getTag(u);if(p===i.argumentsTag&&(p=i.objectTag),v===i.argumentsTag&&(v=i.objectTag),p!==v)return!1;switch(p){case i.stringTag:return c.toString()===u.toString();case i.numberTag:{const _=c.valueOf(),T=u.valueOf();return a.eq(_,T)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(c.valueOf(),u.valueOf());case i.regexpTag:return c.source===u.source&&c.flags===u.flags;case i.functionTag:return c===u}h=h??new Map;const b=h.get(c),g=h.get(u);if(b!=null&&g!=null)return b===u;h.set(c,u),h.set(u,c);try{switch(p){case i.mapTag:{if(c.size!==u.size)return!1;for(const[_,T]of c.entries())if(!u.has(_)||!o(T,u.get(_),_,c,u,h,m))return!1;return!0}case i.setTag:{if(c.size!==u.size)return!1;const _=Array.from(c.values()),T=Array.from(u.values());for(let E=0;E<_.length;E++){const j=_[E],R=T.findIndex(D=>o(j,D,void 0,c,u,h,m));if(R===-1)return!1;T.splice(R,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(c)!==Buffer.isBuffer(u)||c.length!==u.length)return!1;for(let _=0;_<c.length;_++)if(!o(c[_],u[_],_,c,u,h,m))return!1;return!0}case i.arrayBufferTag:return c.byteLength!==u.byteLength?!1:l(new Uint8Array(c),new Uint8Array(u),h,m);case i.dataViewTag:return c.byteLength!==u.byteLength||c.byteOffset!==u.byteOffset?!1:l(new Uint8Array(c),new Uint8Array(u),h,m);case i.errorTag:return c.name===u.name&&c.message===u.message;case i.objectTag:{if(!(l(c.constructor,u.constructor,h,m)||e.isPlainObject(c)&&e.isPlainObject(u)))return!1;const T=[...Object.keys(c),...r.getSymbols(c)],E=[...Object.keys(u),...r.getSymbols(u)];if(T.length!==E.length)return!1;for(let j=0;j<T.length;j++){const R=T[j],D=c[R];if(!Object.hasOwn(u,R))return!1;const S=u[R];if(!o(D,S,R,c,u,h,m))return!1}return!0}default:return!1}}finally{h.delete(c),h.delete(u)}}t.isEqualWith=s})(RS);var MS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(MS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RS,r=MS;function n(i,a){return e.isEqualWith(i,a,r.noop)}t.isEqual=n})(OS);var n8=OS.isEqual;const i8=Fi(n8);function a8(t){var e={},r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...c]=o;if(typeof l=="number"){i=t.setTimeout(a.bind(null,c),l);return}a(l),i=t.setTimeout(a.bind(null,c));return}typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}var Mu=1e-4,LS=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],$S=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Ox=(t,e)=>r=>{var n=LS(t,e);return $S(n,r)},s8=(t,e)=>r=>{var n=LS(t,e),i=[...n.map((a,s)=>a*s).slice(1),0];return $S(i,r)},Rx=function(){for(var e,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,i]=[0,0,1,1];break;case"ease":[e,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,i]=[.42,0,1,1];break;case"ease-out":[e,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,i]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,n,r,i]=l[1].split(")")[0].split(",").map(v=>parseFloat(v)))}}else s.length===4&&([e,n,r,i]=s);var c=Ox(e,r),u=Ox(n,i),h=s8(e,r),m=v=>v>1?1:v<0?0:v,p=v=>{for(var b=v>1?1:v,g=b,_=0;_<8;++_){var T=c(g)-b,E=h(g);if(Math.abs(T-b)<Mu||E<Mu)return u(g);g=m(g-T/E)}return u(g)};return p.isStepper=!1,p},o8=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(s,o,l)=>{var c=-(s-o)*r,u=l*n,h=l+(c-u)*i/1e3,m=l*i/1e3+s;return Math.abs(m-o)<Mu&&Math.abs(h)<Mu?[o,0]:[m,h]};return a.isStepper=!0,a.dt=i,a},l8=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Rx(t);case"spring":return o8();default:if(t.split("(")[0]==="cubic-bezier")return Rx(t)}return typeof t=="function"?t:null};function Dx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dx(Object(r),!0).forEach(function(n){c8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c8(t,e,r){return(e=u8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u8(t){var e=d8(t,"string");return typeof e=="symbol"?e:e+""}function d8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h8=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),f8=(t,e,r)=>t.map(n=>"".concat(h8(n)," ").concat(e,"ms ").concat(r)).join(","),m8=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),ol=(t,e)=>Object.keys(e).reduce((r,n)=>Mx(Mx({},r),{},{[n]:t(n,e[n])}),{});function Lx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lx(Object(r),!0).forEach(function(n){p8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function p8(t,e,r){return(e=g8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g8(t){var e=y8(t,"string");return typeof e=="symbol"?e:e+""}function y8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lu=(t,e,r)=>t+(e-t)*r,Im=t=>{var{from:e,to:r}=t;return e!==r},VS=(t,e,r)=>{var n=ol((i,a)=>{if(Im(a)){var[s,o]=t(a.from,a.to,a.velocity);return zt(zt({},a),{},{from:s,velocity:o})}return a},e);return r<1?ol((i,a)=>Im(a)?zt(zt({},a),{},{velocity:Lu(a.velocity,n[i].velocity,r),from:Lu(a.from,n[i].from,r)}):a,e):VS(t,n,r-1)};function v8(t,e,r,n,i,a){var s,o=n.reduce((m,p)=>zt(zt({},m),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),l=()=>ol((m,p)=>p.from,o),c=()=>!Object.values(o).filter(Im).length,u=null,h=m=>{s||(s=m);var p=m-s,v=p/r.dt;o=VS(r,o,v),i(zt(zt(zt({},t),e),l())),s=m,c()||(u=a.setTimeout(h))};return()=>(u=a.setTimeout(h),()=>{u()})}function b8(t,e,r,n,i,a,s){var o=null,l=i.reduce((h,m)=>zt(zt({},h),{},{[m]:[t[m],e[m]]}),{}),c,u=h=>{c||(c=h);var m=(h-c)/n,p=ol((b,g)=>Lu(...g,r(m)),l);if(a(zt(zt(zt({},t),e),p)),m<1)o=s.setTimeout(u);else{var v=ol((b,g)=>Lu(...g,r(1)),l);a(zt(zt(zt({},t),e),v))}};return()=>(o=s.setTimeout(u),()=>{o()})}const x8=(t,e,r,n,i,a)=>{var s=m8(t,e);return r.isStepper===!0?v8(t,e,r,s,i,a):b8(t,e,r,n,s,i,a)};class w8{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}var _8=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Pm(){return Pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pm.apply(null,arguments)}function E8(t,e){if(t==null)return{};var r,n,i=T8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function T8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function $x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$x(Object(r),!0).forEach(function(n){fa(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$x(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fa(t,e,r){return(e=A8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A8(t){var e=S8(t,"string");return typeof e=="symbol"?e:e+""}function S8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I8(){return a8(new w8)}class $g extends w.PureComponent{constructor(e,r){super(e,r),fa(this,"mounted",!1),fa(this,"manager",null),fa(this,"stopJSAnimation",null),fa(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:r}=this.props;this.mounted=!0,!(!e||!r)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:i?{[i]:s}:s};this.state&&l&&(i&&l[i]!==s||!i&&l!==s)&&this.setState(c);return}if(!(i8(e.to,s)&&e.canBegin&&e.isActive)){var u=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=u||a?o:e.to;if(this.state&&l){var m={style:i?{[i]:h}:h};(i&&l[i]!==h||!i&&l!==h)&&this.setState(m)}this.runAnimation(pi(pi({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:l}=e,c=x8(r,n,l8(a),i,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=c()};this.manager.start([l,s,u,i,o])}runAnimation(e){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:l,children:c}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof c=="function"||s==="spring"){this.runJSAnimation(e);return}var u=i?{[i]:a}:a,h=f8(Object.keys(u),n,s);this.manager.start([o,r,pi(pi({},u),{},{transition:h}),n,l])}render(){var e=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:l,to:c,canBegin:u,onAnimationEnd:h,shouldReAnimate:m,onAnimationReStart:p,animationManager:v}=e,b=E8(e,_8),g=w.Children.count(r),_=this.state.style;if(typeof r=="function")return r(_);if(!o||g===0||i<=0)return r;var T=E=>{var{style:j={},className:R}=E.props,D=w.cloneElement(E,pi(pi({},b),{},{style:pi(pi({},j),_),className:R}));return D};return g===1?T(w.Children.only(r)):w.createElement("div",null,w.Children.map(r,E=>T(E)))}}fa($g,"displayName","Animate");fa($g,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var P8=w.createContext(null);function $u(t){var e,r,n=w.useContext(P8);return w.createElement($g,Pm({},t,{animationManager:(e=(r=t.animationManager)!==null&&r!==void 0?r:n)!==null&&e!==void 0?e:I8()}))}function Vu(){return Vu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vu.apply(null,arguments)}var Vx=(t,e,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>a?a:i[h];c="M".concat(t,",").concat(e+s*u[0]),u[0]>0&&(c+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(t+o*u[0],",").concat(e)),c+="L ".concat(t+r-o*u[1],",").concat(e),u[1]>0&&(c+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,`,
        `).concat(t+r,",").concat(e+s*u[1])),c+="L ".concat(t+r,",").concat(e+n-s*u[2]),u[2]>0&&(c+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,`,
        `).concat(t+r-o*u[2],",").concat(e+n)),c+="L ".concat(t+o*u[3],",").concat(e+n),u[3]>0&&(c+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+n-s*u[3])),c+="Z"}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);c="M ".concat(t,",").concat(e+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+o*p,",").concat(e,`
            L `).concat(t+r-o*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+r,",").concat(e+s*p,`
            L `).concat(t+r,",").concat(e+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+r-o*p,",").concat(e+n,`
            L `).concat(t+o*p,",").concat(e+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t,",").concat(e+n-s*p," Z")}else c="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},C8={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},k8=t=>{var e=qa(t,C8),r=w.useRef(null),[n,i]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&i(_)}catch{}},[]);var{x:a,y:s,width:o,height:l,radius:c,className:u}=e,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:v,isUpdateAnimationActive:b}=e;if(a!==+a||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var g=Le("recharts-rectangle",u);return b?w.createElement($u,{canBegin:n>0,from:{width:o,height:l,x:a,y:s},to:{width:o,height:l,x:a,y:s},duration:m,animationEasing:h,isActive:b},_=>{var{width:T,height:E,x:j,y:R}=_;return w.createElement($u,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:m,isActive:v,easing:h},w.createElement("path",Vu({},Ke(e,!0),{className:g,d:Vx(j,R,T,E,c),ref:r})))}):w.createElement("path",Vu({},Ke(e,!0),{className:g,d:Vx(a,s,o,l,c)}))};function zS(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,s=Ut(e,r,n,i),o=Ut(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function Cm(){return Cm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cm.apply(null,arguments)}var N8=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},jc=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:l}=t,c=o*(s?1:-1)+n,u=Math.asin(o/c)/Ru,h=l?i:i+a*u,m=Ut(e,r,c,h),p=Ut(e,r,n,h),v=l?i-a*u:i,b=Ut(e,r,c*Math.cos(u*Ru),v);return{center:m,circleTangency:p,lineTangency:b,theta:u}},FS=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=t,o=N8(a,s),l=a+o,c=Ut(e,r,i,a),u=Ut(e,r,i,l),h="M ".concat(c.x,",").concat(c.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>l),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var m=Ut(e,r,n,a),p=Ut(e,r,n,l);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=l),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},j8=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:c}=t,u=Lr(c-l),{circleTangency:h,lineTangency:m,theta:p}=jc({cx:e,cy:r,radius:i,angle:l,sign:u,cornerRadius:a,cornerIsExternal:o}),{circleTangency:v,lineTangency:b,theta:g}=jc({cx:e,cy:r,radius:i,angle:c,sign:-u,cornerRadius:a,cornerIsExternal:o}),_=o?Math.abs(l-c):Math.abs(l-c)-p-g;if(_<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):FS({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:l,endAngle:c});var T="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:j,theta:R}=jc({cx:e,cy:r,radius:n,angle:l,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:D,lineTangency:S,theta:A}=jc({cx:e,cy:r,radius:n,angle:c,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(l-c):Math.abs(l-c)-R-A;if(P<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+="L".concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(j.x,",").concat(j.y,"Z")}else T+="L".concat(e,",").concat(r,"Z");return T},O8={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},R8=t=>{var e=qa(t,O8),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u,className:h}=e;if(a<i||c===u)return null;var m=Le("recharts-sector",h),p=a-i,v=Vi(s,p,0,!0),b;return v>0&&Math.abs(c-u)<360?b=j8({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,p/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}):b=FS({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:u}),w.createElement("path",Cm({},Ke(e,!0),{className:m,d:b}))};function D8(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:l,innerRadius:c,outerRadius:u,angle:h}=e,m=Ut(o,l,c,h),p=Ut(o,l,u,h);n=m.x,i=m.y,a=p.x,s=p.y}else return zS(e);return[{x:n,y:i},{x:a,y:s}]}var US={},BS={},HS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cg;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(HS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HS;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(BS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=kg,r=BS;function n(i,a,s){s&&typeof s!="number"&&e.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),l=new Array(o);for(let c=0;c<o;c++)l[c]=i,i+=s;return l}t.range=n})(US);var M8=US.range;const WS=Fi(M8);function ki(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function L8(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Vg(t){let e,r,n;t.length!==2?(e=ki,r=(o,l)=>ki(t(o),l),n=(o,l)=>t(o)-l):(e=t===ki||t===L8?t:$8,r=t,n=t);function i(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<0?c=h+1:u=h}while(c<u)}return c}function a(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function s(o,l,c=0,u=o.length){const h=i(o,l,c,u-1);return h>c&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:i,center:s,right:a}}function $8(){return 0}function qS(t){return t===null?NaN:+t}function*V8(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const z8=Vg(ki),jl=z8.right;Vg(qS).center;class zx extends Map{constructor(e,r=B8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(Fx(this,e))}has(e){return super.has(Fx(this,e))}set(e,r){return super.set(F8(this,e),r)}delete(e){return super.delete(U8(this,e))}}function Fx({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function F8({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function U8({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function B8(t){return t!==null&&typeof t=="object"?t.valueOf():t}function H8(t=ki){if(t===ki)return KS;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function KS(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const W8=Math.sqrt(50),q8=Math.sqrt(10),K8=Math.sqrt(2);function zu(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=W8?10:a>=q8?5:a>=K8?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(t*c),l=Math.round(e*c),o/c<t&&++o,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(t/c),l=Math.round(e/c),o*c<t&&++o,l*c>e&&--l),l<o&&.5<=r&&r<2?zu(t,e,r*2):[o,l,c]}function km(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?zu(e,t,r):zu(t,e,r);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}function Nm(t,e,r){return e=+e,t=+t,r=+r,zu(t,e,r)[2]}function jm(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?Nm(e,t,r):Nm(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function Ux(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Bx(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function GS(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?KS:H8(i);n>r;){if(n-r>600){const l=n-r+1,c=e-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),p=Math.max(r,Math.floor(e-c*h/l+m)),v=Math.min(n,Math.floor(e+(l-c)*h/l+m));GS(t,e,p,v,i)}const a=t[e];let s=r,o=n;for(xo(t,r,e),i(t[n],a)>0&&xo(t,r,n);s<o;){for(xo(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?xo(t,r,o):(++o,xo(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function xo(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function G8(t,e,r){if(t=Float64Array.from(V8(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return Bx(t);if(e>=1)return Ux(t);var n,i=(n-1)*e,a=Math.floor(i),s=Ux(GS(t,a).subarray(0,a+1)),o=Bx(t.subarray(a+1));return s+(o-s)*(i-a)}}function Y8(t,e,r=qS){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function Z8(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Hr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ai(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Om=Symbol("implicit");function zg(){var t=new zx,e=[],r=[],n=Om;function i(a){let s=t.get(a);if(s===void 0){if(n!==Om)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new zx;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return zg(e,r).unknown(n)},Hr.apply(i,arguments),i}function Fg(){var t=zg().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,l=0,c=0,u=.5;delete t.unknown;function h(){var m=e().length,p=i<n,v=p?i:n,b=p?n:i;a=(b-v)/Math.max(1,m-l+c*2),o&&(a=Math.floor(a)),v+=(b-v-a*(m-l))*u,s=a*(1-l),o&&(v=Math.round(v),s=Math.round(s));var g=Z8(m).map(function(_){return v+a*_});return r(p?g.reverse():g)}return t.domain=function(m){return arguments.length?(e(m),h()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(m){return arguments.length?(o=!!m,h()):o},t.padding=function(m){return arguments.length?(l=Math.min(1,c=+m),h()):l},t.paddingInner=function(m){return arguments.length?(l=Math.min(1,m),h()):l},t.paddingOuter=function(m){return arguments.length?(c=+m,h()):c},t.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},t.copy=function(){return Fg(e(),[n,i]).round(o).paddingInner(l).paddingOuter(c).align(u)},Hr.apply(h(),arguments)}function YS(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return YS(e())},t}function X8(){return YS(Fg.apply(null,arguments).paddingInner(1))}function Ug(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ZS(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Ol(){}var ll=.7,Fu=1/ll,_s="\\s*([+-]?\\d+)\\s*",cl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Q8=/^#([0-9a-f]{3,8})$/,J8=new RegExp(`^rgb\\(${_s},${_s},${_s}\\)$`),eH=new RegExp(`^rgb\\(${wn},${wn},${wn}\\)$`),tH=new RegExp(`^rgba\\(${_s},${_s},${_s},${cl}\\)$`),rH=new RegExp(`^rgba\\(${wn},${wn},${wn},${cl}\\)$`),nH=new RegExp(`^hsl\\(${cl},${wn},${wn}\\)$`),iH=new RegExp(`^hsla\\(${cl},${wn},${wn},${cl}\\)$`),Hx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ug(Ol,ul,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Wx,formatHex:Wx,formatHex8:aH,formatHsl:sH,formatRgb:qx,toString:qx});function Wx(){return this.rgb().formatHex()}function aH(){return this.rgb().formatHex8()}function sH(){return XS(this).formatHsl()}function qx(){return this.rgb().formatRgb()}function ul(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Q8.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Kx(e):r===3?new ur(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Oc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Oc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=J8.exec(t))?new ur(e[1],e[2],e[3],1):(e=eH.exec(t))?new ur(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tH.exec(t))?Oc(e[1],e[2],e[3],e[4]):(e=rH.exec(t))?Oc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=nH.exec(t))?Zx(e[1],e[2]/100,e[3]/100,1):(e=iH.exec(t))?Zx(e[1],e[2]/100,e[3]/100,e[4]):Hx.hasOwnProperty(t)?Kx(Hx[t]):t==="transparent"?new ur(NaN,NaN,NaN,0):null}function Kx(t){return new ur(t>>16&255,t>>8&255,t&255,1)}function Oc(t,e,r,n){return n<=0&&(t=e=r=NaN),new ur(t,e,r,n)}function oH(t){return t instanceof Ol||(t=ul(t)),t?(t=t.rgb(),new ur(t.r,t.g,t.b,t.opacity)):new ur}function Rm(t,e,r,n){return arguments.length===1?oH(t):new ur(t,e,r,n??1)}function ur(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Ug(ur,Rm,ZS(Ol,{brighter(t){return t=t==null?Fu:Math.pow(Fu,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ll:Math.pow(ll,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ur(_a(this.r),_a(this.g),_a(this.b),Uu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gx,formatHex:Gx,formatHex8:lH,formatRgb:Yx,toString:Yx}));function Gx(){return`#${ma(this.r)}${ma(this.g)}${ma(this.b)}`}function lH(){return`#${ma(this.r)}${ma(this.g)}${ma(this.b)}${ma((isNaN(this.opacity)?1:this.opacity)*255)}`}function Yx(){const t=Uu(this.opacity);return`${t===1?"rgb(":"rgba("}${_a(this.r)}, ${_a(this.g)}, ${_a(this.b)}${t===1?")":`, ${t})`}`}function Uu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function _a(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ma(t){return t=_a(t),(t<16?"0":"")+t.toString(16)}function Zx(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,r,n)}function XS(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof Ol||(t=ul(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Yr(s,o,l,t.opacity)}function cH(t,e,r,n){return arguments.length===1?XS(t):new Yr(t,e,r,n??1)}function Yr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Ug(Yr,cH,ZS(Ol,{brighter(t){return t=t==null?Fu:Math.pow(Fu,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ll:Math.pow(ll,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new ur(ff(t>=240?t-240:t+120,i,n),ff(t,i,n),ff(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Yr(Xx(this.h),Rc(this.s),Rc(this.l),Uu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Uu(this.opacity);return`${t===1?"hsl(":"hsla("}${Xx(this.h)}, ${Rc(this.s)*100}%, ${Rc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Xx(t){return t=(t||0)%360,t<0?t+360:t}function Rc(t){return Math.max(0,Math.min(1,t||0))}function ff(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Bg=t=>()=>t;function uH(t,e){return function(r){return t+r*e}}function dH(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function hH(t){return(t=+t)==1?QS:function(e,r){return r-e?dH(e,r,t):Bg(isNaN(e)?r:e)}}function QS(t,e){var r=e-t;return r?uH(t,r):Bg(isNaN(t)?e:t)}const Qx=function t(e){var r=hH(e);function n(i,a){var s=r((i=Rm(i)).r,(a=Rm(a)).r),o=r(i.g,a.g),l=r(i.b,a.b),c=QS(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return n.gamma=t,n}(1);function fH(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function mH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pH(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Hs(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function gH(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Bu(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function yH(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Hs(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var Dm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mf=new RegExp(Dm.source,"g");function vH(t){return function(){return t}}function bH(t){return function(e){return t(e)+""}}function xH(t,e){var r=Dm.lastIndex=mf.lastIndex=0,n,i,a,s=-1,o=[],l=[];for(t=t+"",e=e+"";(n=Dm.exec(t))&&(i=mf.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:Bu(n,i)})),r=mf.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?bH(l[0].x):vH(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)o[(h=l[u]).i]=h.x(c);return o.join("")})}function Hs(t,e){var r=typeof e,n;return e==null||r==="boolean"?Bg(e):(r==="number"?Bu:r==="string"?(n=ul(e))?(e=n,Qx):xH:e instanceof ul?Qx:e instanceof Date?gH:mH(e)?fH:Array.isArray(e)?pH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?yH:Bu)(t,e)}function Hg(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function wH(t,e){e===void 0&&(e=t,t=Hs);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function _H(t){return function(){return t}}function Hu(t){return+t}var Jx=[0,1];function ir(t){return t}function Mm(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:_H(isNaN(e)?NaN:.5)}function EH(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function TH(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=Mm(i,n),a=r(s,a)):(n=Mm(n,i),a=r(a,s)),function(o){return a(n(o))}}function AH(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=Mm(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var l=jl(t,o,1,n)-1;return a[l](i[l](o))}}function Rl(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function oh(){var t=Jx,e=Jx,r=Hs,n,i,a,s=ir,o,l,c;function u(){var m=Math.min(t.length,e.length);return s!==ir&&(s=EH(t[0],t[m-1])),o=m>2?AH:TH,l=c=null,h}function h(m){return m==null||isNaN(m=+m)?a:(l||(l=o(t.map(n),e,r)))(n(s(m)))}return h.invert=function(m){return s(i((c||(c=o(e,t.map(n),Bu)))(m)))},h.domain=function(m){return arguments.length?(t=Array.from(m,Hu),u()):t.slice()},h.range=function(m){return arguments.length?(e=Array.from(m),u()):e.slice()},h.rangeRound=function(m){return e=Array.from(m),r=Hg,u()},h.clamp=function(m){return arguments.length?(s=m?!0:ir,u()):s!==ir},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,p){return n=m,i=p,u()}}function Wg(){return oh()(ir,ir)}function SH(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Wu(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function js(t){return t=Wu(Math.abs(t)),t?t[1]:NaN}function IH(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(r.substring(i-=o,i+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function PH(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var CH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function dl(t){if(!(e=CH.exec(t)))throw new Error("invalid format: "+t);var e;return new qg({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}dl.prototype=qg.prototype;function qg(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}qg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kH(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var JS;function NH(t,e){var r=Wu(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(JS=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Wu(t,Math.max(0,e+a-1))[0]}function ew(t,e){var r=Wu(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const tw={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:SH,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ew(t*100,e),r:ew,s:NH,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function rw(t){return t}var nw=Array.prototype.map,iw=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function jH(t){var e=t.grouping===void 0||t.thousands===void 0?rw:IH(nw.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?rw:PH(nw.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(h){h=dl(h);var m=h.fill,p=h.align,v=h.sign,b=h.symbol,g=h.zero,_=h.width,T=h.comma,E=h.precision,j=h.trim,R=h.type;R==="n"?(T=!0,R="g"):tw[R]||(E===void 0&&(E=12),j=!0,R="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var D=b==="$"?r:b==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",S=b==="$"?n:/[%p]/.test(R)?s:"",A=tw[R],P=/[defgprs%]/.test(R);E=E===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function O(N){var C=D,k=S,Q,oe,X;if(R==="c")k=A(N)+k,N="";else{N=+N;var ee=N<0||1/N<0;if(N=isNaN(N)?l:A(Math.abs(N),E),j&&(N=kH(N)),ee&&+N==0&&v!=="+"&&(ee=!1),C=(ee?v==="("?v:o:v==="-"||v==="("?"":v)+C,k=(R==="s"?iw[8+JS/3]:"")+k+(ee&&v==="("?")":""),P){for(Q=-1,oe=N.length;++Q<oe;)if(X=N.charCodeAt(Q),48>X||X>57){k=(X===46?i+N.slice(Q+1):N.slice(Q))+k,N=N.slice(0,Q);break}}}T&&!g&&(N=e(N,1/0));var he=C.length+N.length+k.length,ye=he<_?new Array(_-he+1).join(m):"";switch(T&&g&&(N=e(ye+N,ye.length?_-k.length:1/0),ye=""),p){case"<":N=C+N+k+ye;break;case"=":N=C+ye+N+k;break;case"^":N=ye.slice(0,he=ye.length>>1)+C+N+k+ye.slice(he);break;default:N=ye+C+N+k;break}return a(N)}return O.toString=function(){return h+""},O}function u(h,m){var p=c((h=dl(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(js(m)/3)))*3,b=Math.pow(10,-v),g=iw[8+v/3];return function(_){return p(b*_)+g}}return{format:c,formatPrefix:u}}var Dc,Kg,eI;OH({thousands:",",grouping:[3],currency:["$",""]});function OH(t){return Dc=jH(t),Kg=Dc.format,eI=Dc.formatPrefix,Dc}function RH(t){return Math.max(0,-js(Math.abs(t)))}function DH(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(js(e)/3)))*3-js(Math.abs(t)))}function MH(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,js(e)-js(t))+1}function tI(t,e,r,n){var i=jm(t,e,r),a;switch(n=dl(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=DH(i,s))&&(n.precision=a),eI(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=MH(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=RH(i))&&(n.precision=a-(n.type==="%")*2);break}}return Kg(n)}function qi(t){var e=t.domain;return t.ticks=function(r){var n=e();return km(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return tI(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],l,c,u=10;for(o<s&&(c=s,s=o,o=c,c=i,i=a,a=c);u-- >0;){if(c=Nm(s,o,r),c===l)return n[i]=s,n[a]=o,e(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return t},t}function rI(){var t=Wg();return t.copy=function(){return Rl(t,rI())},Hr.apply(t,arguments),qi(t)}function nI(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Hu),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return nI(t).unknown(e)},t=arguments.length?Array.from(t,Hu):[0,1],qi(r)}function iI(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function aw(t){return Math.log(t)}function sw(t){return Math.exp(t)}function LH(t){return-Math.log(-t)}function $H(t){return-Math.exp(-t)}function VH(t){return isFinite(t)?+("1e"+t):t<0?0:t}function zH(t){return t===10?VH:t===Math.E?Math.exp:e=>Math.pow(t,e)}function FH(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function ow(t){return(e,r)=>-t(-e,r)}function Gg(t){const e=t(aw,sw),r=e.domain;let n=10,i,a;function s(){return i=FH(n),a=zH(n),r()[0]<0?(i=ow(i),a=ow(a),t(LH,$H)):t(aw,sw),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const l=r();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let m=i(c),p=i(u),v,b;const g=o==null?10:+o;let _=[];if(!(n%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),c>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/a(-m):v*a(m),!(b<c)){if(b>u)break;_.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/a(-m):v*a(m),!(b<c)){if(b>u)break;_.push(b)}_.length*2<g&&(_=km(c,u,g))}else _=km(m,p,Math.min(p-m,g)).map(a);return h?_.reverse():_},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=dl(l)).precision==null&&(l.trim=!0),l=Kg(l)),o===1/0)return l;const c=Math.max(1,n*o/e.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=c?l(u):""}},e.nice=()=>r(iI(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function aI(){const t=Gg(oh()).domain([1,10]);return t.copy=()=>Rl(t,aI()).base(t.base()),Hr.apply(t,arguments),t}function lw(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function cw(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Yg(t){var e=1,r=t(lw(e),cw(e));return r.constant=function(n){return arguments.length?t(lw(e=+n),cw(e)):e},qi(r)}function sI(){var t=Yg(oh());return t.copy=function(){return Rl(t,sI()).constant(t.constant())},Hr.apply(t,arguments)}function uw(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function UH(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function BH(t){return t<0?-t*t:t*t}function Zg(t){var e=t(ir,ir),r=1;function n(){return r===1?t(ir,ir):r===.5?t(UH,BH):t(uw(r),uw(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},qi(e)}function Xg(){var t=Zg(oh());return t.copy=function(){return Rl(t,Xg()).exponent(t.exponent())},Hr.apply(t,arguments),t}function HH(){return Xg.apply(null,arguments).exponent(.5)}function dw(t){return Math.sign(t)*t*t}function WH(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function oI(){var t=Wg(),e=[0,1],r=!1,n;function i(a){var s=WH(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(dw(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Hu)).map(dw)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return oI(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hr.apply(i,arguments),qi(i)}function lI(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=Y8(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[jl(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(ki),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return lI().domain(t).range(e).unknown(n)},Hr.apply(a,arguments)}function cI(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(l){return l!=null&&l<=l?i[jl(n,l,0,r)]:a}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*e-(l-r)*t)/(r+1);return s}return s.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},s.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,o()):i.slice()},s.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,n[0]]:c>=r?[n[r-1],e]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return cI().domain([t,e]).range(i).unknown(a)},Hr.apply(qi(s),arguments)}function uI(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[jl(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return uI().domain(t).range(e).unknown(r)},Hr.apply(i,arguments)}const pf=new Date,gf=new Date;function St(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const l=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let c;do l.push(c=new Date(+a)),e(a,o),t(a);while(c<a&&a<s);return l},i.filter=a=>St(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(pf.setTime(+a),gf.setTime(+s),t(pf),t(gf),Math.floor(r(pf,gf))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const qu=St(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);qu.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?St(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):qu);qu.range;const zn=1e3,$r=zn*60,Fn=$r*60,ei=Fn*24,Qg=ei*7,hw=ei*30,yf=ei*365,pa=St(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*zn)},(t,e)=>(e-t)/zn,t=>t.getUTCSeconds());pa.range;const Jg=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getMinutes());Jg.range;const ey=St(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getUTCMinutes());ey.range;const ty=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn-t.getMinutes()*$r)},(t,e)=>{t.setTime(+t+e*Fn)},(t,e)=>(e-t)/Fn,t=>t.getHours());ty.range;const ry=St(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Fn)},(t,e)=>(e-t)/Fn,t=>t.getUTCHours());ry.range;const Dl=St(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$r)/ei,t=>t.getDate()-1);Dl.range;const lh=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>t.getUTCDate()-1);lh.range;const dI=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>Math.floor(t/ei));dI.range;function Ka(t){return St(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*$r)/Qg)}const ch=Ka(0),Ku=Ka(1),qH=Ka(2),KH=Ka(3),Os=Ka(4),GH=Ka(5),YH=Ka(6);ch.range;Ku.range;qH.range;KH.range;Os.range;GH.range;YH.range;function Ga(t){return St(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/Qg)}const uh=Ga(0),Gu=Ga(1),ZH=Ga(2),XH=Ga(3),Rs=Ga(4),QH=Ga(5),JH=Ga(6);uh.range;Gu.range;ZH.range;XH.range;Rs.range;QH.range;JH.range;const ny=St(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());ny.range;const iy=St(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());iy.range;const ti=St(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ti.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ti.range;const ri=St(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ri.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});ri.range;function hI(t,e,r,n,i,a){const s=[[pa,1,zn],[pa,5,5*zn],[pa,15,15*zn],[pa,30,30*zn],[a,1,$r],[a,5,5*$r],[a,15,15*$r],[a,30,30*$r],[i,1,Fn],[i,3,3*Fn],[i,6,6*Fn],[i,12,12*Fn],[n,1,ei],[n,2,2*ei],[r,1,Qg],[e,1,hw],[e,3,3*hw],[t,1,yf]];function o(c,u,h){const m=u<c;m&&([c,u]=[u,c]);const p=h&&typeof h.range=="function"?h:l(c,u,h),v=p?p.range(c,+u+1):[];return m?v.reverse():v}function l(c,u,h){const m=Math.abs(u-c)/h,p=Vg(([,,g])=>g).right(s,m);if(p===s.length)return t.every(jm(c/yf,u/yf,h));if(p===0)return qu.every(Math.max(jm(c,u,h),1));const[v,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return v.every(b)}return[o,l]}const[eW,tW]=hI(ri,iy,uh,dI,ry,ey),[rW,nW]=hI(ti,ny,ch,Dl,ty,Jg);function vf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function bf(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function wo(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function iW(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,c=_o(i),u=Eo(i),h=_o(a),m=Eo(a),p=_o(s),v=Eo(s),b=_o(o),g=Eo(o),_=_o(l),T=Eo(l),E={a:ee,A:he,b:ye,B:Ue,c:null,d:vw,e:vw,f:IW,g:LW,G:VW,H:TW,I:AW,j:SW,L:fI,m:PW,M:CW,p:se,q,Q:ww,s:_w,S:kW,u:NW,U:jW,V:OW,w:RW,W:DW,x:null,X:null,y:MW,Y:$W,Z:zW,"%":xw},j={a:J,A:rt,b:ze,B:Fe,c:null,d:bw,e:bw,f:HW,g:eq,G:rq,H:FW,I:UW,j:BW,L:pI,m:WW,M:qW,p:Pr,q:rn,Q:ww,s:_w,S:KW,u:GW,U:YW,V:ZW,w:XW,W:QW,x:null,X:null,y:JW,Y:tq,Z:nq,"%":xw},R={a:O,A:N,b:C,B:k,c:Q,d:gw,e:gw,f:xW,g:pw,G:mw,H:yw,I:yw,j:gW,L:bW,m:pW,M:yW,p:P,q:mW,Q:_W,s:EW,S:vW,u:cW,U:uW,V:dW,w:lW,W:hW,x:oe,X,y:pw,Y:mw,Z:fW,"%":wW};E.x=D(r,E),E.X=D(n,E),E.c=D(e,E),j.x=D(r,j),j.X=D(n,j),j.c=D(e,j);function D(G,de){return function(be){var B=[],dt=-1,Te=0,vt=G.length,bt,rr,Zi;for(be instanceof Date||(be=new Date(+be));++dt<vt;)G.charCodeAt(dt)===37&&(B.push(G.slice(Te,dt)),(rr=fw[bt=G.charAt(++dt)])!=null?bt=G.charAt(++dt):rr=bt==="e"?" ":"0",(Zi=de[bt])&&(bt=Zi(be,rr)),B.push(bt),Te=dt+1);return B.push(G.slice(Te,dt)),B.join("")}}function S(G,de){return function(be){var B=wo(1900,void 0,1),dt=A(B,G,be+="",0),Te,vt;if(dt!=be.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Te=bf(wo(B.y,0,1)),vt=Te.getUTCDay(),Te=vt>4||vt===0?Gu.ceil(Te):Gu(Te),Te=lh.offset(Te,(B.V-1)*7),B.y=Te.getUTCFullYear(),B.m=Te.getUTCMonth(),B.d=Te.getUTCDate()+(B.w+6)%7):(Te=vf(wo(B.y,0,1)),vt=Te.getDay(),Te=vt>4||vt===0?Ku.ceil(Te):Ku(Te),Te=Dl.offset(Te,(B.V-1)*7),B.y=Te.getFullYear(),B.m=Te.getMonth(),B.d=Te.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),vt="Z"in B?bf(wo(B.y,0,1)).getUTCDay():vf(wo(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(vt+5)%7:B.w+B.U*7-(vt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,bf(B)):vf(B)}}function A(G,de,be,B){for(var dt=0,Te=de.length,vt=be.length,bt,rr;dt<Te;){if(B>=vt)return-1;if(bt=de.charCodeAt(dt++),bt===37){if(bt=de.charAt(dt++),rr=R[bt in fw?de.charAt(dt++):bt],!rr||(B=rr(G,be,B))<0)return-1}else if(bt!=be.charCodeAt(B++))return-1}return B}function P(G,de,be){var B=c.exec(de.slice(be));return B?(G.p=u.get(B[0].toLowerCase()),be+B[0].length):-1}function O(G,de,be){var B=p.exec(de.slice(be));return B?(G.w=v.get(B[0].toLowerCase()),be+B[0].length):-1}function N(G,de,be){var B=h.exec(de.slice(be));return B?(G.w=m.get(B[0].toLowerCase()),be+B[0].length):-1}function C(G,de,be){var B=_.exec(de.slice(be));return B?(G.m=T.get(B[0].toLowerCase()),be+B[0].length):-1}function k(G,de,be){var B=b.exec(de.slice(be));return B?(G.m=g.get(B[0].toLowerCase()),be+B[0].length):-1}function Q(G,de,be){return A(G,e,de,be)}function oe(G,de,be){return A(G,r,de,be)}function X(G,de,be){return A(G,n,de,be)}function ee(G){return s[G.getDay()]}function he(G){return a[G.getDay()]}function ye(G){return l[G.getMonth()]}function Ue(G){return o[G.getMonth()]}function se(G){return i[+(G.getHours()>=12)]}function q(G){return 1+~~(G.getMonth()/3)}function J(G){return s[G.getUTCDay()]}function rt(G){return a[G.getUTCDay()]}function ze(G){return l[G.getUTCMonth()]}function Fe(G){return o[G.getUTCMonth()]}function Pr(G){return i[+(G.getUTCHours()>=12)]}function rn(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var de=D(G+="",E);return de.toString=function(){return G},de},parse:function(G){var de=S(G+="",!1);return de.toString=function(){return G},de},utcFormat:function(G){var de=D(G+="",j);return de.toString=function(){return G},de},utcParse:function(G){var de=S(G+="",!0);return de.toString=function(){return G},de}}}var fw={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,aW=/^%/,sW=/[\\^$*+?|[\]().{}]/g;function Pe(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function oW(t){return t.replace(sW,"\\$&")}function _o(t){return new RegExp("^(?:"+t.map(oW).join("|")+")","i")}function Eo(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function lW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function cW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function uW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function dW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function hW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function mw(t,e,r){var n=kt.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function pw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function fW(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function mW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function pW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function gw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function gW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function yw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function yW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function vW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function bW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function xW(t,e,r){var n=kt.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function wW(t,e,r){var n=aW.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function _W(t,e,r){var n=kt.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function EW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function vw(t,e){return Pe(t.getDate(),e,2)}function TW(t,e){return Pe(t.getHours(),e,2)}function AW(t,e){return Pe(t.getHours()%12||12,e,2)}function SW(t,e){return Pe(1+Dl.count(ti(t),t),e,3)}function fI(t,e){return Pe(t.getMilliseconds(),e,3)}function IW(t,e){return fI(t,e)+"000"}function PW(t,e){return Pe(t.getMonth()+1,e,2)}function CW(t,e){return Pe(t.getMinutes(),e,2)}function kW(t,e){return Pe(t.getSeconds(),e,2)}function NW(t){var e=t.getDay();return e===0?7:e}function jW(t,e){return Pe(ch.count(ti(t)-1,t),e,2)}function mI(t){var e=t.getDay();return e>=4||e===0?Os(t):Os.ceil(t)}function OW(t,e){return t=mI(t),Pe(Os.count(ti(t),t)+(ti(t).getDay()===4),e,2)}function RW(t){return t.getDay()}function DW(t,e){return Pe(Ku.count(ti(t)-1,t),e,2)}function MW(t,e){return Pe(t.getFullYear()%100,e,2)}function LW(t,e){return t=mI(t),Pe(t.getFullYear()%100,e,2)}function $W(t,e){return Pe(t.getFullYear()%1e4,e,4)}function VW(t,e){var r=t.getDay();return t=r>=4||r===0?Os(t):Os.ceil(t),Pe(t.getFullYear()%1e4,e,4)}function zW(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Pe(e/60|0,"0",2)+Pe(e%60,"0",2)}function bw(t,e){return Pe(t.getUTCDate(),e,2)}function FW(t,e){return Pe(t.getUTCHours(),e,2)}function UW(t,e){return Pe(t.getUTCHours()%12||12,e,2)}function BW(t,e){return Pe(1+lh.count(ri(t),t),e,3)}function pI(t,e){return Pe(t.getUTCMilliseconds(),e,3)}function HW(t,e){return pI(t,e)+"000"}function WW(t,e){return Pe(t.getUTCMonth()+1,e,2)}function qW(t,e){return Pe(t.getUTCMinutes(),e,2)}function KW(t,e){return Pe(t.getUTCSeconds(),e,2)}function GW(t){var e=t.getUTCDay();return e===0?7:e}function YW(t,e){return Pe(uh.count(ri(t)-1,t),e,2)}function gI(t){var e=t.getUTCDay();return e>=4||e===0?Rs(t):Rs.ceil(t)}function ZW(t,e){return t=gI(t),Pe(Rs.count(ri(t),t)+(ri(t).getUTCDay()===4),e,2)}function XW(t){return t.getUTCDay()}function QW(t,e){return Pe(Gu.count(ri(t)-1,t),e,2)}function JW(t,e){return Pe(t.getUTCFullYear()%100,e,2)}function eq(t,e){return t=gI(t),Pe(t.getUTCFullYear()%100,e,2)}function tq(t,e){return Pe(t.getUTCFullYear()%1e4,e,4)}function rq(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Rs(t):Rs.ceil(t),Pe(t.getUTCFullYear()%1e4,e,4)}function nq(){return"+0000"}function xw(){return"%"}function ww(t){return+t}function _w(t){return Math.floor(+t/1e3)}var as,yI,vI;iq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iq(t){return as=iW(t),yI=as.format,as.parse,vI=as.utcFormat,as.utcParse,as}function aq(t){return new Date(t)}function sq(t){return t instanceof Date?+t:+new Date(+t)}function ay(t,e,r,n,i,a,s,o,l,c){var u=Wg(),h=u.invert,m=u.domain,p=c(".%L"),v=c(":%S"),b=c("%I:%M"),g=c("%I %p"),_=c("%a %d"),T=c("%b %d"),E=c("%B"),j=c("%Y");function R(D){return(l(D)<D?p:o(D)<D?v:s(D)<D?b:a(D)<D?g:n(D)<D?i(D)<D?_:T:r(D)<D?E:j)(D)}return u.invert=function(D){return new Date(h(D))},u.domain=function(D){return arguments.length?m(Array.from(D,sq)):m().map(aq)},u.ticks=function(D){var S=m();return t(S[0],S[S.length-1],D??10)},u.tickFormat=function(D,S){return S==null?R:c(S)},u.nice=function(D){var S=m();return(!D||typeof D.range!="function")&&(D=e(S[0],S[S.length-1],D??10)),D?m(iI(S,D)):u},u.copy=function(){return Rl(u,ay(t,e,r,n,i,a,s,o,l,c))},u}function oq(){return Hr.apply(ay(rW,nW,ti,ny,ch,Dl,ty,Jg,pa,yI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function lq(){return Hr.apply(ay(eW,tW,ri,iy,uh,lh,ry,ey,pa,vI).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dh(){var t=0,e=1,r,n,i,a,s=ir,o=!1,l;function c(h){return h==null||isNaN(h=+h)?l:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),c):[t,e]},c.clamp=function(h){return arguments.length?(o=!!h,c):o},c.interpolator=function(h){return arguments.length?(s=h,c):s};function u(h){return function(m){var p,v;return arguments.length?([p,v]=m,s=h(p,v),c):[s(0),s(1)]}}return c.range=u(Hs),c.rangeRound=u(Hg),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),c}}function Ki(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function bI(){var t=qi(dh()(ir));return t.copy=function(){return Ki(t,bI())},ai.apply(t,arguments)}function xI(){var t=Gg(dh()).domain([1,10]);return t.copy=function(){return Ki(t,xI()).base(t.base())},ai.apply(t,arguments)}function wI(){var t=Yg(dh());return t.copy=function(){return Ki(t,wI()).constant(t.constant())},ai.apply(t,arguments)}function sy(){var t=Zg(dh());return t.copy=function(){return Ki(t,sy()).exponent(t.exponent())},ai.apply(t,arguments)}function cq(){return sy.apply(null,arguments).exponent(.5)}function _I(){var t=[],e=ir;function r(n){if(n!=null&&!isNaN(n=+n))return e((jl(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(ki),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>G8(t,a/n))},r.copy=function(){return _I(e).domain(t)},ai.apply(r,arguments)}function hh(){var t=0,e=.5,r=1,n=1,i,a,s,o,l,c=ir,u,h=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+u(b))-a)*(n*b<n*a?o:l),c(h?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([t,e,r]=b,i=u(t=+t),a=u(e=+e),s=u(r=+r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,p):[t,e,r]},p.clamp=function(b){return arguments.length?(h=!!b,p):h},p.interpolator=function(b){return arguments.length?(c=b,p):c};function v(b){return function(g){var _,T,E;return arguments.length?([_,T,E]=g,c=wH(b,[_,T,E]),p):[c(0),c(.5),c(1)]}}return p.range=v(Hs),p.rangeRound=v(Hg),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return u=b,i=b(t),a=b(e),s=b(r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,p}}function EI(){var t=qi(hh()(ir));return t.copy=function(){return Ki(t,EI())},ai.apply(t,arguments)}function TI(){var t=Gg(hh()).domain([.1,1,10]);return t.copy=function(){return Ki(t,TI()).base(t.base())},ai.apply(t,arguments)}function AI(){var t=Yg(hh());return t.copy=function(){return Ki(t,AI()).constant(t.constant())},ai.apply(t,arguments)}function oy(){var t=Zg(hh());return t.copy=function(){return Ki(t,oy()).exponent(t.exponent())},ai.apply(t,arguments)}function uq(){return oy.apply(null,arguments).exponent(.5)}const jo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Fg,scaleDiverging:EI,scaleDivergingLog:TI,scaleDivergingPow:oy,scaleDivergingSqrt:uq,scaleDivergingSymlog:AI,scaleIdentity:nI,scaleImplicit:Om,scaleLinear:rI,scaleLog:aI,scaleOrdinal:zg,scalePoint:X8,scalePow:Xg,scaleQuantile:lI,scaleQuantize:cI,scaleRadial:oI,scaleSequential:bI,scaleSequentialLog:xI,scaleSequentialPow:sy,scaleSequentialQuantile:_I,scaleSequentialSqrt:cq,scaleSequentialSymlog:wI,scaleSqrt:HH,scaleSymlog:sI,scaleThreshold:uI,scaleTime:oq,scaleUtc:lq,tickFormat:tI},Symbol.toStringTag,{value:"Module"}));var Ya=t=>t.chartData,dq=V([Ya],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),SI=(t,e,r,n)=>n?dq(t):Ya(t);function Ds(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(tn(e)&&tn(r))return!0}return!1}function Ew(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function hq(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(tn(r))i=r;else if(typeof r=="function")return;if(tn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Ds(s))return s}}function fq(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Ds(n))return Ew(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,s,o;if(i==="auto")e!=null&&(s=Math.min(...e));else if(te(i))s=i;else if(typeof i=="function")try{e!=null&&(s=i(e?.[0]))}catch{}else if(typeof i=="string"&&wx.test(i)){var l=wx.exec(i);if(l==null||e==null)s=void 0;else{var c=+l[1];s=e[0]-c}}else s=e?.[0];if(a==="auto")e!=null&&(o=Math.max(...e));else if(te(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e?.[1]))}catch{}else if(typeof a=="string"&&_x.test(a)){var u=_x.exec(a);if(u==null||e==null)o=void 0;else{var h=+u[1];o=e[1]+h}}else o=e?.[1];var m=[s,o];if(Ds(m))return e==null?m:Ew(m,e,r)}}}var Ws=1e9,mq={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cy,Ye=!0,Fr="[DecimalError] ",Ea=Fr+"Invalid argument: ",ly=Fr+"Exponent out of range: ",qs=Math.floor,la=Math.pow,pq=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_r,Pt=1e7,We=7,II=9007199254740991,Yu=qs(II/We),Z={};Z.absoluteValue=Z.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Z.comparedTo=Z.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Z.decimalPlaces=Z.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*We;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Z.dividedBy=Z.div=function(t){return qn(this,new this.constructor(t))};Z.dividedToIntegerBy=Z.idiv=function(t){var e=this,r=e.constructor;return $e(qn(e,new r(t),0,1),r.precision)};Z.equals=Z.eq=function(t){return!this.cmp(t)};Z.exponent=function(){return yt(this)};Z.greaterThan=Z.gt=function(t){return this.cmp(t)>0};Z.greaterThanOrEqualTo=Z.gte=function(t){return this.cmp(t)>=0};Z.isInteger=Z.isint=function(){return this.e>this.d.length-2};Z.isNegative=Z.isneg=function(){return this.s<0};Z.isPositive=Z.ispos=function(){return this.s>0};Z.isZero=function(){return this.s===0};Z.lessThan=Z.lt=function(t){return this.cmp(t)<0};Z.lessThanOrEqualTo=Z.lte=function(t){return this.cmp(t)<1};Z.logarithm=Z.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(_r))throw Error(Fr+"NaN");if(r.s<1)throw Error(Fr+(r.s?"NaN":"-Infinity"));return r.eq(_r)?new n(0):(Ye=!1,e=qn(hl(r,a),hl(t,a),a),Ye=!0,$e(e,i))};Z.minus=Z.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?kI(e,t):PI(e,(t.s=-t.s,t))};Z.modulo=Z.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(Fr+"NaN");return r.s?(Ye=!1,e=qn(r,t,0,1).times(t),Ye=!0,r.minus(e)):$e(new n(r),i)};Z.naturalExponential=Z.exp=function(){return CI(this)};Z.naturalLogarithm=Z.ln=function(){return hl(this)};Z.negated=Z.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Z.plus=Z.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?PI(e,t):kI(e,(t.s=-t.s,t))};Z.precision=Z.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Ea+t);if(e=yt(i)+1,n=i.d.length-1,r=n*We+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Z.squareRoot=Z.sqrt=function(){var t,e,r,n,i,a,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Fr+"NaN")}for(t=yt(o),Ye=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=hn(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=qs((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new l(e)):n=new l(i.toString()),r=l.precision,i=s=r+3;;)if(a=n,n=a.plus(qn(o,a,s+2)).times(.5),hn(a.d).slice(0,s)===(e=hn(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if($e(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Ye=!0,$e(n,r)};Z.times=Z.mul=function(t){var e,r,n,i,a,s,o,l,c,u=this,h=u.constructor,m=u.d,p=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,l=m.length,c=p.length,l<c&&(a=m,m=p,p=a,s=l,l=c,c=s),a=[],s=l+c,n=s;n--;)a.push(0);for(n=c;--n>=0;){for(e=0,i=l+n;i>n;)o=a[i]+p[n]*m[i-n-1]+e,a[i--]=o%Pt|0,e=o/Pt|0;a[i]=(a[i]+e)%Pt|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ye?$e(t,h.precision):t};Z.toDecimalPlaces=Z.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(In(t,0,Ws),e===void 0?e=n.rounding:In(e,0,8),$e(r,t+yt(r)+1,e))};Z.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=La(n,!0):(In(t,0,Ws),e===void 0?e=i.rounding:In(e,0,8),n=$e(new i(n),t+1,e),r=La(n,!0,t+1)),r};Z.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?La(i):(In(t,0,Ws),e===void 0?e=a.rounding:In(e,0,8),n=$e(new a(i),t+yt(i)+1,e),r=La(n.abs(),!1,t+yt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Z.toInteger=Z.toint=function(){var t=this,e=t.constructor;return $e(new e(t),yt(t)+1,e.rounding)};Z.toNumber=function(){return+this};Z.toPower=Z.pow=function(t){var e,r,n,i,a,s,o=this,l=o.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(_r);if(o=new l(o),!o.s){if(t.s<1)throw Error(Fr+"Infinity");return o}if(o.eq(_r))return o;if(n=l.precision,t.eq(_r))return $e(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=u<0?-u:u)<=II){for(i=new l(_r),e=Math.ceil(n/We+4),Ye=!1;r%2&&(i=i.times(o),Aw(i.d,e)),r=qs(r/2),r!==0;)o=o.times(o),Aw(o.d,e);return Ye=!0,t.s<0?new l(_r).div(i):$e(i,n)}}else if(a<0)throw Error(Fr+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Ye=!1,i=t.times(hl(o,n+c)),Ye=!0,i=CI(i),i.s=a,i};Z.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=yt(i),n=La(i,r<=a.toExpNeg||r>=a.toExpPos)):(In(t,1,Ws),e===void 0?e=a.rounding:In(e,0,8),i=$e(new a(i),t,e),r=yt(i),n=La(i,t<=r||r<=a.toExpNeg,t)),n};Z.toSignificantDigits=Z.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(In(t,1,Ws),e===void 0?e=n.rounding:In(e,0,8)),$e(new n(r),t,e)};Z.toString=Z.valueOf=Z.val=Z.toJSON=Z[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=yt(t),r=t.constructor;return La(t,e<=r.toExpNeg||e>=r.toExpPos)};function PI(t,e){var r,n,i,a,s,o,l,c,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Ye?$e(e,h):e;if(l=t.d,c=e.d,s=t.e,i=e.e,l=l.slice(),a=s-i,a){for(a<0?(n=l,a=-a,o=c.length):(n=c,i=s,o=l.length),s=Math.ceil(h/We),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=l.length,a=c.length,o-a<0&&(a=o,n=c,c=l,l=n),r=0;a;)r=(l[--a]=l[a]+c[a]+r)/Pt|0,l[a]%=Pt;for(r&&(l.unshift(r),++i),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=i,Ye?$e(e,h):e}function In(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Ea+t)}function hn(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=We-n.length,r&&(a+=yi(r)),a+=n;s=t[e],n=s+"",r=We-n.length,r&&(a+=yi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var qn=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Pt|0,s=a/Pt|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=i[o]){l=n[o]>i[o]?1:-1;break}return l}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Pt+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,l,c,u,h,m,p,v,b,g,_,T,E,j,R,D,S,A,P=n.constructor,O=n.s==i.s?1:-1,N=n.d,C=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(Fr+"Division by zero");for(l=n.e-i.e,S=C.length,R=N.length,p=new P(O),v=p.d=[],c=0;C[c]==(N[c]||0);)++c;if(C[c]>(N[c]||0)&&--l,a==null?T=a=P.precision:s?T=a+(yt(n)-yt(i))+1:T=a,T<0)return new P(0);if(T=T/We+2|0,c=0,S==1)for(u=0,C=C[0],T++;(c<R||u)&&T--;c++)E=u*Pt+(N[c]||0),v[c]=E/C|0,u=E%C|0;else{for(u=Pt/(C[0]+1)|0,u>1&&(C=t(C,u),N=t(N,u),S=C.length,R=N.length),j=S,b=N.slice(0,S),g=b.length;g<S;)b[g++]=0;A=C.slice(),A.unshift(0),D=C[0],C[1]>=Pt/2&&++D;do u=0,o=e(C,b,S,g),o<0?(_=b[0],S!=g&&(_=_*Pt+(b[1]||0)),u=_/D|0,u>1?(u>=Pt&&(u=Pt-1),h=t(C,u),m=h.length,g=b.length,o=e(h,b,m,g),o==1&&(u--,r(h,S<m?A:C,m))):(u==0&&(o=u=1),h=C.slice()),m=h.length,m<g&&h.unshift(0),r(b,h,g),o==-1&&(g=b.length,o=e(C,b,S,g),o<1&&(u++,r(b,S<g?A:C,g))),g=b.length):o===0&&(u++,b=[0]),v[c++]=u,o&&b[0]?b[g++]=N[j]||0:(b=[N[j]],g=1);while((j++<R||b[0]!==void 0)&&T--)}return v[0]||v.shift(),p.e=l,$e(p,s?a+yt(p)+1:a)}}();function CI(t,e){var r,n,i,a,s,o,l=0,c=0,u=t.constructor,h=u.precision;if(yt(t)>16)throw Error(ly+yt(t));if(!t.s)return new u(_r);for(Ye=!1,o=h,s=new u(.03125);t.abs().gte(.1);)t=t.times(s),c+=5;for(n=Math.log(la(2,c))/Math.LN10*2+5|0,o+=n,r=i=a=new u(_r),u.precision=o;;){if(i=$e(i.times(t),o),r=r.times(++l),s=a.plus(qn(i,r,o)),hn(s.d).slice(0,o)===hn(a.d).slice(0,o)){for(;c--;)a=$e(a.times(a),o);return u.precision=h,e==null?(Ye=!0,$e(a,h)):a}a=s}}function yt(t){for(var e=t.e*We,r=t.d[0];r>=10;r/=10)e++;return e}function xf(t,e,r){if(e>t.LN10.sd())throw Ye=!0,r&&(t.precision=r),Error(Fr+"LN10 precision limit exceeded");return $e(new t(t.LN10),e)}function yi(t){for(var e="";t--;)e+="0";return e}function hl(t,e){var r,n,i,a,s,o,l,c,u,h=1,m=10,p=t,v=p.d,b=p.constructor,g=b.precision;if(p.s<1)throw Error(Fr+(p.s?"NaN":"-Infinity"));if(p.eq(_r))return new b(0);if(e==null?(Ye=!1,c=g):c=e,p.eq(10))return e==null&&(Ye=!0),xf(b,c);if(c+=m,b.precision=c,r=hn(v),n=r.charAt(0),a=yt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(t),r=hn(p.d),n=r.charAt(0),h++;a=yt(p),n>1?(p=new b("0."+r),a++):p=new b(n+"."+r.slice(1))}else return l=xf(b,c+2,g).times(a+""),p=hl(new b(n+"."+r.slice(1)),c-m).plus(l),b.precision=g,e==null?(Ye=!0,$e(p,g)):p;for(o=s=p=qn(p.minus(_r),p.plus(_r),c),u=$e(p.times(p),c),i=3;;){if(s=$e(s.times(u),c),l=o.plus(qn(s,new b(i),c)),hn(l.d).slice(0,c)===hn(o.d).slice(0,c))return o=o.times(2),a!==0&&(o=o.plus(xf(b,c+2,g).times(a+""))),o=qn(o,new b(h),c),b.precision=g,e==null?(Ye=!0,$e(o,g)):o;o=l,i+=2}}function Tw(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=qs(r/We),t.d=[],n=(r+1)%We,r<0&&(n+=We),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=We;n<i;)t.d.push(+e.slice(n,n+=We));e=e.slice(n),n=We-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ye&&(t.e>Yu||t.e<-Yu))throw Error(ly+r)}else t.s=0,t.e=0,t.d=[0];return t}function $e(t,e,r){var n,i,a,s,o,l,c,u,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=We,i=e,c=h[u=0];else{if(u=Math.ceil((n+1)/We),a=h.length,u>=a)return t;for(c=a=h[u],s=1;a>=10;a/=10)s++;n%=We,i=n-We+s}if(r!==void 0&&(a=la(10,s-i-1),o=c/a%10|0,l=e<0||h[u+1]!==void 0||c%a,l=r<4?(o||l)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?i>0?c/la(10,s-i):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return l?(a=yt(t),h.length=1,e=e-a-1,h[0]=la(10,(We-e%We)%We),t.e=qs(-e/We)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=la(10,We-n),h[u]=i>0?(c/la(10,s-i)%la(10,i)|0)*a:0),l)for(;;)if(u==0){(h[0]+=a)==Pt&&(h[0]=1,++t.e);break}else{if(h[u]+=a,h[u]!=Pt)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Ye&&(t.e>Yu||t.e<-Yu))throw Error(ly+yt(t));return t}function kI(t,e){var r,n,i,a,s,o,l,c,u,h,m=t.constructor,p=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Ye?$e(e,p):e;if(l=t.d,h=e.d,n=e.e,c=t.e,l=l.slice(),s=c-n,s){for(u=s<0,u?(r=l,s=-s,o=h.length):(r=h,n=c,o=l.length),i=Math.max(Math.ceil(p/We),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=l.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=h[i]){u=l[i]<h[i];break}s=0}for(u&&(r=l,l=h,h=r,e.s=-e.s),o=l.length,i=h.length-o;i>0;--i)l[o++]=0;for(i=h.length;i>s;){if(l[--i]<h[i]){for(a=i;a&&l[--a]===0;)l[a]=Pt-1;--l[a],l[i]+=Pt}l[i]-=h[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=n,Ye?$e(e,p):e):new m(0)}function La(t,e,r){var n,i=yt(t),a=hn(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+yi(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+yi(-i-1)+a,r&&(n=r-s)>0&&(a+=yi(n))):i>=s?(a+=yi(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+yi(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=yi(n))),t.s<0?"-"+a:a}function Aw(t,e){if(t.length>e)return t.length=e,!0}function NI(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Ea+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return Tw(s,a.toString())}else if(typeof a!="string")throw Error(Ea+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,pq.test(a))Tw(s,a);else throw Error(Ea+a)}if(i.prototype=Z,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=NI,i.config=i.set=gq,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function gq(t){if(!t||typeof t!="object")throw Error(Fr+"Object expected");var e,r,n,i=["precision",1,Ws,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(qs(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(Ea+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ea+r+": "+n);return this}var cy=NI(mq);_r=new cy(1);const je=cy;var yq=t=>t,jI={},OI=t=>t===jI,Sw=t=>function e(){return arguments.length===0||arguments.length===1&&OI(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},RI=(t,e)=>t===1?e:Sw(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==jI).length;return a>=t?e(...n):RI(t-a,Sw(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var c=n.map(u=>OI(u)?o.shift():u);return e(...c,...o)}))}),fh=t=>RI(t.length,t),Lm=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},vq=fh((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),bq=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return yq;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,l)=>l(o),a(...arguments))}},$m=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),DI=t=>{var e=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e&&i.every((s,o)=>{var l;return s===((l=e)===null||l===void 0?void 0:l[o])})||(e=i,r=t(...i)),r}};function MI(t){var e;return t===0?e=1:e=Math.floor(new je(t).abs().log(10).toNumber())+1,e}function LI(t,e,r){for(var n=new je(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}fh((t,e,r)=>{var n=+t,i=+e;return n+r*(i-n)});fh((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});fh((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var $I=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},VI=(t,e,r)=>{if(t.lte(0))return new je(0);var n=MI(t.toNumber()),i=new je(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new je(Math.ceil(a.div(s).toNumber())).add(r).mul(s),l=o.mul(i);return e?new je(l.toNumber()):new je(Math.ceil(l.toNumber()))},xq=(t,e,r)=>{var n=new je(1),i=new je(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new je(10).pow(MI(t)-1),i=new je(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new je(Math.floor(t)))}else t===0?i=new je(Math.floor((e-1)/2)):r||(i=new je(Math.floor(t)));var s=Math.floor((e-1)/2),o=bq(vq(l=>i.add(new je(l-s).mul(n)).toNumber()),Lm);return o(0,e)},zI=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new je(0),tickMin:new je(0),tickMax:new je(0)};var s=VI(new je(r).sub(e).div(n-1),i,a),o;e<=0&&r>=0?o=new je(0):(o=new je(e).add(r).div(2),o=o.sub(new je(o).mod(s)));var l=Math.ceil(o.sub(e).div(s).toNumber()),c=Math.ceil(new je(r).sub(o).div(s).toNumber()),u=l+c+1;return u>n?zI(e,r,n,i,a+1):(u<n&&(c=r>0?c+(n-u):c,l=r>0?l:l+(n-u)),{step:s,tickMin:o.sub(new je(l).mul(s)),tickMax:o.add(new je(c).mul(s))})};function wq(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=$I([e,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...Lm(0,n-1).map(()=>1/0)]:[...Lm(0,n-1).map(()=>-1/0),o];return e>r?$m(l):l}if(s===o)return xq(s,n,i);var{step:c,tickMin:u,tickMax:h}=zI(s,o,a,i,0),m=LI(u,h.add(new je(.1).mul(c)),c);return e>r?$m(m):m}function _q(t,e){var[r,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=$I([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(e,2),l=VI(new je(s).sub(a).div(o-1),i,0),c=[...LI(new je(a),new je(s),l),s];return i===!1&&(c=c.map(u=>Math.round(u))),r>n?$m(c):c}var Eq=DI(wq),Tq=DI(_q),Aq=t=>t.rootProps.barCategoryGap,mh=t=>t.rootProps.stackOffset,uy=t=>t.options.chartName,dy=t=>t.rootProps.syncId,FI=t=>t.rootProps.syncMethod,hy=t=>t.options.eventEmitter,Mn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},br={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},ph=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},Sq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Mn.angleAxisId,includeHidden:!1,name:void 0,reversed:Mn.reversed,scale:Mn.scale,tick:Mn.tick,tickCount:void 0,ticks:void 0,type:Mn.type,unit:void 0},Iq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:br.type,unit:void 0},Pq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Mn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mn.scale,tick:Mn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Cq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:"category",unit:void 0},fy=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?Pq:Sq,my=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?Cq:Iq,gh=t=>t.polarOptions,py=V([ni,ii,Ht],U9),UI=V([gh,py],(t,e)=>{if(t!=null)return Vi(t.innerRadius,e,0)}),BI=V([gh,py],(t,e)=>{if(t!=null)return Vi(t.outerRadius,e,e*.8)}),kq=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},HI=V([gh],kq);V([fy,HI],ph);var WI=V([py,UI,BI],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});V([my,WI],ph);var Nq=V([tt,gh,UI,BI,ni,ii],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:c}=e;return{cx:Vi(s,i,i/2),cy:Vi(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}}),Nt=(t,e)=>e,yh=(t,e,r)=>r;function Iw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Iw(Object(r),!0).forEach(function(n){jq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Iw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jq(t,e,r){return(e=Oq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oq(t){var e=Rq(t,"string");return typeof e=="symbol"?e:e+""}function Rq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vm=[0,"auto"],yr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},si=(t,e)=>{var r=t.cartesianAxis.xAxis[e];return r??yr},vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Vm,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:ih},Gi=(t,e)=>{var r=t.cartesianAxis.yAxis[e];return r??vr},Dq={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},gy=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??Dq},pr=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Gi(t,r);case"zAxis":return gy(t,r);case"angleAxis":return fy(t,r);case"radiusAxis":return my(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Mq=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Gi(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Ml=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Gi(t,r);case"angleAxis":return fy(t,r);case"radiusAxis":return my(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},qI=t=>t.graphicalItems.countOfBars>0;function KI(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var GI=t=>t.graphicalItems.cartesianItems,Lq=V([Nt,yh],KI),YI=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),Ll=V([GI,pr,Lq],YI),ZI=t=>t.filter(e=>e.stackId===void 0),$q=V([Ll],ZI),XI=t=>t.map(e=>e.data).filter(Boolean).flat(1),Vq=V([Ll],XI),QI=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},vh=V([Vq,SI],QI),JI=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Tr(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Tr(i,n)}))):t.map(n=>({value:n})),bh=V([vh,pr,Ll],JI);function eP(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Za(t){return t.filter(e=>Sn(e)||e instanceof Date).map(Number).filter(e=>Vr(e)===!1)}function zq(t,e,r){return!r||typeof e!="number"||Vr(e)?[]:r.length?Za(r.flatMap(n=>{var i=Tr(t,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!tn(a)||!tn(s)))return[e-a,e+s]})):[]}var tP=(t,e,r)=>{var n={},i=e.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,l=o.map(c=>c.dataKey);return[s,{stackedData:nB(t,l,r),graphicalItems:o}]}))},Fq=V([vh,Ll,mh],tP),rP=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:i}=e;if(r!=="zAxis"){var a=oB(t,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},Uq=V([Fq,Ya,Nt],rP),nP=(t,e,r,n)=>r.length>0?t.flatMap(i=>r.flatMap(a=>{var s,o,l=(s=a.errorBars)===null||s===void 0?void 0:s.filter(u=>eP(n,u)),c=Tr(i,(o=e.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:c,errorDomain:zq(i,c,l)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:Tr(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),Bq=V(vh,pr,$q,Nt,nP);function Hq(t){var{value:e}=t;if(Sn(e)||e instanceof Date)return e}var Wq=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Za(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},qq=(t,e,r)=>{var n=t.map(Hq).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&fA(n))?WS(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},yy=t=>{var e;if(t==null||!("domain"in t))return Vm;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=Za(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:Vm},vy=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},iP=t=>t.referenceElements.dots,Ks=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),Kq=V([iP,Nt,yh],Ks),aP=t=>t.referenceElements.areas,Gq=V([aP,Nt,yh],Ks),sP=t=>t.referenceElements.lines,Yq=V([sP,Nt,yh],Ks),oP=(t,e)=>{var r=Za(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Zq=V(Kq,Nt,oP),lP=(t,e)=>{var r=Za(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Xq=V([Gq,Nt],lP),cP=(t,e)=>{var r=Za(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Qq=V(Yq,Nt,cP),Jq=V(Zq,Qq,Xq,(t,e,r)=>vy(t,r,e)),e7=V([pr],yy),uP=(t,e,r,n,i)=>{var a=hq(e,t.allowDataOverflow);return a??fq(e,vy(r,i,Wq(n)),t.allowDataOverflow)},t7=V([pr,e7,Uq,Bq,Jq],uP),r7=[0,1],dP=(t,e,r,n,i,a,s)=>{if(!(t==null||r==null||r.length===0)){var{dataKey:o,type:l}=t,c=Wi(e,a);return c&&o==null?WS(0,r.length):l==="category"?qq(n,t,c):i==="expand"?r7:s}},by=V([pr,tt,vh,bh,mh,Nt,t7],dP),hP=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:s}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(yg(a));return o in jo?o:"point"}}},$l=V([pr,tt,qI,uy,Nt],hP);function n7(t){if(t!=null){if(t in jo)return jo[t]();var e="scale".concat(yg(t));if(e in jo)return jo[e]()}}function xy(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=n7(e);if(i!=null){var a=i.domain(r).range(n);return J9(a),a}}}var fP=(t,e,r)=>{var n=yy(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Ds(t))return Eq(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Ds(t))return Tq(t,e.tickCount,e.allowDecimals)}},wy=V([by,Ml,$l],fP),mP=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Ds(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],s=e[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return e},i7=V([pr,by,wy,Nt],mP),a7=V(bh,pr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Za(t.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),pP=V(a7,tt,Aq,Ht,(t,e,r,n)=>n,(t,e,r,n,i)=>{if(!tn(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var s=Vi(r,t*a),o=t*a/2;return o-s-(o-s)/a*s}return 0}),s7=(t,e)=>{var r=si(t,e);return r==null||typeof r.padding!="string"?0:pP(t,"xAxis",e,r.padding)},o7=(t,e)=>{var r=Gi(t,e);return r==null||typeof r.padding!="string"?0:pP(t,"yAxis",e,r.padding)},l7=V(si,s7,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),c7=V(Gi,o7,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),u7=V([Ht,l7,sh,ah,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),d7=V([Ht,tt,c7,sh,ah,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Vl=(t,e,r,n)=>{var i;switch(e){case"xAxis":return u7(t,r,n);case"yAxis":return d7(t,r,n);case"zAxis":return(i=gy(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return HI(t);case"radiusAxis":return WI(t,r);default:return}},gP=V([pr,Vl],ph),Gs=V([pr,$l,i7,gP],xy);V(Ll,Nt,(t,e)=>t.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>eP(e,r)));function yP(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var xh=(t,e)=>e,wh=(t,e,r)=>r,h7=V(Rg,xh,wh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(yP)),f7=V(Dg,xh,wh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(yP)),vP=(t,e)=>({width:t.width,height:e.height}),m7=(t,e)=>{var r=typeof e.width=="number"?e.width:ih;return{width:r,height:t.height}},p7=V(Ht,si,vP),g7=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},y7=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},v7=V(ii,Ht,h7,xh,wh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=vP(e,o);s==null&&(s=g7(e,n,t));var c=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(c)*l.height,s+=(c?-1:1)*l.height}),a}),b7=V(ni,Ht,f7,xh,wh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=m7(e,o);s==null&&(s=y7(e,n,t));var c=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(c)*l.width,s+=(c?-1:1)*l.width}),a}),x7=(t,e)=>{var r=Ht(t),n=si(t,e);if(n!=null){var i=v7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},w7=(t,e)=>{var r=Ht(t),n=Gi(t,e);if(n!=null){var i=b7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},_7=V(Ht,Gi,(t,e)=>{var r=typeof e.width=="number"?e.width:ih;return{width:r,height:t.height}}),bP=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=Wi(t,n),l=e.map(c=>c.value);if(s&&o&&a==="category"&&i&&fA(l))return l}},_y=V([tt,bh,pr,Nt],bP),xP=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=Wi(t,n);if(s&&(i==="number"||a!=="auto"))return e.map(o=>o.value)}},Ey=V([tt,bh,Ml,Nt],xP),Pw=V([tt,Mq,$l,Gs,_y,Ey,Vl,wy,Nt],(t,e,r,n,i,a,s,o,l)=>{if(e==null)return null;var c=Wi(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:a,duplicateDomain:i,isCategorical:c,niceTicks:o,range:s,realScaleType:r,scale:n}}),E7=(t,e,r,n,i,a,s,o,l)=>{if(!(e==null||n==null)){var c=Wi(t,l),{type:u,ticks:h,tickCount:m}=e,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=u==="category"&&n.bandwidth?n.bandwidth()/p:0;v=l==="angleAxis"&&a!=null&&a.length>=2?Lr(a[0]-a[1])*2*v:v;var b=h||i;if(b){var g=b.map((_,T)=>{var E=s?s.indexOf(_):_;return{index:T,coordinate:n(E)+v,value:_,offset:v}});return g.filter(_=>!Vr(_.coordinate))}return c&&o?o.map((_,T)=>({coordinate:n(_)+v,value:_,index:T,offset:v})):n.ticks?n.ticks(m).map(_=>({coordinate:n(_)+v,value:_,offset:v})):n.domain().map((_,T)=>({coordinate:n(_)+v,value:s?s[_]:_,index:T,offset:v}))}},wP=V([tt,Ml,$l,Gs,wy,Vl,_y,Ey,Nt],E7),T7=(t,e,r,n,i,a,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Wi(t,s),{tickCount:l}=e,c=0;return c=s==="angleAxis"&&n?.length>=2?Lr(n[0]-n[1])*2*c:c,o&&a?a.map((u,h)=>({coordinate:r(u)+c,value:u,index:h,offset:c})):r.ticks?r.ticks(l).map(u=>({coordinate:r(u)+c,value:u,offset:c})):r.domain().map((u,h)=>({coordinate:r(u)+c,value:i?i[u]:u,index:h,offset:c}))}},_P=V([tt,Ml,Gs,Vl,_y,Ey,Nt],T7),_h=V(pr,Gs,(t,e)=>{if(!(t==null||e==null))return Zu(Zu({},t),{},{scale:e})}),A7=V([pr,$l,by,gP],xy);V((t,e,r)=>gy(t,r),A7,(t,e)=>{if(!(t==null||e==null))return Zu(Zu({},t),{},{scale:e})});var S7=V([tt,Rg,Dg],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),EP=t=>t.options.defaultTooltipEventType,TP=t=>t.options.validateTooltipEventTypes;function AP(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Ty(t,e){var r=EP(t),n=TP(t);return AP(e,r,n)}function I7(t){return ie(e=>Ty(e,t))}var SP=(t,e)=>{var r,n=Number(e);if(!(Vr(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},P7=t=>t.tooltip.settings,_i={active:!1,index:null,dataKey:void 0,coordinate:void 0},C7={itemInteraction:{click:_i,hover:_i},axisInteraction:{click:_i,hover:_i},keyboardInteraction:_i,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},IP=Br({name:"tooltip",initialState:C7,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Un(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:k7,removeTooltipEntrySettings:N7,setTooltipSettingsState:j7,setActiveMouseOverItemIndex:O7,mouseLeaveItem:QJ,mouseLeaveChart:PP,setActiveClickItemIndex:JJ,setMouseOverAxisIndex:CP,setMouseClickAxisIndex:R7,setSyncInteraction:zm,setKeyboardInteraction:Fm}=IP.actions,D7=IP.reducer;function Cw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Mc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(r),!0).forEach(function(n){M7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function M7(t,e,r){return(e=L7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L7(t){var e=$7(t,"string");return typeof e=="symbol"?e:e+""}function $7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V7(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function z7(t){return t.index!=null}var kP=(t,e,r,n)=>{if(e==null)return _i;var i=V7(t,e,r);if(i==null)return _i;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(z7(i)){if(a)return Mc(Mc({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Mc(Mc({},_i),{},{coordinate:i.coordinate})},Ay=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!tn(n))return r;var i=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(i,Math.min(n,a)))},NP=(t,e,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var l=s[0],c=l==null?void 0:o(l.positions,a);if(c!=null)return c;var u=i?.[Number(a)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},jP=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},zl=t=>t.options.tooltipPayloadSearcher,Ys=t=>t.tooltip;function kw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Nw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kw(Object(r),!0).forEach(function(n){F7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function F7(t,e,r){return(e=U7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U7(t){var e=B7(t,"string");return typeof e=="symbol"?e:e+""}function B7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H7(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function W7(t,e){return t??e}var OP=(t,e,r,n,i,a,s)=>{if(!(e==null||a==null)){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:u}=r,h=[];return t.reduce((m,p)=>{var v,{dataDefinedOnItem:b,settings:g}=p,_=W7(b,o),T=H7(_,c,u),E=(v=g?.dataKey)!==null&&v!==void 0?v:n?.dataKey,j=g?.nameKey,R;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?R=mA(T,n.dataKey,i):R=a(T,e,l,j),Array.isArray(R))R.forEach(S=>{var A=Nw(Nw({},g),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});m.push(Ex({tooltipEntrySettings:A,dataKey:S.dataKey,payload:S.payload,value:Tr(S.payload,S.dataKey),name:S.name}))});else{var D;m.push(Ex({tooltipEntrySettings:g,dataKey:E,payload:R,value:Tr(R,E),name:(D=Tr(R,j))!==null&&D!==void 0?D:g?.name}))}return m},h)}},jt=t=>{var e=tt(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Zs=t=>t.tooltip.settings.axisId,Wt=t=>{var e=jt(t),r=Zs(t);return Ml(t,e,r)},Sy=V([Wt,tt,qI,uy,jt],hP),q7=V([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),K7=V([jt,Zs],KI),Eh=V([q7,Wt,K7],YI),G7=V([Eh],XI),Xa=V([G7,Ya],QI),Iy=V([Xa,Wt,Eh],JI),Y7=V([Wt],yy),Z7=V([Xa,Eh,mh],tP),X7=V([Z7,Ya,jt],rP),Q7=V([Eh],ZI),J7=V([Xa,Wt,Q7,jt],nP),eK=V([iP,jt,Zs],Ks),tK=V([eK,jt],oP),rK=V([aP,jt,Zs],Ks),nK=V([rK,jt],lP),iK=V([sP,jt,Zs],Ks),aK=V([iK,jt],cP),sK=V([tK,aK,nK],vy),oK=V([Wt,Y7,X7,J7,sK],uP),RP=V([Wt,tt,Xa,Iy,mh,jt,oK],dP),lK=V([RP,Wt,Sy],fP),cK=V([Wt,RP,lK,jt],mP),DP=t=>{var e=jt(t),r=Zs(t),n=!1;return Vl(t,e,r,n)},MP=V([Wt,DP],ph),LP=V([Wt,Sy,cK,MP],xy),uK=V([tt,Iy,Wt,jt],bP),dK=V([tt,Iy,Wt,jt],xP),hK=(t,e,r,n,i,a,s,o)=>{if(e){var{type:l}=e,c=Wi(t,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&i!=null&&i?.length>=2?Lr(i[0]-i[1])*2*h:h,c&&s?s.map((m,p)=>({coordinate:n(m)+h,value:m,index:p,offset:h})):n.domain().map((m,p)=>({coordinate:n(m)+h,value:a?a[m]:m,index:p,offset:h}))}}},oi=V([tt,Wt,Sy,LP,DP,uK,dK,jt],hK),Py=V([EP,TP,P7],(t,e,r)=>AP(r.shared,t,e)),$P=t=>t.tooltip.settings.trigger,Cy=t=>t.tooltip.settings.defaultIndex,Th=V([Ys,Py,$P,Cy],kP),fl=V([Th,Xa],Ay),VP=V([oi,fl],SP),fK=V([Th],t=>{if(t)return t.dataKey}),zP=V([Ys,Py,$P,Cy],jP),mK=V([ni,ii,tt,Ht,oi,Cy,zP,zl],NP),pK=V([Th,mK],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),gK=V([Th],t=>t.active),yK=V([zP,fl,Ya,Wt,VP,zl,Py],OP),vK=V([yK],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function jw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ow(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jw(Object(r),!0).forEach(function(n){bK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bK(t,e,r){return(e=xK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xK(t){var e=wK(t,"string");return typeof e=="symbol"?e:e+""}function wK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _K=()=>ie(Wt),EK=()=>{var t=_K(),e=ie(oi),r=ie(LP);return _m(Ow(Ow({},t),{},{scale:r}),e)},TK=()=>ie(uy),ky=(t,e)=>e,FP=(t,e,r)=>r,Ny=(t,e,r,n)=>n,AK=V(oi,t=>th(t,e=>e.coordinate)),jy=V([Ys,ky,FP,Ny],kP),UP=V([jy,Xa],Ay),SK=(t,e,r)=>{if(e!=null){var n=Ys(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},BP=V([Ys,ky,FP,Ny],jP),Xu=V([ni,ii,tt,Ht,oi,Ny,BP,zl],NP),IK=V([jy,Xu],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),HP=V(oi,UP,SP),PK=V([BP,UP,Ya,Wt,HP,zl,ky],OP),CK=V([jy],t=>({isActive:t.active,activeIndex:t.index})),kK=(t,e,r,n,i,a,s,o)=>{if(!(!t||!e||!n||!i||!a)){var l=lB(t.chartX,t.chartY,e,r,o);if(l){var c=uB(l,e),u=X9(c,s,a,n,i),h=cB(e,a,u,l);return{activeIndex:String(u),activeCoordinate:h}}}};function Um(){return Um=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Um.apply(null,arguments)}function Rw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Lc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rw(Object(r),!0).forEach(function(n){NK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NK(t,e,r){return(e=jK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RK(t){var{coordinate:e,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:l,chartName:c}=t,u=e,h=r,m=n;if(!o||!u||c!=="ScatterChart"&&l!=="axis")return null;var p,v;if(c==="ScatterChart")p=u,v=XB;else if(c==="BarChart")p=QB(s,u,i,a),v=k8;else if(s==="radial"){var{cx:b,cy:g,radius:_,startAngle:T,endAngle:E}=zS(u);p={cx:b,cy:g,startAngle:T,endAngle:E,innerRadius:_,outerRadius:_},v=R8}else p={points:D8(s,u,i)},v=jS;var j=typeof o=="object"&&"className"in o?o.className:void 0,R=Lc(Lc(Lc(Lc({stroke:"#ccc",pointerEvents:"none"},i),p),Ke(o,!1)),{},{payload:h,payloadIndex:m,className:Le("recharts-tooltip-cursor",j)});return w.isValidElement(o)?w.cloneElement(o,R):w.createElement(v,R)}function DK(t){var e=EK(),r=IS(),n=Lg(),i=TK();return w.createElement(RK,Um({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var WP=w.createContext(null),MK=()=>w.useContext(WP),qP={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||l,m),v=r?r+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],p]:l._events[v].push(p):(l._events[v]=p,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,v=new Array(p);m<p;m++)v[m]=h[m].fn;return v},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,m,p,v){var b=r?r+c:c;if(!this._events[b])return!1;var g=this._events[b],_=arguments.length,T,E;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,m),!0;case 5:return g.fn.call(g.context,u,h,m,p),!0;case 6:return g.fn.call(g.context,u,h,m,p,v),!0}for(E=1,T=new Array(_-1);E<_;E++)T[E-1]=arguments[E];g.fn.apply(g.context,T)}else{var j=g.length,R;for(E=0;E<j;E++)switch(g[E].once&&this.removeListener(c,g[E].fn,void 0,!0),_){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,u);break;case 3:g[E].fn.call(g[E].context,u,h);break;case 4:g[E].fn.call(g[E].context,u,h,m);break;default:if(!T)for(R=1,T=new Array(_-1);R<_;R++)T[R-1]=arguments[R];g[E].fn.apply(g[E].context,T)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,m){var p=r?r+c:c;if(!this._events[p])return this;if(!u)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===u&&(!m||v.once)&&(!h||v.context===h)&&s(this,p);else{for(var b=0,g=[],_=v.length;b<_;b++)(v[b].fn!==u||m&&!v[b].once||h&&v[b].context!==h)&&g.push(v[b]);g.length?this._events[p]=g.length===1?g[0]:g:s(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(qP);var LK=qP.exports;const $K=Fi(LK);var ml=new $K,Bm="recharts.syncEvent.tooltip",Dw="recharts.syncEvent.brush";function VK(t,e){if(e){var r=Number.parseInt(e,10);if(!Vr(r))return t?.[r]}}var zK={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},KP=Br({name:"options",initialState:zK,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),FK=KP.reducer,{createEventEmitter:UK}=KP.actions;function BK(t){return t.tooltip.syncInteraction}var HK={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},GP=Br({name:"chartData",initialState:HK,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:Mw,setDataStartEndIndexes:WK,setComputedData:eee}=GP.actions,qK=GP.reducer,YP=()=>{};function KK(){var t=ie(dy),e=ie(hy),r=sr(),n=ie(FI),i=ie(oi),a=Lg(),s=Mg(),o=ie(l=>l.rootProps.className);w.useEffect(()=>{if(t==null)return YP;var l=(c,u,h)=>{if(e!==h&&t===c){if(n==="index"){r(u);return}if(i!=null){var m;if(typeof n=="function"){var p={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},v=n(i,p);m=i[v]}else n==="value"&&(m=i.find(D=>String(D.value)===u.payload.label));var{coordinate:b}=u.payload;if(m==null||u.payload.active===!1||b==null||s==null){r(zm({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:g,y:_}=b,T=Math.min(g,s.x+s.width),E=Math.min(_,s.y+s.height),j={x:a==="horizontal"?m.coordinate:T,y:a==="horizontal"?E:m.coordinate},R=zm({active:u.payload.active,coordinate:j,dataKey:u.payload.dataKey,index:String(m.index),label:u.payload.label});r(R)}}};return ml.on(Bm,l),()=>{ml.off(Bm,l)}},[o,r,e,t,n,i,a,s])}function GK(){var t=ie(dy),e=ie(hy),r=sr();w.useEffect(()=>{if(t==null)return YP;var n=(i,a,s)=>{e!==s&&t===i&&r(WK(a))};return ml.on(Dw,n),()=>{ml.off(Dw,n)}},[r,e,t])}function YK(){var t=sr();w.useEffect(()=>{t(UK())},[t]),KK(),GK()}function ZK(t,e,r,n,i,a){var s=ie(m=>SK(m,t,e)),o=ie(hy),l=ie(dy),c=ie(FI),u=ie(BK),h=u?.active;w.useEffect(()=>{if(!h&&l!=null&&o!=null){var m=zm({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});ml.emit(Bm,l,m,o)}},[h,r,s,i,n,o,l,c,a])}function Lw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $w(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lw(Object(r),!0).forEach(function(n){XK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XK(t,e,r){return(e=QK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QK(t){var e=JK(t,"string");return typeof e=="symbol"?e:e+""}function JK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eG(t){return t.dataKey}function tG(t,e){return w.isValidElement(t)?w.cloneElement(t,e):typeof t=="function"?w.createElement(t,e):w.createElement(CB,e)}var Vw=[],rG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Nl.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function zw(t){var e=qa(t,rG),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:l,offset:c,payloadUniqBy:u,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:v,cursor:b,shared:g,trigger:_,defaultIndex:T,portal:E,axisId:j}=e,R=sr(),D=typeof T=="number"?String(T):T;w.useEffect(()=>{R(j7({shared:g,trigger:_,axisId:j,active:r,defaultIndex:D}))},[R,g,_,j,r,D]);var S=Mg(),A=NS(),P=I7(g),{activeIndex:O,isActive:N}=ie(ze=>CK(ze,P,_,D)),C=ie(ze=>PK(ze,P,_,D)),k=ie(ze=>HP(ze,P,_,D)),Q=ie(ze=>IK(ze,P,_,D)),oe=C,X=MK(),ee=r??N,[he,ye]=YU([oe,ee]),Ue=P==="axis"?k:void 0;ZK(P,_,Q,Ue,O,ee);var se=E??X;if(se==null)return null;var q=oe??Vw;ee||(q=Vw),o&&q.length&&(q=fU(oe.filter(ze=>ze.value!=null&&(ze.hide!==!0||e.includeHidden)),u,eG));var J=q.length>0,rt=w.createElement(MB,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:l,active:ee,coordinate:Q,hasPayload:J,offset:c,position:h,reverseDirection:m,useTranslate3d:p,viewBox:S,wrapperStyle:v,lastBoundingBox:he,innerRef:ye,hasPortalFromProps:!!E},tG(s,$w($w({},e),{},{payload:q,label:Ue,active:ee,coordinate:Q,accessibilityLayer:A})));return w.createElement(w.Fragment,null,Jm.createPortal(rt,se),ee&&w.createElement(DK,{cursor:b,tooltipEventType:P,coordinate:Q,payload:oe,index:O}))}var ZP={},XP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=0,i={}){typeof i!="object"&&(i={});let a=null,s=null,o=null,l=0,c=null,u;const{leading:h=!1,trailing:m=!0,maxWait:p}=i,v="maxWait"in i,b=v?Math.max(Number(p)||0,n):0,g=S=>(a!==null&&(u=r.apply(s,a)),a=s=null,l=S,u),_=S=>(l=S,c=setTimeout(R,n),h&&a!==null?g(S):u),T=S=>(c=null,m&&a!==null?g(S):u),E=S=>{if(o===null)return!0;const A=S-o,P=A>=n||A<0,O=v&&S-l>=b;return P||O},j=S=>{const A=o===null?0:S-o,P=n-A,O=b-(S-l);return v?Math.min(P,O):P},R=()=>{const S=Date.now();if(E(S))return T(S);c=setTimeout(R,j(S))},D=function(...S){const A=Date.now(),P=E(A);if(a=S,s=this,o=A,P){if(c===null)return _(A);if(v)return clearTimeout(c),c=setTimeout(R,n),g(A)}return c===null&&(c=setTimeout(R,n)),u};return D.cancel=()=>{c!==null&&clearTimeout(c),l=0,o=a=s=c=null},D.flush=()=>c===null?u:T(Date.now()),D}t.debounce=e})(XP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=XP;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return e.debounce(n,i,{leading:s,maxWait:i,trailing:o})}t.throttle=r})(ZP);var nG=ZP.throttle;const iG=Fi(nG);var Uo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function Fw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function wf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Fw(Object(r),!0).forEach(function(n){aG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Fw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aG(t,e,r){return(e=sG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sG(t){var e=oG(t,"string");return typeof e=="symbol"?e:e+""}function oG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Uw=w.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:c,debounce:u=0,id:h,className:m,onResize:p,style:v={}}=t,b=w.useRef(null),g=w.useRef();g.current=p,w.useImperativeHandle(e,()=>b.current);var[_,T]=w.useState({containerWidth:n.width,containerHeight:n.height}),E=w.useCallback((R,D)=>{T(S=>{var A=Math.round(R),P=Math.round(D);return S.containerWidth===A&&S.containerHeight===P?S:{containerWidth:A,containerHeight:P}})},[]);w.useEffect(()=>{var R=P=>{var O,{width:N,height:C}=P[0].contentRect;E(N,C),(O=g.current)===null||O===void 0||O.call(g,N,C)};u>0&&(R=iG(R,u,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),{width:S,height:A}=b.current.getBoundingClientRect();return E(S,A),D.observe(b.current),()=>{D.disconnect()}},[E,u]);var j=w.useMemo(()=>{var{containerWidth:R,containerHeight:D}=_;if(R<0||D<0)return null;Uo(ha(i)||ha(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),Uo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=ha(i)?R:i,A=ha(a)?D:a;return r&&r>0&&(S?A=S/r:A&&(S=A*r),l&&A>l&&(A=l)),Uo(S>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,A,i,a,s,o,r),w.Children.map(c,P=>w.cloneElement(P,{width:S,height:A,style:wf({width:S,height:A},P.props.style)}))},[r,c,a,l,o,s,_,i]);return w.createElement("div",{id:h?"".concat(h):void 0,className:Le("recharts-responsive-container",m),style:wf(wf({},v),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:l}),ref:b},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))});function Bw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Hm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bw(Object(r),!0).forEach(function(n){lG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lG(t,e,r){return(e=cG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cG(t){var e=uG(t,"string");return typeof e=="symbol"?e:e+""}function uG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ss={widthCache:{},cacheCount:0},dG=2e3,hG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Hw="recharts_measurement_span";function fG(t){var e=Hm({},t);return Object.keys(e).forEach(r=>{e[r]||delete e[r]}),e}var Bo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Nl.isSsr)return{width:0,height:0};var n=fG(r),i=JSON.stringify({text:e,copyStyle:n});if(ss.widthCache[i])return ss.widthCache[i];try{var a=document.getElementById(Hw);a||(a=document.createElement("span"),a.setAttribute("id",Hw),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=Hm(Hm({},hG),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),l={width:o.width,height:o.height};return ss.widthCache[i]=l,++ss.cacheCount>dG&&(ss.cacheCount=0,ss.widthCache={}),l}catch{return{width:0,height:0}}},Ww=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,mG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,pG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,QP={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},gG=Object.keys(QP),fs="NaN";function yG(t,e){return t*QP[e]}class lr{static parse(e){var r,[,n,i]=(r=pG.exec(e))!==null&&r!==void 0?r:[];return new lr(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Vr(e)&&(this.unit=""),r!==""&&!mG.test(r)&&(this.num=NaN,this.unit=""),gG.includes(r)&&(this.num=yG(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vr(this.num)}}function JP(t){if(t.includes(fs))return fs;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=Ww.exec(e))!==null&&r!==void 0?r:[],s=lr.parse(n??""),o=lr.parse(a??""),l=i==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return fs;e=e.replace(Ww,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var c,[,u,h,m]=(c=qw.exec(e))!==null&&c!==void 0?c:[],p=lr.parse(u??""),v=lr.parse(m??""),b=h==="+"?p.add(v):p.subtract(v);if(b.isNaN())return fs;e=e.replace(qw,b.toString())}return e}var Kw=/\(([^()]*)\)/;function vG(t){for(var e=t,r;(r=Kw.exec(e))!=null;){var[,n]=r;e=e.replace(Kw,JP(n))}return e}function bG(t){var e=t.replace(/\s+/g,"");return e=vG(e),e=JP(e),e}function xG(t){try{return bG(t)}catch{return fs}}function _f(t){var e=xG(t.slice(5,-1));return e===fs?"":e}var wG=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],_G=["dx","dy","angle","className","breakAll"];function Wm(){return Wm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wm.apply(null,arguments)}function Gw(t,e){if(t==null)return{};var r,n,i=EG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function EG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var eC=/[ \f\n\r\t\v\u2028\u2029]+/,tC=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];ct(e)||(r?i=e.toString().split(""):i=e.toString().split(eC));var a=i.map(o=>({word:o,width:Bo(o,n).width})),s=r?0:Bo("",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},TG=(t,e,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:l}=t,c=te(a),u=s,h=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((C,k)=>{var{word:Q,width:oe}=k,X=C[C.length-1];if(X&&(n==null||i||X.width+oe+r<Number(n)))X.words.push(Q),X.width+=oe+r;else{var ee={words:[Q],width:oe};C.push(ee)}return C},[])},m=h(e),p=O=>O.reduce((N,C)=>N.width>C.width?N:C);if(!c||i)return m;var v=m.length>a||p(m).width>Number(n);if(!v)return m;for(var b="",g=O=>{var N=u.slice(0,O),C=tC({breakAll:l,style:o,children:N+b}).wordsWithComputedWidth,k=h(C),Q=k.length>a||p(k).width>Number(n);return[Q,k]},_=0,T=u.length-1,E=0,j;_<=T&&E<=u.length-1;){var R=Math.floor((_+T)/2),D=R-1,[S,A]=g(D),[P]=g(R);if(!S&&!P&&(_=R+1),S&&P&&(T=R-1),!S&&P){j=A;break}E++}return j||m},Yw=t=>{var e=ct(t)?[]:t.toString().split(eC);return[{words:e}]},AG=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=t;if((e||r)&&!Nl.isSsr){var o,l,c=tC({breakAll:a,children:n,style:i});if(c){var{wordsWithComputedWidth:u,spaceWidth:h}=c;o=u,l=h}else return Yw(n);return TG({breakAll:a,children:n,maxLines:s,style:i},o,l,e,r)}return Yw(n)},Zw="#808080",Oy=w.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:c=Zw}=t,u=Gw(t,wG),h=w.useMemo(()=>AG({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:m,dy:p,angle:v,className:b,breakAll:g}=u,_=Gw(u,_G);if(!Sn(r)||!Sn(n))return null;var T=r+(te(m)?m:0),E=n+(te(p)?p:0),j;switch(l){case"start":j=_f("calc(".concat(a,")"));break;case"middle":j=_f("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:j=_f("calc(".concat(h.length-1," * -").concat(i,")"));break}var R=[];if(s){var D=h[0].width,{width:S}=u;R.push("scale(".concat(te(S)?S/D:1,")"))}return v&&R.push("rotate(".concat(v,", ").concat(T,", ").concat(E,")")),R.length&&(_.transform=R.join(" ")),w.createElement("text",Wm({},Ke(_,!0),{ref:e,x:T,y:E,className:Le("recharts-text",b),textAnchor:o,fill:c.includes("url")?Zw:c}),h.map((A,P)=>{var O=A.words.join(g?"":" ");return w.createElement("tspan",{x:T,dy:P===0?j:i,key:"".concat(O,"-").concat(P)},O)}))});Oy.displayName="Text";var SG=["offset"],IG=["labelRef"];function Xw(t,e){if(t==null)return{};var r,n,i=PG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function PG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Qw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qw(Object(r),!0).forEach(function(n){CG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CG(t,e,r){return(e=kG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kG(t){var e=NG(t,"string");return typeof e=="symbol"?e:e+""}function NG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ln(){return Ln=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ln.apply(null,arguments)}var jG=t=>{var{value:e,formatter:r}=t,n=ct(t.children)?e:t.children;return typeof r=="function"?r(n):n},Ry=t=>t!=null&&typeof t=="function",OG=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),360);return r*n},RG=(t,e,r)=>{var{position:n,viewBox:i,offset:a,className:s}=t,{cx:o,cy:l,innerRadius:c,outerRadius:u,startAngle:h,endAngle:m,clockWise:p}=i,v=(c+u)/2,b=OG(h,m),g=b>=0?1:-1,_,T;n==="insideStart"?(_=h+g*a,T=p):n==="insideEnd"?(_=m-g*a,T=!p):n==="end"&&(_=m+g*a,T=p),T=b<=0?T:!T;var E=Ut(o,l,v,_),j=Ut(o,l,v,_+(T?1:-1)*359),R="M".concat(E.x,",").concat(E.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(T?0:1,`,
    `).concat(j.x,",").concat(j.y),D=ct(t.id)?sl("recharts-radial-line-"):t.id;return w.createElement("text",Ln({},r,{dominantBaseline:"central",className:Le("recharts-radial-bar-label",s)}),w.createElement("defs",null,w.createElement("path",{id:D,d:R})),w.createElement("textPath",{xlinkHref:"#".concat(D)},e))},DG=t=>{var{viewBox:e,offset:r,position:n}=t,{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(n==="outside"){var{x:h,y:m}=Ut(i,a,o+r,u);return{x:h,y:m,textAnchor:h>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:v,y:b}=Ut(i,a,p,u);return{x:v,y:b,textAnchor:"middle",verticalAnchor:"middle"}},MG=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,{x:a,y:s,width:o,height:l}=e,c=l>=0?1:-1,u=c*n,h=c>0?"end":"start",m=c>0?"start":"end",p=o>=0?1:-1,v=p*n,b=p>0?"end":"start",g=p>0?"start":"end";if(i==="top"){var _={x:a+o/2,y:s-c*n,textAnchor:"middle",verticalAnchor:h};return ft(ft({},_),r?{height:Math.max(s-r.y,0),width:o}:{})}if(i==="bottom"){var T={x:a+o/2,y:s+l+u,textAnchor:"middle",verticalAnchor:m};return ft(ft({},T),r?{height:Math.max(r.y+r.height-(s+l),0),width:o}:{})}if(i==="left"){var E={x:a-v,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return ft(ft({},E),r?{width:Math.max(E.x-r.x,0),height:l}:{})}if(i==="right"){var j={x:a+o+v,y:s+l/2,textAnchor:g,verticalAnchor:"middle"};return ft(ft({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:l}:{})}var R=r?{width:o,height:l}:{};return i==="insideLeft"?ft({x:a+v,y:s+l/2,textAnchor:g,verticalAnchor:"middle"},R):i==="insideRight"?ft({x:a+o-v,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},R):i==="insideTop"?ft({x:a+o/2,y:s+u,textAnchor:"middle",verticalAnchor:m},R):i==="insideBottom"?ft({x:a+o/2,y:s+l-u,textAnchor:"middle",verticalAnchor:h},R):i==="insideTopLeft"?ft({x:a+v,y:s+u,textAnchor:g,verticalAnchor:m},R):i==="insideTopRight"?ft({x:a+o-v,y:s+u,textAnchor:b,verticalAnchor:m},R):i==="insideBottomLeft"?ft({x:a+v,y:s+l-u,textAnchor:g,verticalAnchor:h},R):i==="insideBottomRight"?ft({x:a+o-v,y:s+l-u,textAnchor:b,verticalAnchor:h},R):i&&typeof i=="object"&&(te(i.x)||ha(i.x))&&(te(i.y)||ha(i.y))?ft({x:a+Vi(i.x,o),y:s+Vi(i.y,l),textAnchor:"end",verticalAnchor:"end"},R):ft({x:a+o/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},R)},LG=t=>"cx"in t&&te(t.cx);function xr(t){var{offset:e=5}=t,r=Xw(t,SG),n=ft({offset:e},r),{viewBox:i,position:a,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:h}=n,m=Mg(),p=i||m;if(!p||ct(s)&&ct(o)&&!w.isValidElement(l)&&typeof l!="function")return null;if(w.isValidElement(l)){var{labelRef:v}=n,b=Xw(n,IG);return w.cloneElement(l,b)}var g;if(typeof l=="function"){if(g=w.createElement(l,n),w.isValidElement(g))return g}else g=jG(n);var _=LG(p),T=Ke(n,!0);if(_&&(a==="insideStart"||a==="insideEnd"||a==="end"))return RG(n,g,T);var E=_?DG(n):MG(n,p);return w.createElement(Oy,Ln({ref:h,className:Le("recharts-label",c)},T,E,{breakAll:u}),g)}xr.displayName="Label";var rC=t=>{var{cx:e,cy:r,angle:n,startAngle:i,endAngle:a,r:s,radius:o,innerRadius:l,outerRadius:c,x:u,y:h,top:m,left:p,width:v,height:b,clockWise:g,labelViewBox:_}=t;if(_)return _;if(te(v)&&te(b)){if(te(u)&&te(h))return{x:u,y:h,width:v,height:b};if(te(m)&&te(p))return{x:m,y:p,width:v,height:b}}if(te(u)&&te(h))return{x:u,y:h,width:0,height:0};if(te(e)&&te(r))return{cx:e,cy:r,startAngle:i||n||0,endAngle:a||n||0,innerRadius:l||0,outerRadius:c||o||s||0,clockWise:g};if(t.viewBox)return t.viewBox},$G=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?w.createElement(xr,Ln({key:"label-implicit"},n)):Sn(t)?w.createElement(xr,Ln({key:"label-implicit",value:t},n)):w.isValidElement(t)?t.type===xr?w.cloneElement(t,ft({key:"label-implicit"},n)):w.createElement(xr,Ln({key:"label-implicit",content:t},n)):Ry(t)?w.createElement(xr,Ln({key:"label-implicit",content:t},n)):t&&typeof t=="object"?w.createElement(xr,Ln({},t,{key:"label-implicit"},n)):null},VG=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:i,labelRef:a}=e,s=rC(e),o=gA(i,xr).map((c,u)=>w.cloneElement(c,{viewBox:r||s,key:"label-".concat(u)}));if(!n)return o;var l=$G(e.label,r||s,a);return[l,...o]};xr.parseViewBox=rC;xr.renderCallByParent=VG;var nC={},iC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(iC);var aC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(aC);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=iC,r=aC,n=Zd;function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(nC);var zG=nC.last;const FG=Fi(zG);var UG=["valueAccessor"],BG=["data","dataKey","clockWise","id","textBreakAll"];function Qu(){return Qu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qu.apply(null,arguments)}function Jw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function e_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jw(Object(r),!0).forEach(function(n){HG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HG(t,e,r){return(e=WG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WG(t){var e=qG(t,"string");return typeof e=="symbol"?e:e+""}function qG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t_(t,e){if(t==null)return{};var r,n,i=KG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function KG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var GG=t=>Array.isArray(t.value)?FG(t.value):t.value;function Ta(t){var{valueAccessor:e=GG}=t,r=t_(t,UG),{data:n,dataKey:i,clockWise:a,id:s,textBreakAll:o}=r,l=t_(r,BG);return!n||!n.length?null:w.createElement(zi,{className:"recharts-label-list"},n.map((c,u)=>{var h=ct(i)?e(c,u):Tr(c&&c.payload,i),m=ct(s)?{}:{id:"".concat(s,"-").concat(u)};return w.createElement(xr,Qu({},Ke(c,!0),l,m,{parentViewBox:c.parentViewBox,value:h,textBreakAll:o,viewBox:xr.parseViewBox(ct(a)?c:e_(e_({},c),{},{clockWise:a})),key:"label-".concat(u),index:u}))}))}Ta.displayName="LabelList";function YG(t,e){return t?t===!0?w.createElement(Ta,{key:"labelList-implicit",data:e}):w.isValidElement(t)||Ry(t)?w.createElement(Ta,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?w.createElement(Ta,Qu({data:e},t,{key:"labelList-implicit"})):null:null}function ZG(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:n}=t,i=gA(n,Ta).map((s,o)=>w.cloneElement(s,{data:e,key:"labelList-".concat(o)}));if(!r)return i;var a=YG(t.label,e);return[a,...i]}Ta.renderCallByParent=ZG;function qm(){return qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qm.apply(null,arguments)}var sC=t=>{var{cx:e,cy:r,r:n,className:i}=t,a=Le("recharts-dot",i);return e===+e&&r===+r&&n===+n?w.createElement("circle",qm({},Ke(t,!1),bg(t),{className:a,cx:e,cy:r,r:n})):null},XG={radiusAxis:{},angleAxis:{}},oC=Br({name:"polarAxis",initialState:XG,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:tee,removeRadiusAxis:ree,addAngleAxis:nee,removeAngleAxis:iee}=oC.actions,QG=oC.reducer,JG={countOfBars:0,cartesianItems:[],polarItems:[]},lC=Br({name:"graphicalItems",initialState:JG,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,i=Un(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},removeCartesianGraphicalItem(t,e){var r=Un(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Un(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addBar:aee,removeBar:see,addCartesianGraphicalItem:eY,replaceCartesianGraphicalItem:tY,removeCartesianGraphicalItem:rY,addPolarGraphicalItem:oee,removePolarGraphicalItem:lee}=lC.actions,nY=lC.reducer;function r_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function n_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?r_(Object(r),!0).forEach(function(n){iY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):r_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iY(t,e,r){return(e=aY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aY(t){var e=sY(t,"string");return typeof e=="symbol"?e:e+""}function sY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oY(t){var e=sr(),r=w.useRef(null);return w.useEffect(()=>{var n=n_(n_({},t),{},{stackId:iB(t.stackId)});r.current===null?e(eY(n)):r.current!==n&&e(tY({prev:r.current,next:n})),r.current=n},[e,t]),w.useEffect(()=>()=>{r.current&&(e(rY(r.current)),r.current=null)},[e]),null}function lY(t){var{fn:e,args:r}=t,n=sr(),i=mr();return w.useEffect(()=>{if(!i){var a=e(r);return n(k7(a)),()=>{n(N7(a))}}},[e,r,n,i]),null}var cY=()=>{};function uY(t){var{legendPayload:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?cY:(r(_B(e)),()=>{r(EB(e))}),[r,n,e]),null}function dY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(sl(e)),n=w.useRef(t);return n.current!==t&&(r.current=sl(e),n.current=t),r.current}var hY=V([Ht],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),fY=V([hY,ni,ii],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),mY=t=>{var e=mr();return ie(r=>_h(r,"xAxis",t,e))},pY=t=>{var e=mr();return ie(r=>_h(r,"yAxis",t,e))},Dy=()=>ie(fY),gY=()=>ie(vK);function i_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function a_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?i_(Object(r),!0).forEach(function(n){yY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yY(t,e,r){return(e=vY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vY(t){var e=bY(t,"string");return typeof e=="symbol"?e:e+""}function bY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xY=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=t;if(i===!1||e.x==null||e.y==null)return null;var s=a_(a_({index:r,dataKey:a,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},Ke(i,!1)),bg(i)),o;return w.isValidElement(i)?o=w.cloneElement(i,s):typeof i=="function"?o=i(s):o=w.createElement(sC,s),w.createElement(zi,{className:"recharts-active-dot"},o)};function wY(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:i}=t,a=ie(fl),s=gY();if(e==null||s==null)return null;var o=e.find(l=>s.includes(l.payload));return ct(o)?null:xY({point:o,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var _Y=["children"];function EY(t,e){if(t==null)return{};var r,n,i=TY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function TY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var s_=()=>{},cC=w.createContext({addErrorBar:s_,removeErrorBar:s_}),AY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},uC=w.createContext(AY);function SY(t){var{children:e}=t,r=EY(t,_Y);return w.createElement(uC.Provider,{value:r},e)}var IY=()=>w.useContext(uC),PY=t=>{var{children:e,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,data:s,stackId:o,hide:l,type:c,barSize:u}=t,[h,m]=w.useState([]),p=w.useCallback(g=>{m(_=>[..._,g])},[m]),v=w.useCallback(g=>{m(_=>_.filter(T=>T!==g))},[m]),b=mr();return w.createElement(cC.Provider,{value:{addErrorBar:p,removeErrorBar:v}},w.createElement(oY,{type:c,data:s,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,errorBars:h,stackId:o,hide:l,barSize:u,isPanorama:b}),e)};function CY(t){var{addErrorBar:e,removeErrorBar:r}=w.useContext(cC);return w.useEffect(()=>(e(t),()=>{r(t)}),[e,r,t]),null}var kY=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function dC(t,e,r){return(e=NY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NY(t){var e=jY(t,"string");return typeof e=="symbol"?e:e+""}function jY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pl(){return pl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pl.apply(null,arguments)}function OY(t,e){if(t==null)return{};var r,n,i=RY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function RY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function DY(t){var{direction:e,width:r,dataKey:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o}=t,l=OY(t,kY),c=Ke(l,!1),{data:u,dataPointFormatter:h,xAxisId:m,yAxisId:p,errorBarOffset:v}=IY(),b=mY(m),g=pY(p);if(b?.scale==null||g?.scale==null||u==null||e==="x"&&b.type!=="number")return null;var _=u.map(T=>{var{x:E,y:j,value:R,errorVal:D}=h(T,n,e);if(!D)return null;var S=[],A,P;if(Array.isArray(D)?[A,P]=D:A=P=D,e==="x"){var{scale:O}=b,N=j+v,C=N+r,k=N-r,Q=O(R-A),oe=O(R+P);S.push({x1:oe,y1:C,x2:oe,y2:k}),S.push({x1:Q,y1:N,x2:oe,y2:N}),S.push({x1:Q,y1:C,x2:Q,y2:k})}else if(e==="y"){var{scale:X}=g,ee=E+v,he=ee-r,ye=ee+r,Ue=X(R-A),se=X(R+P);S.push({x1:he,y1:se,x2:ye,y2:se}),S.push({x1:ee,y1:Ue,x2:ee,y2:se}),S.push({x1:he,y1:Ue,x2:ye,y2:Ue})}var q="".concat(E+v,"px ").concat(j+v,"px");return w.createElement(zi,pl({className:"recharts-errorBar",key:"bar-".concat(S.map(J=>"".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)))},c),S.map(J=>{var rt=i?{transformOrigin:"".concat(J.x1-5,"px")}:void 0;return w.createElement($u,{from:{transform:"scaleY(0)",transformOrigin:q},to:{transform:"scaleY(1)",transformOrigin:q},begin:a,easing:o,isActive:i,duration:s,key:"line-".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2),style:{transformOrigin:q}},w.createElement("line",pl({},J,{style:rt})))}))});return w.createElement(zi,{className:"recharts-errorBars"},_)}var hC=w.createContext(void 0);function MY(t){var e=w.useContext(hC);return t??e??"x"}function LY(t){var{direction:e,children:r}=t;return w.createElement(hC.Provider,{value:e},r)}var fC={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function $Y(t){var e=MY(t.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s}=qa(t,fC);return w.createElement(w.Fragment,null,w.createElement(CY,{dataKey:t.dataKey,direction:e}),w.createElement(DY,pl({},t,{direction:e,width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s})))}class mC extends w.Component{render(){return w.createElement($Y,this.props)}}dC(mC,"defaultProps",fC);dC(mC,"displayName","ErrorBar");function pC(t,e){var r,n,i=ie(c=>si(c,t)),a=ie(c=>Gi(c,e)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:yr.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:vr.allowDataOverflow,l=s||o;return{needClip:l,needClipX:s,needClipY:o}}function VY(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=Dy(),{needClipX:a,needClipY:s,needClip:o}=pC(e,r);if(!o)return null;var{x:l,y:c,width:u,height:h}=i;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?l:l-u/2,y:s?c:c-h/2,width:a?u:u*2,height:s?h:h*2}))}var zY=t=>{var{chartData:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?()=>{}:(r(Mw(e)),()=>{r(Mw(void 0))}),[e,r,n]),null},o_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},gC=Br({name:"brush",initialState:o_,reducers:{setBrushSettings(t,e){return e.payload==null?o_:e.payload}}}),{setBrushSettings:cee}=gC.actions,FY=gC.reducer;function UY(t,e,r){return(e=BY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BY(t){var e=HY(t,"string");return typeof e=="symbol"?e:e+""}function HY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class My{static create(e){return new My(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}UY(My,"EPS",1e-4);function WY(t){return(t%180+180)%180}var qY=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=WY(i),s=a*Math.PI/180,o=Math.atan(n/r),l=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(l)},KY={dots:[],areas:[],lines:[]},yC=Br({name:"referenceElements",initialState:KY,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Un(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Un(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Un(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:uee,removeDot:dee,addArea:hee,removeArea:fee,addLine:mee,removeLine:pee}=yC.actions,GY=yC.reducer,YY=w.createContext(void 0),ZY=t=>{var{children:e}=t,[r]=w.useState("".concat(sl("recharts"),"-clip")),n=Dy();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return w.createElement(YY.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:i,y:a,height:o,width:s}))),e)};function Ef(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function vC(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function XY(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return qY(n,r)}function QY(t,e,r){var n=r==="width",{x:i,y:a,width:s,height:o}=t;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function Ju(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function JY(t,e){return vC(t,e+1)}function eZ(t,e,r,n,i){for(var a=(n||[]).slice(),{start:s,end:o}=e,l=0,c=1,u=s,h=function(){var v=n?.[l];if(v===void 0)return{v:vC(n,c)};var b=l,g,_=()=>(g===void 0&&(g=r(v,b)),g),T=v.coordinate,E=l===0||Ju(t,T,_,u,o);E||(l=0,u=s,c+=1),E&&(u=T+t*(_()/2+i),l+=c)},m;c<=a.length;)if(m=h(),m)return m.v;return[]}function l_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?l_(Object(r),!0).forEach(function(n){tZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tZ(t,e,r){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iZ(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:o}=e,{end:l}=e,c=function(m){var p=a[m],v,b=()=>(v===void 0&&(v=r(p,m)),v);if(m===s-1){var g=t*(p.coordinate+t*b()/2-l);a[m]=p=Zt(Zt({},p),{},{tickCoord:g>0?p.coordinate-g*t:p.coordinate})}else a[m]=p=Zt(Zt({},p),{},{tickCoord:p.coordinate});var _=Ju(t,p.tickCoord,b,o,l);_&&(l=p.tickCoord-t*(b()/2+i),a[m]=Zt(Zt({},p),{},{isShow:!0}))},u=s-1;u>=0;u--)c(u);return a}function aZ(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,{start:l,end:c}=e;if(a){var u=n[o-1],h=r(u,o-1),m=t*(u.coordinate+t*h/2-c);s[o-1]=u=Zt(Zt({},u),{},{tickCoord:m>0?u.coordinate-m*t:u.coordinate});var p=Ju(t,u.tickCoord,()=>h,l,c);p&&(c=u.tickCoord-t*(h/2+i),s[o-1]=Zt(Zt({},u),{},{isShow:!0}))}for(var v=a?o-1:o,b=function(T){var E=s[T],j,R=()=>(j===void 0&&(j=r(E,T)),j);if(T===0){var D=t*(E.coordinate-t*R()/2-l);s[T]=E=Zt(Zt({},E),{},{tickCoord:D<0?E.coordinate-D*t:E.coordinate})}else s[T]=E=Zt(Zt({},E),{},{tickCoord:E.coordinate});var S=Ju(t,E.tickCoord,R,l,c);S&&(l=E.tickCoord+t*(R()/2+i),s[T]=Zt(Zt({},E),{},{isShow:!0}))},g=0;g<v;g++)b(g);return s}function Ly(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:o,interval:l,tickFormatter:c,unit:u,angle:h}=t;if(!i||!i.length||!n)return[];if(te(l)||Nl.isSsr){var m;return(m=JY(i,te(l)?l:0))!==null&&m!==void 0?m:[]}var p=[],v=o==="top"||o==="bottom"?"width":"height",b=u&&v==="width"?Bo(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(E,j)=>{var R=typeof c=="function"?c(E.value,j):E.value;return v==="width"?XY(Bo(R,{fontSize:e,letterSpacing:r}),b,h):Bo(R,{fontSize:e,letterSpacing:r})[v]},_=i.length>=2?Lr(i[1].coordinate-i[0].coordinate):1,T=QY(a,_,v);return l==="equidistantPreserveStart"?eZ(_,T,g,i,s):(l==="preserveStart"||l==="preserveStartEnd"?p=aZ(_,T,g,i,s,l==="preserveStartEnd"):p=iZ(_,T,g,i,s),p.filter(E=>E.isShow))}var sZ=["viewBox"],oZ=["viewBox"];function ms(){return ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ms.apply(null,arguments)}function c_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c_(Object(r),!0).forEach(function(n){$y(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function u_(t,e){if(t==null)return{};var r,n,i=lZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function lZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function $y(t,e,r){return(e=cZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cZ(t){var e=uZ(t,"string");return typeof e=="symbol"?e:e+""}function uZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yi extends w.Component{constructor(e){super(e),this.tickRefs=w.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,r){var{viewBox:n}=e,i=u_(e,sZ),a=this.props,{viewBox:s}=a,o=u_(a,oZ);return!Ef(n,s)||!Ef(i,o)||!Ef(r,this.state)}getTickLineCoord(e){var{x:r,y:n,width:i,height:a,orientation:s,tickSize:o,mirror:l,tickMargin:c}=this.props,u,h,m,p,v,b,g=l?-1:1,_=e.tickSize||o,T=te(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=h=e.coordinate,p=n+ +!l*a,m=p-g*_,b=m-g*c,v=T;break;case"left":m=p=e.coordinate,h=r+ +!l*i,u=h-g*_,v=u-g*c,b=T;break;case"right":m=p=e.coordinate,h=r+ +l*i,u=h+g*_,v=u+g*c,b=T;break;default:u=h=e.coordinate,p=n+ +l*a,m=p+g*_,b=m+g*c,v=T;break}return{line:{x1:u,y1:m,x2:h,y2:p},tick:{x:v,y:b}}}getTickTextAnchor(){var{orientation:e,mirror:r}=this.props,n;switch(e){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:e,mirror:r}=this.props;switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:e,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:o}=this.props,l=xt(xt(xt({},Ke(this.props,!1)),Ke(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var c=+(a==="top"&&!s||a==="bottom"&&s);l=xt(xt({},l),{},{x1:e,y1:r+c*i,x2:e+n,y2:r+c*i})}else{var u=+(a==="left"&&!s||a==="right"&&s);l=xt(xt({},l),{},{x1:e+u*n,y1:r,x2:e+u*n,y2:r+i})}return w.createElement("line",ms({},l,{className:Le("recharts-cartesian-axis-line",Ma(o,"className"))}))}static renderTickItem(e,r,n){var i,a=Le(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(e))i=w.cloneElement(e,xt(xt({},r),{},{className:a}));else if(typeof e=="function")i=e(xt(xt({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=Le(s,e.className)),i=w.createElement(Oy,ms({},r,{className:s}),n)}return i}renderTicks(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:a,tick:s,tickFormatter:o,unit:l}=this.props,c=Ly(xt(xt({},this.props),{},{ticks:n}),e,r),u=this.getTickTextAnchor(),h=this.getTickVerticalAnchor(),m=Ke(this.props,!1),p=Ke(s,!1),v=xt(xt({},m),{},{fill:"none"},Ke(i,!1)),b=c.map((g,_)=>{var{line:T,tick:E}=this.getTickLineCoord(g),j=xt(xt(xt(xt({textAnchor:u,verticalAnchor:h},m),{},{stroke:"none",fill:a},p),E),{},{index:_,payload:g,visibleTicksCount:c.length,tickFormatter:o});return w.createElement(zi,ms({className:"recharts-cartesian-axis-tick",key:"tick-".concat(g.value,"-").concat(g.coordinate,"-").concat(g.tickCoord)},DF(this.props,g,_)),i&&w.createElement("line",ms({},v,T,{className:Le("recharts-cartesian-axis-tick-line",Ma(i,"className"))})),s&&Yi.renderTickItem(s,j,"".concat(typeof o=="function"?o(g.value,_):g.value).concat(l||"")))});return b.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:e,width:r,height:n,className:i,hide:a}=this.props;if(a)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:w.createElement(zi,{className:Le("recharts-cartesian-axis",i),ref:o=>{if(o){var l=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var u=window.getComputedStyle(c).fontSize,h=window.getComputedStyle(c).letterSpacing;(u!==this.state.fontSize||h!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),xr.renderCallByParent(this.props))}}$y(Yi,"displayName","CartesianAxis");$y(Yi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var dZ=["x1","y1","x2","y2","key"],hZ=["offset"],fZ=["xAxisId","yAxisId"],mZ=["xAxisId","yAxisId"];function d_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?d_(Object(r),!0).forEach(function(n){pZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pZ(t,e,r){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gZ(t){var e=yZ(t,"string");return typeof e=="symbol"?e:e+""}function yZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ga(){return ga=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ga.apply(null,arguments)}function ed(t,e){if(t==null)return{};var r,n,i=vZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var bZ=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:o}=t;return w.createElement("rect",{x:n,y:i,ry:o,width:a,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function bC(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:i,x2:a,y2:s,key:o}=e,l=ed(e,dZ),c=Ke(l,!1),{offset:u}=c,h=ed(c,hZ);r=w.createElement("line",ga({},h,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function xZ(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=ed(t,fZ),l=i.map((c,u)=>{var h=Jt(Jt({},o),{},{x1:e,y1:c,x2:e+r,y2:c,key:"line-".concat(u),index:u});return bC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function wZ(t){var{y:e,height:r,vertical:n=!0,verticalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=ed(t,mZ),l=i.map((c,u)=>{var h=Jt(Jt({},o),{},{x1:c,y1:e,x2:c,y2:e+r,key:"line-".concat(u),index:u});return bC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function _Z(t){var{horizontalFill:e,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:o,horizontal:l=!0}=t;if(!l||!e||!e.length)return null;var c=o.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==c[0]&&c.unshift(0);var u=c.map((h,m)=>{var p=!c[m+1],v=p?i+s-h:c[m+1]-h;if(v<=0)return null;var b=m%e.length;return w.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:v,width:a,stroke:"none",fill:e[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function EZ(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,verticalPoints:l}=t;if(!e||!r||!r.length)return null;var c=l.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==c[0]&&c.unshift(0);var u=c.map((h,m)=>{var p=!c[m+1],v=p?i+s-h:c[m+1]-h;if(v<=0)return null;var b=m%r.length;return w.createElement("rect",{key:"react-".concat(m),x:h,y:a,width:v,height:o,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var TZ=(t,e)=>{var{xAxis:r,width:n,height:i,offset:a}=t;return _S(Ly(Jt(Jt(Jt({},Yi.defaultProps),r),{},{ticks:ES(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,e)},AZ=(t,e)=>{var{yAxis:r,width:n,height:i,offset:a}=t;return _S(Ly(Jt(Jt(Jt({},Yi.defaultProps),r),{},{ticks:ES(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,e)},SZ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Km(t){var e=PS(),r=CS(),n=IS(),i=Jt(Jt({},qa(t,SZ)),{},{x:te(t.x)?t.x:n.left,y:te(t.y)?t.y:n.top,width:te(t.width)?t.width:n.width,height:te(t.height)?t.height:n.height}),{xAxisId:a,yAxisId:s,x:o,y:l,width:c,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,v=mr(),b=ie(P=>Pw(P,"xAxis",a,v)),g=ie(P=>Pw(P,"yAxis",s,v));if(!te(c)||c<=0||!te(u)||u<=0||!te(o)||o!==+o||!te(l)||l!==+l)return null;var _=i.verticalCoordinatesGenerator||TZ,T=i.horizontalCoordinatesGenerator||AZ,{horizontalPoints:E,verticalPoints:j}=i;if((!E||!E.length)&&typeof T=="function"){var R=m&&m.length,D=T({yAxis:g?Jt(Jt({},g),{},{ticks:R?m:g.ticks}):void 0,width:e,height:r,offset:n},R?!0:h);Uo(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(E=D)}if((!j||!j.length)&&typeof _=="function"){var S=p&&p.length,A=_({xAxis:b?Jt(Jt({},b),{},{ticks:S?p:b.ticks}):void 0,width:e,height:r,offset:n},S?!0:h);Uo(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(j=A)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(bZ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),w.createElement(_Z,ga({},i,{horizontalPoints:E})),w.createElement(EZ,ga({},i,{verticalPoints:j})),w.createElement(xZ,ga({},i,{offset:n,horizontalPoints:E,xAxis:b,yAxis:g})),w.createElement(wZ,ga({},i,{offset:n,verticalPoints:j,xAxis:b,yAxis:g})))}Km.displayName="CartesianGrid";var xC=(t,e,r,n)=>_h(t,"xAxis",e,n),wC=(t,e,r,n)=>_P(t,"xAxis",e,n),_C=(t,e,r,n)=>_h(t,"yAxis",r,n),EC=(t,e,r,n)=>_P(t,"yAxis",r,n),IZ=V([tt,xC,_C,wC,EC],(t,e,r,n,i)=>Wi(t,"xAxis")?_m(e,n,!1):_m(r,i,!1)),PZ=(t,e,r,n,i)=>i,CZ=V([GI,PZ],(t,e)=>{if(t.some(r=>r.type==="line"&&e.dataKey===r.dataKey&&e.data===r.data))return e}),kZ=V([tt,xC,_C,wC,EC,CZ,IZ,SI],(t,e,r,n,i,a,s,o)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:u}=o;if(!(a==null||e==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:h,data:m}=a,p;if(m!=null&&m.length>0?p=m:p=l?.slice(c,u+1),p!=null)return YZ({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:h,bandSize:s,displayedData:p})}}),NZ=["type","layout","connectNulls","needClip"],jZ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function TC(t,e){if(t==null)return{};var r,n,i=OZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function OZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function h_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h_(Object(r),!0).forEach(function(n){Ah(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ah(t,e,r){return(e=RZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RZ(t){var e=DZ(t,"string");return typeof e=="symbol"?e:e+""}function DZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ms(){return Ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ms.apply(null,arguments)}var MZ=t=>{var{dataKey:e,name:r,stroke:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:TS(r,e),payload:t}]};function LZ(t){var{dataKey:e,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:l}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:e,nameKey:void 0,name:TS(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:l}}}var AC=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function $Z(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],i=0;i<e;++i)n=[...n,...r];return n}var VZ=(t,e,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return AC(e,t);for(var i=Math.floor(t/n),a=t%n,s=e-t,o=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>a){o=[...r.slice(0,l),a-c];break}var u=o.length%2===0?[0,s]:[s];return[...$Z(r,i),...o,...u].map(h=>"".concat(h,"px")).join(", ")};function zZ(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=Le("recharts-line-dot",typeof t!="boolean"?t.className:"");r=w.createElement(sC,Ms({},e,{className:n}))}return r}function FZ(t,e){return t==null?!1:e?!0:t.length===1}function UZ(t){var{clipPathId:e,points:r,props:n}=t,{dot:i,dataKey:a,needClip:s}=n;if(!FZ(r,i))return null;var o=yA(i),l=Ke(n,!1),c=Ke(i,!0),u=r.map((m,p)=>{var v=Kr(Kr(Kr({key:"dot-".concat(p),r:3},l),c),{},{index:p,cx:m.x,cy:m.y,dataKey:a,value:m.value,payload:m.payload,points:r});return zZ(i,v)}),h={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):null};return w.createElement(zi,Ms({className:"recharts-line-dots",key:"dots"},h),u)}function Gm(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:i,props:a,showLabels:s}=t,{type:o,layout:l,connectNulls:c,needClip:u}=a,h=TC(a,NZ),m=Kr(Kr({},Ke(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):null,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(jS,Ms({},m,{pathRef:r})),w.createElement(UZ,{points:n,clipPathId:e,props:a}),s&&Ta.renderCallByParent(a,n))}function BZ(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function HZ(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=t,{points:s,strokeDasharray:o,isAnimationActive:l,animationBegin:c,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:v,onAnimationEnd:b,onAnimationStart:g}=r,_=i.current,T=dY(r,"recharts-line-"),[E,j]=w.useState(!1),R=w.useCallback(()=>{typeof b=="function"&&b(),j(!1)},[b]),D=w.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),S=BZ(n.current),A=a.current;return w.createElement($u,{begin:c,duration:u,isActive:l,easing:h,from:{t:0},to:{t:1},onAnimationEnd:R,onAnimationStart:D,key:T},P=>{var{t:O}=P,N=go(A,S+A),C=Math.min(N(O),S),k;if(o){var Q="".concat(o).split(/[,\s]+/gim).map(ee=>parseFloat(ee));k=VZ(C,S,Q)}else k=AC(S,C);if(_){var oe=_.length/s.length,X=O===1?s:s.map((ee,he)=>{var ye=Math.floor(he*oe);if(_[ye]){var Ue=_[ye],se=go(Ue.x,ee.x),q=go(Ue.y,ee.y);return Kr(Kr({},ee),{},{x:se(O),y:q(O)})}if(m){var J=go(p*2,ee.x),rt=go(v/2,ee.y);return Kr(Kr({},ee),{},{x:J(O),y:rt(O)})}return Kr(Kr({},ee),{},{x:ee.x,y:ee.y})});return i.current=X,w.createElement(Gm,{props:r,points:X,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})}return O>0&&S>0&&(i.current=s,a.current=C),w.createElement(Gm,{props:r,points:s,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})})}function WZ(t){var{clipPathId:e,props:r}=t,{points:n,isAnimationActive:i}=r,a=w.useRef(null),s=w.useRef(0),o=w.useRef(null),l=a.current;return i&&n&&n.length&&l!==n?w.createElement(HZ,{props:r,clipPathId:e,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:o}):w.createElement(Gm,{props:r,points:n,clipPathId:e,pathRef:o,showLabels:!0})}var qZ=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:Tr(t.payload,e)});class KZ extends w.Component{constructor(){super(...arguments),Ah(this,"id",sl("recharts-line-"))}render(){var e,{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:h,id:m,needClip:p,layout:v}=this.props;if(r)return null;var b=Le("recharts-line",a),g=ct(m)?this.id:m,{r:_=3,strokeWidth:T=2}=(e=Ke(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},E=yA(n),j=_*2+T;return w.createElement(w.Fragment,null,w.createElement(zi,{className:b},p&&w.createElement("defs",null,w.createElement(VY,{clipPathId:g,xAxisId:s,yAxisId:o}),!E&&w.createElement("clipPath",{id:"clipPath-dots-".concat(g)},w.createElement("rect",{x:c-j/2,y:l-j/2,width:u+j,height:h+j}))),w.createElement(WZ,{props:this.props,clipPathId:g}),w.createElement(LY,{direction:v==="horizontal"?"y":"x"},w.createElement(SY,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:qZ,errorBarOffset:0},this.props.children))),w.createElement(wY,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var SC={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Nl.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function GZ(t){var e=qa(t,SC),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:o,dot:l,hide:c,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:v}=e,b=TC(e,jZ),{needClip:g}=pC(p,v),{height:_,width:T,x:E,y:j}=Dy(),R=Lg(),D=mr(),S=w.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),A=ie(P=>kZ(P,p,v,D,S));return R!=="horizontal"&&R!=="vertical"?null:w.createElement(KZ,Ms({},b,{connectNulls:o,dot:l,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:u,hide:c,label:h,legendType:m,xAxisId:p,yAxisId:v,points:A,layout:R,height:_,width:T,left:E,top:j,needClip:g}))}function YZ(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:o,displayedData:l}=t;return l.map((c,u)=>{var h=Tr(c,s);return e==="horizontal"?{x:xx({axis:r,ticks:i,bandSize:o,entry:c,index:u}),y:ct(h)?null:n.scale(h),value:h,payload:c}:{x:ct(h)?null:r.scale(h),y:xx({axis:n,ticks:a,bandSize:o,entry:c,index:u}),value:h,payload:c}})}class td extends w.PureComponent{render(){return w.createElement(PY,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},w.createElement(uY,{legendPayload:MZ(this.props)}),w.createElement(lY,{fn:LZ,args:this.props}),w.createElement(GZ,this.props))}}Ah(td,"displayName","Line");Ah(td,"defaultProps",SC);function f_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function m_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f_(Object(r),!0).forEach(function(n){ZZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZZ(t,e,r){return(e=XZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JZ={xAxis:{},yAxis:{},zAxis:{}},IC=Br({name:"cartesianAxis",initialState:JZ,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=m_(m_({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:eX,removeXAxis:tX,addYAxis:rX,removeYAxis:nX,addZAxis:gee,removeZAxis:yee,updateYAxisWidth:iX}=IC.actions,aX=IC.reducer,sX=["children"],oX=["dangerouslySetInnerHTML","ticks"];function PC(t,e,r){return(e=lX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lX(t){var e=cX(t,"string");return typeof e=="symbol"?e:e+""}function cX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ym(){return Ym=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ym.apply(null,arguments)}function CC(t,e){if(t==null)return{};var r,n,i=uX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function uX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function dX(t){var e=sr(),r=w.useMemo(()=>{var{children:a}=t,s=CC(t,sX);return s},[t]),n=ie(a=>si(a,r.id)),i=r===n;return w.useEffect(()=>(e(eX(r)),()=>{e(tX(r))}),[r,e]),i?t.children:null}var hX=t=>{var{xAxisId:e,className:r}=t,n=ie(SS),i=mr(),a="xAxis",s=ie(p=>Gs(p,a,e,i)),o=ie(p=>wP(p,a,e,i)),l=ie(p=>p7(p,e)),c=ie(p=>x7(p,e));if(l==null||c==null)return null;var{dangerouslySetInnerHTML:u,ticks:h}=t,m=CC(t,oX);return w.createElement(Yi,Ym({},m,{scale:s,x:c.x,y:c.y,width:l.width,height:l.height,className:Le("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},fX=t=>{var e,r,n,i,a;return w.createElement(dX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter},w.createElement(hX,t))};class rd extends w.Component{render(){return w.createElement(fX,this.props)}}PC(rd,"displayName","XAxis");PC(rd,"defaultProps",{allowDataOverflow:yr.allowDataOverflow,allowDecimals:yr.allowDecimals,allowDuplicatedCategory:yr.allowDuplicatedCategory,height:yr.height,hide:!1,mirror:yr.mirror,orientation:yr.orientation,padding:yr.padding,reversed:yr.reversed,scale:yr.scale,tickCount:yr.tickCount,type:yr.type,xAxisId:0});var mX=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,s=0;if(e){e.forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,l=i+a,c=s+l+o+(r?n:0);return Math.round(c)}return 0},pX=["dangerouslySetInnerHTML","ticks"];function kC(t,e,r){return(e=gX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(){return Zm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zm.apply(null,arguments)}function vX(t,e){if(t==null)return{};var r,n,i=bX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function bX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function xX(t){var e=sr();return w.useEffect(()=>(e(rX(t)),()=>{e(nX(t))}),[t,e]),null}var wX=t=>{var e,{yAxisId:r,className:n,width:i,label:a}=t,s=w.useRef(null),o=w.useRef(null),l=ie(SS),c=mr(),u=sr(),h="yAxis",m=ie(E=>Gs(E,h,r,c)),p=ie(E=>_7(E,r)),v=ie(E=>w7(E,r)),b=ie(E=>wP(E,h,r,c));if(w.useLayoutEffect(()=>{var E;if(!(i!=="auto"||!p||Ry(a)||w.isValidElement(a))){var j=s.current,R=j==null||(E=j.tickRefs)===null||E===void 0?void 0:E.current,{tickSize:D,tickMargin:S}=j.props,A=mX({ticks:R,label:o.current,labelGapWithTick:5,tickSize:D,tickMargin:S});Math.round(p.width)!==Math.round(A)&&u(iX({id:r,width:A}))}},[s,s==null||(e=s.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p?.width,p,u,a,r,i]),p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=t,T=vX(t,pX);return w.createElement(Yi,Zm({},T,{ref:s,labelRef:o,scale:m,x:v.x,y:v.y,width:p.width,height:p.height,className:Le("recharts-".concat(h," ").concat(h),n),viewBox:l,ticks:b}))},_X=t=>{var e,r,n,i,a;return w.createElement(w.Fragment,null,w.createElement(xX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter}),w.createElement(wX,t))},EX={allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,hide:!1,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tickCount:vr.tickCount,type:vr.type,width:vr.width,yAxisId:0};class nd extends w.Component{render(){return w.createElement(_X,this.props)}}kC(nd,"displayName","YAxis");kC(nd,"defaultProps",EX);var TX={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fl=w;function AX(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var SX=typeof Object.is=="function"?Object.is:AX,IX=Fl.useSyncExternalStore,PX=Fl.useRef,CX=Fl.useEffect,kX=Fl.useMemo,NX=Fl.useDebugValue;TX.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=PX(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kX(function(){function l(p){if(!c){if(c=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,SX(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var c=!1,u,h,m=r===void 0?null:r;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,r,n,i]);var o=IX(t,a[0],a[1]);return CX(function(){s.hasValue=!0,s.value=o},[o]),NX(o),o};function jX(t){t()}function OX(){let t=null,e=null;return{clear(){t=null,e=null},notify(){jX(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var p_={notify(){},get:()=>[]};function RX(t,e){let r,n=p_,i=0,a=!1;function s(b){u();const g=n.subscribe(b);let _=!1;return()=>{_||(_=!0,g(),h())}}function o(){n.notify()}function l(){v.onStateChange&&v.onStateChange()}function c(){return a}function u(){i++,r||(r=t.subscribe(l),n=OX())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=p_)}function m(){a||(a=!0,u())}function p(){a&&(a=!1,h())}const v={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return v}var DX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MX=DX(),LX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",$X=LX(),VX=()=>MX||$X?w.useLayoutEffect:w.useEffect,zX=VX(),Tf=Symbol.for("react-redux-context"),Af=typeof globalThis<"u"?globalThis:{};function FX(){if(!w.createContext)return{};const t=Af[Tf]??(Af[Tf]=new Map);let e=t.get(w.createContext);return e||(e=w.createContext(null),t.set(w.createContext,e)),e}var UX=FX();function BX(t){const{children:e,context:r,serverState:n,store:i}=t,a=w.useMemo(()=>{const l=RX(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),s=w.useMemo(()=>i.getState(),[i]);zX(()=>{const{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,s]);const o=r||UX;return w.createElement(o.Provider,{value:a},e)}var HX=BX,WX=(t,e)=>e,Vy=V([WX,tt,Nq,jt,MP,oi,AK,Ht],kK),zy=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},NC=zr("mouseClick"),jC=kl();jC.startListening({actionCreator:NC,effect:(t,e)=>{var r=t.payload,n=Vy(e.getState(),zy(r));n?.activeIndex!=null&&e.dispatch(R7({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Xm=zr("mouseMove"),OC=kl();OC.startListening({actionCreator:Xm,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ty(n,n.tooltip.settings.shared),a=Vy(n,zy(r));i==="axis"&&(a?.activeIndex!=null?e.dispatch(CP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(PP()))}});function qX(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var g_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},RC=Br({name:"rootProps",initialState:g_,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:g_.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),KX=RC.reducer,{updateOptions:GX}=RC.actions,DC=Br({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:vee}=DC.actions,YX=DC.reducer,MC=zr("keyDown"),LC=zr("focus"),Fy=kl();Fy.startListening({actionCreator:MC,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Ay(i,Xa(r))),o=oi(r);if(a==="Enter"){var l=Xu(r,"axis","hover",String(i.index));e.dispatch(Fm({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:l}));return}var c=S7(r),u=c==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,m=s+h*u;if(!(o==null||m>=o.length||m<0)){var p=Xu(r,"axis","hover",String(m));e.dispatch(Fm({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});Fy.startListening({actionCreator:LC,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=Xu(r,"axis","hover",String(a));e.dispatch(Fm({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Or=zr("externalEvent"),$C=kl();$C.startListening({actionCreator:Or,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:pK(r),activeDataKey:fK(r),activeIndex:fl(r),activeLabel:VP(r),activeTooltipIndex:fl(r),isTooltipActive:gK(r)};t.payload.handler(n,t.payload.reactEvent)}}});var ZX=V([Ys],t=>t.tooltipItemPayloads),XX=V([ZX,zl,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=e(a,r);return s}}}),VC=zr("touchMove"),zC=kl();zC.startListening({actionCreator:VC,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ty(n,n.tooltip.settings.shared);if(i==="axis"){var a=Vy(n,zy({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&e.dispatch(CP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(hB),u=(s=l.getAttribute(fB))!==null&&s!==void 0?s:void 0,h=XX(e.getState(),c,u);e.dispatch(O7({activeDataKey:u,activeIndex:c,activeCoordinate:h}))}}});var QX=sS({brush:FY,cartesianAxis:aX,chartData:qK,graphicalItems:nY,layout:L9,legend:TB,options:FK,polarAxis:QG,polarOptions:YX,referenceElements:GY,rootProps:KX,tooltip:D7}),JX=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return l9({reducer:QX,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([jC.middleware,OC.middleware,Fy.middleware,$C.middleware,zC.middleware]),devTools:{serialize:{replacer:qX},name:"recharts-".concat(r)}})};function eQ(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=mr(),a=w.useRef(null);if(i)return r;a.current==null&&(a.current=JX(e,n));var s=Pg;return w.createElement(HX,{context:s,store:a.current},r)}function tQ(t){var{layout:e,width:r,height:n,margin:i}=t,a=sr(),s=mr();return w.useEffect(()=>{s||(a(R9(e)),a(D9({width:r,height:n})),a(O9(i)))},[a,s,e,r,n,i]),null}function rQ(t){var e=sr();return w.useEffect(()=>{e(GX(t))},[e,t]),null}var nQ=["children"];function iQ(t,e){if(t==null)return{};var r,n,i=aQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function aQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function id(){return id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},id.apply(null,arguments)}var sQ={width:"100%",height:"100%"},oQ=w.forwardRef((t,e)=>{var r=PS(),n=CS(),i=NS();if(!Du(r)||!Du(n))return null;var{children:a,otherAttributes:s,title:o,desc:l}=t,c,u;return typeof s.tabIndex=="number"?c=s.tabIndex:c=i?0:void 0,typeof s.role=="string"?u=s.role:u=i?"application":void 0,w.createElement(vA,id({},s,{title:o,desc:l,role:u,tabIndex:c,width:r,height:n,style:sQ,ref:e}),a)}),lQ=t=>{var{children:e}=t,r=ie(sh);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return w.createElement(vA,{width:n,height:i,x:s,y:a},e)},y_=w.forwardRef((t,e)=>{var{children:r}=t,n=iQ(t,nQ),i=mr();return i?w.createElement(lQ,null,r):w.createElement(oQ,id({ref:e},n),r)});function cQ(){var t=sr(),[e,r]=w.useState(null),n=ie(dB);return w.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;tn(a)&&a!==n&&t(M9(a))}},[e,t,n]),r}function v_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uQ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v_(Object(r),!0).forEach(function(n){dQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dQ(t,e,r){return(e=hQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:e+""}function fQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mQ=w.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:v,onTouchStart:b,style:g,width:_}=t,T=sr(),[E,j]=w.useState(null),[R,D]=w.useState(null);YK();var S=cQ(),A=w.useCallback(q=>{S(q),typeof e=="function"&&e(q),j(q),D(q)},[S,e,j,D]),P=w.useCallback(q=>{T(NC(q)),T(Or({handler:a,reactEvent:q}))},[T,a]),O=w.useCallback(q=>{T(Xm(q)),T(Or({handler:c,reactEvent:q}))},[T,c]),N=w.useCallback(q=>{T(PP()),T(Or({handler:u,reactEvent:q}))},[T,u]),C=w.useCallback(q=>{T(Xm(q)),T(Or({handler:h,reactEvent:q}))},[T,h]),k=w.useCallback(()=>{T(LC())},[T]),Q=w.useCallback(q=>{T(MC(q.key))},[T]),oe=w.useCallback(q=>{T(Or({handler:s,reactEvent:q}))},[T,s]),X=w.useCallback(q=>{T(Or({handler:o,reactEvent:q}))},[T,o]),ee=w.useCallback(q=>{T(Or({handler:l,reactEvent:q}))},[T,l]),he=w.useCallback(q=>{T(Or({handler:m,reactEvent:q}))},[T,m]),ye=w.useCallback(q=>{T(Or({handler:b,reactEvent:q}))},[T,b]),Ue=w.useCallback(q=>{T(VC(q)),T(Or({handler:v,reactEvent:q}))},[T,v]),se=w.useCallback(q=>{T(Or({handler:p,reactEvent:q}))},[T,p]);return w.createElement(WP.Provider,{value:E},w.createElement(BF.Provider,{value:R},w.createElement("div",{className:Le("recharts-wrapper",n),style:uQ({position:"relative",cursor:"default",width:_,height:i},g),onClick:P,onContextMenu:oe,onDoubleClick:X,onFocus:k,onKeyDown:Q,onMouseDown:ee,onMouseEnter:O,onMouseLeave:N,onMouseMove:C,onMouseUp:he,onTouchEnd:se,onTouchMove:Ue,onTouchStart:ye,ref:A},r)))}),pQ=["children","className","width","height","style","compact","title","desc"];function gQ(t,e){if(t==null)return{};var r,n,i=yQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vQ=w.forwardRef((t,e)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:l,desc:c}=t,u=gQ(t,pQ),h=Ke(u,!1);return o?w.createElement(y_,{otherAttributes:h,title:l,desc:c},r):w.createElement(mQ,{className:n,style:s,width:i,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},w.createElement(y_,{otherAttributes:h,title:l,desc:c,ref:e},w.createElement(ZY,null,r)))}),bQ=["width","height"];function Qm(){return Qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qm.apply(null,arguments)}function xQ(t,e){if(t==null)return{};var r,n,i=wQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function wQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _Q={top:5,right:5,bottom:5,left:5},EQ={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:_Q,reverseStackOrder:!1,syncMethod:"index"},TQ=w.forwardRef(function(e,r){var n,i=qa(e.categoricalChartProps,EQ),{width:a,height:s}=i,o=xQ(i,bQ);if(!Du(a)||!Du(s))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,categoricalChartProps:m}=e,p={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return w.createElement(eQ,{preloadedState:{options:p},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:l},w.createElement(zY,{chartData:m.data}),w.createElement(tQ,{width:a,height:s,layout:i.layout,margin:i.margin}),w.createElement(rQ,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),w.createElement(vQ,Qm({},o,{width:a,height:s,ref:r})))}),AQ=["axis"],b_=w.forwardRef((t,e)=>w.createElement(TQ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:AQ,tooltipPayloadSearcher:VK,categoricalChartProps:t,ref:e}));function SQ(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})}function IQ(t){const e=typeof t=="string"?new Date(t):t;return e.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})+" "+e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}const PQ=({images:t})=>{const[e,r]=w.useState(!1),n=t.map(s=>{let o;const l={excellent:95,good:80,fair:60,poor:30};return s.healthAnalysis?.overallHealth&&l[s.healthAnalysis.overallHealth]?o=l[s.healthAnalysis.overallHealth]:typeof s.healthAnalysis?.confidence=="number"&&(o=s.healthAnalysis.confidence<=1?s.healthAnalysis.confidence*100:s.healthAnalysis.confidence),{id:s.id,date:SQ(s.timestamp),dateTime:IQ(s.timestamp),rawDate:s.timestamp,score:typeof o=="number"?o:null,url:s.url}}).sort((s,o)=>new Date(s.rawDate).getTime()-new Date(o.rawDate).getTime()),i=n.map(s=>({dateTime:s.dateTime,score:s.score})),a=s=>{const{key:o,cx:l,cy:c}=s;return d.jsx("circle",{cx:l,cy:c,r:4,stroke:"#2A7F3E",strokeWidth:2,fill:"#fff"},o)};return d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-base font-semibold text-[#2A7F3E]",children:"Evolucin de Salud"}),d.jsx(me,{size:"sm",variant:"outline",onClick:()=>r(!0),children:"Ampliar"})]}),d.jsx("div",{className:"w-full h-48",children:d.jsx(Uw,{width:"100%",height:"100%",children:d.jsxs(b_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(Km,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(rd,{dataKey:"dateTime",tick:{fontSize:12,fill:"#888"}}),d.jsx(nd,{domain:[0,100],tick:{fontSize:12,fill:"#888"},width:32}),d.jsx(zw,{contentStyle:{fontSize:13,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(td,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:6},connectNulls:!1})]})})}),d.jsx("div",{className:"mt-4 overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-10 h-10 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})}),d.jsx(ke,{children:e&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-2",onClick:()=>r(!1),children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto p-6 relative",onClick:s=>s.stopPropagation(),children:[d.jsx(me,{size:"icon-sm",variant:"ghost",className:"absolute top-2 right-2",onClick:()=>r(!1),children:""}),d.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#2A7F3E]",children:"Evolucin de Salud (Ampliado)"}),d.jsx("div",{className:"w-full h-72 mb-6",children:d.jsx(Uw,{width:"100%",height:"100%",children:d.jsxs(b_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(Km,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(rd,{dataKey:"dateTime",tick:{fontSize:13,fill:"#888"}}),d.jsx(nd,{domain:[0,100],tick:{fontSize:13,fill:"#888"},width:36}),d.jsx(zw,{contentStyle:{fontSize:14,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(td,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:7},connectNulls:!1})]})})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-12 h-12 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})})]})})})]})},CQ=({plant:t,onAddPhoto:e})=>{const r=w.useMemo(()=>{if(!t.images||t.images.length===0)return[];const a=[...t.images].sort((u,h)=>new Date(u.timestamp).getTime()-new Date(h.timestamp).getTime()),s=[],o=30*24*60*60*1e3;let l=new Date(a[0].timestamp),c=[];return a.forEach((u,h)=>{const m=new Date(u.timestamp);if(m.getTime()-l.getTime()<=o)c.push(u);else{if(c.length>0){const p=c.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...c],startDate:new Date(c[0].timestamp),endDate:new Date(c[c.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:c.length})}l=m,c=[u]}if(h===a.length-1&&c.length>0){const p=c.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...c],startDate:new Date(c[0].timestamp),endDate:new Date(c[c.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:c.length})}}),s},[t.images]);function n(a){if(a.length<2)return null;const s=a[a.length-1]-a[0];return s>5?{icon:"",label:"Mejorando",color:"text-green-600 bg-green-50"}:s<-5?{icon:"",label:"Declive",color:"text-red-600 bg-red-50"}:{icon:"",label:"Estable",color:"text-gray-600 bg-gray-50"}}if(r.length===0)return d.jsxs(Ir,{className:"mt-6",children:[d.jsx(Rd,{children:d.jsxs(ug,{className:"flex items-center",children:[d.jsx(jk,{className:"w-5 h-5 mr-2 text-primary"}),"Evolucin de tu Planta"]})}),d.jsx(Jn,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx(Kn,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Comienza a documentar la evolucin!"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:"Agrega ms fotos a lo largo del tiempo para ver cmo progresa tu planta."}),d.jsxs(me,{onClick:e,className:"gap-2",children:[d.jsx(rp,{className:"w-4 h-4"}),"Agregar Primera Foto"]})]})})]});const i=r.map(a=>a.avgHealthScore??0);return n(i),d.jsx(Ir,{className:"mt-6",children:d.jsx(Jn,{className:"mt-4 space-y-6",children:d.jsx(PQ,{images:t.images||[]})})})},kQ=({isOpen:t,onClose:e,onPhotoAdded:r,plantName:n})=>{const[i,a]=w.useState("choose"),[s,o]=w.useState(null),[l,c]=w.useState(""),[u,h]=w.useState(null),[m,p]=w.useState(!1),v=w.useRef(null),{addToast:b}=Us(),g=w.useCallback(()=>{a("choose"),o(null),c(""),h(null),p(!1)},[]),_=w.useCallback(()=>{g(),e()},[g,e]),T=w.useCallback(k=>{const Q=new FileReader;Q.onload=oe=>{const X=oe.target?.result;o(X),a("preview")},Q.readAsDataURL(k)},[]),E=w.useCallback(()=>{v.current&&v.current.click()},[]),j=w.useCallback(()=>{E()},[E]),R=w.useCallback(k=>{const Q=k.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){h("Por favor selecciona un archivo de imagen vlido.");return}if(Q.size>5*1024*1024){h("La imagen es demasiado grande. Mximo 5MB.");return}T(Q)}},[T]),D=w.useCallback(async()=>{if(s)try{a("uploading"),p(!0),await r(s,l.trim()||void 0),a("success"),p(!1),b({type:"success",title:"Foto agregada exitosamente",message:`Nueva imagen aadida a ${n}`}),setTimeout(()=>{_()},1500)}catch(k){h(k instanceof Error?k.message:"Error al subir la imagen"),a("error"),p(!1)}},[s,l,r,n,b,_]),S=()=>(console.log("[AddPhotoModal] Renderizando botn Tomar Foto"),console.log("[AddPhotoModal] Renderizando botn Elegir de Galera"),d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[d.jsxs("div",{children:[d.jsx(Kn,{className:"w-16 h-16 text-primary mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Agregar Nueva Foto"}),d.jsxs("p",{className:"text-muted-foreground",children:["Documenta el progreso de ",d.jsx("span",{className:"font-medium",children:n})]})]}),d.jsxs("div",{className:"grid gap-4",children:[d.jsxs(me,{variant:"primary",size:"lg",onClick:j,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(Kn,{className:"w-6 h-6"}),"Tomar Foto"]}),d.jsxs(me,{variant:"secondary",size:"lg",onClick:E,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(k_,{className:"w-6 h-6"}),"Elegir de Galera"]})]}),d.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:R,className:"hidden","data-testid":"file-input"})]})),A=()=>d.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Vista Previa"}),d.jsxs("p",{className:"text-muted-foreground",children:["Revisa la imagen antes de agregar a ",n]})]}),s&&d.jsxs("div",{className:"space-y-4 pb-8 sm:pb-0",children:[d.jsx("div",{className:"aspect-video max-h-80 mx-auto rounded-lg overflow-hidden border",children:d.jsx("img",{src:s,alt:"Vista previa",className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium",children:"Nota (opcional)"}),d.jsx("textarea",{value:l,onChange:k=>c(k.target.value),placeholder:"Agrega una nota sobre esta foto...",className:"w-full p-3 border border-neutral-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:200}),d.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[l.length,"/200"]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),className:"flex-1",children:"Cambiar Imagen"}),d.jsxs(me,{variant:"primary",onClick:D,className:"flex-1 gap-2",children:[d.jsx(er,{className:"w-4 h-4"}),"Analizar y Guardar"]})]})]})]}),P=()=>d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center space-y-6 py-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx(ya,{className:"w-16 h-16 text-primary mx-auto animate-spin"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:m?"Analizando imagen...":"Subiendo foto..."}),d.jsx("p",{className:"text-muted-foreground",children:m?"La IA est evaluando la salud de tu planta":"Guardando la nueva imagen en tu jardn"})]})]}),d.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:d.jsx("div",{className:"bg-primary h-2 rounded-full animate-pulse",style:{width:"70%"}})})]}),O=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Ai,{className:"w-16 h-16 text-success-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Foto agregada!"}),d.jsxs("p",{className:"text-muted-foreground",children:["La nueva imagen ha sido aadida al progreso de ",n]})]})]}),N=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Jr,{className:"w-16 h-16 text-error-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al subir"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:u||"Hubo un problema al procesar la imagen"}),d.jsxs("div",{className:"flex gap-3 justify-center",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),children:"Intentar de Nuevo"}),d.jsx(me,{variant:"primary",onClick:_,children:"Cerrar"})]})]})]}),C=()=>{switch(i){case"choose":return S();case"preview":return A();case"uploading":return P();case"success":return O();case"error":return N();default:return S()}};return d.jsx(ke,{children:t&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:k=>{k.target===k.currentTarget&&i!=="uploading"&&_()},children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md",children:d.jsx(Ir,{children:d.jsxs(Jn,{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(np,{className:"w-5 h-5 text-primary"}),d.jsx("span",{className:"font-medium text-sm text-muted-foreground",children:"NUEVA FOTO"})]}),i!=="uploading"&&d.jsx(me,{variant:"ghost",size:"icon-sm",onClick:_,children:d.jsx(Ui,{className:"w-4 h-4"})})]}),C()]})})})})})},NQ=({plant:t})=>{const{careProfile:e,healthScore:r,lastWatered:n,dateAdded:i}=t,a=t.images?.[0]?.healthAnalysis,s=n?Math.floor((Date.now()-new Date(n).getTime())/(1e3*60*60*24)):null,o=Math.floor((Date.now()-new Date(i).getTime())/(1e3*60*60*24)),c=r>=85?{text:"Excelente",color:"text-green-500",icon:Ai,emoji:""}:r>=70?{text:"Buena",color:"text-green-400",icon:Ai,emoji:""}:r>=50?{text:"Regular",color:"text-yellow-500",icon:S_,emoji:""}:{text:"Necesita atencin",color:"text-red-500",icon:_n,emoji:""},h=(()=>{if(!s||!e?.wateringFrequency)return{text:"Sin datos",color:"text-gray-500",urgent:!1};const v=s>=e.wateringFrequency;return s>e.wateringFrequency+2?{text:"Riego urgente",color:"text-red-500",urgent:!0}:v?{text:"Necesita riego",color:"text-yellow-500",urgent:!0}:{text:"Bien hidratada",color:"text-green-500",urgent:!1}})(),m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},p={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsx(L.div,{variants:m,initial:"hidden",animate:"visible",children:d.jsxs(Ir,{variant:"glass",className:"content-spacing-sm element-spacing",children:[t.description&&d.jsx("div",{className:"mb-4",children:d.jsx("p",{className:"text-base text-neutral-700 dark:text-neutral-200 leading-relaxed",children:t.description})}),d.jsx(L.div,{variants:p,className:"w-full mb-3",children:d.jsxs("div",{className:"w-full flex items-center justify-between bg-green-100 dark:bg-green-900/30 rounded-lg px-4 py-2 mb-2",children:[d.jsxs("span",{className:"flex items-center gap-2 text-green-700 text-base font-bold",children:[d.jsx(Ai,{className:"w-5 h-5"}),r,"% ",c.text]}),d.jsxs("span",{className:"flex items-center gap-1 text-contrast-soft text-sm align-baseline",children:[d.jsx(Jc,{className:"w-4 h-4"}),"Da ",o]})]})}),d.jsxs(L.div,{variants:p,className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:Oe("flex items-center space-x-3 p-3 rounded-lg",h.urgent?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"),children:[d.jsx(gl,{className:Oe("w-5 h-5",h.color)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Riego"}),d.jsx("p",{className:Oe("font-semibold text-sm",h.color),children:h.text}),s!==null&&d.jsxs("p",{className:"text-xs text-contrast-soft",children:["Hace ",s," da",s!==1?"s":""]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[d.jsx(va,{className:"w-5 h-5 text-blue-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Luz"}),d.jsx("p",{className:"font-semibold text-sm text-blue-600 dark:text-blue-400",children:e?.sunlightRequirement||"No especificado"}),t.lightRequirements&&d.jsx("p",{className:"text-xs text-contrast-soft capitalize",children:t.lightRequirements.replace("_"," ")})]})]}),t.plantEnvironment&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[d.jsx(L_,{className:"w-5 h-5 text-purple-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Ambiente"}),d.jsx("p",{className:"font-semibold text-sm text-purple-600 dark:text-purple-400 capitalize",children:t.plantEnvironment==="ambos"?"Interior/Exterior":t.plantEnvironment})]})]}),e?.temperatureRange&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[d.jsx($_,{className:"w-5 h-5 text-orange-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Temperatura"}),d.jsxs("p",{className:"font-semibold text-sm text-orange-600 dark:text-orange-400",children:[e.temperatureRange.min,"-",e.temperatureRange.max,"C"]})]})]})]}),a?.issues&&a.issues.length>0&&d.jsx(L.div,{variants:p,className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(_n,{className:"w-5 h-5 text-red-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-red-700 dark:text-red-300 text-sm mb-1",children:[a.issues.length," problema",a.issues.length!==1?"s":""," detectado",a.issues.length!==1?"s":""]}),d.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[a.issues[0].description,a.issues.length>1&&` y ${a.issues.length-1} ms...`]})]})]})}),d.jsx("br",{}),t.personality?.communicationStyle&&d.jsx(L.div,{variants:p,className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Ho,{className:"w-5 h-5 text-green-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-green-700 dark:text-green-300 text-sm mb-1",children:[" Personalidad: ",t.personality.communicationStyle]}),t.personality.catchphrases&&t.personality.catchphrases.length>0&&d.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 italic",children:['"',t.personality.catchphrases[0],'"']})]})]})})]})})},jQ=({plant:t,onAddPhoto:e})=>{const[r,n]=w.useState("evolution"),i=t.images?.[0]?.healthAnalysis,a=i?.issues&&i.issues.length>0,s=t.images&&t.images.length>1,o=[{id:"evolution",title:"Evolucin y Progreso",icon:d.jsx(Ok,{className:"w-5 h-5"}),badge:s?`${t.images?.length||0} fotos`:"Nueva",component:d.jsx(CQ,{plant:t,onAddPhoto:e}),priority:1},{id:"health",title:"Anlisis de Salud",icon:d.jsx(Rk,{className:"w-5 h-5"}),badge:a?"Atencin":"Saludable",component:d.jsx(SF,{analysis:i}),priority:a?1:3},{id:"care",title:"Perfil de Cuidados",icon:d.jsx(Dk,{className:"w-5 h-5"}),badge:t.careProfile?"Completo":"Pendiente",component:d.jsx(EF,{plant:t}),priority:t.careProfile?2:1},...t.funFacts&&t.funFacts.length>0?[{id:"funfacts",title:"Datos Curiosos",icon:d.jsx(er,{className:"w-5 h-5"}),component:d.jsx(TF,{species:t.species,funFacts:t.funFacts}),priority:4}]:[]].filter(l=>l.id==="health"?!!i:!0).sort((l,c)=>l.priority-c.priority);return d.jsx("div",{className:"flex flex-col gap-y-1",children:o.map(l=>{const c=r===l.id,u=l.id==="health";return l.id==="care"?d.jsxs(Ir,{variant:"default",radius:"default",className:Oe("border border-[#E5E5E5] rounded-[8px] transition-all duration-200","bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(c?"":l.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none","bg-white","rounded-t-[8px]"),style:{position:c?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:l.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:l.title})]}),d.jsx(L.div,{animate:{rotate:c?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16,transition:"transform .2s"},children:d.jsx(kv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:c&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[l.component,d.jsx("div",{style:{paddingBottom:8}})]})})})]},l.id):d.jsxs(Ir,{variant:"default",radius:"default",className:Oe("border border-[#E0E0E0] rounded-[8px] transition-all duration-200",c&&u?"bg-[#FAFAFA]":"bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(c?"":l.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none",c&&u?"bg-[#FAFAFA]":"bg-white","rounded-t-[8px]"),style:{position:c?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:l.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:l.title})]}),u&&d.jsx("span",{className:"ml-2 px-[6px] py-[2px] text-xs font-medium rounded-[4px] bg-[#E0F2E9] text-[#2A7F3E] align-middle",style:{lineHeight:"1.2"},children:l.badge}),d.jsx(L.div,{animate:{rotate:c?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16},children:d.jsx(kv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:c&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[l.component,u&&d.jsx("div",{style:{paddingBottom:8}})]})})})]},l.id)})})},x_=()=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"relative h-96 w-full overflow-hidden bg-gradient-to-br from-muted/50 to-muted",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 via-background/20 to-transparent"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-8 w-64"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx(pe,{className:"h-8 w-24 rounded-full"}),d.jsx(pe,{className:"h-8 w-32 rounded-full"}),d.jsx(pe,{className:"h-8 w-20 rounded-full"})]})]})})]}),d.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-6 flex items-center",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-48"}),d.jsx(pe,{className:"h-4 w-64"})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx(pe,{className:"h-4 w-full"}),d.jsx(pe,{className:"h-4 w-5/6"}),d.jsx(pe,{className:"h-4 w-4/5"}),d.jsx(pe,{className:"h-4 w-3/4"})]}),d.jsxs("div",{className:"mt-8 space-y-4",children:[d.jsxs("div",{className:"flex items-center mb-4",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-32"}),d.jsx(pe,{className:"h-4 w-56"})]})]}),[1,2,3].map(t=>d.jsxs("div",{className:"flex items-start bg-muted/20 rounded-xl p-4",children:[d.jsx(pe,{className:"h-5 w-5 rounded-full mr-4 mt-1"}),d.jsx(pe,{className:"h-4 w-full"})]},t))]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-6",children:[d.jsx(pe,{className:"h-12 w-12 mx-auto mb-3"}),d.jsx(pe,{className:"h-6 w-32 mx-auto mb-2"}),d.jsx(pe,{className:"h-4 w-48 mx-auto"})]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-40"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>d.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[d.jsx(pe,{className:"h-8 w-8 mb-2"}),d.jsx(pe,{className:"h-4 w-16 mb-1"}),d.jsx(pe,{className:"h-5 w-24"})]},t))})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pe,{className:"h-5 w-5 mr-2"}),d.jsx(pe,{className:"h-6 w-32"})]}),d.jsx(pe,{className:"h-4 w-16"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4,5,6].map(t=>d.jsx(pe,{className:"aspect-square rounded-xl"},t))})]})]}),d.jsxs("div",{className:"fixed bottom-4 right-4 z-40 flex flex-col-reverse gap-3",children:[[1,2,3].map(t=>d.jsx(pe,{className:"h-14 w-14 rounded-full"},t)),d.jsx(pe,{className:"h-16 w-16 rounded-full"})]})]}),OQ=()=>{const{plantId:t}=tp(),e=ar(),{plant:r,loading:n,error:i}=hg(t),{addPlantImage:a}=gF(),[s,o]=w.useState(!1),l=async(c,u)=>{if(!t)throw new Error("Plant ID is required");return new Promise((h,m)=>{a({plantId:t,imageDataUrl:c,note:u},{onSuccess:()=>h(),onError:p=>m(p)})})};return n?d.jsx(x_,{}):i?d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Ocurri un Error"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:i}),d.jsx(me,{onClick:()=>window.location.reload(),className:"mt-4",children:"Intentar de nuevo"})]})}):r?d.jsx(w.Suspense,{fallback:d.jsx(x_,{}),children:d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[d.jsx(_F,{plant:r}),d.jsxs("main",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.2},children:d.jsx(NQ,{plant:r})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15,duration:.2},children:d.jsx(jQ,{plant:r,onAddPhoto:()=>o(!0)})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.2},children:d.jsx(yF,{images:r.images})})]}),d.jsxs(L.div,{className:"fixed bottom-24 right-4 z-40 flex flex-col-reverse gap-3",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.25,duration:.2},children:[d.jsxs(L.button,{onClick:()=>o(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Agregar nueva foto",children:[d.jsx(Kn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Agregar foto"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Agregar foto"})]}),d.jsxs(L.button,{onClick:()=>e(gt.toPlantChat(r.id)),className:"bg-blue-500 hover:bg-blue-600 text-white p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Chat con la planta",children:[d.jsx(yl,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Chat"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Chat"})]})]}),d.jsx(kQ,{isOpen:s,onClose:()=>o(!1),onPhotoAdded:l,plantName:r.nickname||r.name})]})}):d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-muted-foreground mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold",children:"Planta no encontrada"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo encontrar la informacin de la planta solicitada."}),d.jsx(me,{onClick:()=>e(gt.toDashboard()),className:"mt-4",children:"Volver al inicio"})]})})},RQ=({videoRef:t,canvasRef:e})=>{const[r,n]=w.useState(!1),[i,a]=w.useState(null),[s,o]=w.useState("environment"),[l,c]=w.useState(null),u=w.useRef(null),h=w.useCallback(async()=>{try{u.current&&u.current.getTracks().forEach(_=>_.stop()),c(null);const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:s,width:{ideal:1920},height:{ideal:1080},aspectRatio:16/9}});t.current&&(t.current.srcObject=g,u.current=g)}catch(g){console.error("Error accessing camera:",g),g instanceof Error?g.name==="NotAllowedError"||g.message.includes("Permission dismissed")?c("Permiso de cmara denegado. Por favor, actvalo en los ajustes de tu navegador."):c("No se pudo acceder a la cmara. Revisa los permisos y el dispositivo."):c("Ocurri un error inesperado al acceder a la cmara.")}},[s,t]);w.useEffect(()=>(h(),()=>{u.current&&u.current.getTracks().forEach(g=>g.stop())}),[h]);const m=w.useCallback(()=>{if(!t.current||!e.current)return;const g=t.current,_=e.current,T=_.getContext("2d");if(!T)return;_.width=g.videoWidth,_.height=g.videoHeight,T.drawImage(g,0,0,g.videoWidth,g.videoHeight);const E=_.toDataURL("image/jpeg",.9);a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop()),"vibrate"in navigator&&navigator.vibrate(50)},[t,e]),p=w.useCallback(()=>{a(null),n(!1),h()},[h]);return{isCapturing:r,capturedImage:i,cameraError:l,captureImage:m,retakePhoto:p,switchCamera:()=>{o(g=>g==="user"?"environment":"user")},startCamera:h,selectFromGallery:g=>{if(g&&g.type.startsWith("image/")){const _=new FileReader;_.onload=T=>{const E=T.target?.result;a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop())},_.readAsDataURL(g)}}}},DQ=({error:t,onRetry:e})=>{const r=ar();return d.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center p-6",children:d.jsx("div",{className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full mx-4",children:d.jsxs("div",{className:"flex flex-col items-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:d.jsx(Jr,{size:32,className:"text-red-400"})}),d.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Camera Access Required"}),d.jsx("p",{className:"text-gray-300 text-sm mb-6 leading-relaxed",children:t}),d.jsxs("div",{className:"space-y-3 w-full",children:[d.jsxs(me,{onClick:e,children:[d.jsx(Ni,{size:18,className:"mr-2"}),d.jsx("span",{children:"Try Again"})]}),d.jsx(me,{onClick:()=>r(gt.toDashboard()),variant:"secondary",children:"Go Back"})]}),d.jsx("div",{className:"mt-4 p-3 bg-gray-800 rounded-lg",children:d.jsxs("p",{className:"text-gray-400 text-xs",children:[d.jsx("strong",{children:"How to enable camera:"}),d.jsx("br",{}),"1. Click the camera icon in your browser's address bar",d.jsx("br",{}),'2. Select "Allow" for camera access',d.jsx("br",{}),'3. Refresh the page or tap "Try Again"']})})]})})})},MQ=({image:t,isAnalyzing:e,onRetake:r,onAnalyze:n})=>d.jsxs(d.Fragment,{children:[d.jsx(L.img,{src:t,alt:"Captured plant",className:"absolute inset-0 w-full h-full object-cover z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[d.jsx(me,{onClick:r,variant:"secondary",disabled:e,children:"Retake"}),d.jsx(me,{onClick:n,disabled:e,children:e?d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Analyzing..."})]}):"Add Plant"})]}),e&&d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"AI is identifying your plant and creating a care profile..."})]})]}),LQ=({videoRef:t,canvasRef:e,flashEnabled:r,onCapture:n,onSwitchCamera:i,onToggleFlash:a,onSelectFromGallery:s})=>{const o=ar();return d.jsxs(d.Fragment,{children:[d.jsx(L.video,{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),d.jsx("canvas",{ref:e,className:"hidden"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 safe-area-top z-20",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(me,{onClick:()=>o(gt.toDashboard()),variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(Ui,{size:20})}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(me,{onClick:a,variant:"ghost",size:"icon",className:`rounded-full ${r?"bg-yellow-500 text-black hover:bg-yellow-600":"bg-black/50"}`,children:r?d.jsx(er,{size:20}):d.jsx(Mk,{size:20})}),d.jsx(me,{onClick:i,variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(Lk,{size:20})})]})]})}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[d.jsx(me,{onClick:s,size:"icon",variant:"ghost",className:"w-14 h-14 rounded-full bg-black/50",children:d.jsx(np,{size:24})}),d.jsx(L.button,{onClick:n,className:"w-20 h-20 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center ios-button",whileHover:{scale:1.05},whileTap:{scale:.95},children:d.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center",children:d.jsx(Kn,{size:24,className:"text-gray-600"})})}),d.jsx("div",{className:"w-14 h-14"})]}),d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"Position your plant in the frame and tap to capture, or select from gallery"})]}),d.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:d.jsx("div",{className:"w-64 h-64 border-2 border-white/50 rounded-2xl"})})]})},$Q=()=>{const t=ar(),{createPlant:e,isCreatingPlant:r}=Od(),n=w.useRef(null),i=w.useRef(null),{isCapturing:a,capturedImage:s,cameraError:o,captureImage:l,retakePhoto:c,switchCamera:u,startCamera:h,selectFromGallery:m}=RQ({videoRef:n,canvasRef:i}),[p,v]=w.useState(!1),b=w.useRef(null),g=()=>{if(!s)return;const E="Interior",j=new Promise((R,D)=>{e({imageDataUrl:s,location:E},{onSuccess:S=>{S?.id?t(gt.toPlantDetail(S.id)):t(gt.toDashboard()),R(S)},onError:S=>{D(S)}})});vT.promise(j,{loading:"Analizando imagen con IA...",success:R=>`Planta "${R.name}" creada con xito!`,error:R=>`Error: ${R.message}`})},_=()=>v(E=>!E),T=E=>{const j=E.target.files?.[0];j&&m(j)};return d.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[d.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:T,className:"hidden",id:"gallery-input"}),d.jsx(ke,{mode:"wait",children:o?d.jsx(DQ,{error:o,onRetry:h},"error"):a?d.jsx(MQ,{image:s,isAnalyzing:r,onRetake:c,onAnalyze:g},"preview"):d.jsx(LQ,{videoRef:n,canvasRef:i,flashEnabled:p,onCapture:l,onSwitchCamera:u,onToggleFlash:_,onSelectFromGallery:()=>b.current?.click()},"capture")})]})},VQ=()=>{const{plantId:t}=tp(),e=ar(),{user:r}=kn(),n=Wn(c=>c.getPlantById(t||"")),i=Wn(c=>c.addChatMessage),a=Wn(c=>c.operationStates.chat.isLoading),s=w.useMemo(()=>{if(!n||!n.chatHistory||n.chatHistory.length===0)return!1;const c=n.chatHistory[n.chatHistory.length-1];return a&&c.sender==="user"},[n,a]);return{plant:n,isTyping:s,handleSendMessage:async c=>{if(!(!t||!r||!c.trim()))try{await i(t,c.trim(),r.id)}catch(u){console.error("Failed to send message:",u)}},handleGoBack:()=>{e(`/plant/${t}`)},currentUser:r}},zQ=({plant:t})=>{const e=ar(),r=()=>{const n=t.healthScore/100,i=t.lastWatered?new Date(t.lastWatered).getTime():0,a=i?Math.max(0,1-(Date.now()-i)/(t.careProfile.wateringFrequency*24*60*60*1e3)):0,s=n*.6+a*.4;return s>.8?"radiante":s>.6?"feliz":s>.4?"estable":"necesitada de atencin"};return d.jsx("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:d.jsxs("div",{className:"flex items-center gap-2 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>e(gt.toPlantDetail(t.id)),className:"btn btn-ghost btn-circle",children:d.jsx(ip,{size:20})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h1",{className:"font-bold text-foreground truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 capitalize",children:["Se siente ",r()]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400",children:[d.jsx(P_,{className:"w-4 h-4"}),d.jsxs("span",{children:[t.healthScore,"%"]})]})]})})};var FQ={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},UQ=function(e,r,n){var i,a=FQ[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"en "+i:"hace "+i:i},BQ={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},HQ={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},WQ={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qQ={date:xs({formats:BQ,defaultWidth:"full"}),time:xs({formats:HQ,defaultWidth:"full"}),dateTime:xs({formats:WQ,defaultWidth:"full"})},KQ={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},GQ={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},YQ=function(e,r,n,i){return r.getUTCHours()!==1?GQ[e]:KQ[e]},ZQ={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},XQ={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},QQ={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},JQ={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},eJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},tJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},rJ=function(e,r){var n=Number(e);return n+""},nJ={ordinalNumber:rJ,era:cn({values:ZQ,defaultWidth:"wide"}),quarter:cn({values:XQ,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:cn({values:QQ,defaultWidth:"wide"}),day:cn({values:JQ,defaultWidth:"wide"}),dayPeriod:cn({values:eJ,defaultWidth:"wide",formattingValues:tJ,defaultFormattingWidth:"wide"})},iJ=/^(\d+)()?/i,aJ=/\d+/i,sJ={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},oJ={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},lJ={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},cJ={any:[/1/i,/2/i,/3/i,/4/i]},uJ={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},dJ={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},hJ={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},fJ={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},mJ={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},pJ={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},gJ={ordinalNumber:lA({matchPattern:iJ,parsePattern:aJ,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:sJ,defaultMatchWidth:"wide",parsePatterns:oJ,defaultParseWidth:"any"}),quarter:un({matchPatterns:lJ,defaultMatchWidth:"wide",parsePatterns:cJ,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:uJ,defaultMatchWidth:"wide",parsePatterns:dJ,defaultParseWidth:"any"}),day:un({matchPatterns:hJ,defaultMatchWidth:"wide",parsePatterns:fJ,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:mJ,defaultMatchWidth:"any",parsePatterns:pJ,defaultParseWidth:"any"})},FC={code:"es",formatDistance:UQ,formatLong:qQ,formatRelative:YQ,localize:nJ,match:gJ,options:{weekStartsOn:1,firstWeekContainsDate:1}};const yJ=t=>{switch(t){case"happy":case"excited":return"";case"grateful":return"";case"worried":return"";case"sad":return"";default:return""}},vJ=({message:t})=>{const e=t.sender==="user",r=n=>{Cd.success("Gracias por tu feedback!",n?"Nos alegra que la respuesta te haya sido til.":"Trabajaremos para mejorar las respuestas.")};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2",e?"justify-end":"justify-start"),children:[!e&&d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:yJ(t.emotion)}),d.jsxs("div",{className:Oe("max-w-xs rounded-2xl px-4 py-2 sm:max-w-sm md:max-w-md shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm":"rounded-bl-lg bg-contrast-surface text-contrast-medium border border-contrast","rounded-[12px]"),children:[d.jsx("p",{className:"text-sm",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((n,i)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[n.type==="warning"&&" ",n.type==="tip"&&" ",n.type==="recommendation"&&" ",n.type==="observation"&&" ",n.title]}),d.jsx("div",{children:n.description}),n.affectedPlants&&n.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",n.affectedPlants.join(", ")]})]},i))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((n,i)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:n.action}),n.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",n.priority]}),n.plantIds&&n.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",n.plantIds.join(", ")]})]},i))})]}),d.jsx("p",{className:Oe("mt-1 text-xs",e?"text-white/80":"text-contrast-soft","text-[#888] text-[12px]"),children:uA(new Date(t.timestamp),{addSuffix:!0,locale:FC})}),!e&&d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{"aria-label":"Respuesta til",className:"text-green-600 hover:text-green-800 text-lg focus:outline-none",onClick:()=>r(!0),children:""}),d.jsx("button",{"aria-label":"Respuesta no til",className:"text-red-500 hover:text-red-700 text-lg focus:outline-none",onClick:()=>r(!1),children:""})]})]})]})},bJ=({messages:t})=>d.jsx("div",{className:"space-y-4",children:t.map(e=>d.jsx(vJ,{message:e},e.id))}),xJ=["Cmo te sientes hoy?","Necesitas agua?","Cuntame un dato curioso sobre ti"],wJ=({onSendMessage:t,isTyping:e})=>{const[r,n]=w.useState(""),i=w.useRef(null),a=()=>{const o=i.current?.value.trim();o&&(t(o),i.current&&(i.current.value=""))},s=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a())};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Dd,{type:"text",ref:i,onKeyDown:s,placeholder:"Escribe un mensaje...",className:"pr-12",disabled:e}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(z_,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:a,disabled:!r.trim()||e,size:"icon",children:d.jsx(F_,{size:20})})]}),d.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:xJ.map(o=>d.jsx(me,{onClick:()=>n(o),disabled:e,variant:"secondary",size:"sm",children:o},o))})]})})},UC=()=>{const t={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:""}),d.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})},_J=({plantName:t})=>d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center text-center p-8",children:[d.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-primary/10 mb-4",children:d.jsx(er,{className:"h-8 w-8 text-primary"})}),d.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Inicia una conversacin"}),d.jsxs("p",{className:"text-muted-foreground max-w-xs",children:[t," est esperando para charlar. Pregntale sobre sus cuidados o simplemente saluda!"]})]}),EJ=()=>{const{plantId:t}=tp(),e=ar(),{loading:r,error:n}=hg(t),{plant:i,isTyping:a,handleSendMessage:s}=VQ(),o=w.useRef(null);return w.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[i?.chatHistory,a]),r?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(ya,{className:"w-12 h-12 animate-spin text-green-500"}),d.jsx("p",{className:"mt-4 text-lg",children:"Cargando chat..."})]}):n?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-red-500",children:[d.jsxs("p",{className:"mb-4",children:["Error: ",n]}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]}):i?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(zQ,{plant:i}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(ke,{children:i.chatHistory.length===0?d.jsx(_J,{plantName:i.nickname||i.name}):d.jsx(bJ,{messages:i.chatHistory,plantNickname:i.nickname||i.name})}),a&&d.jsx(UC,{}),d.jsx("div",{ref:o})]}),d.jsx(wJ,{onSendMessage:s,isTyping:a})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx("p",{className:"mb-4",children:"Planta no encontrada."}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]})};class TJ{constructor(e,r){Nr(this,"supabase");Nr(this,"cache");this.supabase=e,this.cache=r}async sendMessage(e,r,n){try{const{data:{session:i},error:a}=await this.supabase.auth.getSession();if(a||!i?.access_token)throw console.error("User session not available:",a),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:s,error:o}=await this.supabase.functions.invoke("garden-ai-chat",{body:{message:e,sessionId:r,userId:n},headers:{Authorization:`Bearer ${i.access_token}`}});if(o)throw new Error(`Garden AI service error: ${o.message}`);if(!s)throw new Error("No data received from garden AI service");return s}catch(i){throw console.error("Error in garden chat service:",i),i}}async sendMessageToGardenAI(e,r,n){try{const i=await this.buildGardenContext(r),a=n.map(v=>({role:v.sender==="user"?"user":"assistant",content:v.content})),s="amigable, motivador, experto, clido, y con un toque de humor ligero",{data:{session:o},error:l}=await this.supabase.auth.getSession();if(l||!o?.access_token)throw console.error("User session not available:",l),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:c,error:u}=await this.supabase.functions.invoke("garden-ai-chat",{body:{userMessage:e,gardenContext:i,conversationHistory:a,tonePersona:s},headers:{Authorization:`Bearer ${o.access_token}`}});if(u)throw new Error(`Garden AI service error: ${u.message}`);if(!c)throw new Error("No data received from garden AI service");const h=typeof c=="string"?JSON.parse(c):c,m=(h.content||"").toLowerCase();return(!h.content||m.includes("no s")||m.includes("no tengo informacin")||m.includes("no puedo ayudarte")||m.length<30)&&Cd.warning("Respuesta genrica","La respuesta de la IA fue muy genrica o poco til. Intenta preguntar de otra forma o proporciona ms detalles."),{content:h.content||"Lo siento, no pude procesar tu mensaje.",insights:h.insights||[],suggestedActions:h.suggestedActions||[]}}catch(i){throw i}}async verifyFunctionAvailability(){try{const e={userMessage:"ping",gardenContext:{totalPlants:0,plantsData:[],averageHealthScore:0,commonIssues:[],careScheduleSummary:{needsWatering:[],needsFertilizing:[],healthConcerns:[]},environmentalFactors:{locations:["test"]}},conversationHistory:[]},{data:{session:r},error:n}=await this.supabase.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesin nuevamente.");const{data:i,error:a}=await this.supabase.functions.invoke("garden-ai-chat",{body:e,headers:{Authorization:`Bearer ${r.access_token}`}});return a?a.message.includes("404")||a.message.includes("not found")?{available:!1,error:"La funcin de chat de jardn no est disponible en este momento"}:{available:!1,error:a.message}:i&&typeof i.content=="string"?{available:!0}:{available:!1,error:"Function returned unexpected response format"}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Error desconocido"}}}async getGardenHealthSummary(e){try{const r=this.cache.getGardenSummary(e);if(r)return r;const n=await this.buildGardenContext(e),i=n.plantsData.filter(o=>o.healthScore>=80).length,a=n.careScheduleSummary.needsWatering.length+n.careScheduleSummary.healthConcerns.length,s={totalPlants:n.totalPlants,averageHealth:n.averageHealthScore,urgentActions:a,healthyPlants:i};return this.cache.setGardenSummary(e,s),s}catch(r){throw console.error("Error getting garden health summary:",r),r}}async getSuggestedQuestions(e){try{const r=await this.buildGardenContext(e),n=[];return r.totalPlants===0?(n.push("Cmo agrego mi primera planta?"),n.push("Qu tipo de planta me recomiendas para empezar?"),n):(n.push("Cuntas plantas tengo y cmo estn?"),n.push("Cul es la salud promedio de mi jardn?"),r.careScheduleSummary.healthConcerns.length>0&&(n.push("Qu plantas necesitan atencin especial?"),n.push("Qu problemas de salud hay en mi jardn?")),r.plantsData.some(i=>i.healthScore>=80)&&n.push("Cules de mis plantas estn ms sanas?"),r.environmentalFactors.locations.length>1&&n.push("Cmo afecta la ubicacin a mis plantas?"),r.totalPlants>5&&n.push("Cmo organizar mejor mi espacio de plantas?"),r.plantsData.some(i=>"lastFertilized"in i&&!!i.lastFertilized)&&n.push("Cundo debo fertilizar mis plantas?"),new Set(r.plantsData.map(i=>i.species)).size>1&&n.push("Qu especie de planta es la ms resistente en mi jardn?"),n.slice(0,6))}catch(r){return console.error("Error getting suggested questions:",r),["Cuntas plantas tengo y cmo estn?","Cul es la salud promedio de mi jardn?"]}}async refreshGardenData(e){try{this.invalidateCache(e),await this.buildGardenContext(e),console.log("[GardenChatService] Garden data refreshed for user:",e)}catch(r){throw console.error("Error refreshing garden data:",r),r}}async buildGardenContext(e){try{const r=this.cache.getGardenContext(e);if(r)return r;const{data:n,error:i}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          last_fertilized,
          care_profile,
          date_added
        `).eq("user_id",e).order("created_at",{ascending:!1});if(i)throw i;const a=n.map(v=>({id:v.id,name:v.name,nickname:v.nickname||void 0,species:v.species,location:v.location,plantEnvironment:v.plant_environment,lightRequirements:v.light_requirements,healthScore:v.health_score||85,lastWatered:v.last_watered?new Date(v.last_watered):void 0,wateringFrequency:v.care_profile?.wateringFrequency})),s=a.length,o=s>0?Math.round(a.reduce((v,b)=>v+b.healthScore,0)/s):0,l=new Date,c=[],u=[],h=[];a.forEach(v=>{if(v.lastWatered&&v.wateringFrequency){const b=new Date(v.lastWatered),g=new Date(b);g.setDate(b.getDate()+v.wateringFrequency),l>g&&c.push(v.id)}v.healthScore<70&&h.push(v.id)});const m=[...new Set(a.map(v=>v.location))],p={totalPlants:s,plantsData:a,averageHealthScore:o,commonIssues:[],careScheduleSummary:{needsWatering:c,needsFertilizing:u,healthConcerns:h},environmentalFactors:{locations:m,lightConditions:[],humidityNeeds:[]}};return this.cache.setGardenContext(e,p),p}catch(r){throw console.error("Error building garden context:",r),r}}invalidateCache(e){this.cache.invalidateCache(e),console.log("Cache invalidated for user:",e)}}const ca=new TJ(Et,Fo),AJ=()=>{const{user:t}=kn(),[e,r]=w.useState([]),[n,i]=w.useState(!1),[a,s]=w.useState(!1),[o,l]=w.useState(null),[c,u]=w.useState(null),[h,m]=w.useState([]),[p,v]=w.useState("");w.useEffect(()=>{t?.id&&b()},[t?.id]);const b=async()=>{if(t?.id){i(!0);try{const[D,S]=await Promise.all([ca.getGardenHealthSummary(t.id),ca.getSuggestedQuestions(t.id)]);if(u(D),m(S),e.length===0&&D.totalPlants>0){const A={id:`welcome-${Date.now()}`,sender:"ai",content:`Hola! Soy tu asistente de jardn  

Veo que tienes ${D.totalPlants} plantas en tu jardn con una salud promedio de ${D.averageHealth}%. ${D.urgentActions>0?`Hay ${D.urgentActions} acciones que podran necesitar tu atencin.`:"Todo parece estar en buen estado!"}

En qu puedo ayudarte hoy con tu jardn?`,timestamp:new Date,context:{queryType:"general"}};r([A])}}catch(D){console.error("Error loading initial garden data:",D),l("Error al cargar la informacin del jardn")}finally{i(!1)}}},g=w.useCallback(async D=>{if(!t?.id||!D.trim()||a)return;const S=await ca.verifyFunctionAvailability();if(!S.available){l(` El chat de jardn no est disponible: ${S.error}`);return}const A={id:`user-${Date.now()}`,sender:"user",content:D.trim(),timestamp:new Date};v(D.trim()),r(P=>[...P,A]),s(!0),l(null);try{const P=await ca.sendMessageToGardenAI(D.trim(),t.id,e),O={id:`ai-${Date.now()}`,sender:"ai",content:P.content,timestamp:new Date,context:{plantsAnalyzed:SJ(P),queryType:IJ(D),insights:P.insights||[],suggestedActions:P.suggestedActions||[]}};if(r(N=>[...N,O]),P.suggestedActions&&P.suggestedActions.length>0){const N=await ca.getGardenHealthSummary(t.id);u(N)}}catch(P){console.error("Error sending message to garden AI:",P);let O="Error al enviar el mensaje. Por favor intenta de nuevo.";P instanceof Error&&(P.message.includes("funcin de chat de jardn no est disponible")?O=" El chat de jardn est temporalmente no disponible. Estamos trabajando para solucionarlo.":P.message.includes("CORS")?O=" Error de configuracin. Por favor contacta al administrador.":P.message.includes("garden-ai-chat no existe")&&(O=" Servicio no configurado. El chat de jardn necesita configuracin adicional.")),l(O),r(N=>N.slice(0,-1))}finally{s(!1)}},[t?.id,e,a]),_=w.useCallback(async()=>{p&&await g(p)},[p,g]),T=w.useCallback(()=>{r([]),l(null),t?.id&&b()},[t?.id]),E=w.useCallback(async()=>{if(t?.id){i(!0);try{await ca.refreshGardenData(t.id),await b(),console.log("[useGardenChat] Garden data refreshed successfully")}catch(D){console.error("Error refreshing garden data:",D),l("Error al actualizar los datos del jardn")}finally{i(!1)}}},[t?.id]),j=w.useMemo(()=>n,[n]),R=w.useMemo(()=>{},[t?.id,c]);return{messages:e,isLoading:j,isTyping:a,error:o,gardenSummary:c,suggestedQuestions:h,sendMessage:g,clearMessages:T,retryLastMessage:_,refreshGardenData:E,cacheStats:R}};function SJ(t){const e=[];return t.insights&&t.insights.forEach(r=>{r.affectedPlants&&e.push(...r.affectedPlants)}),t.suggestedActions&&t.suggestedActions.forEach(r=>{r.plantIds&&e.push(...r.plantIds)}),[...new Set(e)]}function IJ(t){const e=t.toLowerCase();return e.includes("salud")||e.includes("problema")||e.includes("enferm")?"health_analysis":e.includes("comparar")||e.includes("diferencia")||e.includes("mejor")?"care_comparison":e.includes("hongo")||e.includes("plaga")||e.includes("prevenir")?"disease_prevention":e.includes("crecimiento")||e.includes("progreso")||e.includes("tiempo")?"growth_tracking":"general"}const PJ=({onClose:t})=>{const[e,r]=w.useState([{name:"garden-ai-chat",available:!1}]),[n,i]=w.useState(!1),a=async()=>{i(!0);const l=[],c=await ca.verifyFunctionAvailability();l.push({name:"garden-ai-chat",available:c.available,error:c.error,lastChecked:new Date}),r(l),i(!1)};w.useEffect(()=>{a()},[]);const s=l=>l.available?d.jsx(Ai,{className:"w-5 h-5 text-green-500"}):d.jsx(Jr,{className:"w-5 h-5 text-red-500"}),o=l=>l.available?"Disponible":"No disponible";return d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),className:"w-full max-w-md",children:d.jsxs(Ir,{className:"p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(U_,{className:"w-6 h-6 text-blue-500"}),d.jsx("h3",{className:"text-lg font-semibold",children:"Diagnstico del Sistema"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Estado de Funciones Edge"}),d.jsx("div",{className:"space-y-3",children:e.map(l=>d.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[s(l),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-sm",children:l.name}),d.jsx("p",{className:"text-xs text-muted-foreground",children:o(l)})]})]}),l.error&&d.jsxs("div",{className:"text-xs text-red-500 max-w-32 text-right",children:[l.error.substring(0,50),"..."]})]},l.name))})]}),e.some(l=>!l.available)&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(Jr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Servicios no disponibles"}),d.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Algunos servicios del chat de jardn no estn funcionando. Verifica que las funciones Edge estn desplegadas en Supabase."})]})]})}),d.jsxs("div",{className:"flex gap-3 pt-3",children:[d.jsxs(me,{onClick:a,disabled:n,variant:"outline",size:"sm",className:"flex-1 gap-2",children:[d.jsx(Ni,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Verificar Nuevamente"]}),d.jsx(me,{onClick:t,variant:"secondary",size:"sm",className:"flex-1",children:"Cerrar"})]})]})]})})})},Sf=({gardenSummary:t,onClearChat:e,onRefresh:r,isRefreshing:n=!1})=>{const i=ar(),[a,s]=w.useState(!1),o=c=>c>=80?"text-green-500":c>=60?"text-green-400":"text-red-500",l=c=>c>=80?"Excelente":c>=60?"Buena":"Necesita atencin";return d.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[d.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>i(gt.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:d.jsx(ip,{size:20})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:d.jsx(ap,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardn"}),t&&d.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(D_,{size:12}),t.totalPlants," plantas"]}),d.jsx("span",{className:`font-medium ${o(t.averageHealth)} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:l(t.averageHealth)}),t.urgentActions>0&&d.jsxs(L.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[t.urgentActions," acciones"]})]})]})]})}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnstico del sistema",children:d.jsx(U_,{size:18})}),r&&d.jsx("button",{onClick:r,disabled:n,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardn",children:d.jsx(L.div,{animate:n?{rotate:360}:{},transition:n?{duration:1,repeat:1/0,ease:"linear"}:{},children:d.jsx(Ni,{size:18})})}),d.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:d.jsx(M_,{size:20})})]})]}),d.jsx(ke,{children:a&&d.jsx(PJ,{onClose:()=>s(!1)})})]})},CJ=({message:t})=>{const e=t.sender==="user",r=()=>{if(!t.context?.queryType)return d.jsx(Ho,{size:16});switch(t.context.queryType){case"health_analysis":return d.jsx(_n,{size:16});case"care_comparison":return d.jsx(If,{size:16});case"disease_prevention":return d.jsx(Vk,{size:16});case"growth_tracking":return d.jsx(V_,{size:16});default:return d.jsx(Ho,{size:16})}},n=()=>{if(e)return"text-primary-foreground/70";if(!t.context?.queryType)return"text-green-500";switch(t.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2 max-w-[85%]",e?"justify-end ml-auto":"justify-start"),children:[!e&&d.jsx(L.div,{className:Oe("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx("div",{className:n(),children:r()})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:Oe("rounded-2xl px-4 py-3 break-words shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[d.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((i,a)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[i.type==="warning"&&" ",i.type==="tip"&&" ",i.type==="recommendation"&&" ",i.type==="observation"&&" ",i.title]}),d.jsx("div",{children:i.description}),i.affectedPlants&&i.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",i.affectedPlants.join(", ")]})]},a))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((i,a)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:i.action}),i.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",i.priority]}),i.plantIds&&i.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",i.plantIds.join(", ")]})]},a))})]}),!e&&t.context?.plantsAnalyzed&&t.context.plantsAnalyzed.length>0&&d.jsxs(L.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[d.jsx(If,{size:12}),d.jsxs("span",{children:["Analiz ",t.context.plantsAnalyzed.length," planta(s)"]})]}),d.jsx("div",{className:Oe("mt-2 text-xs",e?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:uA(new Date(t.timestamp),{addSuffix:!0,locale:FC})})]})}),e&&d.jsx(L.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx($k,{size:16,className:"text-primary"})})]})},kJ=({onSendMessage:t,isTyping:e,suggestedQuestions:r,isLoading:n=!1})=>{const[i,a]=w.useState(""),[s,o]=w.useState(!0),l=w.useRef(null),c=async()=>{if(e)return;const p=l.current?.value.trim();p&&(o(!1),l.current&&(l.current.value=""),await t(p))},u=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),c())},h=async p=>{a(""),o(!1),await t(p)},m=()=>{r.length>0&&!i&&o(!0)};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsx(ke,{children:s&&r.length>0&&!n&&d.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[d.jsx(er,{size:12}),d.jsx("span",{children:"Preguntas sugeridas"})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((p,v)=>d.jsx(L.button,{onClick:()=>h(p),disabled:e,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:v*.1},whileHover:{scale:1.02},whileTap:{scale:.98},children:p},p))})]})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Dd,{type:"text",ref:l,onKeyDown:u,onFocus:m,placeholder:"Pregntame sobre tu jardn...",className:"pr-12",disabled:e||n}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(z_,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:c,disabled:!i.trim()||e||n,size:"icon",className:"shrink-0",children:e?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:20})}):d.jsx(F_,{size:20})})]}),n&&d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:12})}),d.jsx("span",{children:"Analizando tu jardn..."})]})]})})},NJ={plants:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[d.jsx(L.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),d.jsx(L.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:d.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),d.jsx(L.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:d.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),d.jsx(L.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:d.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),d.jsx(L.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),d.jsx(L.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),d.jsx(L.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),d.jsx(L.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[d.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),d.jsx(L.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),d.jsx(L.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),d.jsx(L.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsxs(L.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[d.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),d.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),d.jsxs(L.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[d.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),d.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},jJ=({icon:t,title:e,description:r,action:n,illustration:i="plants",className:a})=>d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:Oe("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",a),children:[d.jsx(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:t||NJ[i]}),d.jsx(L.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:e}),d.jsx(L.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),n&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:d.jsx(me,{onClick:n.onClick,variant:"primary",size:"lg",className:"animate-glow",children:n.label})})]}),OJ=()=>{const t=ar(),e=Wn(p=>p.plants),{messages:r,isLoading:n,isTyping:i,error:a,gardenSummary:s,suggestedQuestions:o,sendMessage:l,clearMessages:c,retryLastMessage:u,refreshGardenData:h}=AJ(),m=w.useRef(null);return w.useEffect(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r,i]),a&&!s?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Sf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexin"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:a}),d.jsxs(me,{onClick:h,variant:"primary",children:[d.jsx(Ni,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]}):s?.totalPlants===0?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Sf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx(jJ,{illustration:"plants",title:"Tu jardn est vaco",description:"Agrega algunas plantas a tu jardn para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>t(gt.toCamera())}})})]}):d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Sf,{gardenSummary:s,onClearChat:c,onRefresh:h,isRefreshing:n&&r.length>0}),r.length===0&&e.length>0&&d.jsxs("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:[d.jsx("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Chats individuales con tus plantas:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.slice(0,4).map(p=>d.jsx(Ir,{variant:"glass",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary-300 dark:hover:border-primary-600",onClick:()=>t(gt.toPlantChat(p.id)),children:d.jsx(Jn,{className:"p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:d.jsx(ap,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium truncate",children:p.nickname||p.name}),d.jsx("p",{className:"text-xs text-neutral-500 truncate",children:p.species})]}),d.jsx(yl,{className:"w-4 h-4 text-neutral-400"})]})})},p.id)),e.length>4&&d.jsx(Ir,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer",onClick:()=>t(gt.toDashboard()),children:d.jsx(Jn,{className:"p-3 flex items-center justify-center",children:d.jsxs("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["+",e.length-4," ms"]})})})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsxs("div",{className:"p-4 space-y-4 max-w-4xl mx-auto",children:[d.jsx(ke,{children:r.map(p=>d.jsx(CJ,{message:p},p.id))}),i&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:d.jsx(UC,{})}),a&&r.length>0&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-center",children:d.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 max-w-sm",children:[d.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300 text-sm",children:[d.jsx(Jr,{size:16}),d.jsx("span",{children:a})]}),d.jsxs(me,{onClick:u,size:"sm",variant:"outline",className:"mt-2 w-full",children:[d.jsx(Ni,{size:14,className:"mr-1"}),"Reintentar"]})]})}),d.jsx("div",{ref:m})]}),!1]}),d.jsx(kJ,{onSendMessage:l,isTyping:i,suggestedQuestions:o,isLoading:n})]})},RJ=w.lazy(()=>ep(()=>import("./Settings-auvpcn4G.js"),__vite__mapDeps([0,1,2,3,4,5]))),DJ=w.lazy(()=>ep(()=>import("./Auth-BeOrtEuB.js"),__vite__mapDeps([6,1,2,4,5,3]))),MJ=new E_({defaultOptions:{queries:{staleTime:gi.QUERY.STALE_TIME.MEDIUM,gcTime:gi.QUERY.GC_TIME.MEDIUM,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:gi.QUERY.RETRY.COUNT,retryDelay:t=>Math.min(gi.QUERY.RETRY.DELAY*2**t,3e4)},mutations:{retry:gi.QUERY.RETRY.COUNT,retryDelay:gi.QUERY.RETRY.DELAY}}}),w_=({message:t})=>d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(sd,{className:"w-12 h-12 text-green-500 animate-bounce mb-4"}),d.jsx("p",{className:"text-lg text-muted-foreground",children:t})]}),LJ=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/":window.location.pathname.startsWith("/plantitas-app")?"/plantitas-app/":"/",$J=()=>{const t=KL();if(S4(),w.useEffect(()=>{console.log("[APP] useEffect running...");try{const r=I4();return()=>{console.log("[APP] Cleanup running..."),r()}}catch(r){throw Jp("APP_INITIALIZATION",r),r}},[]),!t.initialized){const r=t.loading?t.progress.message:t.error||"Inicializando...";return d.jsx(w_,{message:r})}const e=()=>d.jsx(Iv,{children:d.jsxs(sn,{path:"/",element:d.jsx(G3,{}),children:[d.jsx(sn,{index:!0,element:d.jsx(yz,{})}),d.jsx(sn,{path:"camera",element:d.jsx($Q,{})}),d.jsx(sn,{path:"settings",element:d.jsx(RJ,{})}),d.jsx(sn,{path:"garden-chat",element:d.jsx(OJ,{})}),d.jsx(sn,{path:"plant/:plantId",element:d.jsx(OQ,{})}),d.jsx(sn,{path:"plant/:plantId/chat",element:d.jsx(EJ,{})}),d.jsx(sn,{path:"*",element:d.jsx(Vh,{to:wt.dashboard,replace:!0})})]})});return d.jsx(T_,{client:MJ,children:d.jsx(T4,{children:d.jsx(Y3,{children:d.jsxs(vk,{basename:LJ(),future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[d.jsx(x4,{position:"top-center",richColors:!0}),d.jsx(k4,{}),d.jsx(w.Suspense,{fallback:d.jsx(w_,{message:"Cargando..."}),children:d.jsxs(Iv,{children:[d.jsx(sn,{path:wt.auth,element:t.user?d.jsx(Vh,{to:wt.dashboard,replace:!0}):d.jsx(DJ,{})}),d.jsx(sn,{path:"/*",element:t.user?d.jsx(e,{}):d.jsx(Vh,{to:wt.auth,replace:!0})})]})})]})})})})},VJ=w.createContext(void 0),zJ=({children:t,defaultTheme:e="system",storageKey:r="vite-ui-theme"})=>{const[n,i]=w.useState(()=>localStorage.getItem(r)||e),a=w.useMemo(()=>n==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,[n]);w.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(a),localStorage.setItem(r,n)},[a,n,r]);const s={theme:n,setTheme:i,resolvedTheme:a};return d.jsx(VJ.Provider,{value:s,children:t})};console.log("[MOBILE]  Main.tsx loading started");console.log("[MOBILE] Location:",window.location.href);console.log("[MOBILE] Pathname:",window.location.pathname);console.log("[MOBILE] User Agent:",navigator.userAgent);window.addEventListener("error",t=>{console.error("[GLOBAL] Uncaught error:",t.error),console.error("[GLOBAL] Error details:",{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,stack:t.error?.stack})});window.addEventListener("unhandledrejection",t=>{console.error("[GLOBAL] Unhandled promise rejection:",t.reason),console.error("[GLOBAL] Promise:",t.promise)});try{N4(),console.log("[MOBILE] Debug system initialized")}catch(t){console.error("[MOBILE] Debug system failed:",t)}const BC=new E_;function FJ(){const{user:t}=kn();return H.useEffect(()=>{t?.id&&BC.prefetchQuery({queryKey:["plants",t.id],queryFn:()=>hs.getUserPlantSummaries(t.id),staleTime:1e3*60*5})},[t?.id]),null}console.log("[MOBILE] Looking for root container...");const HC=document.getElementById("root");if(!HC)throw Jp("ROOT_CONTAINER","Root container not found"),new Error("Root container not found");console.log("[MOBILE] Root container found, creating React root...");try{const t=Pf.createRoot(HC);console.log("[MOBILE] React root created, rendering App..."),t.render(d.jsx(H.StrictMode,{children:d.jsx(zJ,{children:d.jsxs(T_,{client:BC,children:[d.jsx(FJ,{}),d.jsx($J,{})]})})})),console.log("[MOBILE] App render called successfully")}catch(t){throw Jp("REACT_RENDER",t),t}export{me as B,kn as a,Z3 as b,Oe as c,U3 as g,K3 as u};
