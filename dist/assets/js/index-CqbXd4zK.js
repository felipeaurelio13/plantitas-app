const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Settings-CosF-7wo.js","assets/js/query-D9cK7eLy.js","assets/js/vendor-ohv-86MT.js","assets/js/router-Lz5I7iQY.js","assets/js/ui-BW4tJjqg.js","assets/js/supabase-ChG5PfJU.js","assets/js/Auth-Ct2-Ig2I.js"])))=>i.map(i=>d[i]);
var dk=Object.defineProperty;var hk=(t,e,r)=>e in t?dk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Nr=(t,e,r)=>hk(t,typeof e!="symbol"?e+"":e,r);import{j as u,u as sd,a as Ei,b as w_,Q as __,c as E_}from"./query-D9cK7eLy.js";import{a as Jm,b as H,r as w,d as fk,e as zi}from"./vendor-ohv-86MT.js";import{c as mk,_ as ep}from"./supabase-ChG5PfJU.js";import{u as ar,a as T_,L as pk,O as gk,b as tp,B as yk,R as Sv,c as sn,N as zh}from"./router-Lz5I7iQY.js";import{A as Pe,m as L,X as Fi,I as A_,T as _n,C as Jr,a as Ai,L as ga,P as rp,b as En,c as np,H as Ql,B as Ho,S as vk,W as bk,d as S_,R as La,e as er,f as ya,D as gc,g as I_,E as xk,h as Pf,M as yc,i as P_,j as wk,k as _k,l as Ek,n as Tk,U as C_,o as k_,p as Ak,q as Sk,r as N_,s as j_,t as Ik,u as od,v as O_,w as Jl,x as R_,y as Pk,z as Iv,F as ip,G as D_,J as M_,K as Pv,N as Ck,O as L_,Q as eu,V as $_,Y as kk,Z as Nk,_ as jk,$ as Ok,a0 as Rk,a1 as Cv,a2 as Dk,a3 as Mk,a4 as V_,a5 as z_,a6 as F_,a7 as Lk,a8 as $k}from"./ui-BW4tJjqg.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Cf={},kv=Jm;Cf.createRoot=kv.createRoot,Cf.hydrateRoot=kv.hydrateRoot;const Nv=t=>{let e;const r=new Set,n=(l,d)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const m=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>c,subscribe:l=>(r.add(l),()=>r.delete(l))},c=e=t(n,i,o);return o},Vk=t=>t?Nv(t):Nv,zk=t=>t;function Fk(t,e=zk){const r=H.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return H.useDebugValue(r),r}const jv=t=>{const e=Vk(t),r=n=>Fk(e,n);return Object.assign(r,e),r},ap=t=>t?jv(t):jv;var U_=Symbol.for("immer-nothing"),Ov=Symbol.for("immer-draftable"),Ar=Symbol.for("immer-state");function Gr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Es=Object.getPrototypeOf;function Ta(t){return!!t&&!!t[Ar]}function Gn(t){return t?B_(t)||Array.isArray(t)||!!t[Ov]||!!t.constructor?.[Ov]||ld(t)||ud(t):!1}var Uk=Object.prototype.constructor.toString();function B_(t){if(!t||typeof t!="object")return!1;const e=Es(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Uk}function tu(t,e){cd(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function cd(t){const e=t[Ar];return e?e.type_:Array.isArray(t)?1:ld(t)?2:ud(t)?3:0}function kf(t,e){return cd(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function H_(t,e,r){const n=cd(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function Bk(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ld(t){return t instanceof Map}function ud(t){return t instanceof Set}function ia(t){return t.copy_||t.base_}function Nf(t,e){if(ld(t))return new Map(t);if(ud(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=B_(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ar];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Es(t),n)}else{const n=Es(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function sp(t,e=!1){return dd(t)||Ta(t)||!Gn(t)||(cd(t)>1&&(t.set=t.add=t.clear=t.delete=Hk),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>sp(n,!0))),t}function Hk(){Gr(2)}function dd(t){return Object.isFrozen(t)}var Wk={};function Aa(t){const e=Wk[t];return e||Gr(0,t),e}var Wo;function W_(){return Wo}function qk(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rv(t,e){e&&(Aa("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function jf(t){Of(t),t.drafts_.forEach(Kk),t.drafts_=null}function Of(t){t===Wo&&(Wo=t.parent_)}function Dv(t){return Wo=qk(Wo,t)}function Kk(t){const e=t[Ar];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function Mv(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ar].modified_&&(jf(e),Gr(4)),Gn(t)&&(t=ru(e,t),e.parent_||nu(e,t)),e.patches_&&Aa("Patches").generateReplacementPatches_(r[Ar].base_,t,e.patches_,e.inversePatches_)):t=ru(e,r,[]),jf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==U_?t:void 0}function ru(t,e,r){if(dd(e))return e;const n=e[Ar];if(!n)return tu(e,(i,a)=>Lv(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return nu(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),tu(a,(o,c)=>Lv(t,n,i,o,c,r,s)),nu(t,i,!1),r&&t.patches_&&Aa("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Lv(t,e,r,n,i,a,s){if(Ta(i)){const o=a&&e&&e.type_!==3&&!kf(e.assigned_,n)?a.concat(n):void 0,c=ru(t,i,o);if(H_(r,n,c),Ta(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Gn(i)&&!dd(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ru(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&nu(t,i)}}function nu(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&sp(e,r)}function Gk(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:W_(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=op;r&&(i=[n],a=qo);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var op={get(t,e){if(e===Ar)return t;const r=ia(t);if(!kf(r,e))return Yk(t,r,e);const n=r[e];return t.finalized_||!Gn(n)?n:n===Fh(t.base_,e)?(Uh(t),t.copy_[e]=Df(n,t)):n},has(t,e){return e in ia(t)},ownKeys(t){return Reflect.ownKeys(ia(t))},set(t,e,r){const n=q_(ia(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=Fh(ia(t),e),a=i?.[Ar];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Bk(r,i)&&(r!==void 0||kf(t.base_,e)))return!0;Uh(t),Rf(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Fh(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Uh(t),Rf(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=ia(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gr(11)},getPrototypeOf(t){return Es(t.base_)},setPrototypeOf(){Gr(12)}},qo={};tu(op,(t,e)=>{qo[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});qo.deleteProperty=function(t,e){return qo.set.call(this,t,e,void 0)};qo.set=function(t,e,r){return op.set.call(this,t[0],e,r,t[0])};function Fh(t,e){const r=t[Ar];return(r?ia(r):t)[e]}function Yk(t,e,r){const n=q_(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function q_(t,e){if(!(e in t))return;let r=Es(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Es(r)}}function Rf(t){t.modified_||(t.modified_=!0,t.parent_&&Rf(t.parent_))}function Uh(t){t.copy_||(t.copy_=Nf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Zk=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...l){return s.produce(c,d=>r.call(this,d,...l))}}typeof r!="function"&&Gr(6),n!==void 0&&typeof n!="function"&&Gr(7);let i;if(Gn(e)){const a=Dv(this),s=Df(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?jf(a):Of(a)}return Rv(a,n),Mv(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===U_&&(i=void 0),this.autoFreeze_&&sp(i,!0),n){const a=[],s=[];Aa("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Gr(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Gn(t)||Gr(8),Ta(t)&&(t=Bn(t));const e=Dv(this),r=Df(t,void 0);return r[Ar].isManual_=!0,Of(e),r}finishDraft(t,e){const r=t&&t[Ar];(!r||!r.isManual_)&&Gr(9);const{scope_:n}=r;return Rv(n,e),Mv(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Aa("Patches").applyPatches_;return Ta(t)?n(t,e):this.produce(t,i=>n(i,e))}};function Df(t,e){const r=ld(t)?Aa("MapSet").proxyMap_(t,e):ud(t)?Aa("MapSet").proxySet_(t,e):Gk(t,e);return(e?e.scope_:W_()).drafts_.push(r),r}function Bn(t){return Ta(t)||Gr(10,t),K_(t)}function K_(t){if(!Gn(t)||dd(t))return t;const e=t[Ar];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Nf(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Nf(t,!0);return tu(r,(n,i)=>{H_(r,n,K_(i))}),e&&(e.finalized_=!1),r}var Sr=new Zk,Se=Sr.produce;Sr.produceWithPatches.bind(Sr);Sr.setAutoFreeze.bind(Sr);Sr.setUseStrictShallowCopy.bind(Sr);Sr.applyPatches.bind(Sr);Sr.createDraft.bind(Sr);Sr.finishDraft.bind(Sr);const Xk=()=>{};var $v={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Qk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],c=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},Y_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,d=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|l>>6,p=l&63;c||(p=64,s||(m=64)),n.push(r[d],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(G_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Qk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const l=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||l==null||h==null)throw new Jk;const m=a<<2|o>>4;if(n.push(m),l!==64){const p=o<<4&240|l>>2;if(n.push(p),h!==64){const v=l<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Jk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eN=function(t){const e=G_(t);return Y_.encodeByteArray(e,!0)},iu=function(t){return eN(t).replace(/\./g,"")},Z_=function(t){try{return Y_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN=()=>tN().__FIREBASE_DEFAULTS__,nN=()=>{if(typeof process>"u"||typeof $v>"u")return;const t=$v.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},iN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Z_(t[1]);return e&&JSON.parse(e)},hd=()=>{try{return Xk()||rN()||nN()||iN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},X_=t=>hd()?.emulatorHosts?.[t],Q_=t=>{const e=X_(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},J_=()=>hd()?.config,eE=t=>hd()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[iu(JSON.stringify(r)),iu(JSON.stringify(s)),""].join(".")}const Oo={};function sN(){const t={prod:[],emulator:[]};for(const e of Object.keys(Oo))Oo[e]?t.emulator.push(e):t.prod.push(e);return t}function oN(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Vv=!1;function lp(t,e){if(typeof window>"u"||typeof document>"u"||!$a(window.location.host)||Oo[t]===e||Oo[t]||Vv)return;Oo[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=sN().prod.length>0;function s(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{Vv=!0,s()},m}function d(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=oN(n),p=r("text"),v=document.getElementById(p)||document.createElement("span"),b=r("learnmore"),g=document.getElementById(b)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;o(E),d(g,b);const j=l();c(T,_),E.append(T,v,g,j),document.body.appendChild(E)}a?(v.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function lN(){const t=hd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fN(){const t=tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mN(){return!lN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pN(){try{return typeof indexedDB=="object"}catch{return!1}}function gN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN="FirebaseError";class Cn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=yN,Object.setPrototypeOf(this,Cn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vc.prototype.create)}}class vc{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?vN(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Cn(i,o,n)}}function vN(t,e){return t.replace(bN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const bN=/\{\$([^}]+)}/g;function xN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sa(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(zv(a)&&zv(s)){if(!Sa(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function zv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function To(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Ao(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function wN(t,e){const r=new _N(t,e);return r.subscribe.bind(r)}class _N{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");EN(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Bh),i.error===void 0&&(i.error=Bh),i.complete===void 0&&(i.complete=Bh);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EN(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Bh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class Ni{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TN=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new aN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(SN(e))try{this.getOrInitializeService({instanceIdentifier:aa})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=aa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=aa){return this.instances.has(e)}getOptions(e=aa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:AN(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=aa){return this.component?this.component.multipleInstances?e:aa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function AN(t){return t===aa?void 0:t}function SN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new TN(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const PN={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},CN=xe.INFO,kN={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},NN=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=kN[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class up{constructor(e){this.name=e,this._logLevel=CN,this._logHandler=NN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const jN=(t,e)=>e.some(r=>t instanceof r);let Fv,Uv;function ON(){return Fv||(Fv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RN(){return Uv||(Uv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rE=new WeakMap,Mf=new WeakMap,nE=new WeakMap,Hh=new WeakMap,dp=new WeakMap;function DN(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Si(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&rE.set(r,t)}).catch(()=>{}),dp.set(e,t),e}function MN(t){if(Mf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});Mf.set(t,e)}let Lf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Mf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||nE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Si(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LN(t){Lf=t(Lf)}function $N(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Wh(this),e,...r);return nE.set(n,e.sort?e.sort():[e]),Si(n)}:RN().includes(t)?function(...e){return t.apply(Wh(this),e),Si(rE.get(this))}:function(...e){return Si(t.apply(Wh(this),e))}}function VN(t){return typeof t=="function"?$N(t):(t instanceof IDBTransaction&&MN(t),jN(t,ON())?new Proxy(t,Lf):t)}function Si(t){if(t instanceof IDBRequest)return DN(t);if(Hh.has(t))return Hh.get(t);const e=VN(t);return e!==t&&(Hh.set(t,e),dp.set(e,t)),e}const Wh=t=>dp.get(t);function zN(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Si(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Si(s.result),c.oldVersion,c.newVersion,Si(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const FN=["get","getKey","getAll","getAllKeys","count"],UN=["put","add","delete","clear"],qh=new Map;function Bv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qh.get(e))return qh.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=UN.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||FN.includes(r)))return;const a=async function(s,...o){const c=this.transaction(s,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&c.done]))[0]};return qh.set(e,a),a}LN(t=>({...t,get:(e,r,n)=>Bv(e,r)||t.get(e,r,n),has:(e,r)=>!!Bv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(HN(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function HN(t){return t.getComponent()?.type==="VERSION"}const $f="@firebase/app",Hv="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new up("@firebase/app"),WN="@firebase/app-compat",qN="@firebase/analytics-compat",KN="@firebase/analytics",GN="@firebase/app-check-compat",YN="@firebase/app-check",ZN="@firebase/auth",XN="@firebase/auth-compat",QN="@firebase/database",JN="@firebase/data-connect",ej="@firebase/database-compat",tj="@firebase/functions",rj="@firebase/functions-compat",nj="@firebase/installations",ij="@firebase/installations-compat",aj="@firebase/messaging",sj="@firebase/messaging-compat",oj="@firebase/performance",cj="@firebase/performance-compat",lj="@firebase/remote-config",uj="@firebase/remote-config-compat",dj="@firebase/storage",hj="@firebase/storage-compat",fj="@firebase/firestore",mj="@firebase/ai",pj="@firebase/firestore-compat",gj="firebase",yj="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vf="[DEFAULT]",vj={[$f]:"fire-core",[WN]:"fire-core-compat",[KN]:"fire-analytics",[qN]:"fire-analytics-compat",[YN]:"fire-app-check",[GN]:"fire-app-check-compat",[ZN]:"fire-auth",[XN]:"fire-auth-compat",[QN]:"fire-rtdb",[JN]:"fire-data-connect",[ej]:"fire-rtdb-compat",[tj]:"fire-fn",[rj]:"fire-fn-compat",[nj]:"fire-iid",[ij]:"fire-iid-compat",[aj]:"fire-fcm",[sj]:"fire-fcm-compat",[oj]:"fire-perf",[cj]:"fire-perf-compat",[lj]:"fire-rc",[uj]:"fire-rc-compat",[dj]:"fire-gcs",[hj]:"fire-gcs-compat",[fj]:"fire-fst",[pj]:"fire-fst-compat",[mj]:"fire-vertex","fire-js":"fire-js",[gj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=new Map,bj=new Map,zf=new Map;function Wv(t,e){try{t.container.addComponent(e)}catch(r){Yn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ia(t){const e=t.name;if(zf.has(e))return Yn.debug(`There were multiple attempts to register component ${e}.`),!1;zf.set(e,t);for(const r of au.values())Wv(r,t);for(const r of bj.values())Wv(r,t);return!0}function fd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function wr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ii=new vc("app","Firebase",xj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ni("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ii.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=yj;function iE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Vf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ii.create("bad-app-name",{appName:String(i)});if(r||(r=J_()),!r)throw Ii.create("no-options");const a=au.get(i);if(a){if(Sa(r,a.options)&&Sa(n,a.config))return a;throw Ii.create("duplicate-app",{appName:i})}const s=new IN(i);for(const c of zf.values())s.addComponent(c);const o=new wj(r,n,s);return au.set(i,o),o}function hp(t=Vf){const e=au.get(t);if(!e&&t===Vf&&J_())return iE();if(!e)throw Ii.create("no-app",{appName:t});return e}function fn(t,e,r){let n=vj[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yn.warn(s.join(" "));return}Ia(new Ni(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j="firebase-heartbeat-database",Ej=1,Ko="firebase-heartbeat-store";let Kh=null;function aE(){return Kh||(Kh=zN(_j,Ej,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ko)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ii.create("idb-open",{originalErrorMessage:t.message})})),Kh}async function Tj(t){try{const r=(await aE()).transaction(Ko),n=await r.objectStore(Ko).get(sE(t));return await r.done,n}catch(e){if(e instanceof Cn)Yn.warn(e.message);else{const r=Ii.create("idb-get",{originalErrorMessage:e?.message});Yn.warn(r.message)}}}async function qv(t,e){try{const n=(await aE()).transaction(Ko,"readwrite");await n.objectStore(Ko).put(e,sE(t)),await n.done}catch(r){if(r instanceof Cn)Yn.warn(r.message);else{const n=Ii.create("idb-set",{originalErrorMessage:r?.message});Yn.warn(n.message)}}}function sE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=1024,Sj=30;class Ij{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Cj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Kv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Sj){const i=kj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Kv(),{heartbeatsToSend:r,unsentEntries:n}=Pj(this._heartbeatsCache.heartbeats),i=iu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Yn.warn(e),""}}}function Kv(){return new Date().toISOString().substring(0,10)}function Pj(t,e=Aj){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),Gv(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Gv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Cj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pN()?gN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Tj(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return qv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Gv(t){return iu(JSON.stringify({version:2,heartbeats:t})).length}function kj(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(t){Ia(new Ni("platform-logger",e=>new BN(e),"PRIVATE")),Ia(new Ni("heartbeat",e=>new Ij(e),"PRIVATE")),fn($f,Hv,t),fn($f,Hv,"esm2020"),fn("fire-js","")}Nj("");var jj="firebase",Oj="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(jj,Oj,"app");function oE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Rj=oE,cE=new vc("auth","Firebase",oE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=new up("@firebase/auth");function Dj(t,...e){su.logLevel<=xe.WARN&&su.warn(`Auth (${Va}): ${t}`,...e)}function $l(t,...e){su.logLevel<=xe.ERROR&&su.error(`Auth (${Va}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,...e){throw fp(t,...e)}function mn(t,...e){return fp(t,...e)}function lE(t,e,r){const n={...Rj(),[e]:r};return new vc("auth","Firebase",n).create(e,{appName:t.name})}function Hn(t){return lE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fp(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return cE.create(t,...e)}function ue(t,e,...r){if(!t)throw fp(e,...r)}function Vn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw $l(e),new Error(e)}function Zn(t,e){t||Vn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ff(){return typeof self<"u"&&self.location?.href||""}function Mj(){return Yv()==="http:"||Yv()==="https:"}function Yv(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Mj()||dN()||"connection"in navigator)?navigator.onLine:!0}function $j(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,r){this.shortDelay=e,this.longDelay=r,Zn(r>e,"Short delay should be less than long delay!"),this.isMobile=cN()||hN()}get(){return Lj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fj=new xc(3e4,6e4);function Ui(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Bi(t,e,r,n,i={}){return dE(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=bc({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...a};return uN()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&$a(t.emulatorConfig.host)&&(l.credentials="include"),uE.fetch()(await hE(t,t.config.apiHost,r,o),l)})}async function dE(t,e,r){t._canInitEmulator=!1;const n={...Vj,...e};try{const i=new Bj(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw ul(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ul(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw ul(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw ul(t,"user-disabled",s);const d=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw lE(t,d,l);en(t,d)}}catch(i){if(i instanceof Cn)throw i;en(t,"network-request-failed",{message:String(i)})}}async function wc(t,e,r,n,i={}){const a=await Bi(t,e,r,n,i);return"mfaPendingCredential"in a&&en(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function hE(t,e,r,n){const i=`${e}${r}?${n}`,a=t,s=a.config.emulator?mp(t.config,i):`${t.config.apiScheme}://${i}`;return zj.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function Uj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(mn(this.auth,"network-request-failed")),Fj.get())})}}function ul(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=mn(t,e,n);return i.customData._tokenResponse=r,i}function Zv(t){return t!==void 0&&t.enterprise!==void 0}class Hj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Uj(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Wj(t,e){return Bi(t,"GET","/v2/recaptchaConfig",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qj(t,e){return Bi(t,"POST","/v1/accounts:delete",e)}async function ou(t,e){return Bi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Kj(t,e=!1){const r=dr(t),n=await r.getIdToken(e),i=pp(n);ue(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:n,authTime:Ro(Gh(i.auth_time)),issuedAtTime:Ro(Gh(i.iat)),expirationTime:Ro(Gh(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Gh(t){return Number(t)*1e3}function pp(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return $l("JWT malformed, contained fewer than 3 sections"),null;try{const i=Z_(r);return i?JSON.parse(i):($l("Failed to decode base64 JWT payload"),null)}catch(i){return $l("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Xv(t){const e=pp(t);return ue(e,"internal-error"),ue(typeof e.exp<"u","internal-error"),ue(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Cn&&Gj(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Gj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ro(this.lastLoginAt),this.creationTime=Ro(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cu(t){const e=t.auth,r=await t.getIdToken(),n=await Go(t,ou(e,{idToken:r}));ue(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?fE(i.providerUserInfo):[],s=Xj(t.providerData,a),o=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,l=o?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Uf(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(t,d)}async function Zj(t){const e=dr(t);await cu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Xj(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function fE(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(t,e){const r=await dE(t,{},async()=>{const n=bc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=await hE(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&$a(t.emulatorConfig.host)&&(c.credentials="include"),uE.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Jj(t,e){return Bi(t,"POST","/v2/accounts:revokeToken",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ue(e.idToken,"internal-error"),ue(typeof e.idToken<"u","internal-error"),ue(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Xv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ue(e.length!==0,"internal-error");const r=Xv(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ue(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await Qj(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new ps;return n&&(ue(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(ue(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(ue(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ps,this.toJSON())}_performRefresh(){return Vn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t,e){ue(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Yj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Uf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Go(this,this.stsTokenManager.getToken(this.auth,e));return ue(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Kj(this,e)}reload(){return Zj(this)}_assign(e){this!==e&&(ue(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ue(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await cu(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wr(this.auth.app))return Promise.reject(Hn(this.auth));const e=await this.getIdToken();return await Go(this,qj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,s=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,d=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:b}=r;ue(h&&b,e,"internal-error");const g=ps.fromJSON(this.name,b);ue(typeof h=="string",e,"internal-error"),di(n,e.name),di(i,e.name),ue(typeof m=="boolean",e,"internal-error"),ue(typeof p=="boolean",e,"internal-error"),di(a,e.name),di(s,e.name),di(o,e.name),di(c,e.name),di(l,e.name),di(d,e.name);const _=new Zr({uid:h,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:a,tenantId:o,stsTokenManager:g,createdAt:l,lastLoginAt:d});return v&&Array.isArray(v)&&(_.providerData=v.map(T=>({...T}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new ps;i.updateFromServerResponse(r);const a=new Zr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await cu(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ue(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?fE(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,o=new ps;o.updateFromIdToken(n);const c=new Zr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Uf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv=new Map;function zn(t){Zn(t instanceof Function,"Expected a class definition");let e=Qv.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Qv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}mE.type="NONE";const Jv=mE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(t,e,r){return`firebase:${t}:${e}:${r}`}class gs{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Vl(this.userKey,i.apiKey,a),this.fullPersistenceKey=Vl("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ou(this.auth,{idToken:e}).catch(()=>{});return r?Zr._fromGetAccountInfoResponse(this.auth,r,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new gs(zn(Jv),e,n);const i=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let a=i[0]||zn(Jv);const s=Vl(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const d=await l._get(s);if(d){let h;if(typeof d=="string"){const m=await ou(e,{idToken:d}).catch(()=>{});if(!m)break;h=await Zr._fromGetAccountInfoResponse(e,m,d)}else h=Zr._fromJSON(e,d);l!==a&&(o=h),a=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new gs(a,e,n):(a=c[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==a)try{await l._remove(s)}catch{}})),new gs(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xE(e))return"Blackberry";if(wE(e))return"Webos";if(gE(e))return"Safari";if((e.includes("chrome/")||yE(e))&&!e.includes("edge/"))return"Chrome";if(bE(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function pE(t=tr()){return/firefox\//i.test(t)}function gE(t=tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yE(t=tr()){return/crios\//i.test(t)}function vE(t=tr()){return/iemobile/i.test(t)}function bE(t=tr()){return/android/i.test(t)}function xE(t=tr()){return/blackberry/i.test(t)}function wE(t=tr()){return/webos/i.test(t)}function gp(t=tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function eO(t=tr()){return gp(t)&&!!window.navigator?.standalone}function tO(){return fN()&&document.documentMode===10}function _E(t=tr()){return gp(t)||bE(t)||wE(t)||xE(t)||/windows phone/i.test(t)||vE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(t,e=[]){let r;switch(t){case"Browser":r=e0(tr());break;case"Worker":r=`${e0(tr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Va}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const c=e(a);s(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(t,e={}){return Bi(t,"GET","/v2/passwordPolicy",Ui(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=6;class aO{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??iO,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new t0(this),this.idTokenSubscription=new t0(this),this.beforeStateQueue=new rO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=zn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await gs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ou(this,{idToken:e}),n=await Zr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(wr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===s)&&o?.user&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ue(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await cu(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$j()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wr(this.app))return Promise.reject(Hn(this));const r=e?dr(e):null;return r&&ue(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ue(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wr(this.app)?Promise.reject(Hn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wr(this.app)?Promise.reject(Hn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nO(this),r=new aO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vc("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Jj(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&zn(e)||this._popupRedirectResolver;ue(r,this,"argument-error"),this.redirectPersistenceManager=await gs.create(this,[zn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ue(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ue(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=EE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Dj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function za(t){return dr(t)}class t0{constructor(e){this.auth=e,this.observer=null,this.addObserver=wN(r=>this.observer=r)}get next(){return ue(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oO(t){md=t}function TE(t){return md.loadJS(t)}function cO(){return md.recaptchaEnterpriseScript}function lO(){return md.gapiScript}function uO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class dO{constructor(){this.enterprise=new hO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class hO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const fO="recaptcha-enterprise",AE="NO_RECAPTCHA";class mO{constructor(e){this.type=fO,this.auth=za(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{Wj(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new Hj(c);return a.tenantId==null?a._agentRecaptchaConfig=l:a._tenantRecaptchaConfigs[a.tenantId]=l,s(l.siteKey)}}).catch(c=>{o(c)})})}function i(a,s,o){const c=window.grecaptcha;Zv(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(l=>{s(l)}).catch(()=>{s(AE)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dO().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&Zv(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let c=cO();c.length!==0&&(c+=o),TE(c).then(()=>{i(o,a,s)}).catch(l=>{s(l)})}}).catch(o=>{s(o)})})}}async function r0(t,e,r,n=!1,i=!1){const a=new mO(t);let s;if(i)s=AE;else try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Bf(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await r0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await r0(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(t,e){const r=fd(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Sa(a,e??{}))return i;en(i,"already-initialized")}return r.initialize({options:e})}function gO(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(zn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function yO(t,e,r){const n=za(t);ue(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=SE(e),{host:s,port:o}=vO(e),c=o===null?"":`:${o}`,l={url:`${a}//${s}${c}/`},d=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ue(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ue(Sa(l,n.config.emulator)&&Sa(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,$a(s)?(cp(`${a}//${s}${c}`),lp("Auth",!0)):bO()}function SE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vO(t){const e=SE(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:n0(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:n0(s)}}}function n0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Vn("not implemented")}_getIdTokenResponse(e){return Vn("not implemented")}_linkToIdToken(e,r){return Vn("not implemented")}_getReauthenticationResolver(e){return Vn("not implemented")}}async function xO(t,e){return Bi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(t,e){return wc(t,"POST","/v1/accounts:signInWithPassword",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e){return wc(t,"POST","/v1/accounts:signInWithEmailLink",Ui(t,e))}async function EO(t,e){return wc(t,"POST","/v1/accounts:signInWithEmailLink",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends yp{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Yo(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Yo(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bf(e,r,"signInWithPassword",wO);case"emailLink":return _O(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Bf(e,n,"signUpPassword",xO);case"emailLink":return EO(e,{idToken:r,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ys(t,e){return wc(t,"POST","/v1/accounts:signInWithIdp",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="http://localhost";class Pa extends yp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):en("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const s=new Pa(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return ys(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ys(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ys(e,r)}buildRequest(){const e={requestUri:TO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=bc(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SO(t){const e=To(Ao(t)).link,r=e?To(Ao(e)).deep_link_id:null,n=To(Ao(t)).deep_link_id;return(n?To(Ao(n)).link:null)||n||r||e||t}class vp{constructor(e){const r=To(Ao(e)),n=r.apiKey??null,i=r.oobCode??null,a=AO(r.mode??null);ue(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=SO(e);try{return new vp(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(){this.providerId=Ls.PROVIDER_ID}static credential(e,r){return Yo._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=vp.parseLink(r);return ue(n,"argument-error"),Yo._fromEmailAndCode(e,n.code,n.tenantId)}}Ls.PROVIDER_ID="password";Ls.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ls.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends IE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi extends _c{constructor(){super("facebook.com")}static credential(e){return Pa._fromParams({providerId:vi.PROVIDER_ID,signInMethod:vi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vi.credentialFromTaggedObject(e)}static credentialFromError(e){return vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vi.credential(e.oauthAccessToken)}catch{return null}}}vi.FACEBOOK_SIGN_IN_METHOD="facebook.com";vi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends _c{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Pa._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bi.credential(r,n)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends _c{constructor(){super("github.com")}static credential(e){return Pa._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.GITHUB_SIGN_IN_METHOD="github.com";xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends _c{constructor(){super("twitter.com")}static credential(e,r){return Pa._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return wi.credential(r,n)}catch{return null}}}wi.TWITTER_SIGN_IN_METHOD="twitter.com";wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IO(t,e){return wc(t,"POST","/v1/accounts:signUp",Ui(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Zr._fromIdTokenResponse(e,n,i),s=i0(n);return new Ca({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=i0(n);return new Ca({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function i0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends Cn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,lu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new lu(e,r,n,i)}}function PE(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?lu._fromErrorAndOperation(t,a,e,n):a})}async function PO(t,e,r=!1){const n=await Go(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ca._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CO(t,e,r=!1){const{auth:n}=t;if(wr(n.app))return Promise.reject(Hn(n));const i="reauthenticate";try{const a=await Go(t,PE(n,i,e,t),r);ue(a.idToken,n,"internal-error");const s=pp(a.idToken);ue(s,n,"internal-error");const{sub:o}=s;return ue(t.uid===o,n,"user-mismatch"),Ca._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&en(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CE(t,e,r=!1){if(wr(t.app))return Promise.reject(Hn(t));const n="signIn",i=await PE(t,n,e),a=await Ca._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function kO(t,e){return CE(za(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kE(t){const e=za(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function NO(t,e,r){if(wr(t.app))return Promise.reject(Hn(t));const n=za(t),s=await Bf(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",IO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&kE(t),c}),o=await Ca._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function jO(t,e,r){return wr(t.app)?Promise.reject(Hn(t)):kO(dr(t),Ls.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&kE(t),n})}function OO(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function RO(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function DO(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function MO(t){return dr(t).signOut()}const uu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(uu,"1"),this.storage.removeItem(uu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=1e3,$O=10;class jE extends NE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_E(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);tO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$O):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},LO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}jE.type="LOCAL";const VO=jE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE extends NE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}OE.type="SESSION";const RE=OE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new pd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async l=>l(r.origin,a)),c=await zO(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,c)=>{const l=bp("",20);i.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(d),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function UO(t){pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function BO(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HO(){return navigator?.serviceWorker?.controller||null}function WO(){return DE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ME="firebaseLocalStorageDb",qO=1,du="firebaseLocalStorage",LE="fbase_key";class Ec{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function gd(t,e){return t.transaction([du],e?"readwrite":"readonly").objectStore(du)}function KO(){const t=indexedDB.deleteDatabase(ME);return new Ec(t).toPromise()}function Hf(){const t=indexedDB.open(ME,qO);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(du,{keyPath:LE})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(du)?e(n):(n.close(),await KO(),e(await Hf()))})})}async function a0(t,e,r){const n=gd(t,!0).put({[LE]:e,value:r});return new Ec(n).toPromise()}async function GO(t,e){const r=gd(t,!1).get(e),n=await new Ec(r).toPromise();return n===void 0?null:n.value}function s0(t,e){const r=gd(t,!0).delete(e);return new Ec(r).toPromise()}const YO=800,ZO=3;class $E{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>ZO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pd._getInstance(WO()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await BO(),!this.activeServiceWorker)return;this.sender=new FO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hf();return await a0(e,uu,"1"),await s0(e,uu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>a0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>GO(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>s0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=gd(i,!1).getAll();return new Ec(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$E.type="LOCAL";const XO=$E;new xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QO(t,e){return e?zn(e):(ue(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp extends yp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ys(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ys(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ys(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function JO(t){return CE(t.auth,new xp(t),t.bypassAuthState)}function eR(t){const{auth:e,user:r}=t;return ue(r,e,"internal-error"),CO(r,new xp(t),t.bypassAuthState)}async function tR(t){const{auth:e,user:r}=t;return ue(r,e,"internal-error"),PO(r,new xp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JO;case"linkViaPopup":case"linkViaRedirect":return tR;case"reauthViaPopup":case"reauthViaRedirect":return eR;default:en(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=new xc(2e3,1e4);class ds extends VE{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ds.currentPopupAction&&ds.currentPopupAction.cancel(),ds.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ue(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=bp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ds.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rR.get())};e()}}ds.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR="pendingRedirect",zl=new Map;class iR extends VE{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=zl.get(this.auth._key());if(!e){try{const n=await aR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}zl.set(this.auth._key(),e)}return this.bypassAuthState||zl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aR(t,e){const r=cR(e),n=oR(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function sR(t,e){zl.set(t._key(),e)}function oR(t){return zn(t._redirectPersistence)}function cR(t){return Vl(nR,t.config.apiKey,t.name)}async function lR(t,e,r=!1){if(wr(t.app))return Promise.reject(Hn(t));const n=za(t),i=QO(n,e),s=await new iR(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR=10*60*1e3;class dR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hR(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!zE(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(mn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=uR&&this.cachedEventUids.clear(),this.cachedEventUids.has(o0(e))}saveEventToCache(e){this.cachedEventUids.add(o0(e)),this.lastProcessedEventTime=Date.now()}}function o0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zE({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function hR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fR(t,e={}){return Bi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pR=/^https?/;async function gR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fR(t);for(const r of e)try{if(yR(r))return}catch{}en(t,"unauthorized-domain")}function yR(t){const e=Ff(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!pR.test(r))return!1;if(mR.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR=new xc(3e4,6e4);function c0(){const t=pn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function bR(t){return new Promise((e,r)=>{function n(){c0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{c0(),r(mn(t,"network-request-failed"))},timeout:vR.get()})}if(pn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pn().gapi?.load)n();else{const i=uO("iframefcb");return pn()[i]=()=>{gapi.load?n():r(mn(t,"network-request-failed"))},TE(`${lO()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw Fl=null,e})}let Fl=null;function xR(t){return Fl=Fl||bR(t),Fl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wR=new xc(5e3,15e3),_R="__/auth/iframe",ER="emulator/auth/iframe",TR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function SR(t){const e=t.config;ue(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?mp(e,ER):`https://${t.config.authDomain}/${_R}`,n={apiKey:e.apiKey,appName:t.name,v:Va},i=AR.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${bc(n).slice(1)}`}async function IR(t){const e=await xR(t),r=pn().gapi;return ue(r,t,"internal-error"),e.open({where:document.body,url:SR(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TR,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=mn(t,"network-request-failed"),o=pn().setTimeout(()=>{a(s)},wR.get());function c(){pn().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CR=500,kR=600,NR="_blank",jR="http://localhost";class l0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OR(t,e,r,n=CR,i=kR){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...PR,width:n.toString(),height:i.toString(),top:a,left:s},l=tr().toLowerCase();r&&(o=yE(l)?NR:r),pE(l)&&(e=e||jR,c.scrollbars="yes");const d=Object.entries(c).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(eO(l)&&o!=="_self")return RR(e||"",o),new l0(null);const h=window.open(e||"",o,d);ue(h,t,"popup-blocked");try{h.focus()}catch{}return new l0(h)}function RR(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR="__/auth/handler",MR="emulator/auth/handler",LR=encodeURIComponent("fac");async function u0(t,e,r,n,i,a){ue(t.config.authDomain,t,"auth-domain-config-required"),ue(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Va,eventId:i};if(e instanceof IE){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",xN(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))s[d]=h}if(e instanceof _c){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(s.scopes=d.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const c=await t._getAppCheckToken(),l=c?`#${LR}=${encodeURIComponent(c)}`:"";return`${$R(t)}?${bc(o).slice(1)}${l}`}function $R({config:t}){return t.emulator?mp(t,MR):`https://${t.authDomain}/${DR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="webStorageSupport";class VR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RE,this._completeRedirectFn=lR,this._overrideRedirectResult=sR}async _openPopup(e,r,n,i){Zn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await u0(e,r,n,Ff(),i);return OR(e,a,bp())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await u0(e,r,n,Ff(),i);return UO(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Zn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await IR(e),n=new dR(e);return r.register("authEvent",i=>(ue(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Yh,{type:Yh},i=>{const a=i?.[0]?.[Yh];a!==void 0&&r(!!a),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=gR(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _E()||gE()||gp()}}const zR=VR;var d0="@firebase/auth",h0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ue(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BR(t){Ia(new Ni("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;ue(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:EE(t)},l=new sO(n,i,a,c);return gO(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Ia(new Ni("auth-internal",e=>{const r=za(e.getProvider("auth").getImmediate());return(n=>new FR(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(d0,h0,UR(t)),fn(d0,h0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR=5*60,WR=eE("authIdTokenMaxAge")||HR;let f0=null;const qR=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>WR)return;const i=r?.token;f0!==i&&(f0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function KR(t=hp()){const e=fd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=pO(t,{popupRedirectResolver:zR,persistence:[XO,VO,RE]}),n=eE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=qR(a.toString());RO(r,s,()=>s(r.currentUser)),OO(r,o=>s(o))}}const i=X_("auth");return i&&yO(r,`http://${i}`),r}function GR(){return document.getElementsByTagName("head")?.[0]??document}oO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=mn("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",GR().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BR("Browser");var m0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pi,FE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,A){function P(){}P.prototype=A.prototype,S.D=A.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(O,N,C){for(var k=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)k[Q-2]=arguments[Q];return A.prototype[N].apply(O,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,A,P){P||(P=0);var O=Array(16);if(typeof A=="string")for(var N=0;16>N;++N)O[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;16>N;++N)O[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=S.g[0],P=S.g[1],N=S.g[2];var C=S.g[3],k=A+(C^P&(N^C))+O[0]+3614090360&4294967295;A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[1]+3905402710&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[2]+606105819&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[3]+3250441966&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[4]+4118548399&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[5]+1200080426&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[6]+2821735955&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[7]+4249261313&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[8]+1770035416&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[9]+2336552879&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[10]+4294925233&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[11]+2304563134&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[12]+1804603682&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[13]+4254626195&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[14]+2792965006&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[15]+1236535329&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(N^C&(P^N))+O[1]+4129170786&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[6]+3225465664&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[11]+643717713&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[0]+3921069994&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[5]+3593408605&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[10]+38016083&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[15]+3634488961&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[4]+3889429448&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[9]+568446438&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[14]+3275163606&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[3]+4107603335&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[8]+1163531501&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[13]+2850285829&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[2]+4243563512&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[7]+1735328473&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[12]+2368359562&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(P^N^C)+O[5]+4294588738&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[8]+2272392833&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[11]+1839030562&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[14]+4259657740&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[1]+2763975236&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[4]+1272893353&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[7]+4139469664&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[10]+3200236656&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[13]+681279174&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[0]+3936430074&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[3]+3572445317&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[6]+76029189&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[9]+3654602809&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[12]+3873151461&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[15]+530742520&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[2]+3299628645&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(N^(P|~C))+O[0]+4096336452&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[7]+1126891415&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[14]+2878612391&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[5]+4237533241&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[12]+1700485571&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[3]+2399980690&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[10]+4293915773&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[1]+2240044497&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[8]+1873313359&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[15]+4264355552&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[6]+2734768916&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[13]+1309151649&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[4]+4149444226&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[11]+3174756917&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[2]+718787259&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[9]+3951481745&4294967295,S.g[0]=S.g[0]+A&4294967295,S.g[1]=S.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+C&4294967295}n.prototype.u=function(S,A){A===void 0&&(A=S.length);for(var P=A-this.blockSize,O=this.B,N=this.h,C=0;C<A;){if(N==0)for(;C<=P;)i(this,S,C),C+=this.blockSize;if(typeof S=="string"){for(;C<A;)if(O[N++]=S.charCodeAt(C++),N==this.blockSize){i(this,O),N=0;break}}else for(;C<A;)if(O[N++]=S[C++],N==this.blockSize){i(this,O),N=0;break}}this.h=N,this.o+=A},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var A=1;A<S.length-8;++A)S[A]=0;var P=8*this.o;for(A=S.length-8;A<S.length;++A)S[A]=P&255,P/=256;for(this.u(S),S=Array(16),A=P=0;4>A;++A)for(var O=0;32>O;O+=8)S[P++]=this.g[A]>>>O&255;return S};function a(S,A){var P=o;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=A(S)}function s(S,A){this.h=A;for(var P=[],O=!0,N=S.length-1;0<=N;N--){var C=S[N]|0;O&&C==A||(P[N]=C,O=!1)}this.g=P}var o={};function c(S){return-128<=S&&128>S?a(S,function(A){return new s([A|0],0>A?-1:0)}):new s([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return g(l(-S));for(var A=[],P=1,O=0;S>=P;O++)A[O]=S/P|0,P*=4294967296;return new s(A,0)}function d(S,A){if(S.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S.charAt(0)=="-")return g(d(S.substring(1),A));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=l(Math.pow(A,8)),O=h,N=0;N<S.length;N+=8){var C=Math.min(8,S.length-N),k=parseInt(S.substring(N,N+C),A);8>C?(C=l(Math.pow(A,C)),O=O.j(C).add(l(k))):(O=O.j(P),O=O.add(l(k)))}return O}var h=c(0),m=c(1),p=c(16777216);t=s.prototype,t.m=function(){if(b(this))return-g(this).m();for(var S=0,A=1,P=0;P<this.g.length;P++){var O=this.i(P);S+=(0<=O?O:4294967296+O)*A,A*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(v(this))return"0";if(b(this))return"-"+g(this).toString(S);for(var A=l(Math.pow(S,6)),P=this,O="";;){var N=j(P,A).g;P=_(P,N.j(A));var C=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=N,v(P))return C+O;for(;6>C.length;)C="0"+C;O=C+O}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function v(S){if(S.h!=0)return!1;for(var A=0;A<S.g.length;A++)if(S.g[A]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=_(this,S),b(S)?-1:v(S)?0:1};function g(S){for(var A=S.g.length,P=[],O=0;O<A;O++)P[O]=~S.g[O];return new s(P,~S.h).add(m)}t.abs=function(){return b(this)?g(this):this},t.add=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0,N=0;N<=A;N++){var C=O+(this.i(N)&65535)+(S.i(N)&65535),k=(C>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);O=k>>>16,C&=65535,k&=65535,P[N]=k<<16|C}return new s(P,P[P.length-1]&-2147483648?-1:0)};function _(S,A){return S.add(g(A))}t.j=function(S){if(v(this)||v(S))return h;if(b(this))return b(S)?g(this).j(g(S)):g(g(this).j(S));if(b(S))return g(this.j(g(S)));if(0>this.l(p)&&0>S.l(p))return l(this.m()*S.m());for(var A=this.g.length+S.g.length,P=[],O=0;O<2*A;O++)P[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<S.g.length;N++){var C=this.i(O)>>>16,k=this.i(O)&65535,Q=S.i(N)>>>16,ce=S.i(N)&65535;P[2*O+2*N]+=k*ce,T(P,2*O+2*N),P[2*O+2*N+1]+=C*ce,T(P,2*O+2*N+1),P[2*O+2*N+1]+=k*Q,T(P,2*O+2*N+1),P[2*O+2*N+2]+=C*Q,T(P,2*O+2*N+2)}for(O=0;O<A;O++)P[O]=P[2*O+1]<<16|P[2*O];for(O=A;O<2*A;O++)P[O]=0;return new s(P,0)};function T(S,A){for(;(S[A]&65535)!=S[A];)S[A+1]+=S[A]>>>16,S[A]&=65535,A++}function E(S,A){this.g=S,this.h=A}function j(S,A){if(v(A))throw Error("division by zero");if(v(S))return new E(h,h);if(b(S))return A=j(g(S),A),new E(g(A.g),g(A.h));if(b(A))return A=j(S,g(A)),new E(g(A.g),A.h);if(30<S.g.length){if(b(S)||b(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,O=A;0>=O.l(S);)P=R(P),O=R(O);var N=D(P,1),C=D(O,1);for(O=D(O,2),P=D(P,2);!v(O);){var k=C.add(O);0>=k.l(S)&&(N=N.add(P),C=k),O=D(O,1),P=D(P,1)}return A=_(S,N.j(A)),new E(N,A)}for(N=h;0<=S.l(A);){for(P=Math.max(1,Math.floor(S.m()/A.m())),O=Math.ceil(Math.log(P)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),C=l(P),k=C.j(A);b(k)||0<k.l(S);)P-=O,C=l(P),k=C.j(A);v(C)&&(C=m),N=N.add(C),S=_(S,k)}return new E(N,S)}t.A=function(S){return j(this,S).h},t.and=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)&S.i(O);return new s(P,this.h&S.h)},t.or=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)|S.i(O);return new s(P,this.h|S.h)},t.xor=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)^S.i(O);return new s(P,this.h^S.h)};function R(S){for(var A=S.g.length+1,P=[],O=0;O<A;O++)P[O]=S.i(O)<<1|S.i(O-1)>>>31;return new s(P,S.h)}function D(S,A){var P=A>>5;A%=32;for(var O=S.g.length-P,N=[],C=0;C<O;C++)N[C]=0<A?S.i(C+P)>>>A|S.i(C+P+1)<<32-A:S.i(C+P);return new s(N,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,FE=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=d,Pi=s}).apply(typeof m0<"u"?m0:typeof self<"u"?self:typeof window<"u"?window:{});var dl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UE,So,BE,Ul,Wf,HE,WE,qE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,x){return f==Array.prototype||f==Object.prototype||(f[y]=x.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof dl=="object"&&dl];for(var y=0;y<f.length;++y){var x=f[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(f,y){if(y)e:{var x=n;f=f.split(".");for(var I=0;I<f.length-1;I++){var M=f[I];if(!(M in x))break e;x=x[M]}f=f[f.length-1],I=x[f],y=y(I),y!=I&&y!=null&&e(x,f,{configurable:!0,writable:!0,value:y})}}function a(f,y){f instanceof String&&(f+="");var x=0,I=!1,M={next:function(){if(!I&&x<f.length){var $=x++;return{value:y($,f[$]),done:!1}}return I=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(f){return f||function(){return a(this,function(y,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function c(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function l(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function d(f,y,x){return f.call.apply(f.bind,arguments)}function h(f,y,x){if(!f)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,I),f.apply(y,M)}}return function(){return f.apply(y,arguments)}}function m(f,y,x){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,m.apply(null,arguments)}function p(f,y){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function v(f,y){function x(){}x.prototype=y.prototype,f.aa=y.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(I,M,$){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return y.prototype[M].apply(I,W)}}function b(f){const y=f.length;if(0<y){const x=Array(y);for(let I=0;I<y;I++)x[I]=f[I];return x}return[]}function g(f,y){for(let x=1;x<arguments.length;x++){const I=arguments[x];if(c(I)){const M=f.length||0,$=I.length||0;f.length=M+$;for(let W=0;W<$;W++)f[M+W]=I[W]}else f.push(I)}}class _{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function j(f){return j[" "](f),f}j[" "]=function(){};var R=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(f,y,x){for(const I in f)y.call(x,f[I],I,f)}function S(f,y){for(const x in f)y.call(void 0,f[x],x,f)}function A(f){const y={};for(const x in f)y[x]=f[x];return y}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(f,y){let x,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(x in I)f[x]=I[x];for(let $=0;$<P.length;$++)x=P[$],Object.prototype.hasOwnProperty.call(I,x)&&(f[x]=I[x])}}function N(f){var y=1;f=f.split(":");const x=[];for(;0<y&&f.length;)x.push(f.shift()),y--;return f.length&&x.push(f.join(":")),x}function C(f){o.setTimeout(()=>{throw f},0)}function k(){var f=ye;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,x){const I=ce.get();I.set(y,x),this.h?this.h.next=I:this.g=I,this.h=I}}var ce=new _(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,fe=!1,ye=new Q,Ue=()=>{const f=o.Promise.resolve(void 0);ee=()=>{f.then(se)}};var se=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(x){C(x)}var y=ce;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}fe=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var rt=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const x=()=>{};o.addEventListener("test",x,y),o.removeEventListener("test",x,y)}catch{}return f}();function ze(f,y){if(J.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(R){e:{try{j(y.nodeName);var M=!0;break e}catch{}M=!1}M||(y=null)}}else x=="mouseover"?y=f.fromElement:x=="mouseout"&&(y=f.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Fe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&ze.aa.h.call(this)}}v(ze,J);var Fe={2:"touch",3:"pen",4:"mouse"};ze.prototype.h=function(){ze.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Pr="closure_listenable_"+(1e6*Math.random()|0),rn=0;function G(f,y,x,I,M){this.listener=f,this.proxy=null,this.src=y,this.type=x,this.capture=!!I,this.ha=M,this.key=++rn,this.da=this.fa=!1}function he(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function be(f){this.src=f,this.g={},this.h=0}be.prototype.add=function(f,y,x,I,M){var $=f.toString();f=this.g[$],f||(f=this.g[$]=[],this.h++);var W=ht(f,y,I,M);return-1<W?(y=f[W],x||(y.fa=!1)):(y=new G(y,this.src,$,!!I,M),y.fa=x,f.push(y)),y};function B(f,y){var x=y.type;if(x in f.g){var I=f.g[x],M=Array.prototype.indexOf.call(I,y,void 0),$;($=0<=M)&&Array.prototype.splice.call(I,M,1),$&&(he(y),f.g[x].length==0&&(delete f.g[x],f.h--))}}function ht(f,y,x,I){for(var M=0;M<f.length;++M){var $=f[M];if(!$.da&&$.listener==y&&$.capture==!!x&&$.ha==I)return M}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),vt={};function bt(f,y,x,I,M){if(Array.isArray(y)){for(var $=0;$<y.length;$++)bt(f,y[$],x,I,M);return null}return x=Bc(x),f&&f[Pr]?f.K(y,x,l(I)?!!I.capture:!1,M):rr(f,y,x,!1,I,M)}function rr(f,y,x,I,M,$){if(!y)throw Error("Invalid event type");var W=l(M)?!!M.capture:!!M,Me=nn(f);if(Me||(f[Te]=Me=new be(f)),x=Me.add(y,x,I,W,$),x.proxy)return x;if(I=Yi(),x.proxy=I,I.src=f,I.listener=x,f.addEventListener)rt||(M=W),M===void 0&&(M=!1),f.addEventListener(y.toString(),I,M);else if(f.attachEvent)f.attachEvent(Uc(y.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Yi(){function f(x){return y.call(f.src,f.listener,x)}const y=nr;return f}function Cr(f,y,x,I,M){if(Array.isArray(y))for(var $=0;$<y.length;$++)Cr(f,y[$],x,I,M);else I=l(I)?!!I.capture:!!I,x=Bc(x),f&&f[Pr]?(f=f.i,y=String(y).toString(),y in f.g&&($=f.g[y],x=ht($,x,I,M),-1<x&&(he($[x]),Array.prototype.splice.call($,x,1),$.length==0&&(delete f.g[y],f.h--)))):f&&(f=nn(f))&&(y=f.g[y.toString()],f=-1,y&&(f=ht(y,x,I,M)),(x=-1<f?y[f]:null)&&Xs(x))}function Xs(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[Pr])B(y.i,f);else{var x=f.type,I=f.proxy;y.removeEventListener?y.removeEventListener(x,I,f.capture):y.detachEvent?y.detachEvent(Uc(x),I):y.addListener&&y.removeListener&&y.removeListener(I),(x=nn(y))?(B(x,f),x.h==0&&(x.src=null,y[Te]=null)):he(f)}}}function Uc(f){return f in vt?vt[f]:vt[f]="on"+f}function nr(f,y){if(f.da)f=!0;else{y=new ze(y,this);var x=f.listener,I=f.ha||f.src;f.fa&&Xs(f),f=x.call(I,y)}return f}function nn(f){return f=f[Te],f instanceof be?f:null}var Qs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bc(f){return typeof f=="function"?f:(f[Qs]||(f[Qs]=function(y){return f.handleEvent(y)}),f[Qs])}function at(){q.call(this),this.i=new be(this),this.M=this,this.F=null}v(at,q),at.prototype[Pr]=!0,at.prototype.removeEventListener=function(f,y,x,I){Cr(this,f,y,x,I)};function Ot(f,y){var x,I=f.F;if(I)for(x=[];I;I=I.F)x.push(I);if(f=f.M,I=y.type||y,typeof y=="string")y=new J(y,f);else if(y instanceof J)y.target=y.target||f;else{var M=y;y=new J(I,f),O(y,M)}if(M=!0,x)for(var $=x.length-1;0<=$;$--){var W=y.g=x[$];M=Zi(W,I,!0,y)&&M}if(W=y.g=f,M=Zi(W,I,!0,y)&&M,M=Zi(W,I,!1,y)&&M,x)for($=0;$<x.length;$++)W=y.g=x[$],M=Zi(W,I,!1,y)&&M}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var x=f.g[y],I=0;I<x.length;I++)he(x[I]);delete f.g[y],f.h--}}this.F=null},at.prototype.K=function(f,y,x,I){return this.i.add(String(f),y,!1,x,I)},at.prototype.L=function(f,y,x,I){return this.i.add(String(f),y,!0,x,I)};function Zi(f,y,x,I){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var M=!0,$=0;$<y.length;++$){var W=y[$];if(W&&!W.da&&W.capture==x){var Me=W.listener,Mt=W.ha||W.src;W.fa&&B(f.i,W),M=Me.call(Mt,I)!==!1&&M}}return M&&!I.defaultPrevented}function Qa(f,y,x){if(typeof f=="function")x&&(f=m(f,x));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function jn(f){f.g=Qa(()=>{f.g=null,f.i&&(f.i=!1,jn(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class Hc extends q{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:jn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(f){q.call(this),this.h=f,this.g={}}v(kr,q);var Wc=[];function qc(f){D(f.g,function(y,x){this.g.hasOwnProperty(x)&&Xs(y)},f),f.g={}}kr.prototype.N=function(){kr.aa.N.call(this),qc(this)},kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ja=o.JSON.stringify,Kc=o.JSON.parse,Ih=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Xi(){}Xi.prototype.h=null;function Wr(f){return f.h||(f.h=f.i())}function Gc(){}var Qi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function es(){J.call(this,"d")}v(es,J);function ts(){J.call(this,"c")}v(ts,J);var le={},st=null;function ot(){return st=st||new at}le.La="serverreachability";function qt(f){J.call(this,le.La,f)}v(qt,J);function an(f){const y=ot();Ot(y,new qt(y))}le.STAT_EVENT="statevent";function ft(f,y){J.call(this,le.STAT_EVENT,f),this.stat=y}v(ft,J);function Re(f){const y=ot();Ot(y,new ft(y,f))}le.Ma="timingevent";function Ji(f,y){J.call(this,le.Ma,f),this.size=y}v(Ji,J);function Rt(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function Yc(f,y,x,I,M,$){f.info(function(){if(f.g)if($)for(var W="",Me=$.split("&"),Mt=0;Mt<Me.length;Mt++){var Ie=Me[Mt].split("=");if(1<Ie.length){var Kt=Ie[0];Ie=Ie[1];var Gt=Kt.split("_");W=2<=Gt.length&&Gt[1]=="type"?W+(Kt+"="+Ie+"&"):W+(Kt+"=redacted&")}}else W=null;else W=$;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+y+`
`+x+`
`+W})}function On(f,y,x,I,M,$,W){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+y+`
`+x+`
`+$+" "+W})}function ea(f,y,x,I){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+WC(f,x)+(I?" "+I:"")})}function HC(f,y){f.info(function(){return"TIMEOUT: "+y})}Dt.prototype.info=function(){};function WC(f,y){if(!f.g)return y;if(!y)return null;try{var x=JSON.parse(y);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var I=x[f];if(!(2>I.length)){var M=I[1];if(Array.isArray(M)&&!(1>M.length)){var $=M[0];if($!="noop"&&$!="stop"&&$!="close")for(var W=1;W<M.length;W++)M[W]=""}}}}return Ja(x)}catch{return y}}var Zc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fy={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ph;function Xc(){}v(Xc,Xi),Xc.prototype.g=function(){return new XMLHttpRequest},Xc.prototype.i=function(){return{}},Ph=new Xc;function ci(f,y,x,I){this.j=f,this.i=y,this.l=x,this.R=I||1,this.U=new kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Uy}function Uy(){this.i=null,this.g="",this.h=!1}var By={},Ch={};function kh(f,y,x){f.L=1,f.v=tl(Rn(y)),f.m=x,f.P=!0,Hy(f,null)}function Hy(f,y){f.F=Date.now(),Qc(f),f.A=Rn(f.v);var x=f.A,I=f.R;Array.isArray(I)||(I=[String(I)]),iv(x.i,"t",I),f.C=0,x=f.j.J,f.h=new Uy,f.g=_v(f.j,x?y:null,!f.m),0<f.O&&(f.M=new Hc(m(f.Y,f,f.g),f.O)),y=f.U,x=f.g,I=f.ca;var M="readystatechange";Array.isArray(M)||(M&&(Wc[0]=M.toString()),M=Wc);for(var $=0;$<M.length;$++){var W=bt(x,M[$],I||y.handleEvent,!1,y.h||y);if(!W)break;y.g[W.key]=W}y=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),an(),Yc(f.i,f.u,f.A,f.l,f.R,f.m)}ci.prototype.ca=function(f){f=f.target;const y=this.M;y&&Dn(f)==3?y.j():this.Y(f)},ci.prototype.Y=function(f){try{if(f==this.g)e:{const Gt=Dn(this.g);var y=this.g.Ba();const is=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||dv(this.g)))){this.J||Gt!=4||y==7||(y==8||0>=is?an(3):an(2)),Nh(this);var x=this.g.Z();this.X=x;t:if(Wy(this)){var I=dv(this.g);f="";var M=I.length,$=Dn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ta(this),Js(this);var W="";break t}this.h.i=new o.TextDecoder}for(y=0;y<M;y++)this.h.h=!0,f+=this.h.i.decode(I[y],{stream:!($&&y==M-1)});I.length=0,this.h.g+=f,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=x==200,On(this.i,this.u,this.A,this.l,this.R,Gt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Mt=this.g;if((Me=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Me)){var Ie=Me;break t}}Ie=null}if(x=Ie)ea(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,jh(this,x);else{this.o=!1,this.s=3,Re(12),ta(this),Js(this);break e}}if(this.P){x=!0;let qr;for(;!this.J&&this.C<W.length;)if(qr=qC(this,W),qr==Ch){Gt==4&&(this.s=4,Re(14),x=!1),ea(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==By){this.s=4,Re(15),ea(this.i,this.l,W,"[Invalid Chunk]"),x=!1;break}else ea(this.i,this.l,qr,null),jh(this,qr);if(Wy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||W.length!=0||this.h.h||(this.s=1,Re(16),x=!1),this.o=this.o&&x,!x)ea(this.i,this.l,W,"[Invalid Chunked Response]"),ta(this),Js(this);else if(0<W.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),$h(Kt),Kt.M=!0,Re(11))}}else ea(this.i,this.l,W,null),jh(this,W);Gt==4&&ta(this),this.o&&!this.J&&(Gt==4?vv(this.j,this):(this.o=!1,Qc(this)))}else lk(this.g),x==400&&0<W.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),ta(this),Js(this)}}}catch{}finally{}};function Wy(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function qC(f,y){var x=f.C,I=y.indexOf(`
`,x);return I==-1?Ch:(x=Number(y.substring(x,I)),isNaN(x)?By:(I+=1,I+x>y.length?Ch:(y=y.slice(I,I+x),f.C=I+x,y)))}ci.prototype.cancel=function(){this.J=!0,ta(this)};function Qc(f){f.S=Date.now()+f.I,qy(f,f.I)}function qy(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(m(f.ba,f),y)}function Nh(f){f.B&&(o.clearTimeout(f.B),f.B=null)}ci.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(HC(this.i,this.A),this.L!=2&&(an(),Re(17)),ta(this),this.s=2,Js(this)):qy(this,this.S-f)};function Js(f){f.j.G==0||f.J||vv(f.j,f)}function ta(f){Nh(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,qc(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function jh(f,y){try{var x=f.j;if(x.G!=0&&(x.g==f||Oh(x.h,f))){if(!f.K&&Oh(x.h,f)&&x.G==3){try{var I=x.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)ol(x),al(x);else break e;Lh(x),Re(18)}}else x.za=M[1],0<x.za-x.T&&37500>M[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rt(m(x.Za,x),6e3));if(1>=Yy(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else na(x,11)}else if((f.K||x.g==f)&&ol(x),!T(y))for(M=x.Da.g.parse(y),y=0;y<M.length;y++){let Ie=M[y];if(x.T=Ie[0],Ie=Ie[1],x.G==2)if(Ie[0]=="c"){x.K=Ie[1],x.ia=Ie[2];const Kt=Ie[3];Kt!=null&&(x.la=Kt,x.j.info("VER="+x.la));const Gt=Ie[4];Gt!=null&&(x.Aa=Gt,x.j.info("SVER="+x.Aa));const is=Ie[5];is!=null&&typeof is=="number"&&0<is&&(I=1.5*is,x.L=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const qr=f.g;if(qr){const ll=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ll){var $=I.h;$.g||ll.indexOf("spdy")==-1&&ll.indexOf("quic")==-1&&ll.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Rh($,$.h),$.h=null))}if(I.D){const Vh=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;Vh&&(I.ya=Vh,Be(I.I,I.D,Vh))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),I=x;var W=f;if(I.qa=wv(I,I.J?I.ia:null,I.W),W.K){Zy(I.h,W);var Me=W,Mt=I.L;Mt&&(Me.I=Mt),Me.B&&(Nh(Me),Qc(Me)),I.g=W}else gv(I);0<x.i.length&&sl(x)}else Ie[0]!="stop"&&Ie[0]!="close"||na(x,7);else x.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?na(x,7):Mh(x):Ie[0]!="noop"&&x.l&&x.l.ta(Ie),x.v=0)}}an(4)}catch{}}var KC=class{constructor(f,y){this.g=f,this.map=y}};function Ky(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Gy(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Yy(f){return f.h?1:f.g?f.g.size:0}function Oh(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function Rh(f,y){f.g?f.g.add(y):f.h=y}function Zy(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}Ky.prototype.cancel=function(){if(this.i=Xy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Xy(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const x of f.g.values())y=y.concat(x.D);return y}return b(f.i)}function GC(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var y=[],x=f.length,I=0;I<x;I++)y.push(f[I]);return y}y=[],x=0;for(I in f)y[x++]=f[I];return y}function YC(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var y=[];f=f.length;for(var x=0;x<f;x++)y.push(x);return y}y=[],x=0;for(const I in f)y[x++]=I;return y}}}function Qy(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var x=YC(f),I=GC(f),M=I.length,$=0;$<M;$++)y.call(void 0,I[$],x&&x[$],f)}var Jy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZC(f,y){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var I=f[x].indexOf("="),M=null;if(0<=I){var $=f[x].substring(0,I);M=f[x].substring(I+1)}else $=f[x];y($,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function ra(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof ra){this.h=f.h,Jc(this,f.j),this.o=f.o,this.g=f.g,el(this,f.s),this.l=f.l;var y=f.i,x=new ro;x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),ev(this,x),this.m=f.m}else f&&(y=String(f).match(Jy))?(this.h=!1,Jc(this,y[1]||"",!0),this.o=eo(y[2]||""),this.g=eo(y[3]||"",!0),el(this,y[4]),this.l=eo(y[5]||"",!0),ev(this,y[6]||"",!0),this.m=eo(y[7]||"")):(this.h=!1,this.i=new ro(null,this.h))}ra.prototype.toString=function(){var f=[],y=this.j;y&&f.push(to(y,tv,!0),":");var x=this.g;return(x||y=="file")&&(f.push("//"),(y=this.o)&&f.push(to(y,tv,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(to(x,x.charAt(0)=="/"?JC:QC,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",to(x,tk)),f.join("")};function Rn(f){return new ra(f)}function Jc(f,y,x){f.j=x?eo(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function el(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function ev(f,y,x){y instanceof ro?(f.i=y,rk(f.i,f.h)):(x||(y=to(y,ek)),f.i=new ro(y,f.h))}function Be(f,y,x){f.i.set(y,x)}function tl(f){return Be(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function eo(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function to(f,y,x){return typeof f=="string"?(f=encodeURI(f).replace(y,XC),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function XC(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var tv=/[#\/\?@]/g,QC=/[#\?:]/g,JC=/[#\?]/g,ek=/[#\?@]/g,tk=/#/g;function ro(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function li(f){f.g||(f.g=new Map,f.h=0,f.i&&ZC(f.i,function(y,x){f.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=ro.prototype,t.add=function(f,y){li(this),this.i=null,f=rs(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(y),this.h+=1,this};function rv(f,y){li(f),y=rs(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function nv(f,y){return li(f),y=rs(f,y),f.g.has(y)}t.forEach=function(f,y){li(this),this.g.forEach(function(x,I){x.forEach(function(M){f.call(y,M,I,this)},this)},this)},t.na=function(){li(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),x=[];for(let I=0;I<y.length;I++){const M=f[I];for(let $=0;$<M.length;$++)x.push(y[I])}return x},t.V=function(f){li(this);let y=[];if(typeof f=="string")nv(this,f)&&(y=y.concat(this.g.get(rs(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)y=y.concat(f[x])}return y},t.set=function(f,y){return li(this),this.i=null,f=rs(this,f),nv(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function iv(f,y,x){rv(f,y),0<x.length&&(f.i=null,f.g.set(rs(f,y),b(x)),f.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var x=0;x<y.length;x++){var I=y[x];const $=encodeURIComponent(String(I)),W=this.V(I);for(I=0;I<W.length;I++){var M=$;W[I]!==""&&(M+="="+encodeURIComponent(String(W[I]))),f.push(M)}}return this.i=f.join("&")};function rs(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function rk(f,y){y&&!f.j&&(li(f),f.i=null,f.g.forEach(function(x,I){var M=I.toLowerCase();I!=M&&(rv(this,I),iv(this,M,x))},f)),f.j=y}function nk(f,y){const x=new Dt;if(o.Image){const I=new Image;I.onload=p(ui,x,"TestLoadImage: loaded",!0,y,I),I.onerror=p(ui,x,"TestLoadImage: error",!1,y,I),I.onabort=p(ui,x,"TestLoadImage: abort",!1,y,I),I.ontimeout=p(ui,x,"TestLoadImage: timeout",!1,y,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else y(!1)}function ik(f,y){const x=new Dt,I=new AbortController,M=setTimeout(()=>{I.abort(),ui(x,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:I.signal}).then($=>{clearTimeout(M),$.ok?ui(x,"TestPingServer: ok",!0,y):ui(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(M),ui(x,"TestPingServer: error",!1,y)})}function ui(f,y,x,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(x)}catch{}}function ak(){this.g=new Ih}function sk(f,y,x){const I=x||"";try{Qy(f,function(M,$){let W=M;l(M)&&(W=Ja(M)),y.push(I+$+"="+encodeURIComponent(W))})}catch(M){throw y.push(I+"type="+encodeURIComponent("_badmap")),M}}function rl(f){this.l=f.Ub||null,this.j=f.eb||!1}v(rl,Xi),rl.prototype.g=function(){return new nl(this.l,this.j)},rl.prototype.i=function(f){return function(){return f}}({});function nl(f,y){at.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(nl,at),t=nl.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,io(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,no(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,io(this)),this.g&&(this.readyState=3,io(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;av(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function av(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?no(this):io(this),this.readyState==3&&av(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,no(this))},t.Qa=function(f){this.g&&(this.response=f,no(this))},t.ga=function(){this.g&&no(this)};function no(f){f.readyState=4,f.l=null,f.j=null,f.v=null,io(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=y.next();return f.join(`\r
`)};function io(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(nl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function sv(f){let y="";return D(f,function(x,I){y+=I,y+=":",y+=x,y+=`\r
`}),y}function Dh(f,y,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=sv(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):Be(f,y,x))}function nt(f){at.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(nt,at);var ok=/^https?$/i,ck=["POST","PUT"];t=nt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ph.g(),this.v=this.o?Wr(this.o):Wr(Ph),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch($){ov(this,$);return}if(f=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)x.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const $ of I.keys())x.set($,I.get($));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),M=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(ck,y,void 0))||I||M||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,W]of x)this.g.setRequestHeader($,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{uv(this),this.u=!0,this.g.send(f),this.u=!1}catch($){ov(this,$)}};function ov(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,cv(f),il(f)}function cv(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),il(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),il(this,!0)),nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?lv(this):this.bb())},t.bb=function(){lv(this)};function lv(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Dn(f)!=4||f.Z()!=2)){if(f.u&&Dn(f)==4)Qa(f.Ea,0,f);else if(Ot(f,"readystatechange"),Dn(f)==4){f.h=!1;try{const W=f.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var I;if(I=W===0){var M=String(f.D).match(Jy)[1]||null;!M&&o.self&&o.self.location&&(M=o.self.location.protocol.slice(0,-1)),I=!ok.test(M?M.toLowerCase():"")}x=I}if(x)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var $=2<Dn(f)?f.g.statusText:""}catch{$=""}f.l=$+" ["+f.Z()+"]",cv(f)}}finally{il(f)}}}}function il(f,y){if(f.g){uv(f);const x=f.g,I=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Ot(f,"ready");try{x.onreadystatechange=I}catch{}}}function uv(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Dn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Dn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),Kc(y)}};function dv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function lk(f){const y={};f=(f.g&&2<=Dn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(T(f[I]))continue;var x=N(f[I]);const M=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=y[M]||[];y[M]=$,$.push(x)}S(y,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ao(f,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||y}function hv(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ao("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ao("baseRetryDelayMs",5e3,f),this.cb=ao("retryDelaySeedMs",1e4,f),this.Wa=ao("forwardChannelMaxRetries",2,f),this.wa=ao("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Ky(f&&f.concurrentRequestLimit),this.Da=new ak,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=hv.prototype,t.la=8,t.G=1,t.connect=function(f,y,x,I){Re(0),this.W=f,this.H=y||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.I=wv(this,null,this.W),sl(this)};function Mh(f){if(fv(f),f.G==3){var y=f.U++,x=Rn(f.I);if(Be(x,"SID",f.K),Be(x,"RID",y),Be(x,"TYPE","terminate"),so(f,x),y=new ci(f,f.j,y),y.L=2,y.v=tl(Rn(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=y.v,x=!0),x||(y.g=_v(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Qc(y)}xv(f)}function al(f){f.g&&($h(f),f.g.cancel(),f.g=null)}function fv(f){al(f),f.u&&(o.clearTimeout(f.u),f.u=null),ol(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function sl(f){if(!Gy(f.h)&&!f.s){f.s=!0;var y=f.Ga;ee||Ue(),fe||(ee(),fe=!0),ye.add(y,f),f.B=0}}function uk(f,y){return Yy(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(m(f.Ga,f,y),bv(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const M=new ci(this,this.j,f);let $=this.o;if(this.S&&($?($=A($),O($,this.S)):$=this.S),this.m!==null||this.O||(M.H=$,$=null),this.P)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=pv(this,M,y),x=Rn(this.I),Be(x,"RID",f),Be(x,"CVER",22),this.D&&Be(x,"X-HTTP-Session-Id",this.D),so(this,x),$&&(this.O?y="headers="+encodeURIComponent(String(sv($)))+"&"+y:this.m&&Dh(x,this.m,$)),Rh(this.h,M),this.Ua&&Be(x,"TYPE","init"),this.P?(Be(x,"$req",y),Be(x,"SID","null"),M.T=!0,kh(M,x,null)):kh(M,x,y),this.G=2}}else this.G==3&&(f?mv(this,f):this.i.length==0||Gy(this.h)||mv(this))};function mv(f,y){var x;y?x=y.l:x=f.U++;const I=Rn(f.I);Be(I,"SID",f.K),Be(I,"RID",x),Be(I,"AID",f.T),so(f,I),f.m&&f.o&&Dh(I,f.m,f.o),x=new ci(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),y&&(f.i=y.D.concat(f.i)),y=pv(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Rh(f.h,x),kh(x,I,y)}function so(f,y){f.H&&D(f.H,function(x,I){Be(y,I,x)}),f.l&&Qy({},function(x,I){Be(y,I,x)})}function pv(f,y,x){x=Math.min(f.i.length,x);var I=f.l?m(f.l.Na,f.l,f):null;e:{var M=f.i;let $=-1;for(;;){const W=["count="+x];$==-1?0<x?($=M[0].g,W.push("ofs="+$)):$=0:W.push("ofs="+$);let Me=!0;for(let Mt=0;Mt<x;Mt++){let Ie=M[Mt].g;const Kt=M[Mt].map;if(Ie-=$,0>Ie)$=Math.max(0,M[Mt].g-100),Me=!1;else try{sk(Kt,W,"req"+Ie+"_")}catch{I&&I(Kt)}}if(Me){I=W.join("&");break e}}}return f=f.i.splice(0,x),y.D=f,I}function gv(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;ee||Ue(),fe||(ee(),fe=!0),ye.add(y,f),f.v=0}}function Lh(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(m(f.Fa,f),bv(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,yv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),al(this),yv(this))};function $h(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function yv(f){f.g=new ci(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=Rn(f.qa);Be(y,"RID","rpc"),Be(y,"SID",f.K),Be(y,"AID",f.T),Be(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Be(y,"TO",f.ja),Be(y,"TYPE","xmlhttp"),so(f,y),f.m&&f.o&&Dh(y,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=tl(Rn(y)),x.m=null,x.P=!0,Hy(x,f)}t.Za=function(){this.C!=null&&(this.C=null,al(this),Lh(this),Re(19))};function ol(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function vv(f,y){var x=null;if(f.g==y){ol(f),$h(f),f.g=null;var I=2}else if(Oh(f.h,y))x=y.D,Zy(f.h,y),I=1;else return;if(f.G!=0){if(y.o)if(I==1){x=y.m?y.m.length:0,y=Date.now()-y.F;var M=f.B;I=ot(),Ot(I,new Ji(I,x)),sl(f)}else gv(f);else if(M=y.s,M==3||M==0&&0<y.X||!(I==1&&uk(f,y)||I==2&&Lh(f)))switch(x&&0<x.length&&(y=f.h,y.i=y.i.concat(x)),M){case 1:na(f,5);break;case 4:na(f,10);break;case 3:na(f,6);break;default:na(f,2)}}}function bv(f,y){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*y}function na(f,y){if(f.j.info("Error code "+y),y==2){var x=m(f.fb,f),I=f.Xa;const M=!I;I=new ra(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Jc(I,"https"),tl(I),M?nk(I.toString(),x):ik(I.toString(),x)}else Re(2);f.G=0,f.l&&f.l.sa(y),xv(f),fv(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function xv(f){if(f.G=0,f.ka=[],f.l){const y=Xy(f.h);(y.length!=0||f.i.length!=0)&&(g(f.ka,y),g(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function wv(f,y,x){var I=x instanceof ra?Rn(x):new ra(x);if(I.g!="")y&&(I.g=y+"."+I.g),el(I,I.s);else{var M=o.location;I=M.protocol,y=y?y+"."+M.hostname:M.hostname,M=+M.port;var $=new ra(null);I&&Jc($,I),y&&($.g=y),M&&el($,M),x&&($.l=x),I=$}return x=f.D,y=f.ya,x&&y&&Be(I,x,y),Be(I,"VER",f.la),so(f,I),I}function _v(f,y,x){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new nt(new rl({eb:x})):new nt(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ev(){}t=Ev.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function cl(){}cl.prototype.g=function(f,y){return new gr(f,y)};function gr(f,y){at.call(this),this.g=new hv(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!T(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new ns(this)}v(gr,at),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Mh(this.g)},gr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=Ja(f),f=x);y.i.push(new KC(y.Ya++,f)),y.G==3&&sl(y)},gr.prototype.N=function(){this.g.l=null,delete this.j,Mh(this.g),delete this.g,gr.aa.N.call(this)};function Tv(f){es.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const x in y){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}v(Tv,es);function Av(){ts.call(this),this.status=1}v(Av,ts);function ns(f){this.g=f}v(ns,Ev),ns.prototype.ua=function(){Ot(this.g,"a")},ns.prototype.ta=function(f){Ot(this.g,new Tv(f))},ns.prototype.sa=function(f){Ot(this.g,new Av)},ns.prototype.ra=function(){Ot(this.g,"b")},cl.prototype.createWebChannel=cl.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,qE=function(){return new cl},WE=function(){return ot()},HE=le,Wf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zc.NO_ERROR=0,Zc.TIMEOUT=8,Zc.HTTP_ERROR=6,Ul=Zc,Fy.COMPLETE="complete",BE=Fy,Gc.EventType=Qi,Qi.OPEN="a",Qi.CLOSE="b",Qi.ERROR="c",Qi.MESSAGE="d",at.prototype.listen=at.prototype.K,So=Gc,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,UE=nt}).apply(typeof dl<"u"?dl:typeof self<"u"?self:typeof window<"u"?window:{});const p0="@firebase/firestore",g0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=new up("@firebase/firestore");function os(){return ka.logLevel}function Y(t,...e){if(ka.logLevel<=xe.DEBUG){const r=e.map(wp);ka.debug(`Firestore (${$s}): ${t}`,...r)}}function Xn(t,...e){if(ka.logLevel<=xe.ERROR){const r=e.map(wp);ka.error(`Firestore (${$s}): ${t}`,...r)}}function Ts(t,...e){if(ka.logLevel<=xe.WARN){const r=e.map(wp);ka.warn(`Firestore (${$s}): ${t}`,...r)}}function wp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function de(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,KE(t,n,r)}function KE(t,e,r){let n=`FIRESTORE (${$s}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Xn(n),new Error(n)}function Ne(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||KE(e,i,n)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Cn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Xt.UNAUTHENTICATED))}shutdown(){}}class ZR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class XR{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ne(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ci,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ci)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ne(typeof n.accessToken=="string",31837,{l:n}),new GE(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new Xt(e)}}class QR{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class JR{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new QR(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class y0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class e2{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ne(this.o===void 0,3512);const n=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new y0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ne(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new y0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=t2(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function we(t,e){return t<e?-1:t>e?1:0}function qf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return Zh(i)===Zh(a)?we(i,a):Zh(i)?1:-1}return we(t.length,e.length)}const r2=55296,n2=57343;function Zh(t){const e=t.charCodeAt(0);return e>=r2&&e<=n2}function As(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0="__name__";class cn{constructor(e,r,n){r===void 0?r=0:r>e.length&&de(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&de(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return cn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof cn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=cn.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return we(e.length,r.length)}static compareSegments(e,r){const n=cn.isNumericId(e),i=cn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?cn.extractNumericId(e).compare(cn.extractNumericId(r)):qf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pi.fromString(e.substring(4,e.length-2))}}class Xe extends cn{construct(e,r,n){return new Xe(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new re(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Xe(r)}static emptyPath(){return new Xe([])}}const i2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ft extends cn{construct(e,r,n){return new Ft(e,r,n)}static isValidIdentifier(e){return i2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ft.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===v0}static keyField(){return new Ft([v0])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new re(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new re(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new re(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new re(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ft(r)}static emptyPath(){return new Ft([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Xe.fromString(e))}static fromName(e){return new ae(Xe.fromString(e).popFirst(5))}static empty(){return new ae(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Xe.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a2(t,e,r){if(!r)throw new re(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function s2(t,e,r,n){if(e===!0&&n===!0)throw new re(U.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function b0(t){if(!ae.isDocumentKey(t))throw new re(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function YE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ep(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":de(12329,{type:typeof t})}function Zo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ep(t);throw new re(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t,e){const r={typeString:t};return e&&(r.value=e),r}function Tc(t,e){if(!YE(t))throw new re(U.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new re(U.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0=-62135596800,w0=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*w0);return new qe(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<x0)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/w0}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Tc(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-x0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:gt("string",qe._jsonSchemaVersion),seconds:gt("number"),nanoseconds:gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{static fromTimestamp(e){return new me(e)}static min(){return new me(new qe(0,0))}static max(){return new me(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=-1;function o2(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=me.fromTimestamp(n===1e9?new qe(r+1,0):new qe(r,n));return new ji(i,ae.empty(),e)}function c2(t){return new ji(t.readTime,t.key,Xo)}class ji{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ji(me.min(),ae.empty(),Xo)}static max(){return new ji(me.max(),ae.empty(),Xo)}}function l2(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ae.comparator(t.documentKey,e.documentKey),r!==0?r:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class d2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vs(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==u2)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&de(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new F((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof F?r:F.resolve(r)}catch(r){return F.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):F.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):F.reject(r)}static resolve(e){return new F((r,n)=>{r(e)})}static reject(e){return new F((r,n)=>{n(e)})}static waitFor(e){return new F((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},c=>n(c))}),s=!0,a===i&&r()})}static or(e){let r=F.resolve(!1);for(const n of e)r=r.next(i=>i?F.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new F((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let c=0;c<a;c++){const l=c;r(e[l]).next(d=>{s[l]=d,++o,o===a&&n(s)},d=>i(d))}})}static doWhile(e,r){return new F((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function h2(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function zs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=-1;function vd(t){return t==null}function hu(t){return t===0&&1/t==-1/0}function f2(t){return typeof t=="number"&&Number.isInteger(t)&&!hu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="";function m2(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=_0(e)),e=p2(t.get(r),e);return _0(e)}function p2(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case ZE:r+="";break;default:r+=a}}return r}function _0(t){return t+ZE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Fa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function XE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,r){this.comparator=e,this.root=r||Vt.EMPTY}insert(e,r){return new Qe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new Qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hl(this.root,e,this.comparator,!1)}getReverseIterator(){return new hl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hl(this.root,e,this.comparator,!0)}}class hl{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Vt.RED,this.left=i??Vt.EMPTY,this.right=a??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Vt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw de(43730,{key:this.key,value:this.value});if(this.right.isRed())throw de(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw de(27949);return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw de(57766)}get value(){throw de(16141)}get color(){throw de(16727)}get left(){throw de(29726)}get right(){throw de(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Vt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new T0(this.data.getIterator())}getIteratorFrom(e){return new T0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new At(this.comparator);return r.data=e,r}}class T0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.fields=e,e.sort(Ft.comparator)}static empty(){return new Xr([])}unionWith(e){let r=new At(Ft.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return As(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new QE("Invalid base64 string: "+a):a}}(e);return new Bt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Bt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const g2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oi(t){if(Ne(!!t,39018),typeof t=="string"){let e=0;const r=g2.exec(t);if(Ne(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ri(t){return typeof t=="string"?Bt.fromBase64String(t):Bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="server_timestamp",e1="__type__",t1="__previous_value__",r1="__local_write_time__";function Ap(t){return(t?.mapValue?.fields||{})[e1]?.stringValue===JE}function bd(t){const e=t.mapValue.fields[t1];return Ap(e)?bd(e):e}function Qo(t){const e=Oi(t.mapValue.fields[r1].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,r,n,i,a,s,o,c,l,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=d}}const fu="(default)";class Jo{constructor(e,r){this.projectId=e,this.database=r||fu}static empty(){return new Jo("","")}get isDefaultDatabase(){return this.database===fu}isEqual(e){return e instanceof Jo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1="__type__",v2="__max__",fl={mapValue:{}},i1="__vector__",mu="value";function Di(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ap(t)?4:x2(t)?9007199254740991:b2(t)?10:11:de(28295,{value:t})}function Tn(t,e){if(t===e)return!0;const r=Di(t);if(r!==Di(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qo(t).isEqual(Qo(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Oi(i.timestampValue),o=Oi(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Ri(i.bytesValue).isEqual(Ri(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return ct(i.geoPointValue.latitude)===ct(a.geoPointValue.latitude)&&ct(i.geoPointValue.longitude)===ct(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return ct(i.integerValue)===ct(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=ct(i.doubleValue),o=ct(a.doubleValue);return s===o?hu(s)===hu(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return As(t.arrayValue.values||[],e.arrayValue.values||[],Tn);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(E0(s)!==E0(o))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(o[c]===void 0||!Tn(s[c],o[c])))return!1;return!0}(t,e);default:return de(52216,{left:t})}}function ec(t,e){return(t.values||[]).find(r=>Tn(r,e))!==void 0}function Ss(t,e){if(t===e)return 0;const r=Di(t),n=Di(e);if(r!==n)return we(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=ct(a.integerValue||a.doubleValue),c=ct(s.integerValue||s.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return A0(t.timestampValue,e.timestampValue);case 4:return A0(Qo(t),Qo(e));case 5:return qf(t.stringValue,e.stringValue);case 6:return function(a,s){const o=Ri(a),c=Ri(s);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),c=s.split("/");for(let l=0;l<o.length&&l<c.length;l++){const d=we(o[l],c[l]);if(d!==0)return d}return we(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=we(ct(a.latitude),ct(s.latitude));return o!==0?o:we(ct(a.longitude),ct(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return S0(t.arrayValue,e.arrayValue);case 10:return function(a,s){const o=a.fields||{},c=s.fields||{},l=o[mu]?.arrayValue,d=c[mu]?.arrayValue,h=we(l?.values?.length||0,d?.values?.length||0);return h!==0?h:S0(l,d)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===fl.mapValue&&s===fl.mapValue)return 0;if(a===fl.mapValue)return 1;if(s===fl.mapValue)return-1;const o=a.fields||{},c=Object.keys(o),l=s.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const m=qf(c[h],d[h]);if(m!==0)return m;const p=Ss(o[c[h]],l[d[h]]);if(p!==0)return p}return we(c.length,d.length)}(t.mapValue,e.mapValue);default:throw de(23264,{he:r})}}function A0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const r=Oi(t),n=Oi(e),i=we(r.seconds,n.seconds);return i!==0?i:we(r.nanos,n.nanos)}function S0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=Ss(r[i],n[i]);if(a)return a}return we(r.length,n.length)}function Is(t){return Kf(t)}function Kf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Oi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Ri(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=Kf(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${Kf(r.fields[s])}`;return i+"}"}(t.mapValue):de(61005,{value:t})}function Bl(t){switch(Di(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=bd(t);return e?16+Bl(e):16;case 5:return 2*t.stringValue.length;case 6:return Ri(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Bl(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Fa(n.fields,(a,s)=>{i+=a.length+Bl(s)}),i}(t.mapValue);default:throw de(13486,{value:t})}}function Gf(t){return!!t&&"integerValue"in t}function Sp(t){return!!t&&"arrayValue"in t}function I0(t){return!!t&&"nullValue"in t}function P0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Hl(t){return!!t&&"mapValue"in t}function b2(t){return(t?.mapValue?.fields||{})[n1]?.stringValue===i1}function Do(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Do(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Do(t.arrayValue.values[r]);return e}return{...t}}function x2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===v2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Hl(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Do(r)}setAll(e){let r=Ft.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=Do(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());Hl(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Tn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Hl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Fa(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Dr(Do(this.value))}}function a1(t){const e=[];return Fa(t.fields,(r,n)=>{const i=new Ft([r]);if(Hl(n)){const a=a1(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Qt(e,0,me.min(),me.min(),me.min(),Dr.empty(),0)}static newFoundDocument(e,r,n,i){return new Qt(e,1,r,me.min(),n,i,0)}static newNoDocument(e,r){return new Qt(e,2,r,me.min(),me.min(),Dr.empty(),0)}static newUnknownDocument(e,r){return new Qt(e,3,r,me.min(),me.min(),Dr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,r){this.position=e,this.inclusive=r}}function C0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=ae.comparator(ae.fromName(s.referenceValue),r.key):n=Ss(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function k0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Tn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,r="asc"){this.field=e,this.dir=r}}function w2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{}class _t extends s1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new E2(e,r,n):r==="array-contains"?new S2(e,n):r==="in"?new I2(e,n):r==="not-in"?new P2(e,n):r==="array-contains-any"?new C2(e,n):new _t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new T2(e,n):new A2(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Ss(r,this.value)):r!==null&&Di(this.value)===Di(r)&&this.matchesComparison(Ss(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return de(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends s1{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new An(e,r)}matches(e){return o1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function o1(t){return t.op==="and"}function c1(t){return _2(t)&&o1(t)}function _2(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function Yf(t){if(t instanceof _t)return t.field.canonicalString()+t.op.toString()+Is(t.value);if(c1(t))return t.filters.map(e=>Yf(e)).join(",");{const e=t.filters.map(r=>Yf(r)).join(",");return`${t.op}(${e})`}}function l1(t,e){return t instanceof _t?function(n,i){return i instanceof _t&&n.op===i.op&&n.field.isEqual(i.field)&&Tn(n.value,i.value)}(t,e):t instanceof An?function(n,i){return i instanceof An&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&l1(s,i.filters[o]),!0):!1}(t,e):void de(19439)}function u1(t){return t instanceof _t?function(r){return`${r.field.canonicalString()} ${r.op} ${Is(r.value)}`}(t):t instanceof An?function(r){return r.op.toString()+" {"+r.getFilters().map(u1).join(" ,")+"}"}(t):"Filter"}class E2 extends _t{constructor(e,r,n){super(e,r,n),this.key=ae.fromName(n.referenceValue)}matches(e){const r=ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class T2 extends _t{constructor(e,r){super(e,"in",r),this.keys=d1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class A2 extends _t{constructor(e,r){super(e,"not-in",r),this.keys=d1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function d1(t,e){return(e.arrayValue?.values||[]).map(r=>ae.fromName(r.referenceValue))}class S2 extends _t{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Sp(r)&&ec(r.arrayValue,this.value)}}class I2 extends _t{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ec(this.value.arrayValue,r)}}class P2 extends _t{constructor(e,r){super(e,"not-in",r)}matches(e){if(ec(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ec(this.value.arrayValue,r)}}class C2 extends _t{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Sp(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ec(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function N0(t,e=null,r=[],n=[],i=null,a=null,s=null){return new k2(t,e,r,n,i,a,s)}function Ip(t){const e=ge(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Yf(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),vd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Is(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Is(n)).join(",")),e.Te=r}return e.Te}function Pp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!w2(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!l1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!k0(t.startAt,e.startAt)&&k0(t.endAt,e.endAt)}function Zf(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function N2(t,e,r,n,i,a,s,o){return new xd(t,e,r,n,i,a,s,o)}function Cp(t){return new xd(t)}function j0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function j2(t){return t.collectionGroup!==null}function Mo(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new At(Ft.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new gu(a,n))}),r.has(Ft.keyField().canonicalString())||e.Ie.push(new gu(Ft.keyField(),n))}return e.Ie}function gn(t){const e=ge(t);return e.Ee||(e.Ee=O2(e,Mo(t))),e.Ee}function O2(t,e){if(t.limitType==="F")return N0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new gu(i.field,a)});const r=t.endAt?new pu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pu(t.startAt.position,t.startAt.inclusive):null;return N0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Xf(t,e,r){return new xd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function wd(t,e){return Pp(gn(t),gn(e))&&t.limitType===e.limitType}function h1(t){return`${Ip(gn(t))}|lt:${t.limitType}`}function cs(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>u1(i)).join(", ")}]`),vd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Is(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Is(i)).join(",")),`Target(${n})`}(gn(t))}; limitType=${t.limitType})`}function _d(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ae.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Mo(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,c){const l=C0(s,o,c);return s.inclusive?l<=0:l<0}(n.startAt,Mo(n),i)||n.endAt&&!function(s,o,c){const l=C0(s,o,c);return s.inclusive?l>=0:l>0}(n.endAt,Mo(n),i))}(t,e)}function R2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function f1(t){return(e,r)=>{let n=!1;for(const i of Mo(t)){const a=D2(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function D2(t,e,r){const n=t.field.isKeyField()?ae.comparator(e.key,r.key):function(a,s,o){const c=s.data.field(a),l=o.data.field(a);return c!==null&&l!==null?Ss(c,l):de(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return de(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Fa(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return XE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2=new Qe(ae.comparator);function Qn(){return M2}const m1=new Qe(ae.comparator);function Io(...t){let e=m1;for(const r of t)e=e.insert(r.key,r);return e}function p1(t){let e=m1;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function la(){return Lo()}function g1(){return Lo()}function Lo(){return new Ua(t=>t.toString(),(t,e)=>t.isEqual(e))}const L2=new Qe(ae.comparator),$2=new At(ae.comparator);function Ee(...t){let e=$2;for(const r of t)e=e.add(r);return e}const V2=new At(we);function z2(){return V2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hu(e)?"-0":e}}function y1(t){return{integerValue:""+t}}function F2(t,e){return f2(e)?y1(e):kp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(){this._=void 0}}function U2(t,e,r){return t instanceof yu?function(i,a){const s={fields:{[e1]:{stringValue:JE},[r1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Ap(a)&&(a=bd(a)),a&&(s.fields[t1]=a),{mapValue:s}}(r,e):t instanceof tc?b1(t,e):t instanceof rc?x1(t,e):function(i,a){const s=v1(i,a),o=O0(s)+O0(i.Ae);return Gf(s)&&Gf(i.Ae)?y1(o):kp(i.serializer,o)}(t,e)}function B2(t,e,r){return t instanceof tc?b1(t,e):t instanceof rc?x1(t,e):r}function v1(t,e){return t instanceof vu?function(n){return Gf(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class yu extends Ed{}class tc extends Ed{constructor(e){super(),this.elements=e}}function b1(t,e){const r=w1(e);for(const n of t.elements)r.some(i=>Tn(i,n))||r.push(n);return{arrayValue:{values:r}}}class rc extends Ed{constructor(e){super(),this.elements=e}}function x1(t,e){let r=w1(e);for(const n of t.elements)r=r.filter(i=>!Tn(i,n));return{arrayValue:{values:r}}}class vu extends Ed{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function O0(t){return ct(t.integerValue||t.doubleValue)}function w1(t){return Sp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function H2(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof tc&&i instanceof tc||n instanceof rc&&i instanceof rc?As(n.elements,i.elements,Tn):n instanceof vu&&i instanceof vu?Tn(n.Ae,i.Ae):n instanceof yu&&i instanceof yu}(t.transform,e.transform)}class W2{constructor(e,r){this.version=e,this.transformResults=r}}class Wn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Wn}static exists(e){return new Wn(void 0,e)}static updateTime(e){return new Wn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Td{}function _1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new T1(t.key,Wn.none()):new Ac(t.key,t.data,Wn.none());{const r=t.data,n=Dr.empty();let i=new At(Ft.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new Ba(t.key,n,new Xr(i.toArray()),Wn.none())}}function q2(t,e,r){t instanceof Ac?function(i,a,s){const o=i.value.clone(),c=D0(i.fieldTransforms,a,s.transformResults);o.setAll(c),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ba?function(i,a,s){if(!Wl(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=D0(i.fieldTransforms,a,s.transformResults),c=a.data;c.setAll(E1(i)),c.setAll(o),a.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function $o(t,e,r,n){return t instanceof Ac?function(a,s,o,c){if(!Wl(a.precondition,s))return o;const l=a.value.clone(),d=M0(a.fieldTransforms,c,s);return l.setAll(d),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ba?function(a,s,o,c){if(!Wl(a.precondition,s))return o;const l=M0(a.fieldTransforms,c,s),d=s.data;return d.setAll(E1(a)),d.setAll(l),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return Wl(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function K2(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=v1(n.transform,i||null);a!=null&&(r===null&&(r=Dr.empty()),r.set(n.field,a))}return r||null}function R0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&As(n,i,(a,s)=>H2(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ac extends Td{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ba extends Td{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function E1(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function D0(t,e,r){const n=new Map;Ne(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,B2(s,o,r[i]))}return n}function M0(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,U2(a,s,e))}return n}class T1 extends Td{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class G2 extends Td{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&q2(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=$o(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=$o(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=g1();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const c=_1(s,o);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(me.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ee())}isEqual(e){return this.batchId===e.batchId&&As(this.mutations,e.mutations,(r,n)=>R0(r,n))&&As(this.baseMutations,e.baseMutations,(r,n)=>R0(r,n))}}class Np{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ne(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return L2}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new Np(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,Ae;function Q2(t){switch(t){case U.OK:return de(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return de(15467,{code:t})}}function A1(t){if(t===void 0)return Xn("GRPC error has no .code"),U.UNKNOWN;switch(t){case pt.OK:return U.OK;case pt.CANCELLED:return U.CANCELLED;case pt.UNKNOWN:return U.UNKNOWN;case pt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case pt.INTERNAL:return U.INTERNAL;case pt.UNAVAILABLE:return U.UNAVAILABLE;case pt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case pt.NOT_FOUND:return U.NOT_FOUND;case pt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case pt.ABORTED:return U.ABORTED;case pt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case pt.DATA_LOSS:return U.DATA_LOSS;default:return de(39323,{code:t})}}(Ae=pt||(pt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new Pi([4294967295,4294967295],0);function L0(t){const e=J2().encode(t),r=new FE;return r.update(e),new Uint8Array(r.digest())}function $0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Pi([r,n],0),new Pi([i,a],0)]}class jp{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Po(`Invalid padding: ${r}`);if(n<0)throw new Po(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Po(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Po(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Pi.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Pi.fromNumber(n)));return i.compare(eD)===1&&(i=new Pi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=L0(e),[n,i]=$0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new jp(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=L0(e),[n,i]=$0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Po extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Sc.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Ad(me.min(),i,new Qe(we),Qn(),Ee())}}class Sc{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Sc(n,r,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class S1{constructor(e,r){this.targetId=e,this.Ce=r}}class I1{constructor(e,r,n=Bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class V0{constructor(){this.ve=0,this.Fe=z0(),this.Me=Bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),r=Ee(),n=Ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:de(38017,{changeType:a})}}),new Sc(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=z0()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qn(),this.Je=ml(),this.He=ml(),this.Ye=new Qe(we)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:de(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(Zf(a))if(n===0){const s=new ae(a.path);this.et(r,s,Qt.newNoDocument(s,me.min()))}else Ne(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),c=o?this.ct(o,e,s):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=Ri(n).toUint8Array()}catch(c){if(c instanceof QE)return Ts("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new jp(s,i,a)}catch(c){return Ts(c instanceof Po?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&Zf(o.target)){const c=new ae(o.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Qt.newNoDocument(c,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=Ee();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new Ad(e,r,this.Ye,this.je,n);return this.je=Qn(),this.Je=ml(),this.He=ml(),this.Ye=new Qe(we),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new V0,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new At(we),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new At(we),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Y("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new V0),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function ml(){return new Qe(ae.comparator)}function z0(){return new Qe(ae.comparator)}const rD={asc:"ASCENDING",desc:"DESCENDING"},nD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iD={and:"AND",or:"OR"};class aD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Qf(t,e){return t.useProto3Json||vd(e)?e:{value:e}}function bu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function P1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sD(t,e){return bu(t,e.toTimestamp())}function yn(t){return Ne(!!t,49232),me.fromTimestamp(function(r){const n=Oi(r);return new qe(n.seconds,n.nanos)}(t))}function Op(t,e){return Jf(t,e).canonicalString()}function Jf(t,e){const r=function(i){return new Xe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function C1(t){const e=Xe.fromString(t);return Ne(R1(e),10190,{key:e.toString()}),e}function em(t,e){return Op(t.databaseId,e.path)}function Xh(t,e){const r=C1(e);if(r.get(1)!==t.databaseId.projectId)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ae(N1(r))}function k1(t,e){return Op(t.databaseId,e)}function oD(t){const e=C1(t);return e.length===4?Xe.emptyPath():N1(e)}function tm(t){return new Xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function N1(t){return Ne(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function F0(t,e,r){return{name:em(t,e),fields:r.value.mapValue.fields}}function cD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:de(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(l,d){return l.useProto3Json?(Ne(d===void 0||typeof d=="string",58123),Bt.fromBase64String(d||"")):(Ne(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Bt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(l){const d=l.code===void 0?U.UNKNOWN:A1(l.code);return new re(d,l.message||"")}(s);r=new I1(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Xh(t,n.document.name),a=yn(n.document.updateTime),s=n.document.createTime?yn(n.document.createTime):me.min(),o=new Dr({mapValue:{fields:n.document.fields}}),c=Qt.newFoundDocument(i,a,s,o),l=n.targetIds||[],d=n.removedTargetIds||[];r=new ql(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Xh(t,n.document),a=n.readTime?yn(n.readTime):me.min(),s=Qt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new ql([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Xh(t,n.document),a=n.removedTargetIds||[];r=new ql([],a,i,null)}else{if(!("filter"in e))return de(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new X2(i,a),o=n.targetId;r=new S1(o,s)}}return r}function lD(t,e){let r;if(e instanceof Ac)r={update:F0(t,e.key,e.value)};else if(e instanceof T1)r={delete:em(t,e.key)};else if(e instanceof Ba)r={update:F0(t,e.key,e.data),updateMask:vD(e.fieldMask)};else{if(!(e instanceof G2))return de(16599,{Vt:e.type});r={verify:em(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof yu)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof tc)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof rc)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof vu)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw de(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:sD(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:de(27497)}(t,e.precondition)),r}function uD(t,e){return t&&t.length>0?(Ne(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?yn(i.updateTime):yn(a);return s.isEqual(me.min())&&(s=yn(a)),new W2(s,i.transformResults||[])}(r,e))):[]}function dD(t,e){return{documents:[k1(t,e.path)]}}function hD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=k1(t,i);const a=function(l){if(l.length!==0)return O1(An.create(l,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(l){if(l.length!==0)return l.map(d=>function(m){return{field:ls(m.field),direction:pD(m.dir)}}(d))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=Qf(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:r,parent:i}}function fD(t){let e=oD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ne(n===1,65062);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(h){const m=j1(h);return m instanceof An&&c1(m)?m.getFilters():[m]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(m=>function(v){return new gu(us(v.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,vd(m)?null:m}(r.limit));let c=null;r.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new pu(p,m)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const m=!h.before,p=h.values||[];return new pu(p,m)}(r.endAt)),N2(e,i,s,a,o,"F",c,l)}function mD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return de(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function j1(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=us(r.unaryFilter.field);return _t.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=us(r.unaryFilter.field);return _t.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=us(r.unaryFilter.field);return _t.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=us(r.unaryFilter.field);return _t.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return de(61313);default:return de(60726)}}(t):t.fieldFilter!==void 0?function(r){return _t.create(us(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return de(58110);default:return de(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return An.create(r.compositeFilter.filters.map(n=>j1(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return de(1026)}}(r.compositeFilter.op))}(t):de(30097,{filter:t})}function pD(t){return rD[t]}function gD(t){return nD[t]}function yD(t){return iD[t]}function ls(t){return{fieldPath:t.canonicalString()}}function us(t){return Ft.fromServerFormat(t.fieldPath)}function O1(t){return t instanceof _t?function(r){if(r.op==="=="){if(P0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NAN"}};if(I0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(P0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NOT_NAN"}};if(I0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ls(r.field),op:gD(r.op),value:r.value}}}(t):t instanceof An?function(r){const n=r.getFilters().map(i=>O1(i));return n.length===1?n[0]:{compositeFilter:{op:yD(r.op),filters:n}}}(t):de(54877,{filter:t})}function vD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function R1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r,n,i,a=me.min(),s=me.min(),o=Bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Ti(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e){this.yt=e}}function xD(t){const e=fD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Xf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(){this.Cn=new _D}addToCollectionParentIndex(e,r){return this.Cn.add(r),F.resolve()}getCollectionParents(e,r){return F.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return F.resolve()}deleteFieldIndex(e,r){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,r){return F.resolve()}getDocumentsMatchingTarget(e,r){return F.resolve(null)}getIndexType(e,r){return F.resolve(0)}getFieldIndexes(e,r){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,r){return F.resolve(ji.min())}getMinOffsetFromCollectionGroup(e,r){return F.resolve(ji.min())}updateCollectionGroup(e,r,n){return F.resolve()}updateIndexEntries(e,r){return F.resolve()}}class _D{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new At(Xe.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new At(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},D1=41943040;class lr{static withCacheSize(e){return new lr(e,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lr.DEFAULT_COLLECTION_PERCENTILE=10,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lr.DEFAULT=new lr(D1,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lr.DISABLED=new lr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ps(0)}static cr(){return new Ps(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B0="LruGarbageCollector",ED=1048576;function H0([t,e],[r,n]){const i=we(t,r);return i===0?we(e,n):i}class TD{constructor(e){this.Ir=e,this.buffer=new At(H0),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();H0(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class AD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(B0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){zs(r)?Y(B0,"Ignoring IndexedDB error during garbage collection: ",r):await Vs(r)}await this.Vr(3e5)})}}class SD{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return F.resolve(yd.ce);const n=new TD(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(U0)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),U0):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,c,l;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),os()<=xe.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function ID(t,e){return new SD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(){this.changes=new Ua(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Qt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?F.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&$o(n.mutation,i,Xr.empty(),qe.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ee()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ee()){const i=la();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=Io();return a.forEach((o,c)=>{s=s.insert(o,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=la();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ee()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=Qn();const s=Lo(),o=function(){return Lo()}();return r.forEach((c,l)=>{const d=n.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof Ba)?a=a.insert(l.key,l):d!==void 0?(s.set(l.key,d.mutation.getFieldMask()),$o(d.mutation,l,d.mutation.getFieldMask(),qe.now())):s.set(l.key,Xr.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((l,d)=>s.set(l,d)),r.forEach((l,d)=>o.set(l,new CD(d,s.get(l)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Lo();let i=new Qe((s,o)=>s-o),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let d=n.get(c)||Xr.empty();d=o.applyToLocalView(l,d),n.set(c,d);const h=(i.get(o.batchId)||Ee()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,d=c.value,h=g1();d.forEach(m=>{if(!a.has(m)){const p=_1(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,h))}return F.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ae.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):j2(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):F.resolve(la());let o=Xo,c=a;return s.next(l=>F.forEach(l,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(d)?F.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{c=c.insert(d,m)}))).next(()=>this.populateOverlays(e,l,a)).next(()=>this.computeViews(e,c,l,Ee())).next(d=>({batchId:o,changes:p1(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ae(r)).next(n=>{let i=Io();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=Io();return this.indexManager.getCollectionParents(e,a).next(o=>F.forEach(o,c=>{const l=function(h,m){return new xd(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(d=>{d.forEach((h,m)=>{s=s.insert(h,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((c,l)=>{const d=l.getKey();s.get(d)===null&&(s=s.insert(d,Qt.newInvalidDocument(d)))});let o=Io();return s.forEach((c,l)=>{const d=a.get(c);d!==void 0&&$o(d.mutation,l,Xr.empty(),qe.now()),_d(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return F.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:yn(i.createTime)}}(r)),F.resolve()}getNamedQuery(e,r){return F.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:xD(i.bundledQuery),readTime:yn(i.readTime)}}(r)),F.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(){this.overlays=new Qe(ae.comparator),this.qr=new Map}getOverlay(e,r){return F.resolve(this.overlays.get(r))}getOverlays(e,r){const n=la();return F.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),F.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),F.resolve()}getOverlaysForCollection(e,r,n){const i=la(),a=r.length+1,s=new ae(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===a&&c.largestBatchId>n&&i.set(c.getKey(),c)}return F.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Qe((l,d)=>l-d);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let d=a.get(l.largestBatchId);d===null&&(d=la(),a=a.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}const o=la(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>o.set(l,d)),!(o.size()>=i)););return F.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new Z2(r,n));let a=this.qr.get(r);a===void 0&&(a=Ee(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,F.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(){this.Qr=new At(It.$r),this.Ur=new At(It.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new It(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new It(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1);let a=Ee();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new It(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class It{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ae.comparator(e.key,r.key)||we(e.Yr,r.Yr)}static Kr(e,r){return we(e.Yr,r.Yr)||ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new At(It.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Y2(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new It(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return F.resolve(s)}lookupMutationBatch(e,r){return F.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return F.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Tp:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new It(r,0),i=new It(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),F.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new At(we);return r.forEach(i=>{const a=new It(i,0),s=new It(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),F.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;ae.isDocumentKey(a)||(a=a.child(""));const s=new It(new ae(a),0);let o=new At(we);return this.Zr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.Yr)),!0)},s),F.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ne(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return F.forEach(r.mutations,i=>{const a=new It(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new It(r,0),i=this.Zr.firstAfterOrEqual(n);return F.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.ri=e,this.docs=function(){return new Qe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return F.resolve(n?n.document.mutableCopy():Qt.newInvalidDocument(r))}getEntries(e,r){let n=Qn();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Qt.newInvalidDocument(i))}),F.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Qn();const s=r.path,o=new ae(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:d}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||l2(c2(d),n)<=0||(i.has(d.key)||_d(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return F.resolve(a)}getAllFromCollectionGroup(e,r,n,i){de(9500)}ii(e,r){return F.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new MD(this)}getSize(e){return F.resolve(this.size)}}class MD extends PD{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),F.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e){this.persistence=e,this.si=new Ua(r=>Ip(r),Pp),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.oi=0,this._i=new Rp,this.targetCount=0,this.ai=Ps.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),F.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ps(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,F.resolve()}updateTargetData(e,r){return this.Pr(r),F.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),F.waitFor(a).next(()=>i)}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return F.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),F.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),F.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),F.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return F.resolve(n)}containsKey(e,r){return F.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e,r){this.ui={},this.overlays={},this.ci=new yd(0),this.li=!1,this.li=!0,this.hi=new OD,this.referenceDelegate=e(this),this.Pi=new LD(this),this.indexManager=new wD,this.remoteDocumentCache=function(i){return new DD(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new bD(r),this.Ii=new ND(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new jD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new RD(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Y("MemoryPersistence","Starting transaction:",e);const i=new $D(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return F.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class $D extends d2{constructor(e){super(),this.currentSequenceNumber=e}}class Dp{constructor(e){this.persistence=e,this.Ri=new Rp,this.Vi=null}static mi(e){return new Dp(e)}get fi(){if(this.Vi)return this.Vi;throw de(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),F.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),F.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),F.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,n=>{const i=ae.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,me.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return F.or([()=>F.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class xu{constructor(e,r){this.persistence=e,this.pi=new Ua(n=>m2(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=ID(this,r)}static mi(e,r){return new xu(e,r)}Ei(){}di(e){return F.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return F.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?F.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,me.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),F.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Bl(e.data.value)),r}br(e,r,n){return F.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return F.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ee(),i=Ee();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Mp(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return mN()?8:h2(tr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new VD;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(os()<=xe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",cs(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(os()<=xe.DEBUG&&Y("QueryEngine","Query:",cs(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(os()<=xe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",cs(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gn(r))):F.resolve())}ys(e,r){if(j0(r))return F.resolve(null);let n=gn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Xf(r,null,"F"),n=gn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=Ee(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Ds(r,o);return this.Cs(r,l,s,c.readTime)?this.ys(e,Xf(r,null,"F")):this.vs(e,l,r,c)}))})))}ws(e,r,n,i){return j0(r)||i.isEqual(me.min())?F.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?F.resolve(null):(os()<=xe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),cs(r)),this.vs(e,s,r,o2(i,Xo)).next(o=>o))})}Ds(e,r){let n=new At(f1(e));return r.forEach((i,a)=>{_d(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return os()<=xe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",cs(r)),this.ps.getDocumentsMatchingQuery(e,r,ji.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="LocalStore",FD=3e8;class UD{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Qe(we),this.xs=new Ua(a=>Ip(a),Pp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new kD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function BD(t,e,r,n){return new UD(t,e,r,n)}async function L1(t,e){const r=ge(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let c=Ee();for(const l of i){s.push(l.batchId);for(const d of l.mutations)c=c.add(d.key)}for(const l of a){o.push(l.batchId);for(const d of l.mutations)c=c.add(d.key)}return r.localDocuments.getDocuments(n,c).next(l=>({Ls:l,removedBatchIds:s,addedBatchIds:o}))})})}function HD(t,e){const r=ge(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,l,d){const h=l.batch,m=h.keys();let p=F.resolve();return m.forEach(v=>{p=p.next(()=>d.getEntry(c,v)).next(b=>{const g=l.docVersions.get(v);Ne(g!==null,48541),b.version.compareTo(g)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),d.addEntry(b)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Ee();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function $1(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function WD(t,e){const r=ge(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((d,h)=>{const m=i.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,d.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,d.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Bt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):d.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(d.resumeToken,n)),i=i.insert(h,p),function(b,g,_){return b.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=FD?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,d)&&o.push(r.Pi.updateTargetData(a,p))});let c=Qn(),l=Ee();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),o.push(qD(a,s,e.documentUpdates).next(d=>{c=d.ks,l=d.qs})),!n.isEqual(me.min())){const d=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(d)}return F.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,l)).next(()=>c)}).then(a=>(r.Ms=i,a))}function qD(t,e,r){let n=Ee(),i=Ee();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=Qn();return r.forEach((o,c)=>{const l=a.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(me.min())?(e.removeEntry(o,c.readTime),s=s.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(o,c)):Y(Lp,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{ks:s,qs:i}})}function KD(t,e){const r=ge(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Tp),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function GD(t,e){const r=ge(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,F.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ti(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function rm(t,e,r){const n=ge(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!zs(s))throw s;Y(Lp,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function W0(t,e,r){const n=ge(t);let i=me.min(),a=Ee();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,d){const h=ge(c),m=h.xs.get(d);return m!==void 0?F.resolve(h.Ms.get(m)):h.Pi.getTargetData(l,d)}(n,s,gn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(c=>{a=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:me.min(),r?a:Ee())).next(o=>(YD(n,R2(e),o),{documents:o,Qs:a})))}function YD(t,e,r){let n=t.Os.get(e)||me.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class q0{constructor(){this.activeTargetIds=z2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZD{constructor(){this.Mo=new q0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new q0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="ConnectivityMonitor";class G0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(K0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(K0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pl=null;function nm(){return pl===null?pl=function(){return 268435456+Math.round(2147483648*Math.random())}():pl++,"0x"+pl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="RestConnection",QD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===fu?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=nm(),o=this.zo(e,r.toUriEncodedString());Y(Qh,`Sending RPC '${e}' ${s}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,a);const{host:l}=new URL(o),d=$a(l);return this.Jo(e,o,c,n,d).then(h=>(Y(Qh,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Ts(Qh,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$s}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=QD[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class tM extends JD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=nm();return new Promise((o,c)=>{const l=new UE;l.setWithCredentials(!0),l.listenOnce(BE.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Ul.NO_ERROR:const h=l.getResponseJson();Y(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Ul.TIMEOUT:Y(Yt,`RPC '${e}' ${s} timed out`),c(new re(U.DEADLINE_EXCEEDED,"Request time out"));break;case Ul.HTTP_ERROR:const m=l.getStatus();if(Y(Yt,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p?.error;if(v&&v.status&&v.message){const b=function(_){const T=_.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(T)>=0?T:U.UNKNOWN}(v.status);c(new re(b,v.message))}else c(new re(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new re(U.UNAVAILABLE,"Connection failed."));break;default:de(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{Y(Yt,`RPC '${e}' ${s} completed.`)}});const d=JSON.stringify(i);Y(Yt,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",d,n,15)})}T_(e,r,n){const i=nm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=qE(),o=WE(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const d=a.join("");Y(Yt,`Creating RPC '${e}' stream ${i}: ${d}`,c);const h=s.createWebChannel(d,c);this.I_(h);let m=!1,p=!1;const v=new eM({Yo:g=>{p?Y(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(m||(Y(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Y(Yt,`RPC '${e}' stream ${i} sending:`,g),h.send(g))},Zo:()=>h.close()}),b=(g,_,T)=>{g.listen(_,E=>{try{T(E)}catch(j){setTimeout(()=>{throw j},0)}})};return b(h,So.EventType.OPEN,()=>{p||(Y(Yt,`RPC '${e}' stream ${i} transport opened.`),v.o_())}),b(h,So.EventType.CLOSE,()=>{p||(p=!0,Y(Yt,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))}),b(h,So.EventType.ERROR,g=>{p||(p=!0,Ts(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,g.name,"Message:",g.message),v.a_(new re(U.UNAVAILABLE,"The operation could not be completed")))}),b(h,So.EventType.MESSAGE,g=>{if(!p){const _=g.data[0];Ne(!!_,16349);const T=_,E=T?.error||T[0]?.error;if(E){Y(Yt,`RPC '${e}' stream ${i} received error:`,E);const j=E.status;let R=function(A){const P=pt[A];if(P!==void 0)return A1(P)}(j),D=E.message;R===void 0&&(R=U.INTERNAL,D="Unknown error status: "+j+" with message "+E.message),p=!0,v.a_(new re(R,D)),h.close()}else Y(Yt,`RPC '${e}' stream ${i} received:`,_),v.u_(_)}}),b(o,HE.STAT_EVENT,g=>{g.stat===Wf.PROXY?Y(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===Wf.NOPROXY&&Y(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Jh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sd(t){return new aD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="PersistentStream";class z1{constructor(e,r,n,i,a,s,o,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new V1(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===U.RESOURCE_EXHAUSTED?(Xn(r.toString()),Xn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new re(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(Y0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Y(Y0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rM extends z1{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=cD(this.serializer,e),n=function(a){if(!("targetChange"in a))return me.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?me.min():s.readTime?yn(s.readTime):me.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=tm(this.serializer),r.addTarget=function(a,s){let o;const c=s.target;if(o=Zf(c)?{documents:dD(a,c)}:{query:hD(a,c).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=P1(a,s.resumeToken);const l=Qf(a,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(me.min())>0){o.readTime=bu(a,s.snapshotVersion.toTimestamp());const l=Qf(a,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=mD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=tm(this.serializer),r.removeTarget=e,this.q_(r)}}class nM extends z1{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=uD(e.writeResults,e.commitTime),n=yn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=tm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>lD(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{}class aM extends iM{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,Jf(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new re(U.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,Jf(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(U.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class sM{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xn(r),this.aa=!1):Y("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="RemoteStore";class oM{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ha(this)&&(Y(Na,"Restarting streams for network reachability change."),await async function(c){const l=ge(c);l.Ea.add(4),await Ic(l),l.Ra.set("Unknown"),l.Ea.delete(4),await Id(l)}(this))})}),this.Ra=new sM(n,i)}}async function Id(t){if(Ha(t))for(const e of t.da)await e(!0)}async function Ic(t){for(const e of t.da)await e(!1)}function F1(t,e){const r=ge(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Fp(r)?zp(r):Fs(r).O_()&&Vp(r,e))}function $p(t,e){const r=ge(t),n=Fs(r);r.Ia.delete(e),n.O_()&&U1(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ha(r)&&r.Ra.set("Unknown"))}function Vp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fs(t).Y_(e)}function U1(t,e){t.Va.Ue(e),Fs(t).Z_(e)}function zp(t){t.Va=new tD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fs(t).start(),t.Ra.ua()}function Fp(t){return Ha(t)&&!Fs(t).x_()&&t.Ia.size>0}function Ha(t){return ge(t).Ea.size===0}function B1(t){t.Va=void 0}async function cM(t){t.Ra.set("Online")}async function lM(t){t.Ia.forEach((e,r)=>{Vp(t,e)})}async function uM(t,e){B1(t),Fp(t)?(t.Ra.ha(e),zp(t)):t.Ra.set("Unknown")}async function dM(t,e,r){if(t.Ra.set("Online"),e instanceof I1&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Y(Na,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wu(t,n)}else if(e instanceof ql?t.Va.Ze(e):e instanceof S1?t.Va.st(e):t.Va.tt(e),!r.isEqual(me.min()))try{const n=await $1(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const d=a.Ia.get(l);d&&a.Ia.set(l,d.withResumeToken(c.resumeToken,s))}}),o.targetMismatches.forEach((c,l)=>{const d=a.Ia.get(c);if(!d)return;a.Ia.set(c,d.withResumeToken(Bt.EMPTY_BYTE_STRING,d.snapshotVersion)),U1(a,c);const h=new Ti(d.target,c,l,d.sequenceNumber);Vp(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Y(Na,"Failed to raise snapshot:",n),await wu(t,n)}}async function wu(t,e,r){if(!zs(e))throw e;t.Ea.add(1),await Ic(t),t.Ra.set("Offline"),r||(r=()=>$1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(Na,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Id(t)})}function H1(t,e){return e().catch(r=>wu(t,r,e))}async function Pd(t){const e=ge(t),r=Mi(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Tp;for(;hM(e);)try{const i=await KD(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,fM(e,i)}catch(i){await wu(e,i)}W1(e)&&q1(e)}function hM(t){return Ha(t)&&t.Ta.length<10}function fM(t,e){t.Ta.push(e);const r=Mi(t);r.O_()&&r.X_&&r.ea(e.mutations)}function W1(t){return Ha(t)&&!Mi(t).x_()&&t.Ta.length>0}function q1(t){Mi(t).start()}async function mM(t){Mi(t).ra()}async function pM(t){const e=Mi(t);for(const r of t.Ta)e.ea(r.mutations)}async function gM(t,e,r){const n=t.Ta.shift(),i=Np.from(n,e,r);await H1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Pd(t)}async function yM(t,e){e&&Mi(t).X_&&await async function(n,i){if(function(s){return Q2(s)&&s!==U.ABORTED}(i.code)){const a=n.Ta.shift();Mi(n).B_(),await H1(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Pd(n)}}(t,e),W1(t)&&q1(t)}async function Z0(t,e){const r=ge(t);r.asyncQueue.verifyOperationInProgress(),Y(Na,"RemoteStore received new credentials");const n=Ha(r);r.Ea.add(3),await Ic(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Id(r)}async function vM(t,e){const r=ge(t);e?(r.Ea.delete(2),await Id(r)):e||(r.Ea.add(2),await Ic(r),r.Ra.set("Unknown"))}function Fs(t){return t.ma||(t.ma=function(r,n,i){const a=ge(r);return a.sa(),new rM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:cM.bind(null,t),t_:lM.bind(null,t),r_:uM.bind(null,t),H_:dM.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Fp(t)?zp(t):t.Ra.set("Unknown")):(await t.ma.stop(),B1(t))})),t.ma}function Mi(t){return t.fa||(t.fa=function(r,n,i){const a=ge(r);return a.sa(),new nM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:mM.bind(null,t),r_:yM.bind(null,t),ta:pM.bind(null,t),na:gM.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Pd(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(Na,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new Up(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bp(t,e){if(Xn("AsyncQueue",`${e}: ${t}`),zs(t))return new re(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{static emptySet(e){return new vs(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ae.comparator(r.key,n.key):(r,n)=>ae.comparator(r.key,n.key),this.keyedMap=Io(),this.sortedSet=new Qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof vs)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new vs;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(){this.ga=new Qe(ae.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):de(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Cs{constructor(e,r,n,i,a,s,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Cs(e,r,vs.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class xM{constructor(){this.queries=Q0(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ge(r),a=i.queries;i.queries=Q0(),a.forEach((s,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new re(U.ABORTED,"Firestore shutting down"))}}function Q0(){return new Ua(t=>h1(t),wd)}async function wM(t,e){const r=ge(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new bM,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=Bp(s,`Initialization of query '${cs(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&Hp(r)}async function _M(t,e){const r=ge(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function EM(t,e){const r=ge(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&Hp(r)}function TM(t,e,r){const n=ge(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function Hp(t){t.Ca.forEach(e=>{e.next()})}var im,J0;(J0=im||(im={})).Ma="default",J0.Cache="cache";class AM{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Cs(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Cs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==im.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e){this.key=e}}class G1{constructor(e){this.key=e}}class SM{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=f1(e),this.tu=new vs(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new X0,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const m=i.get(d),p=_d(this.query,h)?h:null,v=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;m&&p?m.data.isEqual(p.data)?v!==b&&(n.track({type:3,doc:p}),g=!0):this.su(m,p)||(n.track({type:2,doc:p}),g=!0,(c&&this.eu(p,c)>0||l&&this.eu(p,l)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),g=!0):m&&!p&&(n.track({type:1,doc:m}),g=!0,(c||l)&&(o=!0)),g&&(p?(s=s.add(p),a=b?a.add(d):a.delete(d)):(s=s.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((d,h)=>function(p,v){const b=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return de(20277,{Rt:g})}};return b(p)-b(v)}(d.type,h.type)||this.eu(d.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,l=c!==this.Za;return this.Za=c,s.length!==0||l?{snapshot:new Cs(this.query,e.tu,a,s,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new X0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new G1(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new K1(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ee();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Cs.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Wp="SyncEngine";class IM{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class PM{constructor(e){this.key=e,this.hu=!1}}class CM{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ua(o=>h1(o),wd),this.Iu=new Map,this.Eu=new Set,this.du=new Qe(ae.comparator),this.Au=new Map,this.Ru=new Rp,this.Vu={},this.mu=new Map,this.fu=Ps.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function kM(t,e,r=!0){const n=eT(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await Y1(n,e,r,!0),i}async function NM(t,e){const r=eT(t);await Y1(r,e,!0,!1)}async function Y1(t,e,r,n){const i=await GD(t.localStore,gn(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await jM(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&F1(t.remoteStore,i),o}async function jM(t,e,r,n,i){t.pu=(h,m,p)=>async function(b,g,_,T){let E=g.view.ru(_);E.Cs&&(E=await W0(b.localStore,g.query,!1).then(({documents:S})=>g.view.ru(S,E)));const j=T&&T.targetChanges.get(g.targetId),R=T&&T.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(E,b.isPrimaryClient,j,R);return tb(b,g.targetId,D.au),D.snapshot}(t,h,m,p);const a=await W0(t.localStore,e,!0),s=new SM(e,a.Qs),o=s.ru(a.documents),c=Sc.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),l=s.applyChanges(o,t.isPrimaryClient,c);tb(t,r,l.au);const d=new IM(e,r,s);return t.Tu.set(e,d),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function OM(t,e,r){const n=ge(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!wd(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await rm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&$p(n.remoteStore,i.targetId),am(n,i.targetId)}).catch(Vs)):(am(n,i.targetId),await rm(n.localStore,i.targetId,!0))}async function RM(t,e){const r=ge(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),$p(r.remoteStore,n.targetId))}async function DM(t,e,r){const n=UM(t);try{const i=await function(s,o){const c=ge(s),l=qe.now(),d=o.reduce((p,v)=>p.add(v.key),Ee());let h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Qn(),b=Ee();return c.Ns.getEntries(p,d).next(g=>{v=g,v.forEach((_,T)=>{T.isValidDocument()||(b=b.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,v)).next(g=>{h=g;const _=[];for(const T of o){const E=K2(T,h.get(T.key).overlayedDocument);E!=null&&_.push(new Ba(T.key,E,a1(E.value.mapValue),Wn.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,_,o)}).next(g=>{m=g;const _=g.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(p,g.batchId,_)})}).then(()=>({batchId:m.batchId,changes:p1(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,c){let l=s.Vu[s.currentUser.toKey()];l||(l=new Qe(we)),l=l.insert(o,c),s.Vu[s.currentUser.toKey()]=l}(n,i.batchId,r),await Pc(n,i.changes),await Pd(n.remoteStore)}catch(i){const a=Bp(i,"Failed to persist write");r.reject(a)}}async function Z1(t,e){const r=ge(t);try{const n=await WD(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Ne(s.hu,14607):i.removedDocuments.size>0&&(Ne(s.hu,42227),s.hu=!1))}),await Pc(r,n,e)}catch(n){await Vs(n)}}function eb(t,e,r){const n=ge(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const c=ge(s);c.onlineState=o;let l=!1;c.queries.forEach((d,h)=>{for(const m of h.Sa)m.va(o)&&(l=!0)}),l&&Hp(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function MM(t,e,r){const n=ge(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new Qe(ae.comparator);s=s.insert(a,Qt.newNoDocument(a,me.min()));const o=Ee().add(a),c=new Ad(me.min(),new Map,new Qe(we),s,o);await Z1(n,c),n.du=n.du.remove(a),n.Au.delete(e),qp(n)}else await rm(n.localStore,e,!1).then(()=>am(n,e,r)).catch(Vs)}async function LM(t,e){const r=ge(t),n=e.batch.batchId;try{const i=await HD(r.localStore,e);Q1(r,n,null),X1(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Pc(r,i)}catch(i){await Vs(i)}}async function $M(t,e,r){const n=ge(t);try{const i=await function(s,o){const c=ge(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(Ne(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(n.localStore,e);Q1(n,e,r),X1(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Pc(n,i)}catch(i){await Vs(i)}}function X1(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function Q1(t,e,r){const n=ge(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function am(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||J1(t,n)})}function J1(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&($p(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),qp(t))}function tb(t,e,r){for(const n of r)n instanceof K1?(t.Ru.addReference(n.key,e),VM(t,n)):n instanceof G1?(Y(Wp,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||J1(t,n.key)):de(19791,{wu:n})}function VM(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Y(Wp,"New document in limbo: "+r),t.Eu.add(n),qp(t))}function qp(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ae(Xe.fromString(e)),n=t.fu.next();t.Au.set(n,new PM(r)),t.du=t.du.insert(r,n),F1(t.remoteStore,new Ti(gn(Cp(r.path)),n,"TargetPurposeLimboResolution",yd.ce))}}async function Pc(t,e,r){const n=ge(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{s.push(n.pu(c,e,r).then(l=>{if((l||r)&&n.isPrimaryClient){const d=l?!l.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){i.push(l);const d=Mp.As(c.targetId,l);a.push(d)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,l){const d=ge(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>F.forEach(l,m=>F.forEach(m.Es,p=>d.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>F.forEach(m.ds,p=>d.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!zs(h))throw h;Y(Lp,"Failed to update sequence numbers: "+h)}for(const h of l){const m=h.targetId;if(!h.fromCache){const p=d.Ms.get(m),v=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(v);d.Ms=d.Ms.insert(m,b)}}}(n.localStore,a))}async function zM(t,e){const r=ge(t);if(!r.currentUser.isEqual(e)){Y(Wp,"User change. New user:",e.toKey());const n=await L1(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(c=>{c.reject(new re(U.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Pc(r,n.Ls)}}function FM(t,e){const r=ge(t),n=r.Au.get(e);if(n&&n.hu)return Ee().add(n.key);{let i=Ee();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}function eT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Z1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MM.bind(null,e),e.Pu.H_=EM.bind(null,e.eventManager),e.Pu.yu=TM.bind(null,e.eventManager),e}function UM(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$M.bind(null,e),e}class _u{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return BD(this.persistence,new zD,e.initialUser,this.serializer)}Cu(e){return new M1(Dp.mi,this.serializer)}Du(e){return new ZD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_u.provider={build:()=>new _u};class BM extends _u{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ne(this.persistence.referenceDelegate instanceof xu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new AD(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?lr.withCacheSize(this.cacheSizeBytes):lr.DEFAULT;return new M1(n=>xu.mi(n,r),this.serializer)}}class sm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>eb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=zM.bind(null,this.syncEngine),await vM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new xM}()}createDatastore(e){const r=Sd(e.databaseInfo.databaseId),n=function(a){return new tM(a)}(e.databaseInfo);return function(a,s,o,c){return new aM(a,s,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new oM(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>eb(this.syncEngine,r,0),function(){return G0.v()?new G0:new XD}())}createSyncEngine(e,r){return function(i,a,s,o,c,l,d){const h=new CM(i,a,s,o,c,l);return d&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ge(r);Y(Na,"RemoteStore shutting down."),n.Ea.add(5),await Ic(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}sm.provider={build:()=>new sm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li="FirestoreClient";class WM{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=_p.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Y(Li,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Y(Li,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Bp(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ef(t,e){t.asyncQueue.verifyOperationInProgress(),Y(Li,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await L1(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function rb(t,e){t.asyncQueue.verifyOperationInProgress();const r=await qM(t);Y(Li,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Z0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Z0(e.remoteStore,i)),t._onlineComponents=e}async function qM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(Li,"Using user provided OfflineComponentProvider");try{await ef(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ts("Error using user provided cache. Falling back to memory cache: "+r),await ef(t,new _u)}}else Y(Li,"Using default OfflineComponentProvider"),await ef(t,new BM(void 0));return t._offlineComponents}async function tT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(Li,"Using user provided OnlineComponentProvider"),await rb(t,t._uninitializedComponentsProvider._online)):(Y(Li,"Using default OnlineComponentProvider"),await rb(t,new sm))),t._onlineComponents}function KM(t){return tT(t).then(e=>e.syncEngine)}async function GM(t){const e=await tT(t),r=e.eventManager;return r.onListen=kM.bind(null,e.syncEngine),r.onUnlisten=OM.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=NM.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=RM.bind(null,e.syncEngine),r}function YM(t,e,r={}){const n=new Ci;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,c,l){const d=new HM({next:m=>{d.Nu(),s.enqueueAndForget(()=>_M(a,h));const p=m.docs.has(o);!p&&m.fromCache?l.reject(new re(U.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&c&&c.source==="server"?l.reject(new re(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new AM(Cp(o.path),d,{includeMetadataChanges:!0,qa:!0});return wM(a,h)}(await GM(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="firestore.googleapis.com",ib=!0;class ab{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nT,this.ssl=ib}else this.host=e.host,this.ssl=e.ssl??ib;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=D1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ED)throw new re(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=rT(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ab({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ab(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new YR;switch(n.type){case"firstParty":return new JR(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new re(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=nb.get(r);n&&(Y("ComponentProvider","Removing Datastore"),nb.delete(r),n.terminate())}(this),Promise.resolve()}}function ZM(t,e,r,n={}){t=Zo(t,Kp);const i=$a(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(cp(`https://${o}`),lp("Firestore",!0)),a.host!==nT&&a.host!==o&&Ts("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:o,ssl:i,emulatorOptions:n};if(!Sa(c,s)&&(t._setSettings(c),n.mockUserToken)){let l,d;if(typeof n.mockUserToken=="string")l=n.mockUserToken,d=Xt.MOCK_USER;else{l=tE(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new re(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Xt(h)}t._authCredentials=new ZR(new GE(l,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Gp(this.firestore,e,this._query)}}class Ct{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new nc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ct(this.firestore,e,this._key)}toJSON(){return{type:Ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Tc(r,Ct._jsonSchema))return new Ct(e,n||null,new ae(Xe.fromString(r.referencePath)))}}Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:gt("string",Ct._jsonSchemaVersion),referencePath:gt("string")};class nc extends Gp{constructor(e,r,n){super(e,r,Cp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new ae(e))}withConverter(e){return new nc(this.firestore,e,this._path)}}function sb(t,e,...r){if(t=dr(t),arguments.length===1&&(e=_p.newId()),a2("doc","path",e),t instanceof Kp){const n=Xe.fromString(e,...r);return b0(n),new Ct(t,null,new ae(n))}{if(!(t instanceof Ct||t instanceof nc))throw new re(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Xe.fromString(e,...r));return b0(n),new Ct(t.firestore,t instanceof nc?t.converter:null,new ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="AsyncQueue";class cb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new V1(this,"async_queue_retry"),this._c=()=>{const n=Jh();n&&Y(ob,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Jh();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Jh();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ci;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!zs(e))throw e;Y(ob,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Xn("INTERNAL UNHANDLED ERROR: ",lb(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Up.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&de(47125,{Pc:lb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function lb(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Yp extends Kp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new cb,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cb(e),this._firestoreClient=void 0,await e}}}function XM(t,e){const r=typeof t=="object"?t:hp(),n=typeof t=="string"?t:fu,i=fd(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=Q_("firestore");a&&ZM(i,...a)}return i}function iT(t){if(t._terminated)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||QM(t),t._firestoreClient}function QM(t){const e=t._freezeSettings(),r=function(i,a,s,o){return new y2(i,a,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,rT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new WM(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(Bt.fromBase64String(e))}catch(r){throw new re(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Mr(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Tc(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:gt("string",Mr._jsonSchemaVersion),bytes:gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new re(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ft(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new re(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new re(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vn._jsonSchemaVersion}}static fromJSON(e){if(Tc(e,vn._jsonSchema))return new vn(e.latitude,e.longitude)}}vn._jsonSchemaVersion="firestore/geoPoint/1.0",vn._jsonSchema={type:gt("string",vn._jsonSchemaVersion),latitude:gt("number"),longitude:gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:bn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Tc(e,bn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new bn(e.vectorValues);throw new re(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bn._jsonSchemaVersion="firestore/vectorValue/1.0",bn._jsonSchema={type:gt("string",bn._jsonSchemaVersion),vectorValues:gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM=/^__.*__$/;class eL{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ba(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ac(e,this.data,r,this.fieldTransforms)}}function sT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw de(40011,{Ac:t})}}class Xp{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Xp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Eu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sT(this.Ac)&&JM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class tL{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Sd(e)}Cc(e,r,n,i=!1){return new Xp({Ac:e,methodName:r,Dc:n,path:Ft.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rL(t){const e=t._freezeSettings(),r=Sd(t._databaseId);return new tL(t._databaseId,!!e.ignoreUndefinedProperties,r)}function nL(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);uT("Data must be an object, but it was:",s,n);const o=cT(n,s);let c,l;if(a.merge)c=new Xr(s.fieldMask),l=s.fieldTransforms;else if(a.mergeFields){const d=[];for(const h of a.mergeFields){const m=iL(e,h,r);if(!s.contains(m))throw new re(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);sL(d,m)||d.push(m)}c=new Xr(d),l=s.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=s.fieldTransforms;return new eL(new Dr(o),c,l)}function oT(t,e){if(lT(t=dr(t)))return uT("Unsupported field value:",e,t),cT(t,e);if(t instanceof aT)return function(n,i){if(!sT(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let c=oT(o,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return F2(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=qe.fromDate(n);return{timestampValue:bu(i.serializer,a)}}if(n instanceof qe){const a=new qe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:bu(i.serializer,a)}}if(n instanceof vn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Mr)return{bytesValue:P1(i.serializer,n._byteString)};if(n instanceof Ct){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Op(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof bn)return function(s,o){return{mapValue:{fields:{[n1]:{stringValue:i1},[mu]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return kp(o.serializer,l)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Ep(n)}`)}(t,e)}function cT(t,e){const r={};return XE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fa(t,(n,i)=>{const a=oT(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function lT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof vn||t instanceof Mr||t instanceof Ct||t instanceof aT||t instanceof bn)}function uT(t,e,r){if(!lT(r)||!YE(r)){const n=Ep(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function iL(t,e,r){if((e=dr(e))instanceof Zp)return e._internalPath;if(typeof e=="string")return dT(t,e);throw Eu("Field path arguments must be of type string or ",t,!1,void 0,r)}const aL=new RegExp("[~\\*/\\[\\]]");function dT(t,e,r){if(e.search(aL)>=0)throw Eu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Zp(...e.split("."))._internalPath}catch{throw Eu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Eu(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(a||s)&&(c+=" (found",a&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new re(U.INVALID_ARGUMENT,o+t+c)}function sL(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(fT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class oL extends hT{data(){return super.data()}}function fT(t,e){return typeof e=="string"?dT(t,e):e instanceof Zp?e._internalPath:e._delegate._internalPath}class cL{convertValue(e,r="none"){switch(Di(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Ri(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw de(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Fa(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){const r=e.fields?.[mu].arrayValue?.values?.map(n=>ct(n.doubleValue));return new bn(r)}convertGeoPoint(e){return new vn(ct(e.latitude),ct(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=bd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Qo(e));default:return null}}convertTimestamp(e){const r=Oi(e);return new qe(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Xe.fromString(e);Ne(R1(n),9688,{name:e});const i=new Jo(n.get(1),n.get(3)),a=new ae(n.popFirst(5));return i.isEqual(r)||Xn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Co{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class va extends hT{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Kl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(fT("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=va._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}va._jsonSchemaVersion="firestore/documentSnapshot/1.0",va._jsonSchema={type:gt("string",va._jsonSchemaVersion),bundleSource:gt("string","DocumentSnapshot"),bundleName:gt("string"),bundle:gt("string")};class Kl extends va{data(e={}){return super.data(e)}}class Vo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Co(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Kl(this._firestore,this._userDataWriter,n.key,n,new Co(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new re(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const c=new Kl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Co(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const c=new Kl(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Co(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,d=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),d=s.indexOf(o.doc.key)),{type:uL(o.type),doc:c,oldIndex:l,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=_p.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function uL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return de(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dL(t){t=Zo(t,Ct);const e=Zo(t.firestore,Yp);return YM(iT(e),t._key).then(r=>mL(e,t,r))}Vo._jsonSchemaVersion="firestore/querySnapshot/1.0",Vo._jsonSchema={type:gt("string",Vo._jsonSchemaVersion),bundleSource:gt("string","QuerySnapshot"),bundleName:gt("string"),bundle:gt("string")};class hL extends cL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,r)}}function ub(t,e,r){t=Zo(t,Ct);const n=Zo(t.firestore,Yp),i=lL(t.converter,e);return fL(n,[nL(rL(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Wn.none())])}function fL(t,e){return function(n,i){const a=new Ci;return n.asyncQueue.enqueueAndForget(async()=>DM(await KM(n),i,a)),a.promise}(iT(t),e)}function mL(t,e,r){const n=r.docs.get(e._key),i=new hL(t);return new va(t,i,e._key,n,new Co(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){$s=i})(Va),Ia(new Ni("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new Yp(new XR(n.getProvider("auth-internal")),new e2(s,n.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new re(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(l.options.projectId,d)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),fn(p0,g0,e),fn(p0,g0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="firebasestorage.googleapis.com",pL="storageBucket",gL=2*60*1e3,yL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Cn{constructor(e,r,n=0){super(tf(e),`Firebase Storage: ${r} (${tf(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return tf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function tf(t){return"storage/"+t}function vL(){const t="An unknown error occurred, please check the error payload for server response.";return new kn(Sn.UNKNOWN,t)}function bL(){return new kn(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function xL(){return new kn(Sn.CANCELED,"User canceled the upload/download.")}function wL(t){return new kn(Sn.INVALID_URL,"Invalid URL '"+t+"'.")}function _L(t){return new kn(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function db(t){return new kn(Sn.INVALID_ARGUMENT,t)}function pT(){return new kn(Sn.APP_DELETED,"The Firebase app was deleted.")}function EL(t){return new kn(Sn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qr.makeFromUrl(e,r)}catch{return new Qr(e,"")}if(n.path==="")return n;throw _L(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const s="(/(.*))?$",o=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function l(j){j.path_=decodeURIComponent(j.path)}const d="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${d}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},b=r===mT?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",_=new RegExp(`^https?://${b}/${i}/${g}`,"i"),E=[{regex:o,indices:c,postModify:a},{regex:p,indices:v,postModify:l},{regex:_,indices:{bucket:1,path:2},postModify:l}];for(let j=0;j<E.length;j++){const R=E[j],D=R.regex.exec(e);if(D){const S=D[R.indices.bucket];let A=D[R.indices.path];A||(A=""),n=new Qr(S,A),R.postModify(n);break}}if(n==null)throw wL(e);return n}}class TL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AL(t,e,r){let n=1,i=null,a=null,s=!1,o=0;function c(){return o===2}let l=!1;function d(...g){l||(l=!0,e.apply(null,g))}function h(g){i=setTimeout(()=>{i=null,t(p,c())},g)}function m(){a&&clearTimeout(a)}function p(g,..._){if(l){m();return}if(g){m(),d.call(null,g,..._);return}if(c()||s){m(),d.call(null,g,..._);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let v=!1;function b(g){v||(v=!0,m(),!l&&(i!==null?(g||(o=2),clearTimeout(i),h(0)):g||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,b(!0)},r),b}function SL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){return t!==void 0}function hb(t,e,r,n){if(n<e)throw db(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw db(`Invalid value for '${t}'. Expected ${r} or less.`)}function PL(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var Tu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Tu||(Tu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL{constructor(e,r,n,i,a,s,o,c,l,d,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,b)=>{this.resolve_=v,this.reject_=b,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new gl(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const s=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const o=a.getErrorCode()===Tu.NO_ERROR,c=a.getStatus();if(!o||CL(c,this.additionalRetryCodes_)&&this.retry){const d=a.getErrorCode()===Tu.ABORT;n(!1,new gl(!1,null,d));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new gl(l,a))})},r=(n,i)=>{const a=this.resolve_,s=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());IL(c)?a(c):a()}catch(c){s(c)}else if(o!==null){const c=vL();c.serverResponse=o.getErrorText(),this.errorCallback_?s(this.errorCallback_(o,c)):s(c)}else if(i.canceled){const c=this.appDelete_?pT():xL();s(c)}else{const c=bL();s(c)}};this.canceled_?r(!1,new gl(!1,null,!0)):this.backoffId_=AL(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&SL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gl{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function NL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function jL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function RL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function DL(t,e,r,n,i,a,s=!0,o=!1){const c=PL(t.urlParams),l=t.url+c,d=Object.assign({},t.headers);return OL(d,e),NL(d,r),jL(d,a),RL(d,n),new kL(l,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ML(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function LL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,r){this._service=e,r instanceof Qr?this._location=r:this._location=Qr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Au(e,r)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return LL(this._location.path)}get storage(){return this._service}get parent(){const e=ML(this._location.path);if(e===null)return null;const r=new Qr(this._location.bucket,e);return new Au(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw EL(e)}}function fb(t,e){const r=e?.[pL];return r==null?null:Qr.makeFromBucketSpec(r,t)}function $L(t,e,r,n={}){t.host=`${e}:${r}`;const i=$a(e);i&&(cp(`https://${t.host}/b`),lp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:tE(a,t.app.options.projectId))}class VL{constructor(e,r,n,i,a,s=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=s,this._bucket=null,this._host=mT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=gL,this._maxUploadRetryTime=yL,this._requests=new Set,i!=null?this._bucket=Qr.makeFromBucketSpec(i,this._host):this._bucket=fb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=fb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Au(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new TL(pT());{const s=DL(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const mb="@firebase/storage",pb="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="storage";function zL(t=hp(),e){t=dr(t);const n=fd(t,gT).getImmediate({identifier:e}),i=Q_("storage");return i&&FL(n,...i),n}function FL(t,e,r,n={}){$L(t,e,r,n)}function UL(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new VL(r,n,i,e,Va)}function BL(){Ia(new Ni(gT,UL,"PUBLIC").setMultipleInstances(!0)),fn(mb,pb,""),fn(mb,pb,"esm2020")}BL();const HL={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},Cd=iE(HL);console.log("Firebase app initialized:",Cd);const ko=KR(Cd);console.log("Firebase auth instance:",ko);const gb=XM(Cd);zL(Cd);const Nn=ap((t,e)=>({user:null,initialized:!1,isLoading:!1,error:null,initialize:()=>{DO(ko,async r=>{try{if(r){console.log("[AUTH STORE] User authenticated:",r.uid);const n=sb(gb,"profiles",r.uid),i=await dL(n);if(i.exists()){const a=i.data();t(Se(s=>{s.user={id:r.uid,...a},s.initialized=!0,s.error=null,s.isLoading=!1}))}else{const a={id:r.uid,email:r.email,fullName:null,avatarUrl:null,preferences:{}};await ub(n,a),t(Se(s=>{s.user=a,s.initialized=!0,s.error=null,s.isLoading=!1}))}}else t(Se(n=>{n.user=null,n.initialized=!0,n.error=null,n.isLoading=!1}))}catch(n){console.error("[AUTH STORE] Error in auth state change:",n),t(Se(i=>{i.error=n instanceof Error?n.message:"Error de autenticación",i.initialized=!0,i.isLoading=!1}))}})},signIn:async(r,n)=>{try{t(Se(i=>{i.isLoading=!0,i.error=null})),console.log("[AUTH STORE] Attempting sign in with email:",r),await jO(ko,r,n)}catch(i){throw console.error("[AUTH STORE] Sign in error:",i),t(Se(a=>{a.error=i.message||"Error al iniciar sesión",a.isLoading=!1})),i}},signUp:async(r,n,i,a)=>{try{if(t(Se(c=>{c.isLoading=!0,c.error=null})),i&&n!==i)throw new Error("Las contraseñas no coinciden");const o=(await NO(ko,r,n)).user;if(o){const c={id:o.uid,email:o.email,fullName:a||null,avatarUrl:null,preferences:{}},l=sb(gb,"profiles",o.uid);await ub(l,c)}else throw new Error("Error al crear el usuario")}catch(s){throw console.error("[AUTH STORE] Sign up error:",s),t(Se(o=>{o.error=s.message||"Error al crear la cuenta",o.isLoading=!1})),s}},signOut:async()=>{try{t(Se(r=>{r.isLoading=!0,r.error=null})),await MO(ko)}catch(r){throw console.error("[AUTH STORE] Sign out error:",r),t(Se(n=>{n.error=r.message||"Error al cerrar sesión",n.isLoading=!1})),r}},clearError:()=>{t(Se(r=>{r.error=null}))}})),jr={initialization:{timeout:5e3,retryAttempts:2,retryDelay:1e3,emergencyFallbackTimeout:8e3},performance:{trackInitialization:!0,slowConnectionThreshold:3e3,performanceLogging:!1},ui:{showProgressIndicator:!0,progressSteps:["Conectando...","Verificando sesión...","Cargando perfil...","Inicializando..."],minLoadingTime:500}};class WL{constructor(){Nr(this,"metrics");this.metrics={startTime:Date.now(),retryCount:0,errors:[],success:!1,isSlowConnection:!1,emergencyFallbackUsed:!1}}recordRetry(e){this.metrics.retryCount++,e&&this.metrics.errors.push(e)}recordError(e){this.metrics.errors.push(e)}recordSuccess(){this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime,this.metrics.success=!0,this.metrics.isSlowConnection=this.metrics.duration>jr.performance.slowConnectionThreshold}recordEmergencyFallback(){this.metrics.emergencyFallbackUsed=!0,this.metrics.endTime||(this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime)}getMetrics(){return{...this.metrics}}logPerformance(){}}const qL=()=>{const{user:t,initialized:e,initialize:r}=Nn(),[n,i]=w.useState({initialized:!1,loading:!1,error:null,progress:{step:0,message:jr.ui.progressSteps[0]},retryCount:0,emergencyFallbackUsed:!1}),a=w.useRef(null),s=w.useRef({}),o=w.useRef(!1),c=b=>{b<jr.ui.progressSteps.length&&i(g=>({...g,progress:{step:b,message:jr.ui.progressSteps[b]}}))},l=()=>{Object.values(s.current).forEach(b=>{b&&clearTimeout(b)}),s.current={}},d=()=>{a.current&&(a.current.recordSuccess(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,error:null})),l()},h=(b,g=!0)=>{a.current&&a.current.recordError(b),i(_=>({..._,error:b,loading:!g})),g&&n.retryCount<jr.initialization.retryAttempts&&m()},m=()=>{const b=n.retryCount+1;a.current&&a.current.recordRetry(`Retry attempt ${b}`),i(g=>({...g,retryCount:b,progress:{step:0,message:`Reintentando... (${b}/${jr.initialization.retryAttempts})`}})),s.current.retry=setTimeout(()=>{v()},jr.initialization.retryDelay)},p=()=>{n.emergencyFallbackUsed||(console.warn("[Auth] Emergency fallback triggered - forcing app render"),a.current&&(a.current.recordEmergencyFallback(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,emergencyFallbackUsed:!0,error:"Inicialización lenta - continuando..."})),l())},v=async()=>{i(b=>({...b,loading:!0,error:null})),c(1);try{jr.performance.trackInitialization&&!a.current&&(a.current=new WL),c(2),await r(),c(3),jr.ui.minLoadingTime>0&&await new Promise(b=>setTimeout(b,jr.ui.minLoadingTime)),d()}catch(b){const g=b instanceof Error?b.message:"Error de inicialización";h(g)}};return w.useEffect(()=>{if(!o.current){if(o.current=!0,e){d();return}return s.current.primary=setTimeout(()=>{n.initialized||h("Timeout de inicialización",!0)},jr.initialization.timeout),s.current.emergency=setTimeout(()=>{n.initialized||p()},jr.initialization.emergencyFallbackTimeout),v(),()=>{l()}}},[]),w.useEffect(()=>{e&&!n.initialized&&d()},[e,n.initialized]),{...n,user:t,metrics:a.current?.getMetrics()}};function KL(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const GL=t=>{switch(t){case"success":return XL;case"info":return JL;case"warning":return QL;case"error":return e4;default:return null}},YL=Array(12).fill(0),ZL=({visible:t,className:e})=>H.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},H.createElement("div",{className:"sonner-spinner"},YL.map((r,n)=>H.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),XL=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),QL=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),JL=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),e4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),t4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},H.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),r4=()=>{const[t,e]=H.useState(document.hidden);return H.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let om=1;class n4{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,a=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:om++,s=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:n}),{...c,...e,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...i,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let a=n!==void 0,s;const o=i.then(async l=>{if(s=["resolve",l],H.isValidElement(l))a=!1,this.create({id:n,type:"default",message:l});else if(a4(l)&&!l.ok){a=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${l.status}`):r.error,m=typeof r.description=="function"?await r.description(`HTTP error! status: ${l.status}`):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(l instanceof Error){a=!1;const h=typeof r.error=="function"?await r.error(l):r.error,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(r.success!==void 0){a=!1;const h=typeof r.success=="function"?await r.success(l):r.success,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:m,...v})}}).catch(async l=>{if(s=["reject",l],r.error!==void 0){a=!1;const d=typeof r.error=="function"?await r.error(l):r.error,h=typeof r.description=="function"?await r.description(l):r.description,p=typeof d=="object"&&!H.isValidElement(d)?d:{message:d};this.create({id:n,type:"error",description:h,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((l,d)=>o.then(()=>s[0]==="reject"?d(s[1]):l(s[1])).catch(d));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(e,r)=>{const n=r?.id||om++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const or=new n4,i4=(t,e)=>{const r=e?.id||om++;return or.addToast({title:t,...e,id:r}),r},a4=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",s4=i4,o4=()=>or.toasts,c4=()=>or.getActiveToasts(),yT=Object.assign(s4,{success:or.success,info:or.info,warning:or.warning,error:or.error,custom:or.custom,message:or.message,promise:or.promise,dismiss:or.dismiss,loading:or.loading},{getHistory:o4,getToasts:c4});KL("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function yl(t){return t.label!==void 0}const l4=3,u4="24px",d4="16px",yb=4e3,h4=356,f4=14,m4=45,p4=200;function on(...t){return t.filter(Boolean).join(" ")}function g4(t){const[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}const y4=t=>{var e,r,n,i,a,s,o,c,l;const{invert:d,toast:h,unstyled:m,interacting:p,setHeights:v,visibleToasts:b,heights:g,index:_,toasts:T,expanded:E,removeToast:j,defaultRichColors:R,closeButton:D,style:S,cancelButtonStyle:A,actionButtonStyle:P,className:O="",descriptionClassName:N="",duration:C,position:k,gap:Q,expandByDefault:ce,classNames:X,icons:ee,closeButtonAriaLabel:fe="Close toast"}=t,[ye,Ue]=H.useState(null),[se,q]=H.useState(null),[J,rt]=H.useState(!1),[ze,Fe]=H.useState(!1),[Pr,rn]=H.useState(!1),[G,he]=H.useState(!1),[be,B]=H.useState(!1),[ht,Te]=H.useState(0),[vt,bt]=H.useState(0),rr=H.useRef(h.duration||C||yb),Yi=H.useRef(null),Cr=H.useRef(null),Xs=_===0,Uc=_+1<=b,nr=h.type,nn=h.dismissible!==!1,Qs=h.className||"",Bc=h.descriptionClassName||"",at=H.useMemo(()=>g.findIndex(le=>le.toastId===h.id)||0,[g,h.id]),Ot=H.useMemo(()=>{var le;return(le=h.closeButton)!=null?le:D},[h.closeButton,D]),Zi=H.useMemo(()=>h.duration||C||yb,[h.duration,C]),Qa=H.useRef(0),jn=H.useRef(0),Hc=H.useRef(0),kr=H.useRef(null),[Wc,qc]=k.split("-"),Ja=H.useMemo(()=>g.reduce((le,st,ot)=>ot>=at?le:le+st.height,0),[g,at]),Kc=r4(),Ih=h.invert||d,Xi=nr==="loading";jn.current=H.useMemo(()=>at*Q+Ja,[at,Ja]),H.useEffect(()=>{rr.current=Zi},[Zi]),H.useEffect(()=>{rt(!0)},[]),H.useEffect(()=>{const le=Cr.current;if(le){const st=le.getBoundingClientRect().height;return bt(st),v(ot=>[{toastId:h.id,height:st,position:h.position},...ot]),()=>v(ot=>ot.filter(qt=>qt.toastId!==h.id))}},[v,h.id]),H.useLayoutEffect(()=>{if(!J)return;const le=Cr.current,st=le.style.height;le.style.height="auto";const ot=le.getBoundingClientRect().height;le.style.height=st,bt(ot),v(qt=>qt.find(ft=>ft.toastId===h.id)?qt.map(ft=>ft.toastId===h.id?{...ft,height:ot}:ft):[{toastId:h.id,height:ot,position:h.position},...qt])},[J,h.title,h.description,v,h.id,h.jsx,h.action,h.cancel]);const Wr=H.useCallback(()=>{Fe(!0),Te(jn.current),v(le=>le.filter(st=>st.toastId!==h.id)),setTimeout(()=>{j(h)},p4)},[h,j,v,jn]);H.useEffect(()=>{if(h.promise&&nr==="loading"||h.duration===1/0||h.type==="loading")return;let le;return E||p||Kc?(()=>{if(Hc.current<Qa.current){const qt=new Date().getTime()-Qa.current;rr.current=rr.current-qt}Hc.current=new Date().getTime()})():(()=>{rr.current!==1/0&&(Qa.current=new Date().getTime(),le=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),Wr()},rr.current))})(),()=>clearTimeout(le)},[E,p,h,nr,Kc,Wr]),H.useEffect(()=>{h.delete&&(Wr(),h.onDismiss==null||h.onDismiss.call(h,h))},[Wr,h.delete]);function Gc(){var le;if(ee?.loading){var st;return H.createElement("div",{className:on(X?.loader,h==null||(st=h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":nr==="loading"},ee.loading)}return H.createElement(ZL,{className:on(X?.loader,h==null||(le=h.classNames)==null?void 0:le.loader),visible:nr==="loading"})}const Qi=h.icon||ee?.[nr]||GL(nr);var es,ts;return H.createElement("li",{tabIndex:0,ref:Cr,className:on(O,Qs,X?.toast,h==null||(e=h.classNames)==null?void 0:e.toast,X?.default,X?.[nr],h==null||(r=h.classNames)==null?void 0:r[nr]),"data-sonner-toast":"","data-rich-colors":(es=h.richColors)!=null?es:R,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":J,"data-promise":!!h.promise,"data-swiped":be,"data-removed":ze,"data-visible":Uc,"data-y-position":Wc,"data-x-position":qc,"data-index":_,"data-front":Xs,"data-swiping":Pr,"data-dismissible":nn,"data-type":nr,"data-invert":Ih,"data-swipe-out":G,"data-swipe-direction":se,"data-expanded":!!(E||ce&&J),style:{"--index":_,"--toasts-before":_,"--z-index":T.length-_,"--offset":`${ze?ht:jn.current}px`,"--initial-height":ce?"auto":`${vt}px`,...S,...h.style},onDragEnd:()=>{rn(!1),Ue(null),kr.current=null},onPointerDown:le=>{le.button!==2&&(Xi||!nn||(Yi.current=new Date,Te(jn.current),le.target.setPointerCapture(le.pointerId),le.target.tagName!=="BUTTON"&&(rn(!0),kr.current={x:le.clientX,y:le.clientY})))},onPointerUp:()=>{var le,st,ot;if(G||!nn)return;kr.current=null;const qt=Number(((le=Cr.current)==null?void 0:le.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),an=Number(((st=Cr.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ft=new Date().getTime()-((ot=Yi.current)==null?void 0:ot.getTime()),Re=ye==="x"?qt:an,Ji=Math.abs(Re)/ft;if(Math.abs(Re)>=m4||Ji>.11){Te(jn.current),h.onDismiss==null||h.onDismiss.call(h,h),q(ye==="x"?qt>0?"right":"left":an>0?"down":"up"),Wr(),he(!0);return}else{var Rt,Dt;(Rt=Cr.current)==null||Rt.style.setProperty("--swipe-amount-x","0px"),(Dt=Cr.current)==null||Dt.style.setProperty("--swipe-amount-y","0px")}B(!1),rn(!1),Ue(null)},onPointerMove:le=>{var st,ot,qt;if(!kr.current||!nn||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;const ft=le.clientY-kr.current.y,Re=le.clientX-kr.current.x;var Ji;const Rt=(Ji=t.swipeDirections)!=null?Ji:g4(k);!ye&&(Math.abs(Re)>1||Math.abs(ft)>1)&&Ue(Math.abs(Re)>Math.abs(ft)?"x":"y");let Dt={x:0,y:0};const Yc=On=>1/(1.5+Math.abs(On)/20);if(ye==="y"){if(Rt.includes("top")||Rt.includes("bottom"))if(Rt.includes("top")&&ft<0||Rt.includes("bottom")&&ft>0)Dt.y=ft;else{const On=ft*Yc(ft);Dt.y=Math.abs(On)<Math.abs(ft)?On:ft}}else if(ye==="x"&&(Rt.includes("left")||Rt.includes("right")))if(Rt.includes("left")&&Re<0||Rt.includes("right")&&Re>0)Dt.x=Re;else{const On=Re*Yc(Re);Dt.x=Math.abs(On)<Math.abs(Re)?On:Re}(Math.abs(Dt.x)>0||Math.abs(Dt.y)>0)&&B(!0),(ot=Cr.current)==null||ot.style.setProperty("--swipe-amount-x",`${Dt.x}px`),(qt=Cr.current)==null||qt.style.setProperty("--swipe-amount-y",`${Dt.y}px`)}},Ot&&!h.jsx&&nr!=="loading"?H.createElement("button",{"aria-label":fe,"data-disabled":Xi,"data-close-button":!0,onClick:Xi||!nn?()=>{}:()=>{Wr(),h.onDismiss==null||h.onDismiss.call(h,h)},className:on(X?.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(ts=ee?.close)!=null?ts:t4):null,(nr||h.icon||h.promise)&&h.icon!==null&&(ee?.[nr]!==null||h.icon)?H.createElement("div",{"data-icon":"",className:on(X?.icon,h==null||(i=h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Gc():null,h.type!=="loading"?Qi:null):null,H.createElement("div",{"data-content":"",className:on(X?.content,h==null||(a=h.classNames)==null?void 0:a.content)},H.createElement("div",{"data-title":"",className:on(X?.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?H.createElement("div",{"data-description":"",className:on(N,Bc,X?.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),H.isValidElement(h.cancel)?h.cancel:h.cancel&&yl(h.cancel)?H.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||A,onClick:le=>{yl(h.cancel)&&nn&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,le),Wr())},className:on(X?.cancelButton,h==null||(c=h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,H.isValidElement(h.action)?h.action:h.action&&yl(h.action)?H.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:le=>{yl(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,le),!le.defaultPrevented&&Wr())},className:on(X?.actionButton,h==null||(l=h.classNames)==null?void 0:l.actionButton)},h.action.label):null)};function vb(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function v4(t,e){const r={};return[t,e].forEach((n,i)=>{const a=i===1,s=a?"--mobile-offset":"--offset",o=a?d4:u4;function c(l){["top","right","bottom","left"].forEach(d=>{r[`${s}-${d}`]=typeof l=="number"?`${l}px`:l})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(l=>{n[l]===void 0?r[`${s}-${l}`]=o:r[`${s}-${l}`]=typeof n[l]=="number"?`${n[l]}px`:n[l]}):c(o)}),r}const b4=H.forwardRef(function(e,r){const{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:o,className:c,offset:l,mobileOffset:d,theme:h="light",richColors:m,duration:p,style:v,visibleToasts:b=l4,toastOptions:g,dir:_=vb(),gap:T=f4,icons:E,containerAriaLabel:j="Notifications"}=e,[R,D]=H.useState([]),S=H.useMemo(()=>Array.from(new Set([i].concat(R.filter(se=>se.position).map(se=>se.position)))),[R,i]),[A,P]=H.useState([]),[O,N]=H.useState(!1),[C,k]=H.useState(!1),[Q,ce]=H.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=H.useRef(null),ee=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),fe=H.useRef(null),ye=H.useRef(!1),Ue=H.useCallback(se=>{D(q=>{var J;return(J=q.find(rt=>rt.id===se.id))!=null&&J.delete||or.dismiss(se.id),q.filter(({id:rt})=>rt!==se.id)})},[]);return H.useEffect(()=>or.subscribe(se=>{if(se.dismiss){requestAnimationFrame(()=>{D(q=>q.map(J=>J.id===se.id?{...J,delete:!0}:J))});return}setTimeout(()=>{fk.flushSync(()=>{D(q=>{const J=q.findIndex(rt=>rt.id===se.id);return J!==-1?[...q.slice(0,J),{...q[J],...se},...q.slice(J+1)]:[se,...q]})})})}),[R]),H.useEffect(()=>{if(h!=="system"){ce(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ce("dark"):ce("light")),typeof window>"u")return;const se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:q})=>{ce(q?"dark":"light")})}catch{se.addListener(({matches:J})=>{try{ce(J?"dark":"light")}catch(rt){console.error(rt)}})}},[h]),H.useEffect(()=>{R.length<=1&&N(!1)},[R]),H.useEffect(()=>{const se=q=>{var J;if(a.every(Fe=>q[Fe]||q.code===Fe)){var ze;N(!0),(ze=X.current)==null||ze.focus()}q.code==="Escape"&&(document.activeElement===X.current||(J=X.current)!=null&&J.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),H.useEffect(()=>{if(X.current)return()=>{fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null,ye.current=!1)}},[X.current]),H.createElement("section",{ref:r,"aria-label":`${j} ${ee}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((se,q)=>{var J;const[rt,ze]=se.split("-");return R.length?H.createElement("ol",{key:se,dir:_==="auto"?vb():_,tabIndex:-1,ref:X,className:c,"data-sonner-toaster":!0,"data-sonner-theme":Q,"data-y-position":rt,"data-x-position":ze,style:{"--front-toast-height":`${((J=A[0])==null?void 0:J.height)||0}px`,"--width":`${h4}px`,"--gap":`${T}px`,...v,...v4(l,d)},onBlur:Fe=>{ye.current&&!Fe.currentTarget.contains(Fe.relatedTarget)&&(ye.current=!1,fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null))},onFocus:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,fe.current=Fe.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{C||N(!1)},onDragEnd:()=>N(!1),onPointerDown:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||k(!0)},onPointerUp:()=>k(!1)},R.filter(Fe=>!Fe.position&&q===0||Fe.position===se).map((Fe,Pr)=>{var rn,G;return H.createElement(y4,{key:Fe.id,icons:E,index:Pr,toast:Fe,defaultRichColors:m,duration:(rn=g?.duration)!=null?rn:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:n,visibleToasts:b,closeButton:(G=g?.closeButton)!=null?G:o,interacting:C,position:se,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:Ue,toasts:R.filter(he=>he.position==Fe.position),heights:A.filter(he=>he.position==Fe.position),setHeights:P,expandByDefault:s,gap:T,expanded:O,swipeDirections:e.swipeDirections})})):null}))});class x4{constructor(){Nr(this,"listeners",new Set)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}success(e,r,n){this.emit({type:"success",title:e,message:r,duration:n})}error(e,r,n){this.emit({type:"error",title:e,message:r,duration:n})}warning(e,r,n){this.emit({type:"warning",title:e,message:r,duration:n})}info(e,r,n){this.emit({type:"info",title:e,message:r,duration:n})}}const kd=new x4,vT=w.createContext(void 0),Us=()=>{const t=w.useContext(vT);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},w4=t=>{switch(t){case"success":return u.jsx(Ai,{size:20,className:"text-green-500"});case"error":return u.jsx(Jr,{size:20,className:"text-red-500"});case"warning":return u.jsx(_n,{size:20,className:"text-yellow-500"});case"info":return u.jsx(A_,{size:20,className:"text-blue-500"})}},_4=t=>{switch(t){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800";case"warning":return"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800";case"info":return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800"}},E4=({children:t})=>{const[e,r]=w.useState([]),n=w.useCallback(s=>{const o=`toast-${Date.now()}-${Math.random()}`,c={id:o,duration:5e3,...s};r(l=>[...l,c]),c.duration!==0&&setTimeout(()=>{i(o)},c.duration)},[]);w.useEffect(()=>kd.subscribe(o=>{n(o)}),[n]);const i=w.useCallback(s=>{r(o=>o.filter(c=>c.id!==s))},[]),a=w.useCallback(()=>{r([])},[]);return u.jsxs(vT.Provider,{value:{toasts:e,addToast:n,removeToast:i,clearToasts:a},children:[t,u.jsx(T4,{})]})},T4=()=>{const{toasts:t,removeToast:e}=Us();return u.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:u.jsx(Pe,{children:t.map(r=>u.jsx(L.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{type:"spring",damping:25,stiffness:300},className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${_4(r.type)}`,role:"alert","aria-live":"assertive",tabIndex:0,children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:"flex-shrink-0 mt-0.5",children:w4(r.type)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.title}),r.message&&u.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r.message})]}),u.jsx("button",{onClick:()=>e(r.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Cerrar notificación",children:u.jsx(Fi,{size:16})})]})},r.id))})})},gi={QUERY:{STALE_TIME:{MEDIUM:1e3*60*15},GC_TIME:{MEDIUM:1e3*60*30,LONG:1e3*60*60},RETRY:{COUNT:1,DELAY:1e3}}},oo={measureTime:async(t,e)=>typeof e=="function"?await e():e,markStart:t=>{},markEnd:t=>{},debounce:(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(void 0,n),e)}},throttle:(t,e)=>{let r;return(...n)=>{r||(t.apply(void 0,n),r=!0,setTimeout(()=>r=!1,e))}}},A4=()=>(w.useEffect(()=>{},[]),{measureTime:oo.measureTime,markStart:oo.markStart,markEnd:oo.markEnd,debounce:oo.debounce,throttle:oo.throttle}),S4=()=>{const t=()=>{const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`),typeof CSS<"u"&&CSS.supports&&CSS.supports("padding","env(safe-area-inset-top)")?(document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-bottom","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)")):(document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-bottom","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px"))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(t,100)}),"visualViewport"in window&&window.visualViewport?.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),"visualViewport"in window&&window.visualViewport?.removeEventListener("resize",t)}};const I4=()=>{const[t,e]=w.useState({isOnline:navigator.onLine});return w.useEffect(()=>{const r=()=>{const o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e({isOnline:navigator.onLine,connectionType:o?.type,effectiveType:o?.effectiveType,downlink:o?.downlink,rtt:o?.rtt})},n=()=>{console.log("[Network] Connection restored"),r()},i=()=>{console.log("[Network] Connection lost"),r()},a=()=>{console.log("[Network] Connection changed"),r()};r(),window.addEventListener("online",n),window.addEventListener("offline",i);const s=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return s&&s.addEventListener("change",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i),s&&s.removeEventListener("change",a)}},[]),t},P4=()=>{const t=I4();return{...t,quality:(()=>{if(!t.isOnline)return"offline";if(t.effectiveType)switch(t.effectiveType){case"4g":return"fast";case"3g":return"slow";case"2g":return"slow";case"slow-2g":return"slow";default:return"fast"}return t.downlink!==void 0?t.downlink>1.5?"fast":"slow":"fast"})()}},C4=()=>{const[t,e]=w.useState(!1);P4();const{user:r,initialized:n}=Nn();return null},k4=()=>{},Qp=(t,e)=>{console.error(`[CRITICAL][${t}]`,e),console.warn("Production error detected:",{context:t,error:e})};function bT(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=bT(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Le(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=bT(t))&&(n&&(n+=" "),n+=e);return n}const Jp="-",N4=t=>{const e=O4(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(Jp);return o[0]===""&&o.length!==1&&o.shift(),xT(o,e)||j4(s)},getConflictingClassGroupIds:(s,o)=>{const c=r[s]||[];return o&&n[s]?[...c,...n[s]]:c}}},xT=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?xT(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(Jp);return e.validators.find(({validator:s})=>s(a))?.classGroupId},bb=/^\[(.+)\]$/,j4=t=>{if(bb.test(t)){const e=bb.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},O4=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return D4(Object.entries(t.classGroups),r).forEach(([a,s])=>{cm(s,n,a,e)}),n},cm=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:xb(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(R4(i)){cm(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{cm(s,xb(e,a),r,n)})})},xb=(t,e)=>{let r=t;return e.split(Jp).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},R4=t=>t.isThemeGetter,D4=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,M4=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},wT="!",L4=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const c=[];let l=0,d=0,h;for(let g=0;g<o.length;g++){let _=o[g];if(l===0){if(_===i&&(n||o.slice(g,g+a)===e)){c.push(o.slice(d,g)),d=g+a;continue}if(_==="/"){h=g;continue}}_==="["?l++:_==="]"&&l--}const m=c.length===0?o:o.substring(d),p=m.startsWith(wT),v=p?m.substring(1):m,b=h&&h>d?h-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},$4=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},V4=t=>({cache:M4(t.cacheSize),parseClassName:L4(t),...N4(t)}),z4=/\s+/,F4=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(z4);let o="";for(let c=s.length-1;c>=0;c-=1){const l=s[c],{modifiers:d,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=r(l);let v=!!p,b=n(v?m.substring(0,p):m);if(!b){if(!v){o=l+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=l+(o.length>0?" "+o:o);continue}v=!1}const g=$4(d).join(":"),_=h?g+wT:g,T=_+b;if(a.includes(T))continue;a.push(T);const E=i(b,v);for(let j=0;j<E.length;++j){const R=E[j];a.push(_+R)}o=l+(o.length>0?" "+o:o)}return o};function U4(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=_T(e))&&(n&&(n+=" "),n+=r);return n}const _T=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=_T(t[n]))&&(r&&(r+=" "),r+=e);return r};function B4(t,...e){let r,n,i,a=s;function s(c){const l=e.reduce((d,h)=>h(d),t());return r=V4(l),n=r.cache.get,i=r.cache.set,a=o,o(c)}function o(c){const l=n(c);if(l)return l;const d=F4(c,r);return i(c,d),d}return function(){return a(U4.apply(null,arguments))}}const He=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},ET=/^\[(?:([a-z-]+):)?(.+)\]$/i,H4=/^\d+\/\d+$/,W4=new Set(["px","full","screen"]),q4=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,K4=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,G4=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Y4=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Z4=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Mn=t=>bs(t)||W4.has(t)||H4.test(t),hi=t=>Bs(t,"length",i$),bs=t=>!!t&&!Number.isNaN(Number(t)),rf=t=>Bs(t,"number",bs),co=t=>!!t&&Number.isInteger(Number(t)),X4=t=>t.endsWith("%")&&bs(t.slice(0,-1)),ve=t=>ET.test(t),fi=t=>q4.test(t),Q4=new Set(["length","size","percentage"]),J4=t=>Bs(t,Q4,TT),e$=t=>Bs(t,"position",TT),t$=new Set(["image","url"]),r$=t=>Bs(t,t$,s$),n$=t=>Bs(t,"",a$),lo=()=>!0,Bs=(t,e,r)=>{const n=ET.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},i$=t=>K4.test(t)&&!G4.test(t),TT=()=>!1,a$=t=>Y4.test(t),s$=t=>Z4.test(t),o$=()=>{const t=He("colors"),e=He("spacing"),r=He("blur"),n=He("brightness"),i=He("borderColor"),a=He("borderRadius"),s=He("borderSpacing"),o=He("borderWidth"),c=He("contrast"),l=He("grayscale"),d=He("hueRotate"),h=He("invert"),m=He("gap"),p=He("gradientColorStops"),v=He("gradientColorStopPositions"),b=He("inset"),g=He("margin"),_=He("opacity"),T=He("padding"),E=He("saturate"),j=He("scale"),R=He("sepia"),D=He("skew"),S=He("space"),A=He("translate"),P=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",ve,e],C=()=>[ve,e],k=()=>["",Mn,hi],Q=()=>["auto",bs,ve],ce=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>["start","end","center","between","around","evenly","stretch"],ye=()=>["","0",ve],Ue=()=>["auto","avoid","all","avoid-page","page","left","right","column"],se=()=>[bs,ve];return{cacheSize:500,separator:":",theme:{colors:[lo],spacing:[Mn,hi],blur:["none","",fi,ve],brightness:se(),borderColor:[t],borderRadius:["none","","full",fi,ve],borderSpacing:C(),borderWidth:k(),contrast:se(),grayscale:ye(),hueRotate:se(),invert:ye(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[X4,hi],inset:N(),margin:N(),opacity:se(),padding:C(),saturate:se(),scale:se(),sepia:ye(),skew:se(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[fi]}],"break-after":[{"break-after":Ue()}],"break-before":[{"break-before":Ue()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ce(),ve]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",co,ve]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",co,ve]}],"grid-cols":[{"grid-cols":[lo]}],"col-start-end":[{col:["auto",{span:["full",co,ve]},ve]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[lo]}],"row-start-end":[{row:["auto",{span:[co,ve]},ve]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...fe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...fe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...fe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ve,e]}],"min-w":[{"min-w":[ve,e,"min","max","fit"]}],"max-w":[{"max-w":[ve,e,"none","full","min","max","fit","prose",{screen:[fi]},fi]}],h:[{h:[ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",fi,hi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",rf]}],"font-family":[{font:[lo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",bs,rf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Mn,ve]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Mn,hi]}],"underline-offset":[{"underline-offset":["auto",Mn,ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ce(),e$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",J4]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},r$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:X()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Mn,ve]}],"outline-w":[{outline:[Mn,hi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Mn,hi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",fi,n$]}],"shadow-color":[{shadow:[lo]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",fi,ve]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:se()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:se()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[co,ve]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Mn,hi,rf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},c$=B4(o$),AT=void 0,l$=void 0;throw new Error("Missing Supabase environment variables");const Et=mk(AT,l$,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"plantitas-app"}},realtime:{timeout:1e4}}),u$=Object.freeze(Object.defineProperty({__proto__:null,supabase:Et,supabaseUrl:AT},Symbol.toStringTag,{value:"Module"}));function Oe(...t){return c$(Le(t))}const wt={auth:"/auth",dashboard:"/",camera:"/camera",settings:"/settings",gardenChat:"/garden-chat",plantDetail:t=>`/plant/${t}`,plantChat:t=>`/plant/${t}/chat`},lt={toDashboard:()=>wt.dashboard,toCamera:()=>wt.camera,toSettings:()=>wt.settings,toGardenChat:()=>wt.gardenChat,toPlantDetail:t=>wt.plantDetail(t),toPlantChat:t=>wt.plantChat(t),toAuth:()=>wt.auth},d$=(t,e)=>t===e?!0:e===wt.dashboard?t==="/"||t.startsWith("/plant/"):e===wt.gardenChat?t===wt.gardenChat||t.includes("/chat")||t.includes("/garden-chat"):e===wt.settings?t.startsWith("/settings"):!1;let vl;const h$=new Uint8Array(16);function f$(){if(!vl&&(vl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!vl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vl(h$)}const Lt=[];for(let t=0;t<256;++t)Lt.push((t+256).toString(16).slice(1));function m$(t,e=0){return Lt[t[e+0]]+Lt[t[e+1]]+Lt[t[e+2]]+Lt[t[e+3]]+"-"+Lt[t[e+4]]+Lt[t[e+5]]+"-"+Lt[t[e+6]]+Lt[t[e+7]]+"-"+Lt[t[e+8]]+Lt[t[e+9]]+"-"+Lt[t[e+10]]+Lt[t[e+11]]+Lt[t[e+12]]+Lt[t[e+13]]+Lt[t[e+14]]+Lt[t[e+15]]}const p$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wb={randomUUID:p$};function g$(t,e,r){if(wb.randomUUID&&!t)return wb.randomUUID();t=t||{};const n=t.random||(t.rng||f$)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,m$(n)}const ST=5,y$=ST*1024*1024,IT=t=>{if(!t||typeof t!="string")throw new Error("URL de imagen inválida");const e=t.split(",")[1];if(!e)throw new Error("Formato de imagen inválido");const r=e.length*3/4;if(r>y$){const n=(r/1048576).toFixed(1);throw new Error(`La imagen es demasiado grande (${n}MB). El límite máximo es ${ST}MB. Por favor, usa una imagen más pequeña.`)}console.log(`[imageService] Image size validation passed: ${(r/(1024*1024)).toFixed(2)}MB`)},v$=t=>{if(!t||typeof t!="string")throw new Error("Invalid data URL: input is not a string");if(!t.startsWith("data:"))throw new Error('Invalid data URL: does not start with "data:"');const e=t.split(",");if(e.length!==2)throw new Error("Invalid data URL: incorrect format");const r=e[0].match(/:(.*?);/);if(!r)throw new Error("Invalid data URL: could not extract MIME type");const n=r[1];if(!n.startsWith("image/"))throw new Error(`Invalid data URL: not an image MIME type (${n})`);try{const i=atob(e[1]);let a=i.length;const s=new Uint8Array(a);for(;a--;)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}catch(i){throw new Error(`Invalid data URL: failed to decode base64 data - ${i instanceof Error?i.message:"Unknown error"}`)}},PT=async(t,e,r)=>{try{IT(t);const n=v$(t),i=n.type.split("/")[1],a=`${r}/${g$()}.${i}`,{error:s}=await Et.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(s)throw console.error("Error uploading image to Supabase Storage:",s),new Error(`Storage error: ${s.message}`);const{data:o}=Et.storage.from(e).getPublicUrl(a);if(!o||!o.publicUrl)throw new Error("Could not get public URL for uploaded image.");return o.publicUrl}catch(n){throw console.error("Failed to upload image:",n),n instanceof Error?new Error(`Image upload failed: ${n.message}`):new Error("An unknown error occurred during image upload.")}};function z(t,e,r){function n(o,c){var l;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(l=o._zod).traits??(l.traits=new Set),o._zod.traits.add(t),e(o,c);for(const d in s.prototype)d in o||Object.defineProperty(o,d,{value:s.prototype[d].bind(o)});o._zod.constr=s,o._zod.def=c}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var c;const l=r?.Parent?new a:this;n(l,o),(c=l._zod).deferred??(c.deferred=[]);for(const d of l._zod.deferred)d();return l}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}class ic extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const CT={};function ja(t){return CT}function b$(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function x$(t,e){return typeof e=="bigint"?e.toString():e}function kT(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function eg(t){return t==null}function tg(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function w$(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}function Ge(t,e,r){Object.defineProperty(t,e,{get(){{const n=r();return t[e]=n,n}},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function rg(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function uo(t){return JSON.stringify(t)}const NT=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function lm(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const _$=kT(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function um(t){if(lm(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(lm(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const E$=new Set(["string","number","symbol"]);function Nd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Wa(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function ne(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function T$(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const A$={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function S$(t,e){const r={},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Wa(t,{...t._zod.def,shape:r,checks:[]})}function I$(t,e){const r={...t._zod.def.shape},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Wa(t,{...t._zod.def,shape:r,checks:[]})}function P$(t,e){if(!um(e))throw new Error("Invalid input to extend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return rg(this,"shape",n),n},checks:[]};return Wa(t,r)}function C$(t,e){return Wa(t,{...t._zod.def,get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return rg(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function k$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in n))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=t?new t({type:"optional",innerType:n[a]}):n[a])}else for(const a in n)i[a]=t?new t({type:"optional",innerType:n[a]}):n[a];return Wa(e,{...e._zod.def,shape:i,checks:[]})}function N$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=new t({type:"nonoptional",innerType:n[a]}))}else for(const a in n)i[a]=new t({type:"nonoptional",innerType:n[a]});return Wa(e,{...e._zod.def,shape:i,checks:[]})}function zo(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function ng(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function bl(t){return typeof t=="string"?t:t?.message}function Oa(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=bl(t.inst?._zod.def?.error?.(t))??bl(e?.error?.(t))??bl(r.customError?.(t))??bl(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function ig(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function ac(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}const jT=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,x$,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},OT=z("$ZodError",jT),RT=z("$ZodError",jT,{Parent:Error});function j$(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function O$(t,e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(r(s));else{let o=n,c=0;for(;c<s.path.length;){const l=s.path[c];c===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(s))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return i(t),n}const R$=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new ic;if(s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>Oa(c,a,ja())));throw NT(o,i?.callee),o}return s.value},D$=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>Oa(c,a,ja())));throw NT(o,i?.callee),o}return s.value},DT=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new ic;return a.issues.length?{success:!1,error:new(t??OT)(a.issues.map(s=>Oa(s,i,ja())))}:{success:!0,data:a.value}},M$=DT(RT),MT=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>Oa(s,i,ja())))}:{success:!0,data:a.value}},L$=MT(RT),$$=/^[cC][^\s-]{8,}$/,V$=/^[0-9a-z]+$/,z$=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,F$=/^[0-9a-vA-V]{20}$/,U$=/^[A-Za-z0-9]{27}$/,B$=/^[a-zA-Z0-9_-]{21}$/,H$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,W$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,_b=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,q$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,K$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function G$(){return new RegExp(K$,"u")}const Y$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Z$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,X$=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Q$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,J$=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,LT=/^[A-Za-z0-9_-]*$/,e5=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,t5=/^\+(?:[0-9]){6,14}[0-9]$/,$T="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",r5=new RegExp(`^${$T}$`);function VT(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function n5(t){return new RegExp(`^${VT(t)}$`)}function i5(t){const e=VT({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${$T}T(?:${n})$`)}const a5=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},s5=/^\d+$/,o5=/^-?\d+(?:\.\d+)?/i,c5=/true|false/i,l5=/^[^A-Z]*$/,u5=/^[^a-z]*$/,hr=z("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),zT={number:"number",bigint:"bigint",object:"date"},FT=z("$ZodCheckLessThan",(t,e)=>{hr.init(t,e);const r=zT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),UT=z("$ZodCheckGreaterThan",(t,e)=>{hr.init(t,e);const r=zT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),d5=z("$ZodCheckMultipleOf",(t,e)=>{hr.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):w$(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),h5=z("$ZodCheckNumberFormat",(t,e)=>{hr.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=A$[e.format];t._zod.onattach.push(s=>{const o=s._zod.bag;o.format=e.format,o.minimum=i,o.maximum=a,r&&(o.pattern=s5)}),t._zod.check=s=>{const o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:n,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}o<i&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:t})}}),f5=z("$ZodCheckMaxLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!eg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const s=ig(i);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),m5=z("$ZodCheckMinLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!eg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const s=ig(i);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),p5=z("$ZodCheckLengthEquals",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!eg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const s=ig(i),o=a>e.length;n.issues.push({origin:s,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),jd=z("$ZodCheckStringFormat",(t,e)=>{var r,n;hr.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),g5=z("$ZodCheckRegex",(t,e)=>{jd.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),y5=z("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=l5),jd.init(t,e)}),v5=z("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=u5),jd.init(t,e)}),b5=z("$ZodCheckIncludes",(t,e)=>{hr.init(t,e);const r=Nd(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),x5=z("$ZodCheckStartsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`^${Nd(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),w5=z("$ZodCheckEndsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`.*${Nd(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),_5=z("$ZodCheckOverwrite",(t,e)=>{hr.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class E5{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(s=>s),i=Math.min(...n.map(s=>s.length-s.trimStart().length)),a=n.map(s=>s.slice(i)).map(s=>" ".repeat(this.indent*2)+s);for(const s of a)this.content.push(s)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const T5={major:4,minor:0,patch:5},Je=z("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=T5;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,s,o)=>{let c=zo(a),l;for(const d of s){if(d._zod.def.when){if(!d._zod.def.when(a))continue}else if(c)continue;const h=a.issues.length,m=d._zod.check(a);if(m instanceof Promise&&o?.async===!1)throw new ic;if(l||m instanceof Promise)l=(l??Promise.resolve()).then(async()=>{await m,a.issues.length!==h&&(c||(c=zo(a,h)))});else{if(a.issues.length===h)continue;c||(c=zo(a,h))}}return l?l.then(()=>a):a};t._zod.run=(a,s)=>{const o=t._zod.parse(a,s);if(o instanceof Promise){if(s.async===!1)throw new ic;return o.then(c=>i(c,n,s))}return i(o,n,s)}}t["~standard"]={validate:i=>{try{const a=M$(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return L$(t,i).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),ag=z("$ZodString",(t,e)=>{Je.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??a5(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Ze=z("$ZodStringFormat",(t,e)=>{jd.init(t,e),ag.init(t,e)}),A5=z("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=W$),Ze.init(t,e)}),S5=z("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=_b(n))}else e.pattern??(e.pattern=_b());Ze.init(t,e)}),I5=z("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=q$),Ze.init(t,e)}),P5=z("$ZodURL",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{try{const n=r.value,i=new URL(n),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e5.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),C5=z("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=G$()),Ze.init(t,e)}),k5=z("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=B$),Ze.init(t,e)}),N5=z("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=$$),Ze.init(t,e)}),j5=z("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=V$),Ze.init(t,e)}),O5=z("$ZodULID",(t,e)=>{e.pattern??(e.pattern=z$),Ze.init(t,e)}),R5=z("$ZodXID",(t,e)=>{e.pattern??(e.pattern=F$),Ze.init(t,e)}),D5=z("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=U$),Ze.init(t,e)}),M5=z("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=i5(e)),Ze.init(t,e)}),L5=z("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=r5),Ze.init(t,e)}),$5=z("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=n5(e)),Ze.init(t,e)}),V5=z("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=H$),Ze.init(t,e)}),z5=z("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Y$),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),F5=z("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Z$),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),U5=z("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=X$),Ze.init(t,e)}),B5=z("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Q$),Ze.init(t,e),t._zod.check=r=>{const[n,i]=r.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function BT(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const H5=z("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=J$),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{BT(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function W5(t){if(!LT.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return BT(r)}const q5=z("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=LT),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{W5(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),K5=z("$ZodE164",(t,e)=>{e.pattern??(e.pattern=t5),Ze.init(t,e)});function G5(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const Y5=z("$ZodJWT",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{G5(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),HT=z("$ZodNumber",(t,e)=>{Je.init(t,e),t._zod.pattern=t._zod.bag.pattern??o5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),Z5=z("$ZodNumber",(t,e)=>{h5.init(t,e),HT.init(t,e)}),X5=z("$ZodBoolean",(t,e)=>{Je.init(t,e),t._zod.pattern=c5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),Q5=z("$ZodUnknown",(t,e)=>{Je.init(t,e),t._zod.parse=r=>r}),J5=z("$ZodNever",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),eV=z("$ZodDate",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function Eb(t,e,r){t.issues.length&&e.issues.push(...ng(r,t.issues)),e.value[r]=t.value}const tV=z("$ZodArray",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let s=0;s<i.length;s++){const o=i[s],c=e.element._zod.run({value:o,issues:[]},n);c instanceof Promise?a.push(c.then(l=>Eb(l,r,s))):Eb(c,r,s)}return a.length?Promise.all(a).then(()=>r):r}});function xl(t,e,r){t.issues.length&&e.issues.push(...ng(r,t.issues)),e.value[r]=t.value}function Tb(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...ng(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}const rV=z("$ZodObject",(t,e)=>{Je.init(t,e);const r=kT(()=>{const h=Object.keys(e.shape);for(const p of h)if(!(e.shape[p]instanceof Je))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const m=T$(e.shape);return{shape:e.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(m)}});Ge(t._zod,"propValues",()=>{const h=e.shape,m={};for(const p in h){const v=h[p]._zod;if(v.values){m[p]??(m[p]=new Set);for(const b of v.values)m[p].add(b)}}return m});const n=h=>{const m=new E5(["shape","payload","ctx"]),p=r.value,v=T=>{const E=uo(T);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};m.write("const input = payload.value;");const b=Object.create(null);let g=0;for(const T of p.keys)b[T]=`key_${g++}`;m.write("const newResult = {}");for(const T of p.keys)if(p.optionalKeys.has(T)){const E=b[T];m.write(`const ${E} = ${v(T)};`);const j=uo(T);m.write(`
        if (${E}.issues.length) {
          if (input[${j}] === undefined) {
            if (${j} in input) {
              newResult[${j}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${j}, ...iss.path] : [${j}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${j} in input) newResult[${j}] = undefined;
        } else {
          newResult[${j}] = ${E}.value;
        }
        `)}else{const E=b[T];m.write(`const ${E} = ${v(T)};`),m.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${uo(T)}, ...iss.path] : [${uo(T)}]
          })));`),m.write(`newResult[${uo(T)}] = ${E}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const _=m.compile();return(T,E)=>_(h,T,E)};let i;const a=lm,s=!CT.jitless,c=s&&_$.value,l=e.catchall;let d;t._zod.parse=(h,m)=>{d??(d=r.value);const p=h.value;if(!a(p))return h.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),h;const v=[];if(s&&c&&m?.async===!1&&m.jitless!==!0)i||(i=n(e.shape)),h=i(h,m);else{h.value={};const E=d.shape;for(const j of d.keys){const R=E[j],D=R._zod.run({value:p[j],issues:[]},m),S=R._zod.optin==="optional"&&R._zod.optout==="optional";D instanceof Promise?v.push(D.then(A=>S?Tb(A,h,j,p):xl(A,h,j))):S?Tb(D,h,j,p):xl(D,h,j)}}if(!l)return v.length?Promise.all(v).then(()=>h):h;const b=[],g=d.keySet,_=l._zod,T=_.def.type;for(const E of Object.keys(p)){if(g.has(E))continue;if(T==="never"){b.push(E);continue}const j=_.run({value:p[E],issues:[]},m);j instanceof Promise?v.push(j.then(R=>xl(R,h,E))):xl(j,h,E)}return b.length&&h.issues.push({code:"unrecognized_keys",keys:b,input:p,inst:t}),v.length?Promise.all(v).then(()=>h):h}});function Ab(t,e,r,n){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(a=>Oa(a,n,ja())))}),e}const nV=z("$ZodUnion",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ge(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ge(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Ge(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>tg(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let i=!1;const a=[];for(const s of e.options){const o=s._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)a.push(o),i=!0;else{if(o.issues.length===0)return o;a.push(o)}}return i?Promise.all(a).then(s=>Ab(s,r,t,n)):Ab(a,r,t,n)}}),iV=z("$ZodIntersection",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),s=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||s instanceof Promise?Promise.all([a,s]).then(([c,l])=>Sb(r,c,l)):Sb(r,a,s)}});function dm(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(um(t)&&um(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const s=dm(t[a],e[a]);if(!s.valid)return{valid:!1,mergeErrorPath:[a,...s.mergeErrorPath]};i[a]=s.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],s=dm(i,a);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Sb(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),zo(t))return t;const n=dm(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const aV=z("$ZodEnum",(t,e)=>{Je.init(t,e);const r=b$(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>E$.has(typeof n)).map(n=>typeof n=="string"?Nd(n):n.toString()).join("|")})$`),t._zod.parse=(n,i)=>{const a=n.value;return t._zod.values.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:t}),n}}),sV=z("$ZodTransform",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(s=>(r.value=s,r));if(i instanceof Promise)throw new ic;return r.value=i,r}}),oV=z("$ZodOptional",(t,e)=>{Je.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${tg(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),cV=z("$ZodNullable",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${tg(r.source)}|null)$`):void 0}),Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),lV=z("$ZodDefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Ib(a,e)):Ib(i,e)}});function Ib(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const uV=z("$ZodPrefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),dV=z("$ZodNonOptional",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Pb(a,t)):Pb(i,t)}});function Pb(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const hV=z("$ZodCatch",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(s=>Oa(s,n,ja()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>Oa(a,n,ja()))},input:r.value}),r.issues=[]),r)}}),fV=z("$ZodPipe",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>e.in._zod.values),Ge(t._zod,"optin",()=>e.in._zod.optin),Ge(t._zod,"optout",()=>e.out._zod.optout),Ge(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>Cb(a,e,n)):Cb(i,e,n)}});function Cb(t,e,r){return zo(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}const mV=z("$ZodReadonly",(t,e)=>{Je.init(t,e),Ge(t._zod,"propValues",()=>e.innerType._zod.propValues),Ge(t._zod,"values",()=>e.innerType._zod.values),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(kb):kb(i)}});function kb(t){return t.value=Object.freeze(t.value),t}const pV=z("$ZodCustom",(t,e)=>{hr.init(t,e),Je.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>Nb(a,r,n,t));Nb(i,r,n,t)}});function Nb(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(ac(i))}}class gV{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function yV(){return new gV}const wl=yV();function vV(t,e){return new t({type:"string",...ne(e)})}function bV(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ne(e)})}function jb(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ne(e)})}function xV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ne(e)})}function wV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ne(e)})}function _V(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ne(e)})}function EV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ne(e)})}function TV(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ne(e)})}function AV(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ne(e)})}function SV(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ne(e)})}function IV(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ne(e)})}function PV(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ne(e)})}function CV(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ne(e)})}function kV(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ne(e)})}function NV(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ne(e)})}function jV(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ne(e)})}function OV(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ne(e)})}function RV(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ne(e)})}function DV(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ne(e)})}function MV(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ne(e)})}function LV(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ne(e)})}function $V(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ne(e)})}function VV(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ne(e)})}function zV(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ne(e)})}function FV(t,e){return new t({type:"string",format:"date",check:"string_format",...ne(e)})}function UV(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ne(e)})}function BV(t,e){return new t({type:"string",format:"duration",check:"string_format",...ne(e)})}function HV(t,e){return new t({type:"number",checks:[],...ne(e)})}function WV(t,e){return new t({type:"number",coerce:!0,checks:[],...ne(e)})}function qV(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ne(e)})}function KV(t,e){return new t({type:"boolean",...ne(e)})}function GV(t){return new t({type:"unknown"})}function YV(t,e){return new t({type:"never",...ne(e)})}function ZV(t,e){return new t({type:"date",...ne(e)})}function Ob(t,e){return new FT({check:"less_than",...ne(e),value:t,inclusive:!1})}function Gl(t,e){return new FT({check:"less_than",...ne(e),value:t,inclusive:!0})}function Rb(t,e){return new UT({check:"greater_than",...ne(e),value:t,inclusive:!1})}function Yl(t,e){return new UT({check:"greater_than",...ne(e),value:t,inclusive:!0})}function Db(t,e){return new d5({check:"multiple_of",...ne(e),value:t})}function WT(t,e){return new f5({check:"max_length",...ne(e),maximum:t})}function Su(t,e){return new m5({check:"min_length",...ne(e),minimum:t})}function qT(t,e){return new p5({check:"length_equals",...ne(e),length:t})}function XV(t,e){return new g5({check:"string_format",format:"regex",...ne(e),pattern:t})}function QV(t){return new y5({check:"string_format",format:"lowercase",...ne(t)})}function JV(t){return new v5({check:"string_format",format:"uppercase",...ne(t)})}function e6(t,e){return new b5({check:"string_format",format:"includes",...ne(e),includes:t})}function t6(t,e){return new x5({check:"string_format",format:"starts_with",...ne(e),prefix:t})}function r6(t,e){return new w5({check:"string_format",format:"ends_with",...ne(e),suffix:t})}function Cc(t){return new _5({check:"overwrite",tx:t})}function n6(t){return Cc(e=>e.normalize(t))}function i6(){return Cc(t=>t.trim())}function a6(){return Cc(t=>t.toLowerCase())}function s6(){return Cc(t=>t.toUpperCase())}function o6(t,e,r){return new t({type:"array",element:e,...ne(r)})}function c6(t,e,r){return new t({type:"custom",check:"custom",fn:e,...ne(r)})}const l6=z("ZodISODateTime",(t,e)=>{M5.init(t,e),et.init(t,e)});function u6(t){return zV(l6,t)}const d6=z("ZodISODate",(t,e)=>{L5.init(t,e),et.init(t,e)});function h6(t){return FV(d6,t)}const f6=z("ZodISOTime",(t,e)=>{$5.init(t,e),et.init(t,e)});function m6(t){return UV(f6,t)}const p6=z("ZodISODuration",(t,e)=>{V5.init(t,e),et.init(t,e)});function g6(t){return BV(p6,t)}const KT=(t,e)=>{OT.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>O$(t,r)},flatten:{value:r=>j$(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},y6=z("ZodError",KT),Od=z("ZodError",KT,{Parent:Error}),v6=R$(Od),b6=D$(Od),x6=DT(Od),w6=MT(Od),dt=z("ZodType",(t,e)=>(Je.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Wa(t,r,n),t.brand=()=>t,t.register=(r,n)=>(r.add(t,n),t),t.parse=(r,n)=>v6(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>x6(t,r,n),t.parseAsync=async(r,n)=>b6(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>w6(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(f3(r,n)),t.superRefine=r=>t.check(m3(r)),t.overwrite=r=>t.check(Cc(r)),t.optional=()=>Vb(t),t.nullable=()=>zb(t),t.nullish=()=>Vb(zb(t)),t.nonoptional=r=>a3(t,r),t.array=()=>_e(t),t.or=r=>Y6([t,r]),t.and=r=>X6(t,r),t.transform=r=>Fb(t,J6(r)),t.default=r=>r3(t,r),t.prefault=r=>i3(t,r),t.catch=r=>o3(t,r),t.pipe=r=>Fb(t,r),t.readonly=()=>u3(t),t.describe=r=>{const n=t.clone();return wl.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return wl.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return wl.get(t);const n=t.clone();return wl.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),GT=z("_ZodString",(t,e)=>{ag.init(t,e),dt.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(XV(...n)),t.includes=(...n)=>t.check(e6(...n)),t.startsWith=(...n)=>t.check(t6(...n)),t.endsWith=(...n)=>t.check(r6(...n)),t.min=(...n)=>t.check(Su(...n)),t.max=(...n)=>t.check(WT(...n)),t.length=(...n)=>t.check(qT(...n)),t.nonempty=(...n)=>t.check(Su(1,...n)),t.lowercase=n=>t.check(QV(n)),t.uppercase=n=>t.check(JV(n)),t.trim=()=>t.check(i6()),t.normalize=(...n)=>t.check(n6(...n)),t.toLowerCase=()=>t.check(a6()),t.toUpperCase=()=>t.check(s6())}),_6=z("ZodString",(t,e)=>{ag.init(t,e),GT.init(t,e),t.email=r=>t.check(bV(E6,r)),t.url=r=>t.check(TV(T6,r)),t.jwt=r=>t.check(VV(V6,r)),t.emoji=r=>t.check(AV(A6,r)),t.guid=r=>t.check(jb(Mb,r)),t.uuid=r=>t.check(xV(_l,r)),t.uuidv4=r=>t.check(wV(_l,r)),t.uuidv6=r=>t.check(_V(_l,r)),t.uuidv7=r=>t.check(EV(_l,r)),t.nanoid=r=>t.check(SV(S6,r)),t.guid=r=>t.check(jb(Mb,r)),t.cuid=r=>t.check(IV(I6,r)),t.cuid2=r=>t.check(PV(P6,r)),t.ulid=r=>t.check(CV(C6,r)),t.base64=r=>t.check(MV(M6,r)),t.base64url=r=>t.check(LV(L6,r)),t.xid=r=>t.check(kV(k6,r)),t.ksuid=r=>t.check(NV(N6,r)),t.ipv4=r=>t.check(jV(j6,r)),t.ipv6=r=>t.check(OV(O6,r)),t.cidrv4=r=>t.check(RV(R6,r)),t.cidrv6=r=>t.check(DV(D6,r)),t.e164=r=>t.check($V($6,r)),t.datetime=r=>t.check(u6(r)),t.date=r=>t.check(h6(r)),t.time=r=>t.check(m6(r)),t.duration=r=>t.check(g6(r))});function K(t){return vV(_6,t)}const et=z("ZodStringFormat",(t,e)=>{Ze.init(t,e),GT.init(t,e)}),E6=z("ZodEmail",(t,e)=>{I5.init(t,e),et.init(t,e)}),Mb=z("ZodGUID",(t,e)=>{A5.init(t,e),et.init(t,e)}),_l=z("ZodUUID",(t,e)=>{S5.init(t,e),et.init(t,e)}),T6=z("ZodURL",(t,e)=>{P5.init(t,e),et.init(t,e)}),A6=z("ZodEmoji",(t,e)=>{C5.init(t,e),et.init(t,e)}),S6=z("ZodNanoID",(t,e)=>{k5.init(t,e),et.init(t,e)}),I6=z("ZodCUID",(t,e)=>{N5.init(t,e),et.init(t,e)}),P6=z("ZodCUID2",(t,e)=>{j5.init(t,e),et.init(t,e)}),C6=z("ZodULID",(t,e)=>{O5.init(t,e),et.init(t,e)}),k6=z("ZodXID",(t,e)=>{R5.init(t,e),et.init(t,e)}),N6=z("ZodKSUID",(t,e)=>{D5.init(t,e),et.init(t,e)}),j6=z("ZodIPv4",(t,e)=>{z5.init(t,e),et.init(t,e)}),O6=z("ZodIPv6",(t,e)=>{F5.init(t,e),et.init(t,e)}),R6=z("ZodCIDRv4",(t,e)=>{U5.init(t,e),et.init(t,e)}),D6=z("ZodCIDRv6",(t,e)=>{B5.init(t,e),et.init(t,e)}),M6=z("ZodBase64",(t,e)=>{H5.init(t,e),et.init(t,e)}),L6=z("ZodBase64URL",(t,e)=>{q5.init(t,e),et.init(t,e)}),$6=z("ZodE164",(t,e)=>{K5.init(t,e),et.init(t,e)}),V6=z("ZodJWT",(t,e)=>{Y5.init(t,e),et.init(t,e)}),sg=z("ZodNumber",(t,e)=>{HT.init(t,e),dt.init(t,e),t.gt=(n,i)=>t.check(Rb(n,i)),t.gte=(n,i)=>t.check(Yl(n,i)),t.min=(n,i)=>t.check(Yl(n,i)),t.lt=(n,i)=>t.check(Ob(n,i)),t.lte=(n,i)=>t.check(Gl(n,i)),t.max=(n,i)=>t.check(Gl(n,i)),t.int=n=>t.check(Lb(n)),t.safe=n=>t.check(Lb(n)),t.positive=n=>t.check(Rb(0,n)),t.nonnegative=n=>t.check(Yl(0,n)),t.negative=n=>t.check(Ob(0,n)),t.nonpositive=n=>t.check(Gl(0,n)),t.multipleOf=(n,i)=>t.check(Db(n,i)),t.step=(n,i)=>t.check(Db(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Ra(t){return HV(sg,t)}const z6=z("ZodNumberFormat",(t,e)=>{Z5.init(t,e),sg.init(t,e)});function Lb(t){return qV(z6,t)}const F6=z("ZodBoolean",(t,e)=>{X5.init(t,e),dt.init(t,e)});function YT(t){return KV(F6,t)}const U6=z("ZodUnknown",(t,e)=>{Q5.init(t,e),dt.init(t,e)});function $b(){return GV(U6)}const B6=z("ZodNever",(t,e)=>{J5.init(t,e),dt.init(t,e)});function H6(t){return YV(B6,t)}const W6=z("ZodDate",(t,e)=>{eV.init(t,e),dt.init(t,e),t.min=(n,i)=>t.check(Yl(n,i)),t.max=(n,i)=>t.check(Gl(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function xn(t){return ZV(W6,t)}const q6=z("ZodArray",(t,e)=>{tV.init(t,e),dt.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Su(r,n)),t.nonempty=r=>t.check(Su(1,r)),t.max=(r,n)=>t.check(WT(r,n)),t.length=(r,n)=>t.check(qT(r,n)),t.unwrap=()=>t.element});function _e(t,e){return o6(q6,t,e)}const K6=z("ZodObject",(t,e)=>{rV.init(t,e),dt.init(t,e),Ge(t,"shape",()=>e.shape),t.keyof=()=>De(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:$b()}),t.loose=()=>t.clone({...t._zod.def,catchall:$b()}),t.strict=()=>t.clone({...t._zod.def,catchall:H6()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>P$(t,r),t.merge=r=>C$(t,r),t.pick=r=>S$(t,r),t.omit=r=>I$(t,r),t.partial=(...r)=>k$(ZT,t,r[0]),t.required=(...r)=>N$(XT,t,r[0])});function ke(t,e){const r={type:"object",get shape(){return rg(this,"shape",{...t}),this.shape},...ne(e)};return new K6(r)}const G6=z("ZodUnion",(t,e)=>{nV.init(t,e),dt.init(t,e),t.options=e.options});function Y6(t,e){return new G6({type:"union",options:t,...ne(e)})}const Z6=z("ZodIntersection",(t,e)=>{iV.init(t,e),dt.init(t,e)});function X6(t,e){return new Z6({type:"intersection",left:t,right:e})}const hm=z("ZodEnum",(t,e)=>{aV.init(t,e),dt.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const s of n)if(r.has(s))a[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new hm({...e,checks:[],...ne(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const s of n)if(r.has(s))delete a[s];else throw new Error(`Key ${s} not found in enum`);return new hm({...e,checks:[],...ne(i),entries:a})}});function De(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new hm({type:"enum",entries:r,...ne(e)})}const Q6=z("ZodTransform",(t,e)=>{sV.init(t,e),dt.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=a=>{if(typeof a=="string")r.issues.push(ac(a,r.value,e));else{const s=a;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!0),r.issues.push(ac(s))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function J6(t){return new Q6({type:"transform",transform:t})}const ZT=z("ZodOptional",(t,e)=>{oV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Vb(t){return new ZT({type:"optional",innerType:t})}const e3=z("ZodNullable",(t,e)=>{cV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function zb(t){return new e3({type:"nullable",innerType:t})}const t3=z("ZodDefault",(t,e)=>{lV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function r3(t,e){return new t3({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const n3=z("ZodPrefault",(t,e)=>{uV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function i3(t,e){return new n3({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const XT=z("ZodNonOptional",(t,e)=>{dV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType});function a3(t,e){return new XT({type:"nonoptional",innerType:t,...ne(e)})}const s3=z("ZodCatch",(t,e)=>{hV.init(t,e),dt.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function o3(t,e){return new s3({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const c3=z("ZodPipe",(t,e)=>{fV.init(t,e),dt.init(t,e),t.in=e.in,t.out=e.out});function Fb(t,e){return new c3({type:"pipe",in:t,out:e})}const l3=z("ZodReadonly",(t,e)=>{mV.init(t,e),dt.init(t,e)});function u3(t){return new l3({type:"readonly",innerType:t})}const d3=z("ZodCustom",(t,e)=>{pV.init(t,e),dt.init(t,e)});function h3(t){const e=new hr({check:"custom"});return e._zod.check=t,e}function f3(t,e={}){return c6(d3,t,e)}function m3(t){const e=h3(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(ac(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(ac(i))}},t(r.value,r)));return e}function dn(t){return WV(sg,t)}const QT=ke({type:De(["overwatering","underwatering","pest","disease","nutrient","light","other"]),severity:De(["low","medium","high"]),description:K().min(1),treatment:K().min(1)}),JT=ke({overallHealth:De(["excellent","good","fair","poor"]),issues:_e(QT),recommendations:_e(K()),moistureLevel:dn().min(0).max(100),growthStage:De(["seedling","juvenile","mature","flowering","dormant"]),confidence:dn().min(0).max(100)}),eA=ke({wateringFrequency:dn().positive(),sunlightRequirement:De(["low","medium","high"]),humidityPreference:De(["low","medium","high"]),temperatureRange:ke({min:dn(),max:dn()}),fertilizingFrequency:dn().positive(),soilType:K().min(1),specialCare:_e(K()).optional()}),tA=ke({traits:_e(K()).min(1),communicationStyle:De(["cheerful","wise","dramatic","calm","playful"]),catchphrases:_e(K()),moodFactors:ke({health:dn().min(0).max(1),care:dn().min(0).max(1),attention:dn().min(0).max(1)})}),p3=ke({species:K(),commonName:K(),variety:K().nullable().optional(),confidence:dn().min(0).max(100),generalDescription:K().min(20),funFacts:_e(K()),plantEnvironment:De(["interior","exterior","ambos"]),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]),health:JT,careProfile:eA,personality:tA}),rA=ke({type:De(["info","warning","tip","alert"]),title:K(),message:K()}),g3=_e(rA),y3=Object.freeze(Object.defineProperty({__proto__:null,AIAnalysisResponseSchema:p3,CareProfileSchema:eA,HealthAnalysisSchema:JT,HealthIssueSchema:QT,InsightResponseSchema:g3,InsightSchema:rA,PlantPersonalitySchema:tA},Symbol.toStringTag,{value:"Module"})),{HealthAnalysisSchema:v3,CareProfileSchema:b3,PlantPersonalitySchema:x3,InsightResponseSchema:w3}=y3,_3=ke({id:K().min(1,"Image ID is required"),url:K().url("Must be a valid URL"),timestamp:xn(),healthAnalysis:v3.optional(),isProfileImage:YT()}),E3=ke({id:K().min(1,"Message ID is required"),sender:De(["user","plant","system"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]).optional(),context:ke({insights:_e(ke({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(ke({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),T3=ke({id:K().min(1,"Notification ID is required"),type:De(["watering","fertilizing","health_check","general"]),title:K().min(1,"Title is required"),message:K().min(1,"Message is required"),priority:De(["low","medium","high"]),scheduledFor:xn(),completed:YT()}),A3=ke({id:K().uuid(),name:K(),species:K(),variety:K().optional(),nickname:K().optional(),description:K().optional(),funFacts:_e(K()).optional(),location:K(),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),dateAdded:xn(),lastWatered:xn().optional(),lastFertilized:xn().optional(),images:_e(_3),healthScore:Ra().min(0).max(100),careProfile:b3,personality:x3,chatHistory:_e(E3),notifications:_e(T3)}),S3=ke({id:K().min(1,"Plant ID is required"),name:K().min(1,"Plant name is required"),nickname:K().optional(),species:K().min(1,"Species is required"),location:K().min(1,"Location is required"),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),healthScore:Ra().min(0).max(100),profileImageUrl:K().url().optional(),lastWatered:xn().optional(),wateringFrequency:Ra().positive().optional()});ke({content:K(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]),mood:K().optional()});ke({changes:_e(K()),healthImprovement:Ra(),recommendations:_e(K()),newHealthScore:Ra().min(0).max(100)});A3.omit({id:!0,dateAdded:!0,chatHistory:!0,notifications:!0}).partial({images:!0,healthScore:!0,careProfile:!0,personality:!0});ke({fullName:K().min(3,"El nombre debe tener al menos 3 caracteres"),email:K().email("Email inválido"),password:K().min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:K().min(6)}).refine(t=>t.password===t.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});ke({email:K().email(),password:K().min(1,"Password is required")});const I3=ke({id:K().min(1,"Message ID is required"),sender:De(["user","ai"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),context:ke({plantsAnalyzed:_e(K()).optional(),queryType:De(["general","health_analysis","care_comparison","disease_prevention","growth_tracking"]).optional(),insights:_e(ke({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(ke({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),P3=ke({totalPlants:Ra(),plantsData:_e(S3),averageHealthScore:Ra(),commonIssues:_e(K()),careScheduleSummary:ke({needsWatering:_e(K()),needsFertilizing:_e(K()),healthConcerns:_e(K())}),environmentalFactors:ke({locations:_e(K()),lightConditions:_e(K()),humidityNeeds:_e(K())})});ke({id:K().uuid(),userId:K().uuid(),messages:_e(I3),createdAt:xn(),updatedAt:xn(),context:P3.optional()});ke({content:K().min(1),insights:_e(ke({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(ke({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()});const C3=async t=>{try{const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e?.access_token)throw console.error("User session not available:",r),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:n,error:i}=await Et.functions.invoke("generate-plant-insights",{body:{plant:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i)throw new Error(`Failed to generate insights: ${i.message}`);return w3.parse(n)}catch(e){throw console.error("[insightService] Error generating insights:",e),e instanceof y6?new Error(`Invalid data structure for insights: ${e.message}`):e}},nA=async t=>{IT(t);const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e)throw new Error("User must be authenticated to analyze images");const{data:n,error:i}=await Et.functions.invoke("analyze-image",{body:{imageDataUrl:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i){if(console.error("Error invoking analyze-image function:",i),i.message?.includes("unsupported image"))throw new Error("La imagen no es válida. Por favor, asegúrate de que sea una foto clara de una planta.");if(i.message?.includes("OpenAI API key"))throw new Error("Servicio de análisis temporalmente no disponible. Intenta de nuevo más tarde.");const a=i.context?.msg?JSON.parse(i.context.msg).error:i.message;throw new Error(`Failed to analyze image: ${a}`)}if(n&&n.error)throw console.error("Image analysis failed with a specific error:",n.error),new Error(n.error);return n},Ub=async(t,e)=>{const r="cálido, simpático, motivador, y con un toque de humor ligero",n=(t.images||[]).map(m=>({url:m.url,timestamp:m.timestamp instanceof Date?m.timestamp.toISOString():m.timestamp,...m.healthAnalysis?{healthAnalysis:m.healthAnalysis}:{}})).sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());let i=[];try{i=await C3(t)}catch(m){console.warn("[generatePlantResponse] No se pudieron generar insights para la planta:",m),i=[]}const a={...t,images:n},{data:{session:s},error:o}=await Et.auth.getSession();if(o||!s?.access_token)throw console.error("User session not available:",o),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:c,error:l}=await Et.functions.invoke("generate-plant-response",{body:{plant:a,userMessage:e,tonePersona:r,insights:i},headers:{Authorization:`Bearer ${s.access_token}`}});if(l)throw console.error("Error calling generate-plant-response function:",l),new Error("Failed to generate plant response: "+l.message);const d=(c?.content||"").toLowerCase();return(!c?.content||d.includes("no sé")||d.includes("no tengo información")||d.includes("no puedo ayudarte")||d.length<20)&&kd.warning("Respuesta genérica","La respuesta de la planta fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{...c,insights:c?.insights||i||[],suggestedActions:c?.suggestedActions||[]}},k3=async(t,e)=>{const{data:{session:r},error:n}=await Et.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await Et.functions.invoke("complete-plant-info",{body:{species:t,commonName:e},headers:{Authorization:`Bearer ${r.access_token}`}});if(a)throw console.error("💥 [API] Error en complete-plant-info function:",a),new Error("Failed to complete plant info: "+a.message);const s=["interior","exterior","ambos"],o=["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"];return{plantEnvironment:s.includes(i.plantEnvironment)?i.plantEnvironment:"interior",lightRequirements:o.includes(i.lightRequirements)?i.lightRequirements:"luz_indirecta",description:i.description||void 0,funFacts:Array.isArray(i.funFacts)?i.funFacts:void 0}},ho=(t,e,r,n)=>({id:t.id,name:t.name,species:t.species,variety:t.variety||void 0,nickname:t.nickname||void 0,description:t.description||void 0,funFacts:t.fun_facts||[],location:t.location,plantEnvironment:t.plant_environment,lightRequirements:t.light_requirements,dateAdded:new Date(t.date_added),lastWatered:t.last_watered?new Date(t.last_watered):void 0,lastFertilized:t.last_fertilized?new Date(t.last_fertilized):void 0,images:e,healthScore:t.health_score||85,careProfile:t.care_profile,personality:t.personality,chatHistory:r,notifications:n});class og{constructor(e=Et){Nr(this,"supabase");this.supabase=e}async getUserPlantSummaries(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          care_profile
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;let i=new Map;if(r.length>0){const s=r.map(l=>l.id),{data:o,error:c}=await this.supabase.from("plant_images").select("plant_id, url").in("plant_id",s).eq("is_profile_image",!0);c?console.warn("[plantService] Error fetching profile images:",c):i=new Map((o||[]).map(l=>[l.plant_id,l.url]))}return r.map(s=>({id:s.id,name:s.name,nickname:s.nickname||void 0,species:s.species,location:s.location,plantEnvironment:s.plant_environment,lightRequirements:s.light_requirements,healthScore:s.health_score||85,profileImageUrl:i.get(s.id),lastWatered:s.last_watered?new Date(s.last_watered):void 0,wateringFrequency:s.care_profile?.wateringFrequency}))}catch(r){throw console.error("Error fetching plant summaries:",r),r}}async getUserPlants(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return r.map(a=>{const s=(a.plant_images||[]).map(l=>({id:l.id,url:l.url,timestamp:new Date(l.created_at),healthAnalysis:l.health_analysis,isProfileImage:l.is_profile_image||!1})),o=(a.chat_messages||[]).map(l=>({id:l.id,sender:l.sender,content:l.content,timestamp:new Date(l.created_at),emotion:l.emotion})),c=(a.plant_notifications||[]).map(l=>({id:l.id,type:l.type,title:l.title,message:l.message,priority:l.priority||"medium",scheduledFor:new Date(l.scheduled_for),completed:l.completed||!1}));return ho(a,s,o,c)})}catch(r){throw console.error("Error fetching plants:",r),r}}async getPlantById(e,r){try{const{data:n,error:i}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("id",e).eq("user_id",r).single();if(i){if(i.code==="PGRST116")return null;throw i}if(!n)return null;const a=(n.plant_images||[]).map(c=>({id:c.id,url:c.url,timestamp:new Date(c.created_at),healthAnalysis:c.health_analysis,isProfileImage:c.is_profile_image||!1})),s=(n.chat_messages||[]).map(c=>({id:c.id,sender:c.sender,content:c.content,timestamp:new Date(c.created_at),emotion:c.emotion})),o=(n.plant_notifications||[]).map(c=>({id:c.id,type:c.type,title:c.title,message:c.message,priority:c.priority||"medium",scheduledFor:new Date(c.scheduled_for),completed:c.completed||!1}));return ho(n,a,s,o)}catch(n){throw console.error("Error fetching plant by ID:",n),n}}async addPlantFromAnalysis(e,r,n){try{console.log("[PlantService] Iniciando análisis IA...");const i=await nA(r);console.log("[PlantService] Resultado IA:",i);const a={name:i.commonName,species:i.species,description:i.generalDescription,funFacts:i.funFacts,variety:i.variety??void 0,nickname:i.commonName,location:n,plantEnvironment:i.plantEnvironment,lightRequirements:i.lightRequirements,dateAdded:new Date,healthScore:i.health.confidence,careProfile:i.careProfile,personality:i.personality};console.log("[PlantService] Payload a createPlant:",a);const s=await this.createPlant(a,e);return console.log("[PlantService] Planta creada:",s),(async()=>{let o=!1,c=!1;try{console.log(`[PlantService] Starting image upload for plant ${s.id}`);const l=await PT(r,"plant-images",`${e}/${s.id}`);console.log("[PlantService] Imagen subida:",l),await this.addPlantImage(s.id,{url:l,timestamp:new Date,isProfileImage:!0,healthAnalysis:i.health},e),o=!0,console.log(`[PlantService] Image upload completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Image upload failed for plant ${s.id}:`,l),alert("Error subiendo imagen: "+(l instanceof Error?l.message:JSON.stringify(l)))}try{console.log(`[PlantService] Starting chat initialization for plant ${s.id}`);const l=await Ub(s,"¡Hola! Acabo de llegar. ¿Cómo te llamas?");console.log("[PlantService] Respuesta IA chat:",l),await this.addChatMessage(s.id,{sender:"plant",content:l.content,timestamp:new Date,emotion:l.emotion},e),c=!0,console.log(`[PlantService] Chat initialization completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Chat initialization failed for plant ${s.id}:`,l),alert("Error inicializando chat: "+(l instanceof Error?l.message:JSON.stringify(l)))}o&&c?console.log(`[PlantService] All background tasks for plant ${s.id} completed successfully.`):(o||c)&&console.log(`[PlantService] Background tasks for plant ${s.id} partially completed.`)})().catch(o=>{console.error(`[PlantService] Error during background tasks for plant ${s.id}:`,o),alert("Error en tareas de fondo: "+(o instanceof Error?o.message:JSON.stringify(o)))}),s}catch(i){throw console.error("Error adding plant from analysis:",i),alert("Error creando planta: "+(i instanceof Error?i.message:JSON.stringify(i))),i}}async createPlant(e,r){try{const n={user_id:r,name:e.name,species:e.species,variety:e.variety||null,nickname:e.nickname||null,description:e.description||null,fun_facts:e.funFacts||null,location:e.location,plant_environment:e.plantEnvironment||null,light_requirements:e.lightRequirements||null,date_added:e.dateAdded.toISOString(),last_watered:null,last_fertilized:null,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,updated_at:null};console.log("[PlantService] Payload a Supabase:",n);const{data:i,error:a}=await this.supabase.from("plants").insert(n).select("*").single();if(console.log("[PlantService] Respuesta Supabase:",i,a),a)throw console.error("Supabase error:",{message:a.message,details:a.details,code:a.code}),alert("Error Supabase: "+a.message),new Error(`Supabase error creating plant: ${a.message}`);if(!i)throw alert("No se pudo crear la planta en la base de datos, no se devolvieron datos."),new Error("Failed to create plant in the database, no data returned.");return ho(i,[],[],[])}catch(n){throw console.error("Error creating plant:",n),alert("Error creando planta: "+(n instanceof Error?n.message:JSON.stringify(n))),n}}async updatePlantInfo(e,r,n){try{const i={};n.plantEnvironment!==void 0&&(i.plant_environment=n.plantEnvironment),n.lightRequirements!==void 0&&(i.light_requirements=n.lightRequirements),n.description!==void 0&&(i.description=n.description),n.funFacts!==void 0&&(i.fun_facts=n.funFacts);const{data:a,error:s}=await this.supabase.from("plants").update(i).eq("id",e).eq("user_id",r).select("*").single();if(s)throw console.error("Supabase error updating plant:",s),new Error(`Error updating plant: ${s.message}`);if(!a)throw new Error("Plant not found or not updated.");return ho(a,[],[],[])}catch(i){throw console.error("Error updating plant info:",i),i}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await this.supabase.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await this.supabase.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}async updatePlant(e,r){try{const n={name:e.name,species:e.species,variety:e.variety,nickname:e.nickname,description:e.description,fun_facts:e.funFacts,location:e.location,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,last_watered:e.lastWatered?.toISOString(),last_fertilized:e.lastFertilized?.toISOString()},{data:i,error:a}=await this.supabase.from("plants").update(n).eq("id",e.id).eq("user_id",r).select().single();if(a)throw a;return ho(i,e.images,e.chatHistory,e.notifications)}catch(n){throw console.error("Error updating plant:",n),n}}async deletePlant(e,r){try{const{error:n}=await this.supabase.from("plants").delete().eq("id",e).eq("user_id",r);if(n)throw n}catch(n){throw console.error("Error deleting plant:",n),n}}async sendChatMessageAndGetResponse(e,r,n){const i=await this.addChatMessage(e.id,r,n),a=await Ub(e,r.content),s={};a.insights&&(s.insights=a.insights),a.suggestedActions&&(s.suggestedActions=a.suggestedActions);const o={sender:"plant",content:a.content,emotion:a.emotion,timestamp:new Date,...Object.keys(s).length>0?{context:s}:{}},c=await this.addChatMessage(e.id,o,n);return[i,c]}async addChatMessage(e,r,n){try{const i={plant_id:e,user_id:n,sender:r.sender,content:r.content,emotion:r.emotion||null};r.context&&(i.context=r.context);const{data:a,error:s}=await this.supabase.from("chat_messages").insert(i).select().single();if(s)throw console.error("❌ Supabase error:",s),s;return{id:a.id,sender:a.sender,content:a.content,timestamp:new Date(a.created_at),emotion:a.emotion,context:a.context||void 0}}catch(i){throw console.error("Error adding chat message:",i),i}}async addPlantImage(e,r,n){try{const i=r.url;let a="";try{const l=new URL(i).pathname.split("/"),d=l.findIndex(h=>h==="object");d!==-1&&d+2<l.length&&(a=l.slice(d+2).join("/"))}catch{console.warn("Could not extract storage path from URL:",i),a=`${n}/${e}/${Date.now()}.jpg`}const{data:s,error:o}=await this.supabase.from("plant_images").insert({plant_id:e,user_id:n,url:i,storage_path:a,is_profile_image:r.isProfileImage,health_analysis:r.healthAnalysis}).select().single();if(o)throw o;if(!s.url)throw new Error("Image URL not returned from database.");return{id:s.id,url:s.url,timestamp:new Date(s.created_at),isProfileImage:s.is_profile_image||!1,healthAnalysis:s.health_analysis}}catch(i){throw console.error("Error adding plant image:",i),new Error(`Image upload failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async setProfileImage(e,r,n){try{await this.supabase.from("plant_images").update({is_profile_image:!1}).eq("plant_id",e).eq("user_id",n);const{error:i}=await this.supabase.from("plant_images").update({is_profile_image:!0}).eq("id",r).eq("user_id",n);if(i)throw i}catch(i){throw console.error("Error setting profile image:",i),i}}async deleteImage(e,r){try{const{data:n,error:i}=await this.supabase.from("plant_images").select("storage_path").eq("id",e).eq("user_id",r).single();if(i)throw i;n?.storage_path&&await this.supabase.storage.from("plant-images").remove([n.storage_path]);const{error:a}=await this.supabase.from("plant_images").delete().eq("id",e).eq("user_id",r);if(a)throw a}catch(n){throw console.error("Error deleting image:",n),n}}}const hs=new og(Et);class N3{constructor(){Nr(this,"cache",new Map);Nr(this,"CACHE_DURATIONS",{GARDEN_CONTEXT:5*60*1e3,GARDEN_SUMMARY:3*60*1e3,SUGGESTED_QUESTIONS:10*60*1e3,PLANT_DATA:2*60*1e3})}getCacheKey(e,r){return`${e}:${r}`}isValidCache(e){return e?Date.now()<e.expiresAt:!1}getCachedData(e){const r=this.cache.get(e);return this.isValidCache(r)?r.data:(r&&this.cache.delete(e),null)}setCachedData(e,r,n){const i={data:r,timestamp:Date.now(),expiresAt:Date.now()+n};this.cache.set(e,i),console.log(`[GardenCache] Cache SET for key: ${e}, expires in ${n/1e3}s`)}getGardenContext(e){const r=this.getCacheKey(e,"garden_context");return this.getCachedData(r)}setGardenContext(e,r){const n=this.getCacheKey(e,"garden_context");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_CONTEXT)}getGardenSummary(e){const r=this.getCacheKey(e,"garden_summary");return this.getCachedData(r)}setGardenSummary(e,r){const n=this.getCacheKey(e,"garden_summary");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_SUMMARY)}getSuggestedQuestions(e){const r=this.getCacheKey(e,"suggested_questions");return this.getCachedData(r)}setSuggestedQuestions(e,r){const n=this.getCacheKey(e,"suggested_questions");this.setCachedData(n,r,this.CACHE_DURATIONS.SUGGESTED_QUESTIONS)}getPlantData(e){const r=this.getCacheKey(e,"plant_data");return this.getCachedData(r)}setPlantData(e,r){const n=this.getCacheKey(e,"plant_data");this.setCachedData(n,r,this.CACHE_DURATIONS.PLANT_DATA)}invalidateCache(e,r){r?r.forEach(n=>{const i=this.getCacheKey(e,n);this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)}):Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>{this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)})}invalidateOnPlantChange(e){console.log("[GardenCache] Plant data changed, invalidating related caches"),this.invalidateCache(e,["garden_context","garden_summary","plant_data","suggested_questions"])}getCacheStats(e){const r=Array.from(this.cache.keys()),n=r.filter(s=>s.startsWith(`${e}:`));let i=0,a=0;return n.forEach(s=>{const o=this.cache.get(s);o&&(this.isValidCache(o)?i++:a++)}),{totalEntries:r.length,userEntries:n.length,validEntries:i,expiredEntries:a}}cleanup(){const e=Date.now(),r=[];this.cache.forEach((n,i)=>{e>=n.expiresAt&&r.push(i)}),r.forEach(n=>{this.cache.delete(n)}),r.length>0&&console.log(`[GardenCache] Cleaned up ${r.length} expired entries`)}clearAll(){this.cache.size,this.cache.clear()}}const Fo=new N3;typeof window<"u"&&setInterval(()=>{Fo.cleanup()},5*60*1e3);const fo=new og,mo={isLoading:!1,error:null},qn=ap((t,e)=>({plants:[],operationStates:{add:{...mo},update:{...mo},delete:{...mo},addImage:{...mo},chat:{...mo}},selectedPlantId:null,getOperationState:r=>e().operationStates[r],getPlantById:r=>e().plants.find(n=>n.id===r),setPlant:r=>{t(Se(n=>{const i=n.plants.findIndex(a=>a.id===r.id);i!==-1?n.plants[i]=r:n.plants.push(r)}))},addPlant:async(r,n,i)=>{t(Se(a=>{a.operationStates.add.isLoading=!0,a.operationStates.add.error=null,a.operationStates.add.lastOperation="addPlant"}));try{const a=await fo.addPlantFromAnalysis(i,r,n);return t(Se(s=>{s.plants.unshift(a),s.operationStates.add.isLoading=!1})),Fo.invalidateOnPlantChange(i),a}catch(a){const s=a instanceof Error?a.message:"Failed to add plant";throw t(Se(o=>{o.operationStates.add.isLoading=!1,o.operationStates.add.error=s})),a}},updatePlant:async(r,n)=>{t(Se(i=>{i.operationStates.update.isLoading=!0,i.operationStates.update.error=null,i.operationStates.update.lastOperation=`updatePlant-${r.id}`}));try{const i=await fo.updatePlant(r,n);t(Se(a=>{const s=a.plants.findIndex(o=>o.id===i.id);s!==-1&&(a.plants[s]=i),a.operationStates.update.isLoading=!1})),Fo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to update plant";throw t(Se(s=>{s.operationStates.update.isLoading=!1,s.operationStates.update.error=a})),i}},deletePlant:async(r,n)=>{t(Se(i=>{i.operationStates.delete.isLoading=!0,i.operationStates.delete.error=null,i.operationStates.delete.lastOperation=`deletePlant-${r}`}));try{await fo.deletePlant(r,n),t(Se(i=>{i.plants=i.plants.filter(a=>a.id!==r),i.operationStates.delete.isLoading=!1})),Fo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to delete plant";throw t(Se(s=>{s.operationStates.delete.isLoading=!1,s.operationStates.delete.error=a})),i}},addChatMessage:async(r,n,i)=>{t(Se(o=>{o.operationStates.chat.isLoading=!0,o.operationStates.chat.error=null,o.operationStates.chat.lastOperation=`addChatMessage-${r}`}));const a=e().getPlantById(r);if(!a){t(Se(o=>{o.operationStates.chat.isLoading=!1,o.operationStates.chat.error="Plant not found to add message"}));return}const s={id:`temp-user-${Date.now()}`,sender:"user",content:n,timestamp:new Date};t(Se(o=>{o.plants.find(c=>c.id===r)?.chatHistory.push(s)}));try{const[o,c]=await fo.sendChatMessageAndGetResponse(a,{sender:"user",content:n,timestamp:s.timestamp},i);t(Se(l=>{const d=l.plants.find(h=>h.id===r);d&&(d.chatHistory=[...d.chatHistory.filter(h=>h.id!==s.id),o,c]),l.operationStates.chat.isLoading=!1}))}catch(o){const c=o instanceof Error?o.message:"Failed to send message";t(Se(l=>{l.operationStates.chat.isLoading=!1,l.operationStates.chat.error=c}))}},addPlantImage:async(r,n,i)=>{t(Se(a=>{a.operationStates.addImage.isLoading=!0,a.operationStates.addImage.error=null,a.operationStates.addImage.lastOperation=`addImage-${r}`}));try{const a=await fo.addPlantImage(r,{url:n,timestamp:new Date,isProfileImage:!1},i);t(Se(s=>{const o=s.plants.find(c=>c.id===r);o&&o.images.push(a),s.operationStates.addImage.isLoading=!1}))}catch(a){const s=a instanceof Error?a.message:"Failed to add image";throw t(Se(o=>{o.operationStates.addImage.isLoading=!1,o.operationStates.addImage.error=s})),a}},selectPlant:r=>t({selectedPlantId:r}),clearError:r=>{t(Se(r?n=>{n.operationStates[r].error=null}:n=>{Object.keys(n.operationStates).forEach(i=>{n.operationStates[i].error=null})}))},clearPlants:()=>t({plants:[],selectedPlantId:null})}));class j3{async updatePlantHealthDiagnosis(e){if(!e.images||e.images.length===0)throw new Error("Esta planta no tiene imágenes para analizar. Toma una foto primero.");const r=[...e.images].sort((a,s)=>s.timestamp.getTime()-a.timestamp.getTime())[0],{data:{session:n},error:i}=await Et.auth.getSession();if(i||!n?.access_token)throw console.error("💥 [Health] User session not available:",i),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");try{const a=await fetch(r.url,{method:"HEAD"});if(!a.ok)throw new Error(`Imagen no accesible: ${a.status}`)}catch(a){throw console.error("💥 [Health] Error verificando acceso a imagen:",a),new Error("La imagen de la planta no está disponible. Intenta tomar una nueva foto.")}console.log("🔬 [Health] Llamando a update-health-diagnosis...");try{const{data:a,error:s}=await Et.functions.invoke("update-health-diagnosis",{body:{imageUrl:r.url,plantName:e.name,species:e.species},headers:{Authorization:`Bearer ${n.access_token}`}});if(s)throw console.error("💥 [Health] Error en función update-health-diagnosis:",s),new Error(`Error en análisis: ${s.message}`);if(!a||!a.overallHealth)throw console.error("💥 [Health] Datos incompletos del análisis:",a),new Error("El análisis no devolvió información de salud válida.");console.log("🎯 [Health] Análisis de salud completado exitosamente:",{overallHealth:a.overallHealth,confidence:a.confidence,issuesCount:a.issues?.length||0,recommendationsCount:a.recommendations?.length||0});const c={excellent:95,good:80,fair:60,poor:30}[a.overallHealth]||a.confidence||60;return console.log("📊 [Health] Nuevo score de salud calculado:",{overallHealth:a.overallHealth,numericScore:c,confidence:a.confidence}),{healthScore:c,healthAnalysis:a,updatedImage:{...r,healthAnalysis:a}}}catch(a){console.error("💥 [Health] Error en diagnóstico primario:",a),console.log("🔄 [Health] Intentando análisis de fallback...");try{if(r.healthAnalysis&&r.healthAnalysis.overallHealth){console.log("🎯 [Health] Usando análisis existente de la imagen");const s=r.healthAnalysis;return{healthScore:{excellent:95,good:80,fair:60,poor:30}[s.overallHealth]||60,healthAnalysis:s,updatedImage:r}}}catch(s){console.error("💥 [Health] Error en fallback:",s)}throw new Error("No se pudo actualizar el diagnóstico de salud. Verifica tu conexión a internet e intenta nuevamente.")}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await Et.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await Et.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}}const Bb=new j3,Rd=()=>{const t=sd(),{addPlant:e,updatePlant:r,deletePlant:n}=qn.getState(),a=Nn(h=>h.user)?.id,{addToast:s}=Us(),o=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");const{imageDataUrl:m,location:p}=h;return e(m,p,a)},onSuccess:h=>{t.invalidateQueries({queryKey:["plants",a]})},onError:h=>{console.error("Failed to create plant:",h)}}),c=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return r(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.map(p=>p.id===h.id?h:p)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:h=>{t.invalidateQueries({queryKey:["plants",a]})}}),l=Ei({mutationFn:async({plant:h,userId:m})=>{console.log("🩺 [Mutation] Iniciando actualización de diagnóstico...");const p=await Bb.updatePlantHealthDiagnosis(h);return await Bb.updatePlantHealthScore(h.id,m,p.healthScore,p.healthAnalysis,p.updatedImage.id),console.log("✅ [Mutation] Diagnóstico actualizado exitosamente"),p},onSuccess:(h,{plant:m})=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",m.id]}),s({type:"success",title:"Diagnóstico Actualizado",message:`Nuevo estado de salud: ${h.healthScore}%`})},onError:h=>{console.error("💥 [Mutation] Error actualizando diagnóstico:",h),s({type:"error",title:"Error en Diagnóstico",message:h.message})}}),d=Ei({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return n(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.filter(p=>p.id!==h)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:()=>{t.invalidateQueries({queryKey:["plants",a]})}});return{createPlant:o.mutate,isCreatingPlant:o.isPending,updatePlant:c.mutate,isUpdatingPlant:c.isPending,updatePlantHealthMutation:l.mutate,isUpdatingPlantHealth:l.isPending,deletePlant:d.mutate,isDeletingPlant:d.isPending}},O3=()=>{const[t,e]=w.useState(!1),r=ar(),{createPlant:n,isCreatingPlant:i}=Rd();w.useEffect(()=>{const o=c=>{c.key==="Escape"&&e(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]);const a=[{id:"camera",icon:En,label:"Tomar Foto",color:"bg-blue-500",action:()=>{e(!1),r(lt.toCamera())}},{id:"gallery",icon:np,label:"Galería",color:"bg-purple-500",action:()=>s()}],s=w.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async c=>{const l=c.target.files?.[0];if(l){const d=new FileReader;d.onload=async h=>{const m=h.target?.result;if(m){e(!1);const p=new Promise((v,b)=>{n({imageDataUrl:m,location:"Interior"},{onSuccess:g=>{g?.id&&r(lt.toPlantDetail(g.id)),v(g)},onError:g=>{console.error("Failed to create plant:",g),b(g)}})});yT.promise(p,{loading:"Analizando imagen... La IA está trabajando.",success:v=>`¡Planta "${v.name}" creada con éxito!`,error:v=>`Error: ${v.message}`})}},d.readAsDataURL(l)}},o.click()},[n,r]);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative flex items-center",children:[u.jsx(L.button,{onClick:()=>e(!t),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},disabled:i,"aria-label":t?"Cerrar menú":"Agregar planta","aria-expanded":t,children:u.jsx(Pe,{mode:"wait",children:i?u.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:u.jsx(ga,{className:"w-6 h-6 animate-spin"})},"loading"):u.jsx(L.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:t?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:u.jsx(rp,{className:"w-6 h-6"})},"plus")})}),t&&u.jsx(L.span,{initial:{opacity:0,x:10},animate:{opacity:1,x:16},exit:{opacity:0,x:10},transition:{duration:.2},className:"ml-3 px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-xs font-medium shadow-md whitespace-nowrap z-50",children:"Agregar planta"})]}),u.jsx(Pe,{children:t&&u.jsx(L.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:a.map((o,c)=>u.jsxs(L.button,{onClick:o.action,className:`w-12 h-12 ${o.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:c*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(a.length-c)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":o.label,children:[u.jsx(o.icon,{className:"w-5 h-5"}),u.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:u.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[o.label,u.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},o.id))})}),u.jsx(Pe,{children:t&&u.jsx(L.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)})})]})},R3=[{icon:Ql,path:wt.dashboard,label:"Inicio",description:"Tu jardín personal"},{icon:Ho,path:wt.gardenChat,label:"Chat IA",description:"Asistente de plantas"},{icon:vk,path:wt.settings,label:"Ajustes",description:"Configuración"}],D3=()=>{const t=T_(),e=t.pathname.startsWith("/plant/");return u.jsxs(u.Fragment,{children:[u.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background/95 backdrop-blur-xl border-t border-border/50 shadow-lg pb-safe-bottom","data-tour":"bottom-navigation",children:u.jsx("div",{className:"flex justify-around items-center h-16 max-w-lg mx-auto px-safe",children:R3.map(r=>{const n=d$(t.pathname,r.path);return u.jsx(L.div,{className:"relative flex-1 h-full",whileTap:{scale:.95},transition:{duration:.1},children:u.jsxs(pk,{to:r.path,className:Oe("touch-target relative flex flex-col items-center justify-center w-full h-full rounded-xl transition-all duration-200 group","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n?"text-primary":"text-muted-foreground hover:text-foreground active:text-primary"),"aria-label":`${r.label} - ${r.description}`,...n?{"aria-current":"page"}:{},...r.path===wt.gardenChat?{"data-tour":"chat-tab"}:{},children:[u.jsx(Pe,{children:n&&u.jsx(L.div,{layoutId:"nav-active-bg",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:500,damping:30,duration:.3},className:"absolute inset-2 bg-primary/10 rounded-lg"})}),u.jsx(L.div,{animate:{scale:n?1.1:1,y:n?-1:0},transition:{duration:.2,ease:"easeOut"},className:"relative z-10 mb-1",children:u.jsx(r.icon,{size:22,strokeWidth:n?2.5:2,className:Oe("transition-all duration-200",n?"drop-shadow-sm":"group-hover:scale-105")})}),u.jsx(L.span,{animate:{scale:n?1.05:1,fontWeight:n?600:500},transition:{duration:.2},className:"text-xs relative z-10 leading-none",children:r.label}),u.jsx(Pe,{children:n&&u.jsx(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1,duration:.2},className:"absolute bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 bg-primary rounded-full"})})]})},r.path)})})}),!e&&u.jsx(L.div,{className:"fixed bottom-20 right-4 z-40","data-tour":"add-plant-fab",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:400,damping:25,delay:.2},children:u.jsx(O3,{})})]})},M3=()=>{const[t,e]=w.useState(navigator.onLine);return w.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t},L3=()=>{const t=M3();return u.jsxs(Pe,{children:[!t&&u.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",children:u.jsx("div",{className:"bg-red-500 text-white px-4 py-2 text-center text-sm font-medium",children:u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(bk,{size:16}),u.jsx("span",{children:"Sin conexión - Modo offline"})]})})}),t&&u.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",onAnimationComplete:()=>{setTimeout(()=>{const e=document.querySelector("[data-online-indicator]");e&&e.remove()},2e3)},children:u.jsx("div",{className:"bg-green-500 text-white px-4 py-2 text-center text-sm font-medium","data-online-indicator":!0,children:u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(S_,{size:16}),u.jsx("span",{children:"Conexión restaurada"})]})})})]})},$3="1.0.0",V3="2025-08-09T18:39:35.810Z",z3="9 de agosto de 2025, 18:39",ua={name:"Plantitas",version:$3,buildDate:z3,buildTimestamp:V3,author:"Felipe Aurelio",repository:"https://github.com/felipeaurelio13/plantitas-app"},F3=()=>`${ua.name} v${ua.version} (${ua.buildDate})`,U3=({className:t="",showVersion:e=!0,showBuildInfo:r=!1})=>u.jsxs("footer",{className:`text-center py-4 text-sm text-muted-foreground ${t}`,children:[e&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"font-medium text-foreground",children:ua.name}),u.jsx("p",{className:"text-xs opacity-75",children:F3()})]}),r&&u.jsxs("div",{className:"mt-2 text-xs opacity-50",children:[u.jsxs("p",{children:["Build: ",ua.buildTimestamp]}),u.jsxs("p",{children:["Repo: ",ua.repository]})]}),u.jsx("div",{className:"mt-2 text-xs opacity-60",children:u.jsxs("p",{children:["© 2024 ",ua.author,". Todos los derechos reservados."]})})]});function B3(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var a;const s=c=>c===null?null:JSON.parse(c,void 0),o=(a=r.getItem(i))!=null?a:null;return o instanceof Promise?o.then(s):s(o)},setItem:(i,a)=>r.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>r.removeItem(i)}}const fm=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return fm(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return fm(n)(r)}}}},H3=(t,e)=>(r,n,i)=>{let a={storage:B3(()=>localStorage),partialize:b=>b,version:0,merge:(b,g)=>({...g,...b}),...e},s=!1;const o=new Set,c=new Set;let l=a.storage;if(!l)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},n,i);const d=()=>{const b=a.partialize({...n()});return l.setItem(a.name,{state:b,version:a.version})},h=i.setState;i.setState=(b,g)=>{h(b,g),d()};const m=t((...b)=>{r(...b),d()},n,i);i.getInitialState=()=>m;let p;const v=()=>{var b,g;if(!l)return;s=!1,o.forEach(T=>{var E;return T((E=n())!=null?E:m)});const _=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(b=n())!=null?b:m))||void 0;return fm(l.getItem.bind(l))(a.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==a.version){if(a.migrate){const E=a.migrate(T.state,T.version);return E instanceof Promise?E.then(j=>[!0,j]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var E;const[j,R]=T;if(p=a.merge(R,(E=n())!=null?E:m),r(p,!0),j)return d()}).then(()=>{_?.(p,void 0),p=n(),s=!0,c.forEach(T=>T(p))}).catch(T=>{_?.(void 0,T)})};return i.persist={setOptions:b=>{a={...a,...b},b.storage&&(l=b.storage)},clearStorage:()=>{l?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>s,onHydrate:b=>(o.add(b),()=>{o.delete(b)}),onFinishHydration:b=>(c.add(b),()=>{c.delete(b)})},a.skipHydration||v(),p||m},W3=H3,q3=ap()(W3((t,e)=>({isDark:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1,toggleTheme:()=>{const{isDark:r}=e(),n=!r;t({isDark:n}),nf(n),"vibrate"in navigator&&navigator.vibrate(50)},setTheme:r=>{t({isDark:r}),nf(r)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t&&nf(t.isDark)}})),nf=t=>{if(typeof window>"u")return;const e=t?"dark":"light";document.documentElement.setAttribute("data-theme",e),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},K3=()=>{const t=T_(),{isDark:e}=q3(),r=t.pathname==="/camera",n=()=>{const a={"/":"Página de inicio - Tu jardín personal","/camera":"Cámara - Agregar nueva planta","/chat":"Chat con IA - Asistente de plantas","/garden-chat":"Chat del jardín - Consultas generales","/settings":"Configuración - Ajustes de la aplicación"},s=t.pathname.includes("/plant/")?"/plant":t.pathname,o=a[s]||a[t.pathname]||"Página",c=document.createElement("div");c.setAttribute("aria-live","polite"),c.setAttribute("aria-atomic","true"),c.setAttribute("class","sr-only"),c.textContent=`Navegando a ${o}`,document.body.appendChild(c),setTimeout(()=>{document.body.removeChild(c)},1e3)};w.useEffect(()=>{n()},[t.pathname]),w.useEffect(()=>{const a=e?"dark":"light";document.documentElement.setAttribute("data-theme",a)},[e]);const i=()=>u.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only fixed top-4 left-4 z-50 bg-primary-600 text-white px-4 py-2 rounded-md font-medium transition-all duration-200 focus:shadow-lg",onFocus:a=>{a.currentTarget.scrollIntoView({behavior:"smooth"})},children:"Saltar al contenido principal"});return u.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[u.jsx(i,{}),u.jsx("h1",{className:"sr-only",children:"Plantitas - Aplicación de cuidado de plantas"}),u.jsx("main",{id:"main-content",role:"main","aria-label":"Contenido principal",className:"pb-28 min-h-screen focus:outline-none",tabIndex:-1,children:u.jsx(Pe,{mode:"wait",children:u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"w-full h-full",children:u.jsx(gk,{})},t.pathname)})}),u.jsx("aside",{role:"complementary","aria-label":"Información de estado",children:u.jsx(L3,{})}),!r&&u.jsx("nav",{role:"navigation","aria-label":"Navegación inferior",children:u.jsx(D3,{})}),!r&&u.jsx(U3,{className:"mt-auto pt-4 pb-20",showVersion:!0,showBuildInfo:!1}),u.jsx("style",{children:`
        @media (prefers-contrast: high) {
          :root {
            --color-background: #000000;
            --color-surface: #111111;
            --color-text-primary: #ffffff;
            --color-text-secondary: #ffffff;
            --color-border: #ffffff;
            --color-accent: #00ff00;
          }
        }

        @media (prefers-reduced-motion: reduce) {
          * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Screen reader only utility */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .sr-only.focus\\:not-sr-only:focus {
          position: static;
          width: auto;
          height: auto;
          padding: inherit;
          margin: inherit;
          overflow: visible;
          clip: auto;
          white-space: normal;
        }

        /* Enhanced focus indicators */
        *:focus-visible {
          outline: 3px solid var(--color-accent) !important;
          outline-offset: 2px !important;
          border-radius: 4px;
        }

        /* High contrast focus ring */
        @media (prefers-contrast: high) {
          *:focus-visible {
            outline: 4px solid #00ff00 !important;
            outline-offset: 3px !important;
          }
        }
      `})]})};class G3 extends w.Component{constructor(r){super(r);Nr(this,"handleReload",()=>{window.location.reload()});Nr(this,"handleGoHome",()=>{window.location.href="/plantitas-app/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n});const i={userAgent:navigator.userAgent,platform:navigator.platform,isOnline:navigator.onLine,viewport:{width:window.innerWidth,height:window.innerHeight},url:window.location.href,timestamp:new Date().toISOString()};console.error("[ErrorBoundary] Error caught:",{error:r.message,stack:r.stack,errorInfo:n,mobileInfo:i}),console.warn("[ErrorBoundary] Production error detected:",{message:r.message,mobile:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:u.jsx("div",{className:"max-w-md w-full",children:u.jsxs("div",{className:"glass-effect rounded-2xl p-8 text-center",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:u.jsx(_n,{size:32,className:"text-red-500"})}),u.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"¡Oops! Algo salió mal"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. No te preocupes, tus plantas están seguras."}),!1,u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:this.handleReload,className:"w-full px-4 py-3 bg-primary-500 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[u.jsx(La,{size:18}),u.jsx("span",{children:"Recargar Página"})]}),u.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-4 py-3 bg-gray-600 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[u.jsx(Ql,{size:18}),u.jsx("span",{children:"Ir al Inicio"})]})]}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-4",children:"Si el problema persiste, intenta limpiar el caché del navegador."})]})})}):this.props.children}}const Y3=()=>{const t=Nn(e=>e.user);return w_({queryKey:["plants",t?.id],queryFn:async()=>t?hs.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:gi.QUERY.STALE_TIME.MEDIUM,gcTime:gi.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]})},Hb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Wb=Le,cg=(t,e)=>r=>{var n;if(e?.variants==null)return Wb(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,s=Object.keys(i).map(l=>{const d=r?.[l],h=a?.[l];if(d===null)return null;const m=Hb(d)||Hb(h);return i[l][m]}),o=r&&Object.entries(r).reduce((l,d)=>{let[h,m]=d;return m===void 0||(l[h]=m),l},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((l,d)=>{let{class:h,className:m,...p}=d;return Object.entries(p).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...a,...o}[b]):{...a,...o}[b]===g})?[...l,h,m]:l},[]);return Wb(t,s,c,r?.class,r?.className)},Z3=cg("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),Ir=H.forwardRef(({className:t,variant:e,size:r,radius:n,interactive:i,hover:a=!1,loading:s=!1,children:o,ariaLabel:c,...l},d)=>u.jsx(L.div,{whileHover:i&&!s?{scale:a?1.02:1.01,y:a?-4:-2}:void 0,whileTap:i&&!s?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe(Z3({variant:e,size:r,radius:n,interactive:i}),s&&"animate-pulse",t),ref:d,...l,children:s?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),u.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));Ir.displayName="Card";const Dd=H.forwardRef(({className:t,...e},r)=>u.jsx("div",{ref:r,className:Oe("flex flex-col space-y-1.5 pb-4",t),...e}));Dd.displayName="CardHeader";const lg=H.forwardRef(({className:t,...e},r)=>u.jsx("h3",{ref:r,className:Oe("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",t),...e}));lg.displayName="CardTitle";const X3=H.forwardRef(({className:t,...e},r)=>u.jsx("p",{ref:r,className:Oe("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",t),...e}));X3.displayName="CardDescription";const Jn=H.forwardRef(({className:t,...e},r)=>u.jsx("div",{ref:r,className:Oe("",t),...e}));Jn.displayName="CardContent";const iA=H.forwardRef(({className:t,...e},r)=>u.jsx("div",{ref:r,className:Oe("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",t),...e}));iA.displayName="CardFooter";const po=new Set,El=new Map,ug=({src:t,alt:e,className:r="",fallback:n,onLoad:i,onError:a,priority:s=!1,sizes:o="(max-width: 768px) 100vw, 50vw",srcSet:c,blurDataUrl:l})=>{const[d,h]=w.useState(()=>po.has(t)),[m,p]=w.useState(!1),[v,b]=w.useState(s),g=w.useRef(null),_=w.useRef(null);w.useEffect(()=>{if(s)return;const j=new IntersectionObserver(([R])=>{R.isIntersecting&&(b(!0),j.disconnect())},{rootMargin:"50px",threshold:.1});return _.current&&j.observe(_.current),()=>j.disconnect()},[s]),w.useEffect(()=>{if(s&&!po.has(t)&&!El.has(t)){const j=new Image;j.src=t,j.onload=()=>{po.add(t),El.set(t,j)},j.onerror=()=>{El.delete(t)},El.set(t,j)}},[t,s]);const T=w.useCallback(()=>{po.add(t),h(!0),i?.()},[i,t]),E=w.useCallback(()=>{po.delete(t),p(!0),a?.()},[a,t]);return m&&n?u.jsx(u.Fragment,{children:n}):m?u.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 flex items-center justify-center ${r}`,children:u.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})}):u.jsxs("div",{ref:_,className:`relative overflow-hidden ${r}`,style:{backgroundColor:"#f0f0f0"},children:[l&&u.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full object-cover",style:{filter:"blur(10px)",transform:"scale(1.1)",opacity:d?0:1,transition:"opacity 0.3s ease-in-out"},"aria-hidden":"true"}),u.jsx(Pe,{children:!d&&!l&&u.jsx(L.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"})}),v&&u.jsx(L.img,{ref:g,src:t,srcSet:c,alt:e,className:`w-full h-full object-cover ${d?"opacity-100":"opacity-0"}`,loading:s?"eager":"lazy",decoding:"async",fetchPriority:s?"high":"low",sizes:o,onLoad:T,onError:E,initial:{opacity:0},animate:{opacity:d?1:0},transition:{duration:.15},style:{transition:"opacity 0.3s ease-in-out, filter 0.3s ease-in-out",filter:d?"blur(0)":"blur(2px)"}})]})},aA=w.memo(({score:t,healthStatus:e,showDetailedStatus:r=!0,size:n="medium",animated:i=!0})=>{const s={small:{barWidth:"w-16",barHeight:"h-1.5",textSize:"text-xs",iconSize:"w-3 h-3",gap:"gap-1"},medium:{barWidth:"w-24",barHeight:"h-2",textSize:"text-xs",iconSize:"w-4 h-4",gap:"gap-2"},large:{barWidth:"w-32",barHeight:"h-3",textSize:"text-sm",iconSize:"w-5 h-5",gap:"gap-3"}}[n],o=()=>{const l=`${s.iconSize} mr-1`;return t>=80?u.jsx(er,{className:`${l} text-green-400`}):t>=60?u.jsx(ya,{className:`${l} text-yellow-400`}):t>=40?u.jsx(gc,{className:`${l} text-orange-400`}):u.jsx(_n,{className:`${l} text-red-400`})};return u.jsxs("div",{className:`flex items-center ${s.gap} w-full`,children:[u.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.jsx("div",{className:`relative ${s.barWidth} ${s.barHeight} bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden`,children:i?u.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}}):u.jsx("div",{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,style:{width:`${t}%`}})}),u.jsxs("span",{className:`${s.textSize} font-semibold text-neutral-500 dark:text-neutral-400`,children:[t,"%"]})]}),r&&u.jsxs("div",{className:`flex items-center ${s.gap.replace("gap-","gap-1")} ${s.textSize} px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700`,children:[o(),u.jsx("span",{className:e.textColor,children:e.status})]})]})});aA.displayName="PlantHealthIndicator";const Q3=t=>{const e=ar(),r=sd(),n=w.useMemo(()=>{const d=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,h=t.lastWatered?Math.floor((new Date().getTime()-new Date(t.lastWatered).getTime())/(24*60*60*1e3)):0,m=t.healthScore>=80,p=J3(t.healthScore,d,h);return{needsWatering:d,isFavorite:m,daysSinceWatered:h,healthStatus:p}},[t.lastWatered,t.wateringFrequency,t.healthScore]),i=w.useCallback(async()=>{try{await r.prefetchQuery({queryKey:["plant",t.id],queryFn:async()=>{const{supabase:d}=await ep(async()=>{const{supabase:p}=await Promise.resolve().then(()=>u$);return{supabase:p}},void 0),{data:h,error:m}=await d.from("plants").select(`
              *,
              plant_images(*)
            `).eq("id",t.id).single();if(m)throw m.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");return h},staleTime:5*60*1e3})}catch(d){console.warn("Failed to prefetch plant data:",d)}},[t.id,r]),a=w.useCallback(()=>{e(lt.toPlantDetail(t.id))},[e,t.id]),s=w.useCallback(()=>{e(lt.toPlantChat(t.id))},[e,t.id]),o=w.useCallback(()=>{a()},[a]),c=w.useCallback(()=>{i()},[i]);return{state:n,actions:{handleClick:o,handleMouseEnter:c,prefetchPlantData:i,navigateToPlant:a,navigateToChat:s},plant:t}};function J3(t,e,r){let n;if(t>=80?n={color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",status:"Excelente",priority:"low"}:t>=60?n={color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",status:"Buena",priority:"medium"}:n={color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",status:"Atención",priority:"high"},e){if(r>7)return{...n,color:"bg-red-400",textColor:"text-red-700 dark:text-red-300",status:"Necesita agua urgente",priority:"high"};if(r>3)return{...n,color:"bg-orange-400",textColor:"text-orange-700 dark:text-orange-300",status:"Necesita agua",priority:"medium"}}return n}const ez=t=>({src:t.profileImageUrl||"/placeholder-plant.jpg",alt:`${t.name} - ${t.species}`,className:"w-full h-48 object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),tz=t=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Math.min(t*.1,.5)},whileHover:{y:-4,transition:{duration:.2}},whileTap:{scale:.98,transition:{duration:.1}}}),sA=w.memo(({plant:t,index:e})=>{const{state:r,actions:n}=Q3(t),{needsWatering:i,isFavorite:a,healthStatus:s}=r,{handleClick:o,handleMouseEnter:c}=n,l=ez(t),d=tz(e);return u.jsx(L.div,{...d,className:"group",children:u.jsxs(Ir,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:o,onMouseEnter:c,className:"overflow-hidden border border-green-200/60 hover:border-green-300/80 dark:hover:border-green-600 transition-all duration-300 p-4 mb-4 shadow-sm hover:shadow-lg hover:shadow-green-100/30 bg-white/80 backdrop-blur-sm",children:[u.jsx(Dd,{className:"pb-2 flex-shrink-0 space-y-0",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[u.jsx(ug,{...l,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",priority:e<4,sizes:"(max-width: 768px) 20vw, 10vw",fallback:u.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:u.jsx(ya,{size:24})})}),u.jsx(Pe,{children:a&&u.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:u.jsx(I_,{size:12,className:"text-white fill-current"})})}),u.jsx(Pe,{children:i&&u.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:u.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:u.jsx(gc,{size:12,className:"text-white"})})})})]}),u.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[u.jsx(lg,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),u.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),u.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:u.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:["📍 ",t.location]})})]})]})}),u.jsxs(Jn,{className:"pt-2 pb-0",children:[u.jsx(aA,{score:t.healthScore,healthStatus:s,size:"medium",animated:!0}),t.healthScore<40&&u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[u.jsx(_n,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),u.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),u.jsx(L.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});sA.displayName="PlantCard";function pe({className:t,...e}){return u.jsx("div",{className:Oe("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",t),...e})}const rz=()=>u.jsxs(Ir,{variant:"elevated",size:"default",className:"overflow-hidden",children:[u.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[u.jsx(pe,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs(Dd,{className:"p-0",children:[u.jsx(pe,{className:"h-6 w-3/4"}),u.jsx(pe,{className:"h-4 w-1/2 mt-2"})]}),u.jsx(Jn,{className:"p-0 mt-3",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(pe,{className:"w-16 h-1.5"}),u.jsx(pe,{className:"w-8 h-3"})]})})]})]}),u.jsx(iA,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:u.jsxs("div",{className:"flex justify-between items-center w-full",children:[u.jsx(pe,{className:"h-4 w-1/3"}),u.jsx(pe,{className:"w-8 h-8 rounded"})]})})]}),nz=cg("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),oe=H.forwardRef(({className:t,variant:e,size:r,fullWidth:n,loading:i=!1,leftIcon:a,rightIcon:s,children:o,disabled:c,...l},d)=>{const h=c||i;return u.jsxs(L.button,{whileTap:h?void 0:{scale:.96},whileHover:h?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:Oe(nz({variant:e,size:r,fullWidth:n,className:t})),disabled:h,ref:d,...l,children:[i&&u.jsx(L.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),a&&!i&&u.jsx("span",{className:"mr-2 -ml-1",children:a}),u.jsx("span",{className:Oe("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(m=>typeof m=="string"||typeof m=="number"||H.isValidElement(m)):typeof o=="string"||typeof o=="number"||H.isValidElement(o)?o:null}),s&&u.jsx("span",{className:"ml-2 -mr-1",children:s})]})});oe.displayName="Button";const iz=cg("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Md=H.forwardRef(({className:t,variant:e,size:r,state:n,label:i,helperText:a,errorMessage:s,successMessage:o,leftIcon:c,rightIcon:l,loading:d=!1,showPasswordToggle:h=!1,floatingLabel:m=!1,type:p,disabled:v,value:b,defaultValue:g,..._},T)=>{const[E,j]=w.useState(!1),[R,D]=w.useState(!1),[S,A]=w.useState(b||g||""),P=w.useRef(null),O=w.useCallback(fe=>{P.current=fe,typeof T=="function"?T(fe):T&&(T.current=fe)},[T]),N=s?"error":o?"success":n,C=!!S||E,k=h?R?"text":"password":p;w.useEffect(()=>{b!==void 0&&A(b)},[b]);const Q=fe=>{j(!0),_.onFocus?.(fe)},ce=fe=>{j(!1),_.onBlur?.(fe)},X=fe=>{A(fe.target.value),_.onChange?.(fe)},ee=()=>{P.current?.focus()};return u.jsxs("div",{className:"w-full",children:[u.jsxs("div",{className:"relative",children:[i&&!m&&u.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),u.jsxs("div",{className:"relative",children:[c&&u.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:c}),i&&m&&u.jsx(L.label,{onClick:ee,animate:{scale:C?.85:1,y:C?-24:0,x:C?4:c?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",C&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),u.jsx("input",{ref:O,type:k,value:S,disabled:v||d,className:Oe(iz({variant:e,size:r,state:N}),c&&"pl-10",(l||h||d)&&"pr-10",m&&C&&"pt-6 pb-2",(!r||r==="default")&&"py-[12px]","placeholder-[#777]",t),style:{..._.style},onFocus:Q,onBlur:ce,onChange:X,..._}),u.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[d&&u.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:u.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:u.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!d&&N==="error"&&u.jsx(Jr,{className:"w-4 h-4 text-error-500"}),!d&&N==="success"&&u.jsx(Ai,{className:"w-4 h-4 text-success-500"}),h&&!d&&u.jsx("button",{type:"button",onClick:()=>D(!R),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:R?u.jsx(xk,{className:"w-4 h-4"}):u.jsx(Pf,{className:"w-4 h-4"})}),l&&!d&&u.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:l})]})]}),u.jsx(Pe,{children:E&&u.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:Oe("absolute inset-0 rounded-xl pointer-events-none",N==="error"&&"ring-2 ring-error-500/20",N==="success"&&"ring-2 ring-success-500/20",N==="default"&&"ring-2 ring-primary-500/20")})})]}),u.jsx(Pe,{mode:"wait",children:(a||s||o)&&u.jsxs(L.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[s&&u.jsxs(u.Fragment,{children:[u.jsx(Jr,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),u.jsx("span",{className:"text-error-600 dark:text-error-400",children:s})]}),o&&!s&&u.jsxs(u.Fragment,{children:[u.jsx(Ai,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),u.jsx("span",{className:"text-success-600 dark:text-success-400",children:o})]}),a&&!s&&!o&&u.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:a})]})})]})});Md.displayName="Input";const az={default:ga,ai:k_,camera:En,upload:C_,download:Tk,sync:Ek,search:_k,save:wk,delete:P_,chat:yc},sz={sm:{icon:"w-4 h-4",text:"text-sm",gap:"gap-2"},md:{icon:"w-5 h-5",text:"text-base",gap:"gap-3"},lg:{icon:"w-6 h-6",text:"text-lg",gap:"gap-4"}},oz=({message:t,type:e="default",size:r="md",className:n=""})=>{const i=az[e],a=sz[r];return u.jsxs("div",{className:`flex items-center justify-center ${a.gap} ${n}`,children:[u.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"flex-shrink-0",children:u.jsx(i,{className:`${a.icon} text-primary-500`})}),u.jsx("span",{className:`${a.text} text-gray-600 dark:text-gray-400 font-medium`,children:t})]})},cz={LoadingPlants:t=>u.jsx(oz,{message:"Cargando tu jardín...",type:"default",...t})},lz=({children:t,content:e,position:r="top",delay:n=300,disabled:i=!1,className:a=""})=>{const[s,o]=w.useState(!1),[c,l]=w.useState({x:0,y:0}),d=w.useRef(null),h=w.useRef(),m=()=>{i||(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(d.current){const g=d.current.getBoundingClientRect(),_=window.pageYOffset||document.documentElement.scrollTop,T=window.pageXOffset||document.documentElement.scrollLeft;let E,j;switch(r){case"top":E=g.left+T+g.width/2,j=g.top+_-8;break;case"bottom":E=g.left+T+g.width/2,j=g.bottom+_+8;break;case"left":E=g.left+T-8,j=g.top+_+g.height/2;break;case"right":E=g.right+T+8,j=g.top+_+g.height/2;break;default:E=g.left+T+g.width/2,j=g.top+_-8}l({x:E,y:j}),o(!0)}},n))},p=()=>{h.current&&clearTimeout(h.current),o(!1)};w.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const v=()=>{const g="absolute z-[9999] px-2 py-1 text-xs font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-md shadow-lg pointer-events-none max-w-xs";switch(r){case"top":return`${g} -translate-x-1/2 -translate-y-full`;case"bottom":return`${g} -translate-x-1/2`;case"left":return`${g} -translate-x-full -translate-y-1/2`;case"right":return`${g} -translate-y-1/2`;default:return`${g} -translate-x-1/2 -translate-y-full`}},b=()=>{const g="absolute w-2 h-2 bg-gray-900 dark:bg-gray-700 transform rotate-45";switch(r){case"top":return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`;case"bottom":return`${g} left-1/2 -translate-x-1/2 -top-1`;case"left":return`${g} top-1/2 -translate-y-1/2 left-full -translate-x-1/2`;case"right":return`${g} top-1/2 -translate-y-1/2 -left-1`;default:return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`}};return u.jsxs(u.Fragment,{children:[u.jsx("div",{ref:d,onMouseEnter:m,onMouseLeave:p,onFocus:m,onBlur:p,className:`inline-block ${a}`,children:t}),typeof document<"u"&&Jm.createPortal(u.jsx(Pe,{children:s&&u.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:v(),style:{left:c.x,top:c.y},children:[e,u.jsx("div",{className:b()})]})}),document.body)]})},uz={network:{icon:S_,color:"text-orange-500",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Verificar conexión",action:"help"}]},validation:{icon:_n,color:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-800",defaultActions:[{label:"Corregir",action:"retry"}]},server:{icon:_n,color:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Reportar problema",action:"help"}]},unknown:{icon:Ak,color:"text-gray-500",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800",defaultActions:[{label:"Reintentar",action:"retry"}]}},dz=({title:t,message:e,type:r="unknown",onRetry:n,onDismiss:i,actions:a,className:s=""})=>{const o=uz[r],c=o.icon,l=h=>{switch(h){case"retry":n?.();break;case"help":console.log("Help requested for error type:",r);break}},d=()=>a?a.map((h,m)=>u.jsx(oe,{variant:h.variant||"outline",size:"sm",onClick:h.onClick,children:h.label},m)):o.defaultActions.map((h,m)=>u.jsxs(oe,{variant:m===0?"primary":"outline",size:"sm",onClick:()=>l(h.action),disabled:h.action==="retry"&&!n,children:[h.action==="retry"&&u.jsx(La,{className:"w-4 h-4 mr-1"}),h.action==="help"&&u.jsx(Sk,{className:"w-4 h-4 mr-1"}),h.label]},m));return u.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
        ${o.bgColor} 
        ${o.borderColor} 
        border rounded-lg p-4 
        ${s}
      `,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:`${o.color} flex-shrink-0 mt-0.5`,children:u.jsx(c,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:t}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e}),u.jsx("div",{className:"flex flex-wrap gap-2",children:d()})]}),i&&u.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar error",children:u.jsx(Fi,{className:"w-4 h-4"})})]})})},hz={LoadingPlantsError:t=>u.jsx(dz,{type:"server",title:"Error al Cargar Plantas",message:"No se pudieron cargar tus plantas. Intenta refrescar la página.",...t})},fz=({isOpen:t,onComplete:e,onSkip:r,steps:n})=>{const[i,a]=w.useState(0),[s,o]=w.useState(null),[c,l]=w.useState({x:0,y:0}),d=n[i],h=i===n.length-1,m=i===0;w.useEffect(()=>{if(!t||!d?.target)return;const g=document.querySelector(d.target);if(g){o(g);const _=g.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,E=window.pageXOffset||document.documentElement.scrollLeft;let j,R;switch(d.position){case"top":j=_.left+E+_.width/2,R=_.top+T-20;break;case"bottom":j=_.left+E+_.width/2,R=_.bottom+T+20;break;case"left":j=_.left+E-20,R=_.top+T+_.height/2;break;case"right":j=_.right+E+20,R=_.top+T+_.height/2;break;default:j=window.innerWidth/2,R=window.innerHeight/2}l({x:j,y:R}),g.scrollIntoView({behavior:"smooth",block:"center"})}else o(null),l({x:window.innerWidth/2,y:window.innerHeight/2})},[t,d,i]);const p=()=>{h?e():a(g=>g+1)},v=()=>{m||a(g=>g-1)},b=()=>{if(!d?.position||d.position==="center")return"-translate-x-1/2 -translate-y-1/2";switch(d.position){case"top":return"-translate-x-1/2 -translate-y-full";case"bottom":return"-translate-x-1/2";case"left":return"-translate-x-full -translate-y-1/2";case"right":return"-translate-y-1/2";default:return"-translate-x-1/2 -translate-y-1/2"}};return t?u.jsx(Pe,{children:u.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[u.jsx("div",{className:"absolute inset-0 bg-black/60"}),s&&u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute pointer-events-none",style:{left:s.getBoundingClientRect().left+window.pageXOffset,top:s.getBoundingClientRect().top+window.pageYOffset,width:s.getBoundingClientRect().width,height:s.getBoundingClientRect().height,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(34, 197, 94, 0.5)",borderRadius:"8px"}}),u.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 max-w-sm ${b()}`,style:{left:c.x,top:c.y},children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(er,{className:"w-5 h-5 text-green-500"}),u.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["Paso ",i+1," de ",n.length]})]}),u.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Omitir tour",children:u.jsx(Fi,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:d.title}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:d.description})]}),d.action&&u.jsx("div",{className:"mb-4",children:u.jsx(oe,{variant:"outline",size:"sm",onClick:d.action.onClick,className:"w-full",children:d.action.label})}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs(oe,{variant:"ghost",size:"sm",onClick:v,disabled:m,className:"flex items-center gap-1",children:[u.jsx(N_,{className:"w-4 h-4"}),"Anterior"]}),u.jsx("div",{className:"flex gap-1",children:n.map((g,_)=>u.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${_===i?"bg-green-500":_<i?"bg-green-300":"bg-gray-300"}`},_))}),u.jsxs(oe,{size:"sm",onClick:p,className:"flex items-center gap-1",children:[h?"Finalizar":"Siguiente",!h&&u.jsx(j_,{className:"w-4 h-4"})]})]}),u.jsx("div",{className:"mt-4 text-center",children:u.jsx("button",{onClick:r,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Omitir tour"})})]})]})}):null},Tl="1.0.0",qb="plantitas-onboarding-state",mz=()=>{const t=ar(),[e,r]=w.useState(()=>{try{const d=localStorage.getItem(qb);if(d){const h=JSON.parse(d);return h.currentVersion!==Tl?{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tl}:h}}catch(d){console.warn("Error loading onboarding state:",d)}return{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tl}});w.useEffect(()=>{try{localStorage.setItem(qb,JSON.stringify(e))}catch(d){console.warn("Error saving onboarding state:",d)}},[e]);const n=d=>{r(h=>({...h,...d}))};return{state:e,shouldShowTour:()=>!e.hasCompletedTour,completeTour:()=>{n({hasCompletedTour:!0})},markFirstPlantAdded:()=>{n({hasAddedFirstPlant:!0})},markChatUsed:()=>{n({hasUsedChat:!0})},resetOnboarding:()=>{r({hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Tl})},getTourSteps:()=>[{id:"welcome",title:"¡Bienvenido a Plantitas! 🌱",description:"Tu asistente personal para el cuidado de plantas. Te ayudaremos a mantener tus plantas saludables y felices.",position:"center"},{id:"add-plant",title:"Agrega tu primera planta",description:"Usa el botón flotante para tomar una foto de tu planta. Nuestra IA la identificará automáticamente.",target:'[data-tour="add-plant-fab"]',position:"left",action:{label:"Ir a cámara",onClick:()=>t(lt.toCamera())}},{id:"navigation",title:"Navegación principal",description:"Usa la navegación inferior para moverte entre el jardín, chat IA y configuraciones.",target:'[data-tour="bottom-navigation"]',position:"top"},{id:"chat-ai",title:"Chat con IA experta",description:"Haz preguntas sobre cuidado de plantas, identificación o cualquier duda que tengas.",target:'[data-tour="chat-tab"]',position:"top",action:{label:"Probar chat",onClick:()=>t(lt.toGardenChat())}},{id:"search-filter",title:"Busca y organiza",description:"Usa la búsqueda y filtros para encontrar rápidamente tus plantas cuando tengas muchas.",target:'[data-tour="search-input"]',position:"bottom"},{id:"complete",title:"¡Listo para empezar! 🎉",description:"Ya conoces lo básico. ¡Comienza agregando tu primera planta y explorando todas las funciones!",position:"center"}]}},Kb=({type:t,title:e,message:r,onDismiss:n,autoHide:i=!1,duration:a=8e3,actions:s})=>{const[o,c]=w.useState(!0),l=ar();w.useEffect(()=>{if(i&&a>0){const v=setTimeout(()=>{c(!1),n?.()},a);return()=>clearTimeout(v)}},[i,a,n]);const d=()=>{c(!1),n?.()};if(!o)return null;const m={suggestion:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",accent:"text-purple-600 dark:text-purple-400",icon:k_},tip:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",accent:"text-blue-600 dark:text-blue-400",icon:er},welcome:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",accent:"text-green-600 dark:text-green-400",icon:yc}}[t],p=m.icon;return u.jsx(Pe,{children:u.jsxs(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:`
          ${m.bg} ${m.border}
          border rounded-lg p-4 shadow-md backdrop-blur-sm
          relative overflow-hidden
        `,children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 opacity-10",children:u.jsx(p,{className:"w-full h-full"})}),u.jsxs("div",{className:"relative flex items-start gap-3",children:[u.jsx("div",{className:`${m.accent} flex-shrink-0 mt-0.5`,children:u.jsx(p,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:`${m.accent} text-sm font-semibold mb-1`,children:e}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-3",children:r}),u.jsx("div",{className:"flex flex-wrap gap-2",children:s?s.map((v,b)=>u.jsx(oe,{size:"sm",variant:v.variant||"outline",onClick:v.onClick,className:"text-xs",children:v.label},b)):u.jsxs(oe,{size:"sm",variant:"outline",onClick:()=>l(lt.toGardenChat()),className:"text-xs flex items-center gap-1",children:["Probar Chat IA",u.jsx(Ik,{className:"w-3 h-3"})]})})]}),n&&u.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar sugerencia",children:u.jsx(Fi,{className:"w-4 h-4"})})]}),i&&a>0&&u.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10",children:u.jsx(L.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:a/1e3,ease:"linear"},className:`h-full ${m.accent.replace("text-","bg-")}`})})]})})},pz=()=>{const[t,e]=w.useState(()=>{try{const a=localStorage.getItem("dismissed-ai-highlights");return a?JSON.parse(a):[]}catch{return[]}});return{dismissHighlight:a=>{const s=[...t,a];e(s);try{localStorage.setItem("dismissed-ai-highlights",JSON.stringify(s))}catch(o){console.warn("Error saving dismissed highlights:",o)}},shouldShowHighlight:a=>!t.includes(a),resetHighlights:()=>{e([]);try{localStorage.removeItem("dismissed-ai-highlights")}catch(a){console.warn("Error resetting highlights:",a)}}}},gz=()=>{const t=ar();return u.jsxs(L.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6 max-w-lg mx-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[u.jsxs(L.div,{className:"relative w-32 h-32 mb-8",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[u.jsx(O_,{className:"absolute top-2 left-2 w-10 h-10 text-sky-400 opacity-60"}),u.jsx(od,{className:"w-32 h-32 text-green-500"}),u.jsx(gc,{className:"absolute bottom-2 right-2 w-12 h-12 text-blue-400 opacity-70"})]}),u.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"¡Comienza tu jardín digital!"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-lg leading-relaxed",children:"Añade tu primera planta tomando una foto y deja que nuestra IA la identifique y te ayude a cuidarla."}),u.jsxs("div",{className:"mb-8 space-y-3 text-left",children:[u.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),u.jsx("span",{children:"Identificación automática con IA"})]}),u.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),u.jsx("span",{children:"Recordatorios de riego personalizados"})]}),u.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),u.jsx("span",{children:"Chat con asistente experto en plantas"})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[u.jsxs(oe,{size:"lg",onClick:()=>t(lt.toCamera()),className:"flex-1",children:[u.jsx(rp,{className:"mr-2"}),"Tomar Foto"]}),u.jsx(lz,{content:"Explora las funciones de chat IA para aprender sobre plantas",children:u.jsxs(oe,{size:"lg",variant:"outline",onClick:()=>t(lt.toGardenChat()),className:"flex-1",children:[u.jsx(yc,{className:"mr-2"}),"Explorar Chat IA"]})})]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6",children:"💡 Tip: Toma fotos con buena iluminación para mejores resultados"})]})},yz=()=>{const{data:t=[],isLoading:e,error:r}=Y3(),[n,i]=w.useState(""),[a,s]=w.useState("name"),{shouldShowTour:o,completeTour:c,getTourSteps:l}=mz(),{shouldShowHighlight:d,dismissHighlight:h}=pz(),m=w.useMemo(()=>[...t].filter(p=>p.name.toLowerCase().includes(n.toLowerCase())||p.species.toLowerCase().includes(n.toLowerCase())).sort((p,v)=>{switch(a){case"health":return(v.healthScore||0)-(p.healthScore||0);case"lastWatered":return(v.lastWatered?.getTime()||0)-(p.lastWatered?.getTime()||0);default:return p.name.localeCompare(v.name)}}),[t,n,a]);return e?u.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[u.jsxs("header",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),u.jsx(cz.LoadingPlants,{size:"sm"})]}),u.jsx(pe,{className:"h-10 w-10 rounded-full"})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((p,v)=>u.jsx(rz,{},v))})]}):r?u.jsx("div",{className:"flex justify-center items-center min-h-[50vh] p-4",children:u.jsx(hz.LoadingPlantsError,{onRetry:()=>window.location.reload(),className:"max-w-md"})}):u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50/20 via-background to-primary-50/10 pb-safe-bottom",children:[u.jsx("header",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur-lg border-b border-border/50 shadow-sm",children:u.jsx("div",{className:"px-4 py-3 max-w-7xl mx-auto",children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[u.jsx(od,{size:22,strokeWidth:2.5,className:"text-primary-600 flex-shrink-0"}),u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("h1",{className:"font-bold text-2xl text-foreground truncate",children:"Mi Jardín"}),t.length>0&&u.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[u.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.length," ",t.length===1?"planta":"plantas"]}),t.some(p=>p.healthScore<40)&&u.jsx("span",{className:"text-xs bg-warning-100 text-warning-700 px-2 py-0.5 rounded-full font-medium",children:"Necesita atención"})]})]})]})})})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[t.length>0&&d("dashboard-ai-welcome")&&u.jsx(Kb,{type:"welcome",title:"¡Tu asistente IA está disponible!",message:"Haz preguntas sobre el cuidado de tus plantas, identifica problemas o descubre nuevos consejos.",onDismiss:()=>h("dashboard-ai-welcome"),autoHide:!0,duration:1e4}),t.length>=3&&d("dashboard-ai-tips")&&u.jsx(Kb,{type:"tip",title:"Consejo del jardinero experto",message:"Con varias plantas, puedes preguntarme sobre rutinas de cuidado personalizadas para optimizar tu tiempo.",onDismiss:()=>h("dashboard-ai-tips"),autoHide:!0,duration:12e3}),t.length>0&&u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsx("div",{className:"flex-1",children:u.jsx(Md,{type:"text",placeholder:"Buscar plantas...",value:n,onChange:p=>i(p.target.value),className:"w-full",size:"default",variant:"default","data-tour":"search-input"})}),u.jsx("div",{className:"sm:w-48",children:u.jsxs("select",{value:a,onChange:p=>s(p.target.value),className:"w-full h-12 px-4 bg-background border border-border rounded-xl text-foreground font-medium shadow-sm focus:ring-2 focus:ring-ring focus:border-ring transition-all duration-200 appearance-none cursor-pointer",children:[u.jsx("option",{value:"name",children:"Por Nombre"}),u.jsx("option",{value:"health",children:"Por Salud"}),u.jsx("option",{value:"lastWatered",children:"Por Riego"})]})})]})}),u.jsx(Pe,{mode:"wait",children:m.length>0?u.jsx(L.div,{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:m.map((p,v)=>u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Math.min(v*.05,.3)},children:u.jsx(sA,{plant:p,index:v})},p.id))},"plants-grid"):t.length===0?u.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:u.jsx(gz,{})},"empty-state"):u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center py-12",children:u.jsxs("div",{className:"text-muted-foreground",children:[u.jsx("p",{className:"text-lg font-medium mb-2",children:"No se encontraron plantas"}),u.jsx("p",{className:"text-sm",children:"Intenta con otros términos de búsqueda"})]})},"no-results")}),u.jsx(fz,{isOpen:o()&&t.length===0,onComplete:c,onSkip:c,steps:l()})]})]})};function mm(t){"@babel/helpers - typeof";return mm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mm(t)}function fr(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Tt(t){fr(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||mm(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var vz={};function bz(){return vz}function Iu(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function Gb(t){fr(1,arguments);var e=Tt(t);return e.setHours(0,0,0,0),e}var xz=864e5;function wz(t,e){fr(2,arguments);var r=Gb(t),n=Gb(e),i=r.getTime()-Iu(r),a=n.getTime()-Iu(n);return Math.round((i-a)/xz)}function Zl(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function _z(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function Yb(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function Ez(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=Yb(r,n),a=Math.abs(wz(r,n));r.setDate(r.getDate()-i*a);var s=+(Yb(r,n)===-i),o=i*(a-s);return o===0?0:o}function Tz(t,e){return fr(2,arguments),Tt(t).getTime()-Tt(e).getTime()}var Az={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},Sz="trunc";function Iz(t){return Az[Sz]}function Pz(t){fr(1,arguments);var e=Tt(t);return e.setHours(23,59,59,999),e}function Cz(t){fr(1,arguments);var e=Tt(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function kz(t){fr(1,arguments);var e=Tt(t);return Pz(e).getTime()===Cz(e).getTime()}function Nz(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=Zl(r,n),a=Math.abs(_z(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=Zl(r,n)===-i;kz(Tt(t))&&a===1&&Zl(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function jz(t,e,r){fr(2,arguments);var n=Tz(t,e)/1e3;return Iz()(n)}var Oz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Rz=function(e,r,n){var i,a=Oz[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function xs(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var Dz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Mz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Lz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$z={date:xs({formats:Dz,defaultWidth:"full"}),time:xs({formats:Mz,defaultWidth:"full"}),dateTime:xs({formats:Lz,defaultWidth:"full"})},Vz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},zz=function(e,r,n,i){return Vz[e]};function ln(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[c]||t.values[o]}var l=t.argumentCallback?t.argumentCallback(e):e;return i[l]}}var Fz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Uz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Bz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Hz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Wz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},qz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Kz=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Gz={ordinalNumber:Kz,era:ln({values:Fz,defaultWidth:"wide"}),quarter:ln({values:Uz,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ln({values:Bz,defaultWidth:"wide"}),day:ln({values:Hz,defaultWidth:"wide"}),dayPeriod:ln({values:Wz,defaultWidth:"wide",formattingValues:qz,defaultFormattingWidth:"wide"})};function un(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(o)?Zz(o,function(h){return h.test(s)}):Yz(o,function(h){return h.test(s)}),l;l=t.valueCallback?t.valueCallback(c):c,l=r.valueCallback?r.valueCallback(l):l;var d=e.slice(s.length);return{value:l,rest:d}}}function Yz(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function Zz(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function oA(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var Xz=/^(\d+)(th|st|nd|rd)?/i,Qz=/\d+/i,Jz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},eF={any:[/^b/i,/^(a|c)/i]},tF={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},rF={any:[/1/i,/2/i,/3/i,/4/i]},nF={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},iF={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aF={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sF={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},oF={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},cF={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},lF={ordinalNumber:oA({matchPattern:Xz,parsePattern:Qz,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:Jz,defaultMatchWidth:"wide",parsePatterns:eF,defaultParseWidth:"any"}),quarter:un({matchPatterns:tF,defaultMatchWidth:"wide",parsePatterns:rF,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:nF,defaultMatchWidth:"wide",parsePatterns:iF,defaultParseWidth:"any"}),day:un({matchPatterns:aF,defaultMatchWidth:"wide",parsePatterns:sF,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:oF,defaultMatchWidth:"any",parsePatterns:cF,defaultParseWidth:"any"})},uF={code:"en-US",formatDistance:Rz,formatLong:$z,formatRelative:zz,localize:Gz,match:lF,options:{weekStartsOn:0,firstWeekContainsDate:1}};function cA(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function dF(t){return cA({},t)}var Zb=1440,hF=2520,af=43200,fF=86400;function mF(t,e,r){var n,i;fr(2,arguments);var a=bz(),s=(n=(i=r?.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:uF;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=Zl(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var c=cA(dF(r),{addSuffix:!!r?.addSuffix,comparison:o}),l,d;o>0?(l=Tt(e),d=Tt(t)):(l=Tt(t),d=Tt(e));var h=jz(d,l),m=(Iu(d)-Iu(l))/1e3,p=Math.round((h-m)/60),v;if(p<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,c):h<10?s.formatDistance("lessThanXSeconds",10,c):h<20?s.formatDistance("lessThanXSeconds",20,c):h<40?s.formatDistance("halfAMinute",0,c):h<60?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",1,c):p===0?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",p,c);if(p<45)return s.formatDistance("xMinutes",p,c);if(p<90)return s.formatDistance("aboutXHours",1,c);if(p<Zb){var b=Math.round(p/60);return s.formatDistance("aboutXHours",b,c)}else{if(p<hF)return s.formatDistance("xDays",1,c);if(p<af){var g=Math.round(p/Zb);return s.formatDistance("xDays",g,c)}else if(p<fF)return v=Math.round(p/af),s.formatDistance("aboutXMonths",v,c)}if(v=Nz(d,l),v<12){var _=Math.round(p/af);return s.formatDistance("xMonths",_,c)}else{var T=v%12,E=Math.floor(v/12);return T<3?s.formatDistance("aboutXYears",E,c):T<9?s.formatDistance("overXYears",E,c):s.formatDistance("almostXYears",E+1,c)}}function lA(t,e){return fr(1,arguments),mF(t,Date.now(),e)}const pF=async t=>{const{data:e,error:r}=await Et.from("plants").select(`
      *,
      plant_images(*)
    `).eq("id",t).single();if(r)throw console.error(`Error fetching plant ${t}:`,r),r.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");const n=e;return{id:n.id,name:n.name,species:n.species,description:n.description??void 0,funFacts:n.fun_facts??void 0,variety:n.variety??void 0,nickname:n.nickname??void 0,location:n.location,plantEnvironment:n.plant_environment,lightRequirements:n.light_requirements,dateAdded:new Date(n.date_added),lastWatered:n.last_watered?new Date(n.last_watered):void 0,lastFertilized:n.last_fertilized?new Date(n.last_fertilized):void 0,healthScore:n.health_score??0,careProfile:n.care_profile,personality:n.personality,images:n.plant_images.map(i=>({id:i.id,url:i.url??"",timestamp:new Date(i.created_at),isProfileImage:i.is_profile_image??!1,healthAnalysis:i.health_analysis})),chatHistory:[],notifications:[]}},dg=t=>{const{data:e,isLoading:r,error:n}=w_({queryKey:["plant",t],queryFn:async()=>pF(t),enabled:!!t,staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1}),i=qn(o=>o.setPlant),a=qn(o=>o.selectPlant);w.useEffect(()=>(e&&(i(e),a(e.id)),()=>{a(null)}),[e,i,a]);const s=w.useMemo(()=>{if(!e)return[];const o=[];if(!e.images||e.images.length===0)return o;const c=e.images.map(l=>l.healthAnalysis?.confidence||null).filter(l=>l!==null);if(c.length>=3){const l=c.slice(-3);if(l[0]>l[1]&&l[1]>l[2]){const d=l[0]-l[2];o.push({type:"warning",title:"Tendencia de Salud a la Baja",message:`La salud de tu planta ha disminuido un ${d.toFixed(0)}% en las últimas revisiones.`})}}if(e.lastWatered&&e.careProfile){const l=Ez(new Date,new Date(e.lastWatered)),d=e.careProfile.wateringFrequency;l>d&&o.push({type:"tip",title:"Consejo de Riego",message:`Han pasado ${l} días desde el último riego. El intervalo recomendado es de ${d} días.`})}return o},[e]);return{plant:e,insights:s,loading:r,error:n?.message||null}},gF=()=>{const t=sd(),r=Nn(o=>o.user)?.id,{addToast:n}=Us(),i=Ei({mutationFn:async({plantId:o,imageDataUrl:c,note:l})=>{if(!r)throw new Error("User not authenticated");console.log("🖼️ [Image] Iniciando proceso de subida de imagen..."),console.log("🔬 [Image] Analizando imagen con IA...");const d=await nA(c);console.log("☁️ [Image] Subiendo imagen a Storage...");const h=await PT(c,"plant-images",`${r}/${o}`);console.log("💾 [Image] Guardando registro en base de datos...");const m=await hs.addPlantImage(o,{url:h,timestamp:new Date,isProfileImage:!1,healthAnalysis:d.health},r);return d.health?.confidence&&(console.log("🏥 [Image] Actualizando health score de la planta..."),await hs.updatePlantHealthScore(o,r,d.health.confidence,d.health,m.id)),console.log("✅ [Image] Proceso completado exitosamente"),{image:m,analysis:d,note:l}},onSuccess:(o,c)=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",c.plantId]});const{setPlant:l}=qn.getState(),d=qn.getState().getPlantById(c.plantId);if(d){const h={...d,images:[...d.images,o.image],healthScore:o.analysis.health?.confidence||d.healthScore};l(h)}n({type:"success",title:"Nueva imagen añadida",message:`Análisis completado. Salud actual: ${o.analysis.health?.confidence?.toFixed(0)||"N/A"}%`})},onError:o=>{console.error("💥 [Image] Error en proceso de subida:",o),n({type:"error",title:"Error al agregar imagen",message:o.message})}}),a=Ei({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🖼️ [Profile] Cambiando imagen de perfil..."),await hs.setProfileImage(o,c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen de perfil actualizada",message:"La imagen principal de la planta ha sido cambiada"})},onError:o=>{n({type:"error",title:"Error al cambiar imagen de perfil",message:o.message})}}),s=Ei({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🗑️ [Image] Eliminando imagen..."),await hs.deleteImage(c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen eliminada",message:"La imagen ha sido eliminada de tu planta"})},onError:o=>{n({type:"error",title:"Error al eliminar imagen",message:o.message})}});return{addPlantImage:i.mutate,isAddingImage:i.isPending,setProfileImage:a.mutate,isSettingProfileImage:a.isPending,deleteImage:s.mutate,isDeletingImage:s.isPending}};function yF({images:t}){const[e,r]=w.useState(null);if(!t||t.length===0)return u.jsx(Ir,{className:"mt-4",children:u.jsx(Jn,{className:"pt-6",children:u.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[u.jsx(En,{className:"w-12 h-12 text-muted-foreground mb-4"}),u.jsx("p",{className:"text-muted-foreground",children:"No hay imágenes para esta planta todavía."}),u.jsx("p",{className:"text-sm text-muted-foreground/70 mt-2",children:"¡Agrega algunas fotos para seguir su progreso!"})]})})});const n=[...t].sort((c,l)=>new Date(l.timestamp).getTime()-new Date(c.timestamp).getTime()),i=c=>{r(c)},a=()=>{r(null)},s=c=>{if(e===null)return;const l=c==="prev"?(e-1+n.length)%n.length:(e+1)%n.length;r(l)},o=c=>(c instanceof Date?c:new Date(c)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"});return u.jsxs("div",{className:"mt-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h2",{className:"text-xl font-bold tracking-tight flex items-center",children:[u.jsx(En,{className:"w-5 h-5 mr-2 text-primary"}),"Galería de Imágenes"]}),u.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," foto",n.length!==1?"s":""]})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((c,l)=>u.jsxs(L.div,{className:"aspect-square relative rounded-[8px] overflow-hidden cursor-pointer group w-[80px] h-[80px]",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(l),children:[u.jsx(ug,{src:c.url,alt:`Imagen de planta del ${o(c.timestamp)}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 rounded-[8px]"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:u.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:u.jsx("div",{className:"flex items-center text-white text-xs gap-2",children:u.jsxs("span",{className:"flex items-center",children:[u.jsx(Jl,{className:"w-3 h-3 mr-1"}),o(c.timestamp)]})})})}),c.isProfileImage&&u.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full font-medium",children:"Principal"})]},c.id))}),u.jsx(Pe,{children:e!==null&&u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a,children:u.jsxs(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:c=>c.stopPropagation(),children:[u.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:u.jsx(Fi,{className:"w-6 h-6"})}),n.length>1&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>s("prev"),className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:u.jsx(N_,{className:"w-6 h-6"})}),u.jsx("button",{onClick:()=>s("next"),className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:u.jsx(j_,{className:"w-6 h-6"})})]}),u.jsx("img",{src:n[e].url,alt:`Imagen de planta del ${o(n[e].timestamp)}`,className:"max-w-full max-h-full object-contain rounded-lg"}),u.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-black/50 text-white p-4 rounded-lg backdrop-blur-sm",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Jl,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"text-sm",children:o(n[e].timestamp)})]}),u.jsxs("span",{className:"text-sm text-white/70",children:[e+1," de ",n.length]})]}),u.jsx("div",{className:"mt-2 text-sm flex items-center gap-2",children:(()=>{const c=n[e].healthAnalysis;if(!c)return u.jsx("span",{className:"italic text-white/60",children:"Sin análisis"});let l="🌱",d="Excelente";switch(c.overallHealth){case"excellent":l="🌱",d="Excelente";break;case"good":l="🌿",d="Buena";break;case"fair":l="🍃",d="Regular";break;case"poor":l="🥀",d="Baja";break;default:l="🌱",d=c.overallHealth}let h;const m={excellent:95,good:80,fair:60,poor:30};return c.overallHealth&&m[c.overallHealth]?h=m[c.overallHealth]:typeof c.confidence=="number"&&(h=c.confidence<=1?c.confidence*100:c.confidence),u.jsxs("span",{children:["Salud: ",u.jsx("span",{className:"font-semibold",children:d})," ",u.jsx("span",{children:l}),h!==void 0&&u.jsxs("span",{className:"ml-2",children:["(",Math.round(h),"%)"]})]})})()}),n[e].isProfileImage&&u.jsx("div",{className:"mt-2",children:u.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:"Imagen Principal"})})]})]})})})]})}const vF=new og,bF=()=>{const[t,e]=w.useState(!1),r=sd(),n=Nn(o=>o.user),{addToast:i}=Us(),a=Ei({mutationFn:async({plantId:o,species:c,commonName:l})=>{if(!n)throw new Error("User not authenticated");e(!0),i({type:"info",title:"🤖 Completando información",message:`Consultando IA para ${l||c}...`,duration:3e3});try{const d=await k3(c,l);return await vF.updatePlantInfo(o,n.id,{plantEnvironment:d.plantEnvironment,lightRequirements:d.lightRequirements,description:d.description,funFacts:d.funFacts})}catch(d){throw console.error("❌ [COMPLETAR IA] Error durante el proceso:",d),d}finally{e(!1)}},onSuccess:o=>{console.log("🔄 [COMPLETAR IA] Refrescando datos en cache..."),i({type:"success",title:"✅ ¡Información completada!",message:`Se agregaron datos de ambiente y luz para ${o.name}`,duration:5e3}),r.invalidateQueries({queryKey:["plant",o.id]}),r.invalidateQueries({queryKey:["plants"]}),console.log("✅ [COMPLETAR IA] Cache actualizado correctamente")},onError:o=>{console.error("💥 [COMPLETAR IA] Error final en la operación:",o),i({type:"error",title:"❌ Error al completar información",message:"No se pudo obtener los datos de IA. Intenta de nuevo.",duration:7e3}),e(!1)}});return{completeInfo:(o,c,l)=>a.mutate({plantId:o,species:c,commonName:l}),isCompleting:t||a.isPending,error:a.error,isSuccess:a.isSuccess}},xF=({isOpen:t,onClose:e,onConfirm:r,title:n,description:i,confirmText:a="Confirmar",cancelText:s="Cancelar",variant:o="warning",isLoading:c=!1,preview:l})=>{const h={danger:{iconColor:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",confirmColor:"destructive"},warning:{iconColor:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",confirmColor:"warning"},info:{iconColor:"text-blue-500",bgColor:"bg-blue-50 dark:bg-blue-900/20",confirmColor:"primary"}}[o];return u.jsx(Pe,{children:t&&u.jsx(u.Fragment,{children:u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:u.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:m=>m.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[u.jsx("div",{className:"p-6 pb-4",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:`${h.bgColor} p-3 rounded-full flex-shrink-0`,children:u.jsx(_n,{className:`w-6 h-6 ${h.iconColor}`})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:n}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:i})]}),u.jsx("button",{onClick:e,disabled:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar diálogo",children:u.jsx(Fi,{className:"w-5 h-5"})})]})}),l&&u.jsx("div",{className:"px-6 pb-4",children:u.jsx("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50",children:l})}),u.jsxs("div",{className:"px-6 pb-6 flex gap-3 justify-end",children:[u.jsx(oe,{variant:"outline",onClick:e,disabled:c,className:"min-w-[80px]",children:s}),u.jsx(oe,{variant:h.confirmColor,onClick:r,disabled:c,loading:c,className:"min-w-[80px]",children:a})]})]})})})})},wF=({plant:t,variant:e="primary",size:r="sm",showLabel:n=!0,className:i=""})=>{const{updatePlantHealthMutation:a,isUpdatingPlantHealth:s}=Rd(),o=Nn(p=>p.user),{addToast:c}=Us(),{plant:l}=dg(t.id),d=async()=>{if(!o?.id){c({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnóstico"});return}if(!l){c({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log("🩺 [Button] Actualizando diagnóstico para:",t.name),a({plant:l,userId:o.id})},h=u.jsxs(u.Fragment,{children:[s?u.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u.jsx(La,{size:r.includes("icon")?16:14})}):u.jsx(R_,{size:r.includes("icon")?16:14}),n&&!r.includes("icon")&&u.jsx("span",{className:"ml-2 text-xs",children:s?"Analizando...":"Analizar"})]}),m=r.includes("icon");return u.jsx(oe,{onClick:d,disabled:s||!l,size:r,variant:e,className:i,"aria-label":m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,title:m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,children:h})},_F=({plant:t})=>{const e=ar(),[r,n]=w.useState(!1),[i,a]=w.useState(!1),{deletePlant:s,isDeletingPlant:o}=Rd(),{completeInfo:c,isCompleting:l}=bF(),{scrollY:d}=Pk(),h=Iv(d,[0,300],[0,150]),m=Iv(d,[0,200],[1,.3]),p=t.images?.find(C=>C.isProfileImage)||t.images?.[0],v=!t.plantEnvironment||!t.lightRequirements,b=()=>{a(!0),n(!1)},g=()=>{s(t.id,{onSuccess:()=>{e("/")}})},_=()=>{console.log("🎯 [UI] Usuario solicitó completar información con IA"),console.log("🌱 [UI] Datos de la planta:",{id:t.id,nombre:t.name,especie:t.species,ambienteActual:t.plantEnvironment||"No especificado",luzActual:t.lightRequirements||"No especificado"}),n(!1),a(!0)},T=()=>{console.log("✅ [UI] Usuario confirmó el completado automático"),a(!1),c(t.id,t.species,t.name)},E=()=>{console.log("❌ [UI] Usuario canceló el completado automático"),a(!1)},j=C=>(C instanceof Date?C:new Date(C)).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),R=C=>{switch(C){case"interior":return u.jsx(Ql,{className:"w-4 h-4 mr-2"});case"exterior":return u.jsx(Pv,{className:"w-4 h-4 mr-2"});case"ambos":return u.jsxs(u.Fragment,{children:[u.jsx(Ql,{className:"w-3 h-3 mr-1"}),u.jsx(Pv,{className:"w-3 h-3 mr-1"})]});default:return null}},D=C=>{switch(C){case"interior":return"Interior";case"exterior":return"Exterior";case"ambos":return"Interior/Exterior";default:return null}},S=C=>{switch(C){case"poca_luz":return u.jsx(Ck,{className:"w-4 h-4 mr-2"});case"luz_indirecta":return u.jsx(ya,{className:"w-4 h-4 mr-2 opacity-60"});case"luz_directa_parcial":return u.jsx(ya,{className:"w-4 h-4 mr-2 opacity-80"});case"pleno_sol":return u.jsx(ya,{className:"w-4 h-4 mr-2"});default:return null}},A=C=>{switch(C){case"poca_luz":return"Poca luz";case"luz_indirecta":return"Luz indirecta";case"luz_directa_parcial":return"Sol parcial";case"pleno_sol":return"Pleno sol";default:return null}},P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},O={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:120}}},N={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6}}};return w.useEffect(()=>{const C=()=>n(!1);if(r)return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[r]),u.jsxs(L.div,{className:"relative h-96 w-full overflow-hidden",variants:P,initial:"hidden",animate:"visible",children:[u.jsx(L.div,{className:"absolute inset-0 scale-110",style:{y:h,opacity:m},children:p?u.jsx(ug,{src:p.url,alt:t.name,className:"h-full w-full object-cover"}):u.jsx("div",{className:"h-full w-full bg-gradient-to-br from-green-400 via-green-500 to-green-600",children:u.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})})}),u.jsxs(L.div,{className:"absolute inset-0",variants:N,children:[u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,0.6)] to-transparent"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/30"}),u.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background/60 to-transparent"})]}),u.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top z-20",children:u.jsxs(L.div,{className:"flex items-center justify-between",variants:O,children:[u.jsx(oe,{"aria-label":"Volver atrás",variant:"ghost",size:"icon",onClick:()=>e("/"),className:"bg-black/30 text-white backdrop-blur-lg rounded-full border border-white/20 hover:bg-black/50 transition-all duration-300",children:u.jsx(ip,{size:20})}),u.jsx("div",{className:"flex items-center space-x-2",children:u.jsxs("div",{className:"relative",children:[u.jsx(oe,{"aria-label":"Más opciones",variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),n(k=>!k)},className:"bg-neutral-800/90 text-white backdrop-blur-lg rounded-full border border-neutral-600 hover:bg-neutral-700 transition-all duration-300 dark:bg-neutral-200/90 dark:text-neutral-900 dark:border-neutral-400 dark:hover:bg-neutral-300",children:u.jsx(D_,{size:20})}),u.jsx(Pe,{children:r&&u.jsx(L.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 mt-2 w-48 origin-top-right rounded-xl bg-background/95 backdrop-blur-lg shadow-xl ring-1 ring-black/10 focus:outline-none z-30 border border-border/50",onClick:C=>C.stopPropagation(),children:u.jsxs("div",{className:"py-2",children:[v&&u.jsxs("button",{onClick:_,disabled:l,className:"flex w-full items-center px-4 py-3 text-sm text-contrast-high hover:bg-contrast-surface transition-colors rounded-lg mx-2",children:[l?u.jsx(ga,{className:"mr-3 h-4 w-4 animate-spin"}):u.jsx(er,{className:"mr-3 h-4 w-4"}),u.jsx("span",{children:l?"Completando...":"Completar con IA"})]}),u.jsx("div",{className:"flex w-full items-center px-2 py-1",children:u.jsx(wF,{plant:t,variant:"outline",size:"sm",showLabel:!0,className:"w-full"})}),u.jsxs("button",{onClick:b,disabled:o,className:"flex w-full items-center px-4 py-3 text-sm text-error-600 dark:text-error-500 hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors rounded-lg mx-2 font-medium",children:[o?u.jsx(ga,{className:"mr-3 h-4 w-4 animate-spin"}):u.jsx(P_,{className:"mr-3 h-4 w-4"}),u.jsx("span",{children:o?"Eliminando...":"Eliminar planta"})]})]})})})]})})]})}),u.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom z-10",children:u.jsxs(L.div,{className:"space-y-4",variants:O,children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(L.h1,{className:"text-[24px] font-bold text-white drop-shadow-lg",variants:O,children:t.nickname||t.name}),u.jsx(L.p,{className:"text-[16px] text-white/90 font-medium",variants:O,children:t.species})]}),u.jsxs(L.div,{className:"flex flex-wrap gap-2 pt-2 max-h-32 overflow-y-auto",variants:O,children:[t.location&&u.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[u.jsx(M_,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"text-sm font-medium",children:t.location})]}),t.dateAdded&&u.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[u.jsx(Jl,{className:"w-4 h-4 mr-2"}),u.jsxs("span",{className:"text-sm font-medium",children:["Desde ",j(t.dateAdded)]})]}),t.plantEnvironment&&D(t.plantEnvironment)&&u.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[R(t.plantEnvironment),u.jsx("span",{className:"text-sm font-medium",children:D(t.plantEnvironment)})]}),t.lightRequirements&&A(t.lightRequirements)&&u.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[S(t.lightRequirements),u.jsx("span",{className:"text-sm font-medium",children:A(t.lightRequirements)})]}),t.images&&t.images.length>0&&u.jsx("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:u.jsxs("span",{className:"text-sm font-medium",children:[t.images.length," foto",t.images.length!==1?"s":""]})})]})]})}),u.jsx(Pe,{children:i&&u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:E,children:u.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:C=>C.stopPropagation(),className:"bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[u.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:u.jsx(er,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Completar con IA"}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Información automática"})]})]}),u.jsxs("div",{className:"space-y-3 mb-6",children:[u.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"¿Quieres que la IA complete la información faltante de esta planta?"}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-2",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-2xl",children:"🌱"}),u.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.name})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"text-2xl",children:"🔬"}),u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.species})]})]}),u.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[u.jsx("p",{className:"font-medium mb-1",children:"La IA agregará:"}),u.jsxs("ul",{className:"space-y-1",children:[u.jsx("li",{children:"• Ambiente recomendado (interior/exterior)"}),u.jsx("li",{children:"• Necesidades de luz específicas"})]})]})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx(oe,{variant:"outline",onClick:E,className:"flex-1",disabled:l,children:"Cancelar"}),u.jsx(oe,{onClick:T,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",disabled:l,children:l?u.jsxs(u.Fragment,{children:[u.jsx(ga,{className:"w-4 h-4 mr-2 animate-spin"}),"Completando..."]}):u.jsxs(u.Fragment,{children:[u.jsx(er,{className:"w-4 h-4 mr-2"}),"Completar"]})})]})]})})}),u.jsx(xF,{isOpen:i,onClose:()=>a(!1),onConfirm:g,title:"Eliminar Planta",description:`¿Estás seguro de que quieres eliminar "${t.nickname||t.name}"? Esta acción es irreversible y se perderán todos los datos, fotos y mensajes de chat asociados.`,confirmText:"Eliminar Definitivamente",cancelText:"Cancelar",variant:"danger",isLoading:o,preview:u.jsxs("div",{className:"flex items-center gap-3",children:[p&&u.jsx("img",{src:p.url,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:t.nickname||t.name}),u.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[t.species," • ",t.images?.length||0," fotos"]})]})]})})]})},EF=({plant:t})=>{const{careProfile:e,personality:r}=t;if(!e)return u.jsx("div",{className:"bg-background p-6 rounded-lg shadow-lg w-full text-center",children:u.jsx("p",{className:"text-muted-foreground",children:"No hay perfil de cuidados disponible para esta planta."})});const n=[{icon:u.jsx(gc,{size:20,strokeWidth:2,color:"#555"}),label:"RIEGO",value:`Cada ${e.wateringFrequency} días`},{icon:u.jsx(ya,{size:20,strokeWidth:2,color:"#555"}),label:"LUZ SOLAR",value:e.sunlightRequirement},{icon:u.jsx(O_,{size:20,strokeWidth:2,color:"#555"}),label:"HUMEDAD",value:e.humidityPreference},{icon:u.jsx(L_,{size:20,strokeWidth:2,color:"#555"}),label:"TEMPERATURA IDEAL",value:`${e.temperatureRange.min}°C - ${e.temperatureRange.max}°C`},{icon:u.jsx(er,{size:20,strokeWidth:2,color:"#555"}),label:"FERTILIZACIÓN",value:`Cada ${e.fertilizingFrequency} días`},{icon:u.jsx(eu,{size:20,strokeWidth:2,color:"#555"}),label:"TIPO DE SUELO",value:e.soilType}];return u.jsxs("div",{className:"w-full",style:{lineHeight:"1.4"},children:[u.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-6 mb-4",style:{gap:"24px 16px"},children:n.map((i,a)=>u.jsxs("div",{className:"flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center mb-1",children:[i.icon,u.jsx("span",{className:"ml-2 text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:i.label})]}),u.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i.value})]},a))}),e.specialCare&&e.specialCare.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Cuidados Especiales"}),u.jsx("ul",{className:"list-none pl-0 ml-4",style:{lineHeight:"1.5"},children:e.specialCare.map((i,a)=>u.jsxs("li",{className:"flex items-start mb-1",children:[u.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),u.jsx("span",{className:"text-[14px] text-[#444]",children:i})]},a))})]}),u.jsx("hr",{className:"my-6",style:{border:"none",borderTop:"1px solid #EEE",margin:"24px 0"}}),r&&u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx(Ho,{size:20,strokeWidth:2,color:"#555",className:"mr-2"}),u.jsx("span",{className:"text-[18px] font-semibold text-[#333]",children:"Personalidad de la Planta"})]}),r.communicationStyle&&u.jsx("div",{className:Array.isArray(r.communicationStyle)&&r.communicationStyle.length>1?"grid grid-cols-2 gap-x-4 mb-3":"flex justify-center mb-3",children:(Array.isArray(r.communicationStyle)?r.communicationStyle:[r.communicationStyle]).map((i,a)=>u.jsxs("div",{className:"flex flex-col items-start mb-2",children:[u.jsx("span",{className:"text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:"ESTILO"}),u.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i})]},a))}),r.catchphrases&&r.catchphrases.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mb-2",children:"Frases Típicas"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:r.catchphrases.map((i,a)=>u.jsx("span",{className:"inline-block bg-[#F0FDF6] text-[#046A38] text-[14px] px-2 py-1 rounded-[4px] font-medium",style:{padding:"4px 8px",marginRight:8,marginBottom:8},children:i},a))})]})]})]})},TF=({funFacts:t})=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return u.jsxs(L.div,{className:"bg-white/0 dark:bg-transparent p-3 sm:p-4 w-full",variants:e,initial:"hidden",animate:"visible",children:[t&&t.length>0&&u.jsxs(L.div,{variants:r,children:[u.jsxs("div",{className:"flex items-center mb-6",children:[u.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-full mr-4",children:u.jsx(er,{className:"w-6 h-6 text-yellow-500"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Datos Curiosos"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Descubre cosas increíbles sobre esta planta"})]})]}),u.jsx("div",{className:"grid gap-4",children:t.map((n,i)=>u.jsxs(L.div,{className:"group flex items-start bg-yellow-500/5 hover:bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 transition-all duration-300 hover:shadow-md",variants:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[u.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:u.jsxs("div",{className:"relative",children:[u.jsx($_,{className:"w-5 h-5 text-yellow-500 group-hover:text-yellow-600 transition-colors"}),u.jsx("div",{className:"absolute -inset-2 bg-yellow-500/20 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pulse"})]})}),u.jsx("p",{className:"text-foreground/90 leading-relaxed font-medium group-hover:text-foreground transition-colors",children:n})]},i))})]}),(!t||t.length===0)&&u.jsx(L.div,{className:"mt-8 flex items-center justify-center p-6 bg-muted/30 rounded-xl border border-dashed border-muted-foreground/20",variants:r,children:u.jsxs("div",{className:"text-center",children:[u.jsx(er,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),u.jsx("p",{className:"text-muted-foreground font-medium",children:"No hay datos curiosos disponibles"}),u.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"¡Pronto agregaremos información interesante!"})]})})]})},AF=()=>u.jsx(od,{className:"w-5 h-5 text-[#EF9A9A]","aria-label":"Problema de hoja seca"}),SF=({analysis:t})=>{if(!t)return null;const e=t.issues&&t.issues.length>0;return u.jsxs("div",{className:"w-full",role:"region","aria-label":"Análisis de salud de la planta",style:{lineHeight:"1.4"},children:[e?u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-[16px] text-[#333] mt-3",children:"Problemas Detectados"}),u.jsxs("p",{className:"mb-2 text-[14px] text-[#D32F2F] font-medium",style:{marginTop:12,marginBottom:8},children:[t.issues.length," problema",t.issues.length!==1?"s":""," detectado",t.issues.length!==1?"s":""]}),u.jsx("ul",{className:"",children:t.issues.map((r,n)=>u.jsxs("li",{className:"flex items-start",style:{marginBottom:n<t.issues.length-1?16:0,paddingBottom:n<t.issues.length-1?16:0,borderBottom:n<t.issues.length-1?"1px solid #EEE":"none"},children:[u.jsx("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center mt-1",children:AF()}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"font-semibold text-[15px] text-[#333]",children:r.type}),u.jsx("p",{className:"text-[14px] text-[#555] mt-1",children:r.description})]})]},n))}),u.jsxs("div",{className:"mt-4",children:[u.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Tratamientos Sugeridos"}),u.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.issues.map((r,n)=>u.jsxs("li",{className:"flex items-start mb-1",children:[u.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),u.jsx("span",{className:"text-[14px] text-[#444]",children:r.treatment})]},n))})]})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[u.jsx("span",{className:"text-4xl mb-2",role:"img","aria-label":"Planta saludable",children:"🌱"}),u.jsx(kk,{className:"w-12 h-12 text-green-500 mb-3","aria-label":"Todo en orden"}),u.jsxs("h4",{className:"font-semibold text-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:["¡Todo en orden!",u.jsx("span",{className:"text-base","aria-hidden":"true",children:"🌱"})]}),u.jsx("p",{className:"text-muted-foreground",children:"El análisis inicial no detectó problemas de salud significativos."})]}),t.recommendations&&t.recommendations.length>0&&u.jsxs("div",{className:"mt-4",children:[u.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Recomendaciones Adicionales"}),u.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.recommendations.map((r,n)=>u.jsxs("li",{className:"flex items-start mb-1",children:[u.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),u.jsx("span",{className:"text-[14px] text-[#444]",children:r})]},n))})]})]})};var Ld={},uA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(uA);var hg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(hg);var fg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(fg);var $d={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const l=r[a];o?l==="\\"&&a+1<i?(a++,s+=r[a]):l===o?o="":s+=l:c?l==='"'||l==="'"?o=l:l==="]"?(c=!1,n.push(s),s=""):s+=l:l==="["?(c=!0,s&&(n.push(s),s="")):l==="."?s&&(n.push(s),s=""):s+=l,a++}return s&&n.push(s),n}t.toPath=e})($d);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uA,r=hg,n=fg,i=$d;function a(o,c,l){if(o==null)return l;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return l;const d=o[c];return d===void 0?r.isDeepKey(c)?a(o,i.toPath(c),l):l:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?l:d}default:{if(Array.isArray(c))return s(o,c,l);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return l;const d=o[c];return d===void 0?l:d}}}function s(o,c,l){if(c.length===0)return l;let d=o;for(let h=0;h<c.length;h++){if(d==null||e.isUnsafeProperty(c[h]))return l;d=d[c[h]]}return d===void 0?l:d}t.get=a})(Ld);var IF=Ld.get;const Da=zi(IF);var dA={exports:{}},Ve={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg=Symbol.for("react.transitional.element"),pg=Symbol.for("react.portal"),Vd=Symbol.for("react.fragment"),zd=Symbol.for("react.strict_mode"),Fd=Symbol.for("react.profiler"),Ud=Symbol.for("react.consumer"),Bd=Symbol.for("react.context"),Hd=Symbol.for("react.forward_ref"),Wd=Symbol.for("react.suspense"),qd=Symbol.for("react.suspense_list"),Kd=Symbol.for("react.memo"),Gd=Symbol.for("react.lazy"),PF=Symbol.for("react.view_transition"),CF=Symbol.for("react.client.reference");function Ur(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case mg:switch(t=t.type,t){case Vd:case Fd:case zd:case Wd:case qd:case PF:return t;default:switch(t=t&&t.$$typeof,t){case Bd:case Hd:case Gd:case Kd:return t;case Ud:return t;default:return e}}case pg:return e}}}Ve.ContextConsumer=Ud;Ve.ContextProvider=Bd;Ve.Element=mg;Ve.ForwardRef=Hd;Ve.Fragment=Vd;Ve.Lazy=Gd;Ve.Memo=Kd;Ve.Portal=pg;Ve.Profiler=Fd;Ve.StrictMode=zd;Ve.Suspense=Wd;Ve.SuspenseList=qd;Ve.isContextConsumer=function(t){return Ur(t)===Ud};Ve.isContextProvider=function(t){return Ur(t)===Bd};Ve.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===mg};Ve.isForwardRef=function(t){return Ur(t)===Hd};Ve.isFragment=function(t){return Ur(t)===Vd};Ve.isLazy=function(t){return Ur(t)===Gd};Ve.isMemo=function(t){return Ur(t)===Kd};Ve.isPortal=function(t){return Ur(t)===pg};Ve.isProfiler=function(t){return Ur(t)===Fd};Ve.isStrictMode=function(t){return Ur(t)===zd};Ve.isSuspense=function(t){return Ur(t)===Wd};Ve.isSuspenseList=function(t){return Ur(t)===qd};Ve.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Vd||t===Fd||t===zd||t===Wd||t===qd||typeof t=="object"&&t!==null&&(t.$$typeof===Gd||t.$$typeof===Kd||t.$$typeof===Bd||t.$$typeof===Ud||t.$$typeof===Hd||t.$$typeof===CF||t.getModuleId!==void 0)};Ve.typeOf=Ur;dA.exports=Ve;var kF=dA.exports,Lr=t=>t===0?0:t>0?1:-1,Vr=t=>typeof t=="number"&&t!=+t,da=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,te=t=>(typeof t=="number"||t instanceof Number)&&!Vr(t),In=t=>te(t)||typeof t=="string",NF=0,sc=t=>{var e=++NF;return"".concat(t||"").concat(e)},$i=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!te(e)&&typeof e!="string")return n;var a;if(da(e)){if(r==null)return n;var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return Vr(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},hA=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},go=(t,e)=>te(t)&&te(e)?r=>t+r*(e-t):()=>e;function fA(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Da(n,e))===r)}var ut=t=>t===null||typeof t>"u",gg=t=>ut(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),jF=["viewBox","children"],OF=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Xb=["points","pathLength"],sf={svg:jF,polygon:Xb,polyline:Xb},yg=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],vg=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(w.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{yg.includes(i)&&(n[i]=a=>r[i](r,a))}),n},RF=(t,e,r)=>n=>(t(e,r,n),null),DF=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];yg.includes(i)&&typeof a=="function"&&(n||(n={}),n[i]=RF(a,e,r))}),n},Qb=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",Jb=null,of=null,mA=t=>{if(t===Jb&&Array.isArray(of))return of;var e=[];return w.Children.forEach(t,r=>{ut(r)||(kF.isFragment(r)?e=e.concat(mA(r.props.children)):e.push(r))}),of=e,Jb=t,e};function pA(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>Qb(i)):n=[Qb(e)],mA(t).forEach(i=>{var a=Da(i,"type.displayName")||Da(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var gA=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,MF=(t,e,r,n)=>{var i,a=(i=n&&sf?.[n])!==null&&i!==void 0?i:[];return e.startsWith("data-")||typeof t!="function"&&(n&&a.includes(e)||OF.includes(e))||r&&yg.includes(e)},Ke=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;MF((s=n)===null||s===void 0?void 0:s[a],a,e,r)&&(i[a]=n[a])}),i},LF=["children","width","height","viewBox","className","style","title","desc"];function pm(){return pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pm.apply(null,arguments)}function $F(t,e){if(t==null)return{};var r,n,i=VF(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function VF(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yA=w.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:c,desc:l}=t,d=$F(t,LF),h=a||{width:n,height:i,x:0,y:0},m=Le("recharts-surface",s);return w.createElement("svg",pm({},Ke(d,!0,"svg"),{className:m,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),w.createElement("title",null,c),w.createElement("desc",null,l),r)}),zF=["children","className"];function gm(){return gm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gm.apply(null,arguments)}function FF(t,e){if(t==null)return{};var r,n,i=UF(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function UF(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Vi=w.forwardRef((t,e)=>{var{children:r,className:n}=t,i=FF(t,zF),a=Le("recharts-layer",n);return w.createElement("g",gm({className:a},Ke(i,!0),{ref:e}),r)}),BF=w.createContext(null);function it(t){return function(){return t}}const ym=Math.PI,vm=2*ym,sa=1e-6,HF=vm-sa;function vA(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function WF(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return vA;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class qF{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?vA:WF(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=n-e,l=i-r,d=s-e,h=o-r,m=d*d+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>sa)if(!(Math.abs(h*c-l*d)>sa)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-s,v=i-o,b=c*c+l*l,g=p*p+v*v,_=Math.sqrt(b),T=Math.sqrt(m),E=a*Math.tan((ym-Math.acos((b+m-g)/(2*_*T)))/2),j=E/T,R=E/_;Math.abs(j-1)>sa&&this._append`L${e+j*d},${r+j*h}`,this._append`A${a},${a},0,0,${+(h*p>d*v)},${this._x1=e+R*c},${this._y1=r+R*l}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),c=n*Math.sin(i),l=e+o,d=r+c,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${l},${d}`:(Math.abs(this._x1-l)>sa||Math.abs(this._y1-d)>sa)&&this._append`L${l},${d}`,n&&(m<0&&(m=m%vm+vm),m>HF?this._append`A${n},${n},0,1,${h},${e-o},${r-c}A${n},${n},0,1,${h},${this._x1=l},${this._y1=d}`:m>sa&&this._append`A${n},${n},0,${+(m>=ym)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function bA(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new qF(e)}function bg(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xA(t){this._context=t}xA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Yd(t){return new xA(t)}function wA(t){return t[0]}function _A(t){return t[1]}function EA(t,e){var r=it(!0),n=null,i=Yd,a=null,s=bA(o);t=typeof t=="function"?t:t===void 0?wA:it(t),e=typeof e=="function"?e:e===void 0?_A:it(e);function o(c){var l,d=(c=bg(c)).length,h,m=!1,p;for(n==null&&(a=i(p=s())),l=0;l<=d;++l)!(l<d&&r(h=c[l],l,c))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(h,l,c),+e(h,l,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(t=typeof c=="function"?c:it(+c),o):t},o.y=function(c){return arguments.length?(e=typeof c=="function"?c:it(+c),o):e},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:it(!!c),o):r},o.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),o):i},o.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),o):n},o}function Al(t,e,r){var n=null,i=it(!0),a=null,s=Yd,o=null,c=bA(l);t=typeof t=="function"?t:t===void 0?wA:it(+t),e=typeof e=="function"?e:it(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?_A:it(+r);function l(h){var m,p,v,b=(h=bg(h)).length,g,_=!1,T,E=new Array(b),j=new Array(b);for(a==null&&(o=s(T=c())),m=0;m<=b;++m){if(!(m<b&&i(g=h[m],m,h))===_)if(_=!_)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=m-1;v>=p;--v)o.point(E[v],j[v]);o.lineEnd(),o.areaEnd()}_&&(E[m]=+t(g,m,h),j[m]=+e(g,m,h),o.point(n?+n(g,m,h):E[m],r?+r(g,m,h):j[m]))}if(T)return o=null,T+""||null}function d(){return EA().defined(i).curve(s).context(a)}return l.x=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),n=null,l):t},l.x0=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),l):t},l.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:it(+h),l):n},l.y=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),r=null,l):e},l.y0=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),l):e},l.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:it(+h),l):r},l.lineX0=l.lineY0=function(){return d().x(t).y(e)},l.lineY1=function(){return d().x(t).y(r)},l.lineX1=function(){return d().x(n).y(e)},l.defined=function(h){return arguments.length?(i=typeof h=="function"?h:it(!!h),l):i},l.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),l):s},l.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),l):a},l}class TA{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function KF(t){return new TA(t,!0)}function GF(t){return new TA(t,!1)}function Pu(){}function Cu(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function AA(t){this._context=t}AA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Cu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Cu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function YF(t){return new AA(t)}function SA(t){this._context=t}SA.prototype={areaStart:Pu,areaEnd:Pu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Cu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ZF(t){return new SA(t)}function IA(t){this._context=t}IA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Cu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function XF(t){return new IA(t)}function PA(t){this._context=t}PA.prototype={areaStart:Pu,areaEnd:Pu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function QF(t){return new PA(t)}function ex(t){return t<0?-1:1}function tx(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(ex(a)+ex(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function rx(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function cf(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function ku(t){this._context=t}ku.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:cf(this,this._t0,rx(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,cf(this,rx(this,r=tx(this,t,e)),r);break;default:cf(this,this._t0,r=tx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function CA(t){this._context=new kA(t)}(CA.prototype=Object.create(ku.prototype)).point=function(t,e){ku.prototype.point.call(this,e,t)};function kA(t){this._context=t}kA.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function JF(t){return new ku(t)}function eU(t){return new CA(t)}function NA(t){this._context=t}NA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=nx(t),i=nx(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function nx(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function tU(t){return new NA(t)}function Zd(t,e){this._context=t,this._t=e}Zd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function rU(t){return new Zd(t,.5)}function nU(t){return new Zd(t,0)}function iU(t){return new Zd(t,1)}function ks(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function bm(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function aU(t,e){return t[e]}function sU(t){const e=[];return e.key=t,e}function oU(){var t=it([]),e=bm,r=ks,n=aU;function i(a){var s=Array.from(t.apply(this,arguments),sU),o,c=s.length,l=-1,d;for(const h of a)for(o=0,++l;o<c;++o)(s[o][l]=[0,+n(h,s[o].key,l,a)]).data=h;for(o=0,d=bg(e(s));o<c;++o)s[d[o]].index=o;return r(s,d),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:it(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:it(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?bm:typeof a=="function"?a:it(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??ks,i):r},i}function cU(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}ks(t,e)}}function lU(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}ks(t,e)}}function uU(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,c=0,l=0;o<s;++o){for(var d=t[e[o]],h=d[n][1]||0,m=d[n-1][1]||0,p=(h-m)/2,v=0;v<o;++v){var b=t[e[v]],g=b[n][1]||0,_=b[n-1][1]||0;p+=g-_}c+=h,l+=p*h}i[n-1][1]+=i[n-1][0]=r,c&&(r-=l/c)}i[n-1][1]+=i[n-1][0]=r,ks(t,e)}}var jA={},OA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}t.uniqBy=e})(OA);var xg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(xg);var RA={},Xd={},DA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(DA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=DA;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Xd);var MA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(MA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Xd,r=MA;function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(RA);var LA={},$A={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ld;function r(n){return function(i){return e.get(i,n)}}t.property=r})($A);var VA={},lf={},uf={},wg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(wg);var _g={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(_g);var Qd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(Qd);var ix;function dU(){return ix||(ix=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eg(),r=wg,n=_g,i=Qd;function a(h,m,p){return typeof p!="function"?e.isMatch(h,m):s(h,m,function v(b,g,_,T,E,j){const R=p(b,g,_,T,E,j);return R!==void 0?!!R:s(b,g,v,j)},new Map)}function s(h,m,p,v){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,p,v);case"function":return Object.keys(m).length>0?s(h,{...m},p,v):i.eq(h,m);default:return r.isObject(h)?typeof m=="string"?m==="":!0:i.eq(h,m)}}function o(h,m,p,v){if(m==null)return!0;if(Array.isArray(m))return l(h,m,p,v);if(m instanceof Map)return c(h,m,p,v);if(m instanceof Set)return d(h,m,p,v);const b=Object.keys(m);if(h==null)return b.length===0;if(b.length===0)return!0;if(v&&v.has(m))return v.get(m)===h;v&&v.set(m,h);try{for(let g=0;g<b.length;g++){const _=b[g];if(!n.isPrimitive(h)&&!(_ in h)||m[_]===void 0&&h[_]!==void 0||m[_]===null&&h[_]!==null||!p(h[_],m[_],_,h,m,v))return!1}return!0}finally{v&&v.delete(m)}}function c(h,m,p,v){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,g]of m.entries()){const _=h.get(b);if(p(_,g,b,h,m,v)===!1)return!1}return!0}function l(h,m,p,v){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let g=0;g<m.length;g++){const _=m[g];let T=!1;for(let E=0;E<h.length;E++){if(b.has(E))continue;const j=h[E];let R=!1;if(p(j,_,g,h,m,v)&&(R=!0),R){b.add(E),T=!0;break}}if(!T)return!1}return!0}function d(h,m,p,v){return m.size===0?!0:h instanceof Set?l([...h],[...m],p,v):!1}t.isMatchWith=a,t.isSetMatch=d}(uf)),uf}var ax;function Eg(){return ax||(ax=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dU();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r}(lf)),lf}var zA={},Tg={},Ag={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Ag);var Jd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(Jd);var eh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",l="[object Set]",d="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",v="[object Error]",b="[object DataView]",g="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",j="[object BigUint64Array]",R="[object Int8Array]",D="[object Int16Array]",S="[object Int32Array]",A="[object BigInt64Array]",P="[object Float32Array]",O="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=d,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=j,t.booleanTag=i,t.dataViewTag=b,t.dateTag=o,t.errorTag=v,t.float32ArrayTag=P,t.float64ArrayTag=O,t.functionTag=h,t.int16ArrayTag=D,t.int32ArrayTag=S,t.int8ArrayTag=R,t.mapTag=c,t.numberTag=n,t.objectTag=p,t.regexpTag=e,t.setTag=l,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=T,t.uint32ArrayTag=E,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=_})(eh);var FA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(FA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag,r=Jd,n=eh,i=_g,a=FA;function s(d,h){return o(d,void 0,d,new Map,h)}function o(d,h,m,p=new Map,v=void 0){const b=v?.(d,h,m,p);if(b!=null)return b;if(i.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const g=new Array(d.length);p.set(d,g);for(let _=0;_<d.length;_++)g[_]=o(d[_],_,m,p,v);return Object.hasOwn(d,"index")&&(g.index=d.index),Object.hasOwn(d,"input")&&(g.input=d.input),g}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const g=new RegExp(d.source,d.flags);return g.lastIndex=d.lastIndex,g}if(d instanceof Map){const g=new Map;p.set(d,g);for(const[_,T]of d)g.set(_,o(T,_,m,p,v));return g}if(d instanceof Set){const g=new Set;p.set(d,g);for(const _ of d)g.add(o(_,void 0,m,p,v));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const g=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,g);for(let _=0;_<d.length;_++)g[_]=o(d[_],_,m,p,v);return g}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const g=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,g),c(g,d,m,p,v),g}if(typeof File<"u"&&d instanceof File){const g=new File([d],d.name,{type:d.type});return p.set(d,g),c(g,d,m,p,v),g}if(d instanceof Blob){const g=new Blob([d],{type:d.type});return p.set(d,g),c(g,d,m,p,v),g}if(d instanceof Error){const g=new d.constructor;return p.set(d,g),g.message=d.message,g.name=d.name,g.stack=d.stack,g.cause=d.cause,c(g,d,m,p,v),g}if(typeof d=="object"&&l(d)){const g=Object.create(Object.getPrototypeOf(d));return p.set(d,g),c(g,d,m,p,v),g}return d}function c(d,h,m=d,p,v){const b=[...Object.keys(h),...e.getSymbols(h)];for(let g=0;g<b.length;g++){const _=b[g],T=Object.getOwnPropertyDescriptor(d,_);(T==null||T.writable)&&(d[_]=o(h[_],_,m,p,v))}}function l(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=c})(Tg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Tg;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(zA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eg(),r=zA;function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(VA);var UA={},BA={},HA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Tg,r=eh;function n(i,a){return e.cloneDeepWith(i,(s,o,c,l)=>{const d=a?.(s,o,c,l);if(d!=null)return d;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i?.valueOf());return e.copyProperties(h,i),h}case r.argumentsTag:{const h={};return e.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(HA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HA;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(BA);var WA={},Sg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(Sg);var qA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Jd;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(qA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hg,r=Sg,n=qA,i=$d;function a(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?c=i.toPath(o):c=[o],c.length===0)return!1;let l=s;for(let d=0;d<c.length;d++){const h=c[d];if((l==null||!Object.hasOwn(l,h))&&!((Array.isArray(l)||n.isArguments(l))&&r.isIndex(h)&&h<l.length))return!1;l=l[h]}return!0}t.has=a})(WA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Eg(),r=fg,n=BA,i=Ld,a=WA;function s(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(l){const d=i.get(l,o);return d===void 0?a.has(l,o):c===void 0?d===void 0:e.isMatch(d,c)}}t.matchesProperty=s})(UA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=xg,r=$A,n=VA,i=UA;function a(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=a})(LA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OA,r=xg,n=RA,i=LA;function a(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),i.iteratee(o)):[]}t.uniqBy=a})(jA);var hU=jA.uniqBy;const sx=zi(hU);function fU(t,e,r){return e===!0?sx(t,r):typeof e=="function"?sx(t,e):t}var KA={exports:{}},GA={},YA={exports:{}},ZA={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ns=w;function mU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pU=typeof Object.is=="function"?Object.is:mU,gU=Ns.useState,yU=Ns.useEffect,vU=Ns.useLayoutEffect,bU=Ns.useDebugValue;function xU(t,e){var r=e(),n=gU({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return vU(function(){i.value=r,i.getSnapshot=e,df(i)&&a({inst:i})},[t,r,e]),yU(function(){return df(i)&&a({inst:i}),t(function(){df(i)&&a({inst:i})})},[t]),bU(r),r}function df(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!pU(t,r)}catch{return!0}}function wU(t,e){return e()}var _U=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?wU:xU;ZA.useSyncExternalStore=Ns.useSyncExternalStore!==void 0?Ns.useSyncExternalStore:_U;YA.exports=ZA;var EU=YA.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var th=w,TU=EU;function AU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var SU=typeof Object.is=="function"?Object.is:AU,IU=TU.useSyncExternalStore,PU=th.useRef,CU=th.useEffect,kU=th.useMemo,NU=th.useDebugValue;GA.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=PU(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kU(function(){function c(p){if(!l){if(l=!0,d=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,SU(d,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(d=p,v):(d=p,h=b)}var l=!1,d,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=IU(t,a[0],a[1]);return CU(function(){s.hasValue=!0,s.value=o},[o]),NU(o),o};KA.exports=GA;var jU=KA.exports,Ig=w.createContext(null),OU=t=>t,sr=()=>{var t=w.useContext(Ig);return t?t.store.dispatch:OU},Xl=()=>{},RU=()=>Xl,DU=(t,e)=>t===e;function ie(t){var e=w.useContext(Ig);return jU.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:RU,e?e.store.getState:Xl,e?e.store.getState:Xl,e?t:Xl,DU)}function MU(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function LU(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function $U(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var ox=t=>Array.isArray(t)?t:[t];function VU(t){const e=Array.isArray(t[0])?t[0]:t;return $U(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function zU(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var FU=class{constructor(t){this.value=t}deref(){return this.value}},UU=typeof WeakRef<"u"?WeakRef:FU,BU=0,cx=1;function Sl(){return{s:BU,v:void 0,o:null,p:null}}function XA(t,e={}){let r=Sl();const{resultEqualityCheck:n}=e;let i,a=0;function s(){let o=r;const{length:c}=arguments;for(let h=0,m=c;h<m;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let v=o.o;v===null&&(o.o=v=new WeakMap);const b=v.get(p);b===void 0?(o=Sl(),v.set(p,o)):o=b}else{let v=o.p;v===null&&(o.p=v=new Map);const b=v.get(p);b===void 0?(o=Sl(),v.set(p,o)):o=b}}const l=o;let d;if(o.s===cx)d=o.v;else if(d=t.apply(null,arguments),a++,n){const h=i?.deref?.()??i;h!=null&&n(h,d)&&(d=h,a!==0&&a--),i=typeof d=="object"&&d!==null||typeof d=="function"?new UU(d):d}return l.s=cx,l.v=d,d}return s.clearCache=()=>{r=Sl(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function HU(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,s=0,o,c={},l=i.pop();typeof l=="object"&&(c=l,l=i.pop()),MU(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const d={...r,...c},{memoize:h,memoizeOptions:m=[],argsMemoize:p=XA,argsMemoizeOptions:v=[]}=d,b=ox(m),g=ox(v),_=VU(i),T=h(function(){return a++,l.apply(null,arguments)},...b),E=p(function(){s++;const R=zU(_,arguments);return o=T.apply(null,R),o},...g);return Object.assign(E,{resultFunc:l,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var V=HU(XA),WU=Object.assign((t,e=V)=>{LU(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>WU}),QA={},JA={},eS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=e(n),o=e(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};t.compareValues=r})(eS);var tS={},Pg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Pg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pg,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}t.isKey=i})(tS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eS,r=tS,n=$d;function i(a,s,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const l=(p,v)=>{let b=p;for(let g=0;g<v.length&&b!=null;++g)b=b[v[g]];return b},d=(p,v)=>v==null||p==null?v:typeof p=="object"&&"key"in p?Object.hasOwn(v,p.key)?v[p.key]:l(v,p.path):typeof p=="function"?p(v):Array.isArray(p)?l(v,p):typeof v=="object"?v[p]:v,h=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(v=>d(v,p))})).slice().sort((p,v)=>{for(let b=0;b<h.length;b++){const g=e.compareValues(p.criteria[b],v.criteria[b],o[b]);if(g!==0)return g}return 0}).map(p=>p.original)}t.orderBy=i})(JA);var rS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),s=(o,c)=>{for(let l=0;l<o.length;l++){const d=o[l];Array.isArray(d)&&c<a?s(d,c+1):i.push(d)}};return s(r,0),i}t.flatten=e})(rS);var Cg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sg,r=Xd,n=wg,i=Qd;function a(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&e.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?i.eq(c[o],s):!1}t.isIterateeCall=a})(Cg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JA,r=rS,n=Cg;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(a,r.flatten(s),["asc"])}t.sortBy=i})(QA);var qU=QA.sortBy;const rh=zi(qU);var nS=t=>t.legend.settings,KU=t=>t.legend.size,GU=t=>t.legend.payload;V([GU,nS],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?rh(n,r):n});var Il=1;function YU(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-e.height)>Il||Math.abs(s.left-e.left)>Il||Math.abs(s.top-e.top)>Il||Math.abs(s.width-e.width)>Il)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function $t(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var ZU=typeof Symbol=="function"&&Symbol.observable||"@@observable",lx=ZU,hf=()=>Math.random().toString(36).substring(7).split("").join("."),XU={INIT:`@@redux/INIT${hf()}`,REPLACE:`@@redux/REPLACE${hf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hf()}`},Nu=XU;function kg(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function iS(t,e,r){if(typeof t!="function")throw new Error($t(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($t(1));return r(iS)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function l(){s===a&&(s=new Map,a.forEach((g,_)=>{s.set(_,g)}))}function d(){if(c)throw new Error($t(3));return i}function h(g){if(typeof g!="function")throw new Error($t(4));if(c)throw new Error($t(5));let _=!0;l();const T=o++;return s.set(T,g),function(){if(_){if(c)throw new Error($t(6));_=!1,l(),s.delete(T),a=null}}}function m(g){if(!kg(g))throw new Error($t(7));if(typeof g.type>"u")throw new Error($t(8));if(typeof g.type!="string")throw new Error($t(17));if(c)throw new Error($t(9));try{c=!0,i=n(i,g)}finally{c=!1}return(a=s).forEach(T=>{T()}),g}function p(g){if(typeof g!="function")throw new Error($t(10));n=g,m({type:Nu.REPLACE})}function v(){const g=h;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error($t(11));function T(){const j=_;j.next&&j.next(d())}return T(),{unsubscribe:g(T)}},[lx](){return this}}}return m({type:Nu.INIT}),{dispatch:m,subscribe:h,getState:d,replaceReducer:p,[lx]:v}}function QU(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Nu.INIT})>"u")throw new Error($t(12));if(typeof r(void 0,{type:Nu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function aS(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{QU(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const l={};for(let d=0;d<n.length;d++){const h=n[d],m=r[h],p=s[h],v=m(p,o);if(typeof v>"u")throw o&&o.type,new Error($t(14));l[h]=v,c=c||v!==p}return c=c||n.length!==Object.keys(s).length,c?l:s}}function ju(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function JU(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error($t(15))};const s={getState:i.getState,dispatch:(c,...l)=>a(c,...l)},o=t.map(c=>c(s));return a=ju(...o)(i.dispatch),{...i,dispatch:a}}}function sS(t){return kg(t)&&"type"in t&&typeof t.type=="string"}function oS(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var e9=oS(),t9=oS,r9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ju:ju.apply(null,arguments)};function zr(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Er(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>sS(n)&&n.type===t,r}var cS=class No extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,No.prototype)}static get[Symbol.species](){return No}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new No(...e[0].concat(this)):new No(...e.concat(this))}};function ux(t){return Gn(t)?Se(t,()=>{}):t}function Pl(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function n9(t){return typeof t=="boolean"}var i9=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new cS;return r&&(n9(r)?s.push(e9):s.push(t9(r.extraArgument))),s},a9="RTK_autoBatch",dx=t=>e=>{setTimeout(e,t)},s9=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:dx(10):t.type==="callback"?t.queueNotification:dx(t.timeout),l=()=>{s=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const h=()=>i&&d(),m=n.subscribe(h);return o.add(d),()=>{m(),o.delete(d)}},dispatch(d){try{return i=!d?.meta?.[a9],a=!i,a&&(s||(s=!0,c(l))),n.dispatch(d)}finally{i=!0}}})},o9=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new cS(t);return n&&i.push(s9(typeof n=="object"?n:void 0)),i};function c9(t){const e=i9(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(kg(r))o=aS(r);else throw new Error(Er(1));let c;typeof n=="function"?c=n(e):c=e();let l=ju;i&&(l=r9({trace:!1,...typeof i=="object"&&i}));const d=JU(...c),h=o9(d);let m=typeof s=="function"?s(h):h();const p=l(...m);return iS(o,a,p)}function lS(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Er(28));if(o in e)throw new Error(Er(29));return e[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function l9(t){return typeof t=="function"}function u9(t,e){let[r,n,i]=lS(e),a;if(l9(t))a=()=>ux(t());else{const o=ux(t);a=()=>o}function s(o=a(),c){let l=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return l.filter(d=>!!d).length===0&&(l=[i]),l.reduce((d,h)=>{if(h)if(Ta(d)){const p=h(d,c);return p===void 0?d:p}else{if(Gn(d))return Se(d,m=>h(m,c));{const m=h(d,c);if(m===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return d},o)}return s.getInitialState=a,s}var d9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",h9=(t=21)=>{let e="",r=t;for(;r--;)e+=d9[Math.random()*64|0];return e},f9=Symbol.for("rtk-slice-createasyncthunk");function m9(t,e){return`${t}/${e}`}function p9({creators:t}={}){const e=t?.asyncThunk?.[f9];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Er(11));const s=(typeof n.reducers=="function"?n.reducers(y9()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(E,j){const R=typeof E=="string"?E:E.type;if(!R)throw new Error(Er(12));if(R in c.sliceCaseReducersByType)throw new Error(Er(13));return c.sliceCaseReducersByType[R]=j,l},addMatcher(E,j){return c.sliceMatchers.push({matcher:E,reducer:j}),l},exposeAction(E,j){return c.actionCreators[E]=j,l},exposeCaseReducer(E,j){return c.sliceCaseReducersByName[E]=j,l}};o.forEach(E=>{const j=s[E],R={reducerName:E,type:m9(i,E),createNotation:typeof n.reducers=="function"};b9(j)?w9(R,j,l,e):v9(R,j,l)});function d(){const[E={},j=[],R=void 0]=typeof n.extraReducers=="function"?lS(n.extraReducers):[n.extraReducers],D={...E,...c.sliceCaseReducersByType};return u9(n.initialState,S=>{for(let A in D)S.addCase(A,D[A]);for(let A of c.sliceMatchers)S.addMatcher(A.matcher,A.reducer);for(let A of j)S.addMatcher(A.matcher,A.reducer);R&&S.addDefaultCase(R)})}const h=E=>E,m=new Map,p=new WeakMap;let v;function b(E,j){return v||(v=d()),v(E,j)}function g(){return v||(v=d()),v.getInitialState()}function _(E,j=!1){function R(S){let A=S[E];return typeof A>"u"&&j&&(A=Pl(p,R,g)),A}function D(S=h){const A=Pl(m,j,()=>new WeakMap);return Pl(A,S,()=>{const P={};for(const[O,N]of Object.entries(n.selectors??{}))P[O]=g9(N,S,()=>Pl(p,S,g),j);return P})}return{reducerPath:E,getSelectors:D,get selectors(){return D(R)},selectSlice:R}}const T={name:i,reducer:b,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,..._(a),injectInto(E,{reducerPath:j,...R}={}){const D=j??a;return E.inject({reducerPath:D,reducer:b},R),{...T,..._(D,!0)}}};return T}}function g9(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var Br=p9();function y9(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function v9({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!x9(n))throw new Error(Er(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?zr(t,s):zr(t))}function b9(t){return t._reducerDefinitionType==="asyncThunk"}function x9(t){return t._reducerDefinitionType==="reducerWithPrepare"}function w9({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Er(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:l,options:d}=r,h=i(t,a,d);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),c&&n.addCase(h.rejected,c),l&&n.addMatcher(h.settled,l),n.exposeCaseReducer(e,{fulfilled:s||Cl,pending:o||Cl,rejected:c||Cl,settled:l||Cl})}function Cl(){}var _9="task",uS="listener",dS="completed",Ng="cancelled",E9=`task-${Ng}`,T9=`task-${dS}`,xm=`${uS}-${Ng}`,A9=`${uS}-${dS}`,nh=class{constructor(t){Nr(this,"name","TaskAbortError");Nr(this,"message");this.code=t,this.message=`${_9} ${Ng} (reason: ${t})`}},jg=(t,e)=>{if(typeof t!="function")throw new TypeError(Er(32))},Ou=()=>{},hS=(t,e=Ou)=>(t.catch(e),t),fS=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),ba=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},xa=t=>{if(t.aborted){const{reason:e}=t;throw new nh(e)}};function mS(t,e){let r=Ou;return new Promise((n,i)=>{const a=()=>i(new nh(t.reason));if(t.aborted){a();return}r=fS(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=Ou})}var S9=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof nh?"cancelled":"rejected",error:r}}finally{e?.()}},Ru=t=>e=>hS(mS(t,e).then(r=>(xa(t),r))),pS=t=>{const e=Ru(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:ws}=Object,hx={},ih="listenerMiddleware",I9=(t,e)=>{const r=n=>fS(t,()=>ba(n,t.reason));return(n,i)=>{jg(n);const a=new AbortController;r(a);const s=S9(async()=>{xa(t),xa(a.signal);const o=await n({pause:Ru(a.signal),delay:pS(a.signal),signal:a.signal});return xa(a.signal),o},()=>ba(a,T9));return i?.autoJoin&&e.push(s.catch(Ou)),{result:Ru(t)(s),cancel(){ba(a,E9)}}}},P9=(t,e)=>{const r=async(n,i)=>{xa(e);let a=()=>{};const o=[new Promise((c,l)=>{let d=t({predicate:n,effect:(h,m)=>{m.unsubscribe(),c([h,m.getState(),m.getOriginalState()])}});a=()=>{d(),l()}})];i!=null&&o.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await mS(e,Promise.race(o));return xa(e),c}finally{a()}};return(n,i)=>hS(r(n,i))},gS=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=zr(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Er(21));return jg(a),{predicate:i,type:e,effect:a}},yS=ws(t=>{const{type:e,predicate:r,effect:n}=gS(t);return{id:h9(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Er(22))}}},{withTypes:()=>yS}),fx=(t,e)=>{const{type:r,effect:n,predicate:i}=gS(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},wm=t=>{t.pending.forEach(e=>{ba(e,xm)})},C9=t=>()=>{t.forEach(wm),t.clear()},mx=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},vS=ws(zr(`${ih}/add`),{withTypes:()=>vS}),k9=zr(`${ih}/removeAll`),bS=ws(zr(`${ih}/remove`),{withTypes:()=>bS}),N9=(...t)=>{console.error(`${ih}/error`,...t)},kc=(t={})=>{const e=new Map,{extra:r,onError:n=N9}=t;jg(n);const i=d=>(d.unsubscribe=()=>e.delete(d.id),e.set(d.id,d),h=>{d.unsubscribe(),h?.cancelActive&&wm(d)}),a=d=>{const h=fx(e,d)??yS(d);return i(h)};ws(a,{withTypes:()=>a});const s=d=>{const h=fx(e,d);return h&&(h.unsubscribe(),d.cancelActive&&wm(h)),!!h};ws(s,{withTypes:()=>s});const o=async(d,h,m,p)=>{const v=new AbortController,b=P9(a,v.signal),g=[];try{d.pending.add(v),await Promise.resolve(d.effect(h,ws({},m,{getOriginalState:p,condition:(_,T)=>b(_,T).then(Boolean),take:b,delay:pS(v.signal),pause:Ru(v.signal),extra:r,signal:v.signal,fork:I9(v.signal,g),unsubscribe:d.unsubscribe,subscribe:()=>{e.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((_,T,E)=>{_!==v&&(ba(_,xm),E.delete(_))})},cancel:()=>{ba(v,xm),d.pending.delete(v)},throwIfCancelled:()=>{xa(v.signal)}})))}catch(_){_ instanceof nh||mx(n,_,{raisedBy:"effect"})}finally{await Promise.all(g),ba(v,A9),d.pending.delete(v)}},c=C9(e);return{middleware:d=>h=>m=>{if(!sS(m))return h(m);if(vS.match(m))return a(m.payload);if(k9.match(m)){c();return}if(bS.match(m))return s(m.payload);let p=d.getState();const v=()=>{if(p===hx)throw new Error(Er(23));return p};let b;try{if(b=h(m),e.size>0){const g=d.getState(),_=Array.from(e.values());for(const T of _){let E=!1;try{E=T.predicate(m,g,p)}catch(j){E=!1,mx(n,j,{raisedBy:"predicate"})}E&&o(T,m,d,v)}}}finally{p=hx}return b},startListening:a,stopListening:s,clearListeners:c}};function Er(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var j9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},xS=Br({name:"chartLayout",initialState:j9,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:O9,setLayout:R9,setChartSize:D9,setScale:M9}=xS.actions,L9=xS.reducer;function px(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?px(Object(r),!0).forEach(function(n){$9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):px(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $9(t,e,r){return(e=V9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V9(t){var e=z9(t,"string");return typeof e=="symbol"?e:e+""}function z9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Du=Math.PI/180,F9=t=>t*180/Math.PI,Ut=(t,e,r,n)=>({x:t+Math.cos(-Du*n)*r,y:e+Math.sin(-Du*n)*r}),U9=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},B9=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},H9=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,s=B9({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:s,angle:F9(c),angleInRadian:c}},W9=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},q9=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return t+s*360},K9=(t,e)=>{var{x:r,y:n}=t,{radius:i,angle:a}=H9({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(i<s||i>o||i===0)return null;var{startAngle:c,endAngle:l}=W9(e),d=a,h;if(c<=l){for(;d>l;)d-=360;for(;d<c;)d+=360;h=d>=c&&d<=l}else{for(;d>c;)d-=360;for(;d<l;)d+=360;h=d>=l&&d<=c}return h?gx(gx({},e),{},{radius:i,angle:q9(d,e)}):null};function yx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yx(Object(r),!0).forEach(function(n){G9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function G9(t,e,r){return(e=Y9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y9(t){var e=Z9(t,"string");return typeof e=="symbol"?e:e+""}function Z9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e,r){return ut(t)||ut(e)?r:In(e)?Da(t,e,r):typeof e=="function"?e(t):r}var X9=(t,e,r,n,i)=>{var a,s=-1,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var c=0;c<o;c++){var l=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,h=c>=o-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(Lr(d-l)!==Lr(h-d)){var p=[];if(Lr(h-d)===Lr(i[1]-i[0])){m=h;var v=d+i[1]-i[0];p[0]=Math.min(v,(v+l)/2),p[1]=Math.max(v,(v+l)/2)}else{m=l;var b=h+i[1]-i[0];p[0]=Math.min(d,(b+d)/2),p[1]=Math.max(d,(b+d)/2)}var g=[Math.min(d,(m+d)/2),Math.max(d,(m+d)/2)];if(t>g[0]&&t<=g[1]||t>=p[0]&&t<=p[1]){({index:s}=r[c]);break}}else{var _=Math.min(l,h),T=Math.max(l,h);if(t>(_+d)/2&&t<=(T+d)/2){({index:s}=r[c]);break}}}else if(e){for(var E=0;E<o;E++)if(E===0&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E>0&&E<o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E===o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2){({index:s}=e[E]);break}}return s},Q9=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&te(t[a]))return Rr(Rr({},t),{},{[a]:t[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&te(t[s]))return Rr(Rr({},t),{},{[s]:t[s]+(i||0)})}return t},Hi=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",wS=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var i,a,s=t.map(o=>(o.coordinate===e&&(i=!0),o.coordinate===r&&(a=!0),o.coordinate));return i||s.push(e),a||s.push(r),s},_S=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:l,tickCount:d,ticks:h,niceTicks:m,axisType:p}=t;if(!s)return null;var v=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,b=i==="category"&&s.bandwidth?s.bandwidth()/v:0;if(b=p==="angleAxis"&&a&&a.length>=2?Lr(a[0]-a[1])*2*b:b,h||m){var g=(h||m||[]).map((_,T)=>{var E=n?n.indexOf(_):_;return{coordinate:s(E)+b,value:_,offset:b,index:T}});return g.filter(_=>!Vr(_.coordinate))}return c&&l?l.map((_,T)=>({coordinate:s(_)+b,value:_,index:T,offset:b})):s.ticks&&d!=null?s.ticks(d).map((_,T)=>({coordinate:s(_)+b,value:_,offset:b,index:T})):s.domain().map((_,T)=>({coordinate:s(_)+b,value:n?n[_]:_,index:T,offset:b}))},vx=1e-4,J9=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-vx,a=Math.max(n[0],n[1])+vx,s=t(e[0]),o=t(e[r-1]);(s<i||s>a||o<i||o>a)&&t.domain([e[0],e[r-1]])}},eB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0,s=0;s<e;++s){var o=Vr(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1]):(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1])}},tB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0;a<e;++a){var s=Vr(t[a][r][1])?t[a][r][0]:t[a][r][1];s>=0?(t[a][r][0]=i,t[a][r][1]=i+s,i=t[a][r][1]):(t[a][r][0]=0,t[a][r][1]=0)}},rB={sign:eB,expand:cU,none:ks,silhouette:lU,wiggle:uU,positive:tB},nB=(t,e,r)=>{var n=rB[r],i=oU().keys(e).value((a,s)=>+Tr(a,s,0)).order(bm).offset(n);return i(t)};function iB(t){return t==null?void 0:String(t)}function bx(t){var{axis:e,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!ut(i[e.dataKey])){var o=fA(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=Tr(i,ut(s)?e.dataKey:s);return ut(c)?null:e.scale(c)}var aB=t=>{var e=t.flat(2).filter(te);return[Math.min(...e),Math.max(...e)]},sB=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],oB=(t,e,r)=>{if(t!=null)return sB(Object.keys(t).reduce((n,i)=>{var a=t[i],{stackedData:s}=a,o=s.reduce((c,l)=>{var d=aB(l.slice(e,r+1));return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},xx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,_m=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=rh(e,d=>d.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var c=i[s],l=i[s-1];a=Math.min((c.coordinate||0)-(l.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function _x(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Rr(Rr({},e),{},{dataKey:r,payload:n,value:i,name:a})}function ES(t,e){if(t)return String(t);if(typeof e=="string")return e}function cB(t,e,r,n,i){if(r==="horizontal"||r==="vertical"){var a=t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height;return a?{x:t,y:e}:null}return n?K9({x:t,y:e},n):null}var lB=(t,e,r,n)=>{var i=e.find(l=>l&&l.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:i.coordinate};if(t==="centric"){var a=i.coordinate,{radius:s}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:c}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},uB=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ni=t=>t.layout.width,ii=t=>t.layout.height,dB=t=>t.layout.scale,TS=t=>t.layout.margin,Og=V(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Rg=V(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),hB="data-recharts-item-index",fB="data-recharts-item-data-key",ah=60;function Ex(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ex(Object(r),!0).forEach(function(n){mB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ex(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mB(t,e,r){return(e=pB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pB(t){var e=gB(t,"string");return typeof e=="symbol"?e:e+""}function gB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yB=t=>t.brush.height,Ht=V([ni,ii,TS,yB,Og,Rg,nS,KU],(t,e,r,n,i,a,s,o)=>{var c=a.reduce((v,b)=>{var{orientation:g}=b;if(!b.mirror&&!b.hide){var _=typeof b.width=="number"?b.width:ah;return mi(mi({},v),{},{[g]:v[g]+_})}return v},{left:r.left||0,right:r.right||0}),l=i.reduce((v,b)=>{var{orientation:g}=b;return!b.mirror&&!b.hide?mi(mi({},v),{},{[g]:Da(v,"".concat(g))+b.height}):v},{top:r.top||0,bottom:r.bottom||0}),d=mi(mi({},l),c),h=d.bottom;d.bottom+=n,d=Q9(d,s,o);var m=t-d.left-d.right,p=e-d.top-d.bottom;return mi(mi({brushBottom:h},d),{},{width:Math.max(m,0),height:Math.max(p,0)})}),vB=V(Ht,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),AS=V(ni,ii,(t,e)=>({x:0,y:0,width:t,height:e})),bB=w.createContext(null),mr=()=>w.useContext(bB)!=null,sh=t=>t.brush,oh=V([sh,Ht,TS],(t,e,r)=>({height:t.height,x:te(t.x)?t.x:e.left,y:te(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:te(t.width)?t.width:e.width})),Dg=()=>{var t,e=mr(),r=ie(vB),n=ie(oh),i=(t=ie(sh))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},xB={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},SS=()=>{var t;return(t=ie(Ht))!==null&&t!==void 0?t:xB},IS=()=>ie(ni),PS=()=>ie(ii),tt=t=>t.layout.layoutType,Mg=()=>ie(tt),wB={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},CS=Br({name:"legend",initialState:wB,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Bn(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:ZJ,setLegendSettings:XJ,addLegendPayload:_B,removeLegendPayload:EB}=CS.actions,TB=CS.reducer;function Em(){return Em=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Em.apply(null,arguments)}function Tx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ff(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Tx(Object(r),!0).forEach(function(n){AB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Tx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AB(t,e,r){return(e=SB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SB(t){var e=IB(t,"string");return typeof e=="symbol"?e:e+""}function IB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PB(t){return Array.isArray(t)&&In(t[0])&&In(t[1])?t.join(" ~ "):t}var CB=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:l,label:d,labelFormatter:h,accessibilityLayer:m=!1}=t,p=()=>{if(a&&a.length){var R={padding:0,margin:0},D=(o?rh(a,o):a).map((S,A)=>{if(S.type==="none")return null;var P=S.formatter||s||PB,{value:O,name:N}=S,C=O,k=N;if(P){var Q=P(O,N,S,A,a);if(Array.isArray(Q))[C,k]=Q;else if(Q!=null)C=Q;else return null}var ce=ff({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:ce},In(k)?w.createElement("span",{className:"recharts-tooltip-item-name"},k):null,In(k)?w.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,w.createElement("span",{className:"recharts-tooltip-item-value"},C),w.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:R},D)}return null},v=ff({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=ff({margin:0},i),g=!ut(d),_=g?d:"",T=Le("recharts-default-tooltip",c),E=Le("recharts-tooltip-label",l);g&&h&&a!==void 0&&a!==null&&(_=h(d,a));var j=m?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",Em({className:T,style:v},j),w.createElement("p",{className:E,style:b},w.isValidElement(_)?_:"".concat(_)),p())},yo="recharts-tooltip-wrapper",kB={visibility:"hidden"};function NB(t){var{coordinate:e,translateX:r,translateY:n}=t;return Le(yo,{["".concat(yo,"-right")]:te(r)&&e&&te(e.x)&&r>=e.x,["".concat(yo,"-left")]:te(r)&&e&&te(e.x)&&r<e.x,["".concat(yo,"-bottom")]:te(n)&&e&&te(e.y)&&n>=e.y,["".concat(yo,"-top")]:te(n)&&e&&te(e.y)&&n<e.y})}function Ax(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:l}=t;if(a&&te(a[n]))return a[n];var d=r[n]-o-(i>0?i:0),h=r[n]+i;if(e[n])return s[n]?d:h;var m=c[n];if(m==null)return 0;if(s[n]){var p=d,v=m;return p<v?Math.max(h,m):Math.max(d,m)}if(l==null)return 0;var b=h+o,g=m+l;return b>g?Math.max(d,m):Math.max(h,m)}function jB(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function OB(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:c}=t,l,d,h;return s.height>0&&s.width>0&&r?(d=Ax({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),h=Ax({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),l=jB({translateX:d,translateY:h,useTranslate3d:o})):l=kB,{cssProperties:l,cssClasses:NB({translateX:d,translateY:h,coordinate:r})}}function Sx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sx(Object(r),!0).forEach(function(n){Tm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tm(t,e,r){return(e=RB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RB(t){var e=DB(t,"string");return typeof e=="symbol"?e:e+""}function DB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MB extends w.PureComponent{constructor(){super(...arguments),Tm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Tm(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:c,offset:l,position:d,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:v,lastBoundingBox:b,innerRef:g,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:E}=OB({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:l,position:d,reverseDirection:h,tooltipBox:{height:b.height,width:b.width},useTranslate3d:m,viewBox:p}),j=_?{}:kl(kl({transition:c&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),R=kl(kl({},j),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},v);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:R,ref:g},a)}}var LB=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Nc={isSsr:LB()},kS=()=>ie(t=>t.rootProps.accessibilityLayer);function tn(t){return Number.isFinite(t)}function Mu(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Am(){return Am=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Am.apply(null,arguments)}function Ix(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Px(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ix(Object(r),!0).forEach(function(n){$B(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ix(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $B(t,e,r){return(e=VB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VB(t){var e=zB(t,"string");return typeof e=="symbol"?e:e+""}function zB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cx={curveBasisClosed:ZF,curveBasisOpen:XF,curveBasis:YF,curveBumpX:KF,curveBumpY:GF,curveLinearClosed:QF,curveLinear:Yd,curveMonotoneX:JF,curveMonotoneY:eU,curveNatural:tU,curveStep:rU,curveStepAfter:iU,curveStepBefore:nU},Nl=t=>tn(t.x)&&tn(t.y),vo=t=>t.x,bo=t=>t.y,FB=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(gg(t));return(r==="curveMonotone"||r==="curveBump")&&e?Cx["".concat(r).concat(e==="vertical"?"Y":"X")]:Cx[r]||Yd},UB=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,s=FB(e,i),o=a?r.filter(Nl):r,c;if(Array.isArray(n)){var l=a?n.filter(h=>Nl(h)):n,d=o.map((h,m)=>Px(Px({},h),{},{base:l[m]}));return i==="vertical"?c=Al().y(bo).x1(vo).x0(h=>h.base.x):c=Al().x(vo).y1(bo).y0(h=>h.base.y),c.defined(Nl).curve(s),c(d)}return i==="vertical"&&te(n)?c=Al().y(bo).x1(vo).x0(n):te(n)?c=Al().x(vo).y1(bo).y0(n):c=EA().x(vo).y(bo),c.defined(Nl).curve(s),c(o)},NS=t=>{var{className:e,points:r,path:n,pathRef:i}=t;if((!r||!r.length)&&!n)return null;var a=r&&r.length?UB(t):n;return w.createElement("path",Am({},Ke(t,!1),vg(t),{className:Le("recharts-curve",e),d:a===null?void 0:a,ref:i}))},BB=["x","y","top","left","width","height","className"];function Sm(){return Sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Sm.apply(null,arguments)}function kx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function HB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kx(Object(r),!0).forEach(function(n){WB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function WB(t,e,r){return(e=qB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qB(t){var e=KB(t,"string");return typeof e=="symbol"?e:e+""}function KB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GB(t,e){if(t==null)return{};var r,n,i=YB(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function YB(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var ZB=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),XB=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=t,c=GB(t,BB),l=HB({x:e,y:r,top:n,left:i,width:a,height:s},c);return!te(e)||!te(r)||!te(a)||!te(s)||!te(n)||!te(i)?null:w.createElement("path",Sm({},Ke(l,!0),{className:Le("recharts-cross",o),d:ZB(e,r,a,s,n,i)}))};function QB(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Nx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function JB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nx(Object(r),!0).forEach(function(n){e8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function e8(t,e,r){return(e=t8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t8(t){var e=r8(t,"string");return typeof e=="symbol"?e:e+""}function r8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qa(t,e){var r=JB({},t),n=e,i=Object.keys(e),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var jS={},OS={},RS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}t.isPlainObject=e})(RS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RS,r=Ag,n=Jd,i=eh,a=Qd;function s(l,d,h){return o(l,d,void 0,void 0,void 0,void 0,h)}function o(l,d,h,m,p,v,b){const g=b(l,d,h,m,p,v);if(g!==void 0)return g;if(typeof l==typeof d)switch(typeof l){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return l===d;case"number":return l===d||Object.is(l,d);case"function":return l===d;case"object":return c(l,d,v,b)}return c(l,d,v,b)}function c(l,d,h,m){if(Object.is(l,d))return!0;let p=n.getTag(l),v=n.getTag(d);if(p===i.argumentsTag&&(p=i.objectTag),v===i.argumentsTag&&(v=i.objectTag),p!==v)return!1;switch(p){case i.stringTag:return l.toString()===d.toString();case i.numberTag:{const _=l.valueOf(),T=d.valueOf();return a.eq(_,T)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(l.valueOf(),d.valueOf());case i.regexpTag:return l.source===d.source&&l.flags===d.flags;case i.functionTag:return l===d}h=h??new Map;const b=h.get(l),g=h.get(d);if(b!=null&&g!=null)return b===d;h.set(l,d),h.set(d,l);try{switch(p){case i.mapTag:{if(l.size!==d.size)return!1;for(const[_,T]of l.entries())if(!d.has(_)||!o(T,d.get(_),_,l,d,h,m))return!1;return!0}case i.setTag:{if(l.size!==d.size)return!1;const _=Array.from(l.values()),T=Array.from(d.values());for(let E=0;E<_.length;E++){const j=_[E],R=T.findIndex(D=>o(j,D,void 0,l,d,h,m));if(R===-1)return!1;T.splice(R,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(l)!==Buffer.isBuffer(d)||l.length!==d.length)return!1;for(let _=0;_<l.length;_++)if(!o(l[_],d[_],_,l,d,h,m))return!1;return!0}case i.arrayBufferTag:return l.byteLength!==d.byteLength?!1:c(new Uint8Array(l),new Uint8Array(d),h,m);case i.dataViewTag:return l.byteLength!==d.byteLength||l.byteOffset!==d.byteOffset?!1:c(new Uint8Array(l),new Uint8Array(d),h,m);case i.errorTag:return l.name===d.name&&l.message===d.message;case i.objectTag:{if(!(c(l.constructor,d.constructor,h,m)||e.isPlainObject(l)&&e.isPlainObject(d)))return!1;const T=[...Object.keys(l),...r.getSymbols(l)],E=[...Object.keys(d),...r.getSymbols(d)];if(T.length!==E.length)return!1;for(let j=0;j<T.length;j++){const R=T[j],D=l[R];if(!Object.hasOwn(d,R))return!1;const S=d[R];if(!o(D,S,R,l,d,h,m))return!1}return!0}default:return!1}}finally{h.delete(l),h.delete(d)}}t.isEqualWith=s})(OS);var DS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(DS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OS,r=DS;function n(i,a){return e.isEqualWith(i,a,r.noop)}t.isEqual=n})(jS);var n8=jS.isEqual;const i8=zi(n8);function a8(t){var e={},r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...l]=o;if(typeof c=="number"){i=t.setTimeout(a.bind(null,l),c);return}a(c),i=t.setTimeout(a.bind(null,l));return}typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}var Lu=1e-4,MS=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],LS=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),jx=(t,e)=>r=>{var n=MS(t,e);return LS(n,r)},s8=(t,e)=>r=>{var n=MS(t,e),i=[...n.map((a,s)=>a*s).slice(1),0];return LS(i,r)},Ox=function(){for(var e,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,i]=[0,0,1,1];break;case"ease":[e,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,i]=[.42,0,1,1];break;case"ease-out":[e,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,i]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([e,n,r,i]=c[1].split(")")[0].split(",").map(v=>parseFloat(v)))}}else s.length===4&&([e,n,r,i]=s);var l=jx(e,r),d=jx(n,i),h=s8(e,r),m=v=>v>1?1:v<0?0:v,p=v=>{for(var b=v>1?1:v,g=b,_=0;_<8;++_){var T=l(g)-b,E=h(g);if(Math.abs(T-b)<Lu||E<Lu)return d(g);g=m(g-T/E)}return d(g)};return p.isStepper=!1,p},o8=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(s,o,c)=>{var l=-(s-o)*r,d=c*n,h=c+(l-d)*i/1e3,m=c*i/1e3+s;return Math.abs(m-o)<Lu&&Math.abs(h)<Lu?[o,0]:[m,h]};return a.isStepper=!0,a.dt=i,a},c8=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Ox(t);case"spring":return o8();default:if(t.split("(")[0]==="cubic-bezier")return Ox(t)}return typeof t=="function"?t:null};function Rx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Dx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rx(Object(r),!0).forEach(function(n){l8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function l8(t,e,r){return(e=u8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u8(t){var e=d8(t,"string");return typeof e=="symbol"?e:e+""}function d8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h8=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),f8=(t,e,r)=>t.map(n=>"".concat(h8(n)," ").concat(e,"ms ").concat(r)).join(","),m8=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),oc=(t,e)=>Object.keys(e).reduce((r,n)=>Dx(Dx({},r),{},{[n]:t(n,e[n])}),{});function Mx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mx(Object(r),!0).forEach(function(n){p8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function p8(t,e,r){return(e=g8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g8(t){var e=y8(t,"string");return typeof e=="symbol"?e:e+""}function y8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $u=(t,e,r)=>t+(e-t)*r,Im=t=>{var{from:e,to:r}=t;return e!==r},$S=(t,e,r)=>{var n=oc((i,a)=>{if(Im(a)){var[s,o]=t(a.from,a.to,a.velocity);return zt(zt({},a),{},{from:s,velocity:o})}return a},e);return r<1?oc((i,a)=>Im(a)?zt(zt({},a),{},{velocity:$u(a.velocity,n[i].velocity,r),from:$u(a.from,n[i].from,r)}):a,e):$S(t,n,r-1)};function v8(t,e,r,n,i,a){var s,o=n.reduce((m,p)=>zt(zt({},m),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),c=()=>oc((m,p)=>p.from,o),l=()=>!Object.values(o).filter(Im).length,d=null,h=m=>{s||(s=m);var p=m-s,v=p/r.dt;o=$S(r,o,v),i(zt(zt(zt({},t),e),c())),s=m,l()||(d=a.setTimeout(h))};return()=>(d=a.setTimeout(h),()=>{d()})}function b8(t,e,r,n,i,a,s){var o=null,c=i.reduce((h,m)=>zt(zt({},h),{},{[m]:[t[m],e[m]]}),{}),l,d=h=>{l||(l=h);var m=(h-l)/n,p=oc((b,g)=>$u(...g,r(m)),c);if(a(zt(zt(zt({},t),e),p)),m<1)o=s.setTimeout(d);else{var v=oc((b,g)=>$u(...g,r(1)),c);a(zt(zt(zt({},t),e),v))}};return()=>(o=s.setTimeout(d),()=>{o()})}const x8=(t,e,r,n,i,a)=>{var s=m8(t,e);return r.isStepper===!0?v8(t,e,r,s,i,a):b8(t,e,r,n,s,i,a)};class w8{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}var _8=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Pm(){return Pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pm.apply(null,arguments)}function E8(t,e){if(t==null)return{};var r,n,i=T8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function T8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Lx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lx(Object(r),!0).forEach(function(n){ha(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ha(t,e,r){return(e=A8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A8(t){var e=S8(t,"string");return typeof e=="symbol"?e:e+""}function S8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I8(){return a8(new w8)}class Lg extends w.PureComponent{constructor(e,r){super(e,r),ha(this,"mounted",!1),ha(this,"manager",null),ha(this,"stopJSAnimation",null),ha(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:c,animationManager:l}=this.props;if(this.manager=l,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||c<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:r}=this.props;this.mounted=!0,!(!e||!r)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:c}=this.state;if(n){if(!r){var l={style:i?{[i]:s}:s};this.state&&c&&(i&&c[i]!==s||!i&&c!==s)&&this.setState(l);return}if(!(i8(e.to,s)&&e.canBegin&&e.isActive)){var d=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=d||a?o:e.to;if(this.state&&c){var m={style:i?{[i]:h}:h};(i&&c[i]!==h||!i&&c!==h)&&this.setState(m)}this.runAnimation(pi(pi({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:c}=e,l=x8(r,n,c8(a),i,this.changeStyle,this.manager.getTimeoutController()),d=()=>{this.stopJSAnimation=l()};this.manager.start([c,s,d,i,o])}runAnimation(e){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:c,children:l}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof l=="function"||s==="spring"){this.runJSAnimation(e);return}var d=i?{[i]:a}:a,h=f8(Object.keys(d),n,s);this.manager.start([o,r,pi(pi({},d),{},{transition:h}),n,c])}render(){var e=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:c,to:l,canBegin:d,onAnimationEnd:h,shouldReAnimate:m,onAnimationReStart:p,animationManager:v}=e,b=E8(e,_8),g=w.Children.count(r),_=this.state.style;if(typeof r=="function")return r(_);if(!o||g===0||i<=0)return r;var T=E=>{var{style:j={},className:R}=E.props,D=w.cloneElement(E,pi(pi({},b),{},{style:pi(pi({},j),_),className:R}));return D};return g===1?T(w.Children.only(r)):w.createElement("div",null,w.Children.map(r,E=>T(E)))}}ha(Lg,"displayName","Animate");ha(Lg,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var P8=w.createContext(null);function Vu(t){var e,r,n=w.useContext(P8);return w.createElement(Lg,Pm({},t,{animationManager:(e=(r=t.animationManager)!==null&&r!==void 0?r:n)!==null&&e!==void 0?e:I8()}))}function zu(){return zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zu.apply(null,arguments)}var $x=(t,e,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,l;if(a>0&&i instanceof Array){for(var d=[0,0,0,0],h=0,m=4;h<m;h++)d[h]=i[h]>a?a:i[h];l="M".concat(t,",").concat(e+s*d[0]),d[0]>0&&(l+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(t+o*d[0],",").concat(e)),l+="L ".concat(t+r-o*d[1],",").concat(e),d[1]>0&&(l+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(t+r,",").concat(e+s*d[1])),l+="L ".concat(t+r,",").concat(e+n-s*d[2]),d[2]>0&&(l+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(t+r-o*d[2],",").concat(e+n)),l+="L ".concat(t+o*d[3],",").concat(e+n),d[3]>0&&(l+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(e+n-s*d[3])),l+="Z"}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);l="M ".concat(t,",").concat(e+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+o*p,",").concat(e,`
            L `).concat(t+r-o*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r,",").concat(e+s*p,`
            L `).concat(t+r,",").concat(e+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r-o*p,",").concat(e+n,`
            L `).concat(t+o*p,",").concat(e+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t,",").concat(e+n-s*p," Z")}else l="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return l},C8={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},k8=t=>{var e=qa(t,C8),r=w.useRef(null),[n,i]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&i(_)}catch{}},[]);var{x:a,y:s,width:o,height:c,radius:l,className:d}=e,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:v,isUpdateAnimationActive:b}=e;if(a!==+a||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var g=Le("recharts-rectangle",d);return b?w.createElement(Vu,{canBegin:n>0,from:{width:o,height:c,x:a,y:s},to:{width:o,height:c,x:a,y:s},duration:m,animationEasing:h,isActive:b},_=>{var{width:T,height:E,x:j,y:R}=_;return w.createElement(Vu,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:m,isActive:v,easing:h},w.createElement("path",zu({},Ke(e,!0),{className:g,d:$x(j,R,T,E,l),ref:r})))}):w.createElement("path",zu({},Ke(e,!0),{className:g,d:$x(a,s,o,c,l)}))};function VS(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,s=Ut(e,r,n,i),o=Ut(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function Cm(){return Cm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cm.apply(null,arguments)}var N8=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},jl=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:c}=t,l=o*(s?1:-1)+n,d=Math.asin(o/l)/Du,h=c?i:i+a*d,m=Ut(e,r,l,h),p=Ut(e,r,n,h),v=c?i-a*d:i,b=Ut(e,r,l*Math.cos(d*Du),v);return{center:m,circleTangency:p,lineTangency:b,theta:d}},zS=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=t,o=N8(a,s),c=a+o,l=Ut(e,r,i,a),d=Ut(e,r,i,c),h="M ".concat(l.x,",").concat(l.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var m=Ut(e,r,n,a),p=Ut(e,r,n,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},j8=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:l}=t,d=Lr(l-c),{circleTangency:h,lineTangency:m,theta:p}=jl({cx:e,cy:r,radius:i,angle:c,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:v,lineTangency:b,theta:g}=jl({cx:e,cy:r,radius:i,angle:l,sign:-d,cornerRadius:a,cornerIsExternal:o}),_=o?Math.abs(c-l):Math.abs(c-l)-p-g;if(_<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):zS({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:l});var T="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:j,theta:R}=jl({cx:e,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:D,lineTangency:S,theta:A}=jl({cx:e,cy:r,radius:n,angle:l,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(c-l):Math.abs(c-l)-R-A;if(P<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+="L".concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(d>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(j.x,",").concat(j.y,"Z")}else T+="L".concat(e,",").concat(r,"Z");return T},O8={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},R8=t=>{var e=qa(t,O8),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:d,className:h}=e;if(a<i||l===d)return null;var m=Le("recharts-sector",h),p=a-i,v=$i(s,p,0,!0),b;return v>0&&Math.abs(l-d)<360?b=j8({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:d}):b=zS({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:l,endAngle:d}),w.createElement("path",Cm({},Ke(e,!0),{className:m,d:b}))};function D8(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:c,innerRadius:l,outerRadius:d,angle:h}=e,m=Ut(o,c,l,h),p=Ut(o,c,d,h);n=m.x,i=m.y,a=p.x,s=p.y}else return VS(e);return[{x:n,y:i},{x:a,y:s}]}var FS={},US={},BS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pg;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(BS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=BS;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(US);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cg,r=US;function n(i,a,s){s&&typeof s!="number"&&e.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),c=new Array(o);for(let l=0;l<o;l++)c[l]=i,i+=s;return c}t.range=n})(FS);var M8=FS.range;const HS=zi(M8);function ki(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function L8(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function $g(t){let e,r,n;t.length!==2?(e=ki,r=(o,c)=>ki(t(o),c),n=(o,c)=>t(o)-c):(e=t===ki||t===L8?t:$8,r=t,n=t);function i(o,c,l=0,d=o.length){if(l<d){if(e(c,c)!==0)return d;do{const h=l+d>>>1;r(o[h],c)<0?l=h+1:d=h}while(l<d)}return l}function a(o,c,l=0,d=o.length){if(l<d){if(e(c,c)!==0)return d;do{const h=l+d>>>1;r(o[h],c)<=0?l=h+1:d=h}while(l<d)}return l}function s(o,c,l=0,d=o.length){const h=i(o,c,l,d-1);return h>l&&n(o[h-1],c)>-n(o[h],c)?h-1:h}return{left:i,center:s,right:a}}function $8(){return 0}function WS(t){return t===null?NaN:+t}function*V8(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const z8=$g(ki),jc=z8.right;$g(WS).center;class Vx extends Map{constructor(e,r=B8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(zx(this,e))}has(e){return super.has(zx(this,e))}set(e,r){return super.set(F8(this,e),r)}delete(e){return super.delete(U8(this,e))}}function zx({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function F8({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function U8({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function B8(t){return t!==null&&typeof t=="object"?t.valueOf():t}function H8(t=ki){if(t===ki)return qS;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function qS(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const W8=Math.sqrt(50),q8=Math.sqrt(10),K8=Math.sqrt(2);function Fu(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=W8?10:a>=q8?5:a>=K8?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),c=Math.round(e*l),o/l<t&&++o,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),c=Math.round(e/l),o*l<t&&++o,c*l>e&&--c),c<o&&.5<=r&&r<2?Fu(t,e,r*2):[o,c,l]}function km(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?Fu(e,t,r):Fu(t,e,r);if(!(a>=i))return[];const o=a-i+1,c=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)c[l]=(a-l)/-s;else for(let l=0;l<o;++l)c[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(i+l)/-s;else for(let l=0;l<o;++l)c[l]=(i+l)*s;return c}function Nm(t,e,r){return e=+e,t=+t,r=+r,Fu(t,e,r)[2]}function jm(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?Nm(e,t,r):Nm(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function Fx(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Ux(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function KS(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?qS:H8(i);n>r;){if(n-r>600){const c=n-r+1,l=e-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*h*(c-h)/c)*(l-c/2<0?-1:1),p=Math.max(r,Math.floor(e-l*h/c+m)),v=Math.min(n,Math.floor(e+(c-l)*h/c+m));KS(t,e,p,v,i)}const a=t[e];let s=r,o=n;for(xo(t,r,e),i(t[n],a)>0&&xo(t,r,n);s<o;){for(xo(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?xo(t,r,o):(++o,xo(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function xo(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function G8(t,e,r){if(t=Float64Array.from(V8(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return Ux(t);if(e>=1)return Fx(t);var n,i=(n-1)*e,a=Math.floor(i),s=Fx(KS(t,a).subarray(0,a+1)),o=Ux(t.subarray(a+1));return s+(o-s)*(i-a)}}function Y8(t,e,r=WS){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function Z8(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Hr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ai(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Om=Symbol("implicit");function Vg(){var t=new Vx,e=[],r=[],n=Om;function i(a){let s=t.get(a);if(s===void 0){if(n!==Om)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new Vx;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return Vg(e,r).unknown(n)},Hr.apply(i,arguments),i}function zg(){var t=Vg().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,c=0,l=0,d=.5;delete t.unknown;function h(){var m=e().length,p=i<n,v=p?i:n,b=p?n:i;a=(b-v)/Math.max(1,m-c+l*2),o&&(a=Math.floor(a)),v+=(b-v-a*(m-c))*d,s=a*(1-c),o&&(v=Math.round(v),s=Math.round(s));var g=Z8(m).map(function(_){return v+a*_});return r(p?g.reverse():g)}return t.domain=function(m){return arguments.length?(e(m),h()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(m){return arguments.length?(o=!!m,h()):o},t.padding=function(m){return arguments.length?(c=Math.min(1,l=+m),h()):c},t.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),h()):c},t.paddingOuter=function(m){return arguments.length?(l=+m,h()):l},t.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),h()):d},t.copy=function(){return zg(e(),[n,i]).round(o).paddingInner(c).paddingOuter(l).align(d)},Hr.apply(h(),arguments)}function GS(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return GS(e())},t}function X8(){return GS(zg.apply(null,arguments).paddingInner(1))}function Fg(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function YS(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Oc(){}var cc=.7,Uu=1/cc,_s="\\s*([+-]?\\d+)\\s*",lc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Q8=/^#([0-9a-f]{3,8})$/,J8=new RegExp(`^rgb\\(${_s},${_s},${_s}\\)$`),eH=new RegExp(`^rgb\\(${wn},${wn},${wn}\\)$`),tH=new RegExp(`^rgba\\(${_s},${_s},${_s},${lc}\\)$`),rH=new RegExp(`^rgba\\(${wn},${wn},${wn},${lc}\\)$`),nH=new RegExp(`^hsl\\(${lc},${wn},${wn}\\)$`),iH=new RegExp(`^hsla\\(${lc},${wn},${wn},${lc}\\)$`),Bx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fg(Oc,uc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Hx,formatHex:Hx,formatHex8:aH,formatHsl:sH,formatRgb:Wx,toString:Wx});function Hx(){return this.rgb().formatHex()}function aH(){return this.rgb().formatHex8()}function sH(){return ZS(this).formatHsl()}function Wx(){return this.rgb().formatRgb()}function uc(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Q8.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?qx(e):r===3?new ur(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ol(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ol(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=J8.exec(t))?new ur(e[1],e[2],e[3],1):(e=eH.exec(t))?new ur(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tH.exec(t))?Ol(e[1],e[2],e[3],e[4]):(e=rH.exec(t))?Ol(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=nH.exec(t))?Yx(e[1],e[2]/100,e[3]/100,1):(e=iH.exec(t))?Yx(e[1],e[2]/100,e[3]/100,e[4]):Bx.hasOwnProperty(t)?qx(Bx[t]):t==="transparent"?new ur(NaN,NaN,NaN,0):null}function qx(t){return new ur(t>>16&255,t>>8&255,t&255,1)}function Ol(t,e,r,n){return n<=0&&(t=e=r=NaN),new ur(t,e,r,n)}function oH(t){return t instanceof Oc||(t=uc(t)),t?(t=t.rgb(),new ur(t.r,t.g,t.b,t.opacity)):new ur}function Rm(t,e,r,n){return arguments.length===1?oH(t):new ur(t,e,r,n??1)}function ur(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Fg(ur,Rm,YS(Oc,{brighter(t){return t=t==null?Uu:Math.pow(Uu,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?cc:Math.pow(cc,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ur(wa(this.r),wa(this.g),wa(this.b),Bu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kx,formatHex:Kx,formatHex8:cH,formatRgb:Gx,toString:Gx}));function Kx(){return`#${fa(this.r)}${fa(this.g)}${fa(this.b)}`}function cH(){return`#${fa(this.r)}${fa(this.g)}${fa(this.b)}${fa((isNaN(this.opacity)?1:this.opacity)*255)}`}function Gx(){const t=Bu(this.opacity);return`${t===1?"rgb(":"rgba("}${wa(this.r)}, ${wa(this.g)}, ${wa(this.b)}${t===1?")":`, ${t})`}`}function Bu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wa(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fa(t){return t=wa(t),(t<16?"0":"")+t.toString(16)}function Yx(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,r,n)}function ZS(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof Oc||(t=uc(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Yr(s,o,c,t.opacity)}function lH(t,e,r,n){return arguments.length===1?ZS(t):new Yr(t,e,r,n??1)}function Yr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Fg(Yr,lH,YS(Oc,{brighter(t){return t=t==null?Uu:Math.pow(Uu,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?cc:Math.pow(cc,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new ur(mf(t>=240?t-240:t+120,i,n),mf(t,i,n),mf(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Yr(Zx(this.h),Rl(this.s),Rl(this.l),Bu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Bu(this.opacity);return`${t===1?"hsl(":"hsla("}${Zx(this.h)}, ${Rl(this.s)*100}%, ${Rl(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Zx(t){return t=(t||0)%360,t<0?t+360:t}function Rl(t){return Math.max(0,Math.min(1,t||0))}function mf(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Ug=t=>()=>t;function uH(t,e){return function(r){return t+r*e}}function dH(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function hH(t){return(t=+t)==1?XS:function(e,r){return r-e?dH(e,r,t):Ug(isNaN(e)?r:e)}}function XS(t,e){var r=e-t;return r?uH(t,r):Ug(isNaN(t)?e:t)}const Xx=function t(e){var r=hH(e);function n(i,a){var s=r((i=Rm(i)).r,(a=Rm(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),l=XS(i.opacity,a.opacity);return function(d){return i.r=s(d),i.g=o(d),i.b=c(d),i.opacity=l(d),i+""}}return n.gamma=t,n}(1);function fH(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function mH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pH(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Hs(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function gH(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Hu(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function yH(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Hs(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var Dm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pf=new RegExp(Dm.source,"g");function vH(t){return function(){return t}}function bH(t){return function(e){return t(e)+""}}function xH(t,e){var r=Dm.lastIndex=pf.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=Dm.exec(t))&&(i=pf.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Hu(n,i)})),r=pf.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?bH(c[0].x):vH(e):(e=c.length,function(l){for(var d=0,h;d<e;++d)o[(h=c[d]).i]=h.x(l);return o.join("")})}function Hs(t,e){var r=typeof e,n;return e==null||r==="boolean"?Ug(e):(r==="number"?Hu:r==="string"?(n=uc(e))?(e=n,Xx):xH:e instanceof uc?Xx:e instanceof Date?gH:mH(e)?fH:Array.isArray(e)?pH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?yH:Hu)(t,e)}function Bg(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function wH(t,e){e===void 0&&(e=t,t=Hs);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function _H(t){return function(){return t}}function Wu(t){return+t}var Qx=[0,1];function ir(t){return t}function Mm(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:_H(isNaN(e)?NaN:.5)}function EH(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function TH(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=Mm(i,n),a=r(s,a)):(n=Mm(n,i),a=r(a,s)),function(o){return a(n(o))}}function AH(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=Mm(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var c=jc(t,o,1,n)-1;return a[c](i[c](o))}}function Rc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ch(){var t=Qx,e=Qx,r=Hs,n,i,a,s=ir,o,c,l;function d(){var m=Math.min(t.length,e.length);return s!==ir&&(s=EH(t[0],t[m-1])),o=m>2?AH:TH,c=l=null,h}function h(m){return m==null||isNaN(m=+m)?a:(c||(c=o(t.map(n),e,r)))(n(s(m)))}return h.invert=function(m){return s(i((l||(l=o(e,t.map(n),Hu)))(m)))},h.domain=function(m){return arguments.length?(t=Array.from(m,Wu),d()):t.slice()},h.range=function(m){return arguments.length?(e=Array.from(m),d()):e.slice()},h.rangeRound=function(m){return e=Array.from(m),r=Bg,d()},h.clamp=function(m){return arguments.length?(s=m?!0:ir,d()):s!==ir},h.interpolate=function(m){return arguments.length?(r=m,d()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,p){return n=m,i=p,d()}}function Hg(){return ch()(ir,ir)}function SH(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function qu(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function js(t){return t=qu(Math.abs(t)),t?t[1]:NaN}function IH(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],c=0;i>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(i-=o,i+o)),!((c+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function PH(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var CH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function dc(t){if(!(e=CH.exec(t)))throw new Error("invalid format: "+t);var e;return new Wg({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}dc.prototype=Wg.prototype;function Wg(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Wg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kH(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var QS;function NH(t,e){var r=qu(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(QS=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+qu(t,Math.max(0,e+a-1))[0]}function Jx(t,e){var r=qu(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const ew={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:SH,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Jx(t*100,e),r:Jx,s:NH,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function tw(t){return t}var rw=Array.prototype.map,nw=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function jH(t){var e=t.grouping===void 0||t.thousands===void 0?tw:IH(rw.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?tw:PH(rw.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(h){h=dc(h);var m=h.fill,p=h.align,v=h.sign,b=h.symbol,g=h.zero,_=h.width,T=h.comma,E=h.precision,j=h.trim,R=h.type;R==="n"?(T=!0,R="g"):ew[R]||(E===void 0&&(E=12),j=!0,R="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var D=b==="$"?r:b==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",S=b==="$"?n:/[%p]/.test(R)?s:"",A=ew[R],P=/[defgprs%]/.test(R);E=E===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function O(N){var C=D,k=S,Q,ce,X;if(R==="c")k=A(N)+k,N="";else{N=+N;var ee=N<0||1/N<0;if(N=isNaN(N)?c:A(Math.abs(N),E),j&&(N=kH(N)),ee&&+N==0&&v!=="+"&&(ee=!1),C=(ee?v==="("?v:o:v==="-"||v==="("?"":v)+C,k=(R==="s"?nw[8+QS/3]:"")+k+(ee&&v==="("?")":""),P){for(Q=-1,ce=N.length;++Q<ce;)if(X=N.charCodeAt(Q),48>X||X>57){k=(X===46?i+N.slice(Q+1):N.slice(Q))+k,N=N.slice(0,Q);break}}}T&&!g&&(N=e(N,1/0));var fe=C.length+N.length+k.length,ye=fe<_?new Array(_-fe+1).join(m):"";switch(T&&g&&(N=e(ye+N,ye.length?_-k.length:1/0),ye=""),p){case"<":N=C+N+k+ye;break;case"=":N=C+ye+N+k;break;case"^":N=ye.slice(0,fe=ye.length>>1)+C+N+k+ye.slice(fe);break;default:N=ye+C+N+k;break}return a(N)}return O.toString=function(){return h+""},O}function d(h,m){var p=l((h=dc(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(js(m)/3)))*3,b=Math.pow(10,-v),g=nw[8+v/3];return function(_){return p(b*_)+g}}return{format:l,formatPrefix:d}}var Dl,qg,JS;OH({thousands:",",grouping:[3],currency:["$",""]});function OH(t){return Dl=jH(t),qg=Dl.format,JS=Dl.formatPrefix,Dl}function RH(t){return Math.max(0,-js(Math.abs(t)))}function DH(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(js(e)/3)))*3-js(Math.abs(t)))}function MH(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,js(e)-js(t))+1}function eI(t,e,r,n){var i=jm(t,e,r),a;switch(n=dc(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=DH(i,s))&&(n.precision=a),JS(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=MH(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=RH(i))&&(n.precision=a-(n.type==="%")*2);break}}return qg(n)}function Wi(t){var e=t.domain;return t.ticks=function(r){var n=e();return km(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return eI(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],c,l,d=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);d-- >0;){if(l=Nm(s,o,r),l===c)return n[i]=s,n[a]=o,e(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return t},t}function tI(){var t=Hg();return t.copy=function(){return Rc(t,tI())},Hr.apply(t,arguments),Wi(t)}function rI(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Wu),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return rI(t).unknown(e)},t=arguments.length?Array.from(t,Wu):[0,1],Wi(r)}function nI(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function iw(t){return Math.log(t)}function aw(t){return Math.exp(t)}function LH(t){return-Math.log(-t)}function $H(t){return-Math.exp(-t)}function VH(t){return isFinite(t)?+("1e"+t):t<0?0:t}function zH(t){return t===10?VH:t===Math.E?Math.exp:e=>Math.pow(t,e)}function FH(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function sw(t){return(e,r)=>-t(-e,r)}function Kg(t){const e=t(iw,aw),r=e.domain;let n=10,i,a;function s(){return i=FH(n),a=zH(n),r()[0]<0?(i=sw(i),a=sw(a),t(LH,$H)):t(iw,aw),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const c=r();let l=c[0],d=c[c.length-1];const h=d<l;h&&([l,d]=[d,l]);let m=i(l),p=i(d),v,b;const g=o==null?10:+o;let _=[];if(!(n%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),l>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/a(-m):v*a(m),!(b<l)){if(b>d)break;_.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/a(-m):v*a(m),!(b<l)){if(b>d)break;_.push(b)}_.length*2<g&&(_=km(l,d,g))}else _=km(m,p,Math.min(p-m,g)).map(a);return h?_.reverse():_},e.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=dc(c)).precision==null&&(c.trim=!0),c=qg(c)),o===1/0)return c;const l=Math.max(1,n*o/e.ticks().length);return d=>{let h=d/a(Math.round(i(d)));return h*n<n-.5&&(h*=n),h<=l?c(d):""}},e.nice=()=>r(nI(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function iI(){const t=Kg(ch()).domain([1,10]);return t.copy=()=>Rc(t,iI()).base(t.base()),Hr.apply(t,arguments),t}function ow(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function cw(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Gg(t){var e=1,r=t(ow(e),cw(e));return r.constant=function(n){return arguments.length?t(ow(e=+n),cw(e)):e},Wi(r)}function aI(){var t=Gg(ch());return t.copy=function(){return Rc(t,aI()).constant(t.constant())},Hr.apply(t,arguments)}function lw(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function UH(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function BH(t){return t<0?-t*t:t*t}function Yg(t){var e=t(ir,ir),r=1;function n(){return r===1?t(ir,ir):r===.5?t(UH,BH):t(lw(r),lw(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Wi(e)}function Zg(){var t=Yg(ch());return t.copy=function(){return Rc(t,Zg()).exponent(t.exponent())},Hr.apply(t,arguments),t}function HH(){return Zg.apply(null,arguments).exponent(.5)}function uw(t){return Math.sign(t)*t*t}function WH(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function sI(){var t=Hg(),e=[0,1],r=!1,n;function i(a){var s=WH(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(uw(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Wu)).map(uw)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return sI(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hr.apply(i,arguments),Wi(i)}function oI(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=Y8(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[jc(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(ki),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return oI().domain(t).range(e).unknown(n)},Hr.apply(a,arguments)}function cI(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(c){return c!=null&&c<=c?i[jc(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return s}return s.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,o()):[t,e]},s.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,o()):i.slice()},s.invertExtent=function(c){var l=i.indexOf(c);return l<0?[NaN,NaN]:l<1?[t,n[0]]:l>=r?[n[r-1],e]:[n[l-1],n[l]]},s.unknown=function(c){return arguments.length&&(a=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return cI().domain([t,e]).range(i).unknown(a)},Hr.apply(Wi(s),arguments)}function lI(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[jc(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return lI().domain(t).range(e).unknown(r)},Hr.apply(i,arguments)}const gf=new Date,yf=new Date;function St(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const c=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return c;let l;do c.push(l=new Date(+a)),e(a,o),t(a);while(l<a&&a<s);return c},i.filter=a=>St(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(gf.setTime(+a),yf.setTime(+s),t(gf),t(yf),Math.floor(r(gf,yf))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const Ku=St(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ku.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?St(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Ku);Ku.range;const Fn=1e3,$r=Fn*60,Un=$r*60,ei=Un*24,Xg=ei*7,dw=ei*30,vf=ei*365,ma=St(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Fn)},(t,e)=>(e-t)/Fn,t=>t.getUTCSeconds());ma.range;const Qg=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fn)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getMinutes());Qg.range;const Jg=St(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getUTCMinutes());Jg.range;const ey=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fn-t.getMinutes()*$r)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getHours());ey.range;const ty=St(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getUTCHours());ty.range;const Dc=St(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$r)/ei,t=>t.getDate()-1);Dc.range;const lh=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>t.getUTCDate()-1);lh.range;const uI=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>Math.floor(t/ei));uI.range;function Ka(t){return St(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*$r)/Xg)}const uh=Ka(0),Gu=Ka(1),qH=Ka(2),KH=Ka(3),Os=Ka(4),GH=Ka(5),YH=Ka(6);uh.range;Gu.range;qH.range;KH.range;Os.range;GH.range;YH.range;function Ga(t){return St(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/Xg)}const dh=Ga(0),Yu=Ga(1),ZH=Ga(2),XH=Ga(3),Rs=Ga(4),QH=Ga(5),JH=Ga(6);dh.range;Yu.range;ZH.range;XH.range;Rs.range;QH.range;JH.range;const ry=St(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());ry.range;const ny=St(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());ny.range;const ti=St(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ti.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ti.range;const ri=St(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ri.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});ri.range;function dI(t,e,r,n,i,a){const s=[[ma,1,Fn],[ma,5,5*Fn],[ma,15,15*Fn],[ma,30,30*Fn],[a,1,$r],[a,5,5*$r],[a,15,15*$r],[a,30,30*$r],[i,1,Un],[i,3,3*Un],[i,6,6*Un],[i,12,12*Un],[n,1,ei],[n,2,2*ei],[r,1,Xg],[e,1,dw],[e,3,3*dw],[t,1,vf]];function o(l,d,h){const m=d<l;m&&([l,d]=[d,l]);const p=h&&typeof h.range=="function"?h:c(l,d,h),v=p?p.range(l,+d+1):[];return m?v.reverse():v}function c(l,d,h){const m=Math.abs(d-l)/h,p=$g(([,,g])=>g).right(s,m);if(p===s.length)return t.every(jm(l/vf,d/vf,h));if(p===0)return Ku.every(Math.max(jm(l,d,h),1));const[v,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return v.every(b)}return[o,c]}const[eW,tW]=dI(ri,ny,dh,uI,ty,Jg),[rW,nW]=dI(ti,ry,uh,Dc,ey,Qg);function bf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function xf(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function wo(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function iW(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,c=t.shortMonths,l=_o(i),d=Eo(i),h=_o(a),m=Eo(a),p=_o(s),v=Eo(s),b=_o(o),g=Eo(o),_=_o(c),T=Eo(c),E={a:ee,A:fe,b:ye,B:Ue,c:null,d:yw,e:yw,f:IW,g:LW,G:VW,H:TW,I:AW,j:SW,L:hI,m:PW,M:CW,p:se,q,Q:xw,s:ww,S:kW,u:NW,U:jW,V:OW,w:RW,W:DW,x:null,X:null,y:MW,Y:$W,Z:zW,"%":bw},j={a:J,A:rt,b:ze,B:Fe,c:null,d:vw,e:vw,f:HW,g:eq,G:rq,H:FW,I:UW,j:BW,L:mI,m:WW,M:qW,p:Pr,q:rn,Q:xw,s:ww,S:KW,u:GW,U:YW,V:ZW,w:XW,W:QW,x:null,X:null,y:JW,Y:tq,Z:nq,"%":bw},R={a:O,A:N,b:C,B:k,c:Q,d:pw,e:pw,f:xW,g:mw,G:fw,H:gw,I:gw,j:gW,L:bW,m:pW,M:yW,p:P,q:mW,Q:_W,s:EW,S:vW,u:lW,U:uW,V:dW,w:cW,W:hW,x:ce,X,y:mw,Y:fw,Z:fW,"%":wW};E.x=D(r,E),E.X=D(n,E),E.c=D(e,E),j.x=D(r,j),j.X=D(n,j),j.c=D(e,j);function D(G,he){return function(be){var B=[],ht=-1,Te=0,vt=G.length,bt,rr,Yi;for(be instanceof Date||(be=new Date(+be));++ht<vt;)G.charCodeAt(ht)===37&&(B.push(G.slice(Te,ht)),(rr=hw[bt=G.charAt(++ht)])!=null?bt=G.charAt(++ht):rr=bt==="e"?" ":"0",(Yi=he[bt])&&(bt=Yi(be,rr)),B.push(bt),Te=ht+1);return B.push(G.slice(Te,ht)),B.join("")}}function S(G,he){return function(be){var B=wo(1900,void 0,1),ht=A(B,G,be+="",0),Te,vt;if(ht!=be.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(he&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Te=xf(wo(B.y,0,1)),vt=Te.getUTCDay(),Te=vt>4||vt===0?Yu.ceil(Te):Yu(Te),Te=lh.offset(Te,(B.V-1)*7),B.y=Te.getUTCFullYear(),B.m=Te.getUTCMonth(),B.d=Te.getUTCDate()+(B.w+6)%7):(Te=bf(wo(B.y,0,1)),vt=Te.getDay(),Te=vt>4||vt===0?Gu.ceil(Te):Gu(Te),Te=Dc.offset(Te,(B.V-1)*7),B.y=Te.getFullYear(),B.m=Te.getMonth(),B.d=Te.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),vt="Z"in B?xf(wo(B.y,0,1)).getUTCDay():bf(wo(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(vt+5)%7:B.w+B.U*7-(vt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,xf(B)):bf(B)}}function A(G,he,be,B){for(var ht=0,Te=he.length,vt=be.length,bt,rr;ht<Te;){if(B>=vt)return-1;if(bt=he.charCodeAt(ht++),bt===37){if(bt=he.charAt(ht++),rr=R[bt in hw?he.charAt(ht++):bt],!rr||(B=rr(G,be,B))<0)return-1}else if(bt!=be.charCodeAt(B++))return-1}return B}function P(G,he,be){var B=l.exec(he.slice(be));return B?(G.p=d.get(B[0].toLowerCase()),be+B[0].length):-1}function O(G,he,be){var B=p.exec(he.slice(be));return B?(G.w=v.get(B[0].toLowerCase()),be+B[0].length):-1}function N(G,he,be){var B=h.exec(he.slice(be));return B?(G.w=m.get(B[0].toLowerCase()),be+B[0].length):-1}function C(G,he,be){var B=_.exec(he.slice(be));return B?(G.m=T.get(B[0].toLowerCase()),be+B[0].length):-1}function k(G,he,be){var B=b.exec(he.slice(be));return B?(G.m=g.get(B[0].toLowerCase()),be+B[0].length):-1}function Q(G,he,be){return A(G,e,he,be)}function ce(G,he,be){return A(G,r,he,be)}function X(G,he,be){return A(G,n,he,be)}function ee(G){return s[G.getDay()]}function fe(G){return a[G.getDay()]}function ye(G){return c[G.getMonth()]}function Ue(G){return o[G.getMonth()]}function se(G){return i[+(G.getHours()>=12)]}function q(G){return 1+~~(G.getMonth()/3)}function J(G){return s[G.getUTCDay()]}function rt(G){return a[G.getUTCDay()]}function ze(G){return c[G.getUTCMonth()]}function Fe(G){return o[G.getUTCMonth()]}function Pr(G){return i[+(G.getUTCHours()>=12)]}function rn(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var he=D(G+="",E);return he.toString=function(){return G},he},parse:function(G){var he=S(G+="",!1);return he.toString=function(){return G},he},utcFormat:function(G){var he=D(G+="",j);return he.toString=function(){return G},he},utcParse:function(G){var he=S(G+="",!0);return he.toString=function(){return G},he}}}var hw={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,aW=/^%/,sW=/[\\^$*+?|[\]().{}]/g;function Ce(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function oW(t){return t.replace(sW,"\\$&")}function _o(t){return new RegExp("^(?:"+t.map(oW).join("|")+")","i")}function Eo(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function cW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function lW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function uW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function dW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function hW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function fw(t,e,r){var n=kt.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function mw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function fW(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function mW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function pW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function pw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function gW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function gw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function yW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function vW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function bW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function xW(t,e,r){var n=kt.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function wW(t,e,r){var n=aW.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function _W(t,e,r){var n=kt.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function EW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function yw(t,e){return Ce(t.getDate(),e,2)}function TW(t,e){return Ce(t.getHours(),e,2)}function AW(t,e){return Ce(t.getHours()%12||12,e,2)}function SW(t,e){return Ce(1+Dc.count(ti(t),t),e,3)}function hI(t,e){return Ce(t.getMilliseconds(),e,3)}function IW(t,e){return hI(t,e)+"000"}function PW(t,e){return Ce(t.getMonth()+1,e,2)}function CW(t,e){return Ce(t.getMinutes(),e,2)}function kW(t,e){return Ce(t.getSeconds(),e,2)}function NW(t){var e=t.getDay();return e===0?7:e}function jW(t,e){return Ce(uh.count(ti(t)-1,t),e,2)}function fI(t){var e=t.getDay();return e>=4||e===0?Os(t):Os.ceil(t)}function OW(t,e){return t=fI(t),Ce(Os.count(ti(t),t)+(ti(t).getDay()===4),e,2)}function RW(t){return t.getDay()}function DW(t,e){return Ce(Gu.count(ti(t)-1,t),e,2)}function MW(t,e){return Ce(t.getFullYear()%100,e,2)}function LW(t,e){return t=fI(t),Ce(t.getFullYear()%100,e,2)}function $W(t,e){return Ce(t.getFullYear()%1e4,e,4)}function VW(t,e){var r=t.getDay();return t=r>=4||r===0?Os(t):Os.ceil(t),Ce(t.getFullYear()%1e4,e,4)}function zW(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Ce(e/60|0,"0",2)+Ce(e%60,"0",2)}function vw(t,e){return Ce(t.getUTCDate(),e,2)}function FW(t,e){return Ce(t.getUTCHours(),e,2)}function UW(t,e){return Ce(t.getUTCHours()%12||12,e,2)}function BW(t,e){return Ce(1+lh.count(ri(t),t),e,3)}function mI(t,e){return Ce(t.getUTCMilliseconds(),e,3)}function HW(t,e){return mI(t,e)+"000"}function WW(t,e){return Ce(t.getUTCMonth()+1,e,2)}function qW(t,e){return Ce(t.getUTCMinutes(),e,2)}function KW(t,e){return Ce(t.getUTCSeconds(),e,2)}function GW(t){var e=t.getUTCDay();return e===0?7:e}function YW(t,e){return Ce(dh.count(ri(t)-1,t),e,2)}function pI(t){var e=t.getUTCDay();return e>=4||e===0?Rs(t):Rs.ceil(t)}function ZW(t,e){return t=pI(t),Ce(Rs.count(ri(t),t)+(ri(t).getUTCDay()===4),e,2)}function XW(t){return t.getUTCDay()}function QW(t,e){return Ce(Yu.count(ri(t)-1,t),e,2)}function JW(t,e){return Ce(t.getUTCFullYear()%100,e,2)}function eq(t,e){return t=pI(t),Ce(t.getUTCFullYear()%100,e,2)}function tq(t,e){return Ce(t.getUTCFullYear()%1e4,e,4)}function rq(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Rs(t):Rs.ceil(t),Ce(t.getUTCFullYear()%1e4,e,4)}function nq(){return"+0000"}function bw(){return"%"}function xw(t){return+t}function ww(t){return Math.floor(+t/1e3)}var as,gI,yI;iq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function iq(t){return as=iW(t),gI=as.format,as.parse,yI=as.utcFormat,as.utcParse,as}function aq(t){return new Date(t)}function sq(t){return t instanceof Date?+t:+new Date(+t)}function iy(t,e,r,n,i,a,s,o,c,l){var d=Hg(),h=d.invert,m=d.domain,p=l(".%L"),v=l(":%S"),b=l("%I:%M"),g=l("%I %p"),_=l("%a %d"),T=l("%b %d"),E=l("%B"),j=l("%Y");function R(D){return(c(D)<D?p:o(D)<D?v:s(D)<D?b:a(D)<D?g:n(D)<D?i(D)<D?_:T:r(D)<D?E:j)(D)}return d.invert=function(D){return new Date(h(D))},d.domain=function(D){return arguments.length?m(Array.from(D,sq)):m().map(aq)},d.ticks=function(D){var S=m();return t(S[0],S[S.length-1],D??10)},d.tickFormat=function(D,S){return S==null?R:l(S)},d.nice=function(D){var S=m();return(!D||typeof D.range!="function")&&(D=e(S[0],S[S.length-1],D??10)),D?m(nI(S,D)):d},d.copy=function(){return Rc(d,iy(t,e,r,n,i,a,s,o,c,l))},d}function oq(){return Hr.apply(iy(rW,nW,ti,ry,uh,Dc,ey,Qg,ma,gI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function cq(){return Hr.apply(iy(eW,tW,ri,ny,dh,lh,ty,Jg,ma,yI).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function hh(){var t=0,e=1,r,n,i,a,s=ir,o=!1,c;function l(h){return h==null||isNaN(h=+h)?c:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),l):[t,e]},l.clamp=function(h){return arguments.length?(o=!!h,l):o},l.interpolator=function(h){return arguments.length?(s=h,l):s};function d(h){return function(m){var p,v;return arguments.length?([p,v]=m,s=h(p,v),l):[s(0),s(1)]}}return l.range=d(Hs),l.rangeRound=d(Bg),l.unknown=function(h){return arguments.length?(c=h,l):c},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),l}}function qi(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function vI(){var t=Wi(hh()(ir));return t.copy=function(){return qi(t,vI())},ai.apply(t,arguments)}function bI(){var t=Kg(hh()).domain([1,10]);return t.copy=function(){return qi(t,bI()).base(t.base())},ai.apply(t,arguments)}function xI(){var t=Gg(hh());return t.copy=function(){return qi(t,xI()).constant(t.constant())},ai.apply(t,arguments)}function ay(){var t=Yg(hh());return t.copy=function(){return qi(t,ay()).exponent(t.exponent())},ai.apply(t,arguments)}function lq(){return ay.apply(null,arguments).exponent(.5)}function wI(){var t=[],e=ir;function r(n){if(n!=null&&!isNaN(n=+n))return e((jc(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(ki),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>G8(t,a/n))},r.copy=function(){return wI(e).domain(t)},ai.apply(r,arguments)}function fh(){var t=0,e=.5,r=1,n=1,i,a,s,o,c,l=ir,d,h=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+d(b))-a)*(n*b<n*a?o:c),l(h?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([t,e,r]=b,i=d(t=+t),a=d(e=+e),s=d(r=+r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p):[t,e,r]},p.clamp=function(b){return arguments.length?(h=!!b,p):h},p.interpolator=function(b){return arguments.length?(l=b,p):l};function v(b){return function(g){var _,T,E;return arguments.length?([_,T,E]=g,l=wH(b,[_,T,E]),p):[l(0),l(.5),l(1)]}}return p.range=v(Hs),p.rangeRound=v(Bg),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return d=b,i=b(t),a=b(e),s=b(r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p}}function _I(){var t=Wi(fh()(ir));return t.copy=function(){return qi(t,_I())},ai.apply(t,arguments)}function EI(){var t=Kg(fh()).domain([.1,1,10]);return t.copy=function(){return qi(t,EI()).base(t.base())},ai.apply(t,arguments)}function TI(){var t=Gg(fh());return t.copy=function(){return qi(t,TI()).constant(t.constant())},ai.apply(t,arguments)}function sy(){var t=Yg(fh());return t.copy=function(){return qi(t,sy()).exponent(t.exponent())},ai.apply(t,arguments)}function uq(){return sy.apply(null,arguments).exponent(.5)}const jo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:zg,scaleDiverging:_I,scaleDivergingLog:EI,scaleDivergingPow:sy,scaleDivergingSqrt:uq,scaleDivergingSymlog:TI,scaleIdentity:rI,scaleImplicit:Om,scaleLinear:tI,scaleLog:iI,scaleOrdinal:Vg,scalePoint:X8,scalePow:Zg,scaleQuantile:oI,scaleQuantize:cI,scaleRadial:sI,scaleSequential:vI,scaleSequentialLog:bI,scaleSequentialPow:ay,scaleSequentialQuantile:wI,scaleSequentialSqrt:lq,scaleSequentialSymlog:xI,scaleSqrt:HH,scaleSymlog:aI,scaleThreshold:lI,scaleTime:oq,scaleUtc:cq,tickFormat:eI},Symbol.toStringTag,{value:"Module"}));var Ya=t=>t.chartData,dq=V([Ya],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),AI=(t,e,r,n)=>n?dq(t):Ya(t);function Ds(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(tn(e)&&tn(r))return!0}return!1}function _w(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function hq(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(tn(r))i=r;else if(typeof r=="function")return;if(tn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Ds(s))return s}}function fq(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Ds(n))return _w(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,s,o;if(i==="auto")e!=null&&(s=Math.min(...e));else if(te(i))s=i;else if(typeof i=="function")try{e!=null&&(s=i(e?.[0]))}catch{}else if(typeof i=="string"&&xx.test(i)){var c=xx.exec(i);if(c==null||e==null)s=void 0;else{var l=+c[1];s=e[0]-l}}else s=e?.[0];if(a==="auto")e!=null&&(o=Math.max(...e));else if(te(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e?.[1]))}catch{}else if(typeof a=="string"&&wx.test(a)){var d=wx.exec(a);if(d==null||e==null)o=void 0;else{var h=+d[1];o=e[1]+h}}else o=e?.[1];var m=[s,o];if(Ds(m))return e==null?m:_w(m,e,r)}}}var Ws=1e9,mq={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cy,Ye=!0,Fr="[DecimalError] ",_a=Fr+"Invalid argument: ",oy=Fr+"Exponent out of range: ",qs=Math.floor,oa=Math.pow,pq=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_r,Pt=1e7,We=7,SI=9007199254740991,Zu=qs(SI/We),Z={};Z.absoluteValue=Z.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Z.comparedTo=Z.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Z.decimalPlaces=Z.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*We;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Z.dividedBy=Z.div=function(t){return Kn(this,new this.constructor(t))};Z.dividedToIntegerBy=Z.idiv=function(t){var e=this,r=e.constructor;return $e(Kn(e,new r(t),0,1),r.precision)};Z.equals=Z.eq=function(t){return!this.cmp(t)};Z.exponent=function(){return yt(this)};Z.greaterThan=Z.gt=function(t){return this.cmp(t)>0};Z.greaterThanOrEqualTo=Z.gte=function(t){return this.cmp(t)>=0};Z.isInteger=Z.isint=function(){return this.e>this.d.length-2};Z.isNegative=Z.isneg=function(){return this.s<0};Z.isPositive=Z.ispos=function(){return this.s>0};Z.isZero=function(){return this.s===0};Z.lessThan=Z.lt=function(t){return this.cmp(t)<0};Z.lessThanOrEqualTo=Z.lte=function(t){return this.cmp(t)<1};Z.logarithm=Z.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(_r))throw Error(Fr+"NaN");if(r.s<1)throw Error(Fr+(r.s?"NaN":"-Infinity"));return r.eq(_r)?new n(0):(Ye=!1,e=Kn(hc(r,a),hc(t,a),a),Ye=!0,$e(e,i))};Z.minus=Z.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?CI(e,t):II(e,(t.s=-t.s,t))};Z.modulo=Z.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(Fr+"NaN");return r.s?(Ye=!1,e=Kn(r,t,0,1).times(t),Ye=!0,r.minus(e)):$e(new n(r),i)};Z.naturalExponential=Z.exp=function(){return PI(this)};Z.naturalLogarithm=Z.ln=function(){return hc(this)};Z.negated=Z.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Z.plus=Z.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?II(e,t):CI(e,(t.s=-t.s,t))};Z.precision=Z.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(_a+t);if(e=yt(i)+1,n=i.d.length-1,r=n*We+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Z.squareRoot=Z.sqrt=function(){var t,e,r,n,i,a,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Fr+"NaN")}for(t=yt(o),Ye=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=hn(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=qs((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(i.toString()),r=c.precision,i=s=r+3;;)if(a=n,n=a.plus(Kn(o,a,s+2)).times(.5),hn(a.d).slice(0,s)===(e=hn(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if($e(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Ye=!0,$e(n,r)};Z.times=Z.mul=function(t){var e,r,n,i,a,s,o,c,l,d=this,h=d.constructor,m=d.d,p=(t=new h(t)).d;if(!d.s||!t.s)return new h(0);for(t.s*=d.s,r=d.e+t.e,c=m.length,l=p.length,c<l&&(a=m,m=p,p=a,s=c,c=l,l=s),a=[],s=c+l,n=s;n--;)a.push(0);for(n=l;--n>=0;){for(e=0,i=c+n;i>n;)o=a[i]+p[n]*m[i-n-1]+e,a[i--]=o%Pt|0,e=o/Pt|0;a[i]=(a[i]+e)%Pt|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ye?$e(t,h.precision):t};Z.toDecimalPlaces=Z.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Pn(t,0,Ws),e===void 0?e=n.rounding:Pn(e,0,8),$e(r,t+yt(r)+1,e))};Z.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Ma(n,!0):(Pn(t,0,Ws),e===void 0?e=i.rounding:Pn(e,0,8),n=$e(new i(n),t+1,e),r=Ma(n,!0,t+1)),r};Z.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?Ma(i):(Pn(t,0,Ws),e===void 0?e=a.rounding:Pn(e,0,8),n=$e(new a(i),t+yt(i)+1,e),r=Ma(n.abs(),!1,t+yt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Z.toInteger=Z.toint=function(){var t=this,e=t.constructor;return $e(new e(t),yt(t)+1,e.rounding)};Z.toNumber=function(){return+this};Z.toPower=Z.pow=function(t){var e,r,n,i,a,s,o=this,c=o.constructor,l=12,d=+(t=new c(t));if(!t.s)return new c(_r);if(o=new c(o),!o.s){if(t.s<1)throw Error(Fr+"Infinity");return o}if(o.eq(_r))return o;if(n=c.precision,t.eq(_r))return $e(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=d<0?-d:d)<=SI){for(i=new c(_r),e=Math.ceil(n/We+4),Ye=!1;r%2&&(i=i.times(o),Tw(i.d,e)),r=qs(r/2),r!==0;)o=o.times(o),Tw(o.d,e);return Ye=!0,t.s<0?new c(_r).div(i):$e(i,n)}}else if(a<0)throw Error(Fr+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Ye=!1,i=t.times(hc(o,n+l)),Ye=!0,i=PI(i),i.s=a,i};Z.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=yt(i),n=Ma(i,r<=a.toExpNeg||r>=a.toExpPos)):(Pn(t,1,Ws),e===void 0?e=a.rounding:Pn(e,0,8),i=$e(new a(i),t,e),r=yt(i),n=Ma(i,t<=r||r<=a.toExpNeg,t)),n};Z.toSignificantDigits=Z.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Pn(t,1,Ws),e===void 0?e=n.rounding:Pn(e,0,8)),$e(new n(r),t,e)};Z.toString=Z.valueOf=Z.val=Z.toJSON=Z[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=yt(t),r=t.constructor;return Ma(t,e<=r.toExpNeg||e>=r.toExpPos)};function II(t,e){var r,n,i,a,s,o,c,l,d=t.constructor,h=d.precision;if(!t.s||!e.s)return e.s||(e=new d(t)),Ye?$e(e,h):e;if(c=t.d,l=e.d,s=t.e,i=e.e,c=c.slice(),a=s-i,a){for(a<0?(n=c,a=-a,o=l.length):(n=l,i=s,o=c.length),s=Math.ceil(h/We),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=l.length,o-a<0&&(a=o,n=l,l=c,c=n),r=0;a;)r=(c[--a]=c[a]+l[a]+r)/Pt|0,c[a]%=Pt;for(r&&(c.unshift(r),++i),o=c.length;c[--o]==0;)c.pop();return e.d=c,e.e=i,Ye?$e(e,h):e}function Pn(t,e,r){if(t!==~~t||t<e||t>r)throw Error(_a+t)}function hn(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=We-n.length,r&&(a+=yi(r)),a+=n;s=t[e],n=s+"",r=We-n.length,r&&(a+=yi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Kn=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Pt|0,s=a/Pt|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,c;if(a!=s)c=a>s?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=i[o]){c=n[o]>i[o]?1:-1;break}return c}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Pt+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,c,l,d,h,m,p,v,b,g,_,T,E,j,R,D,S,A,P=n.constructor,O=n.s==i.s?1:-1,N=n.d,C=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(Fr+"Division by zero");for(c=n.e-i.e,S=C.length,R=N.length,p=new P(O),v=p.d=[],l=0;C[l]==(N[l]||0);)++l;if(C[l]>(N[l]||0)&&--c,a==null?T=a=P.precision:s?T=a+(yt(n)-yt(i))+1:T=a,T<0)return new P(0);if(T=T/We+2|0,l=0,S==1)for(d=0,C=C[0],T++;(l<R||d)&&T--;l++)E=d*Pt+(N[l]||0),v[l]=E/C|0,d=E%C|0;else{for(d=Pt/(C[0]+1)|0,d>1&&(C=t(C,d),N=t(N,d),S=C.length,R=N.length),j=S,b=N.slice(0,S),g=b.length;g<S;)b[g++]=0;A=C.slice(),A.unshift(0),D=C[0],C[1]>=Pt/2&&++D;do d=0,o=e(C,b,S,g),o<0?(_=b[0],S!=g&&(_=_*Pt+(b[1]||0)),d=_/D|0,d>1?(d>=Pt&&(d=Pt-1),h=t(C,d),m=h.length,g=b.length,o=e(h,b,m,g),o==1&&(d--,r(h,S<m?A:C,m))):(d==0&&(o=d=1),h=C.slice()),m=h.length,m<g&&h.unshift(0),r(b,h,g),o==-1&&(g=b.length,o=e(C,b,S,g),o<1&&(d++,r(b,S<g?A:C,g))),g=b.length):o===0&&(d++,b=[0]),v[l++]=d,o&&b[0]?b[g++]=N[j]||0:(b=[N[j]],g=1);while((j++<R||b[0]!==void 0)&&T--)}return v[0]||v.shift(),p.e=c,$e(p,s?a+yt(p)+1:a)}}();function PI(t,e){var r,n,i,a,s,o,c=0,l=0,d=t.constructor,h=d.precision;if(yt(t)>16)throw Error(oy+yt(t));if(!t.s)return new d(_r);for(Ye=!1,o=h,s=new d(.03125);t.abs().gte(.1);)t=t.times(s),l+=5;for(n=Math.log(oa(2,l))/Math.LN10*2+5|0,o+=n,r=i=a=new d(_r),d.precision=o;;){if(i=$e(i.times(t),o),r=r.times(++c),s=a.plus(Kn(i,r,o)),hn(s.d).slice(0,o)===hn(a.d).slice(0,o)){for(;l--;)a=$e(a.times(a),o);return d.precision=h,e==null?(Ye=!0,$e(a,h)):a}a=s}}function yt(t){for(var e=t.e*We,r=t.d[0];r>=10;r/=10)e++;return e}function wf(t,e,r){if(e>t.LN10.sd())throw Ye=!0,r&&(t.precision=r),Error(Fr+"LN10 precision limit exceeded");return $e(new t(t.LN10),e)}function yi(t){for(var e="";t--;)e+="0";return e}function hc(t,e){var r,n,i,a,s,o,c,l,d,h=1,m=10,p=t,v=p.d,b=p.constructor,g=b.precision;if(p.s<1)throw Error(Fr+(p.s?"NaN":"-Infinity"));if(p.eq(_r))return new b(0);if(e==null?(Ye=!1,l=g):l=e,p.eq(10))return e==null&&(Ye=!0),wf(b,l);if(l+=m,b.precision=l,r=hn(v),n=r.charAt(0),a=yt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(t),r=hn(p.d),n=r.charAt(0),h++;a=yt(p),n>1?(p=new b("0."+r),a++):p=new b(n+"."+r.slice(1))}else return c=wf(b,l+2,g).times(a+""),p=hc(new b(n+"."+r.slice(1)),l-m).plus(c),b.precision=g,e==null?(Ye=!0,$e(p,g)):p;for(o=s=p=Kn(p.minus(_r),p.plus(_r),l),d=$e(p.times(p),l),i=3;;){if(s=$e(s.times(d),l),c=o.plus(Kn(s,new b(i),l)),hn(c.d).slice(0,l)===hn(o.d).slice(0,l))return o=o.times(2),a!==0&&(o=o.plus(wf(b,l+2,g).times(a+""))),o=Kn(o,new b(h),l),b.precision=g,e==null?(Ye=!0,$e(o,g)):o;o=c,i+=2}}function Ew(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=qs(r/We),t.d=[],n=(r+1)%We,r<0&&(n+=We),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=We;n<i;)t.d.push(+e.slice(n,n+=We));e=e.slice(n),n=We-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ye&&(t.e>Zu||t.e<-Zu))throw Error(oy+r)}else t.s=0,t.e=0,t.d=[0];return t}function $e(t,e,r){var n,i,a,s,o,c,l,d,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=We,i=e,l=h[d=0];else{if(d=Math.ceil((n+1)/We),a=h.length,d>=a)return t;for(l=a=h[d],s=1;a>=10;a/=10)s++;n%=We,i=n-We+s}if(r!==void 0&&(a=oa(10,s-i-1),o=l/a%10|0,c=e<0||h[d+1]!==void 0||l%a,c=r<4?(o||c)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?i>0?l/oa(10,s-i):0:h[d-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return c?(a=yt(t),h.length=1,e=e-a-1,h[0]=oa(10,(We-e%We)%We),t.e=qs(-e/We)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=d,a=1,d--):(h.length=d+1,a=oa(10,We-n),h[d]=i>0?(l/oa(10,s-i)%oa(10,i)|0)*a:0),c)for(;;)if(d==0){(h[0]+=a)==Pt&&(h[0]=1,++t.e);break}else{if(h[d]+=a,h[d]!=Pt)break;h[d--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Ye&&(t.e>Zu||t.e<-Zu))throw Error(oy+yt(t));return t}function CI(t,e){var r,n,i,a,s,o,c,l,d,h,m=t.constructor,p=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Ye?$e(e,p):e;if(c=t.d,h=e.d,n=e.e,l=t.e,c=c.slice(),s=l-n,s){for(d=s<0,d?(r=c,s=-s,o=h.length):(r=h,n=l,o=c.length),i=Math.max(Math.ceil(p/We),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=c.length,o=h.length,d=i<o,d&&(o=i),i=0;i<o;i++)if(c[i]!=h[i]){d=c[i]<h[i];break}s=0}for(d&&(r=c,c=h,h=r,e.s=-e.s),o=c.length,i=h.length-o;i>0;--i)c[o++]=0;for(i=h.length;i>s;){if(c[--i]<h[i]){for(a=i;a&&c[--a]===0;)c[a]=Pt-1;--c[a],c[i]+=Pt}c[i]-=h[i]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ye?$e(e,p):e):new m(0)}function Ma(t,e,r){var n,i=yt(t),a=hn(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+yi(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+yi(-i-1)+a,r&&(n=r-s)>0&&(a+=yi(n))):i>=s?(a+=yi(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+yi(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=yi(n))),t.s<0?"-"+a:a}function Tw(t,e){if(t.length>e)return t.length=e,!0}function kI(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(_a+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return Ew(s,a.toString())}else if(typeof a!="string")throw Error(_a+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,pq.test(a))Ew(s,a);else throw Error(_a+a)}if(i.prototype=Z,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=kI,i.config=i.set=gq,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function gq(t){if(!t||typeof t!="object")throw Error(Fr+"Object expected");var e,r,n,i=["precision",1,Ws,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(qs(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(_a+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(_a+r+": "+n);return this}var cy=kI(mq);_r=new cy(1);const je=cy;var yq=t=>t,NI={},jI=t=>t===NI,Aw=t=>function e(){return arguments.length===0||arguments.length===1&&jI(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},OI=(t,e)=>t===1?e:Aw(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==NI).length;return a>=t?e(...n):OI(t-a,Aw(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var l=n.map(d=>jI(d)?o.shift():d);return e(...l,...o)}))}),mh=t=>OI(t.length,t),Lm=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},vq=mh((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),bq=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return yq;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,c)=>c(o),a(...arguments))}},$m=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),RI=t=>{var e=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e&&i.every((s,o)=>{var c;return s===((c=e)===null||c===void 0?void 0:c[o])})||(e=i,r=t(...i)),r}};function DI(t){var e;return t===0?e=1:e=Math.floor(new je(t).abs().log(10).toNumber())+1,e}function MI(t,e,r){for(var n=new je(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}mh((t,e,r)=>{var n=+t,i=+e;return n+r*(i-n)});mh((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});mh((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var LI=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},$I=(t,e,r)=>{if(t.lte(0))return new je(0);var n=DI(t.toNumber()),i=new je(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new je(Math.ceil(a.div(s).toNumber())).add(r).mul(s),c=o.mul(i);return e?new je(c.toNumber()):new je(Math.ceil(c.toNumber()))},xq=(t,e,r)=>{var n=new je(1),i=new je(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new je(10).pow(DI(t)-1),i=new je(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new je(Math.floor(t)))}else t===0?i=new je(Math.floor((e-1)/2)):r||(i=new je(Math.floor(t)));var s=Math.floor((e-1)/2),o=bq(vq(c=>i.add(new je(c-s).mul(n)).toNumber()),Lm);return o(0,e)},VI=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new je(0),tickMin:new je(0),tickMax:new je(0)};var s=$I(new je(r).sub(e).div(n-1),i,a),o;e<=0&&r>=0?o=new je(0):(o=new je(e).add(r).div(2),o=o.sub(new je(o).mod(s)));var c=Math.ceil(o.sub(e).div(s).toNumber()),l=Math.ceil(new je(r).sub(o).div(s).toNumber()),d=c+l+1;return d>n?VI(e,r,n,i,a+1):(d<n&&(l=r>0?l+(n-d):l,c=r>0?c:c+(n-d)),{step:s,tickMin:o.sub(new je(c).mul(s)),tickMax:o.add(new je(l).mul(s))})};function wq(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=LI([e,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,...Lm(0,n-1).map(()=>1/0)]:[...Lm(0,n-1).map(()=>-1/0),o];return e>r?$m(c):c}if(s===o)return xq(s,n,i);var{step:l,tickMin:d,tickMax:h}=VI(s,o,a,i,0),m=MI(d,h.add(new je(.1).mul(l)),l);return e>r?$m(m):m}function _q(t,e){var[r,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=LI([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(e,2),c=$I(new je(s).sub(a).div(o-1),i,0),l=[...MI(new je(a),new je(s),c),s];return i===!1&&(l=l.map(d=>Math.round(d))),r>n?$m(l):l}var Eq=RI(wq),Tq=RI(_q),Aq=t=>t.rootProps.barCategoryGap,ph=t=>t.rootProps.stackOffset,ly=t=>t.options.chartName,uy=t=>t.rootProps.syncId,zI=t=>t.rootProps.syncMethod,dy=t=>t.options.eventEmitter,Ln={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},br={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},gh=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},Sq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:Ln.reversed,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:Ln.type,unit:void 0},Iq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:br.type,unit:void 0},Pq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ln.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Cq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:"category",unit:void 0},hy=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?Pq:Sq,fy=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?Cq:Iq,yh=t=>t.polarOptions,my=V([ni,ii,Ht],U9),FI=V([yh,my],(t,e)=>{if(t!=null)return $i(t.innerRadius,e,0)}),UI=V([yh,my],(t,e)=>{if(t!=null)return $i(t.outerRadius,e,e*.8)}),kq=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},BI=V([yh],kq);V([hy,BI],gh);var HI=V([my,FI,UI],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});V([fy,HI],gh);var Nq=V([tt,yh,FI,UI,ni,ii],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:l}=e;return{cx:$i(s,i,i/2),cy:$i(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:l,clockWise:!1}}}),Nt=(t,e)=>e,vh=(t,e,r)=>r;function Sw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Sw(Object(r),!0).forEach(function(n){jq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jq(t,e,r){return(e=Oq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oq(t){var e=Rq(t,"string");return typeof e=="symbol"?e:e+""}function Rq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vm=[0,"auto"],yr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},si=(t,e)=>{var r=t.cartesianAxis.xAxis[e];return r??yr},vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Vm,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:ah},Ki=(t,e)=>{var r=t.cartesianAxis.yAxis[e];return r??vr},Dq={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},py=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??Dq},pr=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Ki(t,r);case"zAxis":return py(t,r);case"angleAxis":return hy(t,r);case"radiusAxis":return fy(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Mq=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Ki(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Mc=(t,e,r)=>{switch(e){case"xAxis":return si(t,r);case"yAxis":return Ki(t,r);case"angleAxis":return hy(t,r);case"radiusAxis":return fy(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},WI=t=>t.graphicalItems.countOfBars>0;function qI(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var KI=t=>t.graphicalItems.cartesianItems,Lq=V([Nt,vh],qI),GI=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),Lc=V([KI,pr,Lq],GI),YI=t=>t.filter(e=>e.stackId===void 0),$q=V([Lc],YI),ZI=t=>t.map(e=>e.data).filter(Boolean).flat(1),Vq=V([Lc],ZI),XI=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},bh=V([Vq,AI],XI),QI=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Tr(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Tr(i,n)}))):t.map(n=>({value:n})),xh=V([bh,pr,Lc],QI);function JI(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Za(t){return t.filter(e=>In(e)||e instanceof Date).map(Number).filter(e=>Vr(e)===!1)}function zq(t,e,r){return!r||typeof e!="number"||Vr(e)?[]:r.length?Za(r.flatMap(n=>{var i=Tr(t,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!tn(a)||!tn(s)))return[e-a,e+s]})):[]}var eP=(t,e,r)=>{var n={},i=e.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,c=o.map(l=>l.dataKey);return[s,{stackedData:nB(t,c,r),graphicalItems:o}]}))},Fq=V([bh,Lc,ph],eP),tP=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:i}=e;if(r!=="zAxis"){var a=oB(t,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},Uq=V([Fq,Ya,Nt],tP),rP=(t,e,r,n)=>r.length>0?t.flatMap(i=>r.flatMap(a=>{var s,o,c=(s=a.errorBars)===null||s===void 0?void 0:s.filter(d=>JI(n,d)),l=Tr(i,(o=e.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:l,errorDomain:zq(i,l,c)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:Tr(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),Bq=V(bh,pr,$q,Nt,rP);function Hq(t){var{value:e}=t;if(In(e)||e instanceof Date)return e}var Wq=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Za(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},qq=(t,e,r)=>{var n=t.map(Hq).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&hA(n))?HS(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},gy=t=>{var e;if(t==null||!("domain"in t))return Vm;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=Za(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:Vm},yy=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},nP=t=>t.referenceElements.dots,Ks=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),Kq=V([nP,Nt,vh],Ks),iP=t=>t.referenceElements.areas,Gq=V([iP,Nt,vh],Ks),aP=t=>t.referenceElements.lines,Yq=V([aP,Nt,vh],Ks),sP=(t,e)=>{var r=Za(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Zq=V(Kq,Nt,sP),oP=(t,e)=>{var r=Za(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Xq=V([Gq,Nt],oP),cP=(t,e)=>{var r=Za(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Qq=V(Yq,Nt,cP),Jq=V(Zq,Qq,Xq,(t,e,r)=>yy(t,r,e)),e7=V([pr],gy),lP=(t,e,r,n,i)=>{var a=hq(e,t.allowDataOverflow);return a??fq(e,yy(r,i,Wq(n)),t.allowDataOverflow)},t7=V([pr,e7,Uq,Bq,Jq],lP),r7=[0,1],uP=(t,e,r,n,i,a,s)=>{if(!(t==null||r==null||r.length===0)){var{dataKey:o,type:c}=t,l=Hi(e,a);return l&&o==null?HS(0,r.length):c==="category"?qq(n,t,l):i==="expand"?r7:s}},vy=V([pr,tt,bh,xh,ph,Nt,t7],uP),dP=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:s}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(gg(a));return o in jo?o:"point"}}},$c=V([pr,tt,WI,ly,Nt],dP);function n7(t){if(t!=null){if(t in jo)return jo[t]();var e="scale".concat(gg(t));if(e in jo)return jo[e]()}}function by(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=n7(e);if(i!=null){var a=i.domain(r).range(n);return J9(a),a}}}var hP=(t,e,r)=>{var n=gy(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Ds(t))return Eq(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Ds(t))return Tq(t,e.tickCount,e.allowDecimals)}},xy=V([vy,Mc,$c],hP),fP=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Ds(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],s=e[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return e},i7=V([pr,vy,xy,Nt],fP),a7=V(xh,pr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Za(t.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),mP=V(a7,tt,Aq,Ht,(t,e,r,n)=>n,(t,e,r,n,i)=>{if(!tn(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var s=$i(r,t*a),o=t*a/2;return o-s-(o-s)/a*s}return 0}),s7=(t,e)=>{var r=si(t,e);return r==null||typeof r.padding!="string"?0:mP(t,"xAxis",e,r.padding)},o7=(t,e)=>{var r=Ki(t,e);return r==null||typeof r.padding!="string"?0:mP(t,"yAxis",e,r.padding)},c7=V(si,s7,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),l7=V(Ki,o7,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),u7=V([Ht,c7,oh,sh,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),d7=V([Ht,tt,l7,oh,sh,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Vc=(t,e,r,n)=>{var i;switch(e){case"xAxis":return u7(t,r,n);case"yAxis":return d7(t,r,n);case"zAxis":return(i=py(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return BI(t);case"radiusAxis":return HI(t,r);default:return}},pP=V([pr,Vc],gh),Gs=V([pr,$c,i7,pP],by);V(Lc,Nt,(t,e)=>t.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>JI(e,r)));function gP(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var wh=(t,e)=>e,_h=(t,e,r)=>r,h7=V(Og,wh,_h,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(gP)),f7=V(Rg,wh,_h,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(gP)),yP=(t,e)=>({width:t.width,height:e.height}),m7=(t,e)=>{var r=typeof e.width=="number"?e.width:ah;return{width:r,height:t.height}},p7=V(Ht,si,yP),g7=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},y7=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},v7=V(ii,Ht,h7,wh,_h,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=yP(e,o);s==null&&(s=g7(e,n,t));var l=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(l)*c.height,s+=(l?-1:1)*c.height}),a}),b7=V(ni,Ht,f7,wh,_h,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=m7(e,o);s==null&&(s=y7(e,n,t));var l=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(l)*c.width,s+=(l?-1:1)*c.width}),a}),x7=(t,e)=>{var r=Ht(t),n=si(t,e);if(n!=null){var i=v7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},w7=(t,e)=>{var r=Ht(t),n=Ki(t,e);if(n!=null){var i=b7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},_7=V(Ht,Ki,(t,e)=>{var r=typeof e.width=="number"?e.width:ah;return{width:r,height:t.height}}),vP=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=Hi(t,n),c=e.map(l=>l.value);if(s&&o&&a==="category"&&i&&hA(c))return c}},wy=V([tt,xh,pr,Nt],vP),bP=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=Hi(t,n);if(s&&(i==="number"||a!=="auto"))return e.map(o=>o.value)}},_y=V([tt,xh,Mc,Nt],bP),Iw=V([tt,Mq,$c,Gs,wy,_y,Vc,xy,Nt],(t,e,r,n,i,a,s,o,c)=>{if(e==null)return null;var l=Hi(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:l,niceTicks:o,range:s,realScaleType:r,scale:n}}),E7=(t,e,r,n,i,a,s,o,c)=>{if(!(e==null||n==null)){var l=Hi(t,c),{type:d,ticks:h,tickCount:m}=e,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=d==="category"&&n.bandwidth?n.bandwidth()/p:0;v=c==="angleAxis"&&a!=null&&a.length>=2?Lr(a[0]-a[1])*2*v:v;var b=h||i;if(b){var g=b.map((_,T)=>{var E=s?s.indexOf(_):_;return{index:T,coordinate:n(E)+v,value:_,offset:v}});return g.filter(_=>!Vr(_.coordinate))}return l&&o?o.map((_,T)=>({coordinate:n(_)+v,value:_,index:T,offset:v})):n.ticks?n.ticks(m).map(_=>({coordinate:n(_)+v,value:_,offset:v})):n.domain().map((_,T)=>({coordinate:n(_)+v,value:s?s[_]:_,index:T,offset:v}))}},xP=V([tt,Mc,$c,Gs,xy,Vc,wy,_y,Nt],E7),T7=(t,e,r,n,i,a,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Hi(t,s),{tickCount:c}=e,l=0;return l=s==="angleAxis"&&n?.length>=2?Lr(n[0]-n[1])*2*l:l,o&&a?a.map((d,h)=>({coordinate:r(d)+l,value:d,index:h,offset:l})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+l,value:d,offset:l})):r.domain().map((d,h)=>({coordinate:r(d)+l,value:i?i[d]:d,index:h,offset:l}))}},wP=V([tt,Mc,Gs,Vc,wy,_y,Nt],T7),Eh=V(pr,Gs,(t,e)=>{if(!(t==null||e==null))return Xu(Xu({},t),{},{scale:e})}),A7=V([pr,$c,vy,pP],by);V((t,e,r)=>py(t,r),A7,(t,e)=>{if(!(t==null||e==null))return Xu(Xu({},t),{},{scale:e})});var S7=V([tt,Og,Rg],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),_P=t=>t.options.defaultTooltipEventType,EP=t=>t.options.validateTooltipEventTypes;function TP(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Ey(t,e){var r=_P(t),n=EP(t);return TP(e,r,n)}function I7(t){return ie(e=>Ey(e,t))}var AP=(t,e)=>{var r,n=Number(e);if(!(Vr(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},P7=t=>t.tooltip.settings,_i={active:!1,index:null,dataKey:void 0,coordinate:void 0},C7={itemInteraction:{click:_i,hover:_i},axisInteraction:{click:_i,hover:_i},keyboardInteraction:_i,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},SP=Br({name:"tooltip",initialState:C7,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Bn(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:k7,removeTooltipEntrySettings:N7,setTooltipSettingsState:j7,setActiveMouseOverItemIndex:O7,mouseLeaveItem:QJ,mouseLeaveChart:IP,setActiveClickItemIndex:JJ,setMouseOverAxisIndex:PP,setMouseClickAxisIndex:R7,setSyncInteraction:zm,setKeyboardInteraction:Fm}=SP.actions,D7=SP.reducer;function Pw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ml(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pw(Object(r),!0).forEach(function(n){M7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function M7(t,e,r){return(e=L7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L7(t){var e=$7(t,"string");return typeof e=="symbol"?e:e+""}function $7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V7(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function z7(t){return t.index!=null}var CP=(t,e,r,n)=>{if(e==null)return _i;var i=V7(t,e,r);if(i==null)return _i;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(z7(i)){if(a)return Ml(Ml({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Ml(Ml({},_i),{},{coordinate:i.coordinate})},Ty=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!tn(n))return r;var i=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(i,Math.min(n,a)))},kP=(t,e,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var c=s[0],l=c==null?void 0:o(c.positions,a);if(l!=null)return l;var d=i?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:d.coordinate}}}},NP=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},zc=t=>t.options.tooltipPayloadSearcher,Ys=t=>t.tooltip;function Cw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function kw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(r),!0).forEach(function(n){F7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function F7(t,e,r){return(e=U7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U7(t){var e=B7(t,"string");return typeof e=="symbol"?e:e+""}function B7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H7(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function W7(t,e){return t??e}var jP=(t,e,r,n,i,a,s)=>{if(!(e==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:l,dataEndIndex:d}=r,h=[];return t.reduce((m,p)=>{var v,{dataDefinedOnItem:b,settings:g}=p,_=W7(b,o),T=H7(_,l,d),E=(v=g?.dataKey)!==null&&v!==void 0?v:n?.dataKey,j=g?.nameKey,R;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?R=fA(T,n.dataKey,i):R=a(T,e,c,j),Array.isArray(R))R.forEach(S=>{var A=kw(kw({},g),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});m.push(_x({tooltipEntrySettings:A,dataKey:S.dataKey,payload:S.payload,value:Tr(S.payload,S.dataKey),name:S.name}))});else{var D;m.push(_x({tooltipEntrySettings:g,dataKey:E,payload:R,value:Tr(R,E),name:(D=Tr(R,j))!==null&&D!==void 0?D:g?.name}))}return m},h)}},jt=t=>{var e=tt(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Zs=t=>t.tooltip.settings.axisId,Wt=t=>{var e=jt(t),r=Zs(t);return Mc(t,e,r)},Ay=V([Wt,tt,WI,ly,jt],dP),q7=V([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),K7=V([jt,Zs],qI),Th=V([q7,Wt,K7],GI),G7=V([Th],ZI),Xa=V([G7,Ya],XI),Sy=V([Xa,Wt,Th],QI),Y7=V([Wt],gy),Z7=V([Xa,Th,ph],eP),X7=V([Z7,Ya,jt],tP),Q7=V([Th],YI),J7=V([Xa,Wt,Q7,jt],rP),eK=V([nP,jt,Zs],Ks),tK=V([eK,jt],sP),rK=V([iP,jt,Zs],Ks),nK=V([rK,jt],oP),iK=V([aP,jt,Zs],Ks),aK=V([iK,jt],cP),sK=V([tK,aK,nK],yy),oK=V([Wt,Y7,X7,J7,sK],lP),OP=V([Wt,tt,Xa,Sy,ph,jt,oK],uP),cK=V([OP,Wt,Ay],hP),lK=V([Wt,OP,cK,jt],fP),RP=t=>{var e=jt(t),r=Zs(t),n=!1;return Vc(t,e,r,n)},DP=V([Wt,RP],gh),MP=V([Wt,Ay,lK,DP],by),uK=V([tt,Sy,Wt,jt],vP),dK=V([tt,Sy,Wt,jt],bP),hK=(t,e,r,n,i,a,s,o)=>{if(e){var{type:c}=e,l=Hi(t,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return h=o==="angleAxis"&&i!=null&&i?.length>=2?Lr(i[0]-i[1])*2*h:h,l&&s?s.map((m,p)=>({coordinate:n(m)+h,value:m,index:p,offset:h})):n.domain().map((m,p)=>({coordinate:n(m)+h,value:a?a[m]:m,index:p,offset:h}))}}},oi=V([tt,Wt,Ay,MP,RP,uK,dK,jt],hK),Iy=V([_P,EP,P7],(t,e,r)=>TP(r.shared,t,e)),LP=t=>t.tooltip.settings.trigger,Py=t=>t.tooltip.settings.defaultIndex,Ah=V([Ys,Iy,LP,Py],CP),fc=V([Ah,Xa],Ty),$P=V([oi,fc],AP),fK=V([Ah],t=>{if(t)return t.dataKey}),VP=V([Ys,Iy,LP,Py],NP),mK=V([ni,ii,tt,Ht,oi,Py,VP,zc],kP),pK=V([Ah,mK],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),gK=V([Ah],t=>t.active),yK=V([VP,fc,Ya,Wt,$P,zc,Iy],jP),vK=V([yK],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function Nw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nw(Object(r),!0).forEach(function(n){bK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bK(t,e,r){return(e=xK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xK(t){var e=wK(t,"string");return typeof e=="symbol"?e:e+""}function wK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _K=()=>ie(Wt),EK=()=>{var t=_K(),e=ie(oi),r=ie(MP);return _m(jw(jw({},t),{},{scale:r}),e)},TK=()=>ie(ly),Cy=(t,e)=>e,zP=(t,e,r)=>r,ky=(t,e,r,n)=>n,AK=V(oi,t=>rh(t,e=>e.coordinate)),Ny=V([Ys,Cy,zP,ky],CP),FP=V([Ny,Xa],Ty),SK=(t,e,r)=>{if(e!=null){var n=Ys(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},UP=V([Ys,Cy,zP,ky],NP),Qu=V([ni,ii,tt,Ht,oi,ky,UP,zc],kP),IK=V([Ny,Qu],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),BP=V(oi,FP,AP),PK=V([UP,FP,Ya,Wt,BP,zc,Cy],jP),CK=V([Ny],t=>({isActive:t.active,activeIndex:t.index})),kK=(t,e,r,n,i,a,s,o)=>{if(!(!t||!e||!n||!i||!a)){var c=cB(t.chartX,t.chartY,e,r,o);if(c){var l=uB(c,e),d=X9(l,s,a,n,i),h=lB(e,a,d,c);return{activeIndex:String(d),activeCoordinate:h}}}};function Um(){return Um=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Um.apply(null,arguments)}function Ow(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ll(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ow(Object(r),!0).forEach(function(n){NK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ow(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NK(t,e,r){return(e=jK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RK(t){var{coordinate:e,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:c,chartName:l}=t,d=e,h=r,m=n;if(!o||!d||l!=="ScatterChart"&&c!=="axis")return null;var p,v;if(l==="ScatterChart")p=d,v=XB;else if(l==="BarChart")p=QB(s,d,i,a),v=k8;else if(s==="radial"){var{cx:b,cy:g,radius:_,startAngle:T,endAngle:E}=VS(d);p={cx:b,cy:g,startAngle:T,endAngle:E,innerRadius:_,outerRadius:_},v=R8}else p={points:D8(s,d,i)},v=NS;var j=typeof o=="object"&&"className"in o?o.className:void 0,R=Ll(Ll(Ll(Ll({stroke:"#ccc",pointerEvents:"none"},i),p),Ke(o,!1)),{},{payload:h,payloadIndex:m,className:Le("recharts-tooltip-cursor",j)});return w.isValidElement(o)?w.cloneElement(o,R):w.createElement(v,R)}function DK(t){var e=EK(),r=SS(),n=Mg(),i=TK();return w.createElement(RK,Um({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var HP=w.createContext(null),MK=()=>w.useContext(HP),WP={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,l,d){this.fn=c,this.context=l,this.once=d||!1}function a(c,l,d,h,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,h||c,m),v=r?r+l:l;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],d,h;if(this._eventsCount===0)return l;for(h in d=this._events)e.call(d,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(d)):l},o.prototype.listeners=function(l){var d=r?r+l:l,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,v=new Array(p);m<p;m++)v[m]=h[m].fn;return v},o.prototype.listenerCount=function(l){var d=r?r+l:l,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,d,h,m,p,v){var b=r?r+l:l;if(!this._events[b])return!1;var g=this._events[b],_=arguments.length,T,E;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,h),!0;case 4:return g.fn.call(g.context,d,h,m),!0;case 5:return g.fn.call(g.context,d,h,m,p),!0;case 6:return g.fn.call(g.context,d,h,m,p,v),!0}for(E=1,T=new Array(_-1);E<_;E++)T[E-1]=arguments[E];g.fn.apply(g.context,T)}else{var j=g.length,R;for(E=0;E<j;E++)switch(g[E].once&&this.removeListener(l,g[E].fn,void 0,!0),_){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,d);break;case 3:g[E].fn.call(g[E].context,d,h);break;case 4:g[E].fn.call(g[E].context,d,h,m);break;default:if(!T)for(R=1,T=new Array(_-1);R<_;R++)T[R-1]=arguments[R];g[E].fn.apply(g[E].context,T)}}return!0},o.prototype.on=function(l,d,h){return a(this,l,d,h,!1)},o.prototype.once=function(l,d,h){return a(this,l,d,h,!0)},o.prototype.removeListener=function(l,d,h,m){var p=r?r+l:l;if(!this._events[p])return this;if(!d)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===d&&(!m||v.once)&&(!h||v.context===h)&&s(this,p);else{for(var b=0,g=[],_=v.length;b<_;b++)(v[b].fn!==d||m&&!v[b].once||h&&v[b].context!==h)&&g.push(v[b]);g.length?this._events[p]=g.length===1?g[0]:g:s(this,p)}return this},o.prototype.removeAllListeners=function(l){var d;return l?(d=r?r+l:l,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(WP);var LK=WP.exports;const $K=zi(LK);var mc=new $K,Bm="recharts.syncEvent.tooltip",Rw="recharts.syncEvent.brush";function VK(t,e){if(e){var r=Number.parseInt(e,10);if(!Vr(r))return t?.[r]}}var zK={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},qP=Br({name:"options",initialState:zK,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),FK=qP.reducer,{createEventEmitter:UK}=qP.actions;function BK(t){return t.tooltip.syncInteraction}var HK={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},KP=Br({name:"chartData",initialState:HK,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:Dw,setDataStartEndIndexes:WK,setComputedData:eee}=KP.actions,qK=KP.reducer,GP=()=>{};function KK(){var t=ie(uy),e=ie(dy),r=sr(),n=ie(zI),i=ie(oi),a=Mg(),s=Dg(),o=ie(c=>c.rootProps.className);w.useEffect(()=>{if(t==null)return GP;var c=(l,d,h)=>{if(e!==h&&t===l){if(n==="index"){r(d);return}if(i!=null){var m;if(typeof n=="function"){var p={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},v=n(i,p);m=i[v]}else n==="value"&&(m=i.find(D=>String(D.value)===d.payload.label));var{coordinate:b}=d.payload;if(m==null||d.payload.active===!1||b==null||s==null){r(zm({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:g,y:_}=b,T=Math.min(g,s.x+s.width),E=Math.min(_,s.y+s.height),j={x:a==="horizontal"?m.coordinate:T,y:a==="horizontal"?E:m.coordinate},R=zm({active:d.payload.active,coordinate:j,dataKey:d.payload.dataKey,index:String(m.index),label:d.payload.label});r(R)}}};return mc.on(Bm,c),()=>{mc.off(Bm,c)}},[o,r,e,t,n,i,a,s])}function GK(){var t=ie(uy),e=ie(dy),r=sr();w.useEffect(()=>{if(t==null)return GP;var n=(i,a,s)=>{e!==s&&t===i&&r(WK(a))};return mc.on(Rw,n),()=>{mc.off(Rw,n)}},[r,e,t])}function YK(){var t=sr();w.useEffect(()=>{t(UK())},[t]),KK(),GK()}function ZK(t,e,r,n,i,a){var s=ie(m=>SK(m,t,e)),o=ie(dy),c=ie(uy),l=ie(zI),d=ie(BK),h=d?.active;w.useEffect(()=>{if(!h&&c!=null&&o!=null){var m=zm({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});mc.emit(Bm,c,m,o)}},[h,r,s,i,n,o,c,l,a])}function Mw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Lw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mw(Object(r),!0).forEach(function(n){XK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XK(t,e,r){return(e=QK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QK(t){var e=JK(t,"string");return typeof e=="symbol"?e:e+""}function JK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eG(t){return t.dataKey}function tG(t,e){return w.isValidElement(t)?w.cloneElement(t,e):typeof t=="function"?w.createElement(t,e):w.createElement(CB,e)}var $w=[],rG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Nc.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Vw(t){var e=qa(t,rG),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:c,offset:l,payloadUniqBy:d,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:v,cursor:b,shared:g,trigger:_,defaultIndex:T,portal:E,axisId:j}=e,R=sr(),D=typeof T=="number"?String(T):T;w.useEffect(()=>{R(j7({shared:g,trigger:_,axisId:j,active:r,defaultIndex:D}))},[R,g,_,j,r,D]);var S=Dg(),A=kS(),P=I7(g),{activeIndex:O,isActive:N}=ie(ze=>CK(ze,P,_,D)),C=ie(ze=>PK(ze,P,_,D)),k=ie(ze=>BP(ze,P,_,D)),Q=ie(ze=>IK(ze,P,_,D)),ce=C,X=MK(),ee=r??N,[fe,ye]=YU([ce,ee]),Ue=P==="axis"?k:void 0;ZK(P,_,Q,Ue,O,ee);var se=E??X;if(se==null)return null;var q=ce??$w;ee||(q=$w),o&&q.length&&(q=fU(ce.filter(ze=>ze.value!=null&&(ze.hide!==!0||e.includeHidden)),d,eG));var J=q.length>0,rt=w.createElement(MB,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:c,active:ee,coordinate:Q,hasPayload:J,offset:l,position:h,reverseDirection:m,useTranslate3d:p,viewBox:S,wrapperStyle:v,lastBoundingBox:fe,innerRef:ye,hasPortalFromProps:!!E},tG(s,Lw(Lw({},e),{},{payload:q,label:Ue,active:ee,coordinate:Q,accessibilityLayer:A})));return w.createElement(w.Fragment,null,Jm.createPortal(rt,se),ee&&w.createElement(DK,{cursor:b,tooltipEventType:P,coordinate:Q,payload:ce,index:O}))}var YP={},ZP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=0,i={}){typeof i!="object"&&(i={});let a=null,s=null,o=null,c=0,l=null,d;const{leading:h=!1,trailing:m=!0,maxWait:p}=i,v="maxWait"in i,b=v?Math.max(Number(p)||0,n):0,g=S=>(a!==null&&(d=r.apply(s,a)),a=s=null,c=S,d),_=S=>(c=S,l=setTimeout(R,n),h&&a!==null?g(S):d),T=S=>(l=null,m&&a!==null?g(S):d),E=S=>{if(o===null)return!0;const A=S-o,P=A>=n||A<0,O=v&&S-c>=b;return P||O},j=S=>{const A=o===null?0:S-o,P=n-A,O=b-(S-c);return v?Math.min(P,O):P},R=()=>{const S=Date.now();if(E(S))return T(S);l=setTimeout(R,j(S))},D=function(...S){const A=Date.now(),P=E(A);if(a=S,s=this,o=A,P){if(l===null)return _(A);if(v)return clearTimeout(l),l=setTimeout(R,n),g(A)}return l===null&&(l=setTimeout(R,n)),d};return D.cancel=()=>{l!==null&&clearTimeout(l),c=0,o=a=s=l=null},D.flush=()=>l===null?d:T(Date.now()),D}t.debounce=e})(ZP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZP;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return e.debounce(n,i,{leading:s,maxWait:i,trailing:o})}t.throttle=r})(YP);var nG=YP.throttle;const iG=zi(nG);var Uo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function zw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _f(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zw(Object(r),!0).forEach(function(n){aG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aG(t,e,r){return(e=sG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sG(t){var e=oG(t,"string");return typeof e=="symbol"?e:e+""}function oG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fw=w.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:c,children:l,debounce:d=0,id:h,className:m,onResize:p,style:v={}}=t,b=w.useRef(null),g=w.useRef();g.current=p,w.useImperativeHandle(e,()=>b.current);var[_,T]=w.useState({containerWidth:n.width,containerHeight:n.height}),E=w.useCallback((R,D)=>{T(S=>{var A=Math.round(R),P=Math.round(D);return S.containerWidth===A&&S.containerHeight===P?S:{containerWidth:A,containerHeight:P}})},[]);w.useEffect(()=>{var R=P=>{var O,{width:N,height:C}=P[0].contentRect;E(N,C),(O=g.current)===null||O===void 0||O.call(g,N,C)};d>0&&(R=iG(R,d,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),{width:S,height:A}=b.current.getBoundingClientRect();return E(S,A),D.observe(b.current),()=>{D.disconnect()}},[E,d]);var j=w.useMemo(()=>{var{containerWidth:R,containerHeight:D}=_;if(R<0||D<0)return null;Uo(da(i)||da(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),Uo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=da(i)?R:i,A=da(a)?D:a;return r&&r>0&&(S?A=S/r:A&&(S=A*r),c&&A>c&&(A=c)),Uo(S>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,A,i,a,s,o,r),w.Children.map(l,P=>w.cloneElement(P,{width:S,height:A,style:_f({width:S,height:A},P.props.style)}))},[r,l,a,c,o,s,_,i]);return w.createElement("div",{id:h?"".concat(h):void 0,className:Le("recharts-responsive-container",m),style:_f(_f({},v),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:c}),ref:b},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))});function Uw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Hm(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uw(Object(r),!0).forEach(function(n){cG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cG(t,e,r){return(e=lG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lG(t){var e=uG(t,"string");return typeof e=="symbol"?e:e+""}function uG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ss={widthCache:{},cacheCount:0},dG=2e3,hG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Bw="recharts_measurement_span";function fG(t){var e=Hm({},t);return Object.keys(e).forEach(r=>{e[r]||delete e[r]}),e}var Bo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Nc.isSsr)return{width:0,height:0};var n=fG(r),i=JSON.stringify({text:e,copyStyle:n});if(ss.widthCache[i])return ss.widthCache[i];try{var a=document.getElementById(Bw);a||(a=document.createElement("span"),a.setAttribute("id",Bw),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=Hm(Hm({},hG),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),c={width:o.width,height:o.height};return ss.widthCache[i]=c,++ss.cacheCount>dG&&(ss.cacheCount=0,ss.widthCache={}),c}catch{return{width:0,height:0}}},Hw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ww=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,mG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,pG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,XP={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},gG=Object.keys(XP),fs="NaN";function yG(t,e){return t*XP[e]}class cr{static parse(e){var r,[,n,i]=(r=pG.exec(e))!==null&&r!==void 0?r:[];return new cr(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Vr(e)&&(this.unit=""),r!==""&&!mG.test(r)&&(this.num=NaN,this.unit=""),gG.includes(r)&&(this.num=yG(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new cr(NaN,""):new cr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new cr(NaN,""):new cr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new cr(NaN,""):new cr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new cr(NaN,""):new cr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vr(this.num)}}function QP(t){if(t.includes(fs))return fs;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=Hw.exec(e))!==null&&r!==void 0?r:[],s=cr.parse(n??""),o=cr.parse(a??""),c=i==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return fs;e=e.replace(Hw,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var l,[,d,h,m]=(l=Ww.exec(e))!==null&&l!==void 0?l:[],p=cr.parse(d??""),v=cr.parse(m??""),b=h==="+"?p.add(v):p.subtract(v);if(b.isNaN())return fs;e=e.replace(Ww,b.toString())}return e}var qw=/\(([^()]*)\)/;function vG(t){for(var e=t,r;(r=qw.exec(e))!=null;){var[,n]=r;e=e.replace(qw,QP(n))}return e}function bG(t){var e=t.replace(/\s+/g,"");return e=vG(e),e=QP(e),e}function xG(t){try{return bG(t)}catch{return fs}}function Ef(t){var e=xG(t.slice(5,-1));return e===fs?"":e}var wG=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],_G=["dx","dy","angle","className","breakAll"];function Wm(){return Wm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wm.apply(null,arguments)}function Kw(t,e){if(t==null)return{};var r,n,i=EG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function EG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var JP=/[ \f\n\r\t\v\u2028\u2029]+/,eC=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];ut(e)||(r?i=e.toString().split(""):i=e.toString().split(JP));var a=i.map(o=>({word:o,width:Bo(o,n).width})),s=r?0:Bo(" ",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},TG=(t,e,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:c}=t,l=te(a),d=s,h=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((C,k)=>{var{word:Q,width:ce}=k,X=C[C.length-1];if(X&&(n==null||i||X.width+ce+r<Number(n)))X.words.push(Q),X.width+=ce+r;else{var ee={words:[Q],width:ce};C.push(ee)}return C},[])},m=h(e),p=O=>O.reduce((N,C)=>N.width>C.width?N:C);if(!l||i)return m;var v=m.length>a||p(m).width>Number(n);if(!v)return m;for(var b="…",g=O=>{var N=d.slice(0,O),C=eC({breakAll:c,style:o,children:N+b}).wordsWithComputedWidth,k=h(C),Q=k.length>a||p(k).width>Number(n);return[Q,k]},_=0,T=d.length-1,E=0,j;_<=T&&E<=d.length-1;){var R=Math.floor((_+T)/2),D=R-1,[S,A]=g(D),[P]=g(R);if(!S&&!P&&(_=R+1),S&&P&&(T=R-1),!S&&P){j=A;break}E++}return j||m},Gw=t=>{var e=ut(t)?[]:t.toString().split(JP);return[{words:e}]},AG=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=t;if((e||r)&&!Nc.isSsr){var o,c,l=eC({breakAll:a,children:n,style:i});if(l){var{wordsWithComputedWidth:d,spaceWidth:h}=l;o=d,c=h}else return Gw(n);return TG({breakAll:a,children:n,maxLines:s,style:i},o,c,e,r)}return Gw(n)},Yw="#808080",jy=w.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:l=Yw}=t,d=Kw(t,wG),h=w.useMemo(()=>AG({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:m,dy:p,angle:v,className:b,breakAll:g}=d,_=Kw(d,_G);if(!In(r)||!In(n))return null;var T=r+(te(m)?m:0),E=n+(te(p)?p:0),j;switch(c){case"start":j=Ef("calc(".concat(a,")"));break;case"middle":j=Ef("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:j=Ef("calc(".concat(h.length-1," * -").concat(i,")"));break}var R=[];if(s){var D=h[0].width,{width:S}=d;R.push("scale(".concat(te(S)?S/D:1,")"))}return v&&R.push("rotate(".concat(v,", ").concat(T,", ").concat(E,")")),R.length&&(_.transform=R.join(" ")),w.createElement("text",Wm({},Ke(_,!0),{ref:e,x:T,y:E,className:Le("recharts-text",b),textAnchor:o,fill:l.includes("url")?Yw:l}),h.map((A,P)=>{var O=A.words.join(g?"":" ");return w.createElement("tspan",{x:T,dy:P===0?j:i,key:"".concat(O,"-").concat(P)},O)}))});jy.displayName="Text";var SG=["offset"],IG=["labelRef"];function Zw(t,e){if(t==null)return{};var r,n,i=PG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function PG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Xw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xw(Object(r),!0).forEach(function(n){CG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CG(t,e,r){return(e=kG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kG(t){var e=NG(t,"string");return typeof e=="symbol"?e:e+""}function NG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $n(){return $n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$n.apply(null,arguments)}var jG=t=>{var{value:e,formatter:r}=t,n=ut(t.children)?e:t.children;return typeof r=="function"?r(n):n},Oy=t=>t!=null&&typeof t=="function",OG=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),360);return r*n},RG=(t,e,r)=>{var{position:n,viewBox:i,offset:a,className:s}=t,{cx:o,cy:c,innerRadius:l,outerRadius:d,startAngle:h,endAngle:m,clockWise:p}=i,v=(l+d)/2,b=OG(h,m),g=b>=0?1:-1,_,T;n==="insideStart"?(_=h+g*a,T=p):n==="insideEnd"?(_=m-g*a,T=!p):n==="end"&&(_=m+g*a,T=p),T=b<=0?T:!T;var E=Ut(o,c,v,_),j=Ut(o,c,v,_+(T?1:-1)*359),R="M".concat(E.x,",").concat(E.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(T?0:1,`,
    `).concat(j.x,",").concat(j.y),D=ut(t.id)?sc("recharts-radial-line-"):t.id;return w.createElement("text",$n({},r,{dominantBaseline:"central",className:Le("recharts-radial-bar-label",s)}),w.createElement("defs",null,w.createElement("path",{id:D,d:R})),w.createElement("textPath",{xlinkHref:"#".concat(D)},e))},DG=t=>{var{viewBox:e,offset:r,position:n}=t,{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:c,endAngle:l}=e,d=(c+l)/2;if(n==="outside"){var{x:h,y:m}=Ut(i,a,o+r,d);return{x:h,y:m,textAnchor:h>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:v,y:b}=Ut(i,a,p,d);return{x:v,y:b,textAnchor:"middle",verticalAnchor:"middle"}},MG=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,{x:a,y:s,width:o,height:c}=e,l=c>=0?1:-1,d=l*n,h=l>0?"end":"start",m=l>0?"start":"end",p=o>=0?1:-1,v=p*n,b=p>0?"end":"start",g=p>0?"start":"end";if(i==="top"){var _={x:a+o/2,y:s-l*n,textAnchor:"middle",verticalAnchor:h};return mt(mt({},_),r?{height:Math.max(s-r.y,0),width:o}:{})}if(i==="bottom"){var T={x:a+o/2,y:s+c+d,textAnchor:"middle",verticalAnchor:m};return mt(mt({},T),r?{height:Math.max(r.y+r.height-(s+c),0),width:o}:{})}if(i==="left"){var E={x:a-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"};return mt(mt({},E),r?{width:Math.max(E.x-r.x,0),height:c}:{})}if(i==="right"){var j={x:a+o+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return mt(mt({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:c}:{})}var R=r?{width:o,height:c}:{};return i==="insideLeft"?mt({x:a+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},R):i==="insideRight"?mt({x:a+o-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"},R):i==="insideTop"?mt({x:a+o/2,y:s+d,textAnchor:"middle",verticalAnchor:m},R):i==="insideBottom"?mt({x:a+o/2,y:s+c-d,textAnchor:"middle",verticalAnchor:h},R):i==="insideTopLeft"?mt({x:a+v,y:s+d,textAnchor:g,verticalAnchor:m},R):i==="insideTopRight"?mt({x:a+o-v,y:s+d,textAnchor:b,verticalAnchor:m},R):i==="insideBottomLeft"?mt({x:a+v,y:s+c-d,textAnchor:g,verticalAnchor:h},R):i==="insideBottomRight"?mt({x:a+o-v,y:s+c-d,textAnchor:b,verticalAnchor:h},R):i&&typeof i=="object"&&(te(i.x)||da(i.x))&&(te(i.y)||da(i.y))?mt({x:a+$i(i.x,o),y:s+$i(i.y,c),textAnchor:"end",verticalAnchor:"end"},R):mt({x:a+o/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},R)},LG=t=>"cx"in t&&te(t.cx);function xr(t){var{offset:e=5}=t,r=Zw(t,SG),n=mt({offset:e},r),{viewBox:i,position:a,value:s,children:o,content:c,className:l="",textBreakAll:d,labelRef:h}=n,m=Dg(),p=i||m;if(!p||ut(s)&&ut(o)&&!w.isValidElement(c)&&typeof c!="function")return null;if(w.isValidElement(c)){var{labelRef:v}=n,b=Zw(n,IG);return w.cloneElement(c,b)}var g;if(typeof c=="function"){if(g=w.createElement(c,n),w.isValidElement(g))return g}else g=jG(n);var _=LG(p),T=Ke(n,!0);if(_&&(a==="insideStart"||a==="insideEnd"||a==="end"))return RG(n,g,T);var E=_?DG(n):MG(n,p);return w.createElement(jy,$n({ref:h,className:Le("recharts-label",l)},T,E,{breakAll:d}),g)}xr.displayName="Label";var tC=t=>{var{cx:e,cy:r,angle:n,startAngle:i,endAngle:a,r:s,radius:o,innerRadius:c,outerRadius:l,x:d,y:h,top:m,left:p,width:v,height:b,clockWise:g,labelViewBox:_}=t;if(_)return _;if(te(v)&&te(b)){if(te(d)&&te(h))return{x:d,y:h,width:v,height:b};if(te(m)&&te(p))return{x:m,y:p,width:v,height:b}}if(te(d)&&te(h))return{x:d,y:h,width:0,height:0};if(te(e)&&te(r))return{cx:e,cy:r,startAngle:i||n||0,endAngle:a||n||0,innerRadius:c||0,outerRadius:l||o||s||0,clockWise:g};if(t.viewBox)return t.viewBox},$G=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?w.createElement(xr,$n({key:"label-implicit"},n)):In(t)?w.createElement(xr,$n({key:"label-implicit",value:t},n)):w.isValidElement(t)?t.type===xr?w.cloneElement(t,mt({key:"label-implicit"},n)):w.createElement(xr,$n({key:"label-implicit",content:t},n)):Oy(t)?w.createElement(xr,$n({key:"label-implicit",content:t},n)):t&&typeof t=="object"?w.createElement(xr,$n({},t,{key:"label-implicit"},n)):null},VG=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:i,labelRef:a}=e,s=tC(e),o=pA(i,xr).map((l,d)=>w.cloneElement(l,{viewBox:r||s,key:"label-".concat(d)}));if(!n)return o;var c=$G(e.label,r||s,a);return[c,...o]};xr.parseViewBox=tC;xr.renderCallByParent=VG;var rC={},nC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(nC);var iC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(iC);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nC,r=iC,n=Xd;function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(rC);var zG=rC.last;const FG=zi(zG);var UG=["valueAccessor"],BG=["data","dataKey","clockWise","id","textBreakAll"];function Ju(){return Ju=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ju.apply(null,arguments)}function Qw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qw(Object(r),!0).forEach(function(n){HG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HG(t,e,r){return(e=WG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WG(t){var e=qG(t,"string");return typeof e=="symbol"?e:e+""}function qG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e_(t,e){if(t==null)return{};var r,n,i=KG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function KG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var GG=t=>Array.isArray(t.value)?FG(t.value):t.value;function Ea(t){var{valueAccessor:e=GG}=t,r=e_(t,UG),{data:n,dataKey:i,clockWise:a,id:s,textBreakAll:o}=r,c=e_(r,BG);return!n||!n.length?null:w.createElement(Vi,{className:"recharts-label-list"},n.map((l,d)=>{var h=ut(i)?e(l,d):Tr(l&&l.payload,i),m=ut(s)?{}:{id:"".concat(s,"-").concat(d)};return w.createElement(xr,Ju({},Ke(l,!0),c,m,{parentViewBox:l.parentViewBox,value:h,textBreakAll:o,viewBox:xr.parseViewBox(ut(a)?l:Jw(Jw({},l),{},{clockWise:a})),key:"label-".concat(d),index:d}))}))}Ea.displayName="LabelList";function YG(t,e){return t?t===!0?w.createElement(Ea,{key:"labelList-implicit",data:e}):w.isValidElement(t)||Oy(t)?w.createElement(Ea,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?w.createElement(Ea,Ju({data:e},t,{key:"labelList-implicit"})):null:null}function ZG(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:n}=t,i=pA(n,Ea).map((s,o)=>w.cloneElement(s,{data:e,key:"labelList-".concat(o)}));if(!r)return i;var a=YG(t.label,e);return[a,...i]}Ea.renderCallByParent=ZG;function qm(){return qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qm.apply(null,arguments)}var aC=t=>{var{cx:e,cy:r,r:n,className:i}=t,a=Le("recharts-dot",i);return e===+e&&r===+r&&n===+n?w.createElement("circle",qm({},Ke(t,!1),vg(t),{className:a,cx:e,cy:r,r:n})):null},XG={radiusAxis:{},angleAxis:{}},sC=Br({name:"polarAxis",initialState:XG,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:tee,removeRadiusAxis:ree,addAngleAxis:nee,removeAngleAxis:iee}=sC.actions,QG=sC.reducer,JG={countOfBars:0,cartesianItems:[],polarItems:[]},oC=Br({name:"graphicalItems",initialState:JG,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,i=Bn(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},removeCartesianGraphicalItem(t,e){var r=Bn(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Bn(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addBar:aee,removeBar:see,addCartesianGraphicalItem:eY,replaceCartesianGraphicalItem:tY,removeCartesianGraphicalItem:rY,addPolarGraphicalItem:oee,removePolarGraphicalItem:cee}=oC.actions,nY=oC.reducer;function t_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function r_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?t_(Object(r),!0).forEach(function(n){iY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):t_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iY(t,e,r){return(e=aY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aY(t){var e=sY(t,"string");return typeof e=="symbol"?e:e+""}function sY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oY(t){var e=sr(),r=w.useRef(null);return w.useEffect(()=>{var n=r_(r_({},t),{},{stackId:iB(t.stackId)});r.current===null?e(eY(n)):r.current!==n&&e(tY({prev:r.current,next:n})),r.current=n},[e,t]),w.useEffect(()=>()=>{r.current&&(e(rY(r.current)),r.current=null)},[e]),null}function cY(t){var{fn:e,args:r}=t,n=sr(),i=mr();return w.useEffect(()=>{if(!i){var a=e(r);return n(k7(a)),()=>{n(N7(a))}}},[e,r,n,i]),null}var lY=()=>{};function uY(t){var{legendPayload:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?lY:(r(_B(e)),()=>{r(EB(e))}),[r,n,e]),null}function dY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(sc(e)),n=w.useRef(t);return n.current!==t&&(r.current=sc(e),n.current=t),r.current}var hY=V([Ht],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),fY=V([hY,ni,ii],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),mY=t=>{var e=mr();return ie(r=>Eh(r,"xAxis",t,e))},pY=t=>{var e=mr();return ie(r=>Eh(r,"yAxis",t,e))},Ry=()=>ie(fY),gY=()=>ie(vK);function n_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function i_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?n_(Object(r),!0).forEach(function(n){yY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function yY(t,e,r){return(e=vY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vY(t){var e=bY(t,"string");return typeof e=="symbol"?e:e+""}function bY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xY=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=t;if(i===!1||e.x==null||e.y==null)return null;var s=i_(i_({index:r,dataKey:a,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},Ke(i,!1)),vg(i)),o;return w.isValidElement(i)?o=w.cloneElement(i,s):typeof i=="function"?o=i(s):o=w.createElement(aC,s),w.createElement(Vi,{className:"recharts-active-dot"},o)};function wY(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:i}=t,a=ie(fc),s=gY();if(e==null||s==null)return null;var o=e.find(c=>s.includes(c.payload));return ut(o)?null:xY({point:o,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var _Y=["children"];function EY(t,e){if(t==null)return{};var r,n,i=TY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function TY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var a_=()=>{},cC=w.createContext({addErrorBar:a_,removeErrorBar:a_}),AY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},lC=w.createContext(AY);function SY(t){var{children:e}=t,r=EY(t,_Y);return w.createElement(lC.Provider,{value:r},e)}var IY=()=>w.useContext(lC),PY=t=>{var{children:e,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,data:s,stackId:o,hide:c,type:l,barSize:d}=t,[h,m]=w.useState([]),p=w.useCallback(g=>{m(_=>[..._,g])},[m]),v=w.useCallback(g=>{m(_=>_.filter(T=>T!==g))},[m]),b=mr();return w.createElement(cC.Provider,{value:{addErrorBar:p,removeErrorBar:v}},w.createElement(oY,{type:l,data:s,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,errorBars:h,stackId:o,hide:c,barSize:d,isPanorama:b}),e)};function CY(t){var{addErrorBar:e,removeErrorBar:r}=w.useContext(cC);return w.useEffect(()=>(e(t),()=>{r(t)}),[e,r,t]),null}var kY=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function uC(t,e,r){return(e=NY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NY(t){var e=jY(t,"string");return typeof e=="symbol"?e:e+""}function jY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pc(){return pc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pc.apply(null,arguments)}function OY(t,e){if(t==null)return{};var r,n,i=RY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function RY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function DY(t){var{direction:e,width:r,dataKey:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o}=t,c=OY(t,kY),l=Ke(c,!1),{data:d,dataPointFormatter:h,xAxisId:m,yAxisId:p,errorBarOffset:v}=IY(),b=mY(m),g=pY(p);if(b?.scale==null||g?.scale==null||d==null||e==="x"&&b.type!=="number")return null;var _=d.map(T=>{var{x:E,y:j,value:R,errorVal:D}=h(T,n,e);if(!D)return null;var S=[],A,P;if(Array.isArray(D)?[A,P]=D:A=P=D,e==="x"){var{scale:O}=b,N=j+v,C=N+r,k=N-r,Q=O(R-A),ce=O(R+P);S.push({x1:ce,y1:C,x2:ce,y2:k}),S.push({x1:Q,y1:N,x2:ce,y2:N}),S.push({x1:Q,y1:C,x2:Q,y2:k})}else if(e==="y"){var{scale:X}=g,ee=E+v,fe=ee-r,ye=ee+r,Ue=X(R-A),se=X(R+P);S.push({x1:fe,y1:se,x2:ye,y2:se}),S.push({x1:ee,y1:Ue,x2:ee,y2:se}),S.push({x1:fe,y1:Ue,x2:ye,y2:Ue})}var q="".concat(E+v,"px ").concat(j+v,"px");return w.createElement(Vi,pc({className:"recharts-errorBar",key:"bar-".concat(S.map(J=>"".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)))},l),S.map(J=>{var rt=i?{transformOrigin:"".concat(J.x1-5,"px")}:void 0;return w.createElement(Vu,{from:{transform:"scaleY(0)",transformOrigin:q},to:{transform:"scaleY(1)",transformOrigin:q},begin:a,easing:o,isActive:i,duration:s,key:"line-".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2),style:{transformOrigin:q}},w.createElement("line",pc({},J,{style:rt})))}))});return w.createElement(Vi,{className:"recharts-errorBars"},_)}var dC=w.createContext(void 0);function MY(t){var e=w.useContext(dC);return t??e??"x"}function LY(t){var{direction:e,children:r}=t;return w.createElement(dC.Provider,{value:e},r)}var hC={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function $Y(t){var e=MY(t.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s}=qa(t,hC);return w.createElement(w.Fragment,null,w.createElement(CY,{dataKey:t.dataKey,direction:e}),w.createElement(DY,pc({},t,{direction:e,width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s})))}class fC extends w.Component{render(){return w.createElement($Y,this.props)}}uC(fC,"defaultProps",hC);uC(fC,"displayName","ErrorBar");function mC(t,e){var r,n,i=ie(l=>si(l,t)),a=ie(l=>Ki(l,e)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:yr.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:vr.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function VY(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=Ry(),{needClipX:a,needClipY:s,needClip:o}=mC(e,r);if(!o)return null;var{x:c,y:l,width:d,height:h}=i;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?c:c-d/2,y:s?l:l-h/2,width:a?d:d*2,height:s?h:h*2}))}var zY=t=>{var{chartData:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?()=>{}:(r(Dw(e)),()=>{r(Dw(void 0))}),[e,r,n]),null},s_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},pC=Br({name:"brush",initialState:s_,reducers:{setBrushSettings(t,e){return e.payload==null?s_:e.payload}}}),{setBrushSettings:lee}=pC.actions,FY=pC.reducer;function UY(t,e,r){return(e=BY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BY(t){var e=HY(t,"string");return typeof e=="symbol"?e:e+""}function HY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dy{static create(e){return new Dy(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}UY(Dy,"EPS",1e-4);function WY(t){return(t%180+180)%180}var qY=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=WY(i),s=a*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},KY={dots:[],areas:[],lines:[]},gC=Br({name:"referenceElements",initialState:KY,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Bn(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Bn(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Bn(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:uee,removeDot:dee,addArea:hee,removeArea:fee,addLine:mee,removeLine:pee}=gC.actions,GY=gC.reducer,YY=w.createContext(void 0),ZY=t=>{var{children:e}=t,[r]=w.useState("".concat(sc("recharts"),"-clip")),n=Ry();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return w.createElement(YY.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:i,y:a,height:o,width:s}))),e)};function Tf(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function yC(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function XY(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return qY(n,r)}function QY(t,e,r){var n=r==="width",{x:i,y:a,width:s,height:o}=t;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function ed(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function JY(t,e){return yC(t,e+1)}function eZ(t,e,r,n,i){for(var a=(n||[]).slice(),{start:s,end:o}=e,c=0,l=1,d=s,h=function(){var v=n?.[c];if(v===void 0)return{v:yC(n,l)};var b=c,g,_=()=>(g===void 0&&(g=r(v,b)),g),T=v.coordinate,E=c===0||ed(t,T,_,d,o);E||(c=0,d=s,l+=1),E&&(d=T+t*(_()/2+i),c+=l)},m;l<=a.length;)if(m=h(),m)return m.v;return[]}function o_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?o_(Object(r),!0).forEach(function(n){tZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function tZ(t,e,r){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iZ(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:o}=e,{end:c}=e,l=function(m){var p=a[m],v,b=()=>(v===void 0&&(v=r(p,m)),v);if(m===s-1){var g=t*(p.coordinate+t*b()/2-c);a[m]=p=Zt(Zt({},p),{},{tickCoord:g>0?p.coordinate-g*t:p.coordinate})}else a[m]=p=Zt(Zt({},p),{},{tickCoord:p.coordinate});var _=ed(t,p.tickCoord,b,o,c);_&&(c=p.tickCoord-t*(b()/2+i),a[m]=Zt(Zt({},p),{},{isShow:!0}))},d=s-1;d>=0;d--)l(d);return a}function aZ(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,{start:c,end:l}=e;if(a){var d=n[o-1],h=r(d,o-1),m=t*(d.coordinate+t*h/2-l);s[o-1]=d=Zt(Zt({},d),{},{tickCoord:m>0?d.coordinate-m*t:d.coordinate});var p=ed(t,d.tickCoord,()=>h,c,l);p&&(l=d.tickCoord-t*(h/2+i),s[o-1]=Zt(Zt({},d),{},{isShow:!0}))}for(var v=a?o-1:o,b=function(T){var E=s[T],j,R=()=>(j===void 0&&(j=r(E,T)),j);if(T===0){var D=t*(E.coordinate-t*R()/2-c);s[T]=E=Zt(Zt({},E),{},{tickCoord:D<0?E.coordinate-D*t:E.coordinate})}else s[T]=E=Zt(Zt({},E),{},{tickCoord:E.coordinate});var S=ed(t,E.tickCoord,R,c,l);S&&(c=E.tickCoord+t*(R()/2+i),s[T]=Zt(Zt({},E),{},{isShow:!0}))},g=0;g<v;g++)b(g);return s}function My(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:o,interval:c,tickFormatter:l,unit:d,angle:h}=t;if(!i||!i.length||!n)return[];if(te(c)||Nc.isSsr){var m;return(m=JY(i,te(c)?c:0))!==null&&m!==void 0?m:[]}var p=[],v=o==="top"||o==="bottom"?"width":"height",b=d&&v==="width"?Bo(d,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(E,j)=>{var R=typeof l=="function"?l(E.value,j):E.value;return v==="width"?XY(Bo(R,{fontSize:e,letterSpacing:r}),b,h):Bo(R,{fontSize:e,letterSpacing:r})[v]},_=i.length>=2?Lr(i[1].coordinate-i[0].coordinate):1,T=QY(a,_,v);return c==="equidistantPreserveStart"?eZ(_,T,g,i,s):(c==="preserveStart"||c==="preserveStartEnd"?p=aZ(_,T,g,i,s,c==="preserveStartEnd"):p=iZ(_,T,g,i,s),p.filter(E=>E.isShow))}var sZ=["viewBox"],oZ=["viewBox"];function ms(){return ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ms.apply(null,arguments)}function c_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c_(Object(r),!0).forEach(function(n){Ly(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function l_(t,e){if(t==null)return{};var r,n,i=cZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function cZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Ly(t,e,r){return(e=lZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lZ(t){var e=uZ(t,"string");return typeof e=="symbol"?e:e+""}function uZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gi extends w.Component{constructor(e){super(e),this.tickRefs=w.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,r){var{viewBox:n}=e,i=l_(e,sZ),a=this.props,{viewBox:s}=a,o=l_(a,oZ);return!Tf(n,s)||!Tf(i,o)||!Tf(r,this.state)}getTickLineCoord(e){var{x:r,y:n,width:i,height:a,orientation:s,tickSize:o,mirror:c,tickMargin:l}=this.props,d,h,m,p,v,b,g=c?-1:1,_=e.tickSize||o,T=te(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":d=h=e.coordinate,p=n+ +!c*a,m=p-g*_,b=m-g*l,v=T;break;case"left":m=p=e.coordinate,h=r+ +!c*i,d=h-g*_,v=d-g*l,b=T;break;case"right":m=p=e.coordinate,h=r+ +c*i,d=h+g*_,v=d+g*l,b=T;break;default:d=h=e.coordinate,p=n+ +c*a,m=p+g*_,b=m+g*l,v=T;break}return{line:{x1:d,y1:m,x2:h,y2:p},tick:{x:v,y:b}}}getTickTextAnchor(){var{orientation:e,mirror:r}=this.props,n;switch(e){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:e,mirror:r}=this.props;switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:e,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:o}=this.props,c=xt(xt(xt({},Ke(this.props,!1)),Ke(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var l=+(a==="top"&&!s||a==="bottom"&&s);c=xt(xt({},c),{},{x1:e,y1:r+l*i,x2:e+n,y2:r+l*i})}else{var d=+(a==="left"&&!s||a==="right"&&s);c=xt(xt({},c),{},{x1:e+d*n,y1:r,x2:e+d*n,y2:r+i})}return w.createElement("line",ms({},c,{className:Le("recharts-cartesian-axis-line",Da(o,"className"))}))}static renderTickItem(e,r,n){var i,a=Le(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(e))i=w.cloneElement(e,xt(xt({},r),{},{className:a}));else if(typeof e=="function")i=e(xt(xt({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=Le(s,e.className)),i=w.createElement(jy,ms({},r,{className:s}),n)}return i}renderTicks(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:a,tick:s,tickFormatter:o,unit:c}=this.props,l=My(xt(xt({},this.props),{},{ticks:n}),e,r),d=this.getTickTextAnchor(),h=this.getTickVerticalAnchor(),m=Ke(this.props,!1),p=Ke(s,!1),v=xt(xt({},m),{},{fill:"none"},Ke(i,!1)),b=l.map((g,_)=>{var{line:T,tick:E}=this.getTickLineCoord(g),j=xt(xt(xt(xt({textAnchor:d,verticalAnchor:h},m),{},{stroke:"none",fill:a},p),E),{},{index:_,payload:g,visibleTicksCount:l.length,tickFormatter:o});return w.createElement(Vi,ms({className:"recharts-cartesian-axis-tick",key:"tick-".concat(g.value,"-").concat(g.coordinate,"-").concat(g.tickCoord)},DF(this.props,g,_)),i&&w.createElement("line",ms({},v,T,{className:Le("recharts-cartesian-axis-tick-line",Da(i,"className"))})),s&&Gi.renderTickItem(s,j,"".concat(typeof o=="function"?o(g.value,_):g.value).concat(c||"")))});return b.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:e,width:r,height:n,className:i,hide:a}=this.props;if(a)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:w.createElement(Vi,{className:Le("recharts-cartesian-axis",i),ref:o=>{if(o){var c=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(c);var l=c[0];if(l){var d=window.getComputedStyle(l).fontSize,h=window.getComputedStyle(l).letterSpacing;(d!==this.state.fontSize||h!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(l).fontSize,letterSpacing:window.getComputedStyle(l).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),xr.renderCallByParent(this.props))}}Ly(Gi,"displayName","CartesianAxis");Ly(Gi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var dZ=["x1","y1","x2","y2","key"],hZ=["offset"],fZ=["xAxisId","yAxisId"],mZ=["xAxisId","yAxisId"];function u_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?u_(Object(r),!0).forEach(function(n){pZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function pZ(t,e,r){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gZ(t){var e=yZ(t,"string");return typeof e=="symbol"?e:e+""}function yZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pa(){return pa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pa.apply(null,arguments)}function td(t,e){if(t==null)return{};var r,n,i=vZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var bZ=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:o}=t;return w.createElement("rect",{x:n,y:i,ry:o,width:a,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function vC(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:i,x2:a,y2:s,key:o}=e,c=td(e,dZ),l=Ke(c,!1),{offset:d}=l,h=td(l,hZ);r=w.createElement("line",pa({},h,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function xZ(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=td(t,fZ),c=i.map((l,d)=>{var h=Jt(Jt({},o),{},{x1:e,y1:l,x2:e+r,y2:l,key:"line-".concat(d),index:d});return vC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function wZ(t){var{y:e,height:r,vertical:n=!0,verticalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=td(t,mZ),c=i.map((l,d)=>{var h=Jt(Jt({},o),{},{x1:l,y1:e,x2:l,y2:e+r,key:"line-".concat(d),index:d});return vC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function _Z(t){var{horizontalFill:e,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:o,horizontal:c=!0}=t;if(!c||!e||!e.length)return null;var l=o.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var d=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%e.length;return w.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:v,width:a,stroke:"none",fill:e[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function EZ(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,verticalPoints:c}=t;if(!e||!r||!r.length)return null;var l=c.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var d=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%r.length;return w.createElement("rect",{key:"react-".concat(m),x:h,y:a,width:v,height:o,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var TZ=(t,e)=>{var{xAxis:r,width:n,height:i,offset:a}=t;return wS(My(Jt(Jt(Jt({},Gi.defaultProps),r),{},{ticks:_S(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,e)},AZ=(t,e)=>{var{yAxis:r,width:n,height:i,offset:a}=t;return wS(My(Jt(Jt(Jt({},Gi.defaultProps),r),{},{ticks:_S(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,e)},SZ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Km(t){var e=IS(),r=PS(),n=SS(),i=Jt(Jt({},qa(t,SZ)),{},{x:te(t.x)?t.x:n.left,y:te(t.y)?t.y:n.top,width:te(t.width)?t.width:n.width,height:te(t.height)?t.height:n.height}),{xAxisId:a,yAxisId:s,x:o,y:c,width:l,height:d,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,v=mr(),b=ie(P=>Iw(P,"xAxis",a,v)),g=ie(P=>Iw(P,"yAxis",s,v));if(!te(l)||l<=0||!te(d)||d<=0||!te(o)||o!==+o||!te(c)||c!==+c)return null;var _=i.verticalCoordinatesGenerator||TZ,T=i.horizontalCoordinatesGenerator||AZ,{horizontalPoints:E,verticalPoints:j}=i;if((!E||!E.length)&&typeof T=="function"){var R=m&&m.length,D=T({yAxis:g?Jt(Jt({},g),{},{ticks:R?m:g.ticks}):void 0,width:e,height:r,offset:n},R?!0:h);Uo(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(E=D)}if((!j||!j.length)&&typeof _=="function"){var S=p&&p.length,A=_({xAxis:b?Jt(Jt({},b),{},{ticks:S?p:b.ticks}):void 0,width:e,height:r,offset:n},S?!0:h);Uo(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(j=A)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(bZ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),w.createElement(_Z,pa({},i,{horizontalPoints:E})),w.createElement(EZ,pa({},i,{verticalPoints:j})),w.createElement(xZ,pa({},i,{offset:n,horizontalPoints:E,xAxis:b,yAxis:g})),w.createElement(wZ,pa({},i,{offset:n,verticalPoints:j,xAxis:b,yAxis:g})))}Km.displayName="CartesianGrid";var bC=(t,e,r,n)=>Eh(t,"xAxis",e,n),xC=(t,e,r,n)=>wP(t,"xAxis",e,n),wC=(t,e,r,n)=>Eh(t,"yAxis",r,n),_C=(t,e,r,n)=>wP(t,"yAxis",r,n),IZ=V([tt,bC,wC,xC,_C],(t,e,r,n,i)=>Hi(t,"xAxis")?_m(e,n,!1):_m(r,i,!1)),PZ=(t,e,r,n,i)=>i,CZ=V([KI,PZ],(t,e)=>{if(t.some(r=>r.type==="line"&&e.dataKey===r.dataKey&&e.data===r.data))return e}),kZ=V([tt,bC,wC,xC,_C,CZ,IZ,AI],(t,e,r,n,i,a,s,o)=>{var{chartData:c,dataStartIndex:l,dataEndIndex:d}=o;if(!(a==null||e==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:h,data:m}=a,p;if(m!=null&&m.length>0?p=m:p=c?.slice(l,d+1),p!=null)return YZ({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:h,bandSize:s,displayedData:p})}}),NZ=["type","layout","connectNulls","needClip"],jZ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function EC(t,e){if(t==null)return{};var r,n,i=OZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function OZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function d_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?d_(Object(r),!0).forEach(function(n){Sh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Sh(t,e,r){return(e=RZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RZ(t){var e=DZ(t,"string");return typeof e=="symbol"?e:e+""}function DZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ms(){return Ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ms.apply(null,arguments)}var MZ=t=>{var{dataKey:e,name:r,stroke:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:ES(r,e),payload:t}]};function LZ(t){var{dataKey:e,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:c}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:e,nameKey:void 0,name:ES(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:c}}}var TC=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function $Z(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],i=0;i<e;++i)n=[...n,...r];return n}var VZ=(t,e,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return TC(e,t);for(var i=Math.floor(t/n),a=t%n,s=e-t,o=[],c=0,l=0;c<r.length;l+=r[c],++c)if(l+r[c]>a){o=[...r.slice(0,c),a-l];break}var d=o.length%2===0?[0,s]:[s];return[...$Z(r,i),...o,...d].map(h=>"".concat(h,"px")).join(", ")};function zZ(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=Le("recharts-line-dot",typeof t!="boolean"?t.className:"");r=w.createElement(aC,Ms({},e,{className:n}))}return r}function FZ(t,e){return t==null?!1:e?!0:t.length===1}function UZ(t){var{clipPathId:e,points:r,props:n}=t,{dot:i,dataKey:a,needClip:s}=n;if(!FZ(r,i))return null;var o=gA(i),c=Ke(n,!1),l=Ke(i,!0),d=r.map((m,p)=>{var v=Kr(Kr(Kr({key:"dot-".concat(p),r:3},c),l),{},{index:p,cx:m.x,cy:m.y,dataKey:a,value:m.value,payload:m.payload,points:r});return zZ(i,v)}),h={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):null};return w.createElement(Vi,Ms({className:"recharts-line-dots",key:"dots"},h),d)}function Gm(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:i,props:a,showLabels:s}=t,{type:o,layout:c,connectNulls:l,needClip:d}=a,h=EC(a,NZ),m=Kr(Kr({},Ke(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(e,")"):null,points:n,type:o,layout:c,connectNulls:l,strokeDasharray:i??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(NS,Ms({},m,{pathRef:r})),w.createElement(UZ,{points:n,clipPathId:e,props:a}),s&&Ea.renderCallByParent(a,n))}function BZ(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function HZ(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=t,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:l,animationDuration:d,animationEasing:h,animateNewValues:m,width:p,height:v,onAnimationEnd:b,onAnimationStart:g}=r,_=i.current,T=dY(r,"recharts-line-"),[E,j]=w.useState(!1),R=w.useCallback(()=>{typeof b=="function"&&b(),j(!1)},[b]),D=w.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),S=BZ(n.current),A=a.current;return w.createElement(Vu,{begin:l,duration:d,isActive:c,easing:h,from:{t:0},to:{t:1},onAnimationEnd:R,onAnimationStart:D,key:T},P=>{var{t:O}=P,N=go(A,S+A),C=Math.min(N(O),S),k;if(o){var Q="".concat(o).split(/[,\s]+/gim).map(ee=>parseFloat(ee));k=VZ(C,S,Q)}else k=TC(S,C);if(_){var ce=_.length/s.length,X=O===1?s:s.map((ee,fe)=>{var ye=Math.floor(fe*ce);if(_[ye]){var Ue=_[ye],se=go(Ue.x,ee.x),q=go(Ue.y,ee.y);return Kr(Kr({},ee),{},{x:se(O),y:q(O)})}if(m){var J=go(p*2,ee.x),rt=go(v/2,ee.y);return Kr(Kr({},ee),{},{x:J(O),y:rt(O)})}return Kr(Kr({},ee),{},{x:ee.x,y:ee.y})});return i.current=X,w.createElement(Gm,{props:r,points:X,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})}return O>0&&S>0&&(i.current=s,a.current=C),w.createElement(Gm,{props:r,points:s,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})})}function WZ(t){var{clipPathId:e,props:r}=t,{points:n,isAnimationActive:i}=r,a=w.useRef(null),s=w.useRef(0),o=w.useRef(null),c=a.current;return i&&n&&n.length&&c!==n?w.createElement(HZ,{props:r,clipPathId:e,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:o}):w.createElement(Gm,{props:r,points:n,clipPathId:e,pathRef:o,showLabels:!0})}var qZ=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:Tr(t.payload,e)});class KZ extends w.Component{constructor(){super(...arguments),Sh(this,"id",sc("recharts-line-"))}render(){var e,{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:c,left:l,width:d,height:h,id:m,needClip:p,layout:v}=this.props;if(r)return null;var b=Le("recharts-line",a),g=ut(m)?this.id:m,{r:_=3,strokeWidth:T=2}=(e=Ke(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},E=gA(n),j=_*2+T;return w.createElement(w.Fragment,null,w.createElement(Vi,{className:b},p&&w.createElement("defs",null,w.createElement(VY,{clipPathId:g,xAxisId:s,yAxisId:o}),!E&&w.createElement("clipPath",{id:"clipPath-dots-".concat(g)},w.createElement("rect",{x:l-j/2,y:c-j/2,width:d+j,height:h+j}))),w.createElement(WZ,{props:this.props,clipPathId:g}),w.createElement(LY,{direction:v==="horizontal"?"y":"x"},w.createElement(SY,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:qZ,errorBarOffset:0},this.props.children))),w.createElement(wY,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var AC={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Nc.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function GZ(t){var e=qa(t,AC),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:o,dot:c,hide:l,isAnimationActive:d,label:h,legendType:m,xAxisId:p,yAxisId:v}=e,b=EC(e,jZ),{needClip:g}=mC(p,v),{height:_,width:T,x:E,y:j}=Ry(),R=Mg(),D=mr(),S=w.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),A=ie(P=>kZ(P,p,v,D,S));return R!=="horizontal"&&R!=="vertical"?null:w.createElement(KZ,Ms({},b,{connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:d,hide:l,label:h,legendType:m,xAxisId:p,yAxisId:v,points:A,layout:R,height:_,width:T,left:E,top:j,needClip:g}))}function YZ(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:o,displayedData:c}=t;return c.map((l,d)=>{var h=Tr(l,s);return e==="horizontal"?{x:bx({axis:r,ticks:i,bandSize:o,entry:l,index:d}),y:ut(h)?null:n.scale(h),value:h,payload:l}:{x:ut(h)?null:r.scale(h),y:bx({axis:n,ticks:a,bandSize:o,entry:l,index:d}),value:h,payload:l}})}class rd extends w.PureComponent{render(){return w.createElement(PY,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},w.createElement(uY,{legendPayload:MZ(this.props)}),w.createElement(cY,{fn:LZ,args:this.props}),w.createElement(GZ,this.props))}}Sh(rd,"displayName","Line");Sh(rd,"defaultProps",AC);function h_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function f_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h_(Object(r),!0).forEach(function(n){ZZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZZ(t,e,r){return(e=XZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JZ={xAxis:{},yAxis:{},zAxis:{}},SC=Br({name:"cartesianAxis",initialState:JZ,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=f_(f_({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:eX,removeXAxis:tX,addYAxis:rX,removeYAxis:nX,addZAxis:gee,removeZAxis:yee,updateYAxisWidth:iX}=SC.actions,aX=SC.reducer,sX=["children"],oX=["dangerouslySetInnerHTML","ticks"];function IC(t,e,r){return(e=cX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ym(){return Ym=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ym.apply(null,arguments)}function PC(t,e){if(t==null)return{};var r,n,i=uX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function uX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function dX(t){var e=sr(),r=w.useMemo(()=>{var{children:a}=t,s=PC(t,sX);return s},[t]),n=ie(a=>si(a,r.id)),i=r===n;return w.useEffect(()=>(e(eX(r)),()=>{e(tX(r))}),[r,e]),i?t.children:null}var hX=t=>{var{xAxisId:e,className:r}=t,n=ie(AS),i=mr(),a="xAxis",s=ie(p=>Gs(p,a,e,i)),o=ie(p=>xP(p,a,e,i)),c=ie(p=>p7(p,e)),l=ie(p=>x7(p,e));if(c==null||l==null)return null;var{dangerouslySetInnerHTML:d,ticks:h}=t,m=PC(t,oX);return w.createElement(Gi,Ym({},m,{scale:s,x:l.x,y:l.y,width:c.width,height:c.height,className:Le("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},fX=t=>{var e,r,n,i,a;return w.createElement(dX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter},w.createElement(hX,t))};class nd extends w.Component{render(){return w.createElement(fX,this.props)}}IC(nd,"displayName","XAxis");IC(nd,"defaultProps",{allowDataOverflow:yr.allowDataOverflow,allowDecimals:yr.allowDecimals,allowDuplicatedCategory:yr.allowDuplicatedCategory,height:yr.height,hide:!1,mirror:yr.mirror,orientation:yr.orientation,padding:yr.padding,reversed:yr.reversed,scale:yr.scale,tickCount:yr.tickCount,type:yr.type,xAxisId:0});var mX=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,s=0;if(e){e.forEach(d=>{if(d){var h=d.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,c=i+a,l=s+c+o+(r?n:0);return Math.round(l)}return 0},pX=["dangerouslySetInnerHTML","ticks"];function CC(t,e,r){return(e=gX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gX(t){var e=yX(t,"string");return typeof e=="symbol"?e:e+""}function yX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(){return Zm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zm.apply(null,arguments)}function vX(t,e){if(t==null)return{};var r,n,i=bX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function bX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function xX(t){var e=sr();return w.useEffect(()=>(e(rX(t)),()=>{e(nX(t))}),[t,e]),null}var wX=t=>{var e,{yAxisId:r,className:n,width:i,label:a}=t,s=w.useRef(null),o=w.useRef(null),c=ie(AS),l=mr(),d=sr(),h="yAxis",m=ie(E=>Gs(E,h,r,l)),p=ie(E=>_7(E,r)),v=ie(E=>w7(E,r)),b=ie(E=>xP(E,h,r,l));if(w.useLayoutEffect(()=>{var E;if(!(i!=="auto"||!p||Oy(a)||w.isValidElement(a))){var j=s.current,R=j==null||(E=j.tickRefs)===null||E===void 0?void 0:E.current,{tickSize:D,tickMargin:S}=j.props,A=mX({ticks:R,label:o.current,labelGapWithTick:5,tickSize:D,tickMargin:S});Math.round(p.width)!==Math.round(A)&&d(iX({id:r,width:A}))}},[s,s==null||(e=s.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p?.width,p,d,a,r,i]),p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=t,T=vX(t,pX);return w.createElement(Gi,Zm({},T,{ref:s,labelRef:o,scale:m,x:v.x,y:v.y,width:p.width,height:p.height,className:Le("recharts-".concat(h," ").concat(h),n),viewBox:c,ticks:b}))},_X=t=>{var e,r,n,i,a;return w.createElement(w.Fragment,null,w.createElement(xX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter}),w.createElement(wX,t))},EX={allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,hide:!1,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tickCount:vr.tickCount,type:vr.type,width:vr.width,yAxisId:0};class id extends w.Component{render(){return w.createElement(_X,this.props)}}CC(id,"displayName","YAxis");CC(id,"defaultProps",EX);var TX={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fc=w;function AX(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var SX=typeof Object.is=="function"?Object.is:AX,IX=Fc.useSyncExternalStore,PX=Fc.useRef,CX=Fc.useEffect,kX=Fc.useMemo,NX=Fc.useDebugValue;TX.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=PX(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kX(function(){function c(p){if(!l){if(l=!0,d=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,SX(d,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(d=p,v):(d=p,h=b)}var l=!1,d,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=IX(t,a[0],a[1]);return CX(function(){s.hasValue=!0,s.value=o},[o]),NX(o),o};function jX(t){t()}function OX(){let t=null,e=null;return{clear(){t=null,e=null},notify(){jX(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var m_={notify(){},get:()=>[]};function RX(t,e){let r,n=m_,i=0,a=!1;function s(b){d();const g=n.subscribe(b);let _=!1;return()=>{_||(_=!0,g(),h())}}function o(){n.notify()}function c(){v.onStateChange&&v.onStateChange()}function l(){return a}function d(){i++,r||(r=t.subscribe(c),n=OX())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=m_)}function m(){a||(a=!0,d())}function p(){a&&(a=!1,h())}const v={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:l,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return v}var DX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MX=DX(),LX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",$X=LX(),VX=()=>MX||$X?w.useLayoutEffect:w.useEffect,zX=VX(),Af=Symbol.for("react-redux-context"),Sf=typeof globalThis<"u"?globalThis:{};function FX(){if(!w.createContext)return{};const t=Sf[Af]??(Sf[Af]=new Map);let e=t.get(w.createContext);return e||(e=w.createContext(null),t.set(w.createContext,e)),e}var UX=FX();function BX(t){const{children:e,context:r,serverState:n,store:i}=t,a=w.useMemo(()=>{const c=RX(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),s=w.useMemo(()=>i.getState(),[i]);zX(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,s]);const o=r||UX;return w.createElement(o.Provider,{value:a},e)}var HX=BX,WX=(t,e)=>e,$y=V([WX,tt,Nq,jt,DP,oi,AK,Ht],kK),Vy=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},kC=zr("mouseClick"),NC=kc();NC.startListening({actionCreator:kC,effect:(t,e)=>{var r=t.payload,n=$y(e.getState(),Vy(r));n?.activeIndex!=null&&e.dispatch(R7({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Xm=zr("mouseMove"),jC=kc();jC.startListening({actionCreator:Xm,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ey(n,n.tooltip.settings.shared),a=$y(n,Vy(r));i==="axis"&&(a?.activeIndex!=null?e.dispatch(PP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(IP()))}});function qX(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var p_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},OC=Br({name:"rootProps",initialState:p_,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:p_.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),KX=OC.reducer,{updateOptions:GX}=OC.actions,RC=Br({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:vee}=RC.actions,YX=RC.reducer,DC=zr("keyDown"),MC=zr("focus"),zy=kc();zy.startListening({actionCreator:DC,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Ty(i,Xa(r))),o=oi(r);if(a==="Enter"){var c=Qu(r,"axis","hover",String(i.index));e.dispatch(Fm({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:c}));return}var l=S7(r),d=l==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,m=s+h*d;if(!(o==null||m>=o.length||m<0)){var p=Qu(r,"axis","hover",String(m));e.dispatch(Fm({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});zy.startListening({actionCreator:MC,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=Qu(r,"axis","hover",String(a));e.dispatch(Fm({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Or=zr("externalEvent"),LC=kc();LC.startListening({actionCreator:Or,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:pK(r),activeDataKey:fK(r),activeIndex:fc(r),activeLabel:$P(r),activeTooltipIndex:fc(r),isTooltipActive:gK(r)};t.payload.handler(n,t.payload.reactEvent)}}});var ZX=V([Ys],t=>t.tooltipItemPayloads),XX=V([ZX,zc,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=e(a,r);return s}}}),$C=zr("touchMove"),VC=kc();VC.startListening({actionCreator:$C,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ey(n,n.tooltip.settings.shared);if(i==="axis"){var a=$y(n,Vy({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&e.dispatch(PP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var l=c.getAttribute(hB),d=(s=c.getAttribute(fB))!==null&&s!==void 0?s:void 0,h=XX(e.getState(),l,d);e.dispatch(O7({activeDataKey:d,activeIndex:l,activeCoordinate:h}))}}});var QX=aS({brush:FY,cartesianAxis:aX,chartData:qK,graphicalItems:nY,layout:L9,legend:TB,options:FK,polarAxis:QG,polarOptions:YX,referenceElements:GY,rootProps:KX,tooltip:D7}),JX=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return c9({reducer:QX,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([NC.middleware,jC.middleware,zy.middleware,LC.middleware,VC.middleware]),devTools:{serialize:{replacer:qX},name:"recharts-".concat(r)}})};function eQ(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=mr(),a=w.useRef(null);if(i)return r;a.current==null&&(a.current=JX(e,n));var s=Ig;return w.createElement(HX,{context:s,store:a.current},r)}function tQ(t){var{layout:e,width:r,height:n,margin:i}=t,a=sr(),s=mr();return w.useEffect(()=>{s||(a(R9(e)),a(D9({width:r,height:n})),a(O9(i)))},[a,s,e,r,n,i]),null}function rQ(t){var e=sr();return w.useEffect(()=>{e(GX(t))},[e,t]),null}var nQ=["children"];function iQ(t,e){if(t==null)return{};var r,n,i=aQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function aQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ad(){return ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ad.apply(null,arguments)}var sQ={width:"100%",height:"100%"},oQ=w.forwardRef((t,e)=>{var r=IS(),n=PS(),i=kS();if(!Mu(r)||!Mu(n))return null;var{children:a,otherAttributes:s,title:o,desc:c}=t,l,d;return typeof s.tabIndex=="number"?l=s.tabIndex:l=i?0:void 0,typeof s.role=="string"?d=s.role:d=i?"application":void 0,w.createElement(yA,ad({},s,{title:o,desc:c,role:d,tabIndex:l,width:r,height:n,style:sQ,ref:e}),a)}),cQ=t=>{var{children:e}=t,r=ie(oh);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return w.createElement(yA,{width:n,height:i,x:s,y:a},e)},g_=w.forwardRef((t,e)=>{var{children:r}=t,n=iQ(t,nQ),i=mr();return i?w.createElement(cQ,null,r):w.createElement(oQ,ad({ref:e},n),r)});function lQ(){var t=sr(),[e,r]=w.useState(null),n=ie(dB);return w.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;tn(a)&&a!==n&&t(M9(a))}},[e,t,n]),r}function y_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uQ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?y_(Object(r),!0).forEach(function(n){dQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dQ(t,e,r){return(e=hQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:e+""}function fQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mQ=w.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:l,onMouseLeave:d,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:v,onTouchStart:b,style:g,width:_}=t,T=sr(),[E,j]=w.useState(null),[R,D]=w.useState(null);YK();var S=lQ(),A=w.useCallback(q=>{S(q),typeof e=="function"&&e(q),j(q),D(q)},[S,e,j,D]),P=w.useCallback(q=>{T(kC(q)),T(Or({handler:a,reactEvent:q}))},[T,a]),O=w.useCallback(q=>{T(Xm(q)),T(Or({handler:l,reactEvent:q}))},[T,l]),N=w.useCallback(q=>{T(IP()),T(Or({handler:d,reactEvent:q}))},[T,d]),C=w.useCallback(q=>{T(Xm(q)),T(Or({handler:h,reactEvent:q}))},[T,h]),k=w.useCallback(()=>{T(MC())},[T]),Q=w.useCallback(q=>{T(DC(q.key))},[T]),ce=w.useCallback(q=>{T(Or({handler:s,reactEvent:q}))},[T,s]),X=w.useCallback(q=>{T(Or({handler:o,reactEvent:q}))},[T,o]),ee=w.useCallback(q=>{T(Or({handler:c,reactEvent:q}))},[T,c]),fe=w.useCallback(q=>{T(Or({handler:m,reactEvent:q}))},[T,m]),ye=w.useCallback(q=>{T(Or({handler:b,reactEvent:q}))},[T,b]),Ue=w.useCallback(q=>{T($C(q)),T(Or({handler:v,reactEvent:q}))},[T,v]),se=w.useCallback(q=>{T(Or({handler:p,reactEvent:q}))},[T,p]);return w.createElement(HP.Provider,{value:E},w.createElement(BF.Provider,{value:R},w.createElement("div",{className:Le("recharts-wrapper",n),style:uQ({position:"relative",cursor:"default",width:_,height:i},g),onClick:P,onContextMenu:ce,onDoubleClick:X,onFocus:k,onKeyDown:Q,onMouseDown:ee,onMouseEnter:O,onMouseLeave:N,onMouseMove:C,onMouseUp:fe,onTouchEnd:se,onTouchMove:Ue,onTouchStart:ye,ref:A},r)))}),pQ=["children","className","width","height","style","compact","title","desc"];function gQ(t,e){if(t==null)return{};var r,n,i=yQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vQ=w.forwardRef((t,e)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:c,desc:l}=t,d=gQ(t,pQ),h=Ke(d,!1);return o?w.createElement(g_,{otherAttributes:h,title:c,desc:l},r):w.createElement(mQ,{className:n,style:s,width:i,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},w.createElement(g_,{otherAttributes:h,title:c,desc:l,ref:e},w.createElement(ZY,null,r)))}),bQ=["width","height"];function Qm(){return Qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qm.apply(null,arguments)}function xQ(t,e){if(t==null)return{};var r,n,i=wQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function wQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var _Q={top:5,right:5,bottom:5,left:5},EQ={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:_Q,reverseStackOrder:!1,syncMethod:"index"},TQ=w.forwardRef(function(e,r){var n,i=qa(e.categoricalChartProps,EQ),{width:a,height:s}=i,o=xQ(i,bQ);if(!Mu(a)||!Mu(s))return null;var{chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,categoricalChartProps:m}=e,p={chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:d,tooltipPayloadSearcher:h,eventEmitter:void 0};return w.createElement(eQ,{preloadedState:{options:p},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:c},w.createElement(zY,{chartData:m.data}),w.createElement(tQ,{width:a,height:s,layout:i.layout,margin:i.margin}),w.createElement(rQ,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),w.createElement(vQ,Qm({},o,{width:a,height:s,ref:r})))}),AQ=["axis"],v_=w.forwardRef((t,e)=>w.createElement(TQ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:AQ,tooltipPayloadSearcher:VK,categoricalChartProps:t,ref:e}));function SQ(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})}function IQ(t){const e=typeof t=="string"?new Date(t):t;return e.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})+" "+e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}const PQ=({images:t})=>{const[e,r]=w.useState(!1),n=t.map(s=>{let o;const c={excellent:95,good:80,fair:60,poor:30};return s.healthAnalysis?.overallHealth&&c[s.healthAnalysis.overallHealth]?o=c[s.healthAnalysis.overallHealth]:typeof s.healthAnalysis?.confidence=="number"&&(o=s.healthAnalysis.confidence<=1?s.healthAnalysis.confidence*100:s.healthAnalysis.confidence),{id:s.id,date:SQ(s.timestamp),dateTime:IQ(s.timestamp),rawDate:s.timestamp,score:typeof o=="number"?o:null,url:s.url}}).sort((s,o)=>new Date(s.rawDate).getTime()-new Date(o.rawDate).getTime()),i=n.map(s=>({dateTime:s.dateTime,score:s.score})),a=s=>{const{key:o,cx:c,cy:l}=s;return u.jsx("circle",{cx:c,cy:l,r:4,stroke:"#2A7F3E",strokeWidth:2,fill:"#fff"},o)};return u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-base font-semibold text-[#2A7F3E]",children:"Evolución de Salud"}),u.jsx(oe,{size:"sm",variant:"outline",onClick:()=>r(!0),children:"Ampliar"})]}),u.jsx("div",{className:"w-full h-48",children:u.jsx(Fw,{width:"100%",height:"100%",children:u.jsxs(v_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[u.jsx(Km,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),u.jsx(nd,{dataKey:"dateTime",tick:{fontSize:12,fill:"#888"}}),u.jsx(id,{domain:[0,100],tick:{fontSize:12,fill:"#888"},width:32}),u.jsx(Vw,{contentStyle:{fontSize:13,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),u.jsx(rd,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:6},connectNulls:!1})]})})}),u.jsx("div",{className:"mt-4 overflow-x-auto",children:u.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-[#666]",children:[u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),u.jsx("tbody",{children:n.map(s=>u.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[u.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),u.jsx("td",{className:"px-2 py-1",children:u.jsx("img",{src:s.url,alt:"miniatura",className:"w-10 h-10 object-cover rounded-md border"})}),u.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:u.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})}),u.jsx(Pe,{children:e&&u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-2",onClick:()=>r(!1),children:u.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto p-6 relative",onClick:s=>s.stopPropagation(),children:[u.jsx(oe,{size:"icon-sm",variant:"ghost",className:"absolute top-2 right-2",onClick:()=>r(!1),children:"×"}),u.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#2A7F3E]",children:"Evolución de Salud (Ampliado)"}),u.jsx("div",{className:"w-full h-72 mb-6",children:u.jsx(Fw,{width:"100%",height:"100%",children:u.jsxs(v_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[u.jsx(Km,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),u.jsx(nd,{dataKey:"dateTime",tick:{fontSize:13,fill:"#888"}}),u.jsx(id,{domain:[0,100],tick:{fontSize:13,fill:"#888"},width:36}),u.jsx(Vw,{contentStyle:{fontSize:14,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),u.jsx(rd,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:7},connectNulls:!1})]})})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-[#666]",children:[u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),u.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),u.jsx("tbody",{children:n.map(s=>u.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[u.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),u.jsx("td",{className:"px-2 py-1",children:u.jsx("img",{src:s.url,alt:"miniatura",className:"w-12 h-12 object-cover rounded-md border"})}),u.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:u.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})})]})})})]})},CQ=({plant:t,onAddPhoto:e})=>{const r=w.useMemo(()=>{if(!t.images||t.images.length===0)return[];const a=[...t.images].sort((d,h)=>new Date(d.timestamp).getTime()-new Date(h.timestamp).getTime()),s=[],o=30*24*60*60*1e3;let c=new Date(a[0].timestamp),l=[];return a.forEach((d,h)=>{const m=new Date(d.timestamp);if(m.getTime()-c.getTime()<=o)l.push(d);else{if(l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}c=m,l=[d]}if(h===a.length-1&&l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}}),s},[t.images]);function n(a){if(a.length<2)return null;const s=a[a.length-1]-a[0];return s>5?{icon:"⬆️",label:"Mejorando",color:"text-green-600 bg-green-50"}:s<-5?{icon:"⬇️",label:"Declive",color:"text-red-600 bg-red-50"}:{icon:"➡️",label:"Estable",color:"text-gray-600 bg-gray-50"}}if(r.length===0)return u.jsxs(Ir,{className:"mt-6",children:[u.jsx(Dd,{children:u.jsxs(lg,{className:"flex items-center",children:[u.jsx(Nk,{className:"w-5 h-5 mr-2 text-primary"}),"Evolución de tu Planta"]})}),u.jsx(Jn,{children:u.jsxs("div",{className:"text-center py-8",children:[u.jsx(En,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"¡Comienza a documentar la evolución!"}),u.jsx("p",{className:"text-muted-foreground mb-4",children:"Agrega más fotos a lo largo del tiempo para ver cómo progresa tu planta."}),u.jsxs(oe,{onClick:e,className:"gap-2",children:[u.jsx(rp,{className:"w-4 h-4"}),"Agregar Primera Foto"]})]})})]});const i=r.map(a=>a.avgHealthScore??0);return n(i),u.jsx(Ir,{className:"mt-6",children:u.jsx(Jn,{className:"mt-4 space-y-6",children:u.jsx(PQ,{images:t.images||[]})})})},kQ=({isOpen:t,onClose:e,onPhotoAdded:r,plantName:n})=>{const[i,a]=w.useState("choose"),[s,o]=w.useState(null),[c,l]=w.useState(""),[d,h]=w.useState(null),[m,p]=w.useState(!1),v=w.useRef(null),{addToast:b}=Us(),g=w.useCallback(()=>{a("choose"),o(null),l(""),h(null),p(!1)},[]),_=w.useCallback(()=>{g(),e()},[g,e]),T=w.useCallback(k=>{const Q=new FileReader;Q.onload=ce=>{const X=ce.target?.result;o(X),a("preview")},Q.readAsDataURL(k)},[]),E=w.useCallback(()=>{v.current&&v.current.click()},[]),j=w.useCallback(()=>{E()},[E]),R=w.useCallback(k=>{const Q=k.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){h("Por favor selecciona un archivo de imagen válido.");return}if(Q.size>5*1024*1024){h("La imagen es demasiado grande. Máximo 5MB.");return}T(Q)}},[T]),D=w.useCallback(async()=>{if(s)try{a("uploading"),p(!0),await r(s,c.trim()||void 0),a("success"),p(!1),b({type:"success",title:"Foto agregada exitosamente",message:`Nueva imagen añadida a ${n}`}),setTimeout(()=>{_()},1500)}catch(k){h(k instanceof Error?k.message:"Error al subir la imagen"),a("error"),p(!1)}},[s,c,r,n,b,_]),S=()=>(console.log("[AddPhotoModal] Renderizando botón Tomar Foto"),console.log("[AddPhotoModal] Renderizando botón Elegir de Galería"),u.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[u.jsxs("div",{children:[u.jsx(En,{className:"w-16 h-16 text-primary mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Agregar Nueva Foto"}),u.jsxs("p",{className:"text-muted-foreground",children:["Documenta el progreso de ",u.jsx("span",{className:"font-medium",children:n})]})]}),u.jsxs("div",{className:"grid gap-4",children:[u.jsxs(oe,{variant:"primary",size:"lg",onClick:j,className:"h-16 gap-3 text-primary-foreground",children:[u.jsx(En,{className:"w-6 h-6"}),"Tomar Foto"]}),u.jsxs(oe,{variant:"secondary",size:"lg",onClick:E,className:"h-16 gap-3 text-primary-foreground",children:[u.jsx(C_,{className:"w-6 h-6"}),"Elegir de Galería"]})]}),u.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:R,className:"hidden","data-testid":"file-input"})]})),A=()=>u.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Vista Previa"}),u.jsxs("p",{className:"text-muted-foreground",children:["Revisa la imagen antes de agregar a ",n]})]}),s&&u.jsxs("div",{className:"space-y-4 pb-8 sm:pb-0",children:[u.jsx("div",{className:"aspect-video max-h-80 mx-auto rounded-lg overflow-hidden border",children:u.jsx("img",{src:s,alt:"Vista previa",className:"w-full h-full object-cover"})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"block text-sm font-medium",children:"Nota (opcional)"}),u.jsx("textarea",{value:c,onChange:k=>l(k.target.value),placeholder:"Agrega una nota sobre esta foto...",className:"w-full p-3 border border-neutral-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:200}),u.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[c.length,"/200"]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(oe,{variant:"secondary",onClick:()=>a("choose"),className:"flex-1",children:"Cambiar Imagen"}),u.jsxs(oe,{variant:"primary",onClick:D,className:"flex-1 gap-2",children:[u.jsx(er,{className:"w-4 h-4"}),"Analizar y Guardar"]})]})]})]}),P=()=>u.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center space-y-6 py-8",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx(ga,{className:"w-16 h-16 text-primary mx-auto animate-spin"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:m?"Analizando imagen...":"Subiendo foto..."}),u.jsx("p",{className:"text-muted-foreground",children:m?"La IA está evaluando la salud de tu planta":"Guardando la nueva imagen en tu jardín"})]})]}),u.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full animate-pulse",style:{width:"70%"}})})]}),O=()=>u.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[u.jsx(Ai,{className:"w-16 h-16 text-success-500 mx-auto"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"¡Foto agregada!"}),u.jsxs("p",{className:"text-muted-foreground",children:["La nueva imagen ha sido añadida al progreso de ",n]})]})]}),N=()=>u.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[u.jsx(Jr,{className:"w-16 h-16 text-error-500 mx-auto"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al subir"}),u.jsx("p",{className:"text-muted-foreground mb-4",children:d||"Hubo un problema al procesar la imagen"}),u.jsxs("div",{className:"flex gap-3 justify-center",children:[u.jsx(oe,{variant:"secondary",onClick:()=>a("choose"),children:"Intentar de Nuevo"}),u.jsx(oe,{variant:"primary",onClick:_,children:"Cerrar"})]})]})]}),C=()=>{switch(i){case"choose":return S();case"preview":return A();case"uploading":return P();case"success":return O();case"error":return N();default:return S()}};return u.jsx(Pe,{children:t&&u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:k=>{k.target===k.currentTarget&&i!=="uploading"&&_()},children:u.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md",children:u.jsx(Ir,{children:u.jsxs(Jn,{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(np,{className:"w-5 h-5 text-primary"}),u.jsx("span",{className:"font-medium text-sm text-muted-foreground",children:"NUEVA FOTO"})]}),i!=="uploading"&&u.jsx(oe,{variant:"ghost",size:"icon-sm",onClick:_,children:u.jsx(Fi,{className:"w-4 h-4"})})]}),C()]})})})})})},NQ=({plant:t})=>{const{careProfile:e,healthScore:r,lastWatered:n,dateAdded:i}=t,a=t.images?.[0]?.healthAnalysis,s=n?Math.floor((Date.now()-new Date(n).getTime())/(1e3*60*60*24)):null,o=Math.floor((Date.now()-new Date(i).getTime())/(1e3*60*60*24)),l=r>=85?{text:"Excelente",color:"text-green-500",icon:Ai,emoji:"🌟"}:r>=70?{text:"Buena",color:"text-green-400",icon:Ai,emoji:"✅"}:r>=50?{text:"Regular",color:"text-yellow-500",icon:A_,emoji:"⚠️"}:{text:"Necesita atención",color:"text-red-500",icon:_n,emoji:"🆘"},h=(()=>{if(!s||!e?.wateringFrequency)return{text:"Sin datos",color:"text-gray-500",urgent:!1};const v=s>=e.wateringFrequency;return s>e.wateringFrequency+2?{text:"Riego urgente",color:"text-red-500",urgent:!0}:v?{text:"Necesita riego",color:"text-yellow-500",urgent:!0}:{text:"Bien hidratada",color:"text-green-500",urgent:!1}})(),m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},p={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return u.jsx(L.div,{variants:m,initial:"hidden",animate:"visible",children:u.jsxs(Ir,{variant:"glass",className:"content-spacing-sm element-spacing",children:[t.description&&u.jsx("div",{className:"mb-4",children:u.jsx("p",{className:"text-base text-neutral-700 dark:text-neutral-200 leading-relaxed",children:t.description})}),u.jsx(L.div,{variants:p,className:"w-full mb-3",children:u.jsxs("div",{className:"w-full flex items-center justify-between bg-green-100 dark:bg-green-900/30 rounded-lg px-4 py-2 mb-2",children:[u.jsxs("span",{className:"flex items-center gap-2 text-green-700 text-base font-bold",children:[u.jsx(Ai,{className:"w-5 h-5"}),r,"% ",l.text]}),u.jsxs("span",{className:"flex items-center gap-1 text-contrast-soft text-sm align-baseline",children:[u.jsx(Jl,{className:"w-4 h-4"}),"Día ",o]})]})}),u.jsxs(L.div,{variants:p,className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:Oe("flex items-center space-x-3 p-3 rounded-lg",h.urgent?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"),children:[u.jsx(gc,{className:Oe("w-5 h-5",h.color)}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-contrast-soft",children:"Riego"}),u.jsx("p",{className:Oe("font-semibold text-sm",h.color),children:h.text}),s!==null&&u.jsxs("p",{className:"text-xs text-contrast-soft",children:["Hace ",s," día",s!==1?"s":""]})]})]}),u.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[u.jsx(ya,{className:"w-5 h-5 text-blue-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-contrast-soft",children:"Luz"}),u.jsx("p",{className:"font-semibold text-sm text-blue-600 dark:text-blue-400",children:e?.sunlightRequirement||"No especificado"}),t.lightRequirements&&u.jsx("p",{className:"text-xs text-contrast-soft capitalize",children:t.lightRequirements.replace("_"," ")})]})]}),t.plantEnvironment&&u.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[u.jsx(M_,{className:"w-5 h-5 text-purple-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-contrast-soft",children:"Ambiente"}),u.jsx("p",{className:"font-semibold text-sm text-purple-600 dark:text-purple-400 capitalize",children:t.plantEnvironment==="ambos"?"Interior/Exterior":t.plantEnvironment})]})]}),e?.temperatureRange&&u.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[u.jsx(L_,{className:"w-5 h-5 text-orange-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-contrast-soft",children:"Temperatura"}),u.jsxs("p",{className:"font-semibold text-sm text-orange-600 dark:text-orange-400",children:[e.temperatureRange.min,"°-",e.temperatureRange.max,"°C"]})]})]})]}),a?.issues&&a.issues.length>0&&u.jsx(L.div,{variants:p,className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(_n,{className:"w-5 h-5 text-red-500 mt-0.5"}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-semibold text-red-700 dark:text-red-300 text-sm mb-1",children:[a.issues.length," problema",a.issues.length!==1?"s":""," detectado",a.issues.length!==1?"s":""]}),u.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[a.issues[0].description,a.issues.length>1&&` y ${a.issues.length-1} más...`]})]})]})}),u.jsx("br",{}),t.personality?.communicationStyle&&u.jsx(L.div,{variants:p,className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Ho,{className:"w-5 h-5 text-green-500 mt-0.5"}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-semibold text-green-700 dark:text-green-300 text-sm mb-1",children:["🤖 Personalidad: ",t.personality.communicationStyle]}),t.personality.catchphrases&&t.personality.catchphrases.length>0&&u.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 italic",children:['"',t.personality.catchphrases[0],'"']})]})]})})]})})},jQ=({plant:t,onAddPhoto:e})=>{const[r,n]=w.useState("evolution"),i=t.images?.[0]?.healthAnalysis,a=i?.issues&&i.issues.length>0,s=t.images&&t.images.length>1,o=[{id:"evolution",title:"Evolución y Progreso",icon:u.jsx(jk,{className:"w-5 h-5"}),badge:s?`${t.images?.length||0} fotos`:"Nueva",component:u.jsx(CQ,{plant:t,onAddPhoto:e}),priority:1},{id:"health",title:"Análisis de Salud",icon:u.jsx(Ok,{className:"w-5 h-5"}),badge:a?"Atención":"Saludable",component:u.jsx(SF,{analysis:i}),priority:a?1:3},{id:"care",title:"Perfil de Cuidados",icon:u.jsx(Rk,{className:"w-5 h-5"}),badge:t.careProfile?"Completo":"Pendiente",component:u.jsx(EF,{plant:t}),priority:t.careProfile?2:1},...t.funFacts&&t.funFacts.length>0?[{id:"funfacts",title:"Datos Curiosos",icon:u.jsx(er,{className:"w-5 h-5"}),component:u.jsx(TF,{species:t.species,funFacts:t.funFacts}),priority:4}]:[]].filter(c=>c.id==="health"?!!i:!0).sort((c,l)=>c.priority-l.priority);return u.jsx("div",{className:"flex flex-col gap-y-1",children:o.map(c=>{const l=r===c.id,d=c.id==="health";return c.id==="care"?u.jsxs(Ir,{variant:"default",radius:"default",className:Oe("border border-[#E5E5E5] rounded-[8px] transition-all duration-200","bg-white","p-0 mb-4"),children:[u.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none","bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[u.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[u.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),u.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),u.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16,transition:"transform .2s"},children:u.jsx(Cv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),u.jsx(Pe,{children:l&&u.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:u.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,u.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id):u.jsxs(Ir,{variant:"default",radius:"default",className:Oe("border border-[#E0E0E0] rounded-[8px] transition-all duration-200",l&&d?"bg-[#FAFAFA]":"bg-white","p-0 mb-4"),children:[u.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none",l&&d?"bg-[#FAFAFA]":"bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[u.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[u.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),u.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),d&&u.jsx("span",{className:"ml-2 px-[6px] py-[2px] text-xs font-medium rounded-[4px] bg-[#E0F2E9] text-[#2A7F3E] align-middle",style:{lineHeight:"1.2"},children:c.badge}),u.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16},children:u.jsx(Cv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),u.jsx(Pe,{children:l&&u.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:u.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,d&&u.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id)})})},b_=()=>u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"relative h-96 w-full overflow-hidden bg-gradient-to-br from-muted/50 to-muted",children:[u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 via-background/20 to-transparent"}),u.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx(pe,{className:"h-10 w-10 rounded-full"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(pe,{className:"h-10 w-10 rounded-full"}),u.jsx(pe,{className:"h-10 w-10 rounded-full"})]})]})}),u.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pe,{className:"h-8 w-64"}),u.jsx(pe,{className:"h-6 w-48"})]}),u.jsxs("div",{className:"flex flex-wrap gap-3",children:[u.jsx(pe,{className:"h-8 w-24 rounded-full"}),u.jsx(pe,{className:"h-8 w-32 rounded-full"}),u.jsx(pe,{className:"h-8 w-20 rounded-full"})]})]})})]}),u.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[u.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[u.jsxs("div",{className:"mb-6 flex items-center",children:[u.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pe,{className:"h-6 w-48"}),u.jsx(pe,{className:"h-4 w-64"})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx(pe,{className:"h-4 w-full"}),u.jsx(pe,{className:"h-4 w-5/6"}),u.jsx(pe,{className:"h-4 w-4/5"}),u.jsx(pe,{className:"h-4 w-3/4"})]}),u.jsxs("div",{className:"mt-8 space-y-4",children:[u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pe,{className:"h-6 w-32"}),u.jsx(pe,{className:"h-4 w-56"})]})]}),[1,2,3].map(t=>u.jsxs("div",{className:"flex items-start bg-muted/20 rounded-xl p-4",children:[u.jsx(pe,{className:"h-5 w-5 rounded-full mr-4 mt-1"}),u.jsx(pe,{className:"h-4 w-full"})]},t))]})]}),u.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[u.jsxs("div",{className:"mb-4 flex items-center",children:[u.jsx(pe,{className:"h-6 w-6 mr-3"}),u.jsx(pe,{className:"h-6 w-48"})]}),u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-6",children:[u.jsx(pe,{className:"h-12 w-12 mx-auto mb-3"}),u.jsx(pe,{className:"h-6 w-32 mx-auto mb-2"}),u.jsx(pe,{className:"h-4 w-48 mx-auto"})]})]}),u.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[u.jsxs("div",{className:"mb-4 flex items-center",children:[u.jsx(pe,{className:"h-6 w-6 mr-3"}),u.jsx(pe,{className:"h-6 w-40"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>u.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[u.jsx(pe,{className:"h-8 w-8 mb-2"}),u.jsx(pe,{className:"h-4 w-16 mb-1"}),u.jsx(pe,{className:"h-5 w-24"})]},t))})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(pe,{className:"h-5 w-5 mr-2"}),u.jsx(pe,{className:"h-6 w-32"})]}),u.jsx(pe,{className:"h-4 w-16"})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4,5,6].map(t=>u.jsx(pe,{className:"aspect-square rounded-xl"},t))})]})]}),u.jsxs("div",{className:"fixed bottom-4 right-4 z-40 flex flex-col-reverse gap-3",children:[[1,2,3].map(t=>u.jsx(pe,{className:"h-14 w-14 rounded-full"},t)),u.jsx(pe,{className:"h-16 w-16 rounded-full"})]})]}),OQ=()=>{const{plantId:t}=tp(),e=ar(),{plant:r,loading:n,error:i}=dg(t),{addPlantImage:a}=gF(),[s,o]=w.useState(!1),c=async(l,d)=>{if(!t)throw new Error("Plant ID is required");return new Promise((h,m)=>{a({plantId:t,imageDataUrl:l,note:d},{onSuccess:()=>h(),onError:p=>m(p)})})};return n?u.jsx(b_,{}):i?u.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[u.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto"}),u.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Ocurrió un Error"}),u.jsx("p",{className:"text-muted-foreground max-w-md",children:i}),u.jsx(oe,{onClick:()=>window.location.reload(),className:"mt-4",children:"Intentar de nuevo"})]})}):r?u.jsx(w.Suspense,{fallback:u.jsx(b_,{}),children:u.jsxs("div",{className:"min-h-screen bg-background",children:[u.jsx(_F,{plant:r}),u.jsx("main",{className:"relative -mt-16 z-10",children:u.jsx("div",{className:"bg-background rounded-t-3xl min-h-[calc(100vh-16rem)] pb-safe-bottom",children:u.jsxs("div",{className:"px-4 py-6 space-y-6 max-w-4xl mx-auto",children:[u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-4",children:u.jsx(NQ,{plant:r})}),u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:u.jsx("div",{className:"bg-surface border border-border rounded-2xl overflow-hidden",children:u.jsx(jQ,{plant:r,onAddPhoto:()=>o(!0)})})}),u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Galería de Fotos"}),u.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"flex items-center gap-2",children:[u.jsx(En,{size:16}),"Agregar"]})]}),u.jsx("div",{className:"bg-surface border border-border rounded-2xl overflow-hidden",children:u.jsx(yF,{images:r.images})})]})}),u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},className:"grid grid-cols-1 sm:grid-cols-2 gap-3 pt-4",children:[u.jsxs(oe,{onClick:()=>e(lt.toPlantChat(r.id)),className:"flex items-center justify-center gap-3 h-14 bg-primary text-primary-foreground hover:bg-primary/90",size:"lg",children:[u.jsx(yc,{size:20}),u.jsxs("span",{className:"font-medium",children:["Chatear con ",r.nickname||r.name]})]}),u.jsxs(oe,{onClick:()=>o(!0),variant:"outline",className:"flex items-center justify-center gap-3 h-14",size:"lg",children:[u.jsx(En,{size:20}),u.jsx("span",{className:"font-medium",children:"Documenta Progreso"})]})]})]})})}),u.jsx(kQ,{isOpen:s,onClose:()=>o(!1),onPhotoAdded:c,plantName:r.nickname||r.name})]})}):u.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[u.jsx(Jr,{className:"w-16 h-16 text-muted-foreground mx-auto"}),u.jsx("h1",{className:"text-2xl font-bold",children:"Planta no encontrada"}),u.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo encontrar la información de la planta solicitada."}),u.jsx(oe,{onClick:()=>e(lt.toDashboard()),className:"mt-4",children:"Volver al inicio"})]})})},RQ=({videoRef:t,canvasRef:e})=>{const[r,n]=w.useState(!1),[i,a]=w.useState(null),[s,o]=w.useState("environment"),[c,l]=w.useState(null),d=w.useRef(null),h=w.useCallback(async()=>{try{d.current&&d.current.getTracks().forEach(_=>_.stop()),l(null);const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:s,width:{ideal:1920},height:{ideal:1080},aspectRatio:16/9}});t.current&&(t.current.srcObject=g,d.current=g)}catch(g){console.error("Error accessing camera:",g),g instanceof Error?g.name==="NotAllowedError"||g.message.includes("Permission dismissed")?l("Permiso de cámara denegado. Por favor, actívalo en los ajustes de tu navegador."):l("No se pudo acceder a la cámara. Revisa los permisos y el dispositivo."):l("Ocurrió un error inesperado al acceder a la cámara.")}},[s,t]);w.useEffect(()=>(h(),()=>{d.current&&d.current.getTracks().forEach(g=>g.stop())}),[h]);const m=w.useCallback(()=>{if(!t.current||!e.current)return;const g=t.current,_=e.current,T=_.getContext("2d");if(!T)return;_.width=g.videoWidth,_.height=g.videoHeight,T.drawImage(g,0,0,g.videoWidth,g.videoHeight);const E=_.toDataURL("image/jpeg",.9);a(E),n(!0),d.current&&d.current.getTracks().forEach(j=>j.stop()),"vibrate"in navigator&&navigator.vibrate(50)},[t,e]),p=w.useCallback(()=>{a(null),n(!1),h()},[h]);return{isCapturing:r,capturedImage:i,cameraError:c,captureImage:m,retakePhoto:p,switchCamera:()=>{o(g=>g==="user"?"environment":"user")},startCamera:h,selectFromGallery:g=>{if(g&&g.type.startsWith("image/")){const _=new FileReader;_.onload=T=>{const E=T.target?.result;a(E),n(!0),d.current&&d.current.getTracks().forEach(j=>j.stop())},_.readAsDataURL(g)}}}},DQ=({error:t,onRetry:e})=>{const r=ar();return u.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center p-6",children:u.jsx("div",{className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full mx-4",children:u.jsxs("div",{className:"flex flex-col items-center text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:u.jsx(Jr,{size:32,className:"text-red-400"})}),u.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Camera Access Required"}),u.jsx("p",{className:"text-gray-300 text-sm mb-6 leading-relaxed",children:t}),u.jsxs("div",{className:"space-y-3 w-full",children:[u.jsxs(oe,{onClick:e,children:[u.jsx(La,{size:18,className:"mr-2"}),u.jsx("span",{children:"Try Again"})]}),u.jsx(oe,{onClick:()=>r(lt.toDashboard()),variant:"secondary",children:"Go Back"})]}),u.jsx("div",{className:"mt-4 p-3 bg-gray-800 rounded-lg",children:u.jsxs("p",{className:"text-gray-400 text-xs",children:[u.jsx("strong",{children:"How to enable camera:"}),u.jsx("br",{}),"1. Click the camera icon in your browser's address bar",u.jsx("br",{}),'2. Select "Allow" for camera access',u.jsx("br",{}),'3. Refresh the page or tap "Try Again"']})})]})})})},MQ=({image:t,isAnalyzing:e,onRetake:r,onAnalyze:n})=>u.jsxs(u.Fragment,{children:[u.jsx(L.img,{src:t,alt:"Captured plant",className:"absolute inset-0 w-full h-full object-cover z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),u.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[u.jsx(oe,{onClick:r,variant:"secondary",disabled:e,children:"Retake"}),u.jsx(oe,{onClick:n,disabled:e,children:e?u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),u.jsx("span",{children:"Analyzing..."})]}):"Add Plant"})]}),e&&u.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"AI is identifying your plant and creating a care profile..."})]})]}),LQ=({videoRef:t,canvasRef:e,flashEnabled:r,onCapture:n,onSwitchCamera:i,onToggleFlash:a,onSelectFromGallery:s})=>{const o=ar();return u.jsxs(u.Fragment,{children:[u.jsx(L.video,{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),u.jsx("canvas",{ref:e,className:"hidden"}),u.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 safe-area-top z-20",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx(oe,{onClick:()=>o(lt.toDashboard()),variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:u.jsx(Fi,{size:20})}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx(oe,{onClick:a,variant:"ghost",size:"icon",className:`rounded-full ${r?"bg-yellow-500 text-black hover:bg-yellow-600":"bg-black/50"}`,children:r?u.jsx(er,{size:20}):u.jsx(Dk,{size:20})}),u.jsx(oe,{onClick:i,variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:u.jsx(Mk,{size:20})})]})]})}),u.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[u.jsx(oe,{onClick:s,size:"icon",variant:"ghost",className:"w-14 h-14 rounded-full bg-black/50",children:u.jsx(np,{size:24})}),u.jsx(L.button,{onClick:n,className:"w-20 h-20 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center ios-button",whileHover:{scale:1.05},whileTap:{scale:.95},children:u.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center",children:u.jsx(En,{size:24,className:"text-gray-600"})})}),u.jsx("div",{className:"w-14 h-14"})]}),u.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"Position your plant in the frame and tap to capture, or select from gallery"})]}),u.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:u.jsx("div",{className:"w-64 h-64 border-2 border-white/50 rounded-2xl"})})]})},$Q=()=>{const t=ar(),{createPlant:e,isCreatingPlant:r}=Rd(),n=w.useRef(null),i=w.useRef(null),{isCapturing:a,capturedImage:s,cameraError:o,captureImage:c,retakePhoto:l,switchCamera:d,startCamera:h,selectFromGallery:m}=RQ({videoRef:n,canvasRef:i}),[p,v]=w.useState(!1),b=w.useRef(null),g=()=>{if(!s)return;const E="Interior",j=new Promise((R,D)=>{e({imageDataUrl:s,location:E},{onSuccess:S=>{S?.id?t(lt.toPlantDetail(S.id)):t(lt.toDashboard()),R(S)},onError:S=>{D(S)}})});yT.promise(j,{loading:"Analizando imagen con IA...",success:R=>`¡Planta "${R.name}" creada con éxito!`,error:R=>`Error: ${R.message}`})},_=()=>v(E=>!E),T=E=>{const j=E.target.files?.[0];j&&m(j)};return u.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[u.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:T,className:"hidden",id:"gallery-input"}),u.jsx(Pe,{mode:"wait",children:o?u.jsx(DQ,{error:o,onRetry:h},"error"):a?u.jsx(MQ,{image:s,isAnalyzing:r,onRetake:l,onAnalyze:g},"preview"):u.jsx(LQ,{videoRef:n,canvasRef:i,flashEnabled:p,onCapture:c,onSwitchCamera:d,onToggleFlash:_,onSelectFromGallery:()=>b.current?.click()},"capture")})]})},VQ=()=>{const{plantId:t}=tp(),e=ar(),{user:r}=Nn(),n=qn(l=>l.getPlantById(t||"")),i=qn(l=>l.addChatMessage),a=qn(l=>l.operationStates.chat.isLoading),s=w.useMemo(()=>{if(!n||!n.chatHistory||n.chatHistory.length===0)return!1;const l=n.chatHistory[n.chatHistory.length-1];return a&&l.sender==="user"},[n,a]);return{plant:n,isTyping:s,handleSendMessage:async l=>{if(!(!t||!r||!l.trim()))try{await i(t,l.trim(),r.id)}catch(d){console.error("Failed to send message:",d)}},handleGoBack:()=>{e(`/plant/${t}`)},currentUser:r}},zQ=({plant:t})=>{const e=ar(),r=()=>{const n=t.healthScore/100,i=t.lastWatered?new Date(t.lastWatered).getTime():0,a=i?Math.max(0,1-(Date.now()-i)/(t.careProfile.wateringFrequency*24*60*60*1e3)):0,s=n*.6+a*.4;return s>.8?"radiante":s>.6?"feliz":s>.4?"estable":"necesitada de atención"};return u.jsx("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:u.jsxs("div",{className:"flex items-center gap-2 p-4 pt-safe-top",children:[u.jsx("button",{onClick:()=>e(lt.toPlantDetail(t.id)),className:"btn btn-ghost btn-circle",children:u.jsx(ip,{size:20})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h1",{className:"font-bold text-foreground truncate",children:t.nickname||t.name}),u.jsxs("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 capitalize",children:["Se siente ",r()]})]}),u.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400",children:[u.jsx(I_,{className:"w-4 h-4"}),u.jsxs("span",{children:[t.healthScore,"%"]})]})]})})};var FQ={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},UQ=function(e,r,n){var i,a=FQ[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"en "+i:"hace "+i:i},BQ={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},HQ={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},WQ={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qQ={date:xs({formats:BQ,defaultWidth:"full"}),time:xs({formats:HQ,defaultWidth:"full"}),dateTime:xs({formats:WQ,defaultWidth:"full"})},KQ={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},GQ={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},YQ=function(e,r,n,i){return r.getUTCHours()!==1?GQ[e]:KQ[e]},ZQ={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},XQ={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},QQ={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},JQ={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},eJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},tJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},rJ=function(e,r){var n=Number(e);return n+"º"},nJ={ordinalNumber:rJ,era:ln({values:ZQ,defaultWidth:"wide"}),quarter:ln({values:XQ,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:ln({values:QQ,defaultWidth:"wide"}),day:ln({values:JQ,defaultWidth:"wide"}),dayPeriod:ln({values:eJ,defaultWidth:"wide",formattingValues:tJ,defaultFormattingWidth:"wide"})},iJ=/^(\d+)(º)?/i,aJ=/\d+/i,sJ={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},oJ={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},cJ={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},lJ={any:[/1/i,/2/i,/3/i,/4/i]},uJ={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},dJ={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},hJ={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},fJ={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},mJ={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},pJ={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},gJ={ordinalNumber:oA({matchPattern:iJ,parsePattern:aJ,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:sJ,defaultMatchWidth:"wide",parsePatterns:oJ,defaultParseWidth:"any"}),quarter:un({matchPatterns:cJ,defaultMatchWidth:"wide",parsePatterns:lJ,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:uJ,defaultMatchWidth:"wide",parsePatterns:dJ,defaultParseWidth:"any"}),day:un({matchPatterns:hJ,defaultMatchWidth:"wide",parsePatterns:fJ,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:mJ,defaultMatchWidth:"any",parsePatterns:pJ,defaultParseWidth:"any"})},zC={code:"es",formatDistance:UQ,formatLong:qQ,formatRelative:YQ,localize:nJ,match:gJ,options:{weekStartsOn:1,firstWeekContainsDate:1}};const yJ=t=>{switch(t){case"happy":case"excited":return"😊";case"grateful":return"🥰";case"worried":return"😟";case"sad":return"😢";default:return"🌱"}},vJ=({message:t})=>{const e=t.sender==="user",r=n=>{kd.success("¡Gracias por tu feedback!",n?"Nos alegra que la respuesta te haya sido útil.":"Trabajaremos para mejorar las respuestas.")};return u.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2",e?"justify-end":"justify-start"),children:[!e&&u.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:yJ(t.emotion)}),u.jsxs("div",{className:Oe("max-w-xs rounded-2xl px-4 py-2 sm:max-w-sm md:max-w-md shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm":"rounded-bl-lg bg-contrast-surface text-contrast-medium border border-contrast","rounded-[12px]"),children:[u.jsx("p",{className:"text-sm",children:t.content}),t.context?.insights&&t.context.insights.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),u.jsx("ul",{className:"space-y-1",children:t.context.insights.map((n,i)=>u.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[u.jsxs("div",{className:"font-medium",children:[n.type==="warning"&&"⚠️ ",n.type==="tip"&&"💡 ",n.type==="recommendation"&&"🌱 ",n.type==="observation"&&"🔎 ",n.title]}),u.jsx("div",{children:n.description}),n.affectedPlants&&n.affectedPlants.length>0&&u.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",n.affectedPlants.join(", ")]})]},i))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),u.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((n,i)=>u.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[u.jsx("div",{className:"font-medium",children:n.action}),n.priority&&u.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",n.priority]}),n.plantIds&&n.plantIds.length>0&&u.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",n.plantIds.join(", ")]})]},i))})]}),u.jsx("p",{className:Oe("mt-1 text-xs",e?"text-white/80":"text-contrast-soft","text-[#888] text-[12px]"),children:lA(new Date(t.timestamp),{addSuffix:!0,locale:zC})}),!e&&u.jsxs("div",{className:"flex gap-2 mt-2",children:[u.jsx("button",{"aria-label":"Respuesta útil",className:"text-green-600 hover:text-green-800 text-lg focus:outline-none",onClick:()=>r(!0),children:"👍"}),u.jsx("button",{"aria-label":"Respuesta no útil",className:"text-red-500 hover:text-red-700 text-lg focus:outline-none",onClick:()=>r(!1),children:"👎"})]})]})]})},bJ=({messages:t})=>u.jsx("div",{className:"space-y-4",children:t.map(e=>u.jsx(vJ,{message:e},e.id))}),xJ=["¿Cómo te sientes hoy?","¿Necesitas agua?","Cuéntame un dato curioso sobre ti"],wJ=({onSendMessage:t,isTyping:e})=>{const[r,n]=w.useState(""),i=w.useRef(null),a=()=>{const o=i.current?.value.trim();o&&(t(o),i.current&&(i.current.value=""))},s=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a())};return u.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:u.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Md,{type:"text",ref:i,onKeyDown:s,placeholder:"Escribe un mensaje...",className:"pr-12",disabled:e}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:u.jsx(V_,{size:16})})]}),u.jsx(oe,{"aria-label":"Enviar mensaje",onClick:a,disabled:!r.trim()||e,size:"icon",children:u.jsx(z_,{size:20})})]}),u.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:xJ.map(o=>u.jsx(oe,{onClick:()=>n(o),disabled:e,variant:"secondary",size:"sm",children:o},o))})]})})},FC=()=>{const t={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return u.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[u.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:"🌱"}),u.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[u.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),u.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),u.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})},_J=({plantName:t})=>u.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center text-center p-8",children:[u.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-primary/10 mb-4",children:u.jsx(er,{className:"h-8 w-8 text-primary"})}),u.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Inicia una conversación"}),u.jsxs("p",{className:"text-muted-foreground max-w-xs",children:[t," está esperando para charlar. ¡Pregúntale sobre sus cuidados o simplemente saluda!"]})]}),EJ=()=>{const{plantId:t}=tp(),e=ar(),{loading:r,error:n}=dg(t),{plant:i,isTyping:a,handleSendMessage:s}=VQ(),o=w.useRef(null);return w.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[i?.chatHistory,a]),r?u.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-background px-4",children:u.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center space-y-4",children:[u.jsx(ga,{className:"w-12 h-12 animate-spin text-primary mx-auto"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Preparando chat"}),u.jsx("p",{className:"text-muted-foreground",children:"Conectando con tu planta..."})]})]})}):n?u.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-background px-4",children:u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center space-y-4 max-w-md",children:[u.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Error de conexión"}),u.jsx("p",{className:"text-muted-foreground",children:n})]}),u.jsx(oe,{onClick:()=>e(-1),className:"mt-4",children:"Volver"})]})}):i?u.jsxs("div",{className:"flex flex-col h-screen bg-background",children:[u.jsx(zQ,{plant:i}),u.jsx("div",{className:"flex-1 overflow-hidden",children:u.jsx("div",{className:"h-full overflow-y-auto",children:u.jsx("div",{className:"min-h-full flex flex-col",children:u.jsxs("div",{className:"flex-1 px-4 py-6 space-y-4",children:[u.jsx(Pe,{mode:"wait",children:i.chatHistory.length===0?u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"h-full flex items-center justify-center",children:u.jsx(_J,{plantName:i.nickname||i.name})},"empty-chat"):u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-4",children:u.jsx(bJ,{messages:i.chatHistory,plantNickname:i.nickname||i.name})},"message-list")}),u.jsx(Pe,{children:a&&u.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:u.jsx(FC,{})})}),u.jsx("div",{ref:o})]})})})}),u.jsx("div",{className:"border-t border-border bg-background/95 backdrop-blur-sm",children:u.jsx(wJ,{onSendMessage:s,isTyping:a})})]}):u.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-background px-4",children:u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center space-y-4 max-w-md",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mx-auto",children:u.jsx("span",{className:"text-2xl",children:"🌱"})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Planta no encontrada"}),u.jsx("p",{className:"text-muted-foreground",children:"No pudimos encontrar la información de esta planta."})]}),u.jsx(oe,{onClick:()=>e(-1),className:"mt-4",children:"Volver al jardín"})]})})};class TJ{constructor(e,r){Nr(this,"supabase");Nr(this,"cache");this.supabase=e,this.cache=r}async sendMessage(e,r,n){try{const{data:{session:i},error:a}=await this.supabase.auth.getSession();if(a||!i?.access_token)throw console.error("User session not available:",a),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:s,error:o}=await this.supabase.functions.invoke("garden-ai-chat",{body:{message:e,sessionId:r,userId:n},headers:{Authorization:`Bearer ${i.access_token}`}});if(o)throw new Error(`Garden AI service error: ${o.message}`);if(!s)throw new Error("No data received from garden AI service");return s}catch(i){throw console.error("Error in garden chat service:",i),i}}async sendMessageToGardenAI(e,r,n){try{const i=await this.buildGardenContext(r),a=n.map(v=>({role:v.sender==="user"?"user":"assistant",content:v.content})),s="amigable, motivador, experto, cálido, y con un toque de humor ligero",{data:{session:o},error:c}=await this.supabase.auth.getSession();if(c||!o?.access_token)throw console.error("User session not available:",c),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:l,error:d}=await this.supabase.functions.invoke("garden-ai-chat",{body:{userMessage:e,gardenContext:i,conversationHistory:a,tonePersona:s},headers:{Authorization:`Bearer ${o.access_token}`}});if(d)throw new Error(`Garden AI service error: ${d.message}`);if(!l)throw new Error("No data received from garden AI service");const h=typeof l=="string"?JSON.parse(l):l,m=(h.content||"").toLowerCase();return(!h.content||m.includes("no sé")||m.includes("no tengo información")||m.includes("no puedo ayudarte")||m.length<30)&&kd.warning("Respuesta genérica","La respuesta de la IA fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{content:h.content||"Lo siento, no pude procesar tu mensaje.",insights:h.insights||[],suggestedActions:h.suggestedActions||[]}}catch(i){throw i}}async verifyFunctionAvailability(){try{const e={userMessage:"ping",gardenContext:{totalPlants:0,plantsData:[],averageHealthScore:0,commonIssues:[],careScheduleSummary:{needsWatering:[],needsFertilizing:[],healthConcerns:[]},environmentalFactors:{locations:["test"]}},conversationHistory:[]},{data:{session:r},error:n}=await this.supabase.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await this.supabase.functions.invoke("garden-ai-chat",{body:e,headers:{Authorization:`Bearer ${r.access_token}`}});return a?a.message.includes("404")||a.message.includes("not found")?{available:!1,error:"La función de chat de jardín no está disponible en este momento"}:{available:!1,error:a.message}:i&&typeof i.content=="string"?{available:!0}:{available:!1,error:"Function returned unexpected response format"}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Error desconocido"}}}async getGardenHealthSummary(e){try{const r=this.cache.getGardenSummary(e);if(r)return r;const n=await this.buildGardenContext(e),i=n.plantsData.filter(o=>o.healthScore>=80).length,a=n.careScheduleSummary.needsWatering.length+n.careScheduleSummary.healthConcerns.length,s={totalPlants:n.totalPlants,averageHealth:n.averageHealthScore,urgentActions:a,healthyPlants:i};return this.cache.setGardenSummary(e,s),s}catch(r){throw console.error("Error getting garden health summary:",r),r}}async getSuggestedQuestions(e){try{const r=await this.buildGardenContext(e),n=[];return r.totalPlants===0?(n.push("¿Cómo agrego mi primera planta?"),n.push("¿Qué tipo de planta me recomiendas para empezar?"),n):(n.push("¿Cuántas plantas tengo y cómo están?"),n.push("¿Cuál es la salud promedio de mi jardín?"),r.careScheduleSummary.healthConcerns.length>0&&(n.push("¿Qué plantas necesitan atención especial?"),n.push("¿Qué problemas de salud hay en mi jardín?")),r.plantsData.some(i=>i.healthScore>=80)&&n.push("¿Cuáles de mis plantas están más sanas?"),r.environmentalFactors.locations.length>1&&n.push("¿Cómo afecta la ubicación a mis plantas?"),r.totalPlants>5&&n.push("¿Cómo organizar mejor mi espacio de plantas?"),r.plantsData.some(i=>"lastFertilized"in i&&!!i.lastFertilized)&&n.push("¿Cuándo debo fertilizar mis plantas?"),new Set(r.plantsData.map(i=>i.species)).size>1&&n.push("¿Qué especie de planta es la más resistente en mi jardín?"),n.slice(0,6))}catch(r){return console.error("Error getting suggested questions:",r),["¿Cuántas plantas tengo y cómo están?","¿Cuál es la salud promedio de mi jardín?"]}}async refreshGardenData(e){try{this.invalidateCache(e),await this.buildGardenContext(e),console.log("[GardenChatService] Garden data refreshed for user:",e)}catch(r){throw console.error("Error refreshing garden data:",r),r}}async buildGardenContext(e){try{const r=this.cache.getGardenContext(e);if(r)return r;const{data:n,error:i}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          last_fertilized,
          care_profile,
          date_added
        `).eq("user_id",e).order("created_at",{ascending:!1});if(i)throw i;const a=n.map(v=>({id:v.id,name:v.name,nickname:v.nickname||void 0,species:v.species,location:v.location,plantEnvironment:v.plant_environment,lightRequirements:v.light_requirements,healthScore:v.health_score||85,lastWatered:v.last_watered?new Date(v.last_watered):void 0,wateringFrequency:v.care_profile?.wateringFrequency})),s=a.length,o=s>0?Math.round(a.reduce((v,b)=>v+b.healthScore,0)/s):0,c=new Date,l=[],d=[],h=[];a.forEach(v=>{if(v.lastWatered&&v.wateringFrequency){const b=new Date(v.lastWatered),g=new Date(b);g.setDate(b.getDate()+v.wateringFrequency),c>g&&l.push(v.id)}v.healthScore<70&&h.push(v.id)});const m=[...new Set(a.map(v=>v.location))],p={totalPlants:s,plantsData:a,averageHealthScore:o,commonIssues:[],careScheduleSummary:{needsWatering:l,needsFertilizing:d,healthConcerns:h},environmentalFactors:{locations:m,lightConditions:[],humidityNeeds:[]}};return this.cache.setGardenContext(e,p),p}catch(r){throw console.error("Error building garden context:",r),r}}invalidateCache(e){this.cache.invalidateCache(e),console.log("Cache invalidated for user:",e)}}const ca=new TJ(Et,Fo),AJ=()=>{const{user:t}=Nn(),[e,r]=w.useState([]),[n,i]=w.useState(!1),[a,s]=w.useState(!1),[o,c]=w.useState(null),[l,d]=w.useState(null),[h,m]=w.useState([]),[p,v]=w.useState("");w.useEffect(()=>{t?.id&&b()},[t?.id]);const b=async()=>{if(t?.id){i(!0);try{const[D,S]=await Promise.all([ca.getGardenHealthSummary(t.id),ca.getSuggestedQuestions(t.id)]);if(d(D),m(S),e.length===0&&D.totalPlants>0){const A={id:`welcome-${Date.now()}`,sender:"ai",content:`¡Hola! Soy tu asistente de jardín 🌱 

Veo que tienes ${D.totalPlants} plantas en tu jardín con una salud promedio de ${D.averageHealth}%. ${D.urgentActions>0?`Hay ${D.urgentActions} acciones que podrían necesitar tu atención.`:"¡Todo parece estar en buen estado!"}

¿En qué puedo ayudarte hoy con tu jardín?`,timestamp:new Date,context:{queryType:"general"}};r([A])}}catch(D){console.error("Error loading initial garden data:",D),c("Error al cargar la información del jardín")}finally{i(!1)}}},g=w.useCallback(async D=>{if(!t?.id||!D.trim()||a)return;const S=await ca.verifyFunctionAvailability();if(!S.available){c(`🚧 El chat de jardín no está disponible: ${S.error}`);return}const A={id:`user-${Date.now()}`,sender:"user",content:D.trim(),timestamp:new Date};v(D.trim()),r(P=>[...P,A]),s(!0),c(null);try{const P=await ca.sendMessageToGardenAI(D.trim(),t.id,e),O={id:`ai-${Date.now()}`,sender:"ai",content:P.content,timestamp:new Date,context:{plantsAnalyzed:SJ(P),queryType:IJ(D),insights:P.insights||[],suggestedActions:P.suggestedActions||[]}};if(r(N=>[...N,O]),P.suggestedActions&&P.suggestedActions.length>0){const N=await ca.getGardenHealthSummary(t.id);d(N)}}catch(P){console.error("Error sending message to garden AI:",P);let O="Error al enviar el mensaje. Por favor intenta de nuevo.";P instanceof Error&&(P.message.includes("función de chat de jardín no está disponible")?O="🚧 El chat de jardín está temporalmente no disponible. Estamos trabajando para solucionarlo.":P.message.includes("CORS")?O="🔧 Error de configuración. Por favor contacta al administrador.":P.message.includes("garden-ai-chat no existe")&&(O="⚠️ Servicio no configurado. El chat de jardín necesita configuración adicional.")),c(O),r(N=>N.slice(0,-1))}finally{s(!1)}},[t?.id,e,a]),_=w.useCallback(async()=>{p&&await g(p)},[p,g]),T=w.useCallback(()=>{r([]),c(null),t?.id&&b()},[t?.id]),E=w.useCallback(async()=>{if(t?.id){i(!0);try{await ca.refreshGardenData(t.id),await b(),console.log("[useGardenChat] Garden data refreshed successfully")}catch(D){console.error("Error refreshing garden data:",D),c("Error al actualizar los datos del jardín")}finally{i(!1)}}},[t?.id]),j=w.useMemo(()=>n,[n]),R=w.useMemo(()=>{},[t?.id,l]);return{messages:e,isLoading:j,isTyping:a,error:o,gardenSummary:l,suggestedQuestions:h,sendMessage:g,clearMessages:T,retryLastMessage:_,refreshGardenData:E,cacheStats:R}};function SJ(t){const e=[];return t.insights&&t.insights.forEach(r=>{r.affectedPlants&&e.push(...r.affectedPlants)}),t.suggestedActions&&t.suggestedActions.forEach(r=>{r.plantIds&&e.push(...r.plantIds)}),[...new Set(e)]}function IJ(t){const e=t.toLowerCase();return e.includes("salud")||e.includes("problema")||e.includes("enferm")?"health_analysis":e.includes("comparar")||e.includes("diferencia")||e.includes("mejor")?"care_comparison":e.includes("hongo")||e.includes("plaga")||e.includes("prevenir")?"disease_prevention":e.includes("crecimiento")||e.includes("progreso")||e.includes("tiempo")?"growth_tracking":"general"}const PJ=({onClose:t})=>{const[e,r]=w.useState([{name:"garden-ai-chat",available:!1}]),[n,i]=w.useState(!1),a=async()=>{i(!0);const c=[],l=await ca.verifyFunctionAvailability();c.push({name:"garden-ai-chat",available:l.available,error:l.error,lastChecked:new Date}),r(c),i(!1)};w.useEffect(()=>{a()},[]);const s=c=>c.available?u.jsx(Ai,{className:"w-5 h-5 text-green-500"}):u.jsx(Jr,{className:"w-5 h-5 text-red-500"}),o=c=>c.available?"Disponible":"No disponible";return u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:u.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:c=>c.stopPropagation(),className:"w-full max-w-md",children:u.jsxs(Ir,{className:"p-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[u.jsx(F_,{className:"w-6 h-6 text-blue-500"}),u.jsx("h3",{className:"text-lg font-semibold",children:"Diagnóstico del Sistema"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Estado de Funciones Edge"}),u.jsx("div",{className:"space-y-3",children:e.map(c=>u.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[s(c),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-sm",children:c.name}),u.jsx("p",{className:"text-xs text-muted-foreground",children:o(c)})]})]}),c.error&&u.jsxs("div",{className:"text-xs text-red-500 max-w-32 text-right",children:[c.error.substring(0,50),"..."]})]},c.name))})]}),e.some(c=>!c.available)&&u.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(Jr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"text-sm",children:[u.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Servicios no disponibles"}),u.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Algunos servicios del chat de jardín no están funcionando. Verifica que las funciones Edge estén desplegadas en Supabase."})]})]})}),u.jsxs("div",{className:"flex gap-3 pt-3",children:[u.jsxs(oe,{onClick:a,disabled:n,variant:"outline",size:"sm",className:"flex-1 gap-2",children:[u.jsx(La,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Verificar Nuevamente"]}),u.jsx(oe,{onClick:t,variant:"secondary",size:"sm",className:"flex-1",children:"Cerrar"})]})]})]})})})},If=({gardenSummary:t,onClearChat:e,onRefresh:r,isRefreshing:n=!1})=>{const i=ar(),[a,s]=w.useState(!1),o=l=>l>=80?"text-green-500":l>=60?"text-green-400":"text-red-500",c=l=>l>=80?"Excelente":l>=60?"Buena":"Necesita atención";return u.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[u.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[u.jsx("button",{onClick:()=>i(lt.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:u.jsx(ip,{size:20})}),u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:u.jsx(eu,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardín"}),t&&u.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[u.jsxs("span",{className:"flex items-center gap-1",children:[u.jsx(R_,{size:12}),t.totalPlants," plantas"]}),u.jsx("span",{className:`font-medium ${o(t.averageHealth)} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:c(t.averageHealth)}),t.urgentActions>0&&u.jsxs(L.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[t.urgentActions," acciones"]})]})]})]})}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnóstico del sistema",children:u.jsx(F_,{size:18})}),r&&u.jsx("button",{onClick:r,disabled:n,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardín",children:u.jsx(L.div,{animate:n?{rotate:360}:{},transition:n?{duration:1,repeat:1/0,ease:"linear"}:{},children:u.jsx(La,{size:18})})}),u.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:u.jsx(D_,{size:20})})]})]}),u.jsx(Pe,{children:a&&u.jsx(PJ,{onClose:()=>s(!1)})})]})},CJ=({message:t})=>{const e=t.sender==="user",r=()=>{if(!t.context?.queryType)return u.jsx(Ho,{size:16});switch(t.context.queryType){case"health_analysis":return u.jsx(_n,{size:16});case"care_comparison":return u.jsx(Pf,{size:16});case"disease_prevention":return u.jsx($k,{size:16});case"growth_tracking":return u.jsx($_,{size:16});default:return u.jsx(Ho,{size:16})}},n=()=>{if(e)return"text-primary-foreground/70";if(!t.context?.queryType)return"text-green-500";switch(t.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}};return u.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2 max-w-[85%]",e?"justify-end ml-auto":"justify-start"),children:[!e&&u.jsx(L.div,{className:Oe("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:u.jsx("div",{className:n(),children:r()})}),u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:Oe("rounded-2xl px-4 py-3 break-words shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[u.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.content}),t.context?.insights&&t.context.insights.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),u.jsx("ul",{className:"space-y-1",children:t.context.insights.map((i,a)=>u.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[u.jsxs("div",{className:"font-medium",children:[i.type==="warning"&&"⚠️ ",i.type==="tip"&&"💡 ",i.type==="recommendation"&&"🌱 ",i.type==="observation"&&"🔎 ",i.title]}),u.jsx("div",{children:i.description}),i.affectedPlants&&i.affectedPlants.length>0&&u.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",i.affectedPlants.join(", ")]})]},a))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),u.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((i,a)=>u.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[u.jsx("div",{className:"font-medium",children:i.action}),i.priority&&u.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",i.priority]}),i.plantIds&&i.plantIds.length>0&&u.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",i.plantIds.join(", ")]})]},a))})]}),!e&&t.context?.plantsAnalyzed&&t.context.plantsAnalyzed.length>0&&u.jsxs(L.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[u.jsx(Pf,{size:12}),u.jsxs("span",{children:["Analizó ",t.context.plantsAnalyzed.length," planta(s)"]})]}),u.jsx("div",{className:Oe("mt-2 text-xs",e?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:lA(new Date(t.timestamp),{addSuffix:!0,locale:zC})})]})}),e&&u.jsx(L.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:u.jsx(Lk,{size:16,className:"text-primary"})})]})},kJ=({onSendMessage:t,isTyping:e,suggestedQuestions:r,isLoading:n=!1})=>{const[i,a]=w.useState(""),[s,o]=w.useState(!0),c=w.useRef(null),l=async()=>{if(e)return;const p=c.current?.value.trim();p&&(o(!1),c.current&&(c.current.value=""),await t(p))},d=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),l())},h=async p=>{a(""),o(!1),await t(p)},m=()=>{r.length>0&&!i&&o(!0)};return u.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:u.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[u.jsx(Pe,{children:s&&r.length>0&&!n&&u.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[u.jsx(er,{size:12}),u.jsx("span",{children:"Preguntas sugeridas"})]}),u.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((p,v)=>u.jsx(L.button,{onClick:()=>h(p),disabled:e,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:v*.1},whileHover:{scale:1.02},whileTap:{scale:.98},children:p},p))})]})}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Md,{type:"text",ref:c,onKeyDown:d,onFocus:m,placeholder:"Pregúntame sobre tu jardín...",className:"pr-12",disabled:e||n}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:u.jsx(V_,{size:16})})]}),u.jsx(oe,{"aria-label":"Enviar mensaje",onClick:l,disabled:!i.trim()||e||n,size:"icon",className:"shrink-0",children:e?u.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u.jsx(er,{size:20})}):u.jsx(z_,{size:20})})]}),n&&u.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[u.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u.jsx(er,{size:12})}),u.jsx("span",{children:"Analizando tu jardín..."})]})]})})},NJ={plants:u.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:u.jsxs(L.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[u.jsx(L.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),u.jsx(L.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:u.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),u.jsx(L.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:u.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),u.jsx(L.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:u.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:u.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:u.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[u.jsx(L.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),u.jsx(L.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),u.jsx(L.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),u.jsx(L.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:u.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:u.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[u.jsx(L.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),u.jsx(L.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),u.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[u.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),u.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),u.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:u.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:u.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[u.jsx(L.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),u.jsx(L.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),u.jsx(L.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),u.jsx(L.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:u.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:u.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[u.jsxs(L.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[u.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),u.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),u.jsxs(L.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[u.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),u.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},jJ=({icon:t,title:e,description:r,action:n,illustration:i="plants",className:a})=>u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:Oe("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",a),children:[u.jsx(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:t||NJ[i]}),u.jsx(L.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:e}),u.jsx(L.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),n&&u.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:u.jsx(oe,{onClick:n.onClick,variant:"primary",size:"lg",className:"animate-glow",children:n.label})})]}),OJ=()=>{const t=ar(),e=qn(p=>p.plants),{messages:r,isLoading:n,isTyping:i,error:a,gardenSummary:s,suggestedQuestions:o,sendMessage:c,clearMessages:l,refreshGardenData:d}=AJ(),h=w.useRef(null);if(w.useEffect(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[r,i]),a&&!s)return u.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[u.jsx(If,{gardenSummary:s}),u.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:u.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[u.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexión"}),u.jsx("p",{className:"text-muted-foreground mb-4",children:a}),u.jsxs(oe,{onClick:d,variant:"primary",children:[u.jsx(La,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]});if(s?.totalPlants===0)return u.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[u.jsx(If,{gardenSummary:s}),u.jsx("div",{className:"flex-1 flex items-center justify-center",children:u.jsx(jJ,{illustration:"plants",title:"Tu jardín está vacío",description:"Agrega algunas plantas a tu jardín para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>t(lt.toCamera())}})})]});const m=async p=>{await c(p)};return u.jsxs("div",{className:"flex flex-col h-screen bg-background",children:[u.jsx(If,{gardenSummary:s,onClearChat:l,onRefresh:d,isRefreshing:n&&r.length>0}),u.jsx("div",{className:"flex-1 overflow-hidden",children:u.jsx("div",{className:"h-full overflow-y-auto",children:u.jsxs("div",{className:"min-h-full flex flex-col",children:[r.length===0&&e.length>0&&u.jsx("div",{className:"px-4 py-4 border-b border-border bg-surface/50",children:u.jsxs("div",{className:"space-y-3",children:[u.jsx("h3",{className:"text-sm font-semibold text-foreground",children:"Chats con tus plantas"}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.slice(0,4).map(p=>u.jsx(Ir,{variant:"default",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>t(lt.toPlantChat(p.id)),children:u.jsx(Jn,{className:"p-3",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:u.jsx(eu,{className:"w-4 h-4 text-primary"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium truncate text-foreground",children:p.nickname||p.name}),u.jsx("p",{className:"text-xs text-muted-foreground truncate",children:p.species})]}),u.jsx(yc,{className:"w-4 h-4 text-muted-foreground flex-shrink-0"})]})})},p.id)),e.length>4&&u.jsx(Ir,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(lt.toDashboard()),children:u.jsx(Jn,{className:"p-3 flex items-center justify-center",children:u.jsxs("span",{className:"text-sm text-muted-foreground font-medium",children:["+",e.length-4," más"]})})})]})]})}),u.jsxs("div",{className:"flex-1 px-4 py-6",children:[u.jsx(Pe,{mode:"wait",children:r.length===0?u.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"h-full flex items-center justify-center",children:e.length===0?u.jsxs("div",{className:"text-center space-y-4 max-w-md mx-auto",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mx-auto",children:u.jsx("span",{className:"text-3xl",children:"🌱"})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"¡Comienza tu jardín!"}),u.jsx("p",{className:"text-muted-foreground",children:"Agrega tu primera planta para comenzar a chatear con tu asistente IA."})]}),u.jsx(oe,{onClick:()=>t(lt.toCamera()),className:"mt-4",children:"Agregar primera planta"})]}):u.jsxs("div",{className:"text-center space-y-4 max-w-md mx-auto",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto",children:u.jsx(eu,{className:"w-8 h-8 text-primary"})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"¡Hola, jardinero! 🌱"}),u.jsxs("p",{className:"text-muted-foreground",children:["Soy tu asistente IA. Pregúntame sobre el cuidado de tus ",e.length," plantas, consejos de jardinería o cualquier duda que tengas."]})]})]})},"empty-garden-chat"):u.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-4",children:u.jsx("div",{className:"space-y-4",children:r.map(p=>u.jsx(CJ,{message:p},p.id))})},"garden-messages")}),u.jsx(Pe,{children:i&&u.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mt-4",children:u.jsx(FC,{})})}),u.jsx("div",{ref:h})]})]})})}),u.jsx("div",{className:"border-t border-border bg-background/95 backdrop-blur-sm",children:u.jsx(kJ,{onSendMessage:m,isTyping:i,suggestedQuestions:o,isLoading:n})}),!1]})},RJ=w.lazy(()=>ep(()=>import("./Settings-CosF-7wo.js"),__vite__mapDeps([0,1,2,3,4,5]))),DJ=w.lazy(()=>ep(()=>import("./Auth-Ct2-Ig2I.js"),__vite__mapDeps([6,1,2,4,5,3]))),MJ=new __({defaultOptions:{queries:{staleTime:gi.QUERY.STALE_TIME.MEDIUM,gcTime:gi.QUERY.GC_TIME.MEDIUM,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:gi.QUERY.RETRY.COUNT,retryDelay:t=>Math.min(gi.QUERY.RETRY.DELAY*2**t,3e4)},mutations:{retry:gi.QUERY.RETRY.COUNT,retryDelay:gi.QUERY.RETRY.DELAY}}}),x_=({message:t})=>u.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[u.jsx(od,{className:"w-12 h-12 text-green-500 animate-bounce mb-4"}),u.jsx("p",{className:"text-lg text-muted-foreground",children:t})]}),LJ=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/":window.location.pathname.startsWith("/plantitas-app")?"/plantitas-app/":"/",$J=()=>{const t=qL();if(A4(),w.useEffect(()=>{console.log("[APP] useEffect running...");try{const r=S4();return()=>{console.log("[APP] Cleanup running..."),r()}}catch(r){throw Qp("APP_INITIALIZATION",r),r}},[]),!t.initialized){const r=t.loading?t.progress.message:t.error||"Inicializando...";return u.jsx(x_,{message:r})}const e=()=>u.jsx(Sv,{children:u.jsxs(sn,{path:"/",element:u.jsx(K3,{}),children:[u.jsx(sn,{index:!0,element:u.jsx(yz,{})}),u.jsx(sn,{path:"camera",element:u.jsx($Q,{})}),u.jsx(sn,{path:"settings",element:u.jsx(RJ,{})}),u.jsx(sn,{path:"garden-chat",element:u.jsx(OJ,{})}),u.jsx(sn,{path:"plant/:plantId",element:u.jsx(OQ,{})}),u.jsx(sn,{path:"plant/:plantId/chat",element:u.jsx(EJ,{})}),u.jsx(sn,{path:"*",element:u.jsx(zh,{to:wt.dashboard,replace:!0})})]})});return u.jsx(E_,{client:MJ,children:u.jsx(E4,{children:u.jsx(G3,{children:u.jsxs(yk,{basename:LJ(),future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[u.jsx(b4,{position:"top-center",richColors:!0}),u.jsx(C4,{}),u.jsx(w.Suspense,{fallback:u.jsx(x_,{message:"Cargando..."}),children:u.jsxs(Sv,{children:[u.jsx(sn,{path:wt.auth,element:t.user?u.jsx(zh,{to:wt.dashboard,replace:!0}):u.jsx(DJ,{})}),u.jsx(sn,{path:"/*",element:t.user?u.jsx(e,{}):u.jsx(zh,{to:wt.auth,replace:!0})})]})})]})})})})},VJ=w.createContext(void 0),zJ=({children:t,defaultTheme:e="system",storageKey:r="vite-ui-theme"})=>{const[n,i]=w.useState(()=>localStorage.getItem(r)||e),a=w.useMemo(()=>n==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,[n]);w.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(a),localStorage.setItem(r,n)},[a,n,r]);const s={theme:n,setTheme:i,resolvedTheme:a};return u.jsx(VJ.Provider,{value:s,children:t})};console.log("[MOBILE] 🚨 Main.tsx loading started");console.log("[MOBILE] Location:",window.location.href);console.log("[MOBILE] Pathname:",window.location.pathname);console.log("[MOBILE] User Agent:",navigator.userAgent);window.addEventListener("error",t=>{console.error("[GLOBAL] Uncaught error:",t.error),console.error("[GLOBAL] Error details:",{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,stack:t.error?.stack})});window.addEventListener("unhandledrejection",t=>{console.error("[GLOBAL] Unhandled promise rejection:",t.reason),console.error("[GLOBAL] Promise:",t.promise)});try{k4(),console.log("[MOBILE] Debug system initialized")}catch(t){console.error("[MOBILE] Debug system failed:",t)}const UC=new __;function FJ(){const{user:t}=Nn();return H.useEffect(()=>{t?.id&&UC.prefetchQuery({queryKey:["plants",t.id],queryFn:()=>hs.getUserPlantSummaries(t.id),staleTime:1e3*60*5})},[t?.id]),null}console.log("[MOBILE] Looking for root container...");const BC=document.getElementById("root");if(!BC)throw Qp("ROOT_CONTAINER","Root container not found"),new Error("Root container not found");console.log("[MOBILE] Root container found, creating React root...");try{const t=Cf.createRoot(BC);console.log("[MOBILE] React root created, rendering App..."),t.render(u.jsx(H.StrictMode,{children:u.jsx(zJ,{children:u.jsxs(E_,{client:UC,children:[u.jsx(FJ,{}),u.jsx($J,{})]})})})),console.log("[MOBILE] App render called successfully")}catch(t){throw Qp("REACT_RENDER",t),t}export{oe as B,Nn as a,Y3 as b,Oe as c,F3 as g,q3 as u};
