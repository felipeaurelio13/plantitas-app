const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Settings-BHY6i4nz.js","assets/js/query-D9cK7eLy.js","assets/js/vendor-ohv-86MT.js","assets/js/router-Lz5I7iQY.js","assets/js/ui-BaGPRaSD.js","assets/js/supabase-ChG5PfJU.js","assets/js/Auth-dkmTSe6U.js"])))=>i.map(i=>d[i]);
var dC=Object.defineProperty;var hC=(t,e,r)=>e in t?dC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var qr=(t,e,r)=>hC(t,typeof e!="symbol"?e+"":e,r);import{j as d,u as nd,a as Ti,b as E_,Q as T_,c as A_}from"./query-D9cK7eLy.js";import{a as Xm,b as H,d as fC,r as w,e as Ui}from"./vendor-ohv-86MT.js";import{c as mC,_ as Qm}from"./supabase-ChG5PfJU.js";import{u as ar,a as I_,L as pC,O as gC,b as Jm,B as yC,R as Pv,c as sn,N as Lh}from"./router-Lz5I7iQY.js";import{A as ke,R as S_,L as ml,C as _n,B as ep,I as tp,a as Lr,b as vC,c as Un,m as L,X as ni,T as Jr,d as ya,P as rp,e as np,H as Zc,f as Uo,S as bC,W as xC,g as P_,h as ji,i as Bt,j as Ii,k as k_,D as id,E as wC,l as Af,M as pl,n as C_,o as _C,p as EC,q as TC,U as N_,r as AC,s as IC,t as j_,u as O_,v as SC,w as R_,x as Xc,y as D_,z as PC,F as kv,G as ip,J as M_,K as L_,N as Cv,O as kC,Q as $_,V as ap,Y as V_,Z as CC,_ as NC,$ as jC,a0 as OC,a1 as RC,a2 as Nv,a3 as DC,a4 as MC,a5 as F_,a6 as z_,a7 as U_,a8 as LC,a9 as $C}from"./ui-BaGPRaSD.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var If={},jv=Xm;If.createRoot=jv.createRoot,If.hydrateRoot=jv.hydrateRoot;const Ov=t=>{let e;const r=new Set,n=(c,u)=>{const h=typeof c=="function"?c(e):c;if(!Object.is(h,e)){const m=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=e=t(n,i,o);return o},VC=t=>t?Ov(t):Ov,FC=t=>t;function zC(t,e=FC){const r=H.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return H.useDebugValue(r),r}const Rv=t=>{const e=VC(t),r=n=>zC(e,n);return Object.assign(r,e),r},sp=t=>t?Rv(t):Rv;var B_=Symbol.for("immer-nothing"),Dv=Symbol.for("immer-draftable"),Ar=Symbol.for("immer-state");function Gr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var _s=Object.getPrototypeOf;function Ta(t){return!!t&&!!t[Ar]}function Gn(t){return t?H_(t)||Array.isArray(t)||!!t[Dv]||!!t.constructor?.[Dv]||sd(t)||od(t):!1}var UC=Object.prototype.constructor.toString();function H_(t){if(!t||typeof t!="object")return!1;const e=_s(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===UC}function Qc(t,e){ad(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function ad(t){const e=t[Ar];return e?e.type_:Array.isArray(t)?1:sd(t)?2:od(t)?3:0}function Sf(t,e){return ad(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function W_(t,e,r){const n=ad(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function BC(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function sd(t){return t instanceof Map}function od(t){return t instanceof Set}function aa(t){return t.copy_||t.base_}function Pf(t,e){if(sd(t))return new Map(t);if(od(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=H_(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ar];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(_s(t),n)}else{const n=_s(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function op(t,e=!1){return ld(t)||Ta(t)||!Gn(t)||(ad(t)>1&&(t.set=t.add=t.clear=t.delete=HC),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>op(n,!0))),t}function HC(){Gr(2)}function ld(t){return Object.isFrozen(t)}var WC={};function Aa(t){const e=WC[t];return e||Gr(0,t),e}var Bo;function q_(){return Bo}function qC(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Mv(t,e){e&&(Aa("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function kf(t){Cf(t),t.drafts_.forEach(KC),t.drafts_=null}function Cf(t){t===Bo&&(Bo=t.parent_)}function Lv(t){return Bo=qC(Bo,t)}function KC(t){const e=t[Ar];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function $v(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ar].modified_&&(kf(e),Gr(4)),Gn(t)&&(t=Jc(e,t),e.parent_||eu(e,t)),e.patches_&&Aa("Patches").generateReplacementPatches_(r[Ar].base_,t,e.patches_,e.inversePatches_)):t=Jc(e,r,[]),kf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==B_?t:void 0}function Jc(t,e,r){if(ld(e))return e;const n=e[Ar];if(!n)return Qc(e,(i,a)=>Vv(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return eu(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),Qc(a,(o,l)=>Vv(t,n,i,o,l,r,s)),eu(t,i,!1),r&&t.patches_&&Aa("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function Vv(t,e,r,n,i,a,s){if(Ta(i)){const o=a&&e&&e.type_!==3&&!Sf(e.assigned_,n)?a.concat(n):void 0,l=Jc(t,i,o);if(W_(r,n,l),Ta(l))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Gn(i)&&!ld(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;Jc(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&eu(t,i)}}function eu(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&op(e,r)}function GC(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:q_(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=lp;r&&(i=[n],a=Ho);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var lp={get(t,e){if(e===Ar)return t;const r=aa(t);if(!Sf(r,e))return YC(t,r,e);const n=r[e];return t.finalized_||!Gn(n)?n:n===$h(t.base_,e)?(Vh(t),t.copy_[e]=jf(n,t)):n},has(t,e){return e in aa(t)},ownKeys(t){return Reflect.ownKeys(aa(t))},set(t,e,r){const n=K_(aa(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=$h(aa(t),e),a=i?.[Ar];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(BC(r,i)&&(r!==void 0||Sf(t.base_,e)))return!0;Vh(t),Nf(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return $h(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Vh(t),Nf(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=aa(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gr(11)},getPrototypeOf(t){return _s(t.base_)},setPrototypeOf(){Gr(12)}},Ho={};Qc(lp,(t,e)=>{Ho[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ho.deleteProperty=function(t,e){return Ho.set.call(this,t,e,void 0)};Ho.set=function(t,e,r){return lp.set.call(this,t[0],e,r,t[0])};function $h(t,e){const r=t[Ar];return(r?aa(r):t)[e]}function YC(t,e,r){const n=K_(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function K_(t,e){if(!(e in t))return;let r=_s(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=_s(r)}}function Nf(t){t.modified_||(t.modified_=!0,t.parent_&&Nf(t.parent_))}function Vh(t){t.copy_||(t.copy_=Pf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var ZC=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(l=a,...c){return s.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Gr(6),n!==void 0&&typeof n!="function"&&Gr(7);let i;if(Gn(e)){const a=Lv(this),s=jf(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?kf(a):Cf(a)}return Mv(a,n),$v(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===B_&&(i=void 0),this.autoFreeze_&&op(i,!0),n){const a=[],s=[];Aa("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Gr(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,l=>e(l,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Gn(t)||Gr(8),Ta(t)&&(t=Bn(t));const e=Lv(this),r=jf(t,void 0);return r[Ar].isManual_=!0,Cf(e),r}finishDraft(t,e){const r=t&&t[Ar];(!r||!r.isManual_)&&Gr(9);const{scope_:n}=r;return Mv(n,e),$v(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Aa("Patches").applyPatches_;return Ta(t)?n(t,e):this.produce(t,i=>n(i,e))}};function jf(t,e){const r=sd(t)?Aa("MapSet").proxyMap_(t,e):od(t)?Aa("MapSet").proxySet_(t,e):GC(t,e);return(e?e.scope_:q_()).drafts_.push(r),r}function Bn(t){return Ta(t)||Gr(10,t),G_(t)}function G_(t){if(!Gn(t)||ld(t))return t;const e=t[Ar];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Pf(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Pf(t,!0);return Qc(r,(n,i)=>{W_(r,n,G_(i))}),e&&(e.finalized_=!1),r}var Ir=new ZC,mt=Ir.produce;Ir.produceWithPatches.bind(Ir);Ir.setAutoFreeze.bind(Ir);Ir.setUseStrictShallowCopy.bind(Ir);Ir.applyPatches.bind(Ir);Ir.createDraft.bind(Ir);Ir.finishDraft.bind(Ir);const XC=()=>{};var Fv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},QC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],l=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},Z_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|c>>6,p=c&63;l||(p=64,s||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Y_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):QC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const c=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||c==null||h==null)throw new JC;const m=a<<2|o>>4;if(n.push(m),c!==64){const p=o<<4&240|c>>2;if(n.push(p),h!==64){const y=c<<6&192|h;n.push(y)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class JC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const eN=function(t){const e=Y_(t);return Z_.encodeByteArray(e,!0)},tu=function(t){return eN(t).replace(/\./g,"")},X_=function(t){try{return Z_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rN=()=>tN().__FIREBASE_DEFAULTS__,nN=()=>{if(typeof process>"u"||typeof Fv>"u")return;const t=Fv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},iN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&X_(t[1]);return e&&JSON.parse(e)},cd=()=>{try{return XC()||rN()||nN()||iN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Q_=t=>cd()?.emulatorHosts?.[t],J_=t=>{const e=Q_(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},eE=()=>cd()?.config,tE=t=>cd()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cp(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[tu(JSON.stringify(r)),tu(JSON.stringify(s)),""].join(".")}const No={};function sN(){const t={prod:[],emulator:[]};for(const e of Object.keys(No))No[e]?t.emulator.push(e):t.prod.push(e);return t}function oN(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let zv=!1;function up(t,e){if(typeof window>"u"||typeof document>"u"||!La(window.location.host)||No[t]===e||No[t]||zv)return;No[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=sN().prod.length>0;function s(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function c(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{zv=!0,s()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=oN(n),p=r("text"),y=document.getElementById(p)||document.createElement("span"),b=r("learnmore"),g=document.getElementById(b)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;o(E),u(g,b);const O=c();l(T,_),E.append(T,y,g,O),document.body.appendChild(E)}a?(y.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function cN(){const t=cd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fN(){const t=tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mN(){return!cN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pN(){try{return typeof indexedDB=="object"}catch{return!1}}function gN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN="FirebaseError";class Pn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=yN,Object.setPrototypeOf(this,Pn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gl.prototype.create)}}class gl{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?vN(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Pn(i,o,n)}}function vN(t,e){return t.replace(bN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const bN=/\{\$([^}]+)}/g;function xN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ia(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(Uv(a)&&Uv(s)){if(!Ia(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function Uv(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yl(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function _o(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Eo(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function wN(t,e){const r=new _N(t,e);return r.subscribe.bind(r)}class _N{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");EN(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Fh),i.error===void 0&&(i.error=Fh),i.complete===void 0&&(i.complete=Fh);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function EN(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Fh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class Oi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TN=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new aN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(IN(e))try{this.getOrInitializeService({instanceIdentifier:sa})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=sa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sa){return this.instances.has(e)}getOptions(e=sa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:AN(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=sa){return this.component?this.component.multipleInstances?e:sa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function AN(t){return t===sa?void 0:t}function IN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new TN(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const PN={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},kN=xe.INFO,CN={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},NN=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=CN[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dp{constructor(e){this.name=e,this._logLevel=kN,this._logHandler=NN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const jN=(t,e)=>e.some(r=>t instanceof r);let Bv,Hv;function ON(){return Bv||(Bv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RN(){return Hv||(Hv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const nE=new WeakMap,Of=new WeakMap,iE=new WeakMap,zh=new WeakMap,hp=new WeakMap;function DN(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Si(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&nE.set(r,t)}).catch(()=>{}),hp.set(e,t),e}function MN(t){if(Of.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});Of.set(t,e)}let Rf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Of.get(t);if(e==="objectStoreNames")return t.objectStoreNames||iE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Si(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LN(t){Rf=t(Rf)}function $N(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Uh(this),e,...r);return iE.set(n,e.sort?e.sort():[e]),Si(n)}:RN().includes(t)?function(...e){return t.apply(Uh(this),e),Si(nE.get(this))}:function(...e){return Si(t.apply(Uh(this),e))}}function VN(t){return typeof t=="function"?$N(t):(t instanceof IDBTransaction&&MN(t),jN(t,ON())?new Proxy(t,Rf):t)}function Si(t){if(t instanceof IDBRequest)return DN(t);if(zh.has(t))return zh.get(t);const e=VN(t);return e!==t&&(zh.set(t,e),hp.set(e,t)),e}const Uh=t=>hp.get(t);function FN(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Si(s);return n&&s.addEventListener("upgradeneeded",l=>{n(Si(s.result),l.oldVersion,l.newVersion,Si(s.transaction),l)}),r&&s.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{a&&l.addEventListener("close",()=>a()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const zN=["get","getKey","getAll","getAllKeys","count"],UN=["put","add","delete","clear"],Bh=new Map;function Wv(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bh.get(e))return Bh.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=UN.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||zN.includes(r)))return;const a=async function(s,...o){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),i&&l.done]))[0]};return Bh.set(e,a),a}LN(t=>({...t,get:(e,r,n)=>Wv(e,r)||t.get(e,r,n),has:(e,r)=>!!Wv(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(HN(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function HN(t){return t.getComponent()?.type==="VERSION"}const Df="@firebase/app",qv="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new dp("@firebase/app"),WN="@firebase/app-compat",qN="@firebase/analytics-compat",KN="@firebase/analytics",GN="@firebase/app-check-compat",YN="@firebase/app-check",ZN="@firebase/auth",XN="@firebase/auth-compat",QN="@firebase/database",JN="@firebase/data-connect",ej="@firebase/database-compat",tj="@firebase/functions",rj="@firebase/functions-compat",nj="@firebase/installations",ij="@firebase/installations-compat",aj="@firebase/messaging",sj="@firebase/messaging-compat",oj="@firebase/performance",lj="@firebase/performance-compat",cj="@firebase/remote-config",uj="@firebase/remote-config-compat",dj="@firebase/storage",hj="@firebase/storage-compat",fj="@firebase/firestore",mj="@firebase/ai",pj="@firebase/firestore-compat",gj="firebase",yj="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="[DEFAULT]",vj={[Df]:"fire-core",[WN]:"fire-core-compat",[KN]:"fire-analytics",[qN]:"fire-analytics-compat",[YN]:"fire-app-check",[GN]:"fire-app-check-compat",[ZN]:"fire-auth",[XN]:"fire-auth-compat",[QN]:"fire-rtdb",[JN]:"fire-data-connect",[ej]:"fire-rtdb-compat",[tj]:"fire-fn",[rj]:"fire-fn-compat",[nj]:"fire-iid",[ij]:"fire-iid-compat",[aj]:"fire-fcm",[sj]:"fire-fcm-compat",[oj]:"fire-perf",[lj]:"fire-perf-compat",[cj]:"fire-rc",[uj]:"fire-rc-compat",[dj]:"fire-gcs",[hj]:"fire-gcs-compat",[fj]:"fire-fst",[pj]:"fire-fst-compat",[mj]:"fire-vertex","fire-js":"fire-js",[gj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru=new Map,bj=new Map,Lf=new Map;function Kv(t,e){try{t.container.addComponent(e)}catch(r){Yn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Sa(t){const e=t.name;if(Lf.has(e))return Yn.debug(`There were multiple attempts to register component ${e}.`),!1;Lf.set(e,t);for(const r of ru.values())Kv(r,t);for(const r of bj.values())Kv(r,t);return!0}function ud(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function wr(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pi=new gl("app","Firebase",xj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Oi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=yj;function aE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Mf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Pi.create("bad-app-name",{appName:String(i)});if(r||(r=eE()),!r)throw Pi.create("no-options");const a=ru.get(i);if(a){if(Ia(r,a.options)&&Ia(n,a.config))return a;throw Pi.create("duplicate-app",{appName:i})}const s=new SN(i);for(const l of Lf.values())s.addComponent(l);const o=new wj(r,n,s);return ru.set(i,o),o}function fp(t=Mf){const e=ru.get(t);if(!e&&t===Mf&&eE())return aE();if(!e)throw Pi.create("no-app",{appName:t});return e}function fn(t,e,r){let n=vj[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Yn.warn(s.join(" "));return}Sa(new Oi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j="firebase-heartbeat-database",Ej=1,Wo="firebase-heartbeat-store";let Hh=null;function sE(){return Hh||(Hh=FN(_j,Ej,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Pi.create("idb-open",{originalErrorMessage:t.message})})),Hh}async function Tj(t){try{const r=(await sE()).transaction(Wo),n=await r.objectStore(Wo).get(oE(t));return await r.done,n}catch(e){if(e instanceof Pn)Yn.warn(e.message);else{const r=Pi.create("idb-get",{originalErrorMessage:e?.message});Yn.warn(r.message)}}}async function Gv(t,e){try{const n=(await sE()).transaction(Wo,"readwrite");await n.objectStore(Wo).put(e,oE(t)),await n.done}catch(r){if(r instanceof Pn)Yn.warn(r.message);else{const n=Pi.create("idb-set",{originalErrorMessage:r?.message});Yn.warn(n.message)}}}function oE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=1024,Ij=30;class Sj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new kj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Yv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>Ij){const i=Cj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Yn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yv(),{heartbeatsToSend:r,unsentEntries:n}=Pj(this._heartbeatsCache.heartbeats),i=tu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Yn.warn(e),""}}}function Yv(){return new Date().toISOString().substring(0,10)}function Pj(t,e=Aj){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),Zv(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Zv(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class kj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pN()?gN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Tj(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Gv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Gv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Zv(t){return tu(JSON.stringify({version:2,heartbeats:t})).length}function Cj(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nj(t){Sa(new Oi("platform-logger",e=>new BN(e),"PRIVATE")),Sa(new Oi("heartbeat",e=>new Sj(e),"PRIVATE")),fn(Df,qv,t),fn(Df,qv,"esm2020"),fn("fire-js","")}Nj("");var jj="firebase",Oj="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fn(jj,Oj,"app");function lE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Rj=lE,cE=new gl("auth","Firebase",lE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nu=new dp("@firebase/auth");function Dj(t,...e){nu.logLevel<=xe.WARN&&nu.warn(`Auth (${$a}): ${t}`,...e)}function Mc(t,...e){nu.logLevel<=xe.ERROR&&nu.error(`Auth (${$a}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,...e){throw mp(t,...e)}function mn(t,...e){return mp(t,...e)}function uE(t,e,r){const n={...Rj(),[e]:r};return new gl("auth","Firebase",n).create(e,{appName:t.name})}function Hn(t){return uE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mp(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return cE.create(t,...e)}function ce(t,e,...r){if(!t)throw mp(e,...r)}function $n(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Mc(e),new Error(e)}function Zn(t,e){t||$n(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(){return typeof self<"u"&&self.location?.href||""}function Mj(){return Xv()==="http:"||Xv()==="https:"}function Xv(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Mj()||dN()||"connection"in navigator)?navigator.onLine:!0}function $j(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,r){this.shortDelay=e,this.longDelay=r,Zn(r>e,"Short delay should be less than long delay!"),this.isMobile=lN()||hN()}get(){return Lj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t,e){Zn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],zj=new vl(3e4,6e4);function Bi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Hi(t,e,r,n,i={}){return hE(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=yl({key:t.config.apiKey,...s}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c={method:e,headers:l,...a};return uN()||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&La(t.emulatorConfig.host)&&(c.credentials="include"),dE.fetch()(await fE(t,t.config.apiHost,r,o),c)})}async function hE(t,e,r){t._canInitEmulator=!1;const n={...Vj,...e};try{const i=new Bj(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw lc(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw lc(t,"credential-already-in-use",s);if(l==="EMAIL_EXISTS")throw lc(t,"email-already-in-use",s);if(l==="USER_DISABLED")throw lc(t,"user-disabled",s);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw uE(t,u,c);en(t,u)}}catch(i){if(i instanceof Pn)throw i;en(t,"network-request-failed",{message:String(i)})}}async function bl(t,e,r,n,i={}){const a=await Hi(t,e,r,n,i);return"mfaPendingCredential"in a&&en(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function fE(t,e,r,n){const i=`${e}${r}?${n}`,a=t,s=a.config.emulator?pp(t.config,i):`${t.config.apiScheme}://${i}`;return Fj.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function Uj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(mn(this.auth,"network-request-failed")),zj.get())})}}function lc(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=mn(t,e,n);return i.customData._tokenResponse=r,i}function Qv(t){return t!==void 0&&t.enterprise!==void 0}class Hj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Uj(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Wj(t,e){return Hi(t,"GET","/v2/recaptchaConfig",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qj(t,e){return Hi(t,"POST","/v1/accounts:delete",e)}async function iu(t,e){return Hi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Kj(t,e=!1){const r=dr(t),n=await r.getIdToken(e),i=gp(n);ce(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:n,authTime:jo(Wh(i.auth_time)),issuedAtTime:jo(Wh(i.iat)),expirationTime:jo(Wh(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Wh(t){return Number(t)*1e3}function gp(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Mc("JWT malformed, contained fewer than 3 sections"),null;try{const i=X_(r);return i?JSON.parse(i):(Mc("Failed to decode base64 JWT payload"),null)}catch(i){return Mc("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Jv(t){const e=gp(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Pn&&Gj(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Gj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=jo(this.lastLoginAt),this.creationTime=jo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function au(t){const e=t.auth,r=await t.getIdToken(),n=await qo(t,iu(e,{idToken:r}));ce(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?mE(i.providerUserInfo):[],s=Xj(t.providerData,a),o=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!s?.length,c=o?l:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Vf(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,u)}async function Zj(t){const e=dr(t);await au(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Xj(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function mE(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(t,e){const r=await hE(t,{},async()=>{const n=yl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=await fE(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:n};return t.emulatorConfig&&La(t.emulatorConfig.host)&&(l.credentials="include"),dE.fetch()(s,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Jj(t,e){return Hi(t,"POST","/v2/accounts:revokeToken",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const r=Jv(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await Qj(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new ms;return n&&(ce(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(ce(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(ce(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ms,this.toJSON())}_performRefresh(){return $n("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new Yj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Vf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await qo(this,this.stsTokenManager.getToken(this.auth,e));return ce(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Kj(this,e)}reload(){return Zj(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await au(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wr(this.auth.app))return Promise.reject(Hn(this.auth));const e=await this.getIdToken();return await qo(this,qj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,s=r.photoURL??void 0,o=r.tenantId??void 0,l=r._redirectEventId??void 0,c=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:y,stsTokenManager:b}=r;ce(h&&b,e,"internal-error");const g=ms.fromJSON(this.name,b);ce(typeof h=="string",e,"internal-error"),hi(n,e.name),hi(i,e.name),ce(typeof m=="boolean",e,"internal-error"),ce(typeof p=="boolean",e,"internal-error"),hi(a,e.name),hi(s,e.name),hi(o,e.name),hi(l,e.name),hi(c,e.name),hi(u,e.name);const _=new Zr({uid:h,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:a,tenantId:o,stsTokenManager:g,createdAt:c,lastLoginAt:u});return y&&Array.isArray(y)&&(_.providerData=y.map(T=>({...T}))),l&&(_._redirectEventId=l),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new ms;i.updateFromServerResponse(r);const a=new Zr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await au(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];ce(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?mE(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,o=new ms;o.updateFromIdToken(n);const l=new Zr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Vf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0=new Map;function Vn(t){Zn(t instanceof Function,"Expected a class definition");let e=e0.get(t);return e?(Zn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,e0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}pE.type="NONE";const t0=pE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(t,e,r){return`firebase:${t}:${e}:${r}`}class ps{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Lc(this.userKey,i.apiKey,a),this.fullPersistenceKey=Lc("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await iu(this.auth,{idToken:e}).catch(()=>{});return r?Zr._fromGetAccountInfoResponse(this.auth,r,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ps(Vn(t0),e,n);const i=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let a=i[0]||Vn(t0);const s=Lc(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(s);if(u){let h;if(typeof u=="string"){const m=await iu(e,{idToken:u}).catch(()=>{});if(!m)break;h=await Zr._fromGetAccountInfoResponse(e,m,u)}else h=Zr._fromJSON(e,u);c!==a&&(o=h),a=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!a._shouldAllowMigration||!l.length?new ps(a,e,n):(a=l[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==a)try{await c._remove(s)}catch{}})),new ps(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(wE(e))return"Blackberry";if(_E(e))return"Webos";if(yE(e))return"Safari";if((e.includes("chrome/")||vE(e))&&!e.includes("edge/"))return"Chrome";if(xE(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function gE(t=tr()){return/firefox\//i.test(t)}function yE(t=tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function vE(t=tr()){return/crios\//i.test(t)}function bE(t=tr()){return/iemobile/i.test(t)}function xE(t=tr()){return/android/i.test(t)}function wE(t=tr()){return/blackberry/i.test(t)}function _E(t=tr()){return/webos/i.test(t)}function yp(t=tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function eO(t=tr()){return yp(t)&&!!window.navigator?.standalone}function tO(){return fN()&&document.documentMode===10}function EE(t=tr()){return yp(t)||xE(t)||_E(t)||wE(t)||/windows phone/i.test(t)||bE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t,e=[]){let r;switch(t){case"Browser":r=r0(tr());break;case"Worker":r=`${r0(tr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${$a}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const l=e(a);s(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nO(t,e={}){return Hi(t,"GET","/v2/passwordPolicy",Bi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO=6;class aO{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??iO,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new n0(this),this.idTokenSubscription=new n0(this),this.beforeStateQueue=new rO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Vn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await ps.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await iu(this,{idToken:e}),n=await Zr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(wr(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===s)&&o?.user&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await au(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$j()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wr(this.app))return Promise.reject(Hn(this));const r=e?dr(e):null;return r&&ce(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wr(this.app)?Promise.reject(Hn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wr(this.app)?Promise.reject(Hn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await nO(this),r=new aO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new gl("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await Jj(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Vn(e)||this._popupRedirectResolver;ce(r,this,"argument-error"),this.redirectPersistenceManager=await ps.create(this,[Vn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,i);return()=>{s=!0,l()}}else{const l=e.addObserver(r);return()=>{s=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=TE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Dj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Va(t){return dr(t)}class n0{constructor(e){this.auth=e,this.observer=null,this.addObserver=wN(r=>this.observer=r)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oO(t){dd=t}function AE(t){return dd.loadJS(t)}function lO(){return dd.recaptchaEnterpriseScript}function cO(){return dd.gapiScript}function uO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class dO{constructor(){this.enterprise=new hO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class hO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const fO="recaptcha-enterprise",IE="NO_RECAPTCHA";class mO{constructor(e){this.type=fO,this.auth=Va(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{Wj(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new Hj(l);return a.tenantId==null?a._agentRecaptchaConfig=c:a._tenantRecaptchaConfigs[a.tenantId]=c,s(c.siteKey)}}).catch(l=>{o(l)})})}function i(a,s,o){const l=window.grecaptcha;Qv(l)?l.enterprise.ready(()=>{l.enterprise.execute(a,{action:e}).then(c=>{s(c)}).catch(()=>{s(IE)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dO().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&Qv(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let l=lO();l.length!==0&&(l+=o),AE(l).then(()=>{i(o,a,s)}).catch(c=>{s(c)})}}).catch(o=>{s(o)})})}}async function i0(t,e,r,n=!1,i=!1){const a=new mO(t);let s;if(i)s=IE;else try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const l=o.phoneEnrollmentInfo.phoneNumber,c=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const l=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ff(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await i0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await i0(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(t,e){const r=ud(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Ia(a,e??{}))return i;en(i,"already-initialized")}return r.initialize({options:e})}function gO(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Vn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function yO(t,e,r){const n=Va(t);ce(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=SE(e),{host:s,port:o}=vO(e),l=o===null?"":`:${o}`,c={url:`${a}//${s}${l}/`},u=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ce(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ce(Ia(c,n.config.emulator)&&Ia(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,La(s)?(cp(`${a}//${s}${l}`),up("Auth",!0)):bO()}function SE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vO(t){const e=SE(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:a0(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:a0(s)}}}function a0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function bO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return $n("not implemented")}_getIdTokenResponse(e){return $n("not implemented")}_linkToIdToken(e,r){return $n("not implemented")}_getReauthenticationResolver(e){return $n("not implemented")}}async function xO(t,e){return Hi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(t,e){return bl(t,"POST","/v1/accounts:signInWithPassword",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e){return bl(t,"POST","/v1/accounts:signInWithEmailLink",Bi(t,e))}async function EO(t,e){return bl(t,"POST","/v1/accounts:signInWithEmailLink",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko extends vp{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Ko(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Ko(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ff(e,r,"signInWithPassword",wO);case"emailLink":return _O(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ff(e,n,"signUpPassword",xO);case"emailLink":return EO(e,{idToken:r,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gs(t,e){return bl(t,"POST","/v1/accounts:signInWithIdp",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO="http://localhost";class Pa extends vp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):en("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const s=new Pa(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return gs(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,gs(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,gs(e,r)}buildRequest(){const e={requestUri:TO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=yl(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function IO(t){const e=_o(Eo(t)).link,r=e?_o(Eo(e)).deep_link_id:null,n=_o(Eo(t)).deep_link_id;return(n?_o(Eo(n)).link:null)||n||r||e||t}class bp{constructor(e){const r=_o(Eo(e)),n=r.apiKey??null,i=r.oobCode??null,a=AO(r.mode??null);ce(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=IO(e);try{return new bp(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(){this.providerId=Ms.PROVIDER_ID}static credential(e,r){return Ko._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=bp.parseLink(r);return ce(n,"argument-error"),Ko._fromEmailAndCode(e,n.code,n.tenantId)}}Ms.PROVIDER_ID="password";Ms.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ms.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl extends PE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends xl{constructor(){super("facebook.com")}static credential(e){return Pa._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bi.credential(e.oauthAccessToken)}catch{return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends xl{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Pa._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xi.credential(r,n)}catch{return null}}}xi.GOOGLE_SIGN_IN_METHOD="google.com";xi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends xl{constructor(){super("github.com")}static credential(e){return Pa._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wi.credential(e.oauthAccessToken)}catch{return null}}}wi.GITHUB_SIGN_IN_METHOD="github.com";wi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends xl{constructor(){super("twitter.com")}static credential(e,r){return Pa._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return _i.credential(r,n)}catch{return null}}}_i.TWITTER_SIGN_IN_METHOD="twitter.com";_i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SO(t,e){return bl(t,"POST","/v1/accounts:signUp",Bi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Zr._fromIdTokenResponse(e,n,i),s=s0(n);return new ka({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=s0(n);return new ka({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function s0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su extends Pn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,su.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new su(e,r,n,i)}}function kE(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?su._fromErrorAndOperation(t,a,e,n):a})}async function PO(t,e,r=!1){const n=await qo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ka._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e,r=!1){const{auth:n}=t;if(wr(n.app))return Promise.reject(Hn(n));const i="reauthenticate";try{const a=await qo(t,kE(n,i,e,t),r);ce(a.idToken,n,"internal-error");const s=gp(a.idToken);ce(s,n,"internal-error");const{sub:o}=s;return ce(t.uid===o,n,"user-mismatch"),ka._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&en(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CE(t,e,r=!1){if(wr(t.app))return Promise.reject(Hn(t));const n="signIn",i=await kE(t,n,e),a=await ka._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function CO(t,e){return CE(Va(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NE(t){const e=Va(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function NO(t,e,r){if(wr(t.app))return Promise.reject(Hn(t));const n=Va(t),s=await Ff(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",SO).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&NE(t),l}),o=await ka._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function jO(t,e,r){return wr(t.app)?Promise.reject(Hn(t)):CO(dr(t),Ms.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&NE(t),n})}function OO(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function RO(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function DO(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function MO(t){return dr(t).signOut()}const ou="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ou,"1"),this.storage.removeItem(ou),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=1e3,$O=10;class OE extends jE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=EE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,l)=>{this.notifyListeners(s,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);tO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$O):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},LO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}OE.type="LOCAL";const VO=OE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE extends jE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}RE.type="SESSION";const DE=RE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new hd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async c=>c(r.origin,a)),l=await FO(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,l)=>{const c=xp("",20);i.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),l(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return window}function UO(t){pn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(){return typeof pn().WorkerGlobalScope<"u"&&typeof pn().importScripts=="function"}async function BO(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HO(){return navigator?.serviceWorker?.controller||null}function WO(){return ME()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="firebaseLocalStorageDb",qO=1,lu="firebaseLocalStorage",$E="fbase_key";class wl{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function fd(t,e){return t.transaction([lu],e?"readwrite":"readonly").objectStore(lu)}function KO(){const t=indexedDB.deleteDatabase(LE);return new wl(t).toPromise()}function zf(){const t=indexedDB.open(LE,qO);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(lu,{keyPath:$E})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(lu)?e(n):(n.close(),await KO(),e(await zf()))})})}async function o0(t,e,r){const n=fd(t,!0).put({[$E]:e,value:r});return new wl(n).toPromise()}async function GO(t,e){const r=fd(t,!1).get(e),n=await new wl(r).toPromise();return n===void 0?null:n.value}function l0(t,e){const r=fd(t,!0).delete(e);return new wl(r).toPromise()}const YO=800,ZO=3;class VE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zf(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>ZO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ME()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hd._getInstance(WO()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await BO(),!this.activeServiceWorker)return;this.sender=new zO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zf();return await o0(e,ou,"1"),await l0(e,ou),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>o0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>GO(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>l0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=fd(i,!1).getAll();return new wl(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}VE.type="LOCAL";const XO=VE;new vl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QO(t,e){return e?Vn(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends vp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gs(e,this._buildIdpRequest())}_linkToIdToken(e,r){return gs(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return gs(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function JO(t){return CE(t.auth,new wp(t),t.bypassAuthState)}function e2(t){const{auth:e,user:r}=t;return ce(r,e,"internal-error"),kO(r,new wp(t),t.bypassAuthState)}async function t2(t){const{auth:e,user:r}=t;return ce(r,e,"internal-error"),PO(r,new wp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FE{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JO;case"linkViaPopup":case"linkViaRedirect":return t2;case"reauthViaPopup":case"reauthViaRedirect":return e2;default:en(this.auth,"internal-error")}}resolve(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r2=new vl(2e3,1e4);class us extends FE{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,us.currentPopupAction&&us.currentPopupAction.cancel(),us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){Zn(this.filter.length===1,"Popup operations only handle one event");const e=xp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(mn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,us.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,r2.get())};e()}}us.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2="pendingRedirect",$c=new Map;class i2 extends FE{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=$c.get(this.auth._key());if(!e){try{const n=await a2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}$c.set(this.auth._key(),e)}return this.bypassAuthState||$c.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function a2(t,e){const r=l2(e),n=o2(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function s2(t,e){$c.set(t._key(),e)}function o2(t){return Vn(t._redirectPersistence)}function l2(t){return Lc(n2,t.config.apiKey,t.name)}async function c2(t,e,r=!1){if(wr(t.app))return Promise.reject(Hn(t));const n=Va(t),i=QO(n,e),s=await new i2(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=10*60*1e3;class d2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h2(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!zE(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(mn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=u2&&this.cachedEventUids.clear(),this.cachedEventUids.has(c0(e))}saveEventToCache(e){this.cachedEventUids.add(c0(e)),this.lastProcessedEventTime=Date.now()}}function c0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zE({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function h2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f2(t,e={}){return Hi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p2=/^https?/;async function g2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await f2(t);for(const r of e)try{if(y2(r))return}catch{}en(t,"unauthorized-domain")}function y2(t){const e=$f(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!p2.test(r))return!1;if(m2.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v2=new vl(3e4,6e4);function u0(){const t=pn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function b2(t){return new Promise((e,r)=>{function n(){u0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{u0(),r(mn(t,"network-request-failed"))},timeout:v2.get()})}if(pn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pn().gapi?.load)n();else{const i=uO("iframefcb");return pn()[i]=()=>{gapi.load?n():r(mn(t,"network-request-failed"))},AE(`${cO()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw Vc=null,e})}let Vc=null;function x2(t){return Vc=Vc||b2(t),Vc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2=new vl(5e3,15e3),_2="__/auth/iframe",E2="emulator/auth/iframe",T2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},A2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function I2(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?pp(e,E2):`https://${t.config.authDomain}/${_2}`,n={apiKey:e.apiKey,appName:t.name,v:$a},i=A2.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${yl(n).slice(1)}`}async function S2(t){const e=await x2(t),r=pn().gapi;return ce(r,t,"internal-error"),e.open({where:document.body,url:I2(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:T2,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=mn(t,"network-request-failed"),o=pn().setTimeout(()=>{a(s)},w2.get());function l(){pn().clearTimeout(o),i(n)}n.ping(l).then(l,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},k2=500,C2=600,N2="_blank",j2="http://localhost";class d0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function O2(t,e,r,n=k2,i=C2){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l={...P2,width:n.toString(),height:i.toString(),top:a,left:s},c=tr().toLowerCase();r&&(o=vE(c)?N2:r),gE(c)&&(e=e||j2,l.scrollbars="yes");const u=Object.entries(l).reduce((m,[p,y])=>`${m}${p}=${y},`,"");if(eO(c)&&o!=="_self")return R2(e||"",o),new d0(null);const h=window.open(e||"",o,u);ce(h,t,"popup-blocked");try{h.focus()}catch{}return new d0(h)}function R2(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2="__/auth/handler",M2="emulator/auth/handler",L2=encodeURIComponent("fac");async function h0(t,e,r,n,i,a){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:$a,eventId:i};if(e instanceof PE){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",xN(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof xl){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${L2}=${encodeURIComponent(l)}`:"";return`${$2(t)}?${yl(o).slice(1)}${c}`}function $2({config:t}){return t.emulator?pp(t,M2):`https://${t.authDomain}/${D2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh="webStorageSupport";class V2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=DE,this._completeRedirectFn=c2,this._overrideRedirectResult=s2}async _openPopup(e,r,n,i){Zn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await h0(e,r,n,$f(),i);return O2(e,a,xp())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await h0(e,r,n,$f(),i);return UO(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Zn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await S2(e),n=new d2(e);return r.register("authEvent",i=>(ce(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(qh,{type:qh},i=>{const a=i?.[0]?.[qh];a!==void 0&&r(!!a),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=g2(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return EE()||yE()||yp()}}const F2=V2;var f0="@firebase/auth",m0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B2(t){Sa(new Oi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;ce(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:TE(t)},c=new sO(n,i,a,l);return gO(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Sa(new Oi("auth-internal",e=>{const r=Va(e.getProvider("auth").getImmediate());return(n=>new z2(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),fn(f0,m0,U2(t)),fn(f0,m0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=5*60,W2=tE("authIdTokenMaxAge")||H2;let p0=null;const q2=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>W2)return;const i=r?.token;p0!==i&&(p0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function K2(t=fp()){const e=ud(t,"auth");if(e.isInitialized())return e.getImmediate();const r=pO(t,{popupRedirectResolver:F2,persistence:[XO,VO,DE]}),n=tE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=q2(a.toString());RO(r,s,()=>s(r.currentUser)),OO(r,o=>s(o))}}const i=Q_("auth");return i&&yO(r,`http://${i}`),r}function G2(){return document.getElementsByTagName("head")?.[0]??document}oO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=mn("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",G2().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B2("Browser");var g0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ki,UE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function P(){}P.prototype=A.prototype,I.D=A.prototype,I.prototype=new P,I.prototype.constructor=I,I.C=function(j,N,k){for(var C=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)C[Q-2]=arguments[Q];return A.prototype[N].apply(j,C)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,A,P){P||(P=0);var j=Array(16);if(typeof A=="string")for(var N=0;16>N;++N)j[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;16>N;++N)j[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=I.g[0],P=I.g[1],N=I.g[2];var k=I.g[3],C=A+(k^P&(N^k))+j[0]+3614090360&4294967295;A=P+(C<<7&4294967295|C>>>25),C=k+(N^A&(P^N))+j[1]+3905402710&4294967295,k=A+(C<<12&4294967295|C>>>20),C=N+(P^k&(A^P))+j[2]+606105819&4294967295,N=k+(C<<17&4294967295|C>>>15),C=P+(A^N&(k^A))+j[3]+3250441966&4294967295,P=N+(C<<22&4294967295|C>>>10),C=A+(k^P&(N^k))+j[4]+4118548399&4294967295,A=P+(C<<7&4294967295|C>>>25),C=k+(N^A&(P^N))+j[5]+1200080426&4294967295,k=A+(C<<12&4294967295|C>>>20),C=N+(P^k&(A^P))+j[6]+2821735955&4294967295,N=k+(C<<17&4294967295|C>>>15),C=P+(A^N&(k^A))+j[7]+4249261313&4294967295,P=N+(C<<22&4294967295|C>>>10),C=A+(k^P&(N^k))+j[8]+1770035416&4294967295,A=P+(C<<7&4294967295|C>>>25),C=k+(N^A&(P^N))+j[9]+2336552879&4294967295,k=A+(C<<12&4294967295|C>>>20),C=N+(P^k&(A^P))+j[10]+4294925233&4294967295,N=k+(C<<17&4294967295|C>>>15),C=P+(A^N&(k^A))+j[11]+2304563134&4294967295,P=N+(C<<22&4294967295|C>>>10),C=A+(k^P&(N^k))+j[12]+1804603682&4294967295,A=P+(C<<7&4294967295|C>>>25),C=k+(N^A&(P^N))+j[13]+4254626195&4294967295,k=A+(C<<12&4294967295|C>>>20),C=N+(P^k&(A^P))+j[14]+2792965006&4294967295,N=k+(C<<17&4294967295|C>>>15),C=P+(A^N&(k^A))+j[15]+1236535329&4294967295,P=N+(C<<22&4294967295|C>>>10),C=A+(N^k&(P^N))+j[1]+4129170786&4294967295,A=P+(C<<5&4294967295|C>>>27),C=k+(P^N&(A^P))+j[6]+3225465664&4294967295,k=A+(C<<9&4294967295|C>>>23),C=N+(A^P&(k^A))+j[11]+643717713&4294967295,N=k+(C<<14&4294967295|C>>>18),C=P+(k^A&(N^k))+j[0]+3921069994&4294967295,P=N+(C<<20&4294967295|C>>>12),C=A+(N^k&(P^N))+j[5]+3593408605&4294967295,A=P+(C<<5&4294967295|C>>>27),C=k+(P^N&(A^P))+j[10]+38016083&4294967295,k=A+(C<<9&4294967295|C>>>23),C=N+(A^P&(k^A))+j[15]+3634488961&4294967295,N=k+(C<<14&4294967295|C>>>18),C=P+(k^A&(N^k))+j[4]+3889429448&4294967295,P=N+(C<<20&4294967295|C>>>12),C=A+(N^k&(P^N))+j[9]+568446438&4294967295,A=P+(C<<5&4294967295|C>>>27),C=k+(P^N&(A^P))+j[14]+3275163606&4294967295,k=A+(C<<9&4294967295|C>>>23),C=N+(A^P&(k^A))+j[3]+4107603335&4294967295,N=k+(C<<14&4294967295|C>>>18),C=P+(k^A&(N^k))+j[8]+1163531501&4294967295,P=N+(C<<20&4294967295|C>>>12),C=A+(N^k&(P^N))+j[13]+2850285829&4294967295,A=P+(C<<5&4294967295|C>>>27),C=k+(P^N&(A^P))+j[2]+4243563512&4294967295,k=A+(C<<9&4294967295|C>>>23),C=N+(A^P&(k^A))+j[7]+1735328473&4294967295,N=k+(C<<14&4294967295|C>>>18),C=P+(k^A&(N^k))+j[12]+2368359562&4294967295,P=N+(C<<20&4294967295|C>>>12),C=A+(P^N^k)+j[5]+4294588738&4294967295,A=P+(C<<4&4294967295|C>>>28),C=k+(A^P^N)+j[8]+2272392833&4294967295,k=A+(C<<11&4294967295|C>>>21),C=N+(k^A^P)+j[11]+1839030562&4294967295,N=k+(C<<16&4294967295|C>>>16),C=P+(N^k^A)+j[14]+4259657740&4294967295,P=N+(C<<23&4294967295|C>>>9),C=A+(P^N^k)+j[1]+2763975236&4294967295,A=P+(C<<4&4294967295|C>>>28),C=k+(A^P^N)+j[4]+1272893353&4294967295,k=A+(C<<11&4294967295|C>>>21),C=N+(k^A^P)+j[7]+4139469664&4294967295,N=k+(C<<16&4294967295|C>>>16),C=P+(N^k^A)+j[10]+3200236656&4294967295,P=N+(C<<23&4294967295|C>>>9),C=A+(P^N^k)+j[13]+681279174&4294967295,A=P+(C<<4&4294967295|C>>>28),C=k+(A^P^N)+j[0]+3936430074&4294967295,k=A+(C<<11&4294967295|C>>>21),C=N+(k^A^P)+j[3]+3572445317&4294967295,N=k+(C<<16&4294967295|C>>>16),C=P+(N^k^A)+j[6]+76029189&4294967295,P=N+(C<<23&4294967295|C>>>9),C=A+(P^N^k)+j[9]+3654602809&4294967295,A=P+(C<<4&4294967295|C>>>28),C=k+(A^P^N)+j[12]+3873151461&4294967295,k=A+(C<<11&4294967295|C>>>21),C=N+(k^A^P)+j[15]+530742520&4294967295,N=k+(C<<16&4294967295|C>>>16),C=P+(N^k^A)+j[2]+3299628645&4294967295,P=N+(C<<23&4294967295|C>>>9),C=A+(N^(P|~k))+j[0]+4096336452&4294967295,A=P+(C<<6&4294967295|C>>>26),C=k+(P^(A|~N))+j[7]+1126891415&4294967295,k=A+(C<<10&4294967295|C>>>22),C=N+(A^(k|~P))+j[14]+2878612391&4294967295,N=k+(C<<15&4294967295|C>>>17),C=P+(k^(N|~A))+j[5]+4237533241&4294967295,P=N+(C<<21&4294967295|C>>>11),C=A+(N^(P|~k))+j[12]+1700485571&4294967295,A=P+(C<<6&4294967295|C>>>26),C=k+(P^(A|~N))+j[3]+2399980690&4294967295,k=A+(C<<10&4294967295|C>>>22),C=N+(A^(k|~P))+j[10]+4293915773&4294967295,N=k+(C<<15&4294967295|C>>>17),C=P+(k^(N|~A))+j[1]+2240044497&4294967295,P=N+(C<<21&4294967295|C>>>11),C=A+(N^(P|~k))+j[8]+1873313359&4294967295,A=P+(C<<6&4294967295|C>>>26),C=k+(P^(A|~N))+j[15]+4264355552&4294967295,k=A+(C<<10&4294967295|C>>>22),C=N+(A^(k|~P))+j[6]+2734768916&4294967295,N=k+(C<<15&4294967295|C>>>17),C=P+(k^(N|~A))+j[13]+1309151649&4294967295,P=N+(C<<21&4294967295|C>>>11),C=A+(N^(P|~k))+j[4]+4149444226&4294967295,A=P+(C<<6&4294967295|C>>>26),C=k+(P^(A|~N))+j[11]+3174756917&4294967295,k=A+(C<<10&4294967295|C>>>22),C=N+(A^(k|~P))+j[2]+718787259&4294967295,N=k+(C<<15&4294967295|C>>>17),C=P+(k^(N|~A))+j[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(N+(C<<21&4294967295|C>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+k&4294967295}n.prototype.u=function(I,A){A===void 0&&(A=I.length);for(var P=A-this.blockSize,j=this.B,N=this.h,k=0;k<A;){if(N==0)for(;k<=P;)i(this,I,k),k+=this.blockSize;if(typeof I=="string"){for(;k<A;)if(j[N++]=I.charCodeAt(k++),N==this.blockSize){i(this,j),N=0;break}}else for(;k<A;)if(j[N++]=I[k++],N==this.blockSize){i(this,j),N=0;break}}this.h=N,this.o+=A},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;var P=8*this.o;for(A=I.length-8;A<I.length;++A)I[A]=P&255,P/=256;for(this.u(I),I=Array(16),A=P=0;4>A;++A)for(var j=0;32>j;j+=8)I[P++]=this.g[A]>>>j&255;return I};function a(I,A){var P=o;return Object.prototype.hasOwnProperty.call(P,I)?P[I]:P[I]=A(I)}function s(I,A){this.h=A;for(var P=[],j=!0,N=I.length-1;0<=N;N--){var k=I[N]|0;j&&k==A||(P[N]=k,j=!1)}this.g=P}var o={};function l(I){return-128<=I&&128>I?a(I,function(A){return new s([A|0],0>A?-1:0)}):new s([I|0],0>I?-1:0)}function c(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return g(c(-I));for(var A=[],P=1,j=0;I>=P;j++)A[j]=I/P|0,P*=4294967296;return new s(A,0)}function u(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return g(u(I.substring(1),A));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=c(Math.pow(A,8)),j=h,N=0;N<I.length;N+=8){var k=Math.min(8,I.length-N),C=parseInt(I.substring(N,N+k),A);8>k?(k=c(Math.pow(A,k)),j=j.j(k).add(c(C))):(j=j.j(P),j=j.add(c(C)))}return j}var h=l(0),m=l(1),p=l(16777216);t=s.prototype,t.m=function(){if(b(this))return-g(this).m();for(var I=0,A=1,P=0;P<this.g.length;P++){var j=this.i(P);I+=(0<=j?j:4294967296+j)*A,A*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(b(this))return"-"+g(this).toString(I);for(var A=c(Math.pow(I,6)),P=this,j="";;){var N=O(P,A).g;P=_(P,N.j(A));var k=((0<P.g.length?P.g[0]:P.h)>>>0).toString(I);if(P=N,y(P))return k+j;for(;6>k.length;)k="0"+k;j=k+j}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function b(I){return I.h==-1}t.l=function(I){return I=_(this,I),b(I)?-1:y(I)?0:1};function g(I){for(var A=I.g.length,P=[],j=0;j<A;j++)P[j]=~I.g[j];return new s(P,~I.h).add(m)}t.abs=function(){return b(this)?g(this):this},t.add=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],j=0,N=0;N<=A;N++){var k=j+(this.i(N)&65535)+(I.i(N)&65535),C=(k>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);j=C>>>16,k&=65535,C&=65535,P[N]=C<<16|k}return new s(P,P[P.length-1]&-2147483648?-1:0)};function _(I,A){return I.add(g(A))}t.j=function(I){if(y(this)||y(I))return h;if(b(this))return b(I)?g(this).j(g(I)):g(g(this).j(I));if(b(I))return g(this.j(g(I)));if(0>this.l(p)&&0>I.l(p))return c(this.m()*I.m());for(var A=this.g.length+I.g.length,P=[],j=0;j<2*A;j++)P[j]=0;for(j=0;j<this.g.length;j++)for(var N=0;N<I.g.length;N++){var k=this.i(j)>>>16,C=this.i(j)&65535,Q=I.i(N)>>>16,oe=I.i(N)&65535;P[2*j+2*N]+=C*oe,T(P,2*j+2*N),P[2*j+2*N+1]+=k*oe,T(P,2*j+2*N+1),P[2*j+2*N+1]+=C*Q,T(P,2*j+2*N+1),P[2*j+2*N+2]+=k*Q,T(P,2*j+2*N+2)}for(j=0;j<A;j++)P[j]=P[2*j+1]<<16|P[2*j];for(j=A;j<2*A;j++)P[j]=0;return new s(P,0)};function T(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function E(I,A){this.g=I,this.h=A}function O(I,A){if(y(A))throw Error("division by zero");if(y(I))return new E(h,h);if(b(I))return A=O(g(I),A),new E(g(A.g),g(A.h));if(b(A))return A=O(I,g(A)),new E(g(A.g),A.h);if(30<I.g.length){if(b(I)||b(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,j=A;0>=j.l(I);)P=R(P),j=R(j);var N=D(P,1),k=D(j,1);for(j=D(j,2),P=D(P,2);!y(j);){var C=k.add(j);0>=C.l(I)&&(N=N.add(P),k=C),j=D(j,1),P=D(P,1)}return A=_(I,N.j(A)),new E(N,A)}for(N=h;0<=I.l(A);){for(P=Math.max(1,Math.floor(I.m()/A.m())),j=Math.ceil(Math.log(P)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),k=c(P),C=k.j(A);b(C)||0<C.l(I);)P-=j,k=c(P),C=k.j(A);y(k)&&(k=m),N=N.add(k),I=_(I,C)}return new E(N,I)}t.A=function(I){return O(this,I).h},t.and=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],j=0;j<A;j++)P[j]=this.i(j)&I.i(j);return new s(P,this.h&I.h)},t.or=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],j=0;j<A;j++)P[j]=this.i(j)|I.i(j);return new s(P,this.h|I.h)},t.xor=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],j=0;j<A;j++)P[j]=this.i(j)^I.i(j);return new s(P,this.h^I.h)};function R(I){for(var A=I.g.length+1,P=[],j=0;j<A;j++)P[j]=I.i(j)<<1|I.i(j-1)>>>31;return new s(P,I.h)}function D(I,A){var P=A>>5;A%=32;for(var j=I.g.length-P,N=[],k=0;k<j;k++)N[k]=0<A?I.i(k+P)>>>A|I.i(k+P+1)<<32-A:I.i(k+P);return new s(N,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,UE=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=u,ki=s}).apply(typeof g0<"u"?g0:typeof self<"u"?self:typeof window<"u"?window:{});var cc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BE,To,HE,Fc,Uf,WE,qE,KE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,v,x){return f==Array.prototype||f==Object.prototype||(f[v]=x.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof cc=="object"&&cc];for(var v=0;v<f.length;++v){var x=f[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(f,v){if(v)e:{var x=n;f=f.split(".");for(var S=0;S<f.length-1;S++){var M=f[S];if(!(M in x))break e;x=x[M]}f=f[f.length-1],S=x[f],v=v(S),v!=S&&v!=null&&e(x,f,{configurable:!0,writable:!0,value:v})}}function a(f,v){f instanceof String&&(f+="");var x=0,S=!1,M={next:function(){if(!S&&x<f.length){var $=x++;return{value:v($,f[$]),done:!1}}return S=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(f){return f||function(){return a(this,function(v,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function l(f){var v=typeof f;return v=v!="object"?v:f?Array.isArray(f)?"array":v:"null",v=="array"||v=="object"&&typeof f.length=="number"}function c(f){var v=typeof f;return v=="object"&&f!=null||v=="function"}function u(f,v,x){return f.call.apply(f.bind,arguments)}function h(f,v,x){if(!f)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,S),f.apply(v,M)}}return function(){return f.apply(v,arguments)}}function m(f,v,x){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,v){var x=Array.prototype.slice.call(arguments,1);return function(){var S=x.slice();return S.push.apply(S,arguments),f.apply(this,S)}}function y(f,v){function x(){}x.prototype=v.prototype,f.aa=v.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(S,M,$){for(var W=Array(arguments.length-2),De=2;De<arguments.length;De++)W[De-2]=arguments[De];return v.prototype[M].apply(S,W)}}function b(f){const v=f.length;if(0<v){const x=Array(v);for(let S=0;S<v;S++)x[S]=f[S];return x}return[]}function g(f,v){for(let x=1;x<arguments.length;x++){const S=arguments[x];if(l(S)){const M=f.length||0,$=S.length||0;f.length=M+$;for(let W=0;W<$;W++)f[M+W]=S[W]}else f.push(S)}}class _{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function O(f){return O[" "](f),f}O[" "]=function(){};var R=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(f,v,x){for(const S in f)v.call(x,f[S],S,f)}function I(f,v){for(const x in f)v.call(void 0,f[x],x,f)}function A(f){const v={};for(const x in f)v[x]=f[x];return v}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(f,v){let x,S;for(let M=1;M<arguments.length;M++){S=arguments[M];for(x in S)f[x]=S[x];for(let $=0;$<P.length;$++)x=P[$],Object.prototype.hasOwnProperty.call(S,x)&&(f[x]=S[x])}}function N(f){var v=1;f=f.split(":");const x=[];for(;0<v&&f.length;)x.push(f.shift()),v--;return f.length&&x.push(f.join(":")),x}function k(f){o.setTimeout(()=>{throw f},0)}function C(){var f=ye;let v=null;return f.g&&(v=f.g,f.g=f.g.next,f.g||(f.h=null),v.next=null),v}class Q{constructor(){this.h=this.g=null}add(v,x){const S=oe.get();S.set(v,x),this.h?this.h.next=S:this.g=S,this.h=S}}var oe=new _(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,he=!1,ye=new Q,ze=()=>{const f=o.Promise.resolve(void 0);ee=()=>{f.then(se)}};var se=()=>{for(var f;f=C();){try{f.h.call(f.g)}catch(x){k(x)}var v=oe;v.j(f),100>v.h&&(v.h++,f.next=v.g,v.g=f)}he=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(f,v){this.type=f,this.g=this.target=v,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var tt=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,v=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const x=()=>{};o.addEventListener("test",x,v),o.removeEventListener("test",x,v)}catch{}return f}();function Ve(f,v){if(J.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,S=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=v,v=f.relatedTarget){if(R){e:{try{O(v.nodeName);var M=!0;break e}catch{}M=!1}M||(v=null)}}else x=="mouseover"?v=f.fromElement:x=="mouseout"&&(v=f.toElement);this.relatedTarget=v,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Fe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Ve.aa.h.call(this)}}y(Ve,J);var Fe={2:"touch",3:"pen",4:"mouse"};Ve.prototype.h=function(){Ve.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Pr="closure_listenable_"+(1e6*Math.random()|0),rn=0;function G(f,v,x,S,M){this.listener=f,this.proxy=null,this.src=v,this.type=x,this.capture=!!S,this.ha=M,this.key=++rn,this.da=this.fa=!1}function de(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function be(f){this.src=f,this.g={},this.h=0}be.prototype.add=function(f,v,x,S,M){var $=f.toString();f=this.g[$],f||(f=this.g[$]=[],this.h++);var W=ut(f,v,S,M);return-1<W?(v=f[W],x||(v.fa=!1)):(v=new G(v,this.src,$,!!S,M),v.fa=x,f.push(v)),v};function B(f,v){var x=v.type;if(x in f.g){var S=f.g[x],M=Array.prototype.indexOf.call(S,v,void 0),$;($=0<=M)&&Array.prototype.splice.call(S,M,1),$&&(de(v),f.g[x].length==0&&(delete f.g[x],f.h--))}}function ut(f,v,x,S){for(var M=0;M<f.length;++M){var $=f[M];if(!$.da&&$.listener==v&&$.capture==!!x&&$.ha==S)return M}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),yt={};function vt(f,v,x,S,M){if(Array.isArray(v)){for(var $=0;$<v.length;$++)vt(f,v[$],x,S,M);return null}return x=zl(x),f&&f[Pr]?f.K(v,x,c(S)?!!S.capture:!1,M):rr(f,v,x,!1,S,M)}function rr(f,v,x,S,M,$){if(!v)throw Error("Invalid event type");var W=c(M)?!!M.capture:!!M,De=nn(f);if(De||(f[Te]=De=new be(f)),x=De.add(v,x,S,W,$),x.proxy)return x;if(S=Zi(),x.proxy=S,S.src=f,S.listener=x,f.addEventListener)tt||(M=W),M===void 0&&(M=!1),f.addEventListener(v.toString(),S,M);else if(f.attachEvent)f.attachEvent(Fl(v.toString()),S);else if(f.addListener&&f.removeListener)f.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Zi(){function f(x){return v.call(f.src,f.listener,x)}const v=nr;return f}function kr(f,v,x,S,M){if(Array.isArray(v))for(var $=0;$<v.length;$++)kr(f,v[$],x,S,M);else S=c(S)?!!S.capture:!!S,x=zl(x),f&&f[Pr]?(f=f.i,v=String(v).toString(),v in f.g&&($=f.g[v],x=ut($,x,S,M),-1<x&&(de($[x]),Array.prototype.splice.call($,x,1),$.length==0&&(delete f.g[v],f.h--)))):f&&(f=nn(f))&&(v=f.g[v.toString()],f=-1,v&&(f=ut(v,x,S,M)),(x=-1<f?v[f]:null)&&Zs(x))}function Zs(f){if(typeof f!="number"&&f&&!f.da){var v=f.src;if(v&&v[Pr])B(v.i,f);else{var x=f.type,S=f.proxy;v.removeEventListener?v.removeEventListener(x,S,f.capture):v.detachEvent?v.detachEvent(Fl(x),S):v.addListener&&v.removeListener&&v.removeListener(S),(x=nn(v))?(B(x,f),x.h==0&&(x.src=null,v[Te]=null)):de(f)}}}function Fl(f){return f in yt?yt[f]:yt[f]="on"+f}function nr(f,v){if(f.da)f=!0;else{v=new Ve(v,this);var x=f.listener,S=f.ha||f.src;f.fa&&Zs(f),f=x.call(S,v)}return f}function nn(f){return f=f[Te],f instanceof be?f:null}var Xs="__closure_events_fn_"+(1e9*Math.random()>>>0);function zl(f){return typeof f=="function"?f:(f[Xs]||(f[Xs]=function(v){return f.handleEvent(v)}),f[Xs])}function it(){q.call(this),this.i=new be(this),this.M=this,this.F=null}y(it,q),it.prototype[Pr]=!0,it.prototype.removeEventListener=function(f,v,x,S){kr(this,f,v,x,S)};function Ot(f,v){var x,S=f.F;if(S)for(x=[];S;S=S.F)x.push(S);if(f=f.M,S=v.type||v,typeof v=="string")v=new J(v,f);else if(v instanceof J)v.target=v.target||f;else{var M=v;v=new J(S,f),j(v,M)}if(M=!0,x)for(var $=x.length-1;0<=$;$--){var W=v.g=x[$];M=Xi(W,S,!0,v)&&M}if(W=v.g=f,M=Xi(W,S,!0,v)&&M,M=Xi(W,S,!1,v)&&M,x)for($=0;$<x.length;$++)W=v.g=x[$],M=Xi(W,S,!1,v)&&M}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var f=this.i,v;for(v in f.g){for(var x=f.g[v],S=0;S<x.length;S++)de(x[S]);delete f.g[v],f.h--}}this.F=null},it.prototype.K=function(f,v,x,S){return this.i.add(String(f),v,!1,x,S)},it.prototype.L=function(f,v,x,S){return this.i.add(String(f),v,!0,x,S)};function Xi(f,v,x,S){if(v=f.i.g[String(v)],!v)return!0;v=v.concat();for(var M=!0,$=0;$<v.length;++$){var W=v[$];if(W&&!W.da&&W.capture==x){var De=W.listener,Mt=W.ha||W.src;W.fa&&B(f.i,W),M=De.call(Mt,S)!==!1&&M}}return M&&!S.defaultPrevented}function Xa(f,v,x){if(typeof f=="function")x&&(f=m(f,x));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:o.setTimeout(f,v||0)}function Nn(f){f.g=Xa(()=>{f.g=null,f.i&&(f.i=!1,Nn(f))},f.l);const v=f.h;f.h=null,f.m.apply(null,v)}class Ul extends q{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Nn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Cr(f){q.call(this),this.h=f,this.g={}}y(Cr,q);var Bl=[];function Hl(f){D(f.g,function(v,x){this.g.hasOwnProperty(x)&&Zs(v)},f),f.g={}}Cr.prototype.N=function(){Cr.aa.N.call(this),Hl(this)},Cr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qa=o.JSON.stringify,Wl=o.JSON.parse,Th=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Qi(){}Qi.prototype.h=null;function Hr(f){return f.h||(f.h=f.i())}function ql(){}var Ji={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ja(){J.call(this,"d")}y(Ja,J);function es(){J.call(this,"c")}y(es,J);var le={},at=null;function st(){return at=at||new it}le.La="serverreachability";function Kt(f){J.call(this,le.La,f)}y(Kt,J);function an(f){const v=st();Ot(v,new Kt(v))}le.STAT_EVENT="statevent";function dt(f,v){J.call(this,le.STAT_EVENT,f),this.stat=v}y(dt,J);function Oe(f){const v=st();Ot(v,new dt(v,f))}le.Ma="timingevent";function ea(f,v){J.call(this,le.Ma,f),this.size=v}y(ea,J);function Rt(f,v){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},v)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function Kl(f,v,x,S,M,$){f.info(function(){if(f.g)if($)for(var W="",De=$.split("&"),Mt=0;Mt<De.length;Mt++){var Ie=De[Mt].split("=");if(1<Ie.length){var Gt=Ie[0];Ie=Ie[1];var Yt=Gt.split("_");W=2<=Yt.length&&Yt[1]=="type"?W+(Gt+"="+Ie+"&"):W+(Gt+"=redacted&")}}else W=null;else W=$;return"XMLHTTP REQ ("+S+") [attempt "+M+"]: "+v+`
`+x+`
`+W})}function jn(f,v,x,S,M,$,W){f.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+M+"]: "+v+`
`+x+`
`+$+" "+W})}function ta(f,v,x,S){f.info(function(){return"XMLHTTP TEXT ("+v+"): "+Wk(f,x)+(S?" "+S:"")})}function Hk(f,v){f.info(function(){return"TIMEOUT: "+v})}Dt.prototype.info=function(){};function Wk(f,v){if(!f.g)return v;if(!v)return null;try{var x=JSON.parse(v);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var S=x[f];if(!(2>S.length)){var M=S[1];if(Array.isArray(M)&&!(1>M.length)){var $=M[0];if($!="noop"&&$!="stop"&&$!="close")for(var W=1;W<M.length;W++)M[W]=""}}}}return Qa(x)}catch{return v}}var Gl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},By={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ah;function Yl(){}y(Yl,Qi),Yl.prototype.g=function(){return new XMLHttpRequest},Yl.prototype.i=function(){return{}},Ah=new Yl;function ci(f,v,x,S){this.j=f,this.i=v,this.l=x,this.R=S||1,this.U=new Cr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Hy}function Hy(){this.i=null,this.g="",this.h=!1}var Wy={},Ih={};function Sh(f,v,x){f.L=1,f.v=Jl(On(v)),f.m=x,f.P=!0,qy(f,null)}function qy(f,v){f.F=Date.now(),Zl(f),f.A=On(f.v);var x=f.A,S=f.R;Array.isArray(S)||(S=[String(S)]),sv(x.i,"t",S),f.C=0,x=f.j.J,f.h=new Hy,f.g=Tv(f.j,x?v:null,!f.m),0<f.O&&(f.M=new Ul(m(f.Y,f,f.g),f.O)),v=f.U,x=f.g,S=f.ca;var M="readystatechange";Array.isArray(M)||(M&&(Bl[0]=M.toString()),M=Bl);for(var $=0;$<M.length;$++){var W=vt(x,M[$],S||v.handleEvent,!1,v.h||v);if(!W)break;v.g[W.key]=W}v=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,v)):(f.u="GET",f.g.ea(f.A,f.u,null,v)),an(),Kl(f.i,f.u,f.A,f.l,f.R,f.m)}ci.prototype.ca=function(f){f=f.target;const v=this.M;v&&Rn(f)==3?v.j():this.Y(f)},ci.prototype.Y=function(f){try{if(f==this.g)e:{const Yt=Rn(this.g);var v=this.g.Ba();const ns=this.g.Z();if(!(3>Yt)&&(Yt!=3||this.g&&(this.h.h||this.g.oa()||fv(this.g)))){this.J||Yt!=4||v==7||(v==8||0>=ns?an(3):an(2)),Ph(this);var x=this.g.Z();this.X=x;t:if(Ky(this)){var S=fv(this.g);f="";var M=S.length,$=Rn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ra(this),Qs(this);var W="";break t}this.h.i=new o.TextDecoder}for(v=0;v<M;v++)this.h.h=!0,f+=this.h.i.decode(S[v],{stream:!($&&v==M-1)});S.length=0,this.h.g+=f,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=x==200,jn(this.i,this.u,this.A,this.l,this.R,Yt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var De,Mt=this.g;if((De=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(De)){var Ie=De;break t}}Ie=null}if(x=Ie)ta(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kh(this,x);else{this.o=!1,this.s=3,Oe(12),ra(this),Qs(this);break e}}if(this.P){x=!0;let Wr;for(;!this.J&&this.C<W.length;)if(Wr=qk(this,W),Wr==Ih){Yt==4&&(this.s=4,Oe(14),x=!1),ta(this.i,this.l,null,"[Incomplete Response]");break}else if(Wr==Wy){this.s=4,Oe(15),ta(this.i,this.l,W,"[Invalid Chunk]"),x=!1;break}else ta(this.i,this.l,Wr,null),kh(this,Wr);if(Ky(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||W.length!=0||this.h.h||(this.s=1,Oe(16),x=!1),this.o=this.o&&x,!x)ta(this.i,this.l,W,"[Invalid Chunked Response]"),ra(this),Qs(this);else if(0<W.length&&!this.W){this.W=!0;var Gt=this.j;Gt.g==this&&Gt.ba&&!Gt.M&&(Gt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Dh(Gt),Gt.M=!0,Oe(11))}}else ta(this.i,this.l,W,null),kh(this,W);Yt==4&&ra(this),this.o&&!this.J&&(Yt==4?xv(this.j,this):(this.o=!1,Zl(this)))}else cC(this.g),x==400&&0<W.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),ra(this),Qs(this)}}}catch{}finally{}};function Ky(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function qk(f,v){var x=f.C,S=v.indexOf(`
`,x);return S==-1?Ih:(x=Number(v.substring(x,S)),isNaN(x)?Wy:(S+=1,S+x>v.length?Ih:(v=v.slice(S,S+x),f.C=S+x,v)))}ci.prototype.cancel=function(){this.J=!0,ra(this)};function Zl(f){f.S=Date.now()+f.I,Gy(f,f.I)}function Gy(f,v){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(m(f.ba,f),v)}function Ph(f){f.B&&(o.clearTimeout(f.B),f.B=null)}ci.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Hk(this.i,this.A),this.L!=2&&(an(),Oe(17)),ra(this),this.s=2,Qs(this)):Gy(this,this.S-f)};function Qs(f){f.j.G==0||f.J||xv(f.j,f)}function ra(f){Ph(f);var v=f.M;v&&typeof v.ma=="function"&&v.ma(),f.M=null,Hl(f.U),f.g&&(v=f.g,f.g=null,v.abort(),v.ma())}function kh(f,v){try{var x=f.j;if(x.G!=0&&(x.g==f||Ch(x.h,f))){if(!f.K&&Ch(x.h,f)&&x.G==3){try{var S=x.Da.g.parse(v)}catch{S=null}if(Array.isArray(S)&&S.length==3){var M=S;if(M[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)ac(x),nc(x);else break e;Rh(x),Oe(18)}}else x.za=M[1],0<x.za-x.T&&37500>M[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rt(m(x.Za,x),6e3));if(1>=Xy(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else ia(x,11)}else if((f.K||x.g==f)&&ac(x),!T(v))for(M=x.Da.g.parse(v),v=0;v<M.length;v++){let Ie=M[v];if(x.T=Ie[0],Ie=Ie[1],x.G==2)if(Ie[0]=="c"){x.K=Ie[1],x.ia=Ie[2];const Gt=Ie[3];Gt!=null&&(x.la=Gt,x.j.info("VER="+x.la));const Yt=Ie[4];Yt!=null&&(x.Aa=Yt,x.j.info("SVER="+x.Aa));const ns=Ie[5];ns!=null&&typeof ns=="number"&&0<ns&&(S=1.5*ns,x.L=S,x.j.info("backChannelRequestTimeoutMs_="+S)),S=x;const Wr=f.g;if(Wr){const oc=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(oc){var $=S.h;$.g||oc.indexOf("spdy")==-1&&oc.indexOf("quic")==-1&&oc.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Nh($,$.h),$.h=null))}if(S.D){const Mh=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Mh&&(S.ya=Mh,Ue(S.I,S.D,Mh))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),S=x;var W=f;if(S.qa=Ev(S,S.J?S.ia:null,S.W),W.K){Qy(S.h,W);var De=W,Mt=S.L;Mt&&(De.I=Mt),De.B&&(Ph(De),Zl(De)),S.g=W}else vv(S);0<x.i.length&&ic(x)}else Ie[0]!="stop"&&Ie[0]!="close"||ia(x,7);else x.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?ia(x,7):Oh(x):Ie[0]!="noop"&&x.l&&x.l.ta(Ie),x.v=0)}}an(4)}catch{}}var Kk=class{constructor(f,v){this.g=f,this.map=v}};function Yy(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Zy(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Xy(f){return f.h?1:f.g?f.g.size:0}function Ch(f,v){return f.h?f.h==v:f.g?f.g.has(v):!1}function Nh(f,v){f.g?f.g.add(v):f.h=v}function Qy(f,v){f.h&&f.h==v?f.h=null:f.g&&f.g.has(v)&&f.g.delete(v)}Yy.prototype.cancel=function(){if(this.i=Jy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Jy(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let v=f.i;for(const x of f.g.values())v=v.concat(x.D);return v}return b(f.i)}function Gk(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var v=[],x=f.length,S=0;S<x;S++)v.push(f[S]);return v}v=[],x=0;for(S in f)v[x++]=f[S];return v}function Yk(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var v=[];f=f.length;for(var x=0;x<f;x++)v.push(x);return v}v=[],x=0;for(const S in f)v[x++]=S;return v}}}function ev(f,v){if(f.forEach&&typeof f.forEach=="function")f.forEach(v,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,v,void 0);else for(var x=Yk(f),S=Gk(f),M=S.length,$=0;$<M;$++)v.call(void 0,S[$],x&&x[$],f)}var tv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Zk(f,v){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var S=f[x].indexOf("="),M=null;if(0<=S){var $=f[x].substring(0,S);M=f[x].substring(S+1)}else $=f[x];v($,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function na(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof na){this.h=f.h,Xl(this,f.j),this.o=f.o,this.g=f.g,Ql(this,f.s),this.l=f.l;var v=f.i,x=new to;x.i=v.i,v.g&&(x.g=new Map(v.g),x.h=v.h),rv(this,x),this.m=f.m}else f&&(v=String(f).match(tv))?(this.h=!1,Xl(this,v[1]||"",!0),this.o=Js(v[2]||""),this.g=Js(v[3]||"",!0),Ql(this,v[4]),this.l=Js(v[5]||"",!0),rv(this,v[6]||"",!0),this.m=Js(v[7]||"")):(this.h=!1,this.i=new to(null,this.h))}na.prototype.toString=function(){var f=[],v=this.j;v&&f.push(eo(v,nv,!0),":");var x=this.g;return(x||v=="file")&&(f.push("//"),(v=this.o)&&f.push(eo(v,nv,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(eo(x,x.charAt(0)=="/"?Jk:Qk,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",eo(x,tC)),f.join("")};function On(f){return new na(f)}function Xl(f,v,x){f.j=x?Js(v,!0):v,f.j&&(f.j=f.j.replace(/:$/,""))}function Ql(f,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);f.s=v}else f.s=null}function rv(f,v,x){v instanceof to?(f.i=v,rC(f.i,f.h)):(x||(v=eo(v,eC)),f.i=new to(v,f.h))}function Ue(f,v,x){f.i.set(v,x)}function Jl(f){return Ue(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Js(f,v){return f?v?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function eo(f,v,x){return typeof f=="string"?(f=encodeURI(f).replace(v,Xk),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Xk(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var nv=/[#\/\?@]/g,Qk=/[#\?:]/g,Jk=/[#\?]/g,eC=/[#\?@]/g,tC=/#/g;function to(f,v){this.h=this.g=null,this.i=f||null,this.j=!!v}function ui(f){f.g||(f.g=new Map,f.h=0,f.i&&Zk(f.i,function(v,x){f.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}t=to.prototype,t.add=function(f,v){ui(this),this.i=null,f=ts(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(v),this.h+=1,this};function iv(f,v){ui(f),v=ts(f,v),f.g.has(v)&&(f.i=null,f.h-=f.g.get(v).length,f.g.delete(v))}function av(f,v){return ui(f),v=ts(f,v),f.g.has(v)}t.forEach=function(f,v){ui(this),this.g.forEach(function(x,S){x.forEach(function(M){f.call(v,M,S,this)},this)},this)},t.na=function(){ui(this);const f=Array.from(this.g.values()),v=Array.from(this.g.keys()),x=[];for(let S=0;S<v.length;S++){const M=f[S];for(let $=0;$<M.length;$++)x.push(v[S])}return x},t.V=function(f){ui(this);let v=[];if(typeof f=="string")av(this,f)&&(v=v.concat(this.g.get(ts(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)v=v.concat(f[x])}return v},t.set=function(f,v){return ui(this),this.i=null,f=ts(this,f),av(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[v]),this.h+=1,this},t.get=function(f,v){return f?(f=this.V(f),0<f.length?String(f[0]):v):v};function sv(f,v,x){iv(f,v),0<x.length&&(f.i=null,f.g.set(ts(f,v),b(x)),f.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],v=Array.from(this.g.keys());for(var x=0;x<v.length;x++){var S=v[x];const $=encodeURIComponent(String(S)),W=this.V(S);for(S=0;S<W.length;S++){var M=$;W[S]!==""&&(M+="="+encodeURIComponent(String(W[S]))),f.push(M)}}return this.i=f.join("&")};function ts(f,v){return v=String(v),f.j&&(v=v.toLowerCase()),v}function rC(f,v){v&&!f.j&&(ui(f),f.i=null,f.g.forEach(function(x,S){var M=S.toLowerCase();S!=M&&(iv(this,S),sv(this,M,x))},f)),f.j=v}function nC(f,v){const x=new Dt;if(o.Image){const S=new Image;S.onload=p(di,x,"TestLoadImage: loaded",!0,v,S),S.onerror=p(di,x,"TestLoadImage: error",!1,v,S),S.onabort=p(di,x,"TestLoadImage: abort",!1,v,S),S.ontimeout=p(di,x,"TestLoadImage: timeout",!1,v,S),o.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=f}else v(!1)}function iC(f,v){const x=new Dt,S=new AbortController,M=setTimeout(()=>{S.abort(),di(x,"TestPingServer: timeout",!1,v)},1e4);fetch(f,{signal:S.signal}).then($=>{clearTimeout(M),$.ok?di(x,"TestPingServer: ok",!0,v):di(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(M),di(x,"TestPingServer: error",!1,v)})}function di(f,v,x,S,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),S(x)}catch{}}function aC(){this.g=new Th}function sC(f,v,x){const S=x||"";try{ev(f,function(M,$){let W=M;c(M)&&(W=Qa(M)),v.push(S+$+"="+encodeURIComponent(W))})}catch(M){throw v.push(S+"type="+encodeURIComponent("_badmap")),M}}function ec(f){this.l=f.Ub||null,this.j=f.eb||!1}y(ec,Qi),ec.prototype.g=function(){return new tc(this.l,this.j)},ec.prototype.i=function(f){return function(){return f}}({});function tc(f,v){it.call(this),this.D=f,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(tc,it),t=tc.prototype,t.open=function(f,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=v,this.readyState=1,no(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(v.body=f),(this.D||o).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ro(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,no(this)),this.g&&(this.readyState=3,no(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ov(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function ov(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var v=f.value?f.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!f.done}))&&(this.response=this.responseText+=v)}f.done?ro(this):no(this),this.readyState==3&&ov(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,ro(this))},t.Qa=function(f){this.g&&(this.response=f,ro(this))},t.ga=function(){this.g&&ro(this)};function ro(f){f.readyState=4,f.l=null,f.j=null,f.v=null,no(f)}t.setRequestHeader=function(f,v){this.u.append(f,v)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=v.next();return f.join(`\r
`)};function no(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(tc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function lv(f){let v="";return D(f,function(x,S){v+=S,v+=":",v+=x,v+=`\r
`}),v}function jh(f,v,x){e:{for(S in x){var S=!1;break e}S=!0}S||(x=lv(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):Ue(f,v,x))}function rt(f){it.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(rt,it);var oC=/^https?$/i,lC=["POST","PUT"];t=rt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,v,x,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);v=v?v.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ah.g(),this.v=this.o?Hr(this.o):Hr(Ah),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(v,String(f),!0),this.B=!1}catch($){cv(this,$);return}if(f=x||"",x=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var M in S)x.set(M,S[M]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const $ of S.keys())x.set($,S.get($));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),M=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(lC,v,void 0))||S||M||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,W]of x)this.g.setRequestHeader($,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{hv(this),this.u=!0,this.g.send(f),this.u=!1}catch($){cv(this,$)}};function cv(f,v){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=v,f.m=5,uv(f),rc(f)}function uv(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),rc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rc(this,!0)),rt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?dv(this):this.bb())},t.bb=function(){dv(this)};function dv(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Rn(f)!=4||f.Z()!=2)){if(f.u&&Rn(f)==4)Xa(f.Ea,0,f);else if(Ot(f,"readystatechange"),Rn(f)==4){f.h=!1;try{const W=f.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var S;if(S=W===0){var M=String(f.D).match(tv)[1]||null;!M&&o.self&&o.self.location&&(M=o.self.location.protocol.slice(0,-1)),S=!oC.test(M?M.toLowerCase():"")}x=S}if(x)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var $=2<Rn(f)?f.g.statusText:""}catch{$=""}f.l=$+" ["+f.Z()+"]",uv(f)}}finally{rc(f)}}}}function rc(f,v){if(f.g){hv(f);const x=f.g,S=f.v[0]?()=>{}:null;f.g=null,f.v=null,v||Ot(f,"ready");try{x.onreadystatechange=S}catch{}}}function hv(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Rn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Rn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var v=this.g.responseText;return f&&v.indexOf(f)==0&&(v=v.substring(f.length)),Wl(v)}};function fv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function cC(f){const v={};f=(f.g&&2<=Rn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<f.length;S++){if(T(f[S]))continue;var x=N(f[S]);const M=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=v[M]||[];v[M]=$,$.push(x)}I(v,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function io(f,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||v}function mv(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=io("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=io("baseRetryDelayMs",5e3,f),this.cb=io("retryDelaySeedMs",1e4,f),this.Wa=io("forwardChannelMaxRetries",2,f),this.wa=io("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new Yy(f&&f.concurrentRequestLimit),this.Da=new aC,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=mv.prototype,t.la=8,t.G=1,t.connect=function(f,v,x,S){Oe(0),this.W=f,this.H=v||{},x&&S!==void 0&&(this.H.OSID=x,this.H.OAID=S),this.F=this.X,this.I=Ev(this,null,this.W),ic(this)};function Oh(f){if(pv(f),f.G==3){var v=f.U++,x=On(f.I);if(Ue(x,"SID",f.K),Ue(x,"RID",v),Ue(x,"TYPE","terminate"),ao(f,x),v=new ci(f,f.j,v),v.L=2,v.v=Jl(On(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(v.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=v.v,x=!0),x||(v.g=Tv(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Zl(v)}_v(f)}function nc(f){f.g&&(Dh(f),f.g.cancel(),f.g=null)}function pv(f){nc(f),f.u&&(o.clearTimeout(f.u),f.u=null),ac(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function ic(f){if(!Zy(f.h)&&!f.s){f.s=!0;var v=f.Ga;ee||ze(),he||(ee(),he=!0),ye.add(v,f),f.B=0}}function uC(f,v){return Xy(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=v.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(m(f.Ga,f,v),wv(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const M=new ci(this,this.j,f);let $=this.o;if(this.S&&($?($=A($),j($,this.S)):$=this.S),this.m!==null||this.O||(M.H=$,$=null),this.P)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var S=this.i[x];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(v+=S,4096<v){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=yv(this,M,v),x=On(this.I),Ue(x,"RID",f),Ue(x,"CVER",22),this.D&&Ue(x,"X-HTTP-Session-Id",this.D),ao(this,x),$&&(this.O?v="headers="+encodeURIComponent(String(lv($)))+"&"+v:this.m&&jh(x,this.m,$)),Nh(this.h,M),this.Ua&&Ue(x,"TYPE","init"),this.P?(Ue(x,"$req",v),Ue(x,"SID","null"),M.T=!0,Sh(M,x,null)):Sh(M,x,v),this.G=2}}else this.G==3&&(f?gv(this,f):this.i.length==0||Zy(this.h)||gv(this))};function gv(f,v){var x;v?x=v.l:x=f.U++;const S=On(f.I);Ue(S,"SID",f.K),Ue(S,"RID",x),Ue(S,"AID",f.T),ao(f,S),f.m&&f.o&&jh(S,f.m,f.o),x=new ci(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),v&&(f.i=v.D.concat(f.i)),v=yv(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Nh(f.h,x),Sh(x,S,v)}function ao(f,v){f.H&&D(f.H,function(x,S){Ue(v,S,x)}),f.l&&ev({},function(x,S){Ue(v,S,x)})}function yv(f,v,x){x=Math.min(f.i.length,x);var S=f.l?m(f.l.Na,f.l,f):null;e:{var M=f.i;let $=-1;for(;;){const W=["count="+x];$==-1?0<x?($=M[0].g,W.push("ofs="+$)):$=0:W.push("ofs="+$);let De=!0;for(let Mt=0;Mt<x;Mt++){let Ie=M[Mt].g;const Gt=M[Mt].map;if(Ie-=$,0>Ie)$=Math.max(0,M[Mt].g-100),De=!1;else try{sC(Gt,W,"req"+Ie+"_")}catch{S&&S(Gt)}}if(De){S=W.join("&");break e}}}return f=f.i.splice(0,x),v.D=f,S}function vv(f){if(!f.g&&!f.u){f.Y=1;var v=f.Fa;ee||ze(),he||(ee(),he=!0),ye.add(v,f),f.v=0}}function Rh(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(m(f.Fa,f),wv(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,bv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),nc(this),bv(this))};function Dh(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function bv(f){f.g=new ci(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var v=On(f.qa);Ue(v,"RID","rpc"),Ue(v,"SID",f.K),Ue(v,"AID",f.T),Ue(v,"CI",f.F?"0":"1"),!f.F&&f.ja&&Ue(v,"TO",f.ja),Ue(v,"TYPE","xmlhttp"),ao(f,v),f.m&&f.o&&jh(v,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=Jl(On(v)),x.m=null,x.P=!0,qy(x,f)}t.Za=function(){this.C!=null&&(this.C=null,nc(this),Rh(this),Oe(19))};function ac(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function xv(f,v){var x=null;if(f.g==v){ac(f),Dh(f),f.g=null;var S=2}else if(Ch(f.h,v))x=v.D,Qy(f.h,v),S=1;else return;if(f.G!=0){if(v.o)if(S==1){x=v.m?v.m.length:0,v=Date.now()-v.F;var M=f.B;S=st(),Ot(S,new ea(S,x)),ic(f)}else vv(f);else if(M=v.s,M==3||M==0&&0<v.X||!(S==1&&uC(f,v)||S==2&&Rh(f)))switch(x&&0<x.length&&(v=f.h,v.i=v.i.concat(x)),M){case 1:ia(f,5);break;case 4:ia(f,10);break;case 3:ia(f,6);break;default:ia(f,2)}}}function wv(f,v){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*v}function ia(f,v){if(f.j.info("Error code "+v),v==2){var x=m(f.fb,f),S=f.Xa;const M=!S;S=new na(S||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Xl(S,"https"),Jl(S),M?nC(S.toString(),x):iC(S.toString(),x)}else Oe(2);f.G=0,f.l&&f.l.sa(v),_v(f),pv(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function _v(f){if(f.G=0,f.ka=[],f.l){const v=Jy(f.h);(v.length!=0||f.i.length!=0)&&(g(f.ka,v),g(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function Ev(f,v,x){var S=x instanceof na?On(x):new na(x);if(S.g!="")v&&(S.g=v+"."+S.g),Ql(S,S.s);else{var M=o.location;S=M.protocol,v=v?v+"."+M.hostname:M.hostname,M=+M.port;var $=new na(null);S&&Xl($,S),v&&($.g=v),M&&Ql($,M),x&&($.l=x),S=$}return x=f.D,v=f.ya,x&&v&&Ue(S,x,v),Ue(S,"VER",f.la),ao(f,S),S}function Tv(f,v,x){if(v&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=f.Ca&&!f.pa?new rt(new ec({eb:x})):new rt(f.pa),v.Ha(f.J),v}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Av(){}t=Av.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function sc(){}sc.prototype.g=function(f,v){return new gr(f,v)};function gr(f,v){it.call(this),this.g=new mv(v),this.l=f,this.h=v&&v.messageUrlParams||null,f=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(f?f["X-WebChannel-Content-Type"]=v.messageContentType:f={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(f?f["X-WebChannel-Client-Profile"]=v.va:f={"X-WebChannel-Client-Profile":v.va}),this.g.S=f,(f=v&&v.Sb)&&!T(f)&&(this.g.m=f),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!T(v)&&(this.g.D=v,f=this.h,f!==null&&v in f&&(f=this.h,v in f&&delete f[v])),this.j=new rs(this)}y(gr,it),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Oh(this.g)},gr.prototype.o=function(f){var v=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=Qa(f),f=x);v.i.push(new Kk(v.Ya++,f)),v.G==3&&ic(v)},gr.prototype.N=function(){this.g.l=null,delete this.j,Oh(this.g),delete this.g,gr.aa.N.call(this)};function Iv(f){Ja.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var v=f.__sm__;if(v){e:{for(const x in v){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,v=v!==null&&f in v?v[f]:void 0),this.data=v}else this.data=f}y(Iv,Ja);function Sv(){es.call(this),this.status=1}y(Sv,es);function rs(f){this.g=f}y(rs,Av),rs.prototype.ua=function(){Ot(this.g,"a")},rs.prototype.ta=function(f){Ot(this.g,new Iv(f))},rs.prototype.sa=function(f){Ot(this.g,new Sv)},rs.prototype.ra=function(){Ot(this.g,"b")},sc.prototype.createWebChannel=sc.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,KE=function(){return new sc},qE=function(){return st()},WE=le,Uf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gl.NO_ERROR=0,Gl.TIMEOUT=8,Gl.HTTP_ERROR=6,Fc=Gl,By.COMPLETE="complete",HE=By,ql.EventType=Ji,Ji.OPEN="a",Ji.CLOSE="b",Ji.ERROR="c",Ji.MESSAGE="d",it.prototype.listen=it.prototype.K,To=ql,rt.prototype.listenOnce=rt.prototype.L,rt.prototype.getLastError=rt.prototype.Ka,rt.prototype.getLastErrorCode=rt.prototype.Ba,rt.prototype.getStatus=rt.prototype.Z,rt.prototype.getResponseJson=rt.prototype.Oa,rt.prototype.getResponseText=rt.prototype.oa,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Ha,BE=rt}).apply(typeof cc<"u"?cc:typeof self<"u"?self:typeof window<"u"?window:{});const y0="@firebase/firestore",v0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ls="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new dp("@firebase/firestore");function ss(){return Ca.logLevel}function Y(t,...e){if(Ca.logLevel<=xe.DEBUG){const r=e.map(_p);Ca.debug(`Firestore (${Ls}): ${t}`,...r)}}function Xn(t,...e){if(Ca.logLevel<=xe.ERROR){const r=e.map(_p);Ca.error(`Firestore (${Ls}): ${t}`,...r)}}function Es(t,...e){if(Ca.logLevel<=xe.WARN){const r=e.map(_p);Ca.warn(`Firestore (${Ls}): ${t}`,...r)}}function _p(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,GE(t,n,r)}function GE(t,e,r){let n=`FIRESTORE (${Ls}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Xn(n),new Error(n)}function Ce(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||GE(e,i,n)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Pn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Y2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Qt.UNAUTHENTICATED))}shutdown(){}}class Z2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class X2{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ce(this.o===void 0,42304);let n=this.i;const i=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let a=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ci,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const l=a;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},o=l=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ci)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ce(typeof n.accessToken=="string",31837,{l:n}),new YE(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ce(e===null||typeof e=="string",2055,{h:e}),new Qt(e)}}class Q2{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class J2{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Q2(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class b0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eR{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ce(this.o===void 0,3512);const n=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new b0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ce(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new b0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=tR(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function we(t,e){return t<e?-1:t>e?1:0}function Bf(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return Kh(i)===Kh(a)?we(i,a):Kh(i)?1:-1}return we(t.length,e.length)}const rR=55296,nR=57343;function Kh(t){const e=t.charCodeAt(0);return e>=rR&&e<=nR}function Ts(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x0="__name__";class ln{constructor(e,r,n){r===void 0?r=0:r>e.length&&ue(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ue(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ln.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ln?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=ln.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return we(e.length,r.length)}static compareSegments(e,r){const n=ln.isNumericId(e),i=ln.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?ln.extractNumericId(e).compare(ln.extractNumericId(r)):Bf(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ki.fromString(e.substring(4,e.length-2))}}class Ze extends ln{construct(e,r,n){return new Ze(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new re(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Ze(r)}static emptyPath(){return new Ze([])}}const iR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends ln{construct(e,r,n){return new zt(e,r,n)}static isValidIdentifier(e){return iR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===x0}static keyField(){return new zt([x0])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new re(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new re(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new re(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(r)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Ze.fromString(e))}static fromName(e){return new ae(Ze.fromString(e).popFirst(5))}static empty(){return new ae(Ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ze.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(t,e,r){if(!r)throw new re(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sR(t,e,r,n){if(e===!0&&n===!0)throw new re(U.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function w0(t){if(!ae.isDocumentKey(t))throw new re(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ZE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Tp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function Go(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Tp(t);throw new re(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t,e){const r={typeString:t};return e&&(r.value=e),r}function _l(t,e){if(!ZE(t))throw new re(U.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new re(U.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=-62135596800,E0=1e6;class We{static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*E0);return new We(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<_0)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/E0}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:We._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(_l(e,We._jsonSchema))return new We(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}We._jsonSchemaVersion="firestore/timestamp/1.0",We._jsonSchema={type:pt("string",We._jsonSchemaVersion),seconds:pt("number"),nanoseconds:pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new We(0,0))}static max(){return new fe(new We(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=-1;function oR(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(n===1e9?new We(r+1,0):new We(r,n));return new Ri(i,ae.empty(),e)}function lR(t){return new Ri(t.readTime,t.key,Yo)}class Ri{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ri(fe.min(),ae.empty(),Yo)}static max(){return new Ri(fe.max(),ae.empty(),Yo)}}function cR(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ae.comparator(t.documentKey,e.documentKey),r!==0?r:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $s(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==uR)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new z((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof z?r:z.resolve(r)}catch(r){return z.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):z.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):z.reject(r)}static resolve(e){return new z((r,n)=>{r(e)})}static reject(e){return new z((r,n)=>{n(e)})}static waitFor(e){return new z((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},l=>n(l))}),s=!0,a===i&&r()})}static or(e){let r=z.resolve(!1);for(const n of e)r=r.next(i=>i?z.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new z((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let l=0;l<a;l++){const c=l;r(e[c]).next(u=>{s[c]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new z((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function hR(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Vs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}md.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap=-1;function pd(t){return t==null}function cu(t){return t===0&&1/t==-1/0}function fR(t){return typeof t=="number"&&Number.isInteger(t)&&!cu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE="";function mR(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=T0(e)),e=pR(t.get(r),e);return T0(e)}function pR(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case XE:r+="";break;default:r+=a}}return r}function T0(t){return t+XE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Fa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function QE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,r){this.comparator=e,this.root=r||Vt.EMPTY}insert(e,r){return new Xe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new uc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new uc(this.root,e,this.comparator,!1)}getReverseIterator(){return new uc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new uc(this.root,e,this.comparator,!0)}}class uc{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Vt.RED,this.left=i??Vt.EMPTY,this.right=a??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Vt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Vt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new I0(this.data.getIterator())}getIteratorFrom(e){return new I0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Tt)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Tt(this.comparator);return r.data=e,r}}class I0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Xr([])}unionWith(e){let r=new Tt(zt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ts(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new JE("Invalid base64 string: "+a):a}}(e);return new Ht(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Ht(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ht.EMPTY_BYTE_STRING=new Ht("");const gR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Di(t){if(Ce(!!t,39018),typeof t=="string"){let e=0;const r=gR.exec(t);if(Ce(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ot(t.seconds),nanos:ot(t.nanos)}}function ot(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mi(t){return typeof t=="string"?Ht.fromBase64String(t):Ht.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="server_timestamp",t1="__type__",r1="__previous_value__",n1="__local_write_time__";function Ip(t){return(t?.mapValue?.fields||{})[t1]?.stringValue===e1}function gd(t){const e=t.mapValue.fields[r1];return Ip(e)?gd(e):e}function Zo(t){const e=Di(t.mapValue.fields[n1].timestampValue);return new We(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,r,n,i,a,s,o,l,c,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const uu="(default)";class Xo{constructor(e,r){this.projectId=e,this.database=r||uu}static empty(){return new Xo("","")}get isDefaultDatabase(){return this.database===uu}isEqual(e){return e instanceof Xo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1="__type__",vR="__max__",dc={mapValue:{}},a1="__vector__",du="value";function Li(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ip(t)?4:xR(t)?9007199254740991:bR(t)?10:11:ue(28295,{value:t})}function En(t,e){if(t===e)return!0;const r=Li(t);if(r!==Li(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zo(t).isEqual(Zo(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Di(i.timestampValue),o=Di(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Mi(i.bytesValue).isEqual(Mi(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return ot(i.geoPointValue.latitude)===ot(a.geoPointValue.latitude)&&ot(i.geoPointValue.longitude)===ot(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return ot(i.integerValue)===ot(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=ot(i.doubleValue),o=ot(a.doubleValue);return s===o?cu(s)===cu(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Ts(t.arrayValue.values||[],e.arrayValue.values||[],En);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(A0(s)!==A0(o))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(o[l]===void 0||!En(s[l],o[l])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function Qo(t,e){return(t.values||[]).find(r=>En(r,e))!==void 0}function As(t,e){if(t===e)return 0;const r=Li(t),n=Li(e);if(r!==n)return we(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=ot(a.integerValue||a.doubleValue),l=ot(s.integerValue||s.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return S0(t.timestampValue,e.timestampValue);case 4:return S0(Zo(t),Zo(e));case 5:return Bf(t.stringValue,e.stringValue);case 6:return function(a,s){const o=Mi(a),l=Mi(s);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),l=s.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=we(o[c],l[c]);if(u!==0)return u}return we(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=we(ot(a.latitude),ot(s.latitude));return o!==0?o:we(ot(a.longitude),ot(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return P0(t.arrayValue,e.arrayValue);case 10:return function(a,s){const o=a.fields||{},l=s.fields||{},c=o[du]?.arrayValue,u=l[du]?.arrayValue,h=we(c?.values?.length||0,u?.values?.length||0);return h!==0?h:P0(c,u)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===dc.mapValue&&s===dc.mapValue)return 0;if(a===dc.mapValue)return 1;if(s===dc.mapValue)return-1;const o=a.fields||{},l=Object.keys(o),c=s.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const m=Bf(l[h],u[h]);if(m!==0)return m;const p=As(o[l[h]],c[u[h]]);if(p!==0)return p}return we(l.length,u.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:r})}}function S0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const r=Di(t),n=Di(e),i=we(r.seconds,n.seconds);return i!==0?i:we(r.nanos,n.nanos)}function P0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=As(r[i],n[i]);if(a)return a}return we(r.length,n.length)}function Is(t){return Hf(t)}function Hf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Di(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Mi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=Hf(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${Hf(r.fields[s])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function zc(t){switch(Li(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gd(t);return e?16+zc(e):16;case 5:return 2*t.stringValue.length;case 6:return Mi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+zc(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Fa(n.fields,(a,s)=>{i+=a.length+zc(s)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function Wf(t){return!!t&&"integerValue"in t}function Sp(t){return!!t&&"arrayValue"in t}function k0(t){return!!t&&"nullValue"in t}function C0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Uc(t){return!!t&&"mapValue"in t}function bR(t){return(t?.mapValue?.fields||{})[i1]?.stringValue===a1}function Oo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Oo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Oo(t.arrayValue.values[r]);return e}return{...t}}function xR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===vR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.value=e}static empty(){return new Or({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Uc(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oo(r)}setAll(e){let r=zt.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=Oo(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());Uc(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return En(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Uc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Fa(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Or(Oo(this.value))}}function s1(t){const e=[];return Fa(t.fields,(r,n)=>{const i=new zt([r]);if(Uc(n)){const a=s1(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Jt(e,0,fe.min(),fe.min(),fe.min(),Or.empty(),0)}static newFoundDocument(e,r,n,i){return new Jt(e,1,r,fe.min(),n,i,0)}static newNoDocument(e,r){return new Jt(e,2,r,fe.min(),fe.min(),Or.empty(),0)}static newUnknownDocument(e,r){return new Jt(e,3,r,fe.min(),fe.min(),Or.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Or.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Or.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,r){this.position=e,this.inclusive=r}}function N0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=ae.comparator(ae.fromName(s.referenceValue),r.key):n=As(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function j0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!En(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(e,r="asc"){this.field=e,this.dir=r}}function wR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{}class wt extends o1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new ER(e,r,n):r==="array-contains"?new IR(e,n):r==="in"?new SR(e,n):r==="not-in"?new PR(e,n):r==="array-contains-any"?new kR(e,n):new wt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new TR(e,n):new AR(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(As(r,this.value)):r!==null&&Li(this.value)===Li(r)&&this.matchesComparison(As(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tn extends o1{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Tn(e,r)}matches(e){return l1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function l1(t){return t.op==="and"}function c1(t){return _R(t)&&l1(t)}function _R(t){for(const e of t.filters)if(e instanceof Tn)return!1;return!0}function qf(t){if(t instanceof wt)return t.field.canonicalString()+t.op.toString()+Is(t.value);if(c1(t))return t.filters.map(e=>qf(e)).join(",");{const e=t.filters.map(r=>qf(r)).join(",");return`${t.op}(${e})`}}function u1(t,e){return t instanceof wt?function(n,i){return i instanceof wt&&n.op===i.op&&n.field.isEqual(i.field)&&En(n.value,i.value)}(t,e):t instanceof Tn?function(n,i){return i instanceof Tn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&u1(s,i.filters[o]),!0):!1}(t,e):void ue(19439)}function d1(t){return t instanceof wt?function(r){return`${r.field.canonicalString()} ${r.op} ${Is(r.value)}`}(t):t instanceof Tn?function(r){return r.op.toString()+" {"+r.getFilters().map(d1).join(" ,")+"}"}(t):"Filter"}class ER extends wt{constructor(e,r,n){super(e,r,n),this.key=ae.fromName(n.referenceValue)}matches(e){const r=ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class TR extends wt{constructor(e,r){super(e,"in",r),this.keys=h1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class AR extends wt{constructor(e,r){super(e,"not-in",r),this.keys=h1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function h1(t,e){return(e.arrayValue?.values||[]).map(r=>ae.fromName(r.referenceValue))}class IR extends wt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Sp(r)&&Qo(r.arrayValue,this.value)}}class SR extends wt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Qo(this.value.arrayValue,r)}}class PR extends wt{constructor(e,r){super(e,"not-in",r)}matches(e){if(Qo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Qo(this.value.arrayValue,r)}}class kR extends wt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Sp(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Qo(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function O0(t,e=null,r=[],n=[],i=null,a=null,s=null){return new CR(t,e,r,n,i,a,s)}function Pp(t){const e=ge(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>qf(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),pd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Is(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Is(n)).join(",")),e.Te=r}return e.Te}function kp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!wR(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!u1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!j0(t.startAt,e.startAt)&&j0(t.endAt,e.endAt)}function Kf(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function NR(t,e,r,n,i,a,s,o){return new yd(t,e,r,n,i,a,s,o)}function Cp(t){return new yd(t)}function R0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jR(t){return t.collectionGroup!==null}function Ro(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new Tt(zt.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new fu(a,n))}),r.has(zt.keyField().canonicalString())||e.Ie.push(new fu(zt.keyField(),n))}return e.Ie}function gn(t){const e=ge(t);return e.Ee||(e.Ee=OR(e,Ro(t))),e.Ee}function OR(t,e){if(t.limitType==="F")return O0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new fu(i.field,a)});const r=t.endAt?new hu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new hu(t.startAt.position,t.startAt.inclusive):null;return O0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Gf(t,e,r){return new yd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function vd(t,e){return kp(gn(t),gn(e))&&t.limitType===e.limitType}function f1(t){return`${Pp(gn(t))}|lt:${t.limitType}`}function os(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>d1(i)).join(", ")}]`),pd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Is(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Is(i)).join(",")),`Target(${n})`}(gn(t))}; limitType=${t.limitType})`}function bd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ae.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Ro(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,l){const c=N0(s,o,l);return s.inclusive?c<=0:c<0}(n.startAt,Ro(n),i)||n.endAt&&!function(s,o,l){const c=N0(s,o,l);return s.inclusive?c>=0:c>0}(n.endAt,Ro(n),i))}(t,e)}function RR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function m1(t){return(e,r)=>{let n=!1;for(const i of Ro(t)){const a=DR(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function DR(t,e,r){const n=t.field.isKeyField()?ae.comparator(e.key,r.key):function(a,s,o){const l=s.data.field(a),c=o.data.field(a);return l!==null&&c!==null?As(l,c):ue(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Fa(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return QE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=new Xe(ae.comparator);function Qn(){return MR}const p1=new Xe(ae.comparator);function Ao(...t){let e=p1;for(const r of t)e=e.insert(r.key,r);return e}function g1(t){let e=p1;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ua(){return Do()}function y1(){return Do()}function Do(){return new za(t=>t.toString(),(t,e)=>t.isEqual(e))}const LR=new Xe(ae.comparator),$R=new Tt(ae.comparator);function Ee(...t){let e=$R;for(const r of t)e=e.add(r);return e}const VR=new Tt(we);function FR(){return VR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cu(e)?"-0":e}}function v1(t){return{integerValue:""+t}}function zR(t,e){return fR(e)?v1(e):Np(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(){this._=void 0}}function UR(t,e,r){return t instanceof mu?function(i,a){const s={fields:{[t1]:{stringValue:e1},[n1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Ip(a)&&(a=gd(a)),a&&(s.fields[r1]=a),{mapValue:s}}(r,e):t instanceof Jo?x1(t,e):t instanceof el?w1(t,e):function(i,a){const s=b1(i,a),o=D0(s)+D0(i.Ae);return Wf(s)&&Wf(i.Ae)?v1(o):Np(i.serializer,o)}(t,e)}function BR(t,e,r){return t instanceof Jo?x1(t,e):t instanceof el?w1(t,e):r}function b1(t,e){return t instanceof pu?function(n){return Wf(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class mu extends xd{}class Jo extends xd{constructor(e){super(),this.elements=e}}function x1(t,e){const r=_1(e);for(const n of t.elements)r.some(i=>En(i,n))||r.push(n);return{arrayValue:{values:r}}}class el extends xd{constructor(e){super(),this.elements=e}}function w1(t,e){let r=_1(e);for(const n of t.elements)r=r.filter(i=>!En(i,n));return{arrayValue:{values:r}}}class pu extends xd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function D0(t){return ot(t.integerValue||t.doubleValue)}function _1(t){return Sp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function HR(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Jo&&i instanceof Jo||n instanceof el&&i instanceof el?Ts(n.elements,i.elements,En):n instanceof pu&&i instanceof pu?En(n.Ae,i.Ae):n instanceof mu&&i instanceof mu}(t.transform,e.transform)}class WR{constructor(e,r){this.version=e,this.transformResults=r}}class Wn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Wn}static exists(e){return new Wn(void 0,e)}static updateTime(e){return new Wn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wd{}function E1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new A1(t.key,Wn.none()):new El(t.key,t.data,Wn.none());{const r=t.data,n=Or.empty();let i=new Tt(zt.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new Ua(t.key,n,new Xr(i.toArray()),Wn.none())}}function qR(t,e,r){t instanceof El?function(i,a,s){const o=i.value.clone(),l=L0(i.fieldTransforms,a,s.transformResults);o.setAll(l),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ua?function(i,a,s){if(!Bc(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=L0(i.fieldTransforms,a,s.transformResults),l=a.data;l.setAll(T1(i)),l.setAll(o),a.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Mo(t,e,r,n){return t instanceof El?function(a,s,o,l){if(!Bc(a.precondition,s))return o;const c=a.value.clone(),u=$0(a.fieldTransforms,l,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ua?function(a,s,o,l){if(!Bc(a.precondition,s))return o;const c=$0(a.fieldTransforms,l,s),u=s.data;return u.setAll(T1(a)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return Bc(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function KR(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=b1(n.transform,i||null);a!=null&&(r===null&&(r=Or.empty()),r.set(n.field,a))}return r||null}function M0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Ts(n,i,(a,s)=>HR(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class El extends wd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ua extends wd{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function T1(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function L0(t,e,r){const n=new Map;Ce(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,BR(s,o,r[i]))}return n}function $0(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,UR(a,s,e))}return n}class A1 extends wd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GR extends wd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&qR(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Mo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Mo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=y1();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const l=E1(s,o);l!==null&&n.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Ts(this.mutations,e.mutations,(r,n)=>M0(r,n))&&Ts(this.baseMutations,e.baseMutations,(r,n)=>M0(r,n))}}class jp{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ce(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return LR}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new jp(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,Ae;function QR(t){switch(t){case U.OK:return ue(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function I1(t){if(t===void 0)return Xn("GRPC error has no .code"),U.UNKNOWN;switch(t){case ft.OK:return U.OK;case ft.CANCELLED:return U.CANCELLED;case ft.UNKNOWN:return U.UNKNOWN;case ft.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case ft.INTERNAL:return U.INTERNAL;case ft.UNAVAILABLE:return U.UNAVAILABLE;case ft.UNAUTHENTICATED:return U.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case ft.NOT_FOUND:return U.NOT_FOUND;case ft.ALREADY_EXISTS:return U.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return U.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case ft.ABORTED:return U.ABORTED;case ft.OUT_OF_RANGE:return U.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return U.UNIMPLEMENTED;case ft.DATA_LOSS:return U.DATA_LOSS;default:return ue(39323,{code:t})}}(Ae=ft||(ft={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD=new ki([4294967295,4294967295],0);function V0(t){const e=JR().encode(t),r=new UE;return r.update(e),new Uint8Array(r.digest())}function F0(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ki([r,n],0),new ki([i,a],0)]}class Op{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Io(`Invalid padding: ${r}`);if(n<0)throw new Io(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Io(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Io(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=ki.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(ki.fromNumber(n)));return i.compare(eD)===1&&(i=new ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=V0(e),[n,i]=F0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new Op(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=V0(e),[n,i]=F0(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Io extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new _d(fe.min(),i,new Xe(we),Qn(),Ee())}}class Tl{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Tl(n,r,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class S1{constructor(e,r){this.targetId=e,this.Ce=r}}class P1{constructor(e,r,n=Ht.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class z0{constructor(){this.ve=0,this.Fe=U0(),this.Me=Ht.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),r=Ee(),n=Ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ue(38017,{changeType:a})}}),new Tl(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=U0()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qn(),this.Je=hc(),this.He=hc(),this.Ye=new Xe(we)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(Kf(a))if(n===0){const s=new ae(a.path);this.et(r,s,Jt.newNoDocument(s,fe.min()))}else Ce(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),l=o?this.ct(o,e,s):1;if(l!==0){this.it(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,c)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=Mi(n).toUint8Array()}catch(l){if(l instanceof JE)return Es("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new Op(s,i,a)}catch(l){return Es(l instanceof Io?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&Kf(o.target)){const l=new ae(o.target.path);this.It(l).has(s)||this.Et(s,l)||this.et(s,l,Jt.newNoDocument(l,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=Ee();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new _d(e,r,this.Ye,this.je,n);return this.je=Qn(),this.Je=hc(),this.He=hc(),this.Ye=new Xe(we),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new z0,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Tt(we),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Tt(we),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Y("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new z0),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function hc(){return new Xe(ae.comparator)}function U0(){return new Xe(ae.comparator)}const rD={asc:"ASCENDING",desc:"DESCENDING"},nD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iD={and:"AND",or:"OR"};class aD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Yf(t,e){return t.useProto3Json||pd(e)?e:{value:e}}function gu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function k1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function sD(t,e){return gu(t,e.toTimestamp())}function yn(t){return Ce(!!t,49232),fe.fromTimestamp(function(r){const n=Di(r);return new We(n.seconds,n.nanos)}(t))}function Rp(t,e){return Zf(t,e).canonicalString()}function Zf(t,e){const r=function(i){return new Ze(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function C1(t){const e=Ze.fromString(t);return Ce(D1(e),10190,{key:e.toString()}),e}function Xf(t,e){return Rp(t.databaseId,e.path)}function Gh(t,e){const r=C1(e);if(r.get(1)!==t.databaseId.projectId)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ae(j1(r))}function N1(t,e){return Rp(t.databaseId,e)}function oD(t){const e=C1(t);return e.length===4?Ze.emptyPath():j1(e)}function Qf(t){return new Ze(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function j1(t){return Ce(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function B0(t,e,r){return{name:Xf(t,e),fields:r.value.mapValue.fields}}function lD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(c,u){return c.useProto3Json?(Ce(u===void 0||typeof u=="string",58123),Ht.fromBase64String(u||"")):(Ce(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Ht.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(c){const u=c.code===void 0?U.UNKNOWN:I1(c.code);return new re(u,c.message||"")}(s);r=new P1(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gh(t,n.document.name),a=yn(n.document.updateTime),s=n.document.createTime?yn(n.document.createTime):fe.min(),o=new Or({mapValue:{fields:n.document.fields}}),l=Jt.newFoundDocument(i,a,s,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new Hc(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gh(t,n.document),a=n.readTime?yn(n.readTime):fe.min(),s=Jt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new Hc([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gh(t,n.document),a=n.removedTargetIds||[];r=new Hc([],a,i,null)}else{if(!("filter"in e))return ue(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new XR(i,a),o=n.targetId;r=new S1(o,s)}}return r}function cD(t,e){let r;if(e instanceof El)r={update:B0(t,e.key,e.value)};else if(e instanceof A1)r={delete:Xf(t,e.key)};else if(e instanceof Ua)r={update:B0(t,e.key,e.data),updateMask:vD(e.fieldMask)};else{if(!(e instanceof GR))return ue(16599,{Vt:e.type});r={verify:Xf(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof mu)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Jo)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof el)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof pu)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw ue(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:sD(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ue(27497)}(t,e.precondition)),r}function uD(t,e){return t&&t.length>0?(Ce(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?yn(i.updateTime):yn(a);return s.isEqual(fe.min())&&(s=yn(a)),new WR(s,i.transformResults||[])}(r,e))):[]}function dD(t,e){return{documents:[N1(t,e.path)]}}function hD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=N1(t,i);const a=function(c){if(c.length!==0)return R1(Tn.create(c,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(c){if(c.length!==0)return c.map(u=>function(m){return{field:ls(m.field),direction:pD(m.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=Yf(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:r,parent:i}}function fD(t){let e=oD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ce(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=O1(h);return m instanceof Tn&&c1(m)?m.getFilters():[m]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(m=>function(y){return new fu(cs(y.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,pd(m)?null:m}(r.limit));let l=null;r.startAt&&(l=function(h){const m=!!h.before,p=h.values||[];return new hu(p,m)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const m=!h.before,p=h.values||[];return new hu(p,m)}(r.endAt)),NR(e,i,s,a,o,"F",l,c)}function mD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function O1(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=cs(r.unaryFilter.field);return wt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=cs(r.unaryFilter.field);return wt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=cs(r.unaryFilter.field);return wt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=cs(r.unaryFilter.field);return wt.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(r){return wt.create(cs(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Tn.create(r.compositeFilter.filters.map(n=>O1(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(r.compositeFilter.op))}(t):ue(30097,{filter:t})}function pD(t){return rD[t]}function gD(t){return nD[t]}function yD(t){return iD[t]}function ls(t){return{fieldPath:t.canonicalString()}}function cs(t){return zt.fromServerFormat(t.fieldPath)}function R1(t){return t instanceof wt?function(r){if(r.op==="=="){if(C0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NAN"}};if(k0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(C0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NOT_NAN"}};if(k0(r.value))return{unaryFilter:{field:ls(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ls(r.field),op:gD(r.op),value:r.value}}}(t):t instanceof Tn?function(r){const n=r.getFilters().map(i=>R1(i));return n.length===1?n[0]:{compositeFilter:{op:yD(r.op),filters:n}}}(t):ue(54877,{filter:t})}function vD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function D1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,r,n,i,a=fe.min(),s=fe.min(),o=Ht.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Ai(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{constructor(e){this.yt=e}}function xD(t){const e=fD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Gf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{constructor(){this.Cn=new _D}addToCollectionParentIndex(e,r){return this.Cn.add(r),z.resolve()}getCollectionParents(e,r){return z.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return z.resolve()}deleteFieldIndex(e,r){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,r){return z.resolve()}getDocumentsMatchingTarget(e,r){return z.resolve(null)}getIndexType(e,r){return z.resolve(0)}getFieldIndexes(e,r){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,r){return z.resolve(Ri.min())}getMinOffsetFromCollectionGroup(e,r){return z.resolve(Ri.min())}updateCollectionGroup(e,r,n){return z.resolve()}updateIndexEntries(e,r){return z.resolve()}}class _D{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Tt(Ze.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Tt(Ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},M1=41943040;class cr{static withCacheSize(e){return new cr(e,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cr.DEFAULT_COLLECTION_PERCENTILE=10,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cr.DEFAULT=new cr(M1,cr.DEFAULT_COLLECTION_PERCENTILE,cr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cr.DISABLED=new cr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ss(0)}static cr(){return new Ss(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="LruGarbageCollector",ED=1048576;function q0([t,e],[r,n]){const i=we(t,r);return i===0?we(e,n):i}class TD{constructor(e){this.Ir=e,this.buffer=new Tt(q0),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();q0(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class AD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(W0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Vs(r)?Y(W0,"Ignoring IndexedDB error during garbage collection: ",r):await $s(r)}await this.Vr(3e5)})}}class ID{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return z.resolve(md.ce);const n=new TD(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(H0)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),H0):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(c=Date.now(),ss()<=xe.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(l-o)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function SD(t,e){return new ID(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(){this.changes=new za(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Jt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?z.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Mo(n.mutation,i,Xr.empty(),We.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ee()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ee()){const i=ua();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=Ao();return a.forEach((o,l)=>{s=s.insert(o,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=ua();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ee()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=Qn();const s=Do(),o=function(){return Do()}();return r.forEach((l,c)=>{const u=n.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ua)?a=a.insert(c.key,c):u!==void 0?(s.set(c.key,u.mutation.getFieldMask()),Mo(u.mutation,c,u.mutation.getFieldMask(),We.now())):s.set(c.key,Xr.empty())}),this.recalculateAndSaveOverlays(e,a).next(l=>(l.forEach((c,u)=>s.set(c,u)),r.forEach((c,u)=>o.set(c,new kD(u,s.get(c)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Do();let i=new Xe((s,o)=>s-o),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Xr.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(i.get(o.batchId)||Ee()).add(l);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=y1();u.forEach(m=>{if(!a.has(m)){const p=E1(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,h))}return z.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ae.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):jR(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):z.resolve(ua());let o=Yo,l=a;return s.next(c=>z.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?z.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{l=l.insert(u,m)}))).next(()=>this.populateOverlays(e,c,a)).next(()=>this.computeViews(e,l,c,Ee())).next(u=>({batchId:o,changes:g1(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ae(r)).next(n=>{let i=Ao();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=Ao();return this.indexManager.getCollectionParents(e,a).next(o=>z.forEach(o,l=>{const c=function(h,m){return new yd(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(a));return this.getDocumentsMatchingCollectionQuery(e,c,n,i).next(u=>{u.forEach((h,m)=>{s=s.insert(h,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((l,c)=>{const u=c.getKey();s.get(u)===null&&(s=s.insert(u,Jt.newInvalidDocument(u)))});let o=Ao();return s.forEach((l,c)=>{const u=a.get(l);u!==void 0&&Mo(u.mutation,c,Xr.empty(),We.now()),bd(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return z.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:yn(i.createTime)}}(r)),z.resolve()}getNamedQuery(e,r){return z.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:xD(i.bundledQuery),readTime:yn(i.readTime)}}(r)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(){this.overlays=new Xe(ae.comparator),this.qr=new Map}getOverlay(e,r){return z.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ua();return z.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),z.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),z.resolve()}getOverlaysForCollection(e,r,n){const i=ua(),a=r.length+1,s=new ae(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===a&&l.largestBatchId>n&&i.set(l.getKey(),l)}return z.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Xe((c,u)=>c-u);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=a.get(c.largestBatchId);u===null&&(u=ua(),a=a.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=ua(),l=a.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=i)););return z.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new ZR(r,n));let a=this.qr.get(r);a===void 0&&(a=Ee(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(){this.sessionToken=Ht.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.Qr=new Tt(St.$r),this.Ur=new Tt(St.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new St(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new St(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ae(new Ze([])),n=new St(r,e),i=new St(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ae(new Ze([])),n=new St(r,e),i=new St(r,e+1);let a=Ee();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new St(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class St{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ae.comparator(e.key,r.key)||we(e.Yr,r.Yr)}static Kr(e,r){return we(e.Yr,r.Yr)||ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Tt(St.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new YR(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new St(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return z.resolve(s)}lookupMutationBatch(e,r){return z.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Ap:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new St(r,0),i=new St(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Tt(we);return r.forEach(i=>{const a=new St(i,0),s=new St(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),z.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;ae.isDocumentKey(a)||(a=a.child(""));const s=new St(new ae(a),0);let o=new Tt(we);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===i&&(o=o.add(l.Yr)),!0)},s),z.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ce(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return z.forEach(r.mutations,i=>{const a=new St(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new St(r,0),i=this.Zr.firstAfterOrEqual(n);return z.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e){this.ri=e,this.docs=function(){return new Xe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return z.resolve(n?n.document.mutableCopy():Jt.newInvalidDocument(r))}getEntries(e,r){let n=Qn();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Jt.newInvalidDocument(i))}),z.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Qn();const s=r.path,o=new ae(s.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||cR(lR(u),n)<=0||(i.has(u.key)||bd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,r,n,i){ue(9500)}ii(e,r){return z.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new MD(this)}getSize(e){return z.resolve(this.size)}}class MD extends PD{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),z.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e){this.persistence=e,this.si=new za(r=>Pp(r),kp),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Dp,this.targetCount=0,this.ai=Ss.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),z.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ss(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,z.resolve()}updateTargetData(e,r){return this.Pr(r),z.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),z.waitFor(a).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return z.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),z.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),z.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),z.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return z.resolve(n)}containsKey(e,r){return z.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e,r){this.ui={},this.overlays={},this.ci=new md(0),this.li=!1,this.li=!0,this.hi=new OD,this.referenceDelegate=e(this),this.Pi=new LD(this),this.indexManager=new wD,this.remoteDocumentCache=function(i){return new DD(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new bD(r),this.Ii=new ND(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new jD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new RD(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Y("MemoryPersistence","Starting transaction:",e);const i=new $D(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return z.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class $D extends dR{constructor(e){super(),this.currentSequenceNumber=e}}class Mp{constructor(e){this.persistence=e,this.Ri=new Dp,this.Vi=null}static mi(e){return new Mp(e)}get fi(){if(this.Vi)return this.Vi;throw ue(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),z.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),z.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),z.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,n=>{const i=ae.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return z.or([()=>z.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class yu{constructor(e,r){this.persistence=e,this.pi=new za(n=>mR(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=SD(this,r)}static mi(e,r){return new yu(e,r)}Ei(){}di(e){return z.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return z.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?z.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,fe.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=zc(e.data.value)),r}br(e,r,n){return z.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return z.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ee(),i=Ee();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Lp(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FD{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return mN()?8:hR(tr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new VD;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(ss()<=xe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",os(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(ss()<=xe.DEBUG&&Y("QueryEngine","Query:",os(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(ss()<=xe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",os(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,gn(r))):z.resolve())}ys(e,r){if(R0(r))return z.resolve(null);let n=gn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Gf(r,null,"F"),n=gn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=Ee(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(r,o);return this.Cs(r,c,s,l.readTime)?this.ys(e,Gf(r,null,"F")):this.vs(e,c,r,l)}))})))}ws(e,r,n,i){return R0(r)||i.isEqual(fe.min())?z.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?z.resolve(null):(ss()<=xe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),os(r)),this.vs(e,s,r,oR(i,Yo)).next(o=>o))})}Ds(e,r){let n=new Tt(m1(e));return r.forEach((i,a)=>{bd(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return ss()<=xe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",os(r)),this.ps.getDocumentsMatchingQuery(e,r,Ri.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="LocalStore",zD=3e8;class UD{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Xe(we),this.xs=new za(a=>Pp(a),kp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CD(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function BD(t,e,r,n){return new UD(t,e,r,n)}async function $1(t,e){const r=ge(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let l=Ee();for(const c of i){s.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of a){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:s,addedBatchIds:o}))})})}function HD(t,e){const r=ge(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,m=h.keys();let p=z.resolve();return m.forEach(y=>{p=p.next(()=>u.getEntry(l,y)).next(b=>{const g=c.docVersions.get(y);Ce(g!==null,48541),b.version.compareTo(g)<0&&(h.applyToRemoteDocument(b,c),b.isValidDocument()&&(b.setReadTime(c.commitVersion),u.addEntry(b)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Ee();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function V1(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function WD(t,e){const r=ge(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const m=i.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Ht.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(b,g,_){return b.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=zD?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,u)&&o.push(r.Pi.updateTargetData(a,p))});let l=Qn(),c=Ee();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(qD(a,s,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!n.isEqual(fe.min())){const u=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return z.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,l,c)).next(()=>l)}).then(a=>(r.Ms=i,a))}function qD(t,e,r){let n=Ee(),i=Ee();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=Qn();return r.forEach((o,l)=>{const c=a.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(o)),l.isNoDocument()&&l.version.isEqual(fe.min())?(e.removeEntry(o,l.readTime),s=s.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(o,l)):Y($p,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{ks:s,qs:i}})}function KD(t,e){const r=ge(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Ap),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function GD(t,e){const r=ge(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,z.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ai(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function Jf(t,e,r){const n=ge(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Vs(s))throw s;Y($p,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function K0(t,e,r){const n=ge(t);let i=fe.min(),a=Ee();return n.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,u){const h=ge(l),m=h.xs.get(u);return m!==void 0?z.resolve(h.Ms.get(m)):h.Pi.getTargetData(c,u)}(n,s,gn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(l=>{a=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:fe.min(),r?a:Ee())).next(o=>(YD(n,RR(e),o),{documents:o,Qs:a})))}function YD(t,e,r){let n=t.Os.get(e)||fe.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class G0{constructor(){this.activeTargetIds=FR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZD{constructor(){this.Mo=new G0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new G0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0="ConnectivityMonitor";class Z0{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(Y0,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(Y0,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fc=null;function em(){return fc===null?fc=function(){return 268435456+Math.round(2147483648*Math.random())}():fc++,"0x"+fc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="RestConnection",QD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JD{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===uu?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=em(),o=this.zo(e,r.toUriEncodedString());Y(Yh,`Sending RPC '${e}' ${s}:`,o,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,i,a);const{host:c}=new URL(o),u=La(c);return this.Jo(e,o,l,n,u).then(h=>(Y(Yh,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Es(Yh,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ls}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=QD[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class tM extends JD{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=em();return new Promise((o,l)=>{const c=new BE;c.setWithCredentials(!0),c.listenOnce(HE.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Fc.NO_ERROR:const h=c.getResponseJson();Y(Zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Fc.TIMEOUT:Y(Zt,`RPC '${e}' ${s} timed out`),l(new re(U.DEADLINE_EXCEEDED,"Request time out"));break;case Fc.HTTP_ERROR:const m=c.getStatus();if(Y(Zt,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p?.error;if(y&&y.status&&y.message){const b=function(_){const T=_.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(T)>=0?T:U.UNKNOWN}(y.status);l(new re(b,y.message))}else l(new re(U.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new re(U.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:s,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{Y(Zt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Y(Zt,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",u,n,15)})}T_(e,r,n){const i=em(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=KE(),o=qE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=a.join("");Y(Zt,`Creating RPC '${e}' stream ${i}: ${u}`,l);const h=s.createWebChannel(u,l);this.I_(h);let m=!1,p=!1;const y=new eM({Yo:g=>{p?Y(Zt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(m||(Y(Zt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Y(Zt,`RPC '${e}' stream ${i} sending:`,g),h.send(g))},Zo:()=>h.close()}),b=(g,_,T)=>{g.listen(_,E=>{try{T(E)}catch(O){setTimeout(()=>{throw O},0)}})};return b(h,To.EventType.OPEN,()=>{p||(Y(Zt,`RPC '${e}' stream ${i} transport opened.`),y.o_())}),b(h,To.EventType.CLOSE,()=>{p||(p=!0,Y(Zt,`RPC '${e}' stream ${i} transport closed`),y.a_(),this.E_(h))}),b(h,To.EventType.ERROR,g=>{p||(p=!0,Es(Zt,`RPC '${e}' stream ${i} transport errored. Name:`,g.name,"Message:",g.message),y.a_(new re(U.UNAVAILABLE,"The operation could not be completed")))}),b(h,To.EventType.MESSAGE,g=>{if(!p){const _=g.data[0];Ce(!!_,16349);const T=_,E=T?.error||T[0]?.error;if(E){Y(Zt,`RPC '${e}' stream ${i} received error:`,E);const O=E.status;let R=function(A){const P=ft[A];if(P!==void 0)return I1(P)}(O),D=E.message;R===void 0&&(R=U.INTERNAL,D="Unknown error status: "+O+" with message "+E.message),p=!0,y.a_(new re(R,D)),h.close()}else Y(Zt,`RPC '${e}' stream ${i} received:`,_),y.u_(_)}}),b(o,WE.STAT_EVENT,g=>{g.stat===Uf.PROXY?Y(Zt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===Uf.NOPROXY&&Y(Zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.__()},0),y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function Zh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(t){return new aD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="PersistentStream";class z1{constructor(e,r,n,i,a,s,o,l){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new F1(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===U.RESOURCE_EXHAUSTED?(Xn(r.toString()),Xn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new re(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(X0,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Y(X0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class rM extends z1{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=lD(this.serializer,e),n=function(a){if(!("targetChange"in a))return fe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?fe.min():s.readTime?yn(s.readTime):fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Qf(this.serializer),r.addTarget=function(a,s){let o;const l=s.target;if(o=Kf(l)?{documents:dD(a,l)}:{query:hD(a,l).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=k1(a,s.resumeToken);const c=Yf(a,s.expectedCount);c!==null&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(fe.min())>0){o.readTime=gu(a,s.snapshotVersion.toTimestamp());const c=Yf(a,s.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=mD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Qf(this.serializer),r.removeTarget=e,this.q_(r)}}class nM extends z1{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=uD(e.writeResults,e.commitTime),n=yn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Qf(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>cD(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM{}class aM extends iM{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,Zf(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new re(U.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,Zf(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(U.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class sM{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xn(r),this.aa=!1):Y("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="RemoteStore";class oM{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ba(this)&&(Y(Na,"Restarting streams for network reachability change."),await async function(l){const c=ge(l);c.Ea.add(4),await Al(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Td(c)}(this))})}),this.Ra=new sM(n,i)}}async function Td(t){if(Ba(t))for(const e of t.da)await e(!0)}async function Al(t){for(const e of t.da)await e(!1)}function U1(t,e){const r=ge(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Up(r)?zp(r):Fs(r).O_()&&Fp(r,e))}function Vp(t,e){const r=ge(t),n=Fs(r);r.Ia.delete(e),n.O_()&&B1(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ba(r)&&r.Ra.set("Unknown"))}function Fp(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fs(t).Y_(e)}function B1(t,e){t.Va.Ue(e),Fs(t).Z_(e)}function zp(t){t.Va=new tD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fs(t).start(),t.Ra.ua()}function Up(t){return Ba(t)&&!Fs(t).x_()&&t.Ia.size>0}function Ba(t){return ge(t).Ea.size===0}function H1(t){t.Va=void 0}async function lM(t){t.Ra.set("Online")}async function cM(t){t.Ia.forEach((e,r)=>{Fp(t,e)})}async function uM(t,e){H1(t),Up(t)?(t.Ra.ha(e),zp(t)):t.Ra.set("Unknown")}async function dM(t,e,r){if(t.Ra.set("Online"),e instanceof P1&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Y(Na,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await vu(t,n)}else if(e instanceof Hc?t.Va.Ze(e):e instanceof S1?t.Va.st(e):t.Va.tt(e),!r.isEqual(fe.min()))try{const n=await V1(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=a.Ia.get(c);u&&a.Ia.set(c,u.withResumeToken(l.resumeToken,s))}}),o.targetMismatches.forEach((l,c)=>{const u=a.Ia.get(l);if(!u)return;a.Ia.set(l,u.withResumeToken(Ht.EMPTY_BYTE_STRING,u.snapshotVersion)),B1(a,l);const h=new Ai(u.target,l,c,u.sequenceNumber);Fp(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Y(Na,"Failed to raise snapshot:",n),await vu(t,n)}}async function vu(t,e,r){if(!Vs(e))throw e;t.Ea.add(1),await Al(t),t.Ra.set("Offline"),r||(r=()=>V1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(Na,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Td(t)})}function W1(t,e){return e().catch(r=>vu(t,r,e))}async function Ad(t){const e=ge(t),r=$i(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ap;for(;hM(e);)try{const i=await KD(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,fM(e,i)}catch(i){await vu(e,i)}q1(e)&&K1(e)}function hM(t){return Ba(t)&&t.Ta.length<10}function fM(t,e){t.Ta.push(e);const r=$i(t);r.O_()&&r.X_&&r.ea(e.mutations)}function q1(t){return Ba(t)&&!$i(t).x_()&&t.Ta.length>0}function K1(t){$i(t).start()}async function mM(t){$i(t).ra()}async function pM(t){const e=$i(t);for(const r of t.Ta)e.ea(r.mutations)}async function gM(t,e,r){const n=t.Ta.shift(),i=jp.from(n,e,r);await W1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ad(t)}async function yM(t,e){e&&$i(t).X_&&await async function(n,i){if(function(s){return QR(s)&&s!==U.ABORTED}(i.code)){const a=n.Ta.shift();$i(n).B_(),await W1(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Ad(n)}}(t,e),q1(t)&&K1(t)}async function Q0(t,e){const r=ge(t);r.asyncQueue.verifyOperationInProgress(),Y(Na,"RemoteStore received new credentials");const n=Ba(r);r.Ea.add(3),await Al(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Td(r)}async function vM(t,e){const r=ge(t);e?(r.Ea.delete(2),await Td(r)):e||(r.Ea.add(2),await Al(r),r.Ra.set("Unknown"))}function Fs(t){return t.ma||(t.ma=function(r,n,i){const a=ge(r);return a.sa(),new rM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:lM.bind(null,t),t_:cM.bind(null,t),r_:uM.bind(null,t),H_:dM.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Up(t)?zp(t):t.Ra.set("Unknown")):(await t.ma.stop(),H1(t))})),t.ma}function $i(t){return t.fa||(t.fa=function(r,n,i){const a=ge(r);return a.sa(),new nM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:mM.bind(null,t),r_:yM.bind(null,t),ta:pM.bind(null,t),na:gM.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ad(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(Na,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new Bp(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hp(t,e){if(Xn("AsyncQueue",`${e}: ${t}`),Vs(t))return new re(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{static emptySet(e){return new ys(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ae.comparator(r.key,n.key):(r,n)=>ae.comparator(r.key,n.key),this.keyedMap=Ao(),this.sortedSet=new Xe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ys)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ys;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(){this.ga=new Xe(ae.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ue(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ps{constructor(e,r,n,i,a,s,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Ps(e,r,ys.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class xM{constructor(){this.queries=eb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ge(r),a=i.queries;i.queries=eb(),a.forEach((s,o)=>{for(const l of o.Sa)l.onError(n)})})(this,new re(U.ABORTED,"Firestore shutting down"))}}function eb(){return new za(t=>f1(t),vd)}async function wM(t,e){const r=ge(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new bM,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=Hp(s,`Initialization of query '${os(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&Wp(r)}async function _M(t,e){const r=ge(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function EM(t,e){const r=ge(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&Wp(r)}function TM(t,e,r){const n=ge(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function Wp(t){t.Ca.forEach(e=>{e.next()})}var tm,tb;(tb=tm||(tm={})).Ma="default",tb.Cache="cache";class AM{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ps(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ps.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==tm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.key=e}}class Y1{constructor(e){this.key=e}}class IM{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=m1(e),this.tu=new ys(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new J0,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const m=i.get(u),p=bd(this.query,h)?h:null,y=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;m&&p?m.data.isEqual(p.data)?y!==b&&(n.track({type:3,doc:p}),g=!0):this.su(m,p)||(n.track({type:2,doc:p}),g=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),g=!0):m&&!p&&(n.track({type:1,doc:m}),g=!0,(l||c)&&(o=!0)),g&&(p?(s=s.add(p),a=b?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(p,y){const b=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Rt:g})}};return b(p)-b(y)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],l=this.Xa.size===0&&this.current&&!i?1:0,c=l!==this.Za;return this.Za=l,s.length!==0||c?{snapshot:new Ps(this.query,e.tu,a,s,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new J0,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new Y1(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new G1(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ee();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ps.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const qp="SyncEngine";class SM{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class PM{constructor(e){this.key=e,this.hu=!1}}class kM{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new za(o=>f1(o),vd),this.Iu=new Map,this.Eu=new Set,this.du=new Xe(ae.comparator),this.Au=new Map,this.Ru=new Dp,this.Vu={},this.mu=new Map,this.fu=Ss.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CM(t,e,r=!0){const n=tT(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await Z1(n,e,r,!0),i}async function NM(t,e){const r=tT(t);await Z1(r,e,!0,!1)}async function Z1(t,e,r,n){const i=await GD(t.localStore,gn(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await jM(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&U1(t.remoteStore,i),o}async function jM(t,e,r,n,i){t.pu=(h,m,p)=>async function(b,g,_,T){let E=g.view.ru(_);E.Cs&&(E=await K0(b.localStore,g.query,!1).then(({documents:I})=>g.view.ru(I,E)));const O=T&&T.targetChanges.get(g.targetId),R=T&&T.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(E,b.isPrimaryClient,O,R);return nb(b,g.targetId,D.au),D.snapshot}(t,h,m,p);const a=await K0(t.localStore,e,!0),s=new IM(e,a.Qs),o=s.ru(a.documents),l=Tl.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),c=s.applyChanges(o,t.isPrimaryClient,l);nb(t,r,c.au);const u=new SM(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),c.snapshot}async function OM(t,e,r){const n=ge(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!vd(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Jf(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Vp(n.remoteStore,i.targetId),rm(n,i.targetId)}).catch($s)):(rm(n,i.targetId),await Jf(n.localStore,i.targetId,!0))}async function RM(t,e){const r=ge(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Vp(r.remoteStore,n.targetId))}async function DM(t,e,r){const n=UM(t);try{const i=await function(s,o){const l=ge(s),c=We.now(),u=o.reduce((p,y)=>p.add(y.key),Ee());let h,m;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=Qn(),b=Ee();return l.Ns.getEntries(p,u).next(g=>{y=g,y.forEach((_,T)=>{T.isValidDocument()||(b=b.add(_))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,y)).next(g=>{h=g;const _=[];for(const T of o){const E=KR(T,h.get(T.key).overlayedDocument);E!=null&&_.push(new Ua(T.key,E,s1(E.value.mapValue),Wn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,_,o)}).next(g=>{m=g;const _=g.applyToLocalDocumentSet(h,b);return l.documentOverlayCache.saveOverlays(p,g.batchId,_)})}).then(()=>({batchId:m.batchId,changes:g1(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,l){let c=s.Vu[s.currentUser.toKey()];c||(c=new Xe(we)),c=c.insert(o,l),s.Vu[s.currentUser.toKey()]=c}(n,i.batchId,r),await Il(n,i.changes),await Ad(n.remoteStore)}catch(i){const a=Hp(i,"Failed to persist write");r.reject(a)}}async function X1(t,e){const r=ge(t);try{const n=await WD(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Ce(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Ce(s.hu,14607):i.removedDocuments.size>0&&(Ce(s.hu,42227),s.hu=!1))}),await Il(r,n,e)}catch(n){await $s(n)}}function rb(t,e,r){const n=ge(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const l=ge(s);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(o)&&(c=!0)}),c&&Wp(l)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function MM(t,e,r){const n=ge(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new Xe(ae.comparator);s=s.insert(a,Jt.newNoDocument(a,fe.min()));const o=Ee().add(a),l=new _d(fe.min(),new Map,new Xe(we),s,o);await X1(n,l),n.du=n.du.remove(a),n.Au.delete(e),Kp(n)}else await Jf(n.localStore,e,!1).then(()=>rm(n,e,r)).catch($s)}async function LM(t,e){const r=ge(t),n=e.batch.batchId;try{const i=await HD(r.localStore,e);J1(r,n,null),Q1(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Il(r,i)}catch(i){await $s(i)}}async function $M(t,e,r){const n=ge(t);try{const i=await function(s,o){const l=ge(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(Ce(h!==null,37113),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);J1(n,e,r),Q1(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Il(n,i)}catch(i){await $s(i)}}function Q1(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function J1(t,e,r){const n=ge(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function rm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||eT(t,n)})}function eT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Vp(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Kp(t))}function nb(t,e,r){for(const n of r)n instanceof G1?(t.Ru.addReference(n.key,e),VM(t,n)):n instanceof Y1?(Y(qp,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||eT(t,n.key)):ue(19791,{wu:n})}function VM(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Y(qp,"New document in limbo: "+r),t.Eu.add(n),Kp(t))}function Kp(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ae(Ze.fromString(e)),n=t.fu.next();t.Au.set(n,new PM(r)),t.du=t.du.insert(r,n),U1(t.remoteStore,new Ai(gn(Cp(r.path)),n,"TargetPurposeLimboResolution",md.ce))}}async function Il(t,e,r){const n=ge(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,l)=>{s.push(n.pu(l,e,r).then(c=>{if((c||r)&&n.isPrimaryClient){const u=c?!c.fromCache:r?.targetChanges.get(l.targetId)?.current;n.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){i.push(c);const u=Lp.As(l.targetId,c);a.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(l,c){const u=ge(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>z.forEach(c,m=>z.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>z.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Vs(h))throw h;Y($p,"Failed to update sequence numbers: "+h)}for(const h of c){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),y=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(m,b)}}}(n.localStore,a))}async function FM(t,e){const r=ge(t);if(!r.currentUser.isEqual(e)){Y(qp,"User change. New user:",e.toKey());const n=await $1(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(l=>{l.reject(new re(U.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Il(r,n.Ls)}}function zM(t,e){const r=ge(t),n=r.Au.get(e);if(n&&n.hu)return Ee().add(n.key);{let i=Ee();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}function tT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=X1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MM.bind(null,e),e.Pu.H_=EM.bind(null,e.eventManager),e.Pu.yu=TM.bind(null,e.eventManager),e}function UM(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$M.bind(null,e),e}class bu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ed(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return BD(this.persistence,new FD,e.initialUser,this.serializer)}Cu(e){return new L1(Mp.mi,this.serializer)}Du(e){return new ZD}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bu.provider={build:()=>new bu};class BM extends bu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ce(this.persistence.referenceDelegate instanceof yu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new AD(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?cr.withCacheSize(this.cacheSizeBytes):cr.DEFAULT;return new L1(n=>yu.mi(n,r),this.serializer)}}class nm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>rb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=FM.bind(null,this.syncEngine),await vM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new xM}()}createDatastore(e){const r=Ed(e.databaseInfo.databaseId),n=function(a){return new tM(a)}(e.databaseInfo);return function(a,s,o,l){return new aM(a,s,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new oM(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>rb(this.syncEngine,r,0),function(){return Z0.v()?new Z0:new XD}())}createSyncEngine(e,r){return function(i,a,s,o,l,c,u){const h=new kM(i,a,s,o,l,c);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ge(r);Y(Na,"RemoteStore shutting down."),n.Ea.add(5),await Al(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}nm.provider={build:()=>new nm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="FirestoreClient";class WM{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Qt.UNAUTHENTICATED,this.clientId=Ep.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Y(Vi,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Y(Vi,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Hp(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xh(t,e){t.asyncQueue.verifyOperationInProgress(),Y(Vi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await $1(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ib(t,e){t.asyncQueue.verifyOperationInProgress();const r=await qM(t);Y(Vi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Q0(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Q0(e.remoteStore,i)),t._onlineComponents=e}async function qM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(Vi,"Using user provided OfflineComponentProvider");try{await Xh(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Es("Error using user provided cache. Falling back to memory cache: "+r),await Xh(t,new bu)}}else Y(Vi,"Using default OfflineComponentProvider"),await Xh(t,new BM(void 0));return t._offlineComponents}async function rT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(Vi,"Using user provided OnlineComponentProvider"),await ib(t,t._uninitializedComponentsProvider._online)):(Y(Vi,"Using default OnlineComponentProvider"),await ib(t,new nm))),t._onlineComponents}function KM(t){return rT(t).then(e=>e.syncEngine)}async function GM(t){const e=await rT(t),r=e.eventManager;return r.onListen=CM.bind(null,e.syncEngine),r.onUnlisten=OM.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=NM.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=RM.bind(null,e.syncEngine),r}function YM(t,e,r={}){const n=new Ci;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,l,c){const u=new HM({next:m=>{u.Nu(),s.enqueueAndForget(()=>_M(a,h));const p=m.docs.has(o);!p&&m.fromCache?c.reject(new re(U.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&l&&l.source==="server"?c.reject(new re(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),h=new AM(Cp(o.path),u,{includeMetadataChanges:!0,qa:!0});return wM(a,h)}(await GM(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="firestore.googleapis.com",sb=!0;class ob{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=iT,this.ssl=sb}else this.host=e.host,this.ssl=e.ssl??sb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=M1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ED)throw new re(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nT(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Gp{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ob({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ob(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Y2;switch(n.type){case"firstParty":return new J2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new re(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=ab.get(r);n&&(Y("ComponentProvider","Removing Datastore"),ab.delete(r),n.terminate())}(this),Promise.resolve()}}function ZM(t,e,r,n={}){t=Go(t,Gp);const i=La(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(cp(`https://${o}`),up("Firestore",!0)),a.host!==iT&&a.host!==o&&Es("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...a,host:o,ssl:i,emulatorOptions:n};if(!Ia(l,s)&&(t._setSettings(l),n.mockUserToken)){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=Qt.MOCK_USER;else{c=rE(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new re(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Qt(h)}t._authCredentials=new Z2(new YE(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Yp(this.firestore,e,this._query)}}class kt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kt(this.firestore,e,this._key)}toJSON(){return{type:kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(_l(r,kt._jsonSchema))return new kt(e,n||null,new ae(Ze.fromString(r.referencePath)))}}kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:pt("string",kt._jsonSchemaVersion),referencePath:pt("string")};class tl extends Yp{constructor(e,r,n){super(e,r,Cp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kt(this.firestore,null,new ae(e))}withConverter(e){return new tl(this.firestore,e,this._path)}}function lb(t,e,...r){if(t=dr(t),arguments.length===1&&(e=Ep.newId()),aR("doc","path",e),t instanceof Gp){const n=Ze.fromString(e,...r);return w0(n),new kt(t,null,new ae(n))}{if(!(t instanceof kt||t instanceof tl))throw new re(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ze.fromString(e,...r));return w0(n),new kt(t.firestore,t instanceof tl?t.converter:null,new ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="AsyncQueue";class ub{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new F1(this,"async_queue_retry"),this._c=()=>{const n=Zh();n&&Y(cb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Zh();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Zh();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Ci;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Vs(e))throw e;Y(cb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Xn("INTERNAL UNHANDLED ERROR: ",db(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=Bp.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:db(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function db(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Zp extends Gp{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new ub,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ub(e),this._firestoreClient=void 0,await e}}}function XM(t,e){const r=typeof t=="object"?t:fp(),n=typeof t=="string"?t:uu,i=ud(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=J_("firestore");a&&ZM(i,...a)}return i}function aT(t){if(t._terminated)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||QM(t),t._firestoreClient}function QM(t){const e=t._freezeSettings(),r=function(i,a,s,o){return new yR(i,a,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,nT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new WM(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rr(Ht.fromBase64String(e))}catch(r){throw new re(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Rr(Ht.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Rr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(_l(e,Rr._jsonSchema))return Rr.fromBase64String(e.bytes)}}Rr._jsonSchemaVersion="firestore/bytes/1.0",Rr._jsonSchema={type:pt("string",Rr._jsonSchemaVersion),bytes:pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new re(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new re(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new re(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vn._jsonSchemaVersion}}static fromJSON(e){if(_l(e,vn._jsonSchema))return new vn(e.latitude,e.longitude)}}vn._jsonSchemaVersion="firestore/geoPoint/1.0",vn._jsonSchema={type:pt("string",vn._jsonSchemaVersion),latitude:pt("number"),longitude:pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:bn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(_l(e,bn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new bn(e.vectorValues);throw new re(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bn._jsonSchemaVersion="firestore/vectorValue/1.0",bn._jsonSchema={type:pt("string",bn._jsonSchemaVersion),vectorValues:pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM=/^__.*__$/;class e4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ua(e,this.data,this.fieldMask,r,this.fieldTransforms):new El(e,this.data,r,this.fieldTransforms)}}function oT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ac:t})}}class Qp{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return xu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(oT(this.Ac)&&JM.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class t4{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ed(e)}Cc(e,r,n,i=!1){return new Qp({Ac:e,methodName:r,Dc:n,path:zt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function r4(t){const e=t._freezeSettings(),r=Ed(t._databaseId);return new t4(t._databaseId,!!e.ignoreUndefinedProperties,r)}function n4(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);dT("Data must be an object, but it was:",s,n);const o=cT(n,s);let l,c;if(a.merge)l=new Xr(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=i4(e,h,r);if(!s.contains(m))throw new re(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);s4(u,m)||u.push(m)}l=new Xr(u),c=s.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=s.fieldTransforms;return new e4(new Or(o),l,c)}function lT(t,e){if(uT(t=dr(t)))return dT("Unsupported field value:",e,t),cT(t,e);if(t instanceof sT)return function(n,i){if(!oT(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let l=lT(o,i.wc(s));l==null&&(l={nullValue:"NULL_VALUE"}),a.push(l),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return zR(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=We.fromDate(n);return{timestampValue:gu(i.serializer,a)}}if(n instanceof We){const a=new We(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:gu(i.serializer,a)}}if(n instanceof vn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Rr)return{bytesValue:k1(i.serializer,n._byteString)};if(n instanceof kt){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Rp(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof bn)return function(s,o){return{mapValue:{fields:{[i1]:{stringValue:a1},[du]:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw o.Sc("VectorValues must only contain numeric values.");return Np(o.serializer,c)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Tp(n)}`)}(t,e)}function cT(t,e){const r={};return QE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fa(t,(n,i)=>{const a=lT(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function uT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof We||t instanceof vn||t instanceof Rr||t instanceof kt||t instanceof sT||t instanceof bn)}function dT(t,e,r){if(!uT(r)||!ZE(r)){const n=Tp(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function i4(t,e,r){if((e=dr(e))instanceof Xp)return e._internalPath;if(typeof e=="string")return hT(t,e);throw xu("Field path arguments must be of type string or ",t,!1,void 0,r)}const a4=new RegExp("[~\\*/\\[\\]]");function hT(t,e,r){if(e.search(a4)>=0)throw xu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Xp(...e.split("."))._internalPath}catch{throw xu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function xu(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=` in field ${n}`),s&&(l+=` in document ${i}`),l+=")"),new re(U.INVALID_ARGUMENT,o+t+l)}function s4(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new o4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(mT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class o4 extends fT{data(){return super.data()}}function mT(t,e){return typeof e=="string"?hT(t,e):e instanceof Xp?e._internalPath:e._delegate._internalPath}class l4{convertValue(e,r="none"){switch(Li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ot(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Fa(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){const r=e.fields?.[du].arrayValue?.values?.map(n=>ot(n.doubleValue));return new bn(r)}convertGeoPoint(e){return new vn(ot(e.latitude),ot(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=gd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zo(e));default:return null}}convertTimestamp(e){const r=Di(e);return new We(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ze.fromString(e);Ce(D1(n),9688,{name:e});const i=new Xo(n.get(1),n.get(3)),a=new ae(n.popFirst(5));return i.isEqual(r)||Xn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class So{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class va extends fT{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Wc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(mT("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=va._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}va._jsonSchemaVersion="firestore/documentSnapshot/1.0",va._jsonSchema={type:pt("string",va._jsonSchemaVersion),bundleSource:pt("string","DocumentSnapshot"),bundleName:pt("string"),bundle:pt("string")};class Wc extends va{data(e={}){return super.data(e)}}class Lo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new So(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Wc(this._firestore,this._userDataWriter,n.key,n,new So(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new re(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const l=new Wc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new So(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const l=new Wc(i._firestore,i._userDataWriter,o.doc.key,o.doc,new So(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,u=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:u4(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ep.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function u4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){t=Go(t,kt);const e=Go(t.firestore,Zp);return YM(aT(e),t._key).then(r=>m4(e,t,r))}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:pt("string",Lo._jsonSchemaVersion),bundleSource:pt("string","QuerySnapshot"),bundleName:pt("string"),bundle:pt("string")};class h4 extends l4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new kt(this.firestore,null,r)}}function hb(t,e,r){t=Go(t,kt);const n=Go(t.firestore,Zp),i=c4(t.converter,e);return f4(n,[n4(r4(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Wn.none())])}function f4(t,e){return function(n,i){const a=new Ci;return n.asyncQueue.enqueueAndForget(async()=>DM(await KM(n),i,a)),a.promise}(aT(t),e)}function m4(t,e,r){const n=r.docs.get(e._key),i=new h4(t);return new va(t,i,e._key,n,new So(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ls=i})($a),Sa(new Oi("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new Zp(new X2(n.getProvider("auth-internal")),new eR(s,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xo(c.options.projectId,u)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),fn(y0,v0,e),fn(y0,v0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="firebasestorage.googleapis.com",p4="storageBucket",g4=2*60*1e3,y4=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Pn{constructor(e,r,n=0){super(Qh(e),`Firebase Storage: ${r} (${Qh(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Qh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var An;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(An||(An={}));function Qh(t){return"storage/"+t}function v4(){const t="An unknown error occurred, please check the error payload for server response.";return new kn(An.UNKNOWN,t)}function b4(){return new kn(An.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function x4(){return new kn(An.CANCELED,"User canceled the upload/download.")}function w4(t){return new kn(An.INVALID_URL,"Invalid URL '"+t+"'.")}function _4(t){return new kn(An.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function fb(t){return new kn(An.INVALID_ARGUMENT,t)}function gT(){return new kn(An.APP_DELETED,"The Firebase app was deleted.")}function E4(t){return new kn(An.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qr.makeFromUrl(e,r)}catch{return new Qr(e,"")}if(n.path==="")return n;throw _4(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(O){O.path.charAt(O.path.length-1)==="/"&&(O.path_=O.path_.slice(0,-1))}const s="(/(.*))?$",o=new RegExp("^gs://"+i+s,"i"),l={bucket:1,path:3};function c(O){O.path_=decodeURIComponent(O.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${m}`,"i"),y={bucket:1,path:3},b=r===pT?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",_=new RegExp(`^https?://${b}/${i}/${g}`,"i"),E=[{regex:o,indices:l,postModify:a},{regex:p,indices:y,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let O=0;O<E.length;O++){const R=E[O],D=R.regex.exec(e);if(D){const I=D[R.indices.bucket];let A=D[R.indices.path];A||(A=""),n=new Qr(I,A),R.postModify(n);break}}if(n==null)throw w4(e);return n}}class T4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(t,e,r){let n=1,i=null,a=null,s=!1,o=0;function l(){return o===2}let c=!1;function u(...g){c||(c=!0,e.apply(null,g))}function h(g){i=setTimeout(()=>{i=null,t(p,l())},g)}function m(){a&&clearTimeout(a)}function p(g,..._){if(c){m();return}if(g){m(),u.call(null,g,..._);return}if(l()||s){m(),u.call(null,g,..._);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let y=!1;function b(g){y||(y=!0,m(),!c&&(i!==null?(g||(o=2),clearTimeout(i),h(0)):g||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,b(!0)},r),b}function I4(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(t){return t!==void 0}function mb(t,e,r,n){if(n<e)throw fb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw fb(`Invalid value for '${t}'. Expected ${r} or less.`)}function P4(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var wu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(wu||(wu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e,r,n,i,a,s,o,l,c,u,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,b)=>{this.resolve_=y,this.reject_=b,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new mc(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const s=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const o=a.getErrorCode()===wu.NO_ERROR,l=a.getStatus();if(!o||k4(l,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===wu.ABORT;n(!1,new mc(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new mc(c,a))})},r=(n,i)=>{const a=this.resolve_,s=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());S4(l)?a(l):a()}catch(l){s(l)}else if(o!==null){const l=v4();l.serverResponse=o.getErrorText(),this.errorCallback_?s(this.errorCallback_(o,l)):s(l)}else if(i.canceled){const l=this.appDelete_?gT():x4();s(l)}else{const l=b4();s(l)}};this.canceled_?r(!1,new mc(!1,null,!0)):this.backoffId_=A4(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&I4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mc{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function N4(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function j4(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function O4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function R4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function D4(t,e,r,n,i,a,s=!0,o=!1){const l=P4(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return O4(u,e),N4(u,r),j4(u,a),R4(u,n),new C4(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function L4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,r){this._service=e,r instanceof Qr?this._location=r:this._location=Qr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new _u(e,r)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return L4(this._location.path)}get storage(){return this._service}get parent(){const e=M4(this._location.path);if(e===null)return null;const r=new Qr(this._location.bucket,e);return new _u(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw E4(e)}}function pb(t,e){const r=e?.[p4];return r==null?null:Qr.makeFromBucketSpec(r,t)}function $4(t,e,r,n={}){t.host=`${e}:${r}`;const i=La(e);i&&(cp(`https://${t.host}/b`),up("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:rE(a,t.app.options.projectId))}class V4{constructor(e,r,n,i,a,s=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=s,this._bucket=null,this._host=pT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=g4,this._maxUploadRetryTime=y4,this._requests=new Set,i!=null?this._bucket=Qr.makeFromBucketSpec(i,this._host):this._bucket=pb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=pb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){mb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){mb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _u(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new T4(gT());{const s=D4(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const gb="@firebase/storage",yb="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="storage";function F4(t=fp(),e){t=dr(t);const n=ud(t,yT).getImmediate({identifier:e}),i=J_("storage");return i&&z4(n,...i),n}function z4(t,e,r,n={}){$4(t,e,r,n)}function U4(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new V4(r,n,i,e,$a)}function B4(){Sa(new Oi(yT,U4,"PUBLIC").setMultipleInstances(!0)),fn(gb,yb,""),fn(gb,yb,"esm2020")}B4();const H4={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0},Id=aE(H4);console.log("Firebase app initialized:",Id);const Po=K2(Id);console.log("Firebase auth instance:",Po);const vb=XM(Id);F4(Id);const Cn=sp((t,e)=>({user:null,initialized:!1,isLoading:!1,error:null,initialize:()=>{DO(Po,async r=>{try{if(r){console.log("[AUTH STORE] User authenticated:",r.uid);const n=lb(vb,"profiles",r.uid),i=await d4(n);if(i.exists()){const a=i.data();t(mt(s=>{s.user={id:r.uid,...a},s.initialized=!0,s.error=null,s.isLoading=!1}))}else{const a={id:r.uid,email:r.email,fullName:null,avatarUrl:null,preferences:{}};await hb(n,a),t(mt(s=>{s.user=a,s.initialized=!0,s.error=null,s.isLoading=!1}))}}else t(mt(n=>{n.user=null,n.initialized=!0,n.error=null,n.isLoading=!1}))}catch(n){console.error("[AUTH STORE] Error in auth state change:",n),t(mt(i=>{i.error=n instanceof Error?n.message:"Error de autenticación",i.initialized=!0,i.isLoading=!1}))}})},signIn:async(r,n)=>{try{t(mt(i=>{i.isLoading=!0,i.error=null})),console.log("[AUTH STORE] Attempting sign in with email:",r),await jO(Po,r,n)}catch(i){throw console.error("[AUTH STORE] Sign in error:",i),t(mt(a=>{a.error=i.message||"Error al iniciar sesión",a.isLoading=!1})),i}},signUp:async(r,n,i,a)=>{try{if(t(mt(l=>{l.isLoading=!0,l.error=null})),i&&n!==i)throw new Error("Las contraseñas no coinciden");const o=(await NO(Po,r,n)).user;if(o){const l={id:o.uid,email:o.email,fullName:a||null,avatarUrl:null,preferences:{}},c=lb(vb,"profiles",o.uid);await hb(c,l)}else throw new Error("Error al crear el usuario")}catch(s){throw console.error("[AUTH STORE] Sign up error:",s),t(mt(o=>{o.error=s.message||"Error al crear la cuenta",o.isLoading=!1})),s}},signOut:async()=>{try{t(mt(r=>{r.isLoading=!0,r.error=null})),await MO(Po)}catch(r){throw console.error("[AUTH STORE] Sign out error:",r),t(mt(n=>{n.error=r.message||"Error al cerrar sesión",n.isLoading=!1})),r}},clearError:()=>{t(mt(r=>{r.error=null}))}}));function W4(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const q4=t=>{switch(t){case"success":return Y4;case"info":return X4;case"warning":return Z4;case"error":return Q4;default:return null}},K4=Array(12).fill(0),G4=({visible:t,className:e})=>H.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},H.createElement("div",{className:"sonner-spinner"},K4.map((r,n)=>H.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Y4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Z4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),X4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Q4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),J4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},H.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),eL=()=>{const[t,e]=H.useState(document.hidden);return H.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let im=1;class tL{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,a=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:im++,s=this.toasts.find(l=>l.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(l=>l.id===a?(this.publish({...l,...e,id:a,title:n}),{...l,...e,id:a,dismissible:o,title:n}):l):this.addToast({title:n,...i,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let a=n!==void 0,s;const o=i.then(async c=>{if(s=["resolve",c],H.isValidElement(c))a=!1,this.create({id:n,type:"default",message:c});else if(nL(c)&&!c.ok){a=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${c.status}`):r.error,m=typeof r.description=="function"?await r.description(`HTTP error! status: ${c.status}`):r.description,y=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...y})}else if(c instanceof Error){a=!1;const h=typeof r.error=="function"?await r.error(c):r.error,m=typeof r.description=="function"?await r.description(c):r.description,y=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...y})}else if(r.success!==void 0){a=!1;const h=typeof r.success=="function"?await r.success(c):r.success,m=typeof r.description=="function"?await r.description(c):r.description,y=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:m,...y})}}).catch(async c=>{if(s=["reject",c],r.error!==void 0){a=!1;const u=typeof r.error=="function"?await r.error(c):r.error,h=typeof r.description=="function"?await r.description(c):r.description,p=typeof u=="object"&&!H.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:h,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),l=()=>new Promise((c,u)=>o.then(()=>s[0]==="reject"?u(s[1]):c(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:l}:Object.assign(n,{unwrap:l})},this.custom=(e,r)=>{const n=r?.id||im++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const or=new tL,rL=(t,e)=>{const r=e?.id||im++;return or.addToast({title:t,...e,id:r}),r},nL=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",iL=rL,aL=()=>or.toasts,sL=()=>or.getActiveToasts(),vT=Object.assign(iL,{success:or.success,info:or.info,warning:or.warning,error:or.error,custom:or.custom,message:or.message,promise:or.promise,dismiss:or.dismiss,loading:or.loading},{getHistory:aL,getToasts:sL});W4("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function pc(t){return t.label!==void 0}const oL=3,lL="24px",cL="16px",bb=4e3,uL=356,dL=14,hL=45,fL=200;function on(...t){return t.filter(Boolean).join(" ")}function mL(t){const[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}const pL=t=>{var e,r,n,i,a,s,o,l,c;const{invert:u,toast:h,unstyled:m,interacting:p,setHeights:y,visibleToasts:b,heights:g,index:_,toasts:T,expanded:E,removeToast:O,defaultRichColors:R,closeButton:D,style:I,cancelButtonStyle:A,actionButtonStyle:P,className:j="",descriptionClassName:N="",duration:k,position:C,gap:Q,expandByDefault:oe,classNames:X,icons:ee,closeButtonAriaLabel:he="Close toast"}=t,[ye,ze]=H.useState(null),[se,q]=H.useState(null),[J,tt]=H.useState(!1),[Ve,Fe]=H.useState(!1),[Pr,rn]=H.useState(!1),[G,de]=H.useState(!1),[be,B]=H.useState(!1),[ut,Te]=H.useState(0),[yt,vt]=H.useState(0),rr=H.useRef(h.duration||k||bb),Zi=H.useRef(null),kr=H.useRef(null),Zs=_===0,Fl=_+1<=b,nr=h.type,nn=h.dismissible!==!1,Xs=h.className||"",zl=h.descriptionClassName||"",it=H.useMemo(()=>g.findIndex(le=>le.toastId===h.id)||0,[g,h.id]),Ot=H.useMemo(()=>{var le;return(le=h.closeButton)!=null?le:D},[h.closeButton,D]),Xi=H.useMemo(()=>h.duration||k||bb,[h.duration,k]),Xa=H.useRef(0),Nn=H.useRef(0),Ul=H.useRef(0),Cr=H.useRef(null),[Bl,Hl]=C.split("-"),Qa=H.useMemo(()=>g.reduce((le,at,st)=>st>=it?le:le+at.height,0),[g,it]),Wl=eL(),Th=h.invert||u,Qi=nr==="loading";Nn.current=H.useMemo(()=>it*Q+Qa,[it,Qa]),H.useEffect(()=>{rr.current=Xi},[Xi]),H.useEffect(()=>{tt(!0)},[]),H.useEffect(()=>{const le=kr.current;if(le){const at=le.getBoundingClientRect().height;return vt(at),y(st=>[{toastId:h.id,height:at,position:h.position},...st]),()=>y(st=>st.filter(Kt=>Kt.toastId!==h.id))}},[y,h.id]),H.useLayoutEffect(()=>{if(!J)return;const le=kr.current,at=le.style.height;le.style.height="auto";const st=le.getBoundingClientRect().height;le.style.height=at,vt(st),y(Kt=>Kt.find(dt=>dt.toastId===h.id)?Kt.map(dt=>dt.toastId===h.id?{...dt,height:st}:dt):[{toastId:h.id,height:st,position:h.position},...Kt])},[J,h.title,h.description,y,h.id,h.jsx,h.action,h.cancel]);const Hr=H.useCallback(()=>{Fe(!0),Te(Nn.current),y(le=>le.filter(at=>at.toastId!==h.id)),setTimeout(()=>{O(h)},fL)},[h,O,y,Nn]);H.useEffect(()=>{if(h.promise&&nr==="loading"||h.duration===1/0||h.type==="loading")return;let le;return E||p||Wl?(()=>{if(Ul.current<Xa.current){const Kt=new Date().getTime()-Xa.current;rr.current=rr.current-Kt}Ul.current=new Date().getTime()})():(()=>{rr.current!==1/0&&(Xa.current=new Date().getTime(),le=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),Hr()},rr.current))})(),()=>clearTimeout(le)},[E,p,h,nr,Wl,Hr]),H.useEffect(()=>{h.delete&&(Hr(),h.onDismiss==null||h.onDismiss.call(h,h))},[Hr,h.delete]);function ql(){var le;if(ee?.loading){var at;return H.createElement("div",{className:on(X?.loader,h==null||(at=h.classNames)==null?void 0:at.loader,"sonner-loader"),"data-visible":nr==="loading"},ee.loading)}return H.createElement(G4,{className:on(X?.loader,h==null||(le=h.classNames)==null?void 0:le.loader),visible:nr==="loading"})}const Ji=h.icon||ee?.[nr]||q4(nr);var Ja,es;return H.createElement("li",{tabIndex:0,ref:kr,className:on(j,Xs,X?.toast,h==null||(e=h.classNames)==null?void 0:e.toast,X?.default,X?.[nr],h==null||(r=h.classNames)==null?void 0:r[nr]),"data-sonner-toast":"","data-rich-colors":(Ja=h.richColors)!=null?Ja:R,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":J,"data-promise":!!h.promise,"data-swiped":be,"data-removed":Ve,"data-visible":Fl,"data-y-position":Bl,"data-x-position":Hl,"data-index":_,"data-front":Zs,"data-swiping":Pr,"data-dismissible":nn,"data-type":nr,"data-invert":Th,"data-swipe-out":G,"data-swipe-direction":se,"data-expanded":!!(E||oe&&J),style:{"--index":_,"--toasts-before":_,"--z-index":T.length-_,"--offset":`${Ve?ut:Nn.current}px`,"--initial-height":oe?"auto":`${yt}px`,...I,...h.style},onDragEnd:()=>{rn(!1),ze(null),Cr.current=null},onPointerDown:le=>{le.button!==2&&(Qi||!nn||(Zi.current=new Date,Te(Nn.current),le.target.setPointerCapture(le.pointerId),le.target.tagName!=="BUTTON"&&(rn(!0),Cr.current={x:le.clientX,y:le.clientY})))},onPointerUp:()=>{var le,at,st;if(G||!nn)return;Cr.current=null;const Kt=Number(((le=kr.current)==null?void 0:le.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),an=Number(((at=kr.current)==null?void 0:at.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),dt=new Date().getTime()-((st=Zi.current)==null?void 0:st.getTime()),Oe=ye==="x"?Kt:an,ea=Math.abs(Oe)/dt;if(Math.abs(Oe)>=hL||ea>.11){Te(Nn.current),h.onDismiss==null||h.onDismiss.call(h,h),q(ye==="x"?Kt>0?"right":"left":an>0?"down":"up"),Hr(),de(!0);return}else{var Rt,Dt;(Rt=kr.current)==null||Rt.style.setProperty("--swipe-amount-x","0px"),(Dt=kr.current)==null||Dt.style.setProperty("--swipe-amount-y","0px")}B(!1),rn(!1),ze(null)},onPointerMove:le=>{var at,st,Kt;if(!Cr.current||!nn||((at=window.getSelection())==null?void 0:at.toString().length)>0)return;const dt=le.clientY-Cr.current.y,Oe=le.clientX-Cr.current.x;var ea;const Rt=(ea=t.swipeDirections)!=null?ea:mL(C);!ye&&(Math.abs(Oe)>1||Math.abs(dt)>1)&&ze(Math.abs(Oe)>Math.abs(dt)?"x":"y");let Dt={x:0,y:0};const Kl=jn=>1/(1.5+Math.abs(jn)/20);if(ye==="y"){if(Rt.includes("top")||Rt.includes("bottom"))if(Rt.includes("top")&&dt<0||Rt.includes("bottom")&&dt>0)Dt.y=dt;else{const jn=dt*Kl(dt);Dt.y=Math.abs(jn)<Math.abs(dt)?jn:dt}}else if(ye==="x"&&(Rt.includes("left")||Rt.includes("right")))if(Rt.includes("left")&&Oe<0||Rt.includes("right")&&Oe>0)Dt.x=Oe;else{const jn=Oe*Kl(Oe);Dt.x=Math.abs(jn)<Math.abs(Oe)?jn:Oe}(Math.abs(Dt.x)>0||Math.abs(Dt.y)>0)&&B(!0),(st=kr.current)==null||st.style.setProperty("--swipe-amount-x",`${Dt.x}px`),(Kt=kr.current)==null||Kt.style.setProperty("--swipe-amount-y",`${Dt.y}px`)}},Ot&&!h.jsx&&nr!=="loading"?H.createElement("button",{"aria-label":he,"data-disabled":Qi,"data-close-button":!0,onClick:Qi||!nn?()=>{}:()=>{Hr(),h.onDismiss==null||h.onDismiss.call(h,h)},className:on(X?.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(es=ee?.close)!=null?es:J4):null,(nr||h.icon||h.promise)&&h.icon!==null&&(ee?.[nr]!==null||h.icon)?H.createElement("div",{"data-icon":"",className:on(X?.icon,h==null||(i=h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||ql():null,h.type!=="loading"?Ji:null):null,H.createElement("div",{"data-content":"",className:on(X?.content,h==null||(a=h.classNames)==null?void 0:a.content)},H.createElement("div",{"data-title":"",className:on(X?.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?H.createElement("div",{"data-description":"",className:on(N,zl,X?.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),H.isValidElement(h.cancel)?h.cancel:h.cancel&&pc(h.cancel)?H.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||A,onClick:le=>{pc(h.cancel)&&nn&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,le),Hr())},className:on(X?.cancelButton,h==null||(l=h.classNames)==null?void 0:l.cancelButton)},h.cancel.label):null,H.isValidElement(h.action)?h.action:h.action&&pc(h.action)?H.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:le=>{pc(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,le),!le.defaultPrevented&&Hr())},className:on(X?.actionButton,h==null||(c=h.classNames)==null?void 0:c.actionButton)},h.action.label):null)};function xb(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function gL(t,e){const r={};return[t,e].forEach((n,i)=>{const a=i===1,s=a?"--mobile-offset":"--offset",o=a?cL:lL;function l(c){["top","right","bottom","left"].forEach(u=>{r[`${s}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(c=>{n[c]===void 0?r[`${s}-${c}`]=o:r[`${s}-${c}`]=typeof n[c]=="number"?`${n[c]}px`:n[c]}):l(o)}),r}const yL=H.forwardRef(function(e,r){const{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:o,className:l,offset:c,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:y,visibleToasts:b=oL,toastOptions:g,dir:_=xb(),gap:T=dL,icons:E,containerAriaLabel:O="Notifications"}=e,[R,D]=H.useState([]),I=H.useMemo(()=>Array.from(new Set([i].concat(R.filter(se=>se.position).map(se=>se.position)))),[R,i]),[A,P]=H.useState([]),[j,N]=H.useState(!1),[k,C]=H.useState(!1),[Q,oe]=H.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=H.useRef(null),ee=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),he=H.useRef(null),ye=H.useRef(!1),ze=H.useCallback(se=>{D(q=>{var J;return(J=q.find(tt=>tt.id===se.id))!=null&&J.delete||or.dismiss(se.id),q.filter(({id:tt})=>tt!==se.id)})},[]);return H.useEffect(()=>or.subscribe(se=>{if(se.dismiss){requestAnimationFrame(()=>{D(q=>q.map(J=>J.id===se.id?{...J,delete:!0}:J))});return}setTimeout(()=>{fC.flushSync(()=>{D(q=>{const J=q.findIndex(tt=>tt.id===se.id);return J!==-1?[...q.slice(0,J),{...q[J],...se},...q.slice(J+1)]:[se,...q]})})})}),[R]),H.useEffect(()=>{if(h!=="system"){oe(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?oe("dark"):oe("light")),typeof window>"u")return;const se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:q})=>{oe(q?"dark":"light")})}catch{se.addListener(({matches:J})=>{try{oe(J?"dark":"light")}catch(tt){console.error(tt)}})}},[h]),H.useEffect(()=>{R.length<=1&&N(!1)},[R]),H.useEffect(()=>{const se=q=>{var J;if(a.every(Fe=>q[Fe]||q.code===Fe)){var Ve;N(!0),(Ve=X.current)==null||Ve.focus()}q.code==="Escape"&&(document.activeElement===X.current||(J=X.current)!=null&&J.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),H.useEffect(()=>{if(X.current)return()=>{he.current&&(he.current.focus({preventScroll:!0}),he.current=null,ye.current=!1)}},[X.current]),H.createElement("section",{ref:r,"aria-label":`${O} ${ee}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},I.map((se,q)=>{var J;const[tt,Ve]=se.split("-");return R.length?H.createElement("ol",{key:se,dir:_==="auto"?xb():_,tabIndex:-1,ref:X,className:l,"data-sonner-toaster":!0,"data-sonner-theme":Q,"data-y-position":tt,"data-x-position":Ve,style:{"--front-toast-height":`${((J=A[0])==null?void 0:J.height)||0}px`,"--width":`${uL}px`,"--gap":`${T}px`,...y,...gL(c,u)},onBlur:Fe=>{ye.current&&!Fe.currentTarget.contains(Fe.relatedTarget)&&(ye.current=!1,he.current&&(he.current.focus({preventScroll:!0}),he.current=null))},onFocus:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,he.current=Fe.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{k||N(!1)},onDragEnd:()=>N(!1),onPointerDown:Fe=>{Fe.target instanceof HTMLElement&&Fe.target.dataset.dismissible==="false"||C(!0)},onPointerUp:()=>C(!1)},R.filter(Fe=>!Fe.position&&q===0||Fe.position===se).map((Fe,Pr)=>{var rn,G;return H.createElement(pL,{key:Fe.id,icons:E,index:Pr,toast:Fe,defaultRichColors:m,duration:(rn=g?.duration)!=null?rn:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:n,visibleToasts:b,closeButton:(G=g?.closeButton)!=null?G:o,interacting:k,position:se,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:ze,toasts:R.filter(de=>de.position==Fe.position),heights:A.filter(de=>de.position==Fe.position),setHeights:P,expandByDefault:s,gap:T,expanded:j,swipeDirections:e.swipeDirections})})):null}))}),Jp=w.createContext(void 0),vL={success:Un,error:vC,warning:Lr,info:tp,ai:ep,camera:_n,plant:ml,sync:S_},bL={success:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:"text-green-500",title:"text-green-800 dark:text-green-200",message:"text-green-700 dark:text-green-300"},error:{bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",icon:"text-red-500",title:"text-red-800 dark:text-red-200",message:"text-red-700 dark:text-red-300"},warning:{bg:"bg-amber-50 dark:bg-amber-900/20",border:"border-amber-200 dark:border-amber-800",icon:"text-amber-500",title:"text-amber-800 dark:text-amber-200",message:"text-amber-700 dark:text-amber-300"},info:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",icon:"text-blue-500",title:"text-blue-800 dark:text-blue-200",message:"text-blue-700 dark:text-blue-300"},ai:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",icon:"text-purple-500",title:"text-purple-800 dark:text-purple-200",message:"text-purple-700 dark:text-purple-300"},camera:{bg:"bg-indigo-50 dark:bg-indigo-900/20",border:"border-indigo-200 dark:border-indigo-800",icon:"text-indigo-500",title:"text-indigo-800 dark:text-indigo-200",message:"text-indigo-700 dark:text-indigo-300"},plant:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:"text-green-500",title:"text-green-800 dark:text-green-200",message:"text-green-700 dark:text-green-300"},sync:{bg:"bg-gray-50 dark:bg-gray-900/20",border:"border-gray-200 dark:border-gray-800",icon:"text-gray-500",title:"text-gray-800 dark:text-gray-200",message:"text-gray-700 dark:text-gray-300"}},xL=({children:t})=>{const[e,r]=w.useState([]),n=()=>Math.random().toString(36).substring(2,9),i=w.useCallback(p=>{const y=n(),b={id:y,duration:5e3,...p};return r(g=>[...g,b]),!b.persistent&&b.duration&&b.duration>0&&setTimeout(()=>{a(y)},b.duration),y},[]),a=w.useCallback(p=>{r(y=>y.filter(b=>b.id!==p))},[]),s=w.useCallback(()=>{r([])},[]),o=w.useCallback((p,y,b)=>i({type:"success",title:p,message:y,...b}),[i]),l=w.useCallback((p,y,b)=>i({type:"error",title:p,message:y,duration:8e3,...b}),[i]),c=w.useCallback((p,y,b)=>i({type:"warning",title:p,message:y,duration:6e3,...b}),[i]),u=w.useCallback((p,y,b)=>i({type:"info",title:p,message:y,...b}),[i]),h=w.useCallback((p,y,b)=>i({type:"ai",title:p,message:y,...b}),[i]),m={toasts:e,addToast:i,removeToast:a,clearAll:s,showSuccess:o,showError:l,showWarning:c,showInfo:u,showAI:h};return d.jsxs(Jp.Provider,{value:m,children:[t,d.jsx(wL,{})]})},wL=()=>{const t=w.useContext(Jp);if(!t)return null;const{toasts:e,removeToast:r}=t;return d.jsx("div",{className:"fixed top-4 right-4 z-[9999] space-y-2 max-w-sm w-full",children:d.jsx(ke,{children:e.map(n=>d.jsx(_L,{toast:n,onRemove:r},n.id))})})},_L=({toast:t,onRemove:e})=>{const r=t.icon||vL[t.type],n=bL[t.type];return d.jsx(L.div,{initial:{opacity:0,x:300,scale:.95},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.95},transition:{duration:.2,ease:"easeOut"},className:`
        ${n.bg} ${n.border}
        border rounded-lg p-4 shadow-lg backdrop-blur-sm
        max-w-sm w-full
      `,children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:`${n.icon} flex-shrink-0 mt-0.5`,children:d.jsx(r,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:`${n.title} text-sm font-medium mb-1`,children:t.title}),t.message&&d.jsx("p",{className:`${n.message} text-sm leading-relaxed`,children:t.message}),t.actions&&t.actions.length>0&&d.jsx("div",{className:"flex gap-2 mt-3",children:t.actions.map((i,a)=>d.jsx("button",{onClick:()=>{i.onClick(),e(t.id)},className:`
                    text-xs font-medium px-2 py-1 rounded transition-colors
                    ${i.variant==="primary"?`${n.icon} bg-white/20 hover:bg-white/30`:`${n.message} hover:${n.title}`}
                  `,children:i.label},a))})]}),d.jsx("button",{onClick:()=>e(t.id),className:`${n.icon} hover:opacity-70 transition-opacity flex-shrink-0`,"aria-label":"Cerrar notificación",children:d.jsx(ni,{className:"w-4 h-4"})})]})})},YJ=()=>{const t=w.useContext(Jp);if(!t)throw new Error("useToast must be used within a ToastProvider");return t};class EL{constructor(){qr(this,"listeners",new Set)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}success(e,r,n){this.emit({type:"success",title:e,message:r,duration:n})}error(e,r,n){this.emit({type:"error",title:e,message:r,duration:n})}warning(e,r,n){this.emit({type:"warning",title:e,message:r,duration:n})}info(e,r,n){this.emit({type:"info",title:e,message:r,duration:n})}}const Sd=new EL,bT=w.createContext(void 0),zs=()=>{const t=w.useContext(bT);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},TL=t=>{switch(t){case"success":return d.jsx(Un,{size:20,className:"text-green-500"});case"error":return d.jsx(Lr,{size:20,className:"text-red-500"});case"warning":return d.jsx(Jr,{size:20,className:"text-yellow-500"});case"info":return d.jsx(tp,{size:20,className:"text-blue-500"})}},AL=t=>{switch(t){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800";case"warning":return"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800";case"info":return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800"}},IL=({children:t})=>{const[e,r]=w.useState([]),n=w.useCallback(s=>{const o=`toast-${Date.now()}-${Math.random()}`,l={id:o,duration:5e3,...s};r(c=>[...c,l]),l.duration!==0&&setTimeout(()=>{i(o)},l.duration)},[]);w.useEffect(()=>Sd.subscribe(o=>{n(o)}),[n]);const i=w.useCallback(s=>{r(o=>o.filter(l=>l.id!==s))},[]),a=w.useCallback(()=>{r([])},[]);return d.jsxs(bT.Provider,{value:{toasts:e,addToast:n,removeToast:i,clearToasts:a},children:[t,d.jsx(SL,{})]})},SL=()=>{const{toasts:t,removeToast:e}=zs();return d.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:d.jsx(ke,{children:t.map(r=>d.jsx(L.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{type:"spring",damping:25,stiffness:300},className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${AL(r.type)}`,role:"alert","aria-live":"assertive",tabIndex:0,children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"flex-shrink-0 mt-0.5",children:TL(r.type)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.title}),r.message&&d.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r.message})]}),d.jsx("button",{onClick:()=>e(r.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Cerrar notificación",children:d.jsx(ni,{size:16})})]})},r.id))})})},yi={QUERY:{STALE_TIME:{MEDIUM:1e3*60*15},GC_TIME:{MEDIUM:1e3*60*30,LONG:1e3*60*60},RETRY:{COUNT:1,DELAY:1e3}}},so={measureTime:async(t,e)=>typeof e=="function"?await e():e,markStart:t=>{},markEnd:t=>{},debounce:(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(void 0,n),e)}},throttle:(t,e)=>{let r;return(...n)=>{r||(t.apply(void 0,n),r=!0,setTimeout(()=>r=!1,e))}}},PL=()=>(w.useEffect(()=>{},[]),{measureTime:so.measureTime,markStart:so.markStart,markEnd:so.markEnd,debounce:so.debounce,throttle:so.throttle}),kL=()=>{const t=()=>{const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`),typeof CSS<"u"&&CSS.supports&&CSS.supports("padding","env(safe-area-inset-top)")?(document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-bottom","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)")):(document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-bottom","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px"))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(t,100)}),"visualViewport"in window&&window.visualViewport?.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),"visualViewport"in window&&window.visualViewport?.removeEventListener("resize",t)}};const CL=()=>{const[t,e]=w.useState({isOnline:navigator.onLine});return w.useEffect(()=>{const r=()=>{const o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e({isOnline:navigator.onLine,connectionType:o?.type,effectiveType:o?.effectiveType,downlink:o?.downlink,rtt:o?.rtt})},n=()=>{console.log("[Network] Connection restored"),r()},i=()=>{console.log("[Network] Connection lost"),r()},a=()=>{console.log("[Network] Connection changed"),r()};r(),window.addEventListener("online",n),window.addEventListener("offline",i);const s=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return s&&s.addEventListener("change",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i),s&&s.removeEventListener("change",a)}},[]),t},NL=()=>{const t=CL();return{...t,quality:(()=>{if(!t.isOnline)return"offline";if(t.effectiveType)switch(t.effectiveType){case"4g":return"fast";case"3g":return"slow";case"2g":return"slow";case"slow-2g":return"slow";default:return"fast"}return t.downlink!==void 0?t.downlink>1.5?"fast":"slow":"fast"})()}},jL=()=>{const[t,e]=w.useState(!1);NL();const{user:r,initialized:n}=Cn();return null},OL=()=>{},eg=(t,e)=>{console.error(`[CRITICAL][${t}]`,e),console.warn("Production error detected:",{context:t,error:e})};function xT(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=xT(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Me(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=xT(t))&&(n&&(n+=" "),n+=e);return n}const tg="-",RL=t=>{const e=ML(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(tg);return o[0]===""&&o.length!==1&&o.shift(),wT(o,e)||DL(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},wT=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?wT(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(tg);return e.validators.find(({validator:s})=>s(a))?.classGroupId},wb=/^\[(.+)\]$/,DL=t=>{if(wb.test(t)){const e=wb.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},ML=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return $L(Object.entries(t.classGroups),r).forEach(([a,s])=>{am(s,n,a,e)}),n},am=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:_b(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(LL(i)){am(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{am(s,_b(e,a),r,n)})})},_b=(t,e)=>{let r=t;return e.split(tg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},LL=t=>t.isThemeGetter,$L=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,VL=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},_T="!",FL=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let c=0,u=0,h;for(let g=0;g<o.length;g++){let _=o[g];if(c===0){if(_===i&&(n||o.slice(g,g+a)===e)){l.push(o.slice(u,g)),u=g+a;continue}if(_==="/"){h=g;continue}}_==="["?c++:_==="]"&&c--}const m=l.length===0?o:o.substring(u),p=m.startsWith(_T),y=p?m.substring(1):m,b=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},zL=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},UL=t=>({cache:VL(t.cacheSize),parseClassName:FL(t),...RL(t)}),BL=/\s+/,HL=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(BL);let o="";for(let l=s.length-1;l>=0;l-=1){const c=s[l],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=r(c);let y=!!p,b=n(y?m.substring(0,p):m);if(!b){if(!y){o=c+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=c+(o.length>0?" "+o:o);continue}y=!1}const g=zL(u).join(":"),_=h?g+_T:g,T=_+b;if(a.includes(T))continue;a.push(T);const E=i(b,y);for(let O=0;O<E.length;++O){const R=E[O];a.push(_+R)}o=c+(o.length>0?" "+o:o)}return o};function WL(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=ET(e))&&(n&&(n+=" "),n+=r);return n}const ET=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=ET(t[n]))&&(r&&(r+=" "),r+=e);return r};function qL(t,...e){let r,n,i,a=s;function s(l){const c=e.reduce((u,h)=>h(u),t());return r=UL(c),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=HL(l,r);return i(l,u),u}return function(){return a(WL.apply(null,arguments))}}const Be=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},TT=/^\[(?:([a-z-]+):)?(.+)\]$/i,KL=/^\d+\/\d+$/,GL=new Set(["px","full","screen"]),YL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ZL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,XL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,QL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,JL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Dn=t=>vs(t)||GL.has(t)||KL.test(t),fi=t=>Us(t,"length",o$),vs=t=>!!t&&!Number.isNaN(Number(t)),Jh=t=>Us(t,"number",vs),oo=t=>!!t&&Number.isInteger(Number(t)),e$=t=>t.endsWith("%")&&vs(t.slice(0,-1)),ve=t=>TT.test(t),mi=t=>YL.test(t),t$=new Set(["length","size","percentage"]),r$=t=>Us(t,t$,AT),n$=t=>Us(t,"position",AT),i$=new Set(["image","url"]),a$=t=>Us(t,i$,c$),s$=t=>Us(t,"",l$),lo=()=>!0,Us=(t,e,r)=>{const n=TT.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},o$=t=>ZL.test(t)&&!XL.test(t),AT=()=>!1,l$=t=>QL.test(t),c$=t=>JL.test(t),u$=()=>{const t=Be("colors"),e=Be("spacing"),r=Be("blur"),n=Be("brightness"),i=Be("borderColor"),a=Be("borderRadius"),s=Be("borderSpacing"),o=Be("borderWidth"),l=Be("contrast"),c=Be("grayscale"),u=Be("hueRotate"),h=Be("invert"),m=Be("gap"),p=Be("gradientColorStops"),y=Be("gradientColorStopPositions"),b=Be("inset"),g=Be("margin"),_=Be("opacity"),T=Be("padding"),E=Be("saturate"),O=Be("scale"),R=Be("sepia"),D=Be("skew"),I=Be("space"),A=Be("translate"),P=()=>["auto","contain","none"],j=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",ve,e],k=()=>[ve,e],C=()=>["",Dn,fi],Q=()=>["auto",vs,ve],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>["start","end","center","between","around","evenly","stretch"],ye=()=>["","0",ve],ze=()=>["auto","avoid","all","avoid-page","page","left","right","column"],se=()=>[vs,ve];return{cacheSize:500,separator:":",theme:{colors:[lo],spacing:[Dn,fi],blur:["none","",mi,ve],brightness:se(),borderColor:[t],borderRadius:["none","","full",mi,ve],borderSpacing:k(),borderWidth:C(),contrast:se(),grayscale:ye(),hueRotate:se(),invert:ye(),gap:k(),gradientColorStops:[t],gradientColorStopPositions:[e$,fi],inset:N(),margin:N(),opacity:se(),padding:k(),saturate:se(),scale:se(),sepia:ye(),skew:se(),space:k(),translate:k()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[mi]}],"break-after":[{"break-after":ze()}],"break-before":[{"break-before":ze()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),ve]}],overflow:[{overflow:j()}],"overflow-x":[{"overflow-x":j()}],"overflow-y":[{"overflow-y":j()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",oo,ve]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",oo,ve]}],"grid-cols":[{"grid-cols":[lo]}],"col-start-end":[{col:["auto",{span:["full",oo,ve]},ve]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[lo]}],"row-start-end":[{row:["auto",{span:[oo,ve]},ve]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...he()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...he(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...he(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ve,e]}],"min-w":[{"min-w":[ve,e,"min","max","fit"]}],"max-w":[{"max-w":[ve,e,"none","full","min","max","fit","prose",{screen:[mi]},mi]}],h:[{h:[ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",mi,fi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Jh]}],"font-family":[{font:[lo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",vs,Jh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Dn,ve]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Dn,fi]}],"underline-offset":[{"underline-offset":["auto",Dn,ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:k()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),n$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",r$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},a$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:X()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Dn,ve]}],"outline-w":[{outline:[Dn,fi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:C()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Dn,fi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",mi,s$]}],"shadow-color":[{shadow:[lo]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",mi,ve]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:se()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:se()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[O]}],"scale-x":[{"scale-x":[O]}],"scale-y":[{"scale-y":[O]}],rotate:[{rotate:[oo,ve]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":k()}],"scroll-mx":[{"scroll-mx":k()}],"scroll-my":[{"scroll-my":k()}],"scroll-ms":[{"scroll-ms":k()}],"scroll-me":[{"scroll-me":k()}],"scroll-mt":[{"scroll-mt":k()}],"scroll-mr":[{"scroll-mr":k()}],"scroll-mb":[{"scroll-mb":k()}],"scroll-ml":[{"scroll-ml":k()}],"scroll-p":[{"scroll-p":k()}],"scroll-px":[{"scroll-px":k()}],"scroll-py":[{"scroll-py":k()}],"scroll-ps":[{"scroll-ps":k()}],"scroll-pe":[{"scroll-pe":k()}],"scroll-pt":[{"scroll-pt":k()}],"scroll-pr":[{"scroll-pr":k()}],"scroll-pb":[{"scroll-pb":k()}],"scroll-pl":[{"scroll-pl":k()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Dn,fi,Jh]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},d$=qL(u$),IT=void 0,h$=void 0;throw new Error("Missing Supabase environment variables");const _t=mC(IT,h$,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"plantitas-app"}},realtime:{timeout:1e4}}),f$=Object.freeze(Object.defineProperty({__proto__:null,supabase:_t,supabaseUrl:IT},Symbol.toStringTag,{value:"Module"}));function je(...t){return d$(Me(t))}const xt={auth:"/auth",dashboard:"/",camera:"/camera",settings:"/settings",gardenChat:"/garden-chat",plantDetail:t=>`/plant/${t}`,plantChat:t=>`/plant/${t}/chat`},At={toDashboard:()=>xt.dashboard,toCamera:()=>xt.camera,toSettings:()=>xt.settings,toGardenChat:()=>xt.gardenChat,toPlantDetail:t=>xt.plantDetail(t),toPlantChat:t=>xt.plantChat(t),toAuth:()=>xt.auth},m$=(t,e)=>t===e?!0:e===xt.dashboard?t==="/"||t.startsWith("/plant/"):e===xt.gardenChat?t===xt.gardenChat||t.includes("/chat")||t.includes("/garden-chat"):e===xt.settings?t.startsWith("/settings"):!1;let gc;const p$=new Uint8Array(16);function g$(){if(!gc&&(gc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!gc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gc(p$)}const Lt=[];for(let t=0;t<256;++t)Lt.push((t+256).toString(16).slice(1));function y$(t,e=0){return Lt[t[e+0]]+Lt[t[e+1]]+Lt[t[e+2]]+Lt[t[e+3]]+"-"+Lt[t[e+4]]+Lt[t[e+5]]+"-"+Lt[t[e+6]]+Lt[t[e+7]]+"-"+Lt[t[e+8]]+Lt[t[e+9]]+"-"+Lt[t[e+10]]+Lt[t[e+11]]+Lt[t[e+12]]+Lt[t[e+13]]+Lt[t[e+14]]+Lt[t[e+15]]}const v$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Eb={randomUUID:v$};function b$(t,e,r){if(Eb.randomUUID&&!t)return Eb.randomUUID();t=t||{};const n=t.random||(t.rng||g$)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,y$(n)}const ST=5,x$=ST*1024*1024,PT=t=>{if(!t||typeof t!="string")throw new Error("URL de imagen inválida");const e=t.split(",")[1];if(!e)throw new Error("Formato de imagen inválido");const r=e.length*3/4;if(r>x$){const n=(r/1048576).toFixed(1);throw new Error(`La imagen es demasiado grande (${n}MB). El límite máximo es ${ST}MB. Por favor, usa una imagen más pequeña.`)}console.log(`[imageService] Image size validation passed: ${(r/(1024*1024)).toFixed(2)}MB`)},w$=t=>{if(!t||typeof t!="string")throw new Error("Invalid data URL: input is not a string");if(!t.startsWith("data:"))throw new Error('Invalid data URL: does not start with "data:"');const e=t.split(",");if(e.length!==2)throw new Error("Invalid data URL: incorrect format");const r=e[0].match(/:(.*?);/);if(!r)throw new Error("Invalid data URL: could not extract MIME type");const n=r[1];if(!n.startsWith("image/"))throw new Error(`Invalid data URL: not an image MIME type (${n})`);try{const i=atob(e[1]);let a=i.length;const s=new Uint8Array(a);for(;a--;)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}catch(i){throw new Error(`Invalid data URL: failed to decode base64 data - ${i instanceof Error?i.message:"Unknown error"}`)}},kT=async(t,e,r)=>{try{PT(t);const n=w$(t),i=n.type.split("/")[1],a=`${r}/${b$()}.${i}`,{error:s}=await _t.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(s)throw console.error("Error uploading image to Supabase Storage:",s),new Error(`Storage error: ${s.message}`);const{data:o}=_t.storage.from(e).getPublicUrl(a);if(!o||!o.publicUrl)throw new Error("Could not get public URL for uploaded image.");return o.publicUrl}catch(n){throw console.error("Failed to upload image:",n),n instanceof Error?new Error(`Image upload failed: ${n.message}`):new Error("An unknown error occurred during image upload.")}};function F(t,e,r){function n(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(t),e(o,l);for(const u in s.prototype)u in o||Object.defineProperty(o,u,{value:s.prototype[u].bind(o)});o._zod.constr=s,o._zod.def=l}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var l;const c=r?.Parent?new a:this;n(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}class rl extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const CT={};function ja(t){return CT}function _$(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function E$(t,e){return typeof e=="bigint"?e.toString():e}function NT(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function rg(t){return t==null}function ng(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function T$(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}function Ke(t,e,r){Object.defineProperty(t,e,{get(){{const n=r();return t[e]=n,n}},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function ig(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function co(t){return JSON.stringify(t)}const jT=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function sm(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const A$=NT(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function om(t){if(sm(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(sm(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const I$=new Set(["string","number","symbol"]);function Pd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ha(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function ne(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function S$(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const P$={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function k$(t,e){const r={},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Ha(t,{...t._zod.def,shape:r,checks:[]})}function C$(t,e){const r={...t._zod.def.shape},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Ha(t,{...t._zod.def,shape:r,checks:[]})}function N$(t,e){if(!om(e))throw new Error("Invalid input to extend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return ig(this,"shape",n),n},checks:[]};return Ha(t,r)}function j$(t,e){return Ha(t,{...t._zod.def,get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return ig(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function O$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in n))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=t?new t({type:"optional",innerType:n[a]}):n[a])}else for(const a in n)i[a]=t?new t({type:"optional",innerType:n[a]}):n[a];return Ha(e,{...e._zod.def,shape:i,checks:[]})}function R$(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=new t({type:"nonoptional",innerType:n[a]}))}else for(const a in n)i[a]=new t({type:"nonoptional",innerType:n[a]});return Ha(e,{...e._zod.def,shape:i,checks:[]})}function $o(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function ag(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function yc(t){return typeof t=="string"?t:t?.message}function Oa(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=yc(t.inst?._zod.def?.error?.(t))??yc(e?.error?.(t))??yc(r.customError?.(t))??yc(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function sg(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function nl(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}const OT=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,E$,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},RT=F("$ZodError",OT),DT=F("$ZodError",OT,{Parent:Error});function D$(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function M$(t,e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(r(s));else{let o=n,l=0;for(;l<s.path.length;){const c=s.path[l];l===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(s))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(t),n}const L$=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new rl;if(s.issues.length){const o=new(i?.Err??t)(s.issues.map(l=>Oa(l,a,ja())));throw jT(o,i?.callee),o}return s.value},$$=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new(i?.Err??t)(s.issues.map(l=>Oa(l,a,ja())));throw jT(o,i?.callee),o}return s.value},MT=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new rl;return a.issues.length?{success:!1,error:new(t??RT)(a.issues.map(s=>Oa(s,i,ja())))}:{success:!0,data:a.value}},V$=MT(DT),LT=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>Oa(s,i,ja())))}:{success:!0,data:a.value}},F$=LT(DT),z$=/^[cC][^\s-]{8,}$/,U$=/^[0-9a-z]+$/,B$=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,H$=/^[0-9a-vA-V]{20}$/,W$=/^[A-Za-z0-9]{27}$/,q$=/^[a-zA-Z0-9_-]{21}$/,K$=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,G$=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Tb=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,Y$=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Z$="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function X$(){return new RegExp(Z$,"u")}const Q$=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,J$=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,e5=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,t5=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,r5=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,$T=/^[A-Za-z0-9_-]*$/,n5=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,i5=/^\+(?:[0-9]){6,14}[0-9]$/,VT="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",a5=new RegExp(`^${VT}$`);function FT(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function s5(t){return new RegExp(`^${FT(t)}$`)}function o5(t){const e=FT({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${VT}T(?:${n})$`)}const l5=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},c5=/^\d+$/,u5=/^-?\d+(?:\.\d+)?/i,d5=/true|false/i,h5=/^[^A-Z]*$/,f5=/^[^a-z]*$/,hr=F("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),zT={number:"number",bigint:"bigint",object:"date"},UT=F("$ZodCheckLessThan",(t,e)=>{hr.init(t,e);const r=zT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),BT=F("$ZodCheckGreaterThan",(t,e)=>{hr.init(t,e);const r=zT[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),m5=F("$ZodCheckMultipleOf",(t,e)=>{hr.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):T$(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),p5=F("$ZodCheckNumberFormat",(t,e)=>{hr.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=P$[e.format];t._zod.onattach.push(s=>{const o=s._zod.bag;o.format=e.format,o.minimum=i,o.maximum=a,r&&(o.pattern=c5)}),t._zod.check=s=>{const o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:n,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}o<i&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:t})}}),g5=F("$ZodCheckMaxLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!rg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const s=sg(i);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),y5=F("$ZodCheckMinLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!rg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const s=sg(i);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),v5=F("$ZodCheckLengthEquals",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!rg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const s=sg(i),o=a>e.length;n.issues.push({origin:s,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),kd=F("$ZodCheckStringFormat",(t,e)=>{var r,n;hr.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),b5=F("$ZodCheckRegex",(t,e)=>{kd.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),x5=F("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=h5),kd.init(t,e)}),w5=F("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=f5),kd.init(t,e)}),_5=F("$ZodCheckIncludes",(t,e)=>{hr.init(t,e);const r=Pd(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),E5=F("$ZodCheckStartsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`^${Pd(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),T5=F("$ZodCheckEndsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`.*${Pd(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),A5=F("$ZodCheckOverwrite",(t,e)=>{hr.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class I5{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(s=>s),i=Math.min(...n.map(s=>s.length-s.trimStart().length)),a=n.map(s=>s.slice(i)).map(s=>" ".repeat(this.indent*2)+s);for(const s of a)this.content.push(s)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const S5={major:4,minor:0,patch:5},Qe=F("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=S5;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,s,o)=>{let l=$o(a),c;for(const u of s){if(u._zod.def.when){if(!u._zod.def.when(a))continue}else if(l)continue;const h=a.issues.length,m=u._zod.check(a);if(m instanceof Promise&&o?.async===!1)throw new rl;if(c||m instanceof Promise)c=(c??Promise.resolve()).then(async()=>{await m,a.issues.length!==h&&(l||(l=$o(a,h)))});else{if(a.issues.length===h)continue;l||(l=$o(a,h))}}return c?c.then(()=>a):a};t._zod.run=(a,s)=>{const o=t._zod.parse(a,s);if(o instanceof Promise){if(s.async===!1)throw new rl;return o.then(l=>i(l,n,s))}return i(o,n,s)}}t["~standard"]={validate:i=>{try{const a=V$(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return F$(t,i).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),og=F("$ZodString",(t,e)=>{Qe.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??l5(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Ye=F("$ZodStringFormat",(t,e)=>{kd.init(t,e),og.init(t,e)}),P5=F("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=G$),Ye.init(t,e)}),k5=F("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Tb(n))}else e.pattern??(e.pattern=Tb());Ye.init(t,e)}),C5=F("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Y$),Ye.init(t,e)}),N5=F("$ZodURL",(t,e)=>{Ye.init(t,e),t._zod.check=r=>{try{const n=r.value,i=new URL(n),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:n5.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),j5=F("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=X$()),Ye.init(t,e)}),O5=F("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=q$),Ye.init(t,e)}),R5=F("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=z$),Ye.init(t,e)}),D5=F("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=U$),Ye.init(t,e)}),M5=F("$ZodULID",(t,e)=>{e.pattern??(e.pattern=B$),Ye.init(t,e)}),L5=F("$ZodXID",(t,e)=>{e.pattern??(e.pattern=H$),Ye.init(t,e)}),$5=F("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=W$),Ye.init(t,e)}),V5=F("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=o5(e)),Ye.init(t,e)}),F5=F("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=a5),Ye.init(t,e)}),z5=F("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=s5(e)),Ye.init(t,e)}),U5=F("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=K$),Ye.init(t,e)}),B5=F("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Q$),Ye.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),H5=F("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=J$),Ye.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),W5=F("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=e5),Ye.init(t,e)}),q5=F("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=t5),Ye.init(t,e),t._zod.check=r=>{const[n,i]=r.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function HT(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const K5=F("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=r5),Ye.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{HT(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function G5(t){if(!$T.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return HT(r)}const Y5=F("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=$T),Ye.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{G5(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),Z5=F("$ZodE164",(t,e)=>{e.pattern??(e.pattern=i5),Ye.init(t,e)});function X5(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const Q5=F("$ZodJWT",(t,e)=>{Ye.init(t,e),t._zod.check=r=>{X5(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),WT=F("$ZodNumber",(t,e)=>{Qe.init(t,e),t._zod.pattern=t._zod.bag.pattern??u5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),J5=F("$ZodNumber",(t,e)=>{p5.init(t,e),WT.init(t,e)}),eV=F("$ZodBoolean",(t,e)=>{Qe.init(t,e),t._zod.pattern=d5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),tV=F("$ZodUnknown",(t,e)=>{Qe.init(t,e),t._zod.parse=r=>r}),rV=F("$ZodNever",(t,e)=>{Qe.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),nV=F("$ZodDate",(t,e)=>{Qe.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function Ab(t,e,r){t.issues.length&&e.issues.push(...ag(r,t.issues)),e.value[r]=t.value}const iV=F("$ZodArray",(t,e)=>{Qe.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let s=0;s<i.length;s++){const o=i[s],l=e.element._zod.run({value:o,issues:[]},n);l instanceof Promise?a.push(l.then(c=>Ab(c,r,s))):Ab(l,r,s)}return a.length?Promise.all(a).then(()=>r):r}});function vc(t,e,r){t.issues.length&&e.issues.push(...ag(r,t.issues)),e.value[r]=t.value}function Ib(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...ag(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}const aV=F("$ZodObject",(t,e)=>{Qe.init(t,e);const r=NT(()=>{const h=Object.keys(e.shape);for(const p of h)if(!(e.shape[p]instanceof Qe))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const m=S$(e.shape);return{shape:e.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(m)}});Ke(t._zod,"propValues",()=>{const h=e.shape,m={};for(const p in h){const y=h[p]._zod;if(y.values){m[p]??(m[p]=new Set);for(const b of y.values)m[p].add(b)}}return m});const n=h=>{const m=new I5(["shape","payload","ctx"]),p=r.value,y=T=>{const E=co(T);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};m.write("const input = payload.value;");const b=Object.create(null);let g=0;for(const T of p.keys)b[T]=`key_${g++}`;m.write("const newResult = {}");for(const T of p.keys)if(p.optionalKeys.has(T)){const E=b[T];m.write(`const ${E} = ${y(T)};`);const O=co(T);m.write(`
        if (${E}.issues.length) {
          if (input[${O}] === undefined) {
            if (${O} in input) {
              newResult[${O}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${O}, ...iss.path] : [${O}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${O} in input) newResult[${O}] = undefined;
        } else {
          newResult[${O}] = ${E}.value;
        }
        `)}else{const E=b[T];m.write(`const ${E} = ${y(T)};`),m.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${co(T)}, ...iss.path] : [${co(T)}]
          })));`),m.write(`newResult[${co(T)}] = ${E}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const _=m.compile();return(T,E)=>_(h,T,E)};let i;const a=sm,s=!CT.jitless,l=s&&A$.value,c=e.catchall;let u;t._zod.parse=(h,m)=>{u??(u=r.value);const p=h.value;if(!a(p))return h.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),h;const y=[];if(s&&l&&m?.async===!1&&m.jitless!==!0)i||(i=n(e.shape)),h=i(h,m);else{h.value={};const E=u.shape;for(const O of u.keys){const R=E[O],D=R._zod.run({value:p[O],issues:[]},m),I=R._zod.optin==="optional"&&R._zod.optout==="optional";D instanceof Promise?y.push(D.then(A=>I?Ib(A,h,O,p):vc(A,h,O))):I?Ib(D,h,O,p):vc(D,h,O)}}if(!c)return y.length?Promise.all(y).then(()=>h):h;const b=[],g=u.keySet,_=c._zod,T=_.def.type;for(const E of Object.keys(p)){if(g.has(E))continue;if(T==="never"){b.push(E);continue}const O=_.run({value:p[E],issues:[]},m);O instanceof Promise?y.push(O.then(R=>vc(R,h,E))):vc(O,h,E)}return b.length&&h.issues.push({code:"unrecognized_keys",keys:b,input:p,inst:t}),y.length?Promise.all(y).then(()=>h):h}});function Sb(t,e,r,n){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(a=>Oa(a,n,ja())))}),e}const sV=F("$ZodUnion",(t,e)=>{Qe.init(t,e),Ke(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ke(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ke(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Ke(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>ng(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let i=!1;const a=[];for(const s of e.options){const o=s._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)a.push(o),i=!0;else{if(o.issues.length===0)return o;a.push(o)}}return i?Promise.all(a).then(s=>Sb(s,r,t,n)):Sb(a,r,t,n)}}),oV=F("$ZodIntersection",(t,e)=>{Qe.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),s=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||s instanceof Promise?Promise.all([a,s]).then(([l,c])=>Pb(r,l,c)):Pb(r,a,s)}});function lm(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(om(t)&&om(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const s=lm(t[a],e[a]);if(!s.valid)return{valid:!1,mergeErrorPath:[a,...s.mergeErrorPath]};i[a]=s.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],s=lm(i,a);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Pb(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),$o(t))return t;const n=lm(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const lV=F("$ZodEnum",(t,e)=>{Qe.init(t,e);const r=_$(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>I$.has(typeof n)).map(n=>typeof n=="string"?Pd(n):n.toString()).join("|")})$`),t._zod.parse=(n,i)=>{const a=n.value;return t._zod.values.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:t}),n}}),cV=F("$ZodTransform",(t,e)=>{Qe.init(t,e),t._zod.parse=(r,n)=>{const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(s=>(r.value=s,r));if(i instanceof Promise)throw new rl;return r.value=i,r}}),uV=F("$ZodOptional",(t,e)=>{Qe.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ke(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ke(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${ng(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),dV=F("$ZodNullable",(t,e)=>{Qe.init(t,e),Ke(t._zod,"optin",()=>e.innerType._zod.optin),Ke(t._zod,"optout",()=>e.innerType._zod.optout),Ke(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${ng(r.source)}|null)$`):void 0}),Ke(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),hV=F("$ZodDefault",(t,e)=>{Qe.init(t,e),t._zod.optin="optional",Ke(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>kb(a,e)):kb(i,e)}});function kb(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const fV=F("$ZodPrefault",(t,e)=>{Qe.init(t,e),t._zod.optin="optional",Ke(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),mV=F("$ZodNonOptional",(t,e)=>{Qe.init(t,e),Ke(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Cb(a,t)):Cb(i,t)}});function Cb(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const pV=F("$ZodCatch",(t,e)=>{Qe.init(t,e),t._zod.optin="optional",Ke(t._zod,"optout",()=>e.innerType._zod.optout),Ke(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(s=>Oa(s,n,ja()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>Oa(a,n,ja()))},input:r.value}),r.issues=[]),r)}}),gV=F("$ZodPipe",(t,e)=>{Qe.init(t,e),Ke(t._zod,"values",()=>e.in._zod.values),Ke(t._zod,"optin",()=>e.in._zod.optin),Ke(t._zod,"optout",()=>e.out._zod.optout),Ke(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>Nb(a,e,n)):Nb(i,e,n)}});function Nb(t,e,r){return $o(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}const yV=F("$ZodReadonly",(t,e)=>{Qe.init(t,e),Ke(t._zod,"propValues",()=>e.innerType._zod.propValues),Ke(t._zod,"values",()=>e.innerType._zod.values),Ke(t._zod,"optin",()=>e.innerType._zod.optin),Ke(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(jb):jb(i)}});function jb(t){return t.value=Object.freeze(t.value),t}const vV=F("$ZodCustom",(t,e)=>{hr.init(t,e),Qe.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>Ob(a,r,n,t));Ob(i,r,n,t)}});function Ob(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(nl(i))}}class bV{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function xV(){return new bV}const bc=xV();function wV(t,e){return new t({type:"string",...ne(e)})}function _V(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ne(e)})}function Rb(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ne(e)})}function EV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ne(e)})}function TV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ne(e)})}function AV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ne(e)})}function IV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ne(e)})}function SV(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ne(e)})}function PV(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ne(e)})}function kV(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ne(e)})}function CV(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ne(e)})}function NV(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ne(e)})}function jV(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ne(e)})}function OV(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ne(e)})}function RV(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ne(e)})}function DV(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ne(e)})}function MV(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ne(e)})}function LV(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ne(e)})}function $V(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ne(e)})}function VV(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ne(e)})}function FV(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ne(e)})}function zV(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ne(e)})}function UV(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ne(e)})}function BV(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ne(e)})}function HV(t,e){return new t({type:"string",format:"date",check:"string_format",...ne(e)})}function WV(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ne(e)})}function qV(t,e){return new t({type:"string",format:"duration",check:"string_format",...ne(e)})}function KV(t,e){return new t({type:"number",checks:[],...ne(e)})}function GV(t,e){return new t({type:"number",coerce:!0,checks:[],...ne(e)})}function YV(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ne(e)})}function ZV(t,e){return new t({type:"boolean",...ne(e)})}function XV(t){return new t({type:"unknown"})}function QV(t,e){return new t({type:"never",...ne(e)})}function JV(t,e){return new t({type:"date",...ne(e)})}function Db(t,e){return new UT({check:"less_than",...ne(e),value:t,inclusive:!1})}function qc(t,e){return new UT({check:"less_than",...ne(e),value:t,inclusive:!0})}function Mb(t,e){return new BT({check:"greater_than",...ne(e),value:t,inclusive:!1})}function Kc(t,e){return new BT({check:"greater_than",...ne(e),value:t,inclusive:!0})}function Lb(t,e){return new m5({check:"multiple_of",...ne(e),value:t})}function qT(t,e){return new g5({check:"max_length",...ne(e),maximum:t})}function Eu(t,e){return new y5({check:"min_length",...ne(e),minimum:t})}function KT(t,e){return new v5({check:"length_equals",...ne(e),length:t})}function e6(t,e){return new b5({check:"string_format",format:"regex",...ne(e),pattern:t})}function t6(t){return new x5({check:"string_format",format:"lowercase",...ne(t)})}function r6(t){return new w5({check:"string_format",format:"uppercase",...ne(t)})}function n6(t,e){return new _5({check:"string_format",format:"includes",...ne(e),includes:t})}function i6(t,e){return new E5({check:"string_format",format:"starts_with",...ne(e),prefix:t})}function a6(t,e){return new T5({check:"string_format",format:"ends_with",...ne(e),suffix:t})}function Sl(t){return new A5({check:"overwrite",tx:t})}function s6(t){return Sl(e=>e.normalize(t))}function o6(){return Sl(t=>t.trim())}function l6(){return Sl(t=>t.toLowerCase())}function c6(){return Sl(t=>t.toUpperCase())}function u6(t,e,r){return new t({type:"array",element:e,...ne(r)})}function d6(t,e,r){return new t({type:"custom",check:"custom",fn:e,...ne(r)})}const h6=F("ZodISODateTime",(t,e)=>{V5.init(t,e),Je.init(t,e)});function f6(t){return BV(h6,t)}const m6=F("ZodISODate",(t,e)=>{F5.init(t,e),Je.init(t,e)});function p6(t){return HV(m6,t)}const g6=F("ZodISOTime",(t,e)=>{z5.init(t,e),Je.init(t,e)});function y6(t){return WV(g6,t)}const v6=F("ZodISODuration",(t,e)=>{U5.init(t,e),Je.init(t,e)});function b6(t){return qV(v6,t)}const GT=(t,e)=>{RT.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>M$(t,r)},flatten:{value:r=>D$(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},x6=F("ZodError",GT),Cd=F("ZodError",GT,{Parent:Error}),w6=L$(Cd),_6=$$(Cd),E6=MT(Cd),T6=LT(Cd),ct=F("ZodType",(t,e)=>(Qe.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ha(t,r,n),t.brand=()=>t,t.register=(r,n)=>(r.add(t,n),t),t.parse=(r,n)=>w6(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>E6(t,r,n),t.parseAsync=async(r,n)=>_6(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>T6(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(g3(r,n)),t.superRefine=r=>t.check(y3(r)),t.overwrite=r=>t.check(Sl(r)),t.optional=()=>zb(t),t.nullable=()=>Ub(t),t.nullish=()=>zb(Ub(t)),t.nonoptional=r=>l3(t,r),t.array=()=>_e(t),t.or=r=>Q6([t,r]),t.and=r=>e3(t,r),t.transform=r=>Bb(t,r3(r)),t.default=r=>a3(t,r),t.prefault=r=>o3(t,r),t.catch=r=>u3(t,r),t.pipe=r=>Bb(t,r),t.readonly=()=>f3(t),t.describe=r=>{const n=t.clone();return bc.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return bc.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return bc.get(t);const n=t.clone();return bc.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),YT=F("_ZodString",(t,e)=>{og.init(t,e),ct.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(e6(...n)),t.includes=(...n)=>t.check(n6(...n)),t.startsWith=(...n)=>t.check(i6(...n)),t.endsWith=(...n)=>t.check(a6(...n)),t.min=(...n)=>t.check(Eu(...n)),t.max=(...n)=>t.check(qT(...n)),t.length=(...n)=>t.check(KT(...n)),t.nonempty=(...n)=>t.check(Eu(1,...n)),t.lowercase=n=>t.check(t6(n)),t.uppercase=n=>t.check(r6(n)),t.trim=()=>t.check(o6()),t.normalize=(...n)=>t.check(s6(...n)),t.toLowerCase=()=>t.check(l6()),t.toUpperCase=()=>t.check(c6())}),A6=F("ZodString",(t,e)=>{og.init(t,e),YT.init(t,e),t.email=r=>t.check(_V(I6,r)),t.url=r=>t.check(SV(S6,r)),t.jwt=r=>t.check(UV(U6,r)),t.emoji=r=>t.check(PV(P6,r)),t.guid=r=>t.check(Rb($b,r)),t.uuid=r=>t.check(EV(xc,r)),t.uuidv4=r=>t.check(TV(xc,r)),t.uuidv6=r=>t.check(AV(xc,r)),t.uuidv7=r=>t.check(IV(xc,r)),t.nanoid=r=>t.check(kV(k6,r)),t.guid=r=>t.check(Rb($b,r)),t.cuid=r=>t.check(CV(C6,r)),t.cuid2=r=>t.check(NV(N6,r)),t.ulid=r=>t.check(jV(j6,r)),t.base64=r=>t.check(VV(V6,r)),t.base64url=r=>t.check(FV(F6,r)),t.xid=r=>t.check(OV(O6,r)),t.ksuid=r=>t.check(RV(R6,r)),t.ipv4=r=>t.check(DV(D6,r)),t.ipv6=r=>t.check(MV(M6,r)),t.cidrv4=r=>t.check(LV(L6,r)),t.cidrv6=r=>t.check($V($6,r)),t.e164=r=>t.check(zV(z6,r)),t.datetime=r=>t.check(f6(r)),t.date=r=>t.check(p6(r)),t.time=r=>t.check(y6(r)),t.duration=r=>t.check(b6(r))});function K(t){return wV(A6,t)}const Je=F("ZodStringFormat",(t,e)=>{Ye.init(t,e),YT.init(t,e)}),I6=F("ZodEmail",(t,e)=>{C5.init(t,e),Je.init(t,e)}),$b=F("ZodGUID",(t,e)=>{P5.init(t,e),Je.init(t,e)}),xc=F("ZodUUID",(t,e)=>{k5.init(t,e),Je.init(t,e)}),S6=F("ZodURL",(t,e)=>{N5.init(t,e),Je.init(t,e)}),P6=F("ZodEmoji",(t,e)=>{j5.init(t,e),Je.init(t,e)}),k6=F("ZodNanoID",(t,e)=>{O5.init(t,e),Je.init(t,e)}),C6=F("ZodCUID",(t,e)=>{R5.init(t,e),Je.init(t,e)}),N6=F("ZodCUID2",(t,e)=>{D5.init(t,e),Je.init(t,e)}),j6=F("ZodULID",(t,e)=>{M5.init(t,e),Je.init(t,e)}),O6=F("ZodXID",(t,e)=>{L5.init(t,e),Je.init(t,e)}),R6=F("ZodKSUID",(t,e)=>{$5.init(t,e),Je.init(t,e)}),D6=F("ZodIPv4",(t,e)=>{B5.init(t,e),Je.init(t,e)}),M6=F("ZodIPv6",(t,e)=>{H5.init(t,e),Je.init(t,e)}),L6=F("ZodCIDRv4",(t,e)=>{W5.init(t,e),Je.init(t,e)}),$6=F("ZodCIDRv6",(t,e)=>{q5.init(t,e),Je.init(t,e)}),V6=F("ZodBase64",(t,e)=>{K5.init(t,e),Je.init(t,e)}),F6=F("ZodBase64URL",(t,e)=>{Y5.init(t,e),Je.init(t,e)}),z6=F("ZodE164",(t,e)=>{Z5.init(t,e),Je.init(t,e)}),U6=F("ZodJWT",(t,e)=>{Q5.init(t,e),Je.init(t,e)}),lg=F("ZodNumber",(t,e)=>{WT.init(t,e),ct.init(t,e),t.gt=(n,i)=>t.check(Mb(n,i)),t.gte=(n,i)=>t.check(Kc(n,i)),t.min=(n,i)=>t.check(Kc(n,i)),t.lt=(n,i)=>t.check(Db(n,i)),t.lte=(n,i)=>t.check(qc(n,i)),t.max=(n,i)=>t.check(qc(n,i)),t.int=n=>t.check(Vb(n)),t.safe=n=>t.check(Vb(n)),t.positive=n=>t.check(Mb(0,n)),t.nonnegative=n=>t.check(Kc(0,n)),t.negative=n=>t.check(Db(0,n)),t.nonpositive=n=>t.check(qc(0,n)),t.multipleOf=(n,i)=>t.check(Lb(n,i)),t.step=(n,i)=>t.check(Lb(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Ra(t){return KV(lg,t)}const B6=F("ZodNumberFormat",(t,e)=>{J5.init(t,e),lg.init(t,e)});function Vb(t){return YV(B6,t)}const H6=F("ZodBoolean",(t,e)=>{eV.init(t,e),ct.init(t,e)});function ZT(t){return ZV(H6,t)}const W6=F("ZodUnknown",(t,e)=>{tV.init(t,e),ct.init(t,e)});function Fb(){return XV(W6)}const q6=F("ZodNever",(t,e)=>{rV.init(t,e),ct.init(t,e)});function K6(t){return QV(q6,t)}const G6=F("ZodDate",(t,e)=>{nV.init(t,e),ct.init(t,e),t.min=(n,i)=>t.check(Kc(n,i)),t.max=(n,i)=>t.check(qc(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function xn(t){return JV(G6,t)}const Y6=F("ZodArray",(t,e)=>{iV.init(t,e),ct.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Eu(r,n)),t.nonempty=r=>t.check(Eu(1,r)),t.max=(r,n)=>t.check(qT(r,n)),t.length=(r,n)=>t.check(KT(r,n)),t.unwrap=()=>t.element});function _e(t,e){return u6(Y6,t,e)}const Z6=F("ZodObject",(t,e)=>{aV.init(t,e),ct.init(t,e),Ke(t,"shape",()=>e.shape),t.keyof=()=>Re(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Fb()}),t.loose=()=>t.clone({...t._zod.def,catchall:Fb()}),t.strict=()=>t.clone({...t._zod.def,catchall:K6()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>N$(t,r),t.merge=r=>j$(t,r),t.pick=r=>k$(t,r),t.omit=r=>C$(t,r),t.partial=(...r)=>O$(XT,t,r[0]),t.required=(...r)=>R$(QT,t,r[0])});function Pe(t,e){const r={type:"object",get shape(){return ig(this,"shape",{...t}),this.shape},...ne(e)};return new Z6(r)}const X6=F("ZodUnion",(t,e)=>{sV.init(t,e),ct.init(t,e),t.options=e.options});function Q6(t,e){return new X6({type:"union",options:t,...ne(e)})}const J6=F("ZodIntersection",(t,e)=>{oV.init(t,e),ct.init(t,e)});function e3(t,e){return new J6({type:"intersection",left:t,right:e})}const cm=F("ZodEnum",(t,e)=>{lV.init(t,e),ct.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const s of n)if(r.has(s))a[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new cm({...e,checks:[],...ne(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const s of n)if(r.has(s))delete a[s];else throw new Error(`Key ${s} not found in enum`);return new cm({...e,checks:[],...ne(i),entries:a})}});function Re(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new cm({type:"enum",entries:r,...ne(e)})}const t3=F("ZodTransform",(t,e)=>{cV.init(t,e),ct.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=a=>{if(typeof a=="string")r.issues.push(nl(a,r.value,e));else{const s=a;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!0),r.issues.push(nl(s))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function r3(t){return new t3({type:"transform",transform:t})}const XT=F("ZodOptional",(t,e)=>{uV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType});function zb(t){return new XT({type:"optional",innerType:t})}const n3=F("ZodNullable",(t,e)=>{dV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Ub(t){return new n3({type:"nullable",innerType:t})}const i3=F("ZodDefault",(t,e)=>{hV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function a3(t,e){return new i3({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const s3=F("ZodPrefault",(t,e)=>{fV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType});function o3(t,e){return new s3({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const QT=F("ZodNonOptional",(t,e)=>{mV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType});function l3(t,e){return new QT({type:"nonoptional",innerType:t,...ne(e)})}const c3=F("ZodCatch",(t,e)=>{pV.init(t,e),ct.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function u3(t,e){return new c3({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const d3=F("ZodPipe",(t,e)=>{gV.init(t,e),ct.init(t,e),t.in=e.in,t.out=e.out});function Bb(t,e){return new d3({type:"pipe",in:t,out:e})}const h3=F("ZodReadonly",(t,e)=>{yV.init(t,e),ct.init(t,e)});function f3(t){return new h3({type:"readonly",innerType:t})}const m3=F("ZodCustom",(t,e)=>{vV.init(t,e),ct.init(t,e)});function p3(t){const e=new hr({check:"custom"});return e._zod.check=t,e}function g3(t,e={}){return d6(m3,t,e)}function y3(t){const e=p3(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(nl(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(nl(i))}},t(r.value,r)));return e}function dn(t){return GV(lg,t)}const JT=Pe({type:Re(["overwatering","underwatering","pest","disease","nutrient","light","other"]),severity:Re(["low","medium","high"]),description:K().min(1),treatment:K().min(1)}),eA=Pe({overallHealth:Re(["excellent","good","fair","poor"]),issues:_e(JT),recommendations:_e(K()),moistureLevel:dn().min(0).max(100),growthStage:Re(["seedling","juvenile","mature","flowering","dormant"]),confidence:dn().min(0).max(100)}),tA=Pe({wateringFrequency:dn().positive(),sunlightRequirement:Re(["low","medium","high"]),humidityPreference:Re(["low","medium","high"]),temperatureRange:Pe({min:dn(),max:dn()}),fertilizingFrequency:dn().positive(),soilType:K().min(1),specialCare:_e(K()).optional()}),rA=Pe({traits:_e(K()).min(1),communicationStyle:Re(["cheerful","wise","dramatic","calm","playful"]),catchphrases:_e(K()),moodFactors:Pe({health:dn().min(0).max(1),care:dn().min(0).max(1),attention:dn().min(0).max(1)})}),v3=Pe({species:K(),commonName:K(),variety:K().nullable().optional(),confidence:dn().min(0).max(100),generalDescription:K().min(20),funFacts:_e(K()),plantEnvironment:Re(["interior","exterior","ambos"]),lightRequirements:Re(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]),health:eA,careProfile:tA,personality:rA}),nA=Pe({type:Re(["info","warning","tip","alert"]),title:K(),message:K()}),b3=_e(nA),x3=Object.freeze(Object.defineProperty({__proto__:null,AIAnalysisResponseSchema:v3,CareProfileSchema:tA,HealthAnalysisSchema:eA,HealthIssueSchema:JT,InsightResponseSchema:b3,InsightSchema:nA,PlantPersonalitySchema:rA},Symbol.toStringTag,{value:"Module"})),{HealthAnalysisSchema:w3,CareProfileSchema:_3,PlantPersonalitySchema:E3,InsightResponseSchema:T3}=x3,A3=Pe({id:K().min(1,"Image ID is required"),url:K().url("Must be a valid URL"),timestamp:xn(),healthAnalysis:w3.optional(),isProfileImage:ZT()}),I3=Pe({id:K().min(1,"Message ID is required"),sender:Re(["user","plant","system"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),emotion:Re(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]).optional(),context:Pe({insights:_e(Pe({type:Re(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Pe({action:K(),priority:Re(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),S3=Pe({id:K().min(1,"Notification ID is required"),type:Re(["watering","fertilizing","health_check","general"]),title:K().min(1,"Title is required"),message:K().min(1,"Message is required"),priority:Re(["low","medium","high"]),scheduledFor:xn(),completed:ZT()}),P3=Pe({id:K().uuid(),name:K(),species:K(),variety:K().optional(),nickname:K().optional(),description:K().optional(),funFacts:_e(K()).optional(),location:K(),plantEnvironment:Re(["interior","exterior","ambos"]).optional(),lightRequirements:Re(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),dateAdded:xn(),lastWatered:xn().optional(),lastFertilized:xn().optional(),images:_e(A3),healthScore:Ra().min(0).max(100),careProfile:_3,personality:E3,chatHistory:_e(I3),notifications:_e(S3)}),k3=Pe({id:K().min(1,"Plant ID is required"),name:K().min(1,"Plant name is required"),nickname:K().optional(),species:K().min(1,"Species is required"),location:K().min(1,"Location is required"),plantEnvironment:Re(["interior","exterior","ambos"]).optional(),lightRequirements:Re(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),healthScore:Ra().min(0).max(100),profileImageUrl:K().url().optional(),lastWatered:xn().optional(),wateringFrequency:Ra().positive().optional()});Pe({content:K(),emotion:Re(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]),mood:K().optional()});Pe({changes:_e(K()),healthImprovement:Ra(),recommendations:_e(K()),newHealthScore:Ra().min(0).max(100)});P3.omit({id:!0,dateAdded:!0,chatHistory:!0,notifications:!0}).partial({images:!0,healthScore:!0,careProfile:!0,personality:!0});Pe({fullName:K().min(3,"El nombre debe tener al menos 3 caracteres"),email:K().email("Email inválido"),password:K().min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:K().min(6)}).refine(t=>t.password===t.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});Pe({email:K().email(),password:K().min(1,"Password is required")});const C3=Pe({id:K().min(1,"Message ID is required"),sender:Re(["user","ai"]),content:K().min(1,"Message content cannot be empty"),timestamp:xn(),context:Pe({plantsAnalyzed:_e(K()).optional(),queryType:Re(["general","health_analysis","care_comparison","disease_prevention","growth_tracking"]).optional(),insights:_e(Pe({type:Re(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Pe({action:K(),priority:Re(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),N3=Pe({totalPlants:Ra(),plantsData:_e(k3),averageHealthScore:Ra(),commonIssues:_e(K()),careScheduleSummary:Pe({needsWatering:_e(K()),needsFertilizing:_e(K()),healthConcerns:_e(K())}),environmentalFactors:Pe({locations:_e(K()),lightConditions:_e(K()),humidityNeeds:_e(K())})});Pe({id:K().uuid(),userId:K().uuid(),messages:_e(C3),createdAt:xn(),updatedAt:xn(),context:N3.optional()});Pe({content:K().min(1),insights:_e(Pe({type:Re(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Pe({action:K(),priority:Re(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()});const j3=async t=>{try{const{data:{session:e},error:r}=await _t.auth.getSession();if(r||!e?.access_token)throw console.error("User session not available:",r),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:n,error:i}=await _t.functions.invoke("generate-plant-insights",{body:{plant:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i)throw new Error(`Failed to generate insights: ${i.message}`);return T3.parse(n)}catch(e){throw console.error("[insightService] Error generating insights:",e),e instanceof x6?new Error(`Invalid data structure for insights: ${e.message}`):e}},iA=async t=>{PT(t);const{data:{session:e},error:r}=await _t.auth.getSession();if(r||!e)throw new Error("User must be authenticated to analyze images");const{data:n,error:i}=await _t.functions.invoke("analyze-image",{body:{imageDataUrl:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i){if(console.error("Error invoking analyze-image function:",i),i.message?.includes("unsupported image"))throw new Error("La imagen no es válida. Por favor, asegúrate de que sea una foto clara de una planta.");if(i.message?.includes("OpenAI API key"))throw new Error("Servicio de análisis temporalmente no disponible. Intenta de nuevo más tarde.");const a=i.context?.msg?JSON.parse(i.context.msg).error:i.message;throw new Error(`Failed to analyze image: ${a}`)}if(n&&n.error)throw console.error("Image analysis failed with a specific error:",n.error),new Error(n.error);return n},Hb=async(t,e)=>{const r="cálido, simpático, motivador, y con un toque de humor ligero",n=(t.images||[]).map(m=>({url:m.url,timestamp:m.timestamp instanceof Date?m.timestamp.toISOString():m.timestamp,...m.healthAnalysis?{healthAnalysis:m.healthAnalysis}:{}})).sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());let i=[];try{i=await j3(t)}catch(m){console.warn("[generatePlantResponse] No se pudieron generar insights para la planta:",m),i=[]}const a={...t,images:n},{data:{session:s},error:o}=await _t.auth.getSession();if(o||!s?.access_token)throw console.error("User session not available:",o),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:l,error:c}=await _t.functions.invoke("generate-plant-response",{body:{plant:a,userMessage:e,tonePersona:r,insights:i},headers:{Authorization:`Bearer ${s.access_token}`}});if(c)throw console.error("Error calling generate-plant-response function:",c),new Error("Failed to generate plant response: "+c.message);const u=(l?.content||"").toLowerCase();return(!l?.content||u.includes("no sé")||u.includes("no tengo información")||u.includes("no puedo ayudarte")||u.length<20)&&Sd.warning("Respuesta genérica","La respuesta de la planta fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{...l,insights:l?.insights||i||[],suggestedActions:l?.suggestedActions||[]}},O3=async(t,e)=>{const{data:{session:r},error:n}=await _t.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await _t.functions.invoke("complete-plant-info",{body:{species:t,commonName:e},headers:{Authorization:`Bearer ${r.access_token}`}});if(a)throw console.error("💥 [API] Error en complete-plant-info function:",a),new Error("Failed to complete plant info: "+a.message);const s=["interior","exterior","ambos"],o=["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"];return{plantEnvironment:s.includes(i.plantEnvironment)?i.plantEnvironment:"interior",lightRequirements:o.includes(i.lightRequirements)?i.lightRequirements:"luz_indirecta",description:i.description||void 0,funFacts:Array.isArray(i.funFacts)?i.funFacts:void 0}},uo=(t,e,r,n)=>({id:t.id,name:t.name,species:t.species,variety:t.variety||void 0,nickname:t.nickname||void 0,description:t.description||void 0,funFacts:t.fun_facts||[],location:t.location,plantEnvironment:t.plant_environment,lightRequirements:t.light_requirements,dateAdded:new Date(t.date_added),lastWatered:t.last_watered?new Date(t.last_watered):void 0,lastFertilized:t.last_fertilized?new Date(t.last_fertilized):void 0,images:e,healthScore:t.health_score||85,careProfile:t.care_profile,personality:t.personality,chatHistory:r,notifications:n});class cg{constructor(e=_t){qr(this,"supabase");this.supabase=e}async getUserPlantSummaries(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          care_profile
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;let i=new Map;if(r.length>0){const s=r.map(c=>c.id),{data:o,error:l}=await this.supabase.from("plant_images").select("plant_id, url").in("plant_id",s).eq("is_profile_image",!0);l?console.warn("[plantService] Error fetching profile images:",l):i=new Map((o||[]).map(c=>[c.plant_id,c.url]))}return r.map(s=>({id:s.id,name:s.name,nickname:s.nickname||void 0,species:s.species,location:s.location,plantEnvironment:s.plant_environment,lightRequirements:s.light_requirements,healthScore:s.health_score||85,profileImageUrl:i.get(s.id),lastWatered:s.last_watered?new Date(s.last_watered):void 0,wateringFrequency:s.care_profile?.wateringFrequency}))}catch(r){throw console.error("Error fetching plant summaries:",r),r}}async getUserPlants(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return r.map(a=>{const s=(a.plant_images||[]).map(c=>({id:c.id,url:c.url,timestamp:new Date(c.created_at),healthAnalysis:c.health_analysis,isProfileImage:c.is_profile_image||!1})),o=(a.chat_messages||[]).map(c=>({id:c.id,sender:c.sender,content:c.content,timestamp:new Date(c.created_at),emotion:c.emotion})),l=(a.plant_notifications||[]).map(c=>({id:c.id,type:c.type,title:c.title,message:c.message,priority:c.priority||"medium",scheduledFor:new Date(c.scheduled_for),completed:c.completed||!1}));return uo(a,s,o,l)})}catch(r){throw console.error("Error fetching plants:",r),r}}async getPlantById(e,r){try{const{data:n,error:i}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("id",e).eq("user_id",r).single();if(i){if(i.code==="PGRST116")return null;throw i}if(!n)return null;const a=(n.plant_images||[]).map(l=>({id:l.id,url:l.url,timestamp:new Date(l.created_at),healthAnalysis:l.health_analysis,isProfileImage:l.is_profile_image||!1})),s=(n.chat_messages||[]).map(l=>({id:l.id,sender:l.sender,content:l.content,timestamp:new Date(l.created_at),emotion:l.emotion})),o=(n.plant_notifications||[]).map(l=>({id:l.id,type:l.type,title:l.title,message:l.message,priority:l.priority||"medium",scheduledFor:new Date(l.scheduled_for),completed:l.completed||!1}));return uo(n,a,s,o)}catch(n){throw console.error("Error fetching plant by ID:",n),n}}async addPlantFromAnalysis(e,r,n){try{console.log("[PlantService] Iniciando análisis IA...");const i=await iA(r);console.log("[PlantService] Resultado IA:",i);const a={name:i.commonName,species:i.species,description:i.generalDescription,funFacts:i.funFacts,variety:i.variety??void 0,nickname:i.commonName,location:n,plantEnvironment:i.plantEnvironment,lightRequirements:i.lightRequirements,dateAdded:new Date,healthScore:i.health.confidence,careProfile:i.careProfile,personality:i.personality};console.log("[PlantService] Payload a createPlant:",a);const s=await this.createPlant(a,e);return console.log("[PlantService] Planta creada:",s),(async()=>{let o=!1,l=!1;try{console.log(`[PlantService] Starting image upload for plant ${s.id}`);const c=await kT(r,"plant-images",`${e}/${s.id}`);console.log("[PlantService] Imagen subida:",c),await this.addPlantImage(s.id,{url:c,timestamp:new Date,isProfileImage:!0,healthAnalysis:i.health},e),o=!0,console.log(`[PlantService] Image upload completed for plant ${s.id}`)}catch(c){console.error(`[PlantService] Image upload failed for plant ${s.id}:`,c),alert("Error subiendo imagen: "+(c instanceof Error?c.message:JSON.stringify(c)))}try{console.log(`[PlantService] Starting chat initialization for plant ${s.id}`);const c=await Hb(s,"¡Hola! Acabo de llegar. ¿Cómo te llamas?");console.log("[PlantService] Respuesta IA chat:",c),await this.addChatMessage(s.id,{sender:"plant",content:c.content,timestamp:new Date,emotion:c.emotion},e),l=!0,console.log(`[PlantService] Chat initialization completed for plant ${s.id}`)}catch(c){console.error(`[PlantService] Chat initialization failed for plant ${s.id}:`,c),alert("Error inicializando chat: "+(c instanceof Error?c.message:JSON.stringify(c)))}o&&l?console.log(`[PlantService] All background tasks for plant ${s.id} completed successfully.`):(o||l)&&console.log(`[PlantService] Background tasks for plant ${s.id} partially completed.`)})().catch(o=>{console.error(`[PlantService] Error during background tasks for plant ${s.id}:`,o),alert("Error en tareas de fondo: "+(o instanceof Error?o.message:JSON.stringify(o)))}),s}catch(i){throw console.error("Error adding plant from analysis:",i),alert("Error creando planta: "+(i instanceof Error?i.message:JSON.stringify(i))),i}}async createPlant(e,r){try{const n={user_id:r,name:e.name,species:e.species,variety:e.variety||null,nickname:e.nickname||null,description:e.description||null,fun_facts:e.funFacts||null,location:e.location,plant_environment:e.plantEnvironment||null,light_requirements:e.lightRequirements||null,date_added:e.dateAdded.toISOString(),last_watered:null,last_fertilized:null,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,updated_at:null};console.log("[PlantService] Payload a Supabase:",n);const{data:i,error:a}=await this.supabase.from("plants").insert(n).select("*").single();if(console.log("[PlantService] Respuesta Supabase:",i,a),a)throw console.error("Supabase error:",{message:a.message,details:a.details,code:a.code}),alert("Error Supabase: "+a.message),new Error(`Supabase error creating plant: ${a.message}`);if(!i)throw alert("No se pudo crear la planta en la base de datos, no se devolvieron datos."),new Error("Failed to create plant in the database, no data returned.");return uo(i,[],[],[])}catch(n){throw console.error("Error creating plant:",n),alert("Error creando planta: "+(n instanceof Error?n.message:JSON.stringify(n))),n}}async updatePlantInfo(e,r,n){try{const i={};n.plantEnvironment!==void 0&&(i.plant_environment=n.plantEnvironment),n.lightRequirements!==void 0&&(i.light_requirements=n.lightRequirements),n.description!==void 0&&(i.description=n.description),n.funFacts!==void 0&&(i.fun_facts=n.funFacts);const{data:a,error:s}=await this.supabase.from("plants").update(i).eq("id",e).eq("user_id",r).select("*").single();if(s)throw console.error("Supabase error updating plant:",s),new Error(`Error updating plant: ${s.message}`);if(!a)throw new Error("Plant not found or not updated.");return uo(a,[],[],[])}catch(i){throw console.error("Error updating plant info:",i),i}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await this.supabase.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await this.supabase.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}async updatePlant(e,r){try{const n={name:e.name,species:e.species,variety:e.variety,nickname:e.nickname,description:e.description,fun_facts:e.funFacts,location:e.location,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,last_watered:e.lastWatered?.toISOString(),last_fertilized:e.lastFertilized?.toISOString()},{data:i,error:a}=await this.supabase.from("plants").update(n).eq("id",e.id).eq("user_id",r).select().single();if(a)throw a;return uo(i,e.images,e.chatHistory,e.notifications)}catch(n){throw console.error("Error updating plant:",n),n}}async deletePlant(e,r){try{const{error:n}=await this.supabase.from("plants").delete().eq("id",e).eq("user_id",r);if(n)throw n}catch(n){throw console.error("Error deleting plant:",n),n}}async sendChatMessageAndGetResponse(e,r,n){const i=await this.addChatMessage(e.id,r,n),a=await Hb(e,r.content),s={};a.insights&&(s.insights=a.insights),a.suggestedActions&&(s.suggestedActions=a.suggestedActions);const o={sender:"plant",content:a.content,emotion:a.emotion,timestamp:new Date,...Object.keys(s).length>0?{context:s}:{}},l=await this.addChatMessage(e.id,o,n);return[i,l]}async addChatMessage(e,r,n){try{const i={plant_id:e,user_id:n,sender:r.sender,content:r.content,emotion:r.emotion||null};r.context&&(i.context=r.context);const{data:a,error:s}=await this.supabase.from("chat_messages").insert(i).select().single();if(s)throw console.error("❌ Supabase error:",s),s;return{id:a.id,sender:a.sender,content:a.content,timestamp:new Date(a.created_at),emotion:a.emotion,context:a.context||void 0}}catch(i){throw console.error("Error adding chat message:",i),i}}async addPlantImage(e,r,n){try{const i=r.url;let a="";try{const c=new URL(i).pathname.split("/"),u=c.findIndex(h=>h==="object");u!==-1&&u+2<c.length&&(a=c.slice(u+2).join("/"))}catch{console.warn("Could not extract storage path from URL:",i),a=`${n}/${e}/${Date.now()}.jpg`}const{data:s,error:o}=await this.supabase.from("plant_images").insert({plant_id:e,user_id:n,url:i,storage_path:a,is_profile_image:r.isProfileImage,health_analysis:r.healthAnalysis}).select().single();if(o)throw o;if(!s.url)throw new Error("Image URL not returned from database.");return{id:s.id,url:s.url,timestamp:new Date(s.created_at),isProfileImage:s.is_profile_image||!1,healthAnalysis:s.health_analysis}}catch(i){throw console.error("Error adding plant image:",i),new Error(`Image upload failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async setProfileImage(e,r,n){try{await this.supabase.from("plant_images").update({is_profile_image:!1}).eq("plant_id",e).eq("user_id",n);const{error:i}=await this.supabase.from("plant_images").update({is_profile_image:!0}).eq("id",r).eq("user_id",n);if(i)throw i}catch(i){throw console.error("Error setting profile image:",i),i}}async deleteImage(e,r){try{const{data:n,error:i}=await this.supabase.from("plant_images").select("storage_path").eq("id",e).eq("user_id",r).single();if(i)throw i;n?.storage_path&&await this.supabase.storage.from("plant-images").remove([n.storage_path]);const{error:a}=await this.supabase.from("plant_images").delete().eq("id",e).eq("user_id",r);if(a)throw a}catch(n){throw console.error("Error deleting image:",n),n}}}const ds=new cg(_t);class R3{constructor(){qr(this,"cache",new Map);qr(this,"CACHE_DURATIONS",{GARDEN_CONTEXT:5*60*1e3,GARDEN_SUMMARY:3*60*1e3,SUGGESTED_QUESTIONS:10*60*1e3,PLANT_DATA:2*60*1e3})}getCacheKey(e,r){return`${e}:${r}`}isValidCache(e){return e?Date.now()<e.expiresAt:!1}getCachedData(e){const r=this.cache.get(e);return this.isValidCache(r)?r.data:(r&&this.cache.delete(e),null)}setCachedData(e,r,n){const i={data:r,timestamp:Date.now(),expiresAt:Date.now()+n};this.cache.set(e,i),console.log(`[GardenCache] Cache SET for key: ${e}, expires in ${n/1e3}s`)}getGardenContext(e){const r=this.getCacheKey(e,"garden_context");return this.getCachedData(r)}setGardenContext(e,r){const n=this.getCacheKey(e,"garden_context");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_CONTEXT)}getGardenSummary(e){const r=this.getCacheKey(e,"garden_summary");return this.getCachedData(r)}setGardenSummary(e,r){const n=this.getCacheKey(e,"garden_summary");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_SUMMARY)}getSuggestedQuestions(e){const r=this.getCacheKey(e,"suggested_questions");return this.getCachedData(r)}setSuggestedQuestions(e,r){const n=this.getCacheKey(e,"suggested_questions");this.setCachedData(n,r,this.CACHE_DURATIONS.SUGGESTED_QUESTIONS)}getPlantData(e){const r=this.getCacheKey(e,"plant_data");return this.getCachedData(r)}setPlantData(e,r){const n=this.getCacheKey(e,"plant_data");this.setCachedData(n,r,this.CACHE_DURATIONS.PLANT_DATA)}invalidateCache(e,r){r?r.forEach(n=>{const i=this.getCacheKey(e,n);this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)}):Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>{this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)})}invalidateOnPlantChange(e){console.log("[GardenCache] Plant data changed, invalidating related caches"),this.invalidateCache(e,["garden_context","garden_summary","plant_data","suggested_questions"])}getCacheStats(e){const r=Array.from(this.cache.keys()),n=r.filter(s=>s.startsWith(`${e}:`));let i=0,a=0;return n.forEach(s=>{const o=this.cache.get(s);o&&(this.isValidCache(o)?i++:a++)}),{totalEntries:r.length,userEntries:n.length,validEntries:i,expiredEntries:a}}cleanup(){const e=Date.now(),r=[];this.cache.forEach((n,i)=>{e>=n.expiresAt&&r.push(i)}),r.forEach(n=>{this.cache.delete(n)}),r.length>0&&console.log(`[GardenCache] Cleaned up ${r.length} expired entries`)}clearAll(){this.cache.size,this.cache.clear()}}const Vo=new R3;typeof window<"u"&&setInterval(()=>{Vo.cleanup()},5*60*1e3);const ho=new cg,qn=sp((t,e)=>({plants:[],isLoading:!1,error:null,selectedPlantId:null,getPlantById:r=>e().plants.find(n=>n.id===r),setPlant:r=>{t(mt(n=>{const i=n.plants.findIndex(a=>a.id===r.id);i!==-1?n.plants[i]=r:n.plants.push(r)}))},addPlant:async(r,n,i)=>{try{const a=await ho.addPlantFromAnalysis(i,r,n);return t(mt(s=>{s.plants.unshift(a)})),Vo.invalidateOnPlantChange(i),a}catch(a){throw console.error(a),a}},updatePlant:async(r,n)=>{try{const i=await ho.updatePlant(r,n);t(mt(a=>{const s=a.plants.findIndex(o=>o.id===i.id);s!==-1&&(a.plants[s]=i)})),Vo.invalidateOnPlantChange(n)}catch(i){throw console.error(i),i}},deletePlant:async(r,n)=>{try{await ho.deletePlant(r,n),t(mt(i=>{i.plants=i.plants.filter(a=>a.id!==r)})),Vo.invalidateOnPlantChange(n)}catch(i){throw console.error(i),i}},addChatMessage:async(r,n,i)=>{t({isLoading:!0,error:null});const a=e().getPlantById(r);if(!a){t({isLoading:!1,error:"Plant not found to add message"});return}const s={id:`temp-user-${Date.now()}`,sender:"user",content:n,timestamp:new Date};t(mt(o=>{o.plants.find(l=>l.id===r)?.chatHistory.push(s)}));try{const[o,l]=await ho.sendChatMessageAndGetResponse(a,{sender:"user",content:n,timestamp:s.timestamp},i);t(mt(c=>{const u=c.plants.find(h=>h.id===r);u&&(u.chatHistory=[...u.chatHistory.filter(h=>h.id!==s.id),o,l]),c.isLoading=!1}))}catch(o){const l=o instanceof Error?o.message:"Failed to send message";console.error(l),t({isLoading:!1,error:l})}},addPlantImage:async(r,n,i)=>{try{const a=await ho.addPlantImage(r,{url:n,timestamp:new Date,isProfileImage:!1},i);t(mt(s=>{const o=s.plants.find(l=>l.id===r);o&&o.images.push(a)}))}catch(a){throw console.error(a),a}},selectPlant:r=>t({selectedPlantId:r}),clearError:()=>{},clearPlants:()=>t({plants:[],selectedPlantId:null})}));class D3{async updatePlantHealthDiagnosis(e){if(!e.images||e.images.length===0)throw new Error("Esta planta no tiene imágenes para analizar. Toma una foto primero.");const r=[...e.images].sort((a,s)=>s.timestamp.getTime()-a.timestamp.getTime())[0],{data:{session:n},error:i}=await _t.auth.getSession();if(i||!n?.access_token)throw console.error("💥 [Health] User session not available:",i),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");try{const a=await fetch(r.url,{method:"HEAD"});if(!a.ok)throw new Error(`Imagen no accesible: ${a.status}`)}catch(a){throw console.error("💥 [Health] Error verificando acceso a imagen:",a),new Error("La imagen de la planta no está disponible. Intenta tomar una nueva foto.")}console.log("🔬 [Health] Llamando a update-health-diagnosis...");try{const{data:a,error:s}=await _t.functions.invoke("update-health-diagnosis",{body:{imageUrl:r.url,plantName:e.name,species:e.species},headers:{Authorization:`Bearer ${n.access_token}`}});if(s)throw console.error("💥 [Health] Error en función update-health-diagnosis:",s),new Error(`Error en análisis: ${s.message}`);if(!a||!a.overallHealth)throw console.error("💥 [Health] Datos incompletos del análisis:",a),new Error("El análisis no devolvió información de salud válida.");console.log("🎯 [Health] Análisis de salud completado exitosamente:",{overallHealth:a.overallHealth,confidence:a.confidence,issuesCount:a.issues?.length||0,recommendationsCount:a.recommendations?.length||0});const l={excellent:95,good:80,fair:60,poor:30}[a.overallHealth]||a.confidence||60;return console.log("📊 [Health] Nuevo score de salud calculado:",{overallHealth:a.overallHealth,numericScore:l,confidence:a.confidence}),{healthScore:l,healthAnalysis:a,updatedImage:{...r,healthAnalysis:a}}}catch(a){console.error("💥 [Health] Error en diagnóstico primario:",a),console.log("🔄 [Health] Intentando análisis de fallback...");try{if(r.healthAnalysis&&r.healthAnalysis.overallHealth){console.log("🎯 [Health] Usando análisis existente de la imagen");const s=r.healthAnalysis;return{healthScore:{excellent:95,good:80,fair:60,poor:30}[s.overallHealth]||60,healthAnalysis:s,updatedImage:r}}}catch(s){console.error("💥 [Health] Error en fallback:",s)}throw new Error("No se pudo actualizar el diagnóstico de salud. Verifica tu conexión a internet e intenta nuevamente.")}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await _t.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await _t.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}}const Wb=new D3,Nd=()=>{const t=nd(),{addPlant:e,updatePlant:r,deletePlant:n}=qn.getState(),a=Cn(h=>h.user)?.id,{addToast:s}=zs(),o=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");const{imageDataUrl:m,location:p}=h;return e(m,p,a)},onSuccess:h=>{t.invalidateQueries({queryKey:["plants",a]})},onError:h=>{console.error("Failed to create plant:",h)}}),l=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return r(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.map(p=>p.id===h.id?h:p)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:h=>{t.invalidateQueries({queryKey:["plants",a]})}}),c=Ti({mutationFn:async({plant:h,userId:m})=>{console.log("🩺 [Mutation] Iniciando actualización de diagnóstico...");const p=await Wb.updatePlantHealthDiagnosis(h);return await Wb.updatePlantHealthScore(h.id,m,p.healthScore,p.healthAnalysis,p.updatedImage.id),console.log("✅ [Mutation] Diagnóstico actualizado exitosamente"),p},onSuccess:(h,{plant:m})=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",m.id]}),s({type:"success",title:"Diagnóstico Actualizado",message:`Nuevo estado de salud: ${h.healthScore}%`})},onError:h=>{console.error("💥 [Mutation] Error actualizando diagnóstico:",h),s({type:"error",title:"Error en Diagnóstico",message:h.message})}}),u=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return n(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.filter(p=>p.id!==h)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:()=>{t.invalidateQueries({queryKey:["plants",a]})}});return{createPlant:o.mutate,isCreatingPlant:o.isPending,updatePlant:l.mutate,isUpdatingPlant:l.isPending,updatePlantHealthMutation:c.mutate,isUpdatingPlantHealth:c.isPending,deletePlant:u.mutate,isDeletingPlant:u.isPending}},M3=()=>{const[t,e]=w.useState(!1),r=ar(),{createPlant:n,isCreatingPlant:i}=Nd();w.useEffect(()=>{const o=l=>{l.key==="Escape"&&e(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]);const a=[{id:"camera",icon:_n,label:"Tomar Foto",color:"bg-blue-500",action:()=>{e(!1),r(At.toCamera())}},{id:"gallery",icon:np,label:"Galería",color:"bg-purple-500",action:()=>s()}],s=w.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async l=>{const c=l.target.files?.[0];if(c){const u=new FileReader;u.onload=async h=>{const m=h.target?.result;if(m){e(!1);const p=new Promise((y,b)=>{n({imageDataUrl:m,location:"Interior"},{onSuccess:g=>{g?.id&&r(At.toPlantDetail(g.id)),y(g)},onError:g=>{console.error("Failed to create plant:",g),b(g)}})});vT.promise(p,{loading:"Analizando imagen... La IA está trabajando.",success:y=>`¡Planta "${y.name}" creada con éxito!`,error:y=>`Error: ${y.message}`})}},u.readAsDataURL(c)}},o.click()},[n,r]);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative flex items-center",children:[d.jsx(L.button,{onClick:()=>e(!t),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},disabled:i,"aria-label":t?"Cerrar menú":"Agregar planta","aria-expanded":t,children:d.jsx(ke,{mode:"wait",children:i?d.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:d.jsx(ya,{className:"w-6 h-6 animate-spin"})},"loading"):d.jsx(L.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:t?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:d.jsx(rp,{className:"w-6 h-6"})},"plus")})}),t&&d.jsx(L.span,{initial:{opacity:0,x:10},animate:{opacity:1,x:16},exit:{opacity:0,x:10},transition:{duration:.2},className:"ml-3 px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-xs font-medium shadow-md whitespace-nowrap z-50",children:"Agregar planta"})]}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:a.map((o,l)=>d.jsxs(L.button,{onClick:o.action,className:`w-12 h-12 ${o.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:l*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(a.length-l)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":o.label,children:[d.jsx(o.icon,{className:"w-5 h-5"}),d.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:d.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[o.label,d.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},o.id))})}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)})})]})},L3=[{icon:Zc,path:xt.dashboard,label:"Inicio",description:"Tu jardín personal"},{icon:Uo,path:xt.gardenChat,label:"Chat IA",description:"Asistente de plantas"},{icon:bC,path:xt.settings,label:"Ajustes",description:"Configuración"}],$3=()=>{const t=I_(),e=t.pathname.startsWith("/plant/");return d.jsxs(d.Fragment,{children:[d.jsx("nav",{className:"safe-bottom fixed bottom-0 left-0 right-0 z-50 glass-enhanced border-t border-contrast","data-tour":"bottom-navigation",children:d.jsx("div",{className:"flex justify-around items-center h-20 max-w-lg mx-auto px-2",children:L3.map(r=>{const n=m$(t.pathname,r.path);return d.jsx(L.div,{className:"relative flex-1 h-full",whileTap:{scale:.92},whileHover:{scale:1.02},children:d.jsxs(pC,{to:r.path,className:je("touch-target relative flex flex-col items-center justify-center w-full h-full rounded-2xl transition-all duration-200","focus-contrast",n?"text-primary-700 dark:text-primary-400":"text-neutral-700 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400"),"aria-label":`${r.label} - ${r.description}`,...n?{"aria-current":"page"}:{},...r.path===xt.gardenChat?{"data-tour":"chat-tab"}:{},children:[d.jsx(ke,{children:n&&d.jsx(L.div,{layoutId:"nav-background",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:400,damping:30},className:"absolute inset-1 bg-primary-500/10 dark:bg-primary-400/10 rounded-xl"})}),d.jsx(L.div,{animate:{scale:n?1.1:1,y:n?-2:0},transition:{duration:.2},className:je("relative z-10",n?"text-[#2A7F3E]":"text-[#888]"),children:d.jsx(r.icon,{size:24,strokeWidth:n?2.5:2,className:"drop-shadow-sm"})}),d.jsx(L.span,{animate:{scale:n?1.05:1,fontWeight:n?600:500},transition:{duration:.2},className:"text-xs mt-1 relative z-10",children:r.label}),d.jsx(ke,{children:n&&d.jsx(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1},className:"absolute left-1/2 -translate-x-1/2 w-1 h-1 bg-primary-500 dark:bg-primary-400 rounded-full mt-1.5"})})]})},r.path)})})}),!e&&d.jsx("div",{className:"fixed bottom-20 sm:bottom-24 right-4 sm:right-6 z-40","data-tour":"add-plant-fab",children:d.jsx(M3,{})})]})},V3=()=>{const[t,e]=w.useState(navigator.onLine);return w.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t},F3=()=>{const t=V3();return d.jsxs(ke,{children:[!t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",children:d.jsx("div",{className:"bg-red-500 text-white px-4 py-2 text-center text-sm font-medium",children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(xC,{size:16}),d.jsx("span",{children:"Sin conexión - Modo offline"})]})})}),t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",onAnimationComplete:()=>{setTimeout(()=>{const e=document.querySelector("[data-online-indicator]");e&&e.remove()},2e3)},children:d.jsx("div",{className:"bg-green-500 text-white px-4 py-2 text-center text-sm font-medium","data-online-indicator":!0,children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(P_,{size:16}),d.jsx("span",{children:"Conexión restaurada"})]})})})]})},z3="1.0.0",U3="2025-07-28T14:59:04.273Z",B3="28 de julio de 2025, 14:59",da={name:"Plantitas",version:z3,buildDate:B3,buildTimestamp:U3,author:"Felipe Aurelio",repository:"https://github.com/felipeaurelio13/plantitas-app"},H3=()=>`${da.name} v${da.version} (${da.buildDate})`,W3=({className:t="",showVersion:e=!0,showBuildInfo:r=!1})=>d.jsxs("footer",{className:`text-center py-4 text-sm text-muted-foreground ${t}`,children:[e&&d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-foreground",children:da.name}),d.jsx("p",{className:"text-xs opacity-75",children:H3()})]}),r&&d.jsxs("div",{className:"mt-2 text-xs opacity-50",children:[d.jsxs("p",{children:["Build: ",da.buildTimestamp]}),d.jsxs("p",{children:["Repo: ",da.repository]})]}),d.jsx("div",{className:"mt-2 text-xs opacity-60",children:d.jsxs("p",{children:["© 2024 ",da.author,". Todos los derechos reservados."]})})]});function q3(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var a;const s=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(i))!=null?a:null;return o instanceof Promise?o.then(s):s(o)},setItem:(i,a)=>r.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>r.removeItem(i)}}const um=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return um(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return um(n)(r)}}}},K3=(t,e)=>(r,n,i)=>{let a={storage:q3(()=>localStorage),partialize:b=>b,version:0,merge:(b,g)=>({...g,...b}),...e},s=!1;const o=new Set,l=new Set;let c=a.storage;if(!c)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},n,i);const u=()=>{const b=a.partialize({...n()});return c.setItem(a.name,{state:b,version:a.version})},h=i.setState;i.setState=(b,g)=>{h(b,g),u()};const m=t((...b)=>{r(...b),u()},n,i);i.getInitialState=()=>m;let p;const y=()=>{var b,g;if(!c)return;s=!1,o.forEach(T=>{var E;return T((E=n())!=null?E:m)});const _=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(b=n())!=null?b:m))||void 0;return um(c.getItem.bind(c))(a.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==a.version){if(a.migrate){const E=a.migrate(T.state,T.version);return E instanceof Promise?E.then(O=>[!0,O]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var E;const[O,R]=T;if(p=a.merge(R,(E=n())!=null?E:m),r(p,!0),O)return u()}).then(()=>{_?.(p,void 0),p=n(),s=!0,l.forEach(T=>T(p))}).catch(T=>{_?.(void 0,T)})};return i.persist={setOptions:b=>{a={...a,...b},b.storage&&(c=b.storage)},clearStorage:()=>{c?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>y(),hasHydrated:()=>s,onHydrate:b=>(o.add(b),()=>{o.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},a.skipHydration||y(),p||m},G3=K3,Y3=sp()(G3((t,e)=>({isDark:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1,toggleTheme:()=>{const{isDark:r}=e(),n=!r;t({isDark:n}),ef(n),"vibrate"in navigator&&navigator.vibrate(50)},setTheme:r=>{t({isDark:r}),ef(r)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t&&ef(t.isDark)}})),ef=t=>{if(typeof window>"u")return;const e=t?"dark":"light";document.documentElement.setAttribute("data-theme",e),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},Z3=()=>{const t=I_(),{isDark:e}=Y3(),r=t.pathname==="/camera",n=()=>{const a={"/":"Página de inicio - Tu jardín personal","/camera":"Cámara - Agregar nueva planta","/chat":"Chat con IA - Asistente de plantas","/garden-chat":"Chat del jardín - Consultas generales","/settings":"Configuración - Ajustes de la aplicación"},s=t.pathname.includes("/plant/")?"/plant":t.pathname,o=a[s]||a[t.pathname]||"Página",l=document.createElement("div");l.setAttribute("aria-live","polite"),l.setAttribute("aria-atomic","true"),l.setAttribute("class","sr-only"),l.textContent=`Navegando a ${o}`,document.body.appendChild(l),setTimeout(()=>{document.body.removeChild(l)},1e3)};w.useEffect(()=>{n()},[t.pathname]),w.useEffect(()=>{const a=e?"dark":"light";document.documentElement.setAttribute("data-theme",a)},[e]);const i=()=>d.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only fixed top-4 left-4 z-50 bg-primary-600 text-white px-4 py-2 rounded-md font-medium transition-all duration-200 focus:shadow-lg",onFocus:a=>{a.currentTarget.scrollIntoView({behavior:"smooth"})},children:"Saltar al contenido principal"});return d.jsxs("div",{className:"min-h-screen bg-background text-text-primary",children:[d.jsx(i,{}),d.jsx("h1",{className:"sr-only",children:"Plantitas - Aplicación de cuidado de plantas"}),d.jsx("main",{id:"main-content",role:"main","aria-label":"Contenido principal",className:"pb-28 min-h-screen focus:outline-none",tabIndex:-1,children:d.jsx(ke,{mode:"wait",children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"w-full h-full",children:d.jsx(gC,{})},t.pathname)})}),d.jsx("aside",{role:"complementary","aria-label":"Información de estado",children:d.jsx(F3,{})}),!r&&d.jsx("nav",{role:"navigation","aria-label":"Navegación inferior",children:d.jsx($3,{})}),!r&&d.jsx(W3,{className:"mt-auto pt-4 pb-20",showVersion:!0,showBuildInfo:!1}),d.jsx("style",{children:`
        @media (prefers-contrast: high) {
          :root {
            --color-background: #000000;
            --color-surface: #111111;
            --color-text-primary: #ffffff;
            --color-text-secondary: #ffffff;
            --color-border: #ffffff;
            --color-accent: #00ff00;
          }
        }

        @media (prefers-reduced-motion: reduce) {
          * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Screen reader only utility */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .sr-only.focus\\:not-sr-only:focus {
          position: static;
          width: auto;
          height: auto;
          padding: inherit;
          margin: inherit;
          overflow: visible;
          clip: auto;
          white-space: normal;
        }

        /* Enhanced focus indicators */
        *:focus-visible {
          outline: 3px solid var(--color-accent) !important;
          outline-offset: 2px !important;
          border-radius: 4px;
        }

        /* High contrast focus ring */
        @media (prefers-contrast: high) {
          *:focus-visible {
            outline: 4px solid #00ff00 !important;
            outline-offset: 3px !important;
          }
        }
      `})]})};class X3 extends w.Component{constructor(r){super(r);qr(this,"handleReload",()=>{window.location.reload()});qr(this,"handleGoHome",()=>{window.location.href="/plantitas-app/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n});const i={userAgent:navigator.userAgent,platform:navigator.platform,isOnline:navigator.onLine,viewport:{width:window.innerWidth,height:window.innerHeight},url:window.location.href,timestamp:new Date().toISOString()};console.error("[ErrorBoundary] Error caught:",{error:r.message,stack:r.stack,errorInfo:n,mobileInfo:i}),console.warn("[ErrorBoundary] Production error detected:",{message:r.message,mobile:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:d.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-md w-full",children:d.jsxs("div",{className:"glass-effect rounded-2xl p-8 text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:d.jsx(Jr,{size:32,className:"text-red-500"})}),d.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"¡Oops! Algo salió mal"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. No te preocupes, tus plantas están seguras."}),!1,d.jsxs("div",{className:"space-y-3",children:[d.jsxs("button",{onClick:this.handleReload,className:"w-full px-4 py-3 bg-primary-500 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(ji,{size:18}),d.jsx("span",{children:"Recargar Página"})]}),d.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-4 py-3 bg-gray-600 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(Zc,{size:18}),d.jsx("span",{children:"Ir al Inicio"})]})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-4",children:"Si el problema persiste, intenta limpiar el caché del navegador."})]})})}):this.props.children}}const Q3=()=>{const t=Cn(e=>e.user);return E_({queryKey:["plants",t?.id],queryFn:async()=>t?ds.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:yi.QUERY.STALE_TIME.MEDIUM,gcTime:yi.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]})},qb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Kb=Me,ug=(t,e)=>r=>{var n;if(e?.variants==null)return Kb(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,s=Object.keys(i).map(c=>{const u=r?.[c],h=a?.[c];if(u===null)return null;const m=qb(u)||qb(h);return i[c][m]}),o=r&&Object.entries(r).reduce((c,u)=>{let[h,m]=u;return m===void 0||(c[h]=m),c},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((c,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(y=>{let[b,g]=y;return Array.isArray(g)?g.includes({...a,...o}[b]):{...a,...o}[b]===g})?[...c,h,m]:c},[]);return Kb(t,s,l,r?.class,r?.className)},J3=ug("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),Sr=H.forwardRef(({className:t,variant:e,size:r,radius:n,interactive:i,hover:a=!1,loading:s=!1,children:o,ariaLabel:l,...c},u)=>d.jsx(L.div,{whileHover:i&&!s?{scale:a?1.02:1.01,y:a?-4:-2}:void 0,whileTap:i&&!s?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:je(J3({variant:e,size:r,radius:n,interactive:i}),s&&"animate-pulse",t),ref:u,...c,children:s?d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));Sr.displayName="Card";const jd=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:je("flex flex-col space-y-1.5 pb-4",t),...e}));jd.displayName="CardHeader";const dg=H.forwardRef(({className:t,...e},r)=>d.jsx("h3",{ref:r,className:je("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",t),...e}));dg.displayName="CardTitle";const eF=H.forwardRef(({className:t,...e},r)=>d.jsx("p",{ref:r,className:je("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",t),...e}));eF.displayName="CardDescription";const Jn=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:je("",t),...e}));Jn.displayName="CardContent";const aA=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:je("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",t),...e}));aA.displayName="CardFooter";const fo=new Set,wc=new Map,hg=({src:t,alt:e,className:r="",fallback:n,onLoad:i,onError:a,priority:s=!1,sizes:o="(max-width: 768px) 100vw, 50vw"})=>{const[l,c]=w.useState(()=>fo.has(t)),[u,h]=w.useState(!1),m=w.useRef(null);w.useEffect(()=>{if(s&&!fo.has(t)&&!wc.has(t)){const b=new Image;b.src=t,b.onload=()=>{fo.add(t),wc.set(t,b)},b.onerror=()=>{wc.delete(t)},wc.set(t,b)}},[t,s]);const p=w.useCallback(()=>{fo.add(t),c(!0),i?.()},[i,t]),y=w.useCallback(()=>{fo.delete(t),h(!0),a?.()},[a,t]);return u&&n?d.jsx(d.Fragment,{children:n}):u?d.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 flex items-center justify-center ${r}`,children:d.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})}):d.jsxs("div",{className:`relative overflow-hidden ${r}`,children:[d.jsx(ke,{children:!l&&d.jsx(L.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"})}),d.jsx(L.img,{ref:m,src:t,alt:e,className:`w-full h-full object-cover ${l?"opacity-100":"opacity-0"}`,loading:s?"eager":"lazy",decoding:"async",fetchPriority:s?"high":"low",sizes:o,onLoad:p,onError:y,initial:{opacity:0},animate:{opacity:l?1:0},transition:{duration:.15}})]})},tF=w.memo(({score:t})=>{const e=w.useMemo(()=>t>=80?{color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",icon:d.jsx(Bt,{className:"w-4 h-4 mr-1 text-green-400"}),status:"Excelente"}:t>=60?{color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",icon:d.jsx(Ii,{className:"w-4 h-4 mr-1 text-yellow-400"}),status:"Buena"}:{color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",icon:d.jsx(Jr,{className:"w-4 h-4 mr-1 text-red-400"}),status:"Atención"},[t]);return d.jsxs("div",{className:"flex items-center gap-3 w-full",children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[d.jsx("div",{className:"relative w-24 h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:d.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}})}),d.jsxs("span",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400",children:[t,"%"]})]}),d.jsxs("div",{className:"flex items-center gap-1 text-xs px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700",children:[e.icon,d.jsx("span",{className:e.textColor,children:e.status})]})]})});tF.displayName="PlantHealthIndicator";const sA=w.memo(({plant:t,index:e})=>{const r=ar(),n=nd(),{needsWatering:i,isFavorite:a}=w.useMemo(()=>{const u=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,h=t.healthScore>=80;return{needsWatering:u,isFavorite:h}},[t.lastWatered,t.wateringFrequency,t.healthScore]),s=()=>{n.prefetchQuery({queryKey:["plant",t.id],queryFn:async()=>{const{supabase:u}=await Qm(async()=>{const{supabase:y}=await Promise.resolve().then(()=>f$);return{supabase:y}},void 0),{data:h,error:m}=await u.from("plants").select(`
            *,
            plant_images(*)
          `).eq("id",t.id).single();if(m)throw m.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");const p=h;return{id:p.id,name:p.name,species:p.species,description:p.description??void 0,funFacts:p.fun_facts??void 0,variety:p.variety??void 0,nickname:p.nickname??void 0,location:p.location,plantEnvironment:p.plant_environment,lightRequirements:p.light_requirements,dateAdded:new Date(p.date_added),lastWatered:p.last_watered?new Date(p.last_watered):void 0,lastFertilized:p.last_fertilized?new Date(p.last_fertilized):void 0,healthScore:p.health_score??0,careProfile:p.care_profile,personality:p.personality,images:p.plant_images.map(y=>({id:y.id,url:y.url??"",timestamp:new Date(y.created_at),isProfileImage:y.is_profile_image??!1,healthAnalysis:y.health_analysis})),chatHistory:[],notifications:[]}},staleTime:1e3*60*5})},o=()=>r(At.toPlantDetail(t.id)),l=Math.min(e,4),c=e<8;return d.jsx(L.div,{initial:c?{opacity:0,y:10}:{opacity:1,y:0},animate:{opacity:1,y:0},transition:c?{delay:l*.02,duration:.2,ease:"easeOut"}:{duration:0},whileHover:{y:-1},className:"group",children:d.jsxs(Sr,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:o,onMouseEnter:s,className:"overflow-hidden border border-green-200/60 hover:border-green-300/80 dark:hover:border-green-600 transition-all duration-300 p-4 mb-4 shadow-sm hover:shadow-lg hover:shadow-green-100/30 bg-white/80 backdrop-blur-sm",children:[d.jsx(jd,{className:"pb-2 flex-shrink-0 space-y-0",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[t.profileImageUrl?d.jsx(hg,{src:t.profileImageUrl,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",priority:e<4,sizes:"(max-width: 768px) 20vw, 10vw"}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:d.jsx(Ii,{size:24})}),d.jsx(ke,{children:a&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(k_,{size:12,className:"text-white fill-current"})})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:d.jsx(id,{size:12,className:"text-white"})})})})]}),d.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[d.jsx(dg,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),d.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),d.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:d.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:["📍 ",t.location]})})]})]})}),d.jsxs(Jn,{className:"pt-2 pb-0",children:[d.jsxs("div",{className:"flex items-center gap-2 w-full",children:[d.jsx("div",{className:"relative w-24 h-[6px] bg-[#EEE] rounded-full overflow-hidden flex-shrink-0",children:d.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${t.healthScore>=80?"bg-green-400":t.healthScore>=60?"bg-yellow-300":"bg-red-300"}`,initial:{width:0},animate:{width:`${t.healthScore}%`},transition:{duration:.5,ease:"easeOut"}})}),d.jsxs("span",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400 ml-1 min-w-[32px] text-right",children:[t.healthScore,"%"]}),d.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ml-auto ${t.healthScore>=80?"bg-green-500/10 text-green-700":t.healthScore>=60?"bg-yellow-400/10 text-yellow-700":"bg-red-400/10 text-red-700"}`,style:{padding:"4px 8px"},children:[t.healthScore>=80?d.jsx(Bt,{className:"w-4 h-4 mr-1 text-green-400"}):t.healthScore>=60?d.jsx(Ii,{className:"w-4 h-4 mr-1 text-yellow-400"}):d.jsx(Jr,{className:"w-4 h-4 mr-1 text-red-400"}),d.jsx("span",{children:t.healthScore>=80?"Excelente":t.healthScore>=60?"Buena":"Atención"})]})]}),t.healthScore<40&&d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[d.jsx(Jr,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),d.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),d.jsx(L.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});sA.displayName="PlantCard";function pe({className:t,...e}){return d.jsx("div",{className:je("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",t),...e})}const rF=()=>d.jsxs(Sr,{variant:"elevated",size:"default",className:"overflow-hidden",children:[d.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[d.jsx(pe,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs(jd,{className:"p-0",children:[d.jsx(pe,{className:"h-6 w-3/4"}),d.jsx(pe,{className:"h-4 w-1/2 mt-2"})]}),d.jsx(Jn,{className:"p-0 mt-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(pe,{className:"w-16 h-1.5"}),d.jsx(pe,{className:"w-8 h-3"})]})})]})]}),d.jsx(aA,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:d.jsxs("div",{className:"flex justify-between items-center w-full",children:[d.jsx(pe,{className:"h-4 w-1/3"}),d.jsx(pe,{className:"w-8 h-8 rounded"})]})})]}),nF=ug("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),me=H.forwardRef(({className:t,variant:e,size:r,fullWidth:n,loading:i=!1,leftIcon:a,rightIcon:s,children:o,disabled:l,...c},u)=>{const h=l||i;return d.jsxs(L.button,{whileTap:h?void 0:{scale:.96},whileHover:h?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:je(nF({variant:e,size:r,fullWidth:n,className:t})),disabled:h,ref:u,...c,children:[i&&d.jsx(L.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),a&&!i&&d.jsx("span",{className:"mr-2 -ml-1",children:a}),d.jsx("span",{className:je("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(m=>typeof m=="string"||typeof m=="number"||H.isValidElement(m)):typeof o=="string"||typeof o=="number"||H.isValidElement(o)?o:null}),s&&d.jsx("span",{className:"ml-2 -mr-1",children:s})]})});me.displayName="Button";const iF=ug("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Od=H.forwardRef(({className:t,variant:e,size:r,state:n,label:i,helperText:a,errorMessage:s,successMessage:o,leftIcon:l,rightIcon:c,loading:u=!1,showPasswordToggle:h=!1,floatingLabel:m=!1,type:p,disabled:y,value:b,defaultValue:g,..._},T)=>{const[E,O]=w.useState(!1),[R,D]=w.useState(!1),[I,A]=w.useState(b||g||""),P=w.useRef(null),j=w.useCallback(he=>{P.current=he,typeof T=="function"?T(he):T&&(T.current=he)},[T]),N=s?"error":o?"success":n,k=!!I||E,C=h?R?"text":"password":p;w.useEffect(()=>{b!==void 0&&A(b)},[b]);const Q=he=>{O(!0),_.onFocus?.(he)},oe=he=>{O(!1),_.onBlur?.(he)},X=he=>{A(he.target.value),_.onChange?.(he)},ee=()=>{P.current?.focus()};return d.jsxs("div",{className:"w-full",children:[d.jsxs("div",{className:"relative",children:[i&&!m&&d.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),d.jsxs("div",{className:"relative",children:[l&&d.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:l}),i&&m&&d.jsx(L.label,{onClick:ee,animate:{scale:k?.85:1,y:k?-24:0,x:k?4:l?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:je("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",k&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),d.jsx("input",{ref:j,type:C,value:I,disabled:y||u,className:je(iF({variant:e,size:r,state:N}),l&&"pl-10",(c||h||u)&&"pr-10",m&&k&&"pt-6 pb-2",(!r||r==="default")&&"py-[12px]","placeholder-[#777]",t),style:{..._.style},onFocus:Q,onBlur:oe,onChange:X,..._}),d.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[u&&d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:d.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!u&&N==="error"&&d.jsx(Lr,{className:"w-4 h-4 text-error-500"}),!u&&N==="success"&&d.jsx(Un,{className:"w-4 h-4 text-success-500"}),h&&!u&&d.jsx("button",{type:"button",onClick:()=>D(!R),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:R?d.jsx(wC,{className:"w-4 h-4"}):d.jsx(Af,{className:"w-4 h-4"})}),c&&!u&&d.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:c})]})]}),d.jsx(ke,{children:E&&d.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:je("absolute inset-0 rounded-xl pointer-events-none",N==="error"&&"ring-2 ring-error-500/20",N==="success"&&"ring-2 ring-success-500/20",N==="default"&&"ring-2 ring-primary-500/20")})})]}),d.jsx(ke,{mode:"wait",children:(a||s||o)&&d.jsxs(L.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[s&&d.jsxs(d.Fragment,{children:[d.jsx(Lr,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),d.jsx("span",{className:"text-error-600 dark:text-error-400",children:s})]}),o&&!s&&d.jsxs(d.Fragment,{children:[d.jsx(Un,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),d.jsx("span",{className:"text-success-600 dark:text-success-400",children:o})]}),a&&!s&&!o&&d.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:a})]})})]})});Od.displayName="Input";const aF={default:ya,ai:ep,camera:_n,upload:N_,download:TC,sync:S_,search:EC,save:_C,delete:C_,chat:pl},sF={sm:{icon:"w-4 h-4",text:"text-sm",gap:"gap-2"},md:{icon:"w-5 h-5",text:"text-base",gap:"gap-3"},lg:{icon:"w-6 h-6",text:"text-lg",gap:"gap-4"}},oF=({message:t,type:e="default",size:r="md",className:n=""})=>{const i=aF[e],a=sF[r];return d.jsxs("div",{className:`flex items-center justify-center ${a.gap} ${n}`,children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"flex-shrink-0",children:d.jsx(i,{className:`${a.icon} text-primary-500`})}),d.jsx("span",{className:`${a.text} text-gray-600 dark:text-gray-400 font-medium`,children:t})]})},lF={LoadingPlants:t=>d.jsx(oF,{message:"Cargando tu jardín...",type:"default",...t})},dm=({children:t,content:e,position:r="top",delay:n=300,disabled:i=!1,className:a=""})=>{const[s,o]=w.useState(!1),[l,c]=w.useState({x:0,y:0}),u=w.useRef(null),h=w.useRef(),m=()=>{i||(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(u.current){const g=u.current.getBoundingClientRect(),_=window.pageYOffset||document.documentElement.scrollTop,T=window.pageXOffset||document.documentElement.scrollLeft;let E,O;switch(r){case"top":E=g.left+T+g.width/2,O=g.top+_-8;break;case"bottom":E=g.left+T+g.width/2,O=g.bottom+_+8;break;case"left":E=g.left+T-8,O=g.top+_+g.height/2;break;case"right":E=g.right+T+8,O=g.top+_+g.height/2;break;default:E=g.left+T+g.width/2,O=g.top+_-8}c({x:E,y:O}),o(!0)}},n))},p=()=>{h.current&&clearTimeout(h.current),o(!1)};w.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const y=()=>{const g="absolute z-[9999] px-2 py-1 text-xs font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-md shadow-lg pointer-events-none max-w-xs";switch(r){case"top":return`${g} -translate-x-1/2 -translate-y-full`;case"bottom":return`${g} -translate-x-1/2`;case"left":return`${g} -translate-x-full -translate-y-1/2`;case"right":return`${g} -translate-y-1/2`;default:return`${g} -translate-x-1/2 -translate-y-full`}},b=()=>{const g="absolute w-2 h-2 bg-gray-900 dark:bg-gray-700 transform rotate-45";switch(r){case"top":return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`;case"bottom":return`${g} left-1/2 -translate-x-1/2 -top-1`;case"left":return`${g} top-1/2 -translate-y-1/2 left-full -translate-x-1/2`;case"right":return`${g} top-1/2 -translate-y-1/2 -left-1`;default:return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`}};return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:u,onMouseEnter:m,onMouseLeave:p,onFocus:m,onBlur:p,className:`inline-block ${a}`,children:t}),typeof document<"u"&&Xm.createPortal(d.jsx(ke,{children:s&&d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:y(),style:{left:l.x,top:l.y},children:[e,d.jsx("div",{className:b()})]})}),document.body)]})},cF={network:{icon:P_,color:"text-orange-500",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Verificar conexión",action:"help"}]},validation:{icon:Jr,color:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-800",defaultActions:[{label:"Corregir",action:"retry"}]},server:{icon:Jr,color:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Reportar problema",action:"help"}]},unknown:{icon:AC,color:"text-gray-500",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800",defaultActions:[{label:"Reintentar",action:"retry"}]}},uF=({title:t,message:e,type:r="unknown",onRetry:n,onDismiss:i,actions:a,className:s=""})=>{const o=cF[r],l=o.icon,c=h=>{switch(h){case"retry":n?.();break;case"help":console.log("Help requested for error type:",r);break}},u=()=>a?a.map((h,m)=>d.jsx(me,{variant:h.variant||"outline",size:"sm",onClick:h.onClick,children:h.label},m)):o.defaultActions.map((h,m)=>d.jsxs(me,{variant:m===0?"primary":"outline",size:"sm",onClick:()=>c(h.action),disabled:h.action==="retry"&&!n,children:[h.action==="retry"&&d.jsx(ji,{className:"w-4 h-4 mr-1"}),h.action==="help"&&d.jsx(IC,{className:"w-4 h-4 mr-1"}),h.label]},m));return d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
        ${o.bgColor} 
        ${o.borderColor} 
        border rounded-lg p-4 
        ${s}
      `,children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:`${o.color} flex-shrink-0 mt-0.5`,children:d.jsx(l,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:t}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e}),d.jsx("div",{className:"flex flex-wrap gap-2",children:u()})]}),i&&d.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar error",children:d.jsx(ni,{className:"w-4 h-4"})})]})})},dF={LoadingPlantsError:t=>d.jsx(uF,{type:"server",title:"Error al Cargar Plantas",message:"No se pudieron cargar tus plantas. Intenta refrescar la página.",...t})},hF=({isOpen:t,onComplete:e,onSkip:r,steps:n})=>{const[i,a]=w.useState(0),[s,o]=w.useState(null),[l,c]=w.useState({x:0,y:0}),u=n[i],h=i===n.length-1,m=i===0;w.useEffect(()=>{if(!t||!u?.target)return;const g=document.querySelector(u.target);if(g){o(g);const _=g.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,E=window.pageXOffset||document.documentElement.scrollLeft;let O,R;switch(u.position){case"top":O=_.left+E+_.width/2,R=_.top+T-20;break;case"bottom":O=_.left+E+_.width/2,R=_.bottom+T+20;break;case"left":O=_.left+E-20,R=_.top+T+_.height/2;break;case"right":O=_.right+E+20,R=_.top+T+_.height/2;break;default:O=window.innerWidth/2,R=window.innerHeight/2}c({x:O,y:R}),g.scrollIntoView({behavior:"smooth",block:"center"})}else o(null),c({x:window.innerWidth/2,y:window.innerHeight/2})},[t,u,i]);const p=()=>{h?e():a(g=>g+1)},y=()=>{m||a(g=>g-1)},b=()=>{if(!u?.position||u.position==="center")return"-translate-x-1/2 -translate-y-1/2";switch(u.position){case"top":return"-translate-x-1/2 -translate-y-full";case"bottom":return"-translate-x-1/2";case"left":return"-translate-x-full -translate-y-1/2";case"right":return"-translate-y-1/2";default:return"-translate-x-1/2 -translate-y-1/2"}};return t?d.jsx(ke,{children:d.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60"}),s&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute pointer-events-none",style:{left:s.getBoundingClientRect().left+window.pageXOffset,top:s.getBoundingClientRect().top+window.pageYOffset,width:s.getBoundingClientRect().width,height:s.getBoundingClientRect().height,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(34, 197, 94, 0.5)",borderRadius:"8px"}}),d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 max-w-sm ${b()}`,style:{left:l.x,top:l.y},children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Bt,{className:"w-5 h-5 text-green-500"}),d.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["Paso ",i+1," de ",n.length]})]}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Omitir tour",children:d.jsx(ni,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:u.title}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:u.description})]}),u.action&&d.jsx("div",{className:"mb-4",children:d.jsx(me,{variant:"outline",size:"sm",onClick:u.action.onClick,className:"w-full",children:u.action.label})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs(me,{variant:"ghost",size:"sm",onClick:y,disabled:m,className:"flex items-center gap-1",children:[d.jsx(j_,{className:"w-4 h-4"}),"Anterior"]}),d.jsx("div",{className:"flex gap-1",children:n.map((g,_)=>d.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${_===i?"bg-green-500":_<i?"bg-green-300":"bg-gray-300"}`},_))}),d.jsxs(me,{size:"sm",onClick:p,className:"flex items-center gap-1",children:[h?"Finalizar":"Siguiente",!h&&d.jsx(O_,{className:"w-4 h-4"})]})]}),d.jsx("div",{className:"mt-4 text-center",children:d.jsx("button",{onClick:r,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Omitir tour"})})]})]})}):null},_c="1.0.0",Gb="plantitas-onboarding-state",fF=()=>{const t=ar(),[e,r]=w.useState(()=>{try{const u=localStorage.getItem(Gb);if(u){const h=JSON.parse(u);return h.currentVersion!==_c?{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:_c}:h}}catch(u){console.warn("Error loading onboarding state:",u)}return{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:_c}});w.useEffect(()=>{try{localStorage.setItem(Gb,JSON.stringify(e))}catch(u){console.warn("Error saving onboarding state:",u)}},[e]);const n=u=>{r(h=>({...h,...u}))};return{state:e,shouldShowTour:()=>!e.hasCompletedTour,completeTour:()=>{n({hasCompletedTour:!0})},markFirstPlantAdded:()=>{n({hasAddedFirstPlant:!0})},markChatUsed:()=>{n({hasUsedChat:!0})},resetOnboarding:()=>{r({hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:_c})},getTourSteps:()=>[{id:"welcome",title:"¡Bienvenido a Plantitas! 🌱",description:"Tu asistente personal para el cuidado de plantas. Te ayudaremos a mantener tus plantas saludables y felices.",position:"center"},{id:"add-plant",title:"Agrega tu primera planta",description:"Usa el botón flotante para tomar una foto de tu planta. Nuestra IA la identificará automáticamente.",target:'[data-tour="add-plant-fab"]',position:"left",action:{label:"Ir a cámara",onClick:()=>t(At.toCamera())}},{id:"navigation",title:"Navegación principal",description:"Usa la navegación inferior para moverte entre el jardín, chat IA y configuraciones.",target:'[data-tour="bottom-navigation"]',position:"top"},{id:"chat-ai",title:"Chat con IA experta",description:"Haz preguntas sobre cuidado de plantas, identificación o cualquier duda que tengas.",target:'[data-tour="chat-tab"]',position:"top",action:{label:"Probar chat",onClick:()=>t(At.toGardenChat())}},{id:"search-filter",title:"Busca y organiza",description:"Usa la búsqueda y filtros para encontrar rápidamente tus plantas cuando tengas muchas.",target:'[data-tour="search-input"]',position:"bottom"},{id:"complete",title:"¡Listo para empezar! 🎉",description:"Ya conoces lo básico. ¡Comienza agregando tu primera planta y explorando todas las funciones!",position:"center"}]}},Yb=({type:t,title:e,message:r,onDismiss:n,autoHide:i=!1,duration:a=8e3,actions:s})=>{const[o,l]=w.useState(!0),c=ar();w.useEffect(()=>{if(i&&a>0){const y=setTimeout(()=>{l(!1),n?.()},a);return()=>clearTimeout(y)}},[i,a,n]);const u=()=>{l(!1),n?.()};if(!o)return null;const m={suggestion:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",accent:"text-purple-600 dark:text-purple-400",icon:ep},tip:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",accent:"text-blue-600 dark:text-blue-400",icon:Bt},welcome:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",accent:"text-green-600 dark:text-green-400",icon:pl}}[t],p=m.icon;return d.jsx(ke,{children:d.jsxs(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:`
          ${m.bg} ${m.border}
          border rounded-lg p-4 shadow-md backdrop-blur-sm
          relative overflow-hidden
        `,children:[d.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 opacity-10",children:d.jsx(p,{className:"w-full h-full"})}),d.jsxs("div",{className:"relative flex items-start gap-3",children:[d.jsx("div",{className:`${m.accent} flex-shrink-0 mt-0.5`,children:d.jsx(p,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:`${m.accent} text-sm font-semibold mb-1`,children:e}),d.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-3",children:r}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s?s.map((y,b)=>d.jsx(me,{size:"sm",variant:y.variant||"outline",onClick:y.onClick,className:"text-xs",children:y.label},b)):d.jsxs(me,{size:"sm",variant:"outline",onClick:()=>c(At.toGardenChat()),className:"text-xs flex items-center gap-1",children:["Probar Chat IA",d.jsx(SC,{className:"w-3 h-3"})]})})]}),n&&d.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar sugerencia",children:d.jsx(ni,{className:"w-4 h-4"})})]}),i&&a>0&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10",children:d.jsx(L.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:a/1e3,ease:"linear"},className:`h-full ${m.accent.replace("text-","bg-")}`})})]})})},mF=()=>{const[t,e]=w.useState(()=>{try{const a=localStorage.getItem("dismissed-ai-highlights");return a?JSON.parse(a):[]}catch{return[]}});return{dismissHighlight:a=>{const s=[...t,a];e(s);try{localStorage.setItem("dismissed-ai-highlights",JSON.stringify(s))}catch(o){console.warn("Error saving dismissed highlights:",o)}},shouldShowHighlight:a=>!t.includes(a),resetHighlights:()=>{e([]);try{localStorage.removeItem("dismissed-ai-highlights")}catch(a){console.warn("Error resetting highlights:",a)}}}},pF=()=>{const t=ar();return d.jsxs(L.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6 max-w-lg mx-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[d.jsxs(L.div,{className:"relative w-32 h-32 mb-8",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[d.jsx(R_,{className:"absolute top-2 left-2 w-10 h-10 text-sky-400 opacity-60"}),d.jsx(ml,{className:"w-32 h-32 text-green-500"}),d.jsx(id,{className:"absolute bottom-2 right-2 w-12 h-12 text-blue-400 opacity-70"})]}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"¡Comienza tu jardín digital!"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-lg leading-relaxed",children:"Añade tu primera planta tomando una foto y deja que nuestra IA la identifique y te ayude a cuidarla."}),d.jsxs("div",{className:"mb-8 space-y-3 text-left",children:[d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Identificación automática con IA"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Recordatorios de riego personalizados"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Chat con asistente experto en plantas"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[d.jsxs(me,{size:"lg",onClick:()=>t(At.toCamera()),className:"flex-1",children:[d.jsx(rp,{className:"mr-2"}),"Tomar Foto"]}),d.jsx(dm,{content:"Explora las funciones de chat IA para aprender sobre plantas",children:d.jsxs(me,{size:"lg",variant:"outline",onClick:()=>t(At.toGardenChat()),className:"flex-1",children:[d.jsx(pl,{className:"mr-2"}),"Explorar Chat IA"]})})]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6",children:"💡 Tip: Toma fotos con buena iluminación para mejores resultados"})]})},gF=()=>{const{data:t=[],isLoading:e,error:r}=Q3(),[n,i]=w.useState(""),[a,s]=w.useState("name"),{shouldShowTour:o,completeTour:l,getTourSteps:c}=fF(),{shouldShowHighlight:u,dismissHighlight:h}=mF(),m=w.useMemo(()=>[...t].filter(p=>p.name.toLowerCase().includes(n.toLowerCase())||p.species.toLowerCase().includes(n.toLowerCase())).sort((p,y)=>{switch(a){case"health":return(y.healthScore||0)-(p.healthScore||0);case"lastWatered":return(y.lastWatered?.getTime()||0)-(p.lastWatered?.getTime()||0);default:return p.name.localeCompare(y.name)}}),[t,n,a]);return e?d.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[d.jsxs("header",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),d.jsx(lF.LoadingPlants,{size:"sm"})]}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((p,y)=>d.jsx(rF,{},y))})]}):r?d.jsx("div",{className:"flex justify-center items-center min-h-[50vh] p-4",children:d.jsx(dF.LoadingPlantsError,{onRetry:()=>window.location.reload(),className:"max-w-md"})}):d.jsxs("div",{className:"container-spacing element-spacing bg-gradient-to-br from-green-50/30 via-white to-emerald-50/20 min-h-screen",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx("header",{className:"flex items-center justify-between border-b border-green-100/50 bg-white/70 backdrop-blur-sm pb-4 mb-6 rounded-xl px-4 py-3 shadow-sm shadow-green-100/20",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(dm,{content:"Tu jardín personal de plantas",children:d.jsx(ml,{size:20,strokeWidth:2,className:"text-[#2A7F3E] flex-shrink-0"})}),d.jsx("h1",{className:"font-semibold text-[28px] leading-[1.2] text-[#222]",children:"Mi Jardín"}),d.jsx(dm,{content:`Tienes ${t.length} ${t.length===1?"planta registrada":"plantas registradas"} en tu jardín`,children:d.jsxs("span",{className:"ml-2 bg-[#E0F2E9]/50 text-[#2A7F3E] text-sm font-medium rounded-full px-[6px] py-[2px] cursor-help",children:[t.length," ",t.length===1?"planta":"plantas"]})})]})}),t.length>0&&u("dashboard-ai-welcome")&&d.jsx("div",{className:"mb-4",children:d.jsx(Yb,{type:"welcome",title:"¡Tu asistente IA está disponible!",message:"Haz preguntas sobre el cuidado de tus plantas, identifica problemas o descubre nuevos consejos.",onDismiss:()=>h("dashboard-ai-welcome"),autoHide:!0,duration:1e4})}),t.length>=3&&u("dashboard-ai-tips")&&d.jsx("div",{className:"mb-4",children:d.jsx(Yb,{type:"tip",title:"Consejo del jardinero experto",message:"Con varias plantas, puedes preguntarme sobre rutinas de cuidado personalizadas para optimizar tu tiempo.",onDismiss:()=>h("dashboard-ai-tips"),autoHide:!0,duration:12e3})}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 mt-6 mb-6",children:[d.jsx(Od,{type:"text",placeholder:"Buscar por nombre o especie...",value:n,onChange:p=>i(p.target.value),className:"max-w-md w-full mx-auto","data-tour":"search-input"}),d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsxs("select",{value:a,onChange:p=>s(p.target.value),className:"appearance-none bg-white border border-green-300 rounded-[8px] px-4 py-2 h-10 text-green-700 font-medium shadow-sm focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors duration-150 w-full pr-8",style:{borderWidth:"1px"},children:[d.jsx("option",{value:"name",children:"Ordenar por Nombre"}),d.jsx("option",{value:"health",children:"Ordenar por Salud"}),d.jsx("option",{value:"lastWatered",children:"Ordenar por Riego"})]}),d.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-green-400 text-base",children:"▼"})]})]}),d.jsx(ke,{children:m.length>0?d.jsx(L.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.01,delayChildren:0}}},children:m.map((p,y)=>d.jsx(sA,{plant:p,index:Math.min(y,8)},p.id))}):d.jsx(pF,{})}),d.jsx(hF,{isOpen:o()&&t.length===0,onComplete:l,onSkip:l,steps:c()})]})};function hm(t){"@babel/helpers - typeof";return hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hm(t)}function fr(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Et(t){fr(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||hm(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var yF={};function vF(){return yF}function Tu(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function Zb(t){fr(1,arguments);var e=Et(t);return e.setHours(0,0,0,0),e}var bF=864e5;function xF(t,e){fr(2,arguments);var r=Zb(t),n=Zb(e),i=r.getTime()-Tu(r),a=n.getTime()-Tu(n);return Math.round((i-a)/bF)}function Gc(t,e){fr(2,arguments);var r=Et(t),n=Et(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function wF(t,e){fr(2,arguments);var r=Et(t),n=Et(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function Xb(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function _F(t,e){fr(2,arguments);var r=Et(t),n=Et(e),i=Xb(r,n),a=Math.abs(xF(r,n));r.setDate(r.getDate()-i*a);var s=+(Xb(r,n)===-i),o=i*(a-s);return o===0?0:o}function EF(t,e){return fr(2,arguments),Et(t).getTime()-Et(e).getTime()}var TF={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},AF="trunc";function IF(t){return TF[AF]}function SF(t){fr(1,arguments);var e=Et(t);return e.setHours(23,59,59,999),e}function PF(t){fr(1,arguments);var e=Et(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function kF(t){fr(1,arguments);var e=Et(t);return SF(e).getTime()===PF(e).getTime()}function CF(t,e){fr(2,arguments);var r=Et(t),n=Et(e),i=Gc(r,n),a=Math.abs(wF(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=Gc(r,n)===-i;kF(Et(t))&&a===1&&Gc(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function NF(t,e,r){fr(2,arguments);var n=EF(t,e)/1e3;return IF()(n)}var jF={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},OF=function(e,r,n){var i,a=jF[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function bs(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var RF={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},DF={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},MF={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},LF={date:bs({formats:RF,defaultWidth:"full"}),time:bs({formats:DF,defaultWidth:"full"}),dateTime:bs({formats:MF,defaultWidth:"full"})},$F={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},VF=function(e,r,n,i){return $F[e]};function cn(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[o]}var c=t.argumentCallback?t.argumentCallback(e):e;return i[c]}}var FF={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},zF={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},UF={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},BF={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},HF={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},WF={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qF=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},KF={ordinalNumber:qF,era:cn({values:FF,defaultWidth:"wide"}),quarter:cn({values:zF,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:cn({values:UF,defaultWidth:"wide"}),day:cn({values:BF,defaultWidth:"wide"}),dayPeriod:cn({values:HF,defaultWidth:"wide",formattingValues:WF,defaultFormattingWidth:"wide"})};function un(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?YF(o,function(h){return h.test(s)}):GF(o,function(h){return h.test(s)}),c;c=t.valueCallback?t.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;var u=e.slice(s.length);return{value:c,rest:u}}}function GF(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function YF(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function oA(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var ZF=/^(\d+)(th|st|nd|rd)?/i,XF=/\d+/i,QF={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},JF={any:[/^b/i,/^(a|c)/i]},ez={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},tz={any:[/1/i,/2/i,/3/i,/4/i]},rz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},nz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},iz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},az={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},sz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},oz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},lz={ordinalNumber:oA({matchPattern:ZF,parsePattern:XF,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:QF,defaultMatchWidth:"wide",parsePatterns:JF,defaultParseWidth:"any"}),quarter:un({matchPatterns:ez,defaultMatchWidth:"wide",parsePatterns:tz,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:rz,defaultMatchWidth:"wide",parsePatterns:nz,defaultParseWidth:"any"}),day:un({matchPatterns:iz,defaultMatchWidth:"wide",parsePatterns:az,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:sz,defaultMatchWidth:"any",parsePatterns:oz,defaultParseWidth:"any"})},cz={code:"en-US",formatDistance:OF,formatLong:LF,formatRelative:VF,localize:KF,match:lz,options:{weekStartsOn:0,firstWeekContainsDate:1}};function lA(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function uz(t){return lA({},t)}var Qb=1440,dz=2520,tf=43200,hz=86400;function fz(t,e,r){var n,i;fr(2,arguments);var a=vF(),s=(n=(i=r?.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:cz;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=Gc(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var l=lA(uz(r),{addSuffix:!!r?.addSuffix,comparison:o}),c,u;o>0?(c=Et(e),u=Et(t)):(c=Et(t),u=Et(e));var h=NF(u,c),m=(Tu(u)-Tu(c))/1e3,p=Math.round((h-m)/60),y;if(p<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):p===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",p,l);if(p<45)return s.formatDistance("xMinutes",p,l);if(p<90)return s.formatDistance("aboutXHours",1,l);if(p<Qb){var b=Math.round(p/60);return s.formatDistance("aboutXHours",b,l)}else{if(p<dz)return s.formatDistance("xDays",1,l);if(p<tf){var g=Math.round(p/Qb);return s.formatDistance("xDays",g,l)}else if(p<hz)return y=Math.round(p/tf),s.formatDistance("aboutXMonths",y,l)}if(y=CF(u,c),y<12){var _=Math.round(p/tf);return s.formatDistance("xMonths",_,l)}else{var T=y%12,E=Math.floor(y/12);return T<3?s.formatDistance("aboutXYears",E,l):T<9?s.formatDistance("overXYears",E,l):s.formatDistance("almostXYears",E+1,l)}}function cA(t,e){return fr(1,arguments),fz(t,Date.now(),e)}const mz=async t=>{const{data:e,error:r}=await _t.from("plants").select(`
      *,
      plant_images(*)
    `).eq("id",t).single();if(r)throw console.error(`Error fetching plant ${t}:`,r),r.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");const n=e;return{id:n.id,name:n.name,species:n.species,description:n.description??void 0,funFacts:n.fun_facts??void 0,variety:n.variety??void 0,nickname:n.nickname??void 0,location:n.location,plantEnvironment:n.plant_environment,lightRequirements:n.light_requirements,dateAdded:new Date(n.date_added),lastWatered:n.last_watered?new Date(n.last_watered):void 0,lastFertilized:n.last_fertilized?new Date(n.last_fertilized):void 0,healthScore:n.health_score??0,careProfile:n.care_profile,personality:n.personality,images:n.plant_images.map(i=>({id:i.id,url:i.url??"",timestamp:new Date(i.created_at),isProfileImage:i.is_profile_image??!1,healthAnalysis:i.health_analysis})),chatHistory:[],notifications:[]}},fg=t=>{const{data:e,isLoading:r,error:n}=E_({queryKey:["plant",t],queryFn:async()=>mz(t),enabled:!!t,staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1}),i=qn(o=>o.setPlant),a=qn(o=>o.selectPlant);w.useEffect(()=>(e&&(i(e),a(e.id)),()=>{a(null)}),[e,i,a]);const s=w.useMemo(()=>{if(!e)return[];const o=[];if(!e.images||e.images.length===0)return o;const l=e.images.map(c=>c.healthAnalysis?.confidence||null).filter(c=>c!==null);if(l.length>=3){const c=l.slice(-3);if(c[0]>c[1]&&c[1]>c[2]){const u=c[0]-c[2];o.push({type:"warning",title:"Tendencia de Salud a la Baja",message:`La salud de tu planta ha disminuido un ${u.toFixed(0)}% en las últimas revisiones.`})}}if(e.lastWatered&&e.careProfile){const c=_F(new Date,new Date(e.lastWatered)),u=e.careProfile.wateringFrequency;c>u&&o.push({type:"tip",title:"Consejo de Riego",message:`Han pasado ${c} días desde el último riego. El intervalo recomendado es de ${u} días.`})}return o},[e]);return{plant:e,insights:s,loading:r,error:n?.message||null}},pz=()=>{const t=nd(),r=Cn(o=>o.user)?.id,{addToast:n}=zs(),i=Ti({mutationFn:async({plantId:o,imageDataUrl:l,note:c})=>{if(!r)throw new Error("User not authenticated");console.log("🖼️ [Image] Iniciando proceso de subida de imagen..."),console.log("🔬 [Image] Analizando imagen con IA...");const u=await iA(l);console.log("☁️ [Image] Subiendo imagen a Storage...");const h=await kT(l,"plant-images",`${r}/${o}`);console.log("💾 [Image] Guardando registro en base de datos...");const m=await ds.addPlantImage(o,{url:h,timestamp:new Date,isProfileImage:!1,healthAnalysis:u.health},r);return u.health?.confidence&&(console.log("🏥 [Image] Actualizando health score de la planta..."),await ds.updatePlantHealthScore(o,r,u.health.confidence,u.health,m.id)),console.log("✅ [Image] Proceso completado exitosamente"),{image:m,analysis:u,note:c}},onSuccess:(o,l)=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",l.plantId]});const{setPlant:c}=qn.getState(),u=qn.getState().getPlantById(l.plantId);if(u){const h={...u,images:[...u.images,o.image],healthScore:o.analysis.health?.confidence||u.healthScore};c(h)}n({type:"success",title:"Nueva imagen añadida",message:`Análisis completado. Salud actual: ${o.analysis.health?.confidence?.toFixed(0)||"N/A"}%`})},onError:o=>{console.error("💥 [Image] Error en proceso de subida:",o),n({type:"error",title:"Error al agregar imagen",message:o.message})}}),a=Ti({mutationFn:async({plantId:o,imageId:l})=>{if(!r)throw new Error("User not authenticated");return console.log("🖼️ [Profile] Cambiando imagen de perfil..."),await ds.setProfileImage(o,l,r),{plantId:o,imageId:l}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen de perfil actualizada",message:"La imagen principal de la planta ha sido cambiada"})},onError:o=>{n({type:"error",title:"Error al cambiar imagen de perfil",message:o.message})}}),s=Ti({mutationFn:async({plantId:o,imageId:l})=>{if(!r)throw new Error("User not authenticated");return console.log("🗑️ [Image] Eliminando imagen..."),await ds.deleteImage(l,r),{plantId:o,imageId:l}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen eliminada",message:"La imagen ha sido eliminada de tu planta"})},onError:o=>{n({type:"error",title:"Error al eliminar imagen",message:o.message})}});return{addPlantImage:i.mutate,isAddingImage:i.isPending,setProfileImage:a.mutate,isSettingProfileImage:a.isPending,deleteImage:s.mutate,isDeletingImage:s.isPending}};function gz({images:t}){const[e,r]=w.useState(null);if(!t||t.length===0)return d.jsx(Sr,{className:"mt-4",children:d.jsx(Jn,{className:"pt-6",children:d.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[d.jsx(_n,{className:"w-12 h-12 text-muted-foreground mb-4"}),d.jsx("p",{className:"text-muted-foreground",children:"No hay imágenes para esta planta todavía."}),d.jsx("p",{className:"text-sm text-muted-foreground/70 mt-2",children:"¡Agrega algunas fotos para seguir su progreso!"})]})})});const n=[...t].sort((l,c)=>new Date(c.timestamp).getTime()-new Date(l.timestamp).getTime()),i=l=>{r(l)},a=()=>{r(null)},s=l=>{if(e===null)return;const c=l==="prev"?(e-1+n.length)%n.length:(e+1)%n.length;r(c)},o=l=>(l instanceof Date?l:new Date(l)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"});return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold tracking-tight flex items-center",children:[d.jsx(_n,{className:"w-5 h-5 mr-2 text-primary"}),"Galería de Imágenes"]}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," foto",n.length!==1?"s":""]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((l,c)=>d.jsxs(L.div,{className:"aspect-square relative rounded-[8px] overflow-hidden cursor-pointer group w-[80px] h-[80px]",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(c),children:[d.jsx(hg,{src:l.url,alt:`Imagen de planta del ${o(l.timestamp)}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 rounded-[8px]"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:d.jsx("div",{className:"flex items-center text-white text-xs gap-2",children:d.jsxs("span",{className:"flex items-center",children:[d.jsx(Xc,{className:"w-3 h-3 mr-1"}),o(l.timestamp)]})})})}),l.isProfileImage&&d.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full font-medium",children:"Principal"})]},l.id))}),d.jsx(ke,{children:e!==null&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a,children:d.jsxs(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:l=>l.stopPropagation(),children:[d.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(ni,{className:"w-6 h-6"})}),n.length>1&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>s("prev"),className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(j_,{className:"w-6 h-6"})}),d.jsx("button",{onClick:()=>s("next"),className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(O_,{className:"w-6 h-6"})})]}),d.jsx("img",{src:n[e].url,alt:`Imagen de planta del ${o(n[e].timestamp)}`,className:"max-w-full max-h-full object-contain rounded-lg"}),d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-black/50 text-white p-4 rounded-lg backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Xc,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm",children:o(n[e].timestamp)})]}),d.jsxs("span",{className:"text-sm text-white/70",children:[e+1," de ",n.length]})]}),d.jsx("div",{className:"mt-2 text-sm flex items-center gap-2",children:(()=>{const l=n[e].healthAnalysis;if(!l)return d.jsx("span",{className:"italic text-white/60",children:"Sin análisis"});let c="🌱",u="Excelente";switch(l.overallHealth){case"excellent":c="🌱",u="Excelente";break;case"good":c="🌿",u="Buena";break;case"fair":c="🍃",u="Regular";break;case"poor":c="🥀",u="Baja";break;default:c="🌱",u=l.overallHealth}let h;const m={excellent:95,good:80,fair:60,poor:30};return l.overallHealth&&m[l.overallHealth]?h=m[l.overallHealth]:typeof l.confidence=="number"&&(h=l.confidence<=1?l.confidence*100:l.confidence),d.jsxs("span",{children:["Salud: ",d.jsx("span",{className:"font-semibold",children:u})," ",d.jsx("span",{children:c}),h!==void 0&&d.jsxs("span",{className:"ml-2",children:["(",Math.round(h),"%)"]})]})})()}),n[e].isProfileImage&&d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:"Imagen Principal"})})]})]})})})]})}const yz=new cg,vz=()=>{const[t,e]=w.useState(!1),r=nd(),n=Cn(o=>o.user),{addToast:i}=zs(),a=Ti({mutationFn:async({plantId:o,species:l,commonName:c})=>{if(!n)throw new Error("User not authenticated");e(!0),i({type:"info",title:"🤖 Completando información",message:`Consultando IA para ${c||l}...`,duration:3e3});try{const u=await O3(l,c);return await yz.updatePlantInfo(o,n.id,{plantEnvironment:u.plantEnvironment,lightRequirements:u.lightRequirements,description:u.description,funFacts:u.funFacts})}catch(u){throw console.error("❌ [COMPLETAR IA] Error durante el proceso:",u),u}finally{e(!1)}},onSuccess:o=>{console.log("🔄 [COMPLETAR IA] Refrescando datos en cache..."),i({type:"success",title:"✅ ¡Información completada!",message:`Se agregaron datos de ambiente y luz para ${o.name}`,duration:5e3}),r.invalidateQueries({queryKey:["plant",o.id]}),r.invalidateQueries({queryKey:["plants"]}),console.log("✅ [COMPLETAR IA] Cache actualizado correctamente")},onError:o=>{console.error("💥 [COMPLETAR IA] Error final en la operación:",o),i({type:"error",title:"❌ Error al completar información",message:"No se pudo obtener los datos de IA. Intenta de nuevo.",duration:7e3}),e(!1)}});return{completeInfo:(o,l,c)=>a.mutate({plantId:o,species:l,commonName:c}),isCompleting:t||a.isPending,error:a.error,isSuccess:a.isSuccess}},bz=({isOpen:t,onClose:e,onConfirm:r,title:n,description:i,confirmText:a="Confirmar",cancelText:s="Cancelar",variant:o="warning",isLoading:l=!1,preview:c})=>{const h={danger:{iconColor:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",confirmColor:"destructive"},warning:{iconColor:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",confirmColor:"warning"},info:{iconColor:"text-blue-500",bgColor:"bg-blue-50 dark:bg-blue-900/20",confirmColor:"primary"}}[o];return d.jsx(ke,{children:t&&d.jsx(d.Fragment,{children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:m=>m.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[d.jsx("div",{className:"p-6 pb-4",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:`${h.bgColor} p-3 rounded-full flex-shrink-0`,children:d.jsx(Jr,{className:`w-6 h-6 ${h.iconColor}`})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:n}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:i})]}),d.jsx("button",{onClick:e,disabled:l,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar diálogo",children:d.jsx(ni,{className:"w-5 h-5"})})]})}),c&&d.jsx("div",{className:"px-6 pb-4",children:d.jsx("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50",children:c})}),d.jsxs("div",{className:"px-6 pb-6 flex gap-3 justify-end",children:[d.jsx(me,{variant:"outline",onClick:e,disabled:l,className:"min-w-[80px]",children:s}),d.jsx(me,{variant:h.confirmColor,onClick:r,disabled:l,loading:l,className:"min-w-[80px]",children:a})]})]})})})})},xz=({plant:t,variant:e="primary",size:r="sm",showLabel:n=!0,className:i=""})=>{const{updatePlantHealthMutation:a,isUpdatingPlantHealth:s}=Nd(),o=Cn(p=>p.user),{addToast:l}=zs(),{plant:c}=fg(t.id),u=async()=>{if(!o?.id){l({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnóstico"});return}if(!c){l({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log("🩺 [Button] Actualizando diagnóstico para:",t.name),a({plant:c,userId:o.id})},h=d.jsxs(d.Fragment,{children:[s?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(ji,{size:r.includes("icon")?16:14})}):d.jsx(D_,{size:r.includes("icon")?16:14}),n&&!r.includes("icon")&&d.jsx("span",{className:"ml-2 text-xs",children:s?"Analizando...":"Analizar"})]}),m=r.includes("icon");return d.jsx(me,{onClick:u,disabled:s||!c,size:r,variant:e,className:i,"aria-label":m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,title:m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,children:h})},wz=({plant:t})=>{const e=ar(),[r,n]=w.useState(!1),[i,a]=w.useState(!1),{deletePlant:s,isDeletingPlant:o}=Nd(),{completeInfo:l,isCompleting:c}=vz(),{scrollY:u}=PC(),h=kv(u,[0,300],[0,150]),m=kv(u,[0,200],[1,.3]),p=t.images?.find(k=>k.isProfileImage)||t.images?.[0],y=!t.plantEnvironment||!t.lightRequirements,b=()=>{a(!0),n(!1)},g=()=>{s(t.id,{onSuccess:()=>{e("/")}})},_=()=>{console.log("🎯 [UI] Usuario solicitó completar información con IA"),console.log("🌱 [UI] Datos de la planta:",{id:t.id,nombre:t.name,especie:t.species,ambienteActual:t.plantEnvironment||"No especificado",luzActual:t.lightRequirements||"No especificado"}),n(!1),a(!0)},T=()=>{console.log("✅ [UI] Usuario confirmó el completado automático"),a(!1),l(t.id,t.species,t.name)},E=()=>{console.log("❌ [UI] Usuario canceló el completado automático"),a(!1)},O=k=>(k instanceof Date?k:new Date(k)).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),R=k=>{switch(k){case"interior":return d.jsx(Zc,{className:"w-4 h-4 mr-2"});case"exterior":return d.jsx(Cv,{className:"w-4 h-4 mr-2"});case"ambos":return d.jsxs(d.Fragment,{children:[d.jsx(Zc,{className:"w-3 h-3 mr-1"}),d.jsx(Cv,{className:"w-3 h-3 mr-1"})]});default:return null}},D=k=>{switch(k){case"interior":return"Interior";case"exterior":return"Exterior";case"ambos":return"Interior/Exterior";default:return null}},I=k=>{switch(k){case"poca_luz":return d.jsx(kC,{className:"w-4 h-4 mr-2"});case"luz_indirecta":return d.jsx(Ii,{className:"w-4 h-4 mr-2 opacity-60"});case"luz_directa_parcial":return d.jsx(Ii,{className:"w-4 h-4 mr-2 opacity-80"});case"pleno_sol":return d.jsx(Ii,{className:"w-4 h-4 mr-2"});default:return null}},A=k=>{switch(k){case"poca_luz":return"Poca luz";case"luz_indirecta":return"Luz indirecta";case"luz_directa_parcial":return"Sol parcial";case"pleno_sol":return"Pleno sol";default:return null}},P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},j={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:120}}},N={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6}}};return w.useEffect(()=>{const k=()=>n(!1);if(r)return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[r]),d.jsxs(L.div,{className:"relative h-96 w-full overflow-hidden",variants:P,initial:"hidden",animate:"visible",children:[d.jsx(L.div,{className:"absolute inset-0 scale-110",style:{y:h,opacity:m},children:p?d.jsx(hg,{src:p.url,alt:t.name,className:"h-full w-full object-cover"}):d.jsx("div",{className:"h-full w-full bg-gradient-to-br from-green-400 via-green-500 to-green-600",children:d.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})})}),d.jsxs(L.div,{className:"absolute inset-0",variants:N,children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,0.6)] to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/30"}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background/60 to-transparent"})]}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top z-20",children:d.jsxs(L.div,{className:"flex items-center justify-between",variants:j,children:[d.jsx(me,{"aria-label":"Volver atrás",variant:"ghost",size:"icon",onClick:()=>e("/"),className:"bg-black/30 text-white backdrop-blur-lg rounded-full border border-white/20 hover:bg-black/50 transition-all duration-300",children:d.jsx(ip,{size:20})}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("div",{className:"relative",children:[d.jsx(me,{"aria-label":"Más opciones",variant:"ghost",size:"icon",onClick:k=>{k.stopPropagation(),n(C=>!C)},className:"bg-neutral-800/90 text-white backdrop-blur-lg rounded-full border border-neutral-600 hover:bg-neutral-700 transition-all duration-300 dark:bg-neutral-200/90 dark:text-neutral-900 dark:border-neutral-400 dark:hover:bg-neutral-300",children:d.jsx(M_,{size:20})}),d.jsx(ke,{children:r&&d.jsx(L.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 mt-2 w-48 origin-top-right rounded-xl bg-background/95 backdrop-blur-lg shadow-xl ring-1 ring-black/10 focus:outline-none z-30 border border-border/50",onClick:k=>k.stopPropagation(),children:d.jsxs("div",{className:"py-2",children:[y&&d.jsxs("button",{onClick:_,disabled:c,className:"flex w-full items-center px-4 py-3 text-sm text-contrast-high hover:bg-contrast-surface transition-colors rounded-lg mx-2",children:[c?d.jsx(ya,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(Bt,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:c?"Completando...":"Completar con IA"})]}),d.jsx("div",{className:"flex w-full items-center px-2 py-1",children:d.jsx(xz,{plant:t,variant:"outline",size:"sm",showLabel:!0,className:"w-full"})}),d.jsxs("button",{onClick:b,disabled:o,className:"flex w-full items-center px-4 py-3 text-sm text-error-600 dark:text-error-500 hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors rounded-lg mx-2 font-medium",children:[o?d.jsx(ya,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(C_,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:o?"Eliminando...":"Eliminar planta"})]})]})})})]})})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom z-10",children:d.jsxs(L.div,{className:"space-y-4",variants:j,children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(L.h1,{className:"text-[24px] font-bold text-white drop-shadow-lg",variants:j,children:t.nickname||t.name}),d.jsx(L.p,{className:"text-[16px] text-white/90 font-medium",variants:j,children:t.species})]}),d.jsxs(L.div,{className:"flex flex-wrap gap-2 pt-2 max-h-32 overflow-y-auto",variants:j,children:[t.location&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(L_,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm font-medium",children:t.location})]}),t.dateAdded&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(Xc,{className:"w-4 h-4 mr-2"}),d.jsxs("span",{className:"text-sm font-medium",children:["Desde ",O(t.dateAdded)]})]}),t.plantEnvironment&&D(t.plantEnvironment)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[R(t.plantEnvironment),d.jsx("span",{className:"text-sm font-medium",children:D(t.plantEnvironment)})]}),t.lightRequirements&&A(t.lightRequirements)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[I(t.lightRequirements),d.jsx("span",{className:"text-sm font-medium",children:A(t.lightRequirements)})]}),t.images&&t.images.length>0&&d.jsx("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:d.jsxs("span",{className:"text-sm font-medium",children:[t.images.length," foto",t.images.length!==1?"s":""]})})]})]})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:E,children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:k=>k.stopPropagation(),className:"bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[d.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:d.jsx(Bt,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Completar con IA"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Información automática"})]})]}),d.jsxs("div",{className:"space-y-3 mb-6",children:[d.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"¿Quieres que la IA complete la información faltante de esta planta?"}),d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🌱"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🔬"}),d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.species})]})]}),d.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d.jsx("p",{className:"font-medium mb-1",children:"La IA agregará:"}),d.jsxs("ul",{className:"space-y-1",children:[d.jsx("li",{children:"• Ambiente recomendado (interior/exterior)"}),d.jsx("li",{children:"• Necesidades de luz específicas"})]})]})]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx(me,{variant:"outline",onClick:E,className:"flex-1",disabled:c,children:"Cancelar"}),d.jsx(me,{onClick:T,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",disabled:c,children:c?d.jsxs(d.Fragment,{children:[d.jsx(ya,{className:"w-4 h-4 mr-2 animate-spin"}),"Completando..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Bt,{className:"w-4 h-4 mr-2"}),"Completar"]})})]})]})})}),d.jsx(bz,{isOpen:i,onClose:()=>a(!1),onConfirm:g,title:"Eliminar Planta",description:`¿Estás seguro de que quieres eliminar "${t.nickname||t.name}"? Esta acción es irreversible y se perderán todos los datos, fotos y mensajes de chat asociados.`,confirmText:"Eliminar Definitivamente",cancelText:"Cancelar",variant:"danger",isLoading:o,preview:d.jsxs("div",{className:"flex items-center gap-3",children:[p&&d.jsx("img",{src:p.url,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[t.species," • ",t.images?.length||0," fotos"]})]})]})})]})},_z=({plant:t})=>{const{careProfile:e,personality:r}=t;if(!e)return d.jsx("div",{className:"bg-background p-6 rounded-lg shadow-lg w-full text-center",children:d.jsx("p",{className:"text-muted-foreground",children:"No hay perfil de cuidados disponible para esta planta."})});const n=[{icon:d.jsx(id,{size:20,strokeWidth:2,color:"#555"}),label:"RIEGO",value:`Cada ${e.wateringFrequency} días`},{icon:d.jsx(Ii,{size:20,strokeWidth:2,color:"#555"}),label:"LUZ SOLAR",value:e.sunlightRequirement},{icon:d.jsx(R_,{size:20,strokeWidth:2,color:"#555"}),label:"HUMEDAD",value:e.humidityPreference},{icon:d.jsx($_,{size:20,strokeWidth:2,color:"#555"}),label:"TEMPERATURA IDEAL",value:`${e.temperatureRange.min}°C - ${e.temperatureRange.max}°C`},{icon:d.jsx(Bt,{size:20,strokeWidth:2,color:"#555"}),label:"FERTILIZACIÓN",value:`Cada ${e.fertilizingFrequency} días`},{icon:d.jsx(ap,{size:20,strokeWidth:2,color:"#555"}),label:"TIPO DE SUELO",value:e.soilType}];return d.jsxs("div",{className:"w-full",style:{lineHeight:"1.4"},children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-6 mb-4",style:{gap:"24px 16px"},children:n.map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start",children:[d.jsxs("div",{className:"flex items-center mb-1",children:[i.icon,d.jsx("span",{className:"ml-2 text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:i.label})]}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i.value})]},a))}),e.specialCare&&e.specialCare.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Cuidados Especiales"}),d.jsx("ul",{className:"list-none pl-0 ml-4",style:{lineHeight:"1.5"},children:e.specialCare.map((i,a)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:i})]},a))})]}),d.jsx("hr",{className:"my-6",style:{border:"none",borderTop:"1px solid #EEE",margin:"24px 0"}}),r&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx(Uo,{size:20,strokeWidth:2,color:"#555",className:"mr-2"}),d.jsx("span",{className:"text-[18px] font-semibold text-[#333]",children:"Personalidad de la Planta"})]}),r.communicationStyle&&d.jsx("div",{className:Array.isArray(r.communicationStyle)&&r.communicationStyle.length>1?"grid grid-cols-2 gap-x-4 mb-3":"flex justify-center mb-3",children:(Array.isArray(r.communicationStyle)?r.communicationStyle:[r.communicationStyle]).map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start mb-2",children:[d.jsx("span",{className:"text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:"ESTILO"}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i})]},a))}),r.catchphrases&&r.catchphrases.length>0&&d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mb-2",children:"Frases Típicas"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:r.catchphrases.map((i,a)=>d.jsx("span",{className:"inline-block bg-[#F0FDF6] text-[#046A38] text-[14px] px-2 py-1 rounded-[4px] font-medium",style:{padding:"4px 8px",marginRight:8,marginBottom:8},children:i},a))})]})]})]})},Ez=({funFacts:t})=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsxs(L.div,{className:"bg-white/0 dark:bg-transparent p-3 sm:p-4 w-full",variants:e,initial:"hidden",animate:"visible",children:[t&&t.length>0&&d.jsxs(L.div,{variants:r,children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-full mr-4",children:d.jsx(Bt,{className:"w-6 h-6 text-yellow-500"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Datos Curiosos"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Descubre cosas increíbles sobre esta planta"})]})]}),d.jsx("div",{className:"grid gap-4",children:t.map((n,i)=>d.jsxs(L.div,{className:"group flex items-start bg-yellow-500/5 hover:bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 transition-all duration-300 hover:shadow-md",variants:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[d.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:d.jsxs("div",{className:"relative",children:[d.jsx(V_,{className:"w-5 h-5 text-yellow-500 group-hover:text-yellow-600 transition-colors"}),d.jsx("div",{className:"absolute -inset-2 bg-yellow-500/20 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pulse"})]})}),d.jsx("p",{className:"text-foreground/90 leading-relaxed font-medium group-hover:text-foreground transition-colors",children:n})]},i))})]}),(!t||t.length===0)&&d.jsx(L.div,{className:"mt-8 flex items-center justify-center p-6 bg-muted/30 rounded-xl border border-dashed border-muted-foreground/20",variants:r,children:d.jsxs("div",{className:"text-center",children:[d.jsx(Bt,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),d.jsx("p",{className:"text-muted-foreground font-medium",children:"No hay datos curiosos disponibles"}),d.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"¡Pronto agregaremos información interesante!"})]})})]})},Tz=()=>d.jsx(ml,{className:"w-5 h-5 text-[#EF9A9A]","aria-label":"Problema de hoja seca"}),Az=({analysis:t})=>{if(!t)return null;const e=t.issues&&t.issues.length>0;return d.jsxs("div",{className:"w-full",role:"region","aria-label":"Análisis de salud de la planta",style:{lineHeight:"1.4"},children:[e?d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[16px] text-[#333] mt-3",children:"Problemas Detectados"}),d.jsxs("p",{className:"mb-2 text-[14px] text-[#D32F2F] font-medium",style:{marginTop:12,marginBottom:8},children:[t.issues.length," problema",t.issues.length!==1?"s":""," detectado",t.issues.length!==1?"s":""]}),d.jsx("ul",{className:"",children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start",style:{marginBottom:n<t.issues.length-1?16:0,paddingBottom:n<t.issues.length-1?16:0,borderBottom:n<t.issues.length-1?"1px solid #EEE":"none"},children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center mt-1",children:Tz()}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"font-semibold text-[15px] text-[#333]",children:r.type}),d.jsx("p",{className:"text-[14px] text-[#555] mt-1",children:r.description})]})]},n))}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Tratamientos Sugeridos"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r.treatment})]},n))})]})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[d.jsx("span",{className:"text-4xl mb-2",role:"img","aria-label":"Planta saludable",children:"🌱"}),d.jsx(CC,{className:"w-12 h-12 text-green-500 mb-3","aria-label":"Todo en orden"}),d.jsxs("h4",{className:"font-semibold text-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:["¡Todo en orden!",d.jsx("span",{className:"text-base","aria-hidden":"true",children:"🌱"})]}),d.jsx("p",{className:"text-muted-foreground",children:"El análisis inicial no detectó problemas de salud significativos."})]}),t.recommendations&&t.recommendations.length>0&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Recomendaciones Adicionales"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.recommendations.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r})]},n))})]})]})};var Rd={},uA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(uA);var mg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(mg);var pg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(pg);var Dd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const c=r[a];o?c==="\\"&&a+1<i?(a++,s+=r[a]):c===o?o="":s+=c:l?c==='"'||c==="'"?o=c:c==="]"?(l=!1,n.push(s),s=""):s+=c:c==="["?(l=!0,s&&(n.push(s),s="")):c==="."?s&&(n.push(s),s=""):s+=c,a++}return s&&n.push(s),n}t.toPath=e})(Dd);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uA,r=mg,n=pg,i=Dd;function a(o,l,c){if(o==null)return c;switch(typeof l){case"string":{if(e.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?r.isDeepKey(l)?a(o,i.toPath(l),c):c:u}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const u=o[l];return u===void 0?c:u}default:{if(Array.isArray(l))return s(o,l,c);if(Object.is(l?.valueOf(),-0)?l="-0":l=String(l),e.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?c:u}}}function s(o,l,c){if(l.length===0)return c;let u=o;for(let h=0;h<l.length;h++){if(u==null||e.isUnsafeProperty(l[h]))return c;u=u[l[h]]}return u===void 0?c:u}t.get=a})(Rd);var Iz=Rd.get;const Da=Ui(Iz);var dA={exports:{}},$e={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg=Symbol.for("react.transitional.element"),yg=Symbol.for("react.portal"),Md=Symbol.for("react.fragment"),Ld=Symbol.for("react.strict_mode"),$d=Symbol.for("react.profiler"),Vd=Symbol.for("react.consumer"),Fd=Symbol.for("react.context"),zd=Symbol.for("react.forward_ref"),Ud=Symbol.for("react.suspense"),Bd=Symbol.for("react.suspense_list"),Hd=Symbol.for("react.memo"),Wd=Symbol.for("react.lazy"),Sz=Symbol.for("react.view_transition"),Pz=Symbol.for("react.client.reference");function zr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case gg:switch(t=t.type,t){case Md:case $d:case Ld:case Ud:case Bd:case Sz:return t;default:switch(t=t&&t.$$typeof,t){case Fd:case zd:case Wd:case Hd:return t;case Vd:return t;default:return e}}case yg:return e}}}$e.ContextConsumer=Vd;$e.ContextProvider=Fd;$e.Element=gg;$e.ForwardRef=zd;$e.Fragment=Md;$e.Lazy=Wd;$e.Memo=Hd;$e.Portal=yg;$e.Profiler=$d;$e.StrictMode=Ld;$e.Suspense=Ud;$e.SuspenseList=Bd;$e.isContextConsumer=function(t){return zr(t)===Vd};$e.isContextProvider=function(t){return zr(t)===Fd};$e.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===gg};$e.isForwardRef=function(t){return zr(t)===zd};$e.isFragment=function(t){return zr(t)===Md};$e.isLazy=function(t){return zr(t)===Wd};$e.isMemo=function(t){return zr(t)===Hd};$e.isPortal=function(t){return zr(t)===yg};$e.isProfiler=function(t){return zr(t)===$d};$e.isStrictMode=function(t){return zr(t)===Ld};$e.isSuspense=function(t){return zr(t)===Ud};$e.isSuspenseList=function(t){return zr(t)===Bd};$e.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Md||t===$d||t===Ld||t===Ud||t===Bd||typeof t=="object"&&t!==null&&(t.$$typeof===Wd||t.$$typeof===Hd||t.$$typeof===Fd||t.$$typeof===Vd||t.$$typeof===zd||t.$$typeof===Pz||t.getModuleId!==void 0)};$e.typeOf=zr;dA.exports=$e;var kz=dA.exports,Dr=t=>t===0?0:t>0?1:-1,$r=t=>typeof t=="number"&&t!=+t,ha=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,te=t=>(typeof t=="number"||t instanceof Number)&&!$r(t),In=t=>te(t)||typeof t=="string",Cz=0,il=t=>{var e=++Cz;return"".concat(t||"").concat(e)},Fi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!te(e)&&typeof e!="string")return n;var a;if(ha(e)){if(r==null)return n;var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return $r(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},hA=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},mo=(t,e)=>te(t)&&te(e)?r=>t+r*(e-t):()=>e;function fA(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Da(n,e))===r)}var lt=t=>t===null||typeof t>"u",vg=t=>lt(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),Nz=["viewBox","children"],jz=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Jb=["points","pathLength"],rf={svg:Nz,polygon:Jb,polyline:Jb},bg=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],xg=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(w.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{bg.includes(i)&&(n[i]=a=>r[i](r,a))}),n},Oz=(t,e,r)=>n=>(t(e,r,n),null),Rz=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];bg.includes(i)&&typeof a=="function"&&(n||(n={}),n[i]=Oz(a,e,r))}),n},ex=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",tx=null,nf=null,mA=t=>{if(t===tx&&Array.isArray(nf))return nf;var e=[];return w.Children.forEach(t,r=>{lt(r)||(kz.isFragment(r)?e=e.concat(mA(r.props.children)):e.push(r))}),nf=e,tx=t,e};function pA(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>ex(i)):n=[ex(e)],mA(t).forEach(i=>{var a=Da(i,"type.displayName")||Da(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var gA=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,Dz=(t,e,r,n)=>{var i,a=(i=n&&rf?.[n])!==null&&i!==void 0?i:[];return e.startsWith("data-")||typeof t!="function"&&(n&&a.includes(e)||jz.includes(e))||r&&bg.includes(e)},qe=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;Dz((s=n)===null||s===void 0?void 0:s[a],a,e,r)&&(i[a]=n[a])}),i},Mz=["children","width","height","viewBox","className","style","title","desc"];function fm(){return fm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fm.apply(null,arguments)}function Lz(t,e){if(t==null)return{};var r,n,i=$z(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function $z(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yA=w.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:l,desc:c}=t,u=Lz(t,Mz),h=a||{width:n,height:i,x:0,y:0},m=Me("recharts-surface",s);return w.createElement("svg",fm({},qe(u,!0,"svg"),{className:m,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),w.createElement("title",null,l),w.createElement("desc",null,c),r)}),Vz=["children","className"];function mm(){return mm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mm.apply(null,arguments)}function Fz(t,e){if(t==null)return{};var r,n,i=zz(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function zz(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zi=w.forwardRef((t,e)=>{var{children:r,className:n}=t,i=Fz(t,Vz),a=Me("recharts-layer",n);return w.createElement("g",mm({className:a},qe(i,!0),{ref:e}),r)}),Uz=w.createContext(null);function nt(t){return function(){return t}}const pm=Math.PI,gm=2*pm,oa=1e-6,Bz=gm-oa;function vA(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Hz(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return vA;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class Wz{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?vA:Hz(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=n-e,c=i-r,u=s-e,h=o-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>oa)if(!(Math.abs(h*l-c*u)>oa)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-s,y=i-o,b=l*l+c*c,g=p*p+y*y,_=Math.sqrt(b),T=Math.sqrt(m),E=a*Math.tan((pm-Math.acos((b+m-g)/(2*_*T)))/2),O=E/T,R=E/_;Math.abs(O-1)>oa&&this._append`L${e+O*u},${r+O*h}`,this._append`A${a},${a},0,0,${+(h*p>u*y)},${this._x1=e+R*l},${this._y1=r+R*c}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),l=n*Math.sin(i),c=e+o,u=r+l,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>oa||Math.abs(this._y1-u)>oa)&&this._append`L${c},${u}`,n&&(m<0&&(m=m%gm+gm),m>Bz?this._append`A${n},${n},0,1,${h},${e-o},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=u}`:m>oa&&this._append`A${n},${n},0,${+(m>=pm)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function bA(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new Wz(e)}function wg(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xA(t){this._context=t}xA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function qd(t){return new xA(t)}function wA(t){return t[0]}function _A(t){return t[1]}function EA(t,e){var r=nt(!0),n=null,i=qd,a=null,s=bA(o);t=typeof t=="function"?t:t===void 0?wA:nt(t),e=typeof e=="function"?e:e===void 0?_A:nt(e);function o(l){var c,u=(l=wg(l)).length,h,m=!1,p;for(n==null&&(a=i(p=s())),c=0;c<=u;++c)!(c<u&&r(h=l[c],c,l))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(h,c,l),+e(h,c,l));if(p)return a=null,p+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:nt(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:nt(+l),o):e},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:nt(!!l),o):r},o.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),o):i},o.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),o):n},o}function Ec(t,e,r){var n=null,i=nt(!0),a=null,s=qd,o=null,l=bA(c);t=typeof t=="function"?t:t===void 0?wA:nt(+t),e=typeof e=="function"?e:nt(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?_A:nt(+r);function c(h){var m,p,y,b=(h=wg(h)).length,g,_=!1,T,E=new Array(b),O=new Array(b);for(a==null&&(o=s(T=l())),m=0;m<=b;++m){if(!(m<b&&i(g=h[m],m,h))===_)if(_=!_)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),y=m-1;y>=p;--y)o.point(E[y],O[y]);o.lineEnd(),o.areaEnd()}_&&(E[m]=+t(g,m,h),O[m]=+e(g,m,h),o.point(n?+n(g,m,h):E[m],r?+r(g,m,h):O[m]))}if(T)return o=null,T+""||null}function u(){return EA().defined(i).curve(s).context(a)}return c.x=function(h){return arguments.length?(t=typeof h=="function"?h:nt(+h),n=null,c):t},c.x0=function(h){return arguments.length?(t=typeof h=="function"?h:nt(+h),c):t},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:nt(+h),c):n},c.y=function(h){return arguments.length?(e=typeof h=="function"?h:nt(+h),r=null,c):e},c.y0=function(h){return arguments.length?(e=typeof h=="function"?h:nt(+h),c):e},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:nt(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(r)},c.lineX1=function(){return u().x(n).y(e)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:nt(!!h),c):i},c.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),c):s},c.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),c):a},c}class TA{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function qz(t){return new TA(t,!0)}function Kz(t){return new TA(t,!1)}function Au(){}function Iu(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function AA(t){this._context=t}AA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Iu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Iu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Gz(t){return new AA(t)}function IA(t){this._context=t}IA.prototype={areaStart:Au,areaEnd:Au,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Iu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Yz(t){return new IA(t)}function SA(t){this._context=t}SA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Iu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function Zz(t){return new SA(t)}function PA(t){this._context=t}PA.prototype={areaStart:Au,areaEnd:Au,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function Xz(t){return new PA(t)}function rx(t){return t<0?-1:1}function nx(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(rx(a)+rx(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function ix(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function af(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function Su(t){this._context=t}Su.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:af(this,this._t0,ix(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,af(this,ix(this,r=nx(this,t,e)),r);break;default:af(this,this._t0,r=nx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function kA(t){this._context=new CA(t)}(kA.prototype=Object.create(Su.prototype)).point=function(t,e){Su.prototype.point.call(this,e,t)};function CA(t){this._context=t}CA.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function Qz(t){return new Su(t)}function Jz(t){return new kA(t)}function NA(t){this._context=t}NA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=ax(t),i=ax(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function ax(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function eU(t){return new NA(t)}function Kd(t,e){this._context=t,this._t=e}Kd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function tU(t){return new Kd(t,.5)}function rU(t){return new Kd(t,0)}function nU(t){return new Kd(t,1)}function ks(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function ym(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function iU(t,e){return t[e]}function aU(t){const e=[];return e.key=t,e}function sU(){var t=nt([]),e=ym,r=ks,n=iU;function i(a){var s=Array.from(t.apply(this,arguments),aU),o,l=s.length,c=-1,u;for(const h of a)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(h,s[o].key,c,a)]).data=h;for(o=0,u=wg(e(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:nt(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:nt(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?ym:typeof a=="function"?a:nt(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??ks,i):r},i}function oU(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}ks(t,e)}}function lU(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}ks(t,e)}}function cU(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,l=0,c=0;o<s;++o){for(var u=t[e[o]],h=u[n][1]||0,m=u[n-1][1]||0,p=(h-m)/2,y=0;y<o;++y){var b=t[e[y]],g=b[n][1]||0,_=b[n-1][1]||0;p+=g-_}l+=h,c+=p*h}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,ks(t,e)}}var jA={},OA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}t.uniqBy=e})(OA);var _g={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(_g);var RA={},Gd={},DA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(DA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=DA;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(Gd);var MA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(MA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Gd,r=MA;function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(RA);var LA={},$A={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Rd;function r(n){return function(i){return e.get(i,n)}}t.property=r})($A);var VA={},sf={},of={},Eg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(Eg);var Tg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(Tg);var Yd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(Yd);var sx;function uU(){return sx||(sx=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag(),r=Eg,n=Tg,i=Yd;function a(h,m,p){return typeof p!="function"?e.isMatch(h,m):s(h,m,function y(b,g,_,T,E,O){const R=p(b,g,_,T,E,O);return R!==void 0?!!R:s(b,g,y,O)},new Map)}function s(h,m,p,y){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,p,y);case"function":return Object.keys(m).length>0?s(h,{...m},p,y):i.eq(h,m);default:return r.isObject(h)?typeof m=="string"?m==="":!0:i.eq(h,m)}}function o(h,m,p,y){if(m==null)return!0;if(Array.isArray(m))return c(h,m,p,y);if(m instanceof Map)return l(h,m,p,y);if(m instanceof Set)return u(h,m,p,y);const b=Object.keys(m);if(h==null)return b.length===0;if(b.length===0)return!0;if(y&&y.has(m))return y.get(m)===h;y&&y.set(m,h);try{for(let g=0;g<b.length;g++){const _=b[g];if(!n.isPrimitive(h)&&!(_ in h)||m[_]===void 0&&h[_]!==void 0||m[_]===null&&h[_]!==null||!p(h[_],m[_],_,h,m,y))return!1}return!0}finally{y&&y.delete(m)}}function l(h,m,p,y){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,g]of m.entries()){const _=h.get(b);if(p(_,g,b,h,m,y)===!1)return!1}return!0}function c(h,m,p,y){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let g=0;g<m.length;g++){const _=m[g];let T=!1;for(let E=0;E<h.length;E++){if(b.has(E))continue;const O=h[E];let R=!1;if(p(O,_,g,h,m,y)&&(R=!0),R){b.add(E),T=!0;break}}if(!T)return!1}return!0}function u(h,m,p,y){return m.size===0?!0:h instanceof Set?c([...h],[...m],p,y):!1}t.isMatchWith=a,t.isSetMatch=u}(of)),of}var ox;function Ag(){return ox||(ox=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uU();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r}(sf)),sf}var FA={},Ig={},Sg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Sg);var Zd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(Zd);var Xd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",c="[object Set]",u="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",y="[object Error]",b="[object DataView]",g="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",O="[object BigUint64Array]",R="[object Int8Array]",D="[object Int16Array]",I="[object Int32Array]",A="[object BigInt64Array]",P="[object Float32Array]",j="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=u,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=O,t.booleanTag=i,t.dataViewTag=b,t.dateTag=o,t.errorTag=y,t.float32ArrayTag=P,t.float64ArrayTag=j,t.functionTag=h,t.int16ArrayTag=D,t.int32ArrayTag=I,t.int8ArrayTag=R,t.mapTag=l,t.numberTag=n,t.objectTag=p,t.regexpTag=e,t.setTag=c,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=T,t.uint32ArrayTag=E,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=_})(Xd);var zA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(zA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Sg,r=Zd,n=Xd,i=Tg,a=zA;function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,m,p=new Map,y=void 0){const b=y?.(u,h,m,p);if(b!=null)return b;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,y);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[_,T]of u)g.set(_,o(T,_,m,p,y));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const _ of u)g.add(o(_,void 0,m,p,y));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(a.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,y);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),l(g,u,m,p,y),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),l(g,u,m,p,y),g}if(u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),l(g,u,m,p,y),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,l(g,u,m,p,y),g}if(typeof u=="object"&&c(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),l(g,u,m,p,y),g}return u}function l(u,h,m=u,p,y){const b=[...Object.keys(h),...e.getSymbols(h)];for(let g=0;g<b.length;g++){const _=b[g],T=Object.getOwnPropertyDescriptor(u,_);(T==null||T.writable)&&(u[_]=o(h[_],_,m,p,y))}}function c(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=l})(Ig);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ig;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(FA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag(),r=FA;function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(VA);var UA={},BA={},HA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ig,r=Xd;function n(i,a){return e.cloneDeepWith(i,(s,o,l,c)=>{const u=a?.(s,o,l,c);if(u!=null)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i?.valueOf());return e.copyProperties(h,i),h}case r.argumentsTag:{const h={};return e.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(HA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HA;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(BA);var WA={},Pg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(Pg);var qA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zd;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(qA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=mg,r=Pg,n=qA,i=Dd;function a(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?l=i.toPath(o):l=[o],l.length===0)return!1;let c=s;for(let u=0;u<l.length;u++){const h=l[u];if((c==null||!Object.hasOwn(c,h))&&!((Array.isArray(c)||n.isArguments(c))&&r.isIndex(h)&&h<c.length))return!1;c=c[h]}return!0}t.has=a})(WA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ag(),r=pg,n=BA,i=Rd,a=WA;function s(o,l){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(c){const u=i.get(c,o);return u===void 0?a.has(c,o):l===void 0?u===void 0:e.isMatch(u,l)}}t.matchesProperty=s})(UA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_g,r=$A,n=VA,i=UA;function a(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=a})(LA);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OA,r=_g,n=RA,i=LA;function a(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),i.iteratee(o)):[]}t.uniqBy=a})(jA);var dU=jA.uniqBy;const lx=Ui(dU);function hU(t,e,r){return e===!0?lx(t,r):typeof e=="function"?lx(t,e):t}var KA={exports:{}},GA={},YA={exports:{}},ZA={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cs=w;function fU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mU=typeof Object.is=="function"?Object.is:fU,pU=Cs.useState,gU=Cs.useEffect,yU=Cs.useLayoutEffect,vU=Cs.useDebugValue;function bU(t,e){var r=e(),n=pU({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return yU(function(){i.value=r,i.getSnapshot=e,lf(i)&&a({inst:i})},[t,r,e]),gU(function(){return lf(i)&&a({inst:i}),t(function(){lf(i)&&a({inst:i})})},[t]),vU(r),r}function lf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!mU(t,r)}catch{return!0}}function xU(t,e){return e()}var wU=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xU:bU;ZA.useSyncExternalStore=Cs.useSyncExternalStore!==void 0?Cs.useSyncExternalStore:wU;YA.exports=ZA;var _U=YA.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qd=w,EU=_U;function TU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var AU=typeof Object.is=="function"?Object.is:TU,IU=EU.useSyncExternalStore,SU=Qd.useRef,PU=Qd.useEffect,kU=Qd.useMemo,CU=Qd.useDebugValue;GA.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=SU(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kU(function(){function l(p){if(!c){if(c=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var y=s.value;if(i(y,p))return h=y}return h=p}if(y=h,AU(u,p))return y;var b=n(p);return i!==void 0&&i(y,b)?(u=p,y):(u=p,h=b)}var c=!1,u,h,m=r===void 0?null:r;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,r,n,i]);var o=IU(t,a[0],a[1]);return PU(function(){s.hasValue=!0,s.value=o},[o]),CU(o),o};KA.exports=GA;var NU=KA.exports,kg=w.createContext(null),jU=t=>t,sr=()=>{var t=w.useContext(kg);return t?t.store.dispatch:jU},Yc=()=>{},OU=()=>Yc,RU=(t,e)=>t===e;function ie(t){var e=w.useContext(kg);return NU.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:OU,e?e.store.getState:Yc,e?e.store.getState:Yc,e?t:Yc,RU)}function DU(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function MU(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function LU(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var cx=t=>Array.isArray(t)?t:[t];function $U(t){const e=Array.isArray(t[0])?t[0]:t;return LU(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function VU(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var FU=class{constructor(t){this.value=t}deref(){return this.value}},zU=typeof WeakRef<"u"?WeakRef:FU,UU=0,ux=1;function Tc(){return{s:UU,v:void 0,o:null,p:null}}function XA(t,e={}){let r=Tc();const{resultEqualityCheck:n}=e;let i,a=0;function s(){let o=r;const{length:l}=arguments;for(let h=0,m=l;h<m;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let y=o.o;y===null&&(o.o=y=new WeakMap);const b=y.get(p);b===void 0?(o=Tc(),y.set(p,o)):o=b}else{let y=o.p;y===null&&(o.p=y=new Map);const b=y.get(p);b===void 0?(o=Tc(),y.set(p,o)):o=b}}const c=o;let u;if(o.s===ux)u=o.v;else if(u=t.apply(null,arguments),a++,n){const h=i?.deref?.()??i;h!=null&&n(h,u)&&(u=h,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new zU(u):u}return c.s=ux,c.v=u,u}return s.clearCache=()=>{r=Tc(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function BU(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,s=0,o,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),DU(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:m=[],argsMemoize:p=XA,argsMemoizeOptions:y=[]}=u,b=cx(m),g=cx(y),_=$U(i),T=h(function(){return a++,c.apply(null,arguments)},...b),E=p(function(){s++;const R=VU(_,arguments);return o=T.apply(null,R),o},...g);return Object.assign(E,{resultFunc:c,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var V=BU(XA),HU=Object.assign((t,e=V)=>{MU(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>HU}),QA={},JA={},eI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=e(n),o=e(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};t.compareValues=r})(eI);var tI={},Cg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Cg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cg,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}t.isKey=i})(tI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=eI,r=tI,n=Dd;function i(a,s,o,l){if(a==null)return[];o=l?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const c=(p,y)=>{let b=p;for(let g=0;g<y.length&&b!=null;++g)b=b[y[g]];return b},u=(p,y)=>y==null||p==null?y:typeof p=="object"&&"key"in p?Object.hasOwn(y,p.key)?y[p.key]:c(y,p.path):typeof p=="function"?p(y):Array.isArray(p)?c(y,p):typeof y=="object"?y[p]:y,h=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(y=>u(y,p))})).slice().sort((p,y)=>{for(let b=0;b<h.length;b++){const g=e.compareValues(p.criteria[b],y.criteria[b],o[b]);if(g!==0)return g}return 0}).map(p=>p.original)}t.orderBy=i})(JA);var rI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),s=(o,l)=>{for(let c=0;c<o.length;c++){const u=o[c];Array.isArray(u)&&l<a?s(u,l+1):i.push(u)}};return s(r,0),i}t.flatten=e})(rI);var Ng={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Pg,r=Gd,n=Eg,i=Yd;function a(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&e.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?i.eq(l[o],s):!1}t.isIterateeCall=a})(Ng);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=JA,r=rI,n=Ng;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(a,r.flatten(s),["asc"])}t.sortBy=i})(QA);var WU=QA.sortBy;const Jd=Ui(WU);var nI=t=>t.legend.settings,qU=t=>t.legend.size,KU=t=>t.legend.payload;V([KU,nI],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?Jd(n,r):n});var Ac=1;function GU(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-e.height)>Ac||Math.abs(s.left-e.left)>Ac||Math.abs(s.top-e.top)>Ac||Math.abs(s.width-e.width)>Ac)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function $t(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var YU=typeof Symbol=="function"&&Symbol.observable||"@@observable",dx=YU,cf=()=>Math.random().toString(36).substring(7).split("").join("."),ZU={INIT:`@@redux/INIT${cf()}`,REPLACE:`@@redux/REPLACE${cf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${cf()}`},Pu=ZU;function jg(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function iI(t,e,r){if(typeof t!="function")throw new Error($t(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($t(1));return r(iI)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,l=!1;function c(){s===a&&(s=new Map,a.forEach((g,_)=>{s.set(_,g)}))}function u(){if(l)throw new Error($t(3));return i}function h(g){if(typeof g!="function")throw new Error($t(4));if(l)throw new Error($t(5));let _=!0;c();const T=o++;return s.set(T,g),function(){if(_){if(l)throw new Error($t(6));_=!1,c(),s.delete(T),a=null}}}function m(g){if(!jg(g))throw new Error($t(7));if(typeof g.type>"u")throw new Error($t(8));if(typeof g.type!="string")throw new Error($t(17));if(l)throw new Error($t(9));try{l=!0,i=n(i,g)}finally{l=!1}return(a=s).forEach(T=>{T()}),g}function p(g){if(typeof g!="function")throw new Error($t(10));n=g,m({type:Pu.REPLACE})}function y(){const g=h;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error($t(11));function T(){const O=_;O.next&&O.next(u())}return T(),{unsubscribe:g(T)}},[dx](){return this}}}return m({type:Pu.INIT}),{dispatch:m,subscribe:h,getState:u,replaceReducer:p,[dx]:y}}function XU(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Pu.INIT})>"u")throw new Error($t(12));if(typeof r(void 0,{type:Pu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function aI(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{XU(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],m=r[h],p=s[h],y=m(p,o);if(typeof y>"u")throw o&&o.type,new Error($t(14));c[h]=y,l=l||y!==p}return l=l||n.length!==Object.keys(s).length,l?c:s}}function ku(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function QU(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error($t(15))};const s={getState:i.getState,dispatch:(l,...c)=>a(l,...c)},o=t.map(l=>l(s));return a=ku(...o)(i.dispatch),{...i,dispatch:a}}}function sI(t){return jg(t)&&"type"in t&&typeof t.type=="string"}function oI(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var JU=oI(),e9=oI,t9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ku:ku.apply(null,arguments)};function Vr(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Er(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>sI(n)&&n.type===t,r}var lI=class ko extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ko.prototype)}static get[Symbol.species](){return ko}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new ko(...e[0].concat(this)):new ko(...e.concat(this))}};function hx(t){return Gn(t)?mt(t,()=>{}):t}function Ic(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function r9(t){return typeof t=="boolean"}var n9=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new lI;return r&&(r9(r)?s.push(JU):s.push(e9(r.extraArgument))),s},i9="RTK_autoBatch",fx=t=>e=>{setTimeout(e,t)},a9=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,l=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:fx(10):t.type==="callback"?t.queueNotification:fx(t.timeout),c=()=>{s=!1,a&&(a=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),m=n.subscribe(h);return o.add(u),()=>{m(),o.delete(u)}},dispatch(u){try{return i=!u?.meta?.[i9],a=!i,a&&(s||(s=!0,l(c))),n.dispatch(u)}finally{i=!0}}})},s9=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new lI(t);return n&&i.push(a9(typeof n=="object"?n:void 0)),i};function o9(t){const e=n9(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(jg(r))o=aI(r);else throw new Error(Er(1));let l;typeof n=="function"?l=n(e):l=e();let c=ku;i&&(c=t9({trace:!1,...typeof i=="object"&&i}));const u=QU(...l),h=s9(u);let m=typeof s=="function"?s(h):h();const p=c(...m);return iI(o,a,p)}function cI(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Er(28));if(o in e)throw new Error(Er(29));return e[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function l9(t){return typeof t=="function"}function c9(t,e){let[r,n,i]=cI(e),a;if(l9(t))a=()=>hx(t());else{const o=hx(t);a=()=>o}function s(o=a(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,h)=>{if(h)if(Ta(u)){const p=h(u,l);return p===void 0?u:p}else{if(Gn(u))return mt(u,m=>h(m,l));{const m=h(u,l);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},o)}return s.getInitialState=a,s}var u9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",d9=(t=21)=>{let e="",r=t;for(;r--;)e+=u9[Math.random()*64|0];return e},h9=Symbol.for("rtk-slice-createasyncthunk");function f9(t,e){return`${t}/${e}`}function m9({creators:t}={}){const e=t?.asyncThunk?.[h9];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Er(11));const s=(typeof n.reducers=="function"?n.reducers(g9()):n.reducers)||{},o=Object.keys(s),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(E,O){const R=typeof E=="string"?E:E.type;if(!R)throw new Error(Er(12));if(R in l.sliceCaseReducersByType)throw new Error(Er(13));return l.sliceCaseReducersByType[R]=O,c},addMatcher(E,O){return l.sliceMatchers.push({matcher:E,reducer:O}),c},exposeAction(E,O){return l.actionCreators[E]=O,c},exposeCaseReducer(E,O){return l.sliceCaseReducersByName[E]=O,c}};o.forEach(E=>{const O=s[E],R={reducerName:E,type:f9(i,E),createNotation:typeof n.reducers=="function"};v9(O)?x9(R,O,c,e):y9(R,O,c)});function u(){const[E={},O=[],R=void 0]=typeof n.extraReducers=="function"?cI(n.extraReducers):[n.extraReducers],D={...E,...l.sliceCaseReducersByType};return c9(n.initialState,I=>{for(let A in D)I.addCase(A,D[A]);for(let A of l.sliceMatchers)I.addMatcher(A.matcher,A.reducer);for(let A of O)I.addMatcher(A.matcher,A.reducer);R&&I.addDefaultCase(R)})}const h=E=>E,m=new Map,p=new WeakMap;let y;function b(E,O){return y||(y=u()),y(E,O)}function g(){return y||(y=u()),y.getInitialState()}function _(E,O=!1){function R(I){let A=I[E];return typeof A>"u"&&O&&(A=Ic(p,R,g)),A}function D(I=h){const A=Ic(m,O,()=>new WeakMap);return Ic(A,I,()=>{const P={};for(const[j,N]of Object.entries(n.selectors??{}))P[j]=p9(N,I,()=>Ic(p,I,g),O);return P})}return{reducerPath:E,getSelectors:D,get selectors(){return D(R)},selectSlice:R}}const T={name:i,reducer:b,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:g,..._(a),injectInto(E,{reducerPath:O,...R}={}){const D=O??a;return E.inject({reducerPath:D,reducer:b},R),{...T,..._(D,!0)}}};return T}}function p9(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var Ur=m9();function g9(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function y9({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!b9(n))throw new Error(Er(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?Vr(t,s):Vr(t))}function v9(t){return t._reducerDefinitionType==="asyncThunk"}function b9(t){return t._reducerDefinitionType==="reducerWithPrepare"}function x9({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Er(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:l,settled:c,options:u}=r,h=i(t,a,u);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(e,{fulfilled:s||Sc,pending:o||Sc,rejected:l||Sc,settled:c||Sc})}function Sc(){}var w9="task",uI="listener",dI="completed",Og="cancelled",_9=`task-${Og}`,E9=`task-${dI}`,vm=`${uI}-${Og}`,T9=`${uI}-${dI}`,eh=class{constructor(t){qr(this,"name","TaskAbortError");qr(this,"message");this.code=t,this.message=`${w9} ${Og} (reason: ${t})`}},Rg=(t,e)=>{if(typeof t!="function")throw new TypeError(Er(32))},Cu=()=>{},hI=(t,e=Cu)=>(t.catch(e),t),fI=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),ba=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},xa=t=>{if(t.aborted){const{reason:e}=t;throw new eh(e)}};function mI(t,e){let r=Cu;return new Promise((n,i)=>{const a=()=>i(new eh(t.reason));if(t.aborted){a();return}r=fI(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=Cu})}var A9=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof eh?"cancelled":"rejected",error:r}}finally{e?.()}},Nu=t=>e=>hI(mI(t,e).then(r=>(xa(t),r))),pI=t=>{const e=Nu(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:xs}=Object,mx={},th="listenerMiddleware",I9=(t,e)=>{const r=n=>fI(t,()=>ba(n,t.reason));return(n,i)=>{Rg(n);const a=new AbortController;r(a);const s=A9(async()=>{xa(t),xa(a.signal);const o=await n({pause:Nu(a.signal),delay:pI(a.signal),signal:a.signal});return xa(a.signal),o},()=>ba(a,E9));return i?.autoJoin&&e.push(s.catch(Cu)),{result:Nu(t)(s),cancel(){ba(a,_9)}}}},S9=(t,e)=>{const r=async(n,i)=>{xa(e);let a=()=>{};const o=[new Promise((l,c)=>{let u=t({predicate:n,effect:(h,m)=>{m.unsubscribe(),l([h,m.getState(),m.getOriginalState()])}});a=()=>{u(),c()}})];i!=null&&o.push(new Promise(l=>setTimeout(l,i,null)));try{const l=await mI(e,Promise.race(o));return xa(e),l}finally{a()}};return(n,i)=>hI(r(n,i))},gI=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=Vr(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Er(21));return Rg(a),{predicate:i,type:e,effect:a}},yI=xs(t=>{const{type:e,predicate:r,effect:n}=gI(t);return{id:d9(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Er(22))}}},{withTypes:()=>yI}),px=(t,e)=>{const{type:r,effect:n,predicate:i}=gI(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},bm=t=>{t.pending.forEach(e=>{ba(e,vm)})},P9=t=>()=>{t.forEach(bm),t.clear()},gx=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},vI=xs(Vr(`${th}/add`),{withTypes:()=>vI}),k9=Vr(`${th}/removeAll`),bI=xs(Vr(`${th}/remove`),{withTypes:()=>bI}),C9=(...t)=>{console.error(`${th}/error`,...t)},Pl=(t={})=>{const e=new Map,{extra:r,onError:n=C9}=t;Rg(n);const i=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&bm(u)}),a=u=>{const h=px(e,u)??yI(u);return i(h)};xs(a,{withTypes:()=>a});const s=u=>{const h=px(e,u);return h&&(h.unsubscribe(),u.cancelActive&&bm(h)),!!h};xs(s,{withTypes:()=>s});const o=async(u,h,m,p)=>{const y=new AbortController,b=S9(a,y.signal),g=[];try{u.pending.add(y),await Promise.resolve(u.effect(h,xs({},m,{getOriginalState:p,condition:(_,T)=>b(_,T).then(Boolean),take:b,delay:pI(y.signal),pause:Nu(y.signal),extra:r,signal:y.signal,fork:I9(y.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((_,T,E)=>{_!==y&&(ba(_,vm),E.delete(_))})},cancel:()=>{ba(y,vm),u.pending.delete(y)},throwIfCancelled:()=>{xa(y.signal)}})))}catch(_){_ instanceof eh||gx(n,_,{raisedBy:"effect"})}finally{await Promise.all(g),ba(y,T9),u.pending.delete(y)}},l=P9(e);return{middleware:u=>h=>m=>{if(!sI(m))return h(m);if(vI.match(m))return a(m.payload);if(k9.match(m)){l();return}if(bI.match(m))return s(m.payload);let p=u.getState();const y=()=>{if(p===mx)throw new Error(Er(23));return p};let b;try{if(b=h(m),e.size>0){const g=u.getState(),_=Array.from(e.values());for(const T of _){let E=!1;try{E=T.predicate(m,g,p)}catch(O){E=!1,gx(n,O,{raisedBy:"predicate"})}E&&o(T,m,u,y)}}}finally{p=mx}return b},startListening:a,stopListening:s,clearListeners:l}};function Er(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var N9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},xI=Ur({name:"chartLayout",initialState:N9,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:j9,setLayout:O9,setChartSize:R9,setScale:D9}=xI.actions,M9=xI.reducer;function yx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function vx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yx(Object(r),!0).forEach(function(n){L9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function L9(t,e,r){return(e=$9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $9(t){var e=V9(t,"string");return typeof e=="symbol"?e:e+""}function V9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ju=Math.PI/180,F9=t=>t*180/Math.PI,Ut=(t,e,r,n)=>({x:t+Math.cos(-ju*n)*r,y:e+Math.sin(-ju*n)*r}),z9=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},U9=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},B9=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,s=U9({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,l=Math.acos(o);return n>a&&(l=2*Math.PI-l),{radius:s,angle:F9(l),angleInRadian:l}},H9=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},W9=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return t+s*360},q9=(t,e)=>{var{x:r,y:n}=t,{radius:i,angle:a}=B9({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(i<s||i>o||i===0)return null;var{startAngle:l,endAngle:c}=H9(e),u=a,h;if(l<=c){for(;u>c;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=c}else{for(;u>l;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=l}return h?vx(vx({},e),{},{radius:i,angle:W9(u,e)}):null};function bx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bx(Object(r),!0).forEach(function(n){K9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function K9(t,e,r){return(e=G9(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G9(t){var e=Y9(t,"string");return typeof e=="symbol"?e:e+""}function Y9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tr(t,e,r){return lt(t)||lt(e)?r:In(e)?Da(t,e,r):typeof e=="function"?e(t):r}var Z9=(t,e,r,n,i)=>{var a,s=-1,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,u=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,m=void 0;if(Dr(u-c)!==Dr(h-u)){var p=[];if(Dr(h-u)===Dr(i[1]-i[0])){m=h;var y=u+i[1]-i[0];p[0]=Math.min(y,(y+c)/2),p[1]=Math.max(y,(y+c)/2)}else{m=c;var b=h+i[1]-i[0];p[0]=Math.min(u,(b+u)/2),p[1]=Math.max(u,(b+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(t>g[0]&&t<=g[1]||t>=p[0]&&t<=p[1]){({index:s}=r[l]);break}}else{var _=Math.min(c,h),T=Math.max(c,h);if(t>(_+u)/2&&t<=(T+u)/2){({index:s}=r[l]);break}}}else if(e){for(var E=0;E<o;E++)if(E===0&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E>0&&E<o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E===o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2){({index:s}=e[E]);break}}return s},X9=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&te(t[a]))return jr(jr({},t),{},{[a]:t[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&te(t[s]))return jr(jr({},t),{},{[s]:t[s]+(i||0)})}return t},Wi=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",wI=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var i,a,s=t.map(o=>(o.coordinate===e&&(i=!0),o.coordinate===r&&(a=!0),o.coordinate));return i||s.push(e),a||s.push(r),s},_I=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:o,isCategorical:l,categoricalDomain:c,tickCount:u,ticks:h,niceTicks:m,axisType:p}=t;if(!s)return null;var y=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,b=i==="category"&&s.bandwidth?s.bandwidth()/y:0;if(b=p==="angleAxis"&&a&&a.length>=2?Dr(a[0]-a[1])*2*b:b,h||m){var g=(h||m||[]).map((_,T)=>{var E=n?n.indexOf(_):_;return{coordinate:s(E)+b,value:_,offset:b,index:T}});return g.filter(_=>!$r(_.coordinate))}return l&&c?c.map((_,T)=>({coordinate:s(_)+b,value:_,index:T,offset:b})):s.ticks&&u!=null?s.ticks(u).map((_,T)=>({coordinate:s(_)+b,value:_,offset:b,index:T})):s.domain().map((_,T)=>({coordinate:s(_)+b,value:n?n[_]:_,index:T,offset:b}))},xx=1e-4,Q9=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-xx,a=Math.max(n[0],n[1])+xx,s=t(e[0]),o=t(e[r-1]);(s<i||s>a||o<i||o>a)&&t.domain([e[0],e[r-1]])}},J9=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0,s=0;s<e;++s){var o=$r(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1]):(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1])}},eB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0;a<e;++a){var s=$r(t[a][r][1])?t[a][r][0]:t[a][r][1];s>=0?(t[a][r][0]=i,t[a][r][1]=i+s,i=t[a][r][1]):(t[a][r][0]=0,t[a][r][1]=0)}},tB={sign:J9,expand:oU,none:ks,silhouette:lU,wiggle:cU,positive:eB},rB=(t,e,r)=>{var n=tB[r],i=sU().keys(e).value((a,s)=>+Tr(a,s,0)).order(ym).offset(n);return i(t)};function nB(t){return t==null?void 0:String(t)}function wx(t){var{axis:e,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!lt(i[e.dataKey])){var o=fA(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var l=Tr(i,lt(s)?e.dataKey:s);return lt(l)?null:e.scale(l)}var iB=t=>{var e=t.flat(2).filter(te);return[Math.min(...e),Math.max(...e)]},aB=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],sB=(t,e,r)=>{if(t!=null)return aB(Object.keys(t).reduce((n,i)=>{var a=t[i],{stackedData:s}=a,o=s.reduce((l,c)=>{var u=iB(c.slice(e,r+1));return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},_x=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ex=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xm=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=Jd(e,u=>u.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var l=i[s],c=i[s-1];a=Math.min((l.coordinate||0)-(c.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function Tx(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return jr(jr({},e),{},{dataKey:r,payload:n,value:i,name:a})}function EI(t,e){if(t)return String(t);if(typeof e=="string")return e}function oB(t,e,r,n,i){if(r==="horizontal"||r==="vertical"){var a=t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height;return a?{x:t,y:e}:null}return n?q9({x:t,y:e},n):null}var lB=(t,e,r,n)=>{var i=e.find(c=>c&&c.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:i.coordinate};if(t==="centric"){var a=i.coordinate,{radius:s}=n;return jr(jr(jr({},n),Ut(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:l}=n;return jr(jr(jr({},n),Ut(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},cB=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ii=t=>t.layout.width,ai=t=>t.layout.height,uB=t=>t.layout.scale,TI=t=>t.layout.margin,Dg=V(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Mg=V(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),dB="data-recharts-item-index",hB="data-recharts-item-data-key",rh=60;function Ax(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ax(Object(r),!0).forEach(function(n){fB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ax(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fB(t,e,r){return(e=mB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mB(t){var e=pB(t,"string");return typeof e=="symbol"?e:e+""}function pB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gB=t=>t.brush.height,Wt=V([ii,ai,TI,gB,Dg,Mg,nI,qU],(t,e,r,n,i,a,s,o)=>{var l=a.reduce((y,b)=>{var{orientation:g}=b;if(!b.mirror&&!b.hide){var _=typeof b.width=="number"?b.width:rh;return pi(pi({},y),{},{[g]:y[g]+_})}return y},{left:r.left||0,right:r.right||0}),c=i.reduce((y,b)=>{var{orientation:g}=b;return!b.mirror&&!b.hide?pi(pi({},y),{},{[g]:Da(y,"".concat(g))+b.height}):y},{top:r.top||0,bottom:r.bottom||0}),u=pi(pi({},c),l),h=u.bottom;u.bottom+=n,u=X9(u,s,o);var m=t-u.left-u.right,p=e-u.top-u.bottom;return pi(pi({brushBottom:h},u),{},{width:Math.max(m,0),height:Math.max(p,0)})}),yB=V(Wt,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),AI=V(ii,ai,(t,e)=>({x:0,y:0,width:t,height:e})),vB=w.createContext(null),mr=()=>w.useContext(vB)!=null,nh=t=>t.brush,ih=V([nh,Wt,TI],(t,e,r)=>({height:t.height,x:te(t.x)?t.x:e.left,y:te(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:te(t.width)?t.width:e.width})),Lg=()=>{var t,e=mr(),r=ie(yB),n=ie(ih),i=(t=ie(nh))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},bB={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},II=()=>{var t;return(t=ie(Wt))!==null&&t!==void 0?t:bB},SI=()=>ie(ii),PI=()=>ie(ai),et=t=>t.layout.layoutType,$g=()=>ie(et),xB={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},kI=Ur({name:"legend",initialState:xB,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Bn(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:ZJ,setLegendSettings:XJ,addLegendPayload:wB,removeLegendPayload:_B}=kI.actions,EB=kI.reducer;function wm(){return wm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wm.apply(null,arguments)}function Ix(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function uf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ix(Object(r),!0).forEach(function(n){TB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ix(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function TB(t,e,r){return(e=AB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AB(t){var e=IB(t,"string");return typeof e=="symbol"?e:e+""}function IB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SB(t){return Array.isArray(t)&&In(t[0])&&In(t[1])?t.join(" ~ "):t}var PB=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:c,label:u,labelFormatter:h,accessibilityLayer:m=!1}=t,p=()=>{if(a&&a.length){var R={padding:0,margin:0},D=(o?Jd(a,o):a).map((I,A)=>{if(I.type==="none")return null;var P=I.formatter||s||SB,{value:j,name:N}=I,k=j,C=N;if(P){var Q=P(j,N,I,A,a);if(Array.isArray(Q))[k,C]=Q;else if(Q!=null)k=Q;else return null}var oe=uf({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:oe},In(C)?w.createElement("span",{className:"recharts-tooltip-item-name"},C):null,In(C)?w.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,w.createElement("span",{className:"recharts-tooltip-item-value"},k),w.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:R},D)}return null},y=uf({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=uf({margin:0},i),g=!lt(u),_=g?u:"",T=Me("recharts-default-tooltip",l),E=Me("recharts-tooltip-label",c);g&&h&&a!==void 0&&a!==null&&(_=h(u,a));var O=m?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",wm({className:T,style:y},O),w.createElement("p",{className:E,style:b},w.isValidElement(_)?_:"".concat(_)),p())},po="recharts-tooltip-wrapper",kB={visibility:"hidden"};function CB(t){var{coordinate:e,translateX:r,translateY:n}=t;return Me(po,{["".concat(po,"-right")]:te(r)&&e&&te(e.x)&&r>=e.x,["".concat(po,"-left")]:te(r)&&e&&te(e.x)&&r<e.x,["".concat(po,"-bottom")]:te(n)&&e&&te(e.y)&&n>=e.y,["".concat(po,"-top")]:te(n)&&e&&te(e.y)&&n<e.y})}function Sx(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=t;if(a&&te(a[n]))return a[n];var u=r[n]-o-(i>0?i:0),h=r[n]+i;if(e[n])return s[n]?u:h;var m=l[n];if(m==null)return 0;if(s[n]){var p=u,y=m;return p<y?Math.max(h,m):Math.max(u,m)}if(c==null)return 0;var b=h+o,g=m+c;return b>g?Math.max(u,m):Math.max(h,m)}function NB(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function jB(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:l}=t,c,u,h;return s.height>0&&s.width>0&&r?(u=Sx({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=Sx({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=NB({translateX:u,translateY:h,useTranslate3d:o})):c=kB,{cssProperties:c,cssClasses:CB({translateX:u,translateY:h,coordinate:r})}}function Px(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Pc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Px(Object(r),!0).forEach(function(n){_m(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Px(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function _m(t,e,r){return(e=OB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OB(t){var e=RB(t,"string");return typeof e=="symbol"?e:e+""}function RB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DB extends w.PureComponent{constructor(){super(...arguments),_m(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),_m(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:l,offset:c,position:u,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:y,lastBoundingBox:b,innerRef:g,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:E}=jB({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:c,position:u,reverseDirection:h,tooltipBox:{height:b.height,width:b.width},useTranslate3d:m,viewBox:p}),O=_?{}:Pc(Pc({transition:l&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),R=Pc(Pc({},O),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},y);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:R,ref:g},a)}}var MB=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),kl={isSsr:MB()},CI=()=>ie(t=>t.rootProps.accessibilityLayer);function tn(t){return Number.isFinite(t)}function Ou(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Em(){return Em=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Em.apply(null,arguments)}function kx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Cx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kx(Object(r),!0).forEach(function(n){LB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LB(t,e,r){return(e=$B(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $B(t){var e=VB(t,"string");return typeof e=="symbol"?e:e+""}function VB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Nx={curveBasisClosed:Yz,curveBasisOpen:Zz,curveBasis:Gz,curveBumpX:qz,curveBumpY:Kz,curveLinearClosed:Xz,curveLinear:qd,curveMonotoneX:Qz,curveMonotoneY:Jz,curveNatural:eU,curveStep:tU,curveStepAfter:nU,curveStepBefore:rU},kc=t=>tn(t.x)&&tn(t.y),go=t=>t.x,yo=t=>t.y,FB=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(vg(t));return(r==="curveMonotone"||r==="curveBump")&&e?Nx["".concat(r).concat(e==="vertical"?"Y":"X")]:Nx[r]||qd},zB=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,s=FB(e,i),o=a?r.filter(kc):r,l;if(Array.isArray(n)){var c=a?n.filter(h=>kc(h)):n,u=o.map((h,m)=>Cx(Cx({},h),{},{base:c[m]}));return i==="vertical"?l=Ec().y(yo).x1(go).x0(h=>h.base.x):l=Ec().x(go).y1(yo).y0(h=>h.base.y),l.defined(kc).curve(s),l(u)}return i==="vertical"&&te(n)?l=Ec().y(yo).x1(go).x0(n):te(n)?l=Ec().x(go).y1(yo).y0(n):l=EA().x(go).y(yo),l.defined(kc).curve(s),l(o)},NI=t=>{var{className:e,points:r,path:n,pathRef:i}=t;if((!r||!r.length)&&!n)return null;var a=r&&r.length?zB(t):n;return w.createElement("path",Em({},qe(t,!1),xg(t),{className:Me("recharts-curve",e),d:a===null?void 0:a,ref:i}))},UB=["x","y","top","left","width","height","className"];function Tm(){return Tm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Tm.apply(null,arguments)}function jx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function BB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jx(Object(r),!0).forEach(function(n){HB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HB(t,e,r){return(e=WB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WB(t){var e=qB(t,"string");return typeof e=="symbol"?e:e+""}function qB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KB(t,e){if(t==null)return{};var r,n,i=GB(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function GB(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var YB=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),ZB=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=t,l=KB(t,UB),c=BB({x:e,y:r,top:n,left:i,width:a,height:s},l);return!te(e)||!te(r)||!te(a)||!te(s)||!te(n)||!te(i)?null:w.createElement("path",Tm({},qe(c,!0),{className:Me("recharts-cross",o),d:YB(e,r,a,s,n,i)}))};function XB(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Ox(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function QB(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ox(Object(r),!0).forEach(function(n){JB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ox(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JB(t,e,r){return(e=e8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function e8(t){var e=t8(t,"string");return typeof e=="symbol"?e:e+""}function t8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wa(t,e){var r=QB({},t),n=e,i=Object.keys(e),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var jI={},OI={},RI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}t.isPlainObject=e})(RI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=RI,r=Sg,n=Zd,i=Xd,a=Yd;function s(c,u,h){return o(c,u,void 0,void 0,void 0,void 0,h)}function o(c,u,h,m,p,y,b){const g=b(c,u,h,m,p,y);if(g!==void 0)return g;if(typeof c==typeof u)switch(typeof c){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return c===u;case"number":return c===u||Object.is(c,u);case"function":return c===u;case"object":return l(c,u,y,b)}return l(c,u,y,b)}function l(c,u,h,m){if(Object.is(c,u))return!0;let p=n.getTag(c),y=n.getTag(u);if(p===i.argumentsTag&&(p=i.objectTag),y===i.argumentsTag&&(y=i.objectTag),p!==y)return!1;switch(p){case i.stringTag:return c.toString()===u.toString();case i.numberTag:{const _=c.valueOf(),T=u.valueOf();return a.eq(_,T)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(c.valueOf(),u.valueOf());case i.regexpTag:return c.source===u.source&&c.flags===u.flags;case i.functionTag:return c===u}h=h??new Map;const b=h.get(c),g=h.get(u);if(b!=null&&g!=null)return b===u;h.set(c,u),h.set(u,c);try{switch(p){case i.mapTag:{if(c.size!==u.size)return!1;for(const[_,T]of c.entries())if(!u.has(_)||!o(T,u.get(_),_,c,u,h,m))return!1;return!0}case i.setTag:{if(c.size!==u.size)return!1;const _=Array.from(c.values()),T=Array.from(u.values());for(let E=0;E<_.length;E++){const O=_[E],R=T.findIndex(D=>o(O,D,void 0,c,u,h,m));if(R===-1)return!1;T.splice(R,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(c)!==Buffer.isBuffer(u)||c.length!==u.length)return!1;for(let _=0;_<c.length;_++)if(!o(c[_],u[_],_,c,u,h,m))return!1;return!0}case i.arrayBufferTag:return c.byteLength!==u.byteLength?!1:l(new Uint8Array(c),new Uint8Array(u),h,m);case i.dataViewTag:return c.byteLength!==u.byteLength||c.byteOffset!==u.byteOffset?!1:l(new Uint8Array(c),new Uint8Array(u),h,m);case i.errorTag:return c.name===u.name&&c.message===u.message;case i.objectTag:{if(!(l(c.constructor,u.constructor,h,m)||e.isPlainObject(c)&&e.isPlainObject(u)))return!1;const T=[...Object.keys(c),...r.getSymbols(c)],E=[...Object.keys(u),...r.getSymbols(u)];if(T.length!==E.length)return!1;for(let O=0;O<T.length;O++){const R=T[O],D=c[R];if(!Object.hasOwn(u,R))return!1;const I=u[R];if(!o(D,I,R,c,u,h,m))return!1}return!0}default:return!1}}finally{h.delete(c),h.delete(u)}}t.isEqualWith=s})(OI);var DI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(DI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OI,r=DI;function n(i,a){return e.isEqualWith(i,a,r.noop)}t.isEqual=n})(jI);var r8=jI.isEqual;const n8=Ui(r8);function i8(t){var e={},r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...c]=o;if(typeof l=="number"){i=t.setTimeout(a.bind(null,c),l);return}a(l),i=t.setTimeout(a.bind(null,c));return}typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}var Ru=1e-4,MI=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],LI=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Rx=(t,e)=>r=>{var n=MI(t,e);return LI(n,r)},a8=(t,e)=>r=>{var n=MI(t,e),i=[...n.map((a,s)=>a*s).slice(1),0];return LI(i,r)},Dx=function(){for(var e,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,i]=[0,0,1,1];break;case"ease":[e,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,i]=[.42,0,1,1];break;case"ease-out":[e,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,i]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([e,n,r,i]=l[1].split(")")[0].split(",").map(y=>parseFloat(y)))}}else s.length===4&&([e,n,r,i]=s);var c=Rx(e,r),u=Rx(n,i),h=a8(e,r),m=y=>y>1?1:y<0?0:y,p=y=>{for(var b=y>1?1:y,g=b,_=0;_<8;++_){var T=c(g)-b,E=h(g);if(Math.abs(T-b)<Ru||E<Ru)return u(g);g=m(g-T/E)}return u(g)};return p.isStepper=!1,p},s8=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(s,o,l)=>{var c=-(s-o)*r,u=l*n,h=l+(c-u)*i/1e3,m=l*i/1e3+s;return Math.abs(m-o)<Ru&&Math.abs(h)<Ru?[o,0]:[m,h]};return a.isStepper=!0,a.dt=i,a},o8=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Dx(t);case"spring":return s8();default:if(t.split("(")[0]==="cubic-bezier")return Dx(t)}return typeof t=="function"?t:null};function Mx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Lx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mx(Object(r),!0).forEach(function(n){l8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function l8(t,e,r){return(e=c8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d8=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),h8=(t,e,r)=>t.map(n=>"".concat(d8(n)," ").concat(e,"ms ").concat(r)).join(","),f8=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),al=(t,e)=>Object.keys(e).reduce((r,n)=>Lx(Lx({},r),{},{[n]:t(n,e[n])}),{});function $x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$x(Object(r),!0).forEach(function(n){m8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$x(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function m8(t,e,r){return(e=p8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p8(t){var e=g8(t,"string");return typeof e=="symbol"?e:e+""}function g8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Du=(t,e,r)=>t+(e-t)*r,Am=t=>{var{from:e,to:r}=t;return e!==r},$I=(t,e,r)=>{var n=al((i,a)=>{if(Am(a)){var[s,o]=t(a.from,a.to,a.velocity);return Ft(Ft({},a),{},{from:s,velocity:o})}return a},e);return r<1?al((i,a)=>Am(a)?Ft(Ft({},a),{},{velocity:Du(a.velocity,n[i].velocity,r),from:Du(a.from,n[i].from,r)}):a,e):$I(t,n,r-1)};function y8(t,e,r,n,i,a){var s,o=n.reduce((m,p)=>Ft(Ft({},m),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),l=()=>al((m,p)=>p.from,o),c=()=>!Object.values(o).filter(Am).length,u=null,h=m=>{s||(s=m);var p=m-s,y=p/r.dt;o=$I(r,o,y),i(Ft(Ft(Ft({},t),e),l())),s=m,c()||(u=a.setTimeout(h))};return()=>(u=a.setTimeout(h),()=>{u()})}function v8(t,e,r,n,i,a,s){var o=null,l=i.reduce((h,m)=>Ft(Ft({},h),{},{[m]:[t[m],e[m]]}),{}),c,u=h=>{c||(c=h);var m=(h-c)/n,p=al((b,g)=>Du(...g,r(m)),l);if(a(Ft(Ft(Ft({},t),e),p)),m<1)o=s.setTimeout(u);else{var y=al((b,g)=>Du(...g,r(1)),l);a(Ft(Ft(Ft({},t),e),y))}};return()=>(o=s.setTimeout(u),()=>{o()})}const b8=(t,e,r,n,i,a)=>{var s=f8(t,e);return r.isStepper===!0?y8(t,e,r,s,i,a):v8(t,e,r,n,s,i,a)};class x8{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}var w8=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Im(){return Im=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Im.apply(null,arguments)}function _8(t,e){if(t==null)return{};var r,n,i=E8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function E8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Vx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Vx(Object(r),!0).forEach(function(n){fa(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fa(t,e,r){return(e=T8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T8(t){var e=A8(t,"string");return typeof e=="symbol"?e:e+""}function A8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function I8(){return i8(new x8)}class Vg extends w.PureComponent{constructor(e,r){super(e,r),fa(this,"mounted",!1),fa(this,"manager",null),fa(this,"stopJSAnimation",null),fa(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:r}=this.props;this.mounted=!0,!(!e||!r)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:i?{[i]:s}:s};this.state&&l&&(i&&l[i]!==s||!i&&l!==s)&&this.setState(c);return}if(!(n8(e.to,s)&&e.canBegin&&e.isActive)){var u=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=u||a?o:e.to;if(this.state&&l){var m={style:i?{[i]:h}:h};(i&&l[i]!==h||!i&&l!==h)&&this.setState(m)}this.runAnimation(gi(gi({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:l}=e,c=b8(r,n,o8(a),i,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=c()};this.manager.start([l,s,u,i,o])}runAnimation(e){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:l,children:c}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof c=="function"||s==="spring"){this.runJSAnimation(e);return}var u=i?{[i]:a}:a,h=h8(Object.keys(u),n,s);this.manager.start([o,r,gi(gi({},u),{},{transition:h}),n,l])}render(){var e=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:l,to:c,canBegin:u,onAnimationEnd:h,shouldReAnimate:m,onAnimationReStart:p,animationManager:y}=e,b=_8(e,w8),g=w.Children.count(r),_=this.state.style;if(typeof r=="function")return r(_);if(!o||g===0||i<=0)return r;var T=E=>{var{style:O={},className:R}=E.props,D=w.cloneElement(E,gi(gi({},b),{},{style:gi(gi({},O),_),className:R}));return D};return g===1?T(w.Children.only(r)):w.createElement("div",null,w.Children.map(r,E=>T(E)))}}fa(Vg,"displayName","Animate");fa(Vg,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var S8=w.createContext(null);function Mu(t){var e,r,n=w.useContext(S8);return w.createElement(Vg,Im({},t,{animationManager:(e=(r=t.animationManager)!==null&&r!==void 0?r:n)!==null&&e!==void 0?e:I8()}))}function Lu(){return Lu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lu.apply(null,arguments)}var Fx=(t,e,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>a?a:i[h];c="M".concat(t,",").concat(e+s*u[0]),u[0]>0&&(c+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(t+o*u[0],",").concat(e)),c+="L ".concat(t+r-o*u[1],",").concat(e),u[1]>0&&(c+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,`,
        `).concat(t+r,",").concat(e+s*u[1])),c+="L ".concat(t+r,",").concat(e+n-s*u[2]),u[2]>0&&(c+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,`,
        `).concat(t+r-o*u[2],",").concat(e+n)),c+="L ".concat(t+o*u[3],",").concat(e+n),u[3]>0&&(c+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(e+n-s*u[3])),c+="Z"}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);c="M ".concat(t,",").concat(e+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+o*p,",").concat(e,`
            L `).concat(t+r-o*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+r,",").concat(e+s*p,`
            L `).concat(t+r,",").concat(e+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+r-o*p,",").concat(e+n,`
            L `).concat(t+o*p,",").concat(e+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t,",").concat(e+n-s*p," Z")}else c="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},P8={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},k8=t=>{var e=Wa(t,P8),r=w.useRef(null),[n,i]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&i(_)}catch{}},[]);var{x:a,y:s,width:o,height:l,radius:c,className:u}=e,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:y,isUpdateAnimationActive:b}=e;if(a!==+a||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var g=Me("recharts-rectangle",u);return b?w.createElement(Mu,{canBegin:n>0,from:{width:o,height:l,x:a,y:s},to:{width:o,height:l,x:a,y:s},duration:m,animationEasing:h,isActive:b},_=>{var{width:T,height:E,x:O,y:R}=_;return w.createElement(Mu,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:m,isActive:y,easing:h},w.createElement("path",Lu({},qe(e,!0),{className:g,d:Fx(O,R,T,E,c),ref:r})))}):w.createElement("path",Lu({},qe(e,!0),{className:g,d:Fx(a,s,o,l,c)}))};function VI(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,s=Ut(e,r,n,i),o=Ut(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function Sm(){return Sm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Sm.apply(null,arguments)}var C8=(t,e)=>{var r=Dr(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},Cc=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:l}=t,c=o*(s?1:-1)+n,u=Math.asin(o/c)/ju,h=l?i:i+a*u,m=Ut(e,r,c,h),p=Ut(e,r,n,h),y=l?i-a*u:i,b=Ut(e,r,c*Math.cos(u*ju),y);return{center:m,circleTangency:p,lineTangency:b,theta:u}},FI=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=t,o=C8(a,s),l=a+o,c=Ut(e,r,i,a),u=Ut(e,r,i,l),h="M ".concat(c.x,",").concat(c.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>l),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var m=Ut(e,r,n,a),p=Ut(e,r,n,l);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=l),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},N8=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:c}=t,u=Dr(c-l),{circleTangency:h,lineTangency:m,theta:p}=Cc({cx:e,cy:r,radius:i,angle:l,sign:u,cornerRadius:a,cornerIsExternal:o}),{circleTangency:y,lineTangency:b,theta:g}=Cc({cx:e,cy:r,radius:i,angle:c,sign:-u,cornerRadius:a,cornerIsExternal:o}),_=o?Math.abs(l-c):Math.abs(l-c)-p-g;if(_<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):FI({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:l,endAngle:c});var T="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:O,theta:R}=Cc({cx:e,cy:r,radius:n,angle:l,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:D,lineTangency:I,theta:A}=Cc({cx:e,cy:r,radius:n,angle:c,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(l-c):Math.abs(l-c)-R-A;if(P<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+="L".concat(I.x,",").concat(I.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(O.x,",").concat(O.y,"Z")}else T+="L".concat(e,",").concat(r,"Z");return T},j8={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},O8=t=>{var e=Wa(t,j8),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u,className:h}=e;if(a<i||c===u)return null;var m=Me("recharts-sector",h),p=a-i,y=Fi(s,p,0,!0),b;return y>0&&Math.abs(c-u)<360?b=N8({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(y,p/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}):b=FI({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:u}),w.createElement("path",Sm({},qe(e,!0),{className:m,d:b}))};function R8(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:l,innerRadius:c,outerRadius:u,angle:h}=e,m=Ut(o,l,c,h),p=Ut(o,l,u,h);n=m.x,i=m.y,a=p.x,s=p.y}else return VI(e);return[{x:n,y:i},{x:a,y:s}]}var zI={},UI={},BI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Cg;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(BI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=BI;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(UI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ng,r=UI;function n(i,a,s){s&&typeof s!="number"&&e.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),l=new Array(o);for(let c=0;c<o;c++)l[c]=i,i+=s;return l}t.range=n})(zI);var D8=zI.range;const HI=Ui(D8);function Ni(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function M8(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Fg(t){let e,r,n;t.length!==2?(e=Ni,r=(o,l)=>Ni(t(o),l),n=(o,l)=>t(o)-l):(e=t===Ni||t===M8?t:L8,r=t,n=t);function i(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<0?c=h+1:u=h}while(c<u)}return c}function a(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function s(o,l,c=0,u=o.length){const h=i(o,l,c,u-1);return h>c&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:i,center:s,right:a}}function L8(){return 0}function WI(t){return t===null?NaN:+t}function*$8(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const V8=Fg(Ni),Cl=V8.right;Fg(WI).center;class zx extends Map{constructor(e,r=U8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(Ux(this,e))}has(e){return super.has(Ux(this,e))}set(e,r){return super.set(F8(this,e),r)}delete(e){return super.delete(z8(this,e))}}function Ux({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function F8({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function z8({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function U8(t){return t!==null&&typeof t=="object"?t.valueOf():t}function B8(t=Ni){if(t===Ni)return qI;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function qI(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const H8=Math.sqrt(50),W8=Math.sqrt(10),q8=Math.sqrt(2);function $u(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=H8?10:a>=W8?5:a>=q8?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(t*c),l=Math.round(e*c),o/c<t&&++o,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(t/c),l=Math.round(e/c),o*c<t&&++o,l*c>e&&--l),l<o&&.5<=r&&r<2?$u(t,e,r*2):[o,l,c]}function Pm(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?$u(e,t,r):$u(t,e,r);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}function km(t,e,r){return e=+e,t=+t,r=+r,$u(t,e,r)[2]}function Cm(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?km(e,t,r):km(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function Bx(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Hx(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function KI(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?qI:B8(i);n>r;){if(n-r>600){const l=n-r+1,c=e-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),p=Math.max(r,Math.floor(e-c*h/l+m)),y=Math.min(n,Math.floor(e+(l-c)*h/l+m));KI(t,e,p,y,i)}const a=t[e];let s=r,o=n;for(vo(t,r,e),i(t[n],a)>0&&vo(t,r,n);s<o;){for(vo(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?vo(t,r,o):(++o,vo(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function vo(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function K8(t,e,r){if(t=Float64Array.from($8(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return Hx(t);if(e>=1)return Bx(t);var n,i=(n-1)*e,a=Math.floor(i),s=Bx(KI(t,a).subarray(0,a+1)),o=Hx(t.subarray(a+1));return s+(o-s)*(i-a)}}function G8(t,e,r=WI){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function Y8(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Br(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function si(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Nm=Symbol("implicit");function zg(){var t=new zx,e=[],r=[],n=Nm;function i(a){let s=t.get(a);if(s===void 0){if(n!==Nm)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new zx;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return zg(e,r).unknown(n)},Br.apply(i,arguments),i}function Ug(){var t=zg().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,l=0,c=0,u=.5;delete t.unknown;function h(){var m=e().length,p=i<n,y=p?i:n,b=p?n:i;a=(b-y)/Math.max(1,m-l+c*2),o&&(a=Math.floor(a)),y+=(b-y-a*(m-l))*u,s=a*(1-l),o&&(y=Math.round(y),s=Math.round(s));var g=Y8(m).map(function(_){return y+a*_});return r(p?g.reverse():g)}return t.domain=function(m){return arguments.length?(e(m),h()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(m){return arguments.length?(o=!!m,h()):o},t.padding=function(m){return arguments.length?(l=Math.min(1,c=+m),h()):l},t.paddingInner=function(m){return arguments.length?(l=Math.min(1,m),h()):l},t.paddingOuter=function(m){return arguments.length?(c=+m,h()):c},t.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},t.copy=function(){return Ug(e(),[n,i]).round(o).paddingInner(l).paddingOuter(c).align(u)},Br.apply(h(),arguments)}function GI(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return GI(e())},t}function Z8(){return GI(Ug.apply(null,arguments).paddingInner(1))}function Bg(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function YI(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Nl(){}var sl=.7,Vu=1/sl,ws="\\s*([+-]?\\d+)\\s*",ol="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",X8=/^#([0-9a-f]{3,8})$/,Q8=new RegExp(`^rgb\\(${ws},${ws},${ws}\\)$`),J8=new RegExp(`^rgb\\(${wn},${wn},${wn}\\)$`),eH=new RegExp(`^rgba\\(${ws},${ws},${ws},${ol}\\)$`),tH=new RegExp(`^rgba\\(${wn},${wn},${wn},${ol}\\)$`),rH=new RegExp(`^hsl\\(${ol},${wn},${wn}\\)$`),nH=new RegExp(`^hsla\\(${ol},${wn},${wn},${ol}\\)$`),Wx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bg(Nl,ll,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:qx,formatHex:qx,formatHex8:iH,formatHsl:aH,formatRgb:Kx,toString:Kx});function qx(){return this.rgb().formatHex()}function iH(){return this.rgb().formatHex8()}function aH(){return ZI(this).formatHsl()}function Kx(){return this.rgb().formatRgb()}function ll(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=X8.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Gx(e):r===3?new ur(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Nc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Nc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Q8.exec(t))?new ur(e[1],e[2],e[3],1):(e=J8.exec(t))?new ur(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=eH.exec(t))?Nc(e[1],e[2],e[3],e[4]):(e=tH.exec(t))?Nc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=rH.exec(t))?Xx(e[1],e[2]/100,e[3]/100,1):(e=nH.exec(t))?Xx(e[1],e[2]/100,e[3]/100,e[4]):Wx.hasOwnProperty(t)?Gx(Wx[t]):t==="transparent"?new ur(NaN,NaN,NaN,0):null}function Gx(t){return new ur(t>>16&255,t>>8&255,t&255,1)}function Nc(t,e,r,n){return n<=0&&(t=e=r=NaN),new ur(t,e,r,n)}function sH(t){return t instanceof Nl||(t=ll(t)),t?(t=t.rgb(),new ur(t.r,t.g,t.b,t.opacity)):new ur}function jm(t,e,r,n){return arguments.length===1?sH(t):new ur(t,e,r,n??1)}function ur(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}Bg(ur,jm,YI(Nl,{brighter(t){return t=t==null?Vu:Math.pow(Vu,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?sl:Math.pow(sl,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ur(wa(this.r),wa(this.g),wa(this.b),Fu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yx,formatHex:Yx,formatHex8:oH,formatRgb:Zx,toString:Zx}));function Yx(){return`#${ma(this.r)}${ma(this.g)}${ma(this.b)}`}function oH(){return`#${ma(this.r)}${ma(this.g)}${ma(this.b)}${ma((isNaN(this.opacity)?1:this.opacity)*255)}`}function Zx(){const t=Fu(this.opacity);return`${t===1?"rgb(":"rgba("}${wa(this.r)}, ${wa(this.g)}, ${wa(this.b)}${t===1?")":`, ${t})`}`}function Fu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wa(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ma(t){return t=wa(t),(t<16?"0":"")+t.toString(16)}function Xx(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,r,n)}function ZI(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof Nl||(t=ll(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Yr(s,o,l,t.opacity)}function lH(t,e,r,n){return arguments.length===1?ZI(t):new Yr(t,e,r,n??1)}function Yr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}Bg(Yr,lH,YI(Nl,{brighter(t){return t=t==null?Vu:Math.pow(Vu,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?sl:Math.pow(sl,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new ur(df(t>=240?t-240:t+120,i,n),df(t,i,n),df(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Yr(Qx(this.h),jc(this.s),jc(this.l),Fu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Fu(this.opacity);return`${t===1?"hsl(":"hsla("}${Qx(this.h)}, ${jc(this.s)*100}%, ${jc(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Qx(t){return t=(t||0)%360,t<0?t+360:t}function jc(t){return Math.max(0,Math.min(1,t||0))}function df(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const Hg=t=>()=>t;function cH(t,e){return function(r){return t+r*e}}function uH(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function dH(t){return(t=+t)==1?XI:function(e,r){return r-e?uH(e,r,t):Hg(isNaN(e)?r:e)}}function XI(t,e){var r=e-t;return r?cH(t,r):Hg(isNaN(t)?e:t)}const Jx=function t(e){var r=dH(e);function n(i,a){var s=r((i=jm(i)).r,(a=jm(a)).r),o=r(i.g,a.g),l=r(i.b,a.b),c=XI(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return n.gamma=t,n}(1);function hH(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function fH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function mH(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Bs(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function pH(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function zu(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function gH(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Bs(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var Om=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hf=new RegExp(Om.source,"g");function yH(t){return function(){return t}}function vH(t){return function(e){return t(e)+""}}function bH(t,e){var r=Om.lastIndex=hf.lastIndex=0,n,i,a,s=-1,o=[],l=[];for(t=t+"",e=e+"";(n=Om.exec(t))&&(i=hf.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:zu(n,i)})),r=hf.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?vH(l[0].x):yH(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)o[(h=l[u]).i]=h.x(c);return o.join("")})}function Bs(t,e){var r=typeof e,n;return e==null||r==="boolean"?Hg(e):(r==="number"?zu:r==="string"?(n=ll(e))?(e=n,Jx):bH:e instanceof ll?Jx:e instanceof Date?pH:fH(e)?hH:Array.isArray(e)?mH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?gH:zu)(t,e)}function Wg(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function xH(t,e){e===void 0&&(e=t,t=Bs);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function wH(t){return function(){return t}}function Uu(t){return+t}var ew=[0,1];function ir(t){return t}function Rm(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:wH(isNaN(e)?NaN:.5)}function _H(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function EH(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=Rm(i,n),a=r(s,a)):(n=Rm(n,i),a=r(a,s)),function(o){return a(n(o))}}function TH(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=Rm(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var l=Cl(t,o,1,n)-1;return a[l](i[l](o))}}function jl(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ah(){var t=ew,e=ew,r=Bs,n,i,a,s=ir,o,l,c;function u(){var m=Math.min(t.length,e.length);return s!==ir&&(s=_H(t[0],t[m-1])),o=m>2?TH:EH,l=c=null,h}function h(m){return m==null||isNaN(m=+m)?a:(l||(l=o(t.map(n),e,r)))(n(s(m)))}return h.invert=function(m){return s(i((c||(c=o(e,t.map(n),zu)))(m)))},h.domain=function(m){return arguments.length?(t=Array.from(m,Uu),u()):t.slice()},h.range=function(m){return arguments.length?(e=Array.from(m),u()):e.slice()},h.rangeRound=function(m){return e=Array.from(m),r=Wg,u()},h.clamp=function(m){return arguments.length?(s=m?!0:ir,u()):s!==ir},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,p){return n=m,i=p,u()}}function qg(){return ah()(ir,ir)}function AH(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Bu(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Ns(t){return t=Bu(Math.abs(t)),t?t[1]:NaN}function IH(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(r.substring(i-=o,i+o)),!((l+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function SH(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var PH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cl(t){if(!(e=PH.exec(t)))throw new Error("invalid format: "+t);var e;return new Kg({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}cl.prototype=Kg.prototype;function Kg(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Kg.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kH(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var QI;function CH(t,e){var r=Bu(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(QI=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Bu(t,Math.max(0,e+a-1))[0]}function tw(t,e){var r=Bu(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const rw={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:AH,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>tw(t*100,e),r:tw,s:CH,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function nw(t){return t}var iw=Array.prototype.map,aw=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function NH(t){var e=t.grouping===void 0||t.thousands===void 0?nw:IH(iw.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?nw:SH(iw.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(h){h=cl(h);var m=h.fill,p=h.align,y=h.sign,b=h.symbol,g=h.zero,_=h.width,T=h.comma,E=h.precision,O=h.trim,R=h.type;R==="n"?(T=!0,R="g"):rw[R]||(E===void 0&&(E=12),O=!0,R="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var D=b==="$"?r:b==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",I=b==="$"?n:/[%p]/.test(R)?s:"",A=rw[R],P=/[defgprs%]/.test(R);E=E===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function j(N){var k=D,C=I,Q,oe,X;if(R==="c")C=A(N)+C,N="";else{N=+N;var ee=N<0||1/N<0;if(N=isNaN(N)?l:A(Math.abs(N),E),O&&(N=kH(N)),ee&&+N==0&&y!=="+"&&(ee=!1),k=(ee?y==="("?y:o:y==="-"||y==="("?"":y)+k,C=(R==="s"?aw[8+QI/3]:"")+C+(ee&&y==="("?")":""),P){for(Q=-1,oe=N.length;++Q<oe;)if(X=N.charCodeAt(Q),48>X||X>57){C=(X===46?i+N.slice(Q+1):N.slice(Q))+C,N=N.slice(0,Q);break}}}T&&!g&&(N=e(N,1/0));var he=k.length+N.length+C.length,ye=he<_?new Array(_-he+1).join(m):"";switch(T&&g&&(N=e(ye+N,ye.length?_-C.length:1/0),ye=""),p){case"<":N=k+N+C+ye;break;case"=":N=k+ye+N+C;break;case"^":N=ye.slice(0,he=ye.length>>1)+k+N+C+ye.slice(he);break;default:N=ye+k+N+C;break}return a(N)}return j.toString=function(){return h+""},j}function u(h,m){var p=c((h=cl(h),h.type="f",h)),y=Math.max(-8,Math.min(8,Math.floor(Ns(m)/3)))*3,b=Math.pow(10,-y),g=aw[8+y/3];return function(_){return p(b*_)+g}}return{format:c,formatPrefix:u}}var Oc,Gg,JI;jH({thousands:",",grouping:[3],currency:["$",""]});function jH(t){return Oc=NH(t),Gg=Oc.format,JI=Oc.formatPrefix,Oc}function OH(t){return Math.max(0,-Ns(Math.abs(t)))}function RH(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ns(e)/3)))*3-Ns(Math.abs(t)))}function DH(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ns(e)-Ns(t))+1}function eS(t,e,r,n){var i=Cm(t,e,r),a;switch(n=cl(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=RH(i,s))&&(n.precision=a),JI(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=DH(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=OH(i))&&(n.precision=a-(n.type==="%")*2);break}}return Gg(n)}function qi(t){var e=t.domain;return t.ticks=function(r){var n=e();return Pm(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return eS(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],l,c,u=10;for(o<s&&(c=s,s=o,o=c,c=i,i=a,a=c);u-- >0;){if(c=km(s,o,r),c===l)return n[i]=s,n[a]=o,e(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return t},t}function tS(){var t=qg();return t.copy=function(){return jl(t,tS())},Br.apply(t,arguments),qi(t)}function rS(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Uu),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return rS(t).unknown(e)},t=arguments.length?Array.from(t,Uu):[0,1],qi(r)}function nS(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function sw(t){return Math.log(t)}function ow(t){return Math.exp(t)}function MH(t){return-Math.log(-t)}function LH(t){return-Math.exp(-t)}function $H(t){return isFinite(t)?+("1e"+t):t<0?0:t}function VH(t){return t===10?$H:t===Math.E?Math.exp:e=>Math.pow(t,e)}function FH(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function lw(t){return(e,r)=>-t(-e,r)}function Yg(t){const e=t(sw,ow),r=e.domain;let n=10,i,a;function s(){return i=FH(n),a=VH(n),r()[0]<0?(i=lw(i),a=lw(a),t(MH,LH)):t(sw,ow),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const l=r();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let m=i(c),p=i(u),y,b;const g=o==null?10:+o;let _=[];if(!(n%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),c>0){for(;m<=p;++m)for(y=1;y<n;++y)if(b=m<0?y/a(-m):y*a(m),!(b<c)){if(b>u)break;_.push(b)}}else for(;m<=p;++m)for(y=n-1;y>=1;--y)if(b=m>0?y/a(-m):y*a(m),!(b<c)){if(b>u)break;_.push(b)}_.length*2<g&&(_=Pm(c,u,g))}else _=Pm(m,p,Math.min(p-m,g)).map(a);return h?_.reverse():_},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=cl(l)).precision==null&&(l.trim=!0),l=Gg(l)),o===1/0)return l;const c=Math.max(1,n*o/e.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=c?l(u):""}},e.nice=()=>r(nS(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function iS(){const t=Yg(ah()).domain([1,10]);return t.copy=()=>jl(t,iS()).base(t.base()),Br.apply(t,arguments),t}function cw(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function uw(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Zg(t){var e=1,r=t(cw(e),uw(e));return r.constant=function(n){return arguments.length?t(cw(e=+n),uw(e)):e},qi(r)}function aS(){var t=Zg(ah());return t.copy=function(){return jl(t,aS()).constant(t.constant())},Br.apply(t,arguments)}function dw(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function zH(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function UH(t){return t<0?-t*t:t*t}function Xg(t){var e=t(ir,ir),r=1;function n(){return r===1?t(ir,ir):r===.5?t(zH,UH):t(dw(r),dw(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},qi(e)}function Qg(){var t=Xg(ah());return t.copy=function(){return jl(t,Qg()).exponent(t.exponent())},Br.apply(t,arguments),t}function BH(){return Qg.apply(null,arguments).exponent(.5)}function hw(t){return Math.sign(t)*t*t}function HH(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function sS(){var t=qg(),e=[0,1],r=!1,n;function i(a){var s=HH(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(hw(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Uu)).map(hw)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return sS(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Br.apply(i,arguments),qi(i)}function oS(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=G8(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[Cl(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(Ni),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return oS().domain(t).range(e).unknown(n)},Br.apply(a,arguments)}function lS(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(l){return l!=null&&l<=l?i[Cl(n,l,0,r)]:a}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*e-(l-r)*t)/(r+1);return s}return s.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},s.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,o()):i.slice()},s.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,n[0]]:c>=r?[n[r-1],e]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return lS().domain([t,e]).range(i).unknown(a)},Br.apply(qi(s),arguments)}function cS(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[Cl(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return cS().domain(t).range(e).unknown(r)},Br.apply(i,arguments)}const ff=new Date,mf=new Date;function It(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const l=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let c;do l.push(c=new Date(+a)),e(a,o),t(a);while(c<a&&a<s);return l},i.filter=a=>It(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(ff.setTime(+a),mf.setTime(+s),t(ff),t(mf),Math.floor(r(ff,mf))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const Hu=It(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Hu.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?It(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Hu);Hu.range;const Fn=1e3,Mr=Fn*60,zn=Mr*60,ei=zn*24,Jg=ei*7,fw=ei*30,pf=ei*365,pa=It(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Fn)},(t,e)=>(e-t)/Fn,t=>t.getUTCSeconds());pa.range;const ey=It(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fn)},(t,e)=>{t.setTime(+t+e*Mr)},(t,e)=>(e-t)/Mr,t=>t.getMinutes());ey.range;const ty=It(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Mr)},(t,e)=>(e-t)/Mr,t=>t.getUTCMinutes());ty.range;const ry=It(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Fn-t.getMinutes()*Mr)},(t,e)=>{t.setTime(+t+e*zn)},(t,e)=>(e-t)/zn,t=>t.getHours());ry.range;const ny=It(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*zn)},(t,e)=>(e-t)/zn,t=>t.getUTCHours());ny.range;const Ol=It(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Mr)/ei,t=>t.getDate()-1);Ol.range;const sh=It(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>t.getUTCDate()-1);sh.range;const uS=It(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ei,t=>Math.floor(t/ei));uS.range;function qa(t){return It(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*Mr)/Jg)}const oh=qa(0),Wu=qa(1),WH=qa(2),qH=qa(3),js=qa(4),KH=qa(5),GH=qa(6);oh.range;Wu.range;WH.range;qH.range;js.range;KH.range;GH.range;function Ka(t){return It(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/Jg)}const lh=Ka(0),qu=Ka(1),YH=Ka(2),ZH=Ka(3),Os=Ka(4),XH=Ka(5),QH=Ka(6);lh.range;qu.range;YH.range;ZH.range;Os.range;XH.range;QH.range;const iy=It(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());iy.range;const ay=It(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());ay.range;const ti=It(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ti.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:It(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ti.range;const ri=It(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ri.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:It(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});ri.range;function dS(t,e,r,n,i,a){const s=[[pa,1,Fn],[pa,5,5*Fn],[pa,15,15*Fn],[pa,30,30*Fn],[a,1,Mr],[a,5,5*Mr],[a,15,15*Mr],[a,30,30*Mr],[i,1,zn],[i,3,3*zn],[i,6,6*zn],[i,12,12*zn],[n,1,ei],[n,2,2*ei],[r,1,Jg],[e,1,fw],[e,3,3*fw],[t,1,pf]];function o(c,u,h){const m=u<c;m&&([c,u]=[u,c]);const p=h&&typeof h.range=="function"?h:l(c,u,h),y=p?p.range(c,+u+1):[];return m?y.reverse():y}function l(c,u,h){const m=Math.abs(u-c)/h,p=Fg(([,,g])=>g).right(s,m);if(p===s.length)return t.every(Cm(c/pf,u/pf,h));if(p===0)return Hu.every(Math.max(Cm(c,u,h),1));const[y,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return y.every(b)}return[o,l]}const[JH,eW]=dS(ri,ay,lh,uS,ny,ty),[tW,rW]=dS(ti,iy,oh,Ol,ry,ey);function gf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function yf(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function bo(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function nW(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,l=t.shortMonths,c=xo(i),u=wo(i),h=xo(a),m=wo(a),p=xo(s),y=wo(s),b=xo(o),g=wo(o),_=xo(l),T=wo(l),E={a:ee,A:he,b:ye,B:ze,c:null,d:bw,e:bw,f:IW,g:MW,G:$W,H:EW,I:TW,j:AW,L:hS,m:SW,M:PW,p:se,q,Q:_w,s:Ew,S:kW,u:CW,U:NW,V:jW,w:OW,W:RW,x:null,X:null,y:DW,Y:LW,Z:VW,"%":ww},O={a:J,A:tt,b:Ve,B:Fe,c:null,d:xw,e:xw,f:BW,g:JW,G:tq,H:FW,I:zW,j:UW,L:mS,m:HW,M:WW,p:Pr,q:rn,Q:_w,s:Ew,S:qW,u:KW,U:GW,V:YW,w:ZW,W:XW,x:null,X:null,y:QW,Y:eq,Z:rq,"%":ww},R={a:j,A:N,b:k,B:C,c:Q,d:yw,e:yw,f:bW,g:gw,G:pw,H:vw,I:vw,j:pW,L:vW,m:mW,M:gW,p:P,q:fW,Q:wW,s:_W,S:yW,u:lW,U:cW,V:uW,w:oW,W:dW,x:oe,X,y:gw,Y:pw,Z:hW,"%":xW};E.x=D(r,E),E.X=D(n,E),E.c=D(e,E),O.x=D(r,O),O.X=D(n,O),O.c=D(e,O);function D(G,de){return function(be){var B=[],ut=-1,Te=0,yt=G.length,vt,rr,Zi;for(be instanceof Date||(be=new Date(+be));++ut<yt;)G.charCodeAt(ut)===37&&(B.push(G.slice(Te,ut)),(rr=mw[vt=G.charAt(++ut)])!=null?vt=G.charAt(++ut):rr=vt==="e"?" ":"0",(Zi=de[vt])&&(vt=Zi(be,rr)),B.push(vt),Te=ut+1);return B.push(G.slice(Te,ut)),B.join("")}}function I(G,de){return function(be){var B=bo(1900,void 0,1),ut=A(B,G,be+="",0),Te,yt;if(ut!=be.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Te=yf(bo(B.y,0,1)),yt=Te.getUTCDay(),Te=yt>4||yt===0?qu.ceil(Te):qu(Te),Te=sh.offset(Te,(B.V-1)*7),B.y=Te.getUTCFullYear(),B.m=Te.getUTCMonth(),B.d=Te.getUTCDate()+(B.w+6)%7):(Te=gf(bo(B.y,0,1)),yt=Te.getDay(),Te=yt>4||yt===0?Wu.ceil(Te):Wu(Te),Te=Ol.offset(Te,(B.V-1)*7),B.y=Te.getFullYear(),B.m=Te.getMonth(),B.d=Te.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),yt="Z"in B?yf(bo(B.y,0,1)).getUTCDay():gf(bo(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(yt+5)%7:B.w+B.U*7-(yt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,yf(B)):gf(B)}}function A(G,de,be,B){for(var ut=0,Te=de.length,yt=be.length,vt,rr;ut<Te;){if(B>=yt)return-1;if(vt=de.charCodeAt(ut++),vt===37){if(vt=de.charAt(ut++),rr=R[vt in mw?de.charAt(ut++):vt],!rr||(B=rr(G,be,B))<0)return-1}else if(vt!=be.charCodeAt(B++))return-1}return B}function P(G,de,be){var B=c.exec(de.slice(be));return B?(G.p=u.get(B[0].toLowerCase()),be+B[0].length):-1}function j(G,de,be){var B=p.exec(de.slice(be));return B?(G.w=y.get(B[0].toLowerCase()),be+B[0].length):-1}function N(G,de,be){var B=h.exec(de.slice(be));return B?(G.w=m.get(B[0].toLowerCase()),be+B[0].length):-1}function k(G,de,be){var B=_.exec(de.slice(be));return B?(G.m=T.get(B[0].toLowerCase()),be+B[0].length):-1}function C(G,de,be){var B=b.exec(de.slice(be));return B?(G.m=g.get(B[0].toLowerCase()),be+B[0].length):-1}function Q(G,de,be){return A(G,e,de,be)}function oe(G,de,be){return A(G,r,de,be)}function X(G,de,be){return A(G,n,de,be)}function ee(G){return s[G.getDay()]}function he(G){return a[G.getDay()]}function ye(G){return l[G.getMonth()]}function ze(G){return o[G.getMonth()]}function se(G){return i[+(G.getHours()>=12)]}function q(G){return 1+~~(G.getMonth()/3)}function J(G){return s[G.getUTCDay()]}function tt(G){return a[G.getUTCDay()]}function Ve(G){return l[G.getUTCMonth()]}function Fe(G){return o[G.getUTCMonth()]}function Pr(G){return i[+(G.getUTCHours()>=12)]}function rn(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var de=D(G+="",E);return de.toString=function(){return G},de},parse:function(G){var de=I(G+="",!1);return de.toString=function(){return G},de},utcFormat:function(G){var de=D(G+="",O);return de.toString=function(){return G},de},utcParse:function(G){var de=I(G+="",!0);return de.toString=function(){return G},de}}}var mw={"-":"",_:" ",0:"0"},Ct=/^\s*\d+/,iW=/^%/,aW=/[\\^$*+?|[\]().{}]/g;function Se(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function sW(t){return t.replace(aW,"\\$&")}function xo(t){return new RegExp("^(?:"+t.map(sW).join("|")+")","i")}function wo(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function oW(t,e,r){var n=Ct.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function lW(t,e,r){var n=Ct.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function cW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function uW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function dW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function pw(t,e,r){var n=Ct.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function gw(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function hW(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function fW(t,e,r){var n=Ct.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function mW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function yw(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function pW(t,e,r){var n=Ct.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function vw(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function gW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function yW(t,e,r){var n=Ct.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function vW(t,e,r){var n=Ct.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function bW(t,e,r){var n=Ct.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function xW(t,e,r){var n=iW.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function wW(t,e,r){var n=Ct.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function _W(t,e,r){var n=Ct.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function bw(t,e){return Se(t.getDate(),e,2)}function EW(t,e){return Se(t.getHours(),e,2)}function TW(t,e){return Se(t.getHours()%12||12,e,2)}function AW(t,e){return Se(1+Ol.count(ti(t),t),e,3)}function hS(t,e){return Se(t.getMilliseconds(),e,3)}function IW(t,e){return hS(t,e)+"000"}function SW(t,e){return Se(t.getMonth()+1,e,2)}function PW(t,e){return Se(t.getMinutes(),e,2)}function kW(t,e){return Se(t.getSeconds(),e,2)}function CW(t){var e=t.getDay();return e===0?7:e}function NW(t,e){return Se(oh.count(ti(t)-1,t),e,2)}function fS(t){var e=t.getDay();return e>=4||e===0?js(t):js.ceil(t)}function jW(t,e){return t=fS(t),Se(js.count(ti(t),t)+(ti(t).getDay()===4),e,2)}function OW(t){return t.getDay()}function RW(t,e){return Se(Wu.count(ti(t)-1,t),e,2)}function DW(t,e){return Se(t.getFullYear()%100,e,2)}function MW(t,e){return t=fS(t),Se(t.getFullYear()%100,e,2)}function LW(t,e){return Se(t.getFullYear()%1e4,e,4)}function $W(t,e){var r=t.getDay();return t=r>=4||r===0?js(t):js.ceil(t),Se(t.getFullYear()%1e4,e,4)}function VW(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Se(e/60|0,"0",2)+Se(e%60,"0",2)}function xw(t,e){return Se(t.getUTCDate(),e,2)}function FW(t,e){return Se(t.getUTCHours(),e,2)}function zW(t,e){return Se(t.getUTCHours()%12||12,e,2)}function UW(t,e){return Se(1+sh.count(ri(t),t),e,3)}function mS(t,e){return Se(t.getUTCMilliseconds(),e,3)}function BW(t,e){return mS(t,e)+"000"}function HW(t,e){return Se(t.getUTCMonth()+1,e,2)}function WW(t,e){return Se(t.getUTCMinutes(),e,2)}function qW(t,e){return Se(t.getUTCSeconds(),e,2)}function KW(t){var e=t.getUTCDay();return e===0?7:e}function GW(t,e){return Se(lh.count(ri(t)-1,t),e,2)}function pS(t){var e=t.getUTCDay();return e>=4||e===0?Os(t):Os.ceil(t)}function YW(t,e){return t=pS(t),Se(Os.count(ri(t),t)+(ri(t).getUTCDay()===4),e,2)}function ZW(t){return t.getUTCDay()}function XW(t,e){return Se(qu.count(ri(t)-1,t),e,2)}function QW(t,e){return Se(t.getUTCFullYear()%100,e,2)}function JW(t,e){return t=pS(t),Se(t.getUTCFullYear()%100,e,2)}function eq(t,e){return Se(t.getUTCFullYear()%1e4,e,4)}function tq(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Os(t):Os.ceil(t),Se(t.getUTCFullYear()%1e4,e,4)}function rq(){return"+0000"}function ww(){return"%"}function _w(t){return+t}function Ew(t){return Math.floor(+t/1e3)}var is,gS,yS;nq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function nq(t){return is=nW(t),gS=is.format,is.parse,yS=is.utcFormat,is.utcParse,is}function iq(t){return new Date(t)}function aq(t){return t instanceof Date?+t:+new Date(+t)}function sy(t,e,r,n,i,a,s,o,l,c){var u=qg(),h=u.invert,m=u.domain,p=c(".%L"),y=c(":%S"),b=c("%I:%M"),g=c("%I %p"),_=c("%a %d"),T=c("%b %d"),E=c("%B"),O=c("%Y");function R(D){return(l(D)<D?p:o(D)<D?y:s(D)<D?b:a(D)<D?g:n(D)<D?i(D)<D?_:T:r(D)<D?E:O)(D)}return u.invert=function(D){return new Date(h(D))},u.domain=function(D){return arguments.length?m(Array.from(D,aq)):m().map(iq)},u.ticks=function(D){var I=m();return t(I[0],I[I.length-1],D??10)},u.tickFormat=function(D,I){return I==null?R:c(I)},u.nice=function(D){var I=m();return(!D||typeof D.range!="function")&&(D=e(I[0],I[I.length-1],D??10)),D?m(nS(I,D)):u},u.copy=function(){return jl(u,sy(t,e,r,n,i,a,s,o,l,c))},u}function sq(){return Br.apply(sy(tW,rW,ti,iy,oh,Ol,ry,ey,pa,gS).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oq(){return Br.apply(sy(JH,eW,ri,ay,lh,sh,ny,ty,pa,yS).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ch(){var t=0,e=1,r,n,i,a,s=ir,o=!1,l;function c(h){return h==null||isNaN(h=+h)?l:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),c):[t,e]},c.clamp=function(h){return arguments.length?(o=!!h,c):o},c.interpolator=function(h){return arguments.length?(s=h,c):s};function u(h){return function(m){var p,y;return arguments.length?([p,y]=m,s=h(p,y),c):[s(0),s(1)]}}return c.range=u(Bs),c.rangeRound=u(Wg),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),c}}function Ki(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function vS(){var t=qi(ch()(ir));return t.copy=function(){return Ki(t,vS())},si.apply(t,arguments)}function bS(){var t=Yg(ch()).domain([1,10]);return t.copy=function(){return Ki(t,bS()).base(t.base())},si.apply(t,arguments)}function xS(){var t=Zg(ch());return t.copy=function(){return Ki(t,xS()).constant(t.constant())},si.apply(t,arguments)}function oy(){var t=Xg(ch());return t.copy=function(){return Ki(t,oy()).exponent(t.exponent())},si.apply(t,arguments)}function lq(){return oy.apply(null,arguments).exponent(.5)}function wS(){var t=[],e=ir;function r(n){if(n!=null&&!isNaN(n=+n))return e((Cl(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Ni),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>K8(t,a/n))},r.copy=function(){return wS(e).domain(t)},si.apply(r,arguments)}function uh(){var t=0,e=.5,r=1,n=1,i,a,s,o,l,c=ir,u,h=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+u(b))-a)*(n*b<n*a?o:l),c(h?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([t,e,r]=b,i=u(t=+t),a=u(e=+e),s=u(r=+r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,p):[t,e,r]},p.clamp=function(b){return arguments.length?(h=!!b,p):h},p.interpolator=function(b){return arguments.length?(c=b,p):c};function y(b){return function(g){var _,T,E;return arguments.length?([_,T,E]=g,c=xH(b,[_,T,E]),p):[c(0),c(.5),c(1)]}}return p.range=y(Bs),p.rangeRound=y(Wg),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return u=b,i=b(t),a=b(e),s=b(r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,p}}function _S(){var t=qi(uh()(ir));return t.copy=function(){return Ki(t,_S())},si.apply(t,arguments)}function ES(){var t=Yg(uh()).domain([.1,1,10]);return t.copy=function(){return Ki(t,ES()).base(t.base())},si.apply(t,arguments)}function TS(){var t=Zg(uh());return t.copy=function(){return Ki(t,TS()).constant(t.constant())},si.apply(t,arguments)}function ly(){var t=Xg(uh());return t.copy=function(){return Ki(t,ly()).exponent(t.exponent())},si.apply(t,arguments)}function cq(){return ly.apply(null,arguments).exponent(.5)}const Co=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Ug,scaleDiverging:_S,scaleDivergingLog:ES,scaleDivergingPow:ly,scaleDivergingSqrt:cq,scaleDivergingSymlog:TS,scaleIdentity:rS,scaleImplicit:Nm,scaleLinear:tS,scaleLog:iS,scaleOrdinal:zg,scalePoint:Z8,scalePow:Qg,scaleQuantile:oS,scaleQuantize:lS,scaleRadial:sS,scaleSequential:vS,scaleSequentialLog:bS,scaleSequentialPow:oy,scaleSequentialQuantile:wS,scaleSequentialSqrt:lq,scaleSequentialSymlog:xS,scaleSqrt:BH,scaleSymlog:aS,scaleThreshold:cS,scaleTime:sq,scaleUtc:oq,tickFormat:eS},Symbol.toStringTag,{value:"Module"}));var Ga=t=>t.chartData,uq=V([Ga],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),AS=(t,e,r,n)=>n?uq(t):Ga(t);function Rs(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(tn(e)&&tn(r))return!0}return!1}function Tw(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function dq(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(tn(r))i=r;else if(typeof r=="function")return;if(tn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Rs(s))return s}}function hq(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Rs(n))return Tw(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,s,o;if(i==="auto")e!=null&&(s=Math.min(...e));else if(te(i))s=i;else if(typeof i=="function")try{e!=null&&(s=i(e?.[0]))}catch{}else if(typeof i=="string"&&_x.test(i)){var l=_x.exec(i);if(l==null||e==null)s=void 0;else{var c=+l[1];s=e[0]-c}}else s=e?.[0];if(a==="auto")e!=null&&(o=Math.max(...e));else if(te(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e?.[1]))}catch{}else if(typeof a=="string"&&Ex.test(a)){var u=Ex.exec(a);if(u==null||e==null)o=void 0;else{var h=+u[1];o=e[1]+h}}else o=e?.[1];var m=[s,o];if(Rs(m))return e==null?m:Tw(m,e,r)}}}var Hs=1e9,fq={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},uy,Ge=!0,Fr="[DecimalError] ",_a=Fr+"Invalid argument: ",cy=Fr+"Exponent out of range: ",Ws=Math.floor,la=Math.pow,mq=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_r,Pt=1e7,He=7,IS=9007199254740991,Ku=Ws(IS/He),Z={};Z.absoluteValue=Z.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Z.comparedTo=Z.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Z.decimalPlaces=Z.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*He;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Z.dividedBy=Z.div=function(t){return Kn(this,new this.constructor(t))};Z.dividedToIntegerBy=Z.idiv=function(t){var e=this,r=e.constructor;return Le(Kn(e,new r(t),0,1),r.precision)};Z.equals=Z.eq=function(t){return!this.cmp(t)};Z.exponent=function(){return gt(this)};Z.greaterThan=Z.gt=function(t){return this.cmp(t)>0};Z.greaterThanOrEqualTo=Z.gte=function(t){return this.cmp(t)>=0};Z.isInteger=Z.isint=function(){return this.e>this.d.length-2};Z.isNegative=Z.isneg=function(){return this.s<0};Z.isPositive=Z.ispos=function(){return this.s>0};Z.isZero=function(){return this.s===0};Z.lessThan=Z.lt=function(t){return this.cmp(t)<0};Z.lessThanOrEqualTo=Z.lte=function(t){return this.cmp(t)<1};Z.logarithm=Z.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(_r))throw Error(Fr+"NaN");if(r.s<1)throw Error(Fr+(r.s?"NaN":"-Infinity"));return r.eq(_r)?new n(0):(Ge=!1,e=Kn(ul(r,a),ul(t,a),a),Ge=!0,Le(e,i))};Z.minus=Z.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?kS(e,t):SS(e,(t.s=-t.s,t))};Z.modulo=Z.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(Fr+"NaN");return r.s?(Ge=!1,e=Kn(r,t,0,1).times(t),Ge=!0,r.minus(e)):Le(new n(r),i)};Z.naturalExponential=Z.exp=function(){return PS(this)};Z.naturalLogarithm=Z.ln=function(){return ul(this)};Z.negated=Z.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Z.plus=Z.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?SS(e,t):kS(e,(t.s=-t.s,t))};Z.precision=Z.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(_a+t);if(e=gt(i)+1,n=i.d.length-1,r=n*He+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Z.squareRoot=Z.sqrt=function(){var t,e,r,n,i,a,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Fr+"NaN")}for(t=gt(o),Ge=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=hn(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Ws((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new l(e)):n=new l(i.toString()),r=l.precision,i=s=r+3;;)if(a=n,n=a.plus(Kn(o,a,s+2)).times(.5),hn(a.d).slice(0,s)===(e=hn(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if(Le(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Ge=!0,Le(n,r)};Z.times=Z.mul=function(t){var e,r,n,i,a,s,o,l,c,u=this,h=u.constructor,m=u.d,p=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,l=m.length,c=p.length,l<c&&(a=m,m=p,p=a,s=l,l=c,c=s),a=[],s=l+c,n=s;n--;)a.push(0);for(n=c;--n>=0;){for(e=0,i=l+n;i>n;)o=a[i]+p[n]*m[i-n-1]+e,a[i--]=o%Pt|0,e=o/Pt|0;a[i]=(a[i]+e)%Pt|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ge?Le(t,h.precision):t};Z.toDecimalPlaces=Z.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Sn(t,0,Hs),e===void 0?e=n.rounding:Sn(e,0,8),Le(r,t+gt(r)+1,e))};Z.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Ma(n,!0):(Sn(t,0,Hs),e===void 0?e=i.rounding:Sn(e,0,8),n=Le(new i(n),t+1,e),r=Ma(n,!0,t+1)),r};Z.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?Ma(i):(Sn(t,0,Hs),e===void 0?e=a.rounding:Sn(e,0,8),n=Le(new a(i),t+gt(i)+1,e),r=Ma(n.abs(),!1,t+gt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Z.toInteger=Z.toint=function(){var t=this,e=t.constructor;return Le(new e(t),gt(t)+1,e.rounding)};Z.toNumber=function(){return+this};Z.toPower=Z.pow=function(t){var e,r,n,i,a,s,o=this,l=o.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(_r);if(o=new l(o),!o.s){if(t.s<1)throw Error(Fr+"Infinity");return o}if(o.eq(_r))return o;if(n=l.precision,t.eq(_r))return Le(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=u<0?-u:u)<=IS){for(i=new l(_r),e=Math.ceil(n/He+4),Ge=!1;r%2&&(i=i.times(o),Iw(i.d,e)),r=Ws(r/2),r!==0;)o=o.times(o),Iw(o.d,e);return Ge=!0,t.s<0?new l(_r).div(i):Le(i,n)}}else if(a<0)throw Error(Fr+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Ge=!1,i=t.times(ul(o,n+c)),Ge=!0,i=PS(i),i.s=a,i};Z.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=gt(i),n=Ma(i,r<=a.toExpNeg||r>=a.toExpPos)):(Sn(t,1,Hs),e===void 0?e=a.rounding:Sn(e,0,8),i=Le(new a(i),t,e),r=gt(i),n=Ma(i,t<=r||r<=a.toExpNeg,t)),n};Z.toSignificantDigits=Z.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Sn(t,1,Hs),e===void 0?e=n.rounding:Sn(e,0,8)),Le(new n(r),t,e)};Z.toString=Z.valueOf=Z.val=Z.toJSON=Z[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=gt(t),r=t.constructor;return Ma(t,e<=r.toExpNeg||e>=r.toExpPos)};function SS(t,e){var r,n,i,a,s,o,l,c,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Ge?Le(e,h):e;if(l=t.d,c=e.d,s=t.e,i=e.e,l=l.slice(),a=s-i,a){for(a<0?(n=l,a=-a,o=c.length):(n=c,i=s,o=l.length),s=Math.ceil(h/He),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=l.length,a=c.length,o-a<0&&(a=o,n=c,c=l,l=n),r=0;a;)r=(l[--a]=l[a]+c[a]+r)/Pt|0,l[a]%=Pt;for(r&&(l.unshift(r),++i),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=i,Ge?Le(e,h):e}function Sn(t,e,r){if(t!==~~t||t<e||t>r)throw Error(_a+t)}function hn(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=He-n.length,r&&(a+=vi(r)),a+=n;s=t[e],n=s+"",r=He-n.length,r&&(a+=vi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Kn=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Pt|0,s=a/Pt|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=i[o]){l=n[o]>i[o]?1:-1;break}return l}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Pt+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,l,c,u,h,m,p,y,b,g,_,T,E,O,R,D,I,A,P=n.constructor,j=n.s==i.s?1:-1,N=n.d,k=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(Fr+"Division by zero");for(l=n.e-i.e,I=k.length,R=N.length,p=new P(j),y=p.d=[],c=0;k[c]==(N[c]||0);)++c;if(k[c]>(N[c]||0)&&--l,a==null?T=a=P.precision:s?T=a+(gt(n)-gt(i))+1:T=a,T<0)return new P(0);if(T=T/He+2|0,c=0,I==1)for(u=0,k=k[0],T++;(c<R||u)&&T--;c++)E=u*Pt+(N[c]||0),y[c]=E/k|0,u=E%k|0;else{for(u=Pt/(k[0]+1)|0,u>1&&(k=t(k,u),N=t(N,u),I=k.length,R=N.length),O=I,b=N.slice(0,I),g=b.length;g<I;)b[g++]=0;A=k.slice(),A.unshift(0),D=k[0],k[1]>=Pt/2&&++D;do u=0,o=e(k,b,I,g),o<0?(_=b[0],I!=g&&(_=_*Pt+(b[1]||0)),u=_/D|0,u>1?(u>=Pt&&(u=Pt-1),h=t(k,u),m=h.length,g=b.length,o=e(h,b,m,g),o==1&&(u--,r(h,I<m?A:k,m))):(u==0&&(o=u=1),h=k.slice()),m=h.length,m<g&&h.unshift(0),r(b,h,g),o==-1&&(g=b.length,o=e(k,b,I,g),o<1&&(u++,r(b,I<g?A:k,g))),g=b.length):o===0&&(u++,b=[0]),y[c++]=u,o&&b[0]?b[g++]=N[O]||0:(b=[N[O]],g=1);while((O++<R||b[0]!==void 0)&&T--)}return y[0]||y.shift(),p.e=l,Le(p,s?a+gt(p)+1:a)}}();function PS(t,e){var r,n,i,a,s,o,l=0,c=0,u=t.constructor,h=u.precision;if(gt(t)>16)throw Error(cy+gt(t));if(!t.s)return new u(_r);for(Ge=!1,o=h,s=new u(.03125);t.abs().gte(.1);)t=t.times(s),c+=5;for(n=Math.log(la(2,c))/Math.LN10*2+5|0,o+=n,r=i=a=new u(_r),u.precision=o;;){if(i=Le(i.times(t),o),r=r.times(++l),s=a.plus(Kn(i,r,o)),hn(s.d).slice(0,o)===hn(a.d).slice(0,o)){for(;c--;)a=Le(a.times(a),o);return u.precision=h,e==null?(Ge=!0,Le(a,h)):a}a=s}}function gt(t){for(var e=t.e*He,r=t.d[0];r>=10;r/=10)e++;return e}function vf(t,e,r){if(e>t.LN10.sd())throw Ge=!0,r&&(t.precision=r),Error(Fr+"LN10 precision limit exceeded");return Le(new t(t.LN10),e)}function vi(t){for(var e="";t--;)e+="0";return e}function ul(t,e){var r,n,i,a,s,o,l,c,u,h=1,m=10,p=t,y=p.d,b=p.constructor,g=b.precision;if(p.s<1)throw Error(Fr+(p.s?"NaN":"-Infinity"));if(p.eq(_r))return new b(0);if(e==null?(Ge=!1,c=g):c=e,p.eq(10))return e==null&&(Ge=!0),vf(b,c);if(c+=m,b.precision=c,r=hn(y),n=r.charAt(0),a=gt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(t),r=hn(p.d),n=r.charAt(0),h++;a=gt(p),n>1?(p=new b("0."+r),a++):p=new b(n+"."+r.slice(1))}else return l=vf(b,c+2,g).times(a+""),p=ul(new b(n+"."+r.slice(1)),c-m).plus(l),b.precision=g,e==null?(Ge=!0,Le(p,g)):p;for(o=s=p=Kn(p.minus(_r),p.plus(_r),c),u=Le(p.times(p),c),i=3;;){if(s=Le(s.times(u),c),l=o.plus(Kn(s,new b(i),c)),hn(l.d).slice(0,c)===hn(o.d).slice(0,c))return o=o.times(2),a!==0&&(o=o.plus(vf(b,c+2,g).times(a+""))),o=Kn(o,new b(h),c),b.precision=g,e==null?(Ge=!0,Le(o,g)):o;o=l,i+=2}}function Aw(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=Ws(r/He),t.d=[],n=(r+1)%He,r<0&&(n+=He),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=He;n<i;)t.d.push(+e.slice(n,n+=He));e=e.slice(n),n=He-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ge&&(t.e>Ku||t.e<-Ku))throw Error(cy+r)}else t.s=0,t.e=0,t.d=[0];return t}function Le(t,e,r){var n,i,a,s,o,l,c,u,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=He,i=e,c=h[u=0];else{if(u=Math.ceil((n+1)/He),a=h.length,u>=a)return t;for(c=a=h[u],s=1;a>=10;a/=10)s++;n%=He,i=n-He+s}if(r!==void 0&&(a=la(10,s-i-1),o=c/a%10|0,l=e<0||h[u+1]!==void 0||c%a,l=r<4?(o||l)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?i>0?c/la(10,s-i):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return l?(a=gt(t),h.length=1,e=e-a-1,h[0]=la(10,(He-e%He)%He),t.e=Ws(-e/He)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=la(10,He-n),h[u]=i>0?(c/la(10,s-i)%la(10,i)|0)*a:0),l)for(;;)if(u==0){(h[0]+=a)==Pt&&(h[0]=1,++t.e);break}else{if(h[u]+=a,h[u]!=Pt)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Ge&&(t.e>Ku||t.e<-Ku))throw Error(cy+gt(t));return t}function kS(t,e){var r,n,i,a,s,o,l,c,u,h,m=t.constructor,p=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Ge?Le(e,p):e;if(l=t.d,h=e.d,n=e.e,c=t.e,l=l.slice(),s=c-n,s){for(u=s<0,u?(r=l,s=-s,o=h.length):(r=h,n=c,o=l.length),i=Math.max(Math.ceil(p/He),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=l.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=h[i]){u=l[i]<h[i];break}s=0}for(u&&(r=l,l=h,h=r,e.s=-e.s),o=l.length,i=h.length-o;i>0;--i)l[o++]=0;for(i=h.length;i>s;){if(l[--i]<h[i]){for(a=i;a&&l[--a]===0;)l[a]=Pt-1;--l[a],l[i]+=Pt}l[i]-=h[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=n,Ge?Le(e,p):e):new m(0)}function Ma(t,e,r){var n,i=gt(t),a=hn(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+vi(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+vi(-i-1)+a,r&&(n=r-s)>0&&(a+=vi(n))):i>=s?(a+=vi(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+vi(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=vi(n))),t.s<0?"-"+a:a}function Iw(t,e){if(t.length>e)return t.length=e,!0}function CS(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(_a+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return Aw(s,a.toString())}else if(typeof a!="string")throw Error(_a+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,mq.test(a))Aw(s,a);else throw Error(_a+a)}if(i.prototype=Z,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=CS,i.config=i.set=pq,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function pq(t){if(!t||typeof t!="object")throw Error(Fr+"Object expected");var e,r,n,i=["precision",1,Hs,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(Ws(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(_a+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(_a+r+": "+n);return this}var uy=CS(fq);_r=new uy(1);const Ne=uy;var gq=t=>t,NS={},jS=t=>t===NS,Sw=t=>function e(){return arguments.length===0||arguments.length===1&&jS(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},OS=(t,e)=>t===1?e:Sw(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==NS).length;return a>=t?e(...n):OS(t-a,Sw(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var c=n.map(u=>jS(u)?o.shift():u);return e(...c,...o)}))}),dh=t=>OS(t.length,t),Dm=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},yq=dh((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),vq=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return gq;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,l)=>l(o),a(...arguments))}},Mm=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),RS=t=>{var e=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e&&i.every((s,o)=>{var l;return s===((l=e)===null||l===void 0?void 0:l[o])})||(e=i,r=t(...i)),r}};function DS(t){var e;return t===0?e=1:e=Math.floor(new Ne(t).abs().log(10).toNumber())+1,e}function MS(t,e,r){for(var n=new Ne(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}dh((t,e,r)=>{var n=+t,i=+e;return n+r*(i-n)});dh((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});dh((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var LS=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},$S=(t,e,r)=>{if(t.lte(0))return new Ne(0);var n=DS(t.toNumber()),i=new Ne(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new Ne(Math.ceil(a.div(s).toNumber())).add(r).mul(s),l=o.mul(i);return e?new Ne(l.toNumber()):new Ne(Math.ceil(l.toNumber()))},bq=(t,e,r)=>{var n=new Ne(1),i=new Ne(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new Ne(10).pow(DS(t)-1),i=new Ne(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new Ne(Math.floor(t)))}else t===0?i=new Ne(Math.floor((e-1)/2)):r||(i=new Ne(Math.floor(t)));var s=Math.floor((e-1)/2),o=vq(yq(l=>i.add(new Ne(l-s).mul(n)).toNumber()),Dm);return o(0,e)},VS=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new Ne(0),tickMin:new Ne(0),tickMax:new Ne(0)};var s=$S(new Ne(r).sub(e).div(n-1),i,a),o;e<=0&&r>=0?o=new Ne(0):(o=new Ne(e).add(r).div(2),o=o.sub(new Ne(o).mod(s)));var l=Math.ceil(o.sub(e).div(s).toNumber()),c=Math.ceil(new Ne(r).sub(o).div(s).toNumber()),u=l+c+1;return u>n?VS(e,r,n,i,a+1):(u<n&&(c=r>0?c+(n-u):c,l=r>0?l:l+(n-u)),{step:s,tickMin:o.sub(new Ne(l).mul(s)),tickMax:o.add(new Ne(c).mul(s))})};function xq(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=LS([e,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...Dm(0,n-1).map(()=>1/0)]:[...Dm(0,n-1).map(()=>-1/0),o];return e>r?Mm(l):l}if(s===o)return bq(s,n,i);var{step:c,tickMin:u,tickMax:h}=VS(s,o,a,i,0),m=MS(u,h.add(new Ne(.1).mul(c)),c);return e>r?Mm(m):m}function wq(t,e){var[r,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=LS([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(e,2),l=$S(new Ne(s).sub(a).div(o-1),i,0),c=[...MS(new Ne(a),new Ne(s),l),s];return i===!1&&(c=c.map(u=>Math.round(u))),r>n?Mm(c):c}var _q=RS(xq),Eq=RS(wq),Tq=t=>t.rootProps.barCategoryGap,hh=t=>t.rootProps.stackOffset,dy=t=>t.options.chartName,hy=t=>t.rootProps.syncId,FS=t=>t.rootProps.syncMethod,fy=t=>t.options.eventEmitter,Mn={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},br={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},fh=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},Aq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Mn.angleAxisId,includeHidden:!1,name:void 0,reversed:Mn.reversed,scale:Mn.scale,tick:Mn.tick,tickCount:void 0,ticks:void 0,type:Mn.type,unit:void 0},Iq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:br.type,unit:void 0},Sq={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Mn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Mn.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Mn.scale,tick:Mn.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Pq={allowDataOverflow:br.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:br.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:br.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:br.scale,tick:br.tick,tickCount:br.tickCount,ticks:void 0,type:"category",unit:void 0},my=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?Sq:Aq,py=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?Pq:Iq,mh=t=>t.polarOptions,gy=V([ii,ai,Wt],z9),zS=V([mh,gy],(t,e)=>{if(t!=null)return Fi(t.innerRadius,e,0)}),US=V([mh,gy],(t,e)=>{if(t!=null)return Fi(t.outerRadius,e,e*.8)}),kq=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},BS=V([mh],kq);V([my,BS],fh);var HS=V([gy,zS,US],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});V([py,HS],fh);var Cq=V([et,mh,zS,US,ii,ai],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:c}=e;return{cx:Fi(s,i,i/2),cy:Fi(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}}),Nt=(t,e)=>e,ph=(t,e,r)=>r;function Pw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Gu(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Pw(Object(r),!0).forEach(function(n){Nq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Pw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Nq(t,e,r){return(e=jq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jq(t){var e=Oq(t,"string");return typeof e=="symbol"?e:e+""}function Oq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lm=[0,"auto"],yr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},oi=(t,e)=>{var r=t.cartesianAxis.xAxis[e];return r??yr},vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Lm,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:rh},Gi=(t,e)=>{var r=t.cartesianAxis.yAxis[e];return r??vr},Rq={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},yy=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??Rq},pr=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Gi(t,r);case"zAxis":return yy(t,r);case"angleAxis":return my(t,r);case"radiusAxis":return py(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Dq=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Gi(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Rl=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Gi(t,r);case"angleAxis":return my(t,r);case"radiusAxis":return py(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},WS=t=>t.graphicalItems.countOfBars>0;function qS(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var KS=t=>t.graphicalItems.cartesianItems,Mq=V([Nt,ph],qS),GS=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),Dl=V([KS,pr,Mq],GS),YS=t=>t.filter(e=>e.stackId===void 0),Lq=V([Dl],YS),ZS=t=>t.map(e=>e.data).filter(Boolean).flat(1),$q=V([Dl],ZS),XS=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},gh=V([$q,AS],XS),QS=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Tr(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Tr(i,n)}))):t.map(n=>({value:n})),yh=V([gh,pr,Dl],QS);function JS(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Ya(t){return t.filter(e=>In(e)||e instanceof Date).map(Number).filter(e=>$r(e)===!1)}function Vq(t,e,r){return!r||typeof e!="number"||$r(e)?[]:r.length?Ya(r.flatMap(n=>{var i=Tr(t,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!tn(a)||!tn(s)))return[e-a,e+s]})):[]}var eP=(t,e,r)=>{var n={},i=e.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,l=o.map(c=>c.dataKey);return[s,{stackedData:rB(t,l,r),graphicalItems:o}]}))},Fq=V([gh,Dl,hh],eP),tP=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:i}=e;if(r!=="zAxis"){var a=sB(t,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},zq=V([Fq,Ga,Nt],tP),rP=(t,e,r,n)=>r.length>0?t.flatMap(i=>r.flatMap(a=>{var s,o,l=(s=a.errorBars)===null||s===void 0?void 0:s.filter(u=>JS(n,u)),c=Tr(i,(o=e.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:c,errorDomain:Vq(i,c,l)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:Tr(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),Uq=V(gh,pr,Lq,Nt,rP);function Bq(t){var{value:e}=t;if(In(e)||e instanceof Date)return e}var Hq=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Ya(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Wq=(t,e,r)=>{var n=t.map(Bq).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&hA(n))?HI(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},vy=t=>{var e;if(t==null||!("domain"in t))return Lm;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=Ya(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:Lm},by=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},nP=t=>t.referenceElements.dots,qs=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),qq=V([nP,Nt,ph],qs),iP=t=>t.referenceElements.areas,Kq=V([iP,Nt,ph],qs),aP=t=>t.referenceElements.lines,Gq=V([aP,Nt,ph],qs),sP=(t,e)=>{var r=Ya(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Yq=V(qq,Nt,sP),oP=(t,e)=>{var r=Ya(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Zq=V([Kq,Nt],oP),lP=(t,e)=>{var r=Ya(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Xq=V(Gq,Nt,lP),Qq=V(Yq,Xq,Zq,(t,e,r)=>by(t,r,e)),Jq=V([pr],vy),cP=(t,e,r,n,i)=>{var a=dq(e,t.allowDataOverflow);return a??hq(e,by(r,i,Hq(n)),t.allowDataOverflow)},e7=V([pr,Jq,zq,Uq,Qq],cP),t7=[0,1],uP=(t,e,r,n,i,a,s)=>{if(!(t==null||r==null||r.length===0)){var{dataKey:o,type:l}=t,c=Wi(e,a);return c&&o==null?HI(0,r.length):l==="category"?Wq(n,t,c):i==="expand"?t7:s}},xy=V([pr,et,gh,yh,hh,Nt,e7],uP),dP=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:s}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(vg(a));return o in Co?o:"point"}}},Ml=V([pr,et,WS,dy,Nt],dP);function r7(t){if(t!=null){if(t in Co)return Co[t]();var e="scale".concat(vg(t));if(e in Co)return Co[e]()}}function wy(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=r7(e);if(i!=null){var a=i.domain(r).range(n);return Q9(a),a}}}var hP=(t,e,r)=>{var n=vy(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Rs(t))return _q(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Rs(t))return Eq(t,e.tickCount,e.allowDecimals)}},_y=V([xy,Rl,Ml],hP),fP=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Rs(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],s=e[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return e},n7=V([pr,xy,_y,Nt],fP),i7=V(yh,pr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Ya(t.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),mP=V(i7,et,Tq,Wt,(t,e,r,n)=>n,(t,e,r,n,i)=>{if(!tn(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var s=Fi(r,t*a),o=t*a/2;return o-s-(o-s)/a*s}return 0}),a7=(t,e)=>{var r=oi(t,e);return r==null||typeof r.padding!="string"?0:mP(t,"xAxis",e,r.padding)},s7=(t,e)=>{var r=Gi(t,e);return r==null||typeof r.padding!="string"?0:mP(t,"yAxis",e,r.padding)},o7=V(oi,a7,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),l7=V(Gi,s7,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),c7=V([Wt,o7,ih,nh,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),u7=V([Wt,et,l7,ih,nh,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Ll=(t,e,r,n)=>{var i;switch(e){case"xAxis":return c7(t,r,n);case"yAxis":return u7(t,r,n);case"zAxis":return(i=yy(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return BS(t);case"radiusAxis":return HS(t,r);default:return}},pP=V([pr,Ll],fh),Ks=V([pr,Ml,n7,pP],wy);V(Dl,Nt,(t,e)=>t.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>JS(e,r)));function gP(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var vh=(t,e)=>e,bh=(t,e,r)=>r,d7=V(Dg,vh,bh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(gP)),h7=V(Mg,vh,bh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(gP)),yP=(t,e)=>({width:t.width,height:e.height}),f7=(t,e)=>{var r=typeof e.width=="number"?e.width:rh;return{width:r,height:t.height}},m7=V(Wt,oi,yP),p7=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},g7=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},y7=V(ai,Wt,d7,vh,bh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=yP(e,o);s==null&&(s=p7(e,n,t));var c=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(c)*l.height,s+=(c?-1:1)*l.height}),a}),v7=V(ii,Wt,h7,vh,bh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=f7(e,o);s==null&&(s=g7(e,n,t));var c=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(c)*l.width,s+=(c?-1:1)*l.width}),a}),b7=(t,e)=>{var r=Wt(t),n=oi(t,e);if(n!=null){var i=y7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},x7=(t,e)=>{var r=Wt(t),n=Gi(t,e);if(n!=null){var i=v7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},w7=V(Wt,Gi,(t,e)=>{var r=typeof e.width=="number"?e.width:rh;return{width:r,height:t.height}}),vP=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=Wi(t,n),l=e.map(c=>c.value);if(s&&o&&a==="category"&&i&&hA(l))return l}},Ey=V([et,yh,pr,Nt],vP),bP=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=Wi(t,n);if(s&&(i==="number"||a!=="auto"))return e.map(o=>o.value)}},Ty=V([et,yh,Rl,Nt],bP),kw=V([et,Dq,Ml,Ks,Ey,Ty,Ll,_y,Nt],(t,e,r,n,i,a,s,o,l)=>{if(e==null)return null;var c=Wi(t,l);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:l,categoricalDomain:a,duplicateDomain:i,isCategorical:c,niceTicks:o,range:s,realScaleType:r,scale:n}}),_7=(t,e,r,n,i,a,s,o,l)=>{if(!(e==null||n==null)){var c=Wi(t,l),{type:u,ticks:h,tickCount:m}=e,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=u==="category"&&n.bandwidth?n.bandwidth()/p:0;y=l==="angleAxis"&&a!=null&&a.length>=2?Dr(a[0]-a[1])*2*y:y;var b=h||i;if(b){var g=b.map((_,T)=>{var E=s?s.indexOf(_):_;return{index:T,coordinate:n(E)+y,value:_,offset:y}});return g.filter(_=>!$r(_.coordinate))}return c&&o?o.map((_,T)=>({coordinate:n(_)+y,value:_,index:T,offset:y})):n.ticks?n.ticks(m).map(_=>({coordinate:n(_)+y,value:_,offset:y})):n.domain().map((_,T)=>({coordinate:n(_)+y,value:s?s[_]:_,index:T,offset:y}))}},xP=V([et,Rl,Ml,Ks,_y,Ll,Ey,Ty,Nt],_7),E7=(t,e,r,n,i,a,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Wi(t,s),{tickCount:l}=e,c=0;return c=s==="angleAxis"&&n?.length>=2?Dr(n[0]-n[1])*2*c:c,o&&a?a.map((u,h)=>({coordinate:r(u)+c,value:u,index:h,offset:c})):r.ticks?r.ticks(l).map(u=>({coordinate:r(u)+c,value:u,offset:c})):r.domain().map((u,h)=>({coordinate:r(u)+c,value:i?i[u]:u,index:h,offset:c}))}},wP=V([et,Rl,Ks,Ll,Ey,Ty,Nt],E7),xh=V(pr,Ks,(t,e)=>{if(!(t==null||e==null))return Gu(Gu({},t),{},{scale:e})}),T7=V([pr,Ml,xy,pP],wy);V((t,e,r)=>yy(t,r),T7,(t,e)=>{if(!(t==null||e==null))return Gu(Gu({},t),{},{scale:e})});var A7=V([et,Dg,Mg],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),_P=t=>t.options.defaultTooltipEventType,EP=t=>t.options.validateTooltipEventTypes;function TP(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Ay(t,e){var r=_P(t),n=EP(t);return TP(e,r,n)}function I7(t){return ie(e=>Ay(e,t))}var AP=(t,e)=>{var r,n=Number(e);if(!($r(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},S7=t=>t.tooltip.settings,Ei={active:!1,index:null,dataKey:void 0,coordinate:void 0},P7={itemInteraction:{click:Ei,hover:Ei},axisInteraction:{click:Ei,hover:Ei},keyboardInteraction:Ei,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},IP=Ur({name:"tooltip",initialState:P7,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Bn(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:k7,removeTooltipEntrySettings:C7,setTooltipSettingsState:N7,setActiveMouseOverItemIndex:j7,mouseLeaveItem:QJ,mouseLeaveChart:SP,setActiveClickItemIndex:JJ,setMouseOverAxisIndex:PP,setMouseClickAxisIndex:O7,setSyncInteraction:$m,setKeyboardInteraction:Vm}=IP.actions,R7=IP.reducer;function Cw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(r),!0).forEach(function(n){D7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function D7(t,e,r){return(e=M7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M7(t){var e=L7(t,"string");return typeof e=="symbol"?e:e+""}function L7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $7(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function V7(t){return t.index!=null}var kP=(t,e,r,n)=>{if(e==null)return Ei;var i=$7(t,e,r);if(i==null)return Ei;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(V7(i)){if(a)return Rc(Rc({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Rc(Rc({},Ei),{},{coordinate:i.coordinate})},Iy=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!tn(n))return r;var i=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(i,Math.min(n,a)))},CP=(t,e,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var l=s[0],c=l==null?void 0:o(l.positions,a);if(c!=null)return c;var u=i?.[Number(a)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},NP=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},$l=t=>t.options.tooltipPayloadSearcher,Gs=t=>t.tooltip;function Nw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function jw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Nw(Object(r),!0).forEach(function(n){F7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function F7(t,e,r){return(e=z7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z7(t){var e=U7(t,"string");return typeof e=="symbol"?e:e+""}function U7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B7(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function H7(t,e){return t??e}var jP=(t,e,r,n,i,a,s)=>{if(!(e==null||a==null)){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:u}=r,h=[];return t.reduce((m,p)=>{var y,{dataDefinedOnItem:b,settings:g}=p,_=H7(b,o),T=B7(_,c,u),E=(y=g?.dataKey)!==null&&y!==void 0?y:n?.dataKey,O=g?.nameKey,R;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?R=fA(T,n.dataKey,i):R=a(T,e,l,O),Array.isArray(R))R.forEach(I=>{var A=jw(jw({},g),{},{name:I.name,unit:I.unit,color:void 0,fill:void 0});m.push(Tx({tooltipEntrySettings:A,dataKey:I.dataKey,payload:I.payload,value:Tr(I.payload,I.dataKey),name:I.name}))});else{var D;m.push(Tx({tooltipEntrySettings:g,dataKey:E,payload:R,value:Tr(R,E),name:(D=Tr(R,O))!==null&&D!==void 0?D:g?.name}))}return m},h)}},jt=t=>{var e=et(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Ys=t=>t.tooltip.settings.axisId,qt=t=>{var e=jt(t),r=Ys(t);return Rl(t,e,r)},Sy=V([qt,et,WS,dy,jt],dP),W7=V([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),q7=V([jt,Ys],qS),wh=V([W7,qt,q7],GS),K7=V([wh],ZS),Za=V([K7,Ga],XS),Py=V([Za,qt,wh],QS),G7=V([qt],vy),Y7=V([Za,wh,hh],eP),Z7=V([Y7,Ga,jt],tP),X7=V([wh],YS),Q7=V([Za,qt,X7,jt],rP),J7=V([nP,jt,Ys],qs),eK=V([J7,jt],sP),tK=V([iP,jt,Ys],qs),rK=V([tK,jt],oP),nK=V([aP,jt,Ys],qs),iK=V([nK,jt],lP),aK=V([eK,iK,rK],by),sK=V([qt,G7,Z7,Q7,aK],cP),OP=V([qt,et,Za,Py,hh,jt,sK],uP),oK=V([OP,qt,Sy],hP),lK=V([qt,OP,oK,jt],fP),RP=t=>{var e=jt(t),r=Ys(t),n=!1;return Ll(t,e,r,n)},DP=V([qt,RP],fh),MP=V([qt,Sy,lK,DP],wy),cK=V([et,Py,qt,jt],vP),uK=V([et,Py,qt,jt],bP),dK=(t,e,r,n,i,a,s,o)=>{if(e){var{type:l}=e,c=Wi(t,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&i!=null&&i?.length>=2?Dr(i[0]-i[1])*2*h:h,c&&s?s.map((m,p)=>({coordinate:n(m)+h,value:m,index:p,offset:h})):n.domain().map((m,p)=>({coordinate:n(m)+h,value:a?a[m]:m,index:p,offset:h}))}}},li=V([et,qt,Sy,MP,RP,cK,uK,jt],dK),ky=V([_P,EP,S7],(t,e,r)=>TP(r.shared,t,e)),LP=t=>t.tooltip.settings.trigger,Cy=t=>t.tooltip.settings.defaultIndex,_h=V([Gs,ky,LP,Cy],kP),dl=V([_h,Za],Iy),$P=V([li,dl],AP),hK=V([_h],t=>{if(t)return t.dataKey}),VP=V([Gs,ky,LP,Cy],NP),fK=V([ii,ai,et,Wt,li,Cy,VP,$l],CP),mK=V([_h,fK],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),pK=V([_h],t=>t.active),gK=V([VP,dl,Ga,qt,$P,$l,ky],jP),yK=V([gK],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function Ow(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ow(Object(r),!0).forEach(function(n){vK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ow(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function vK(t,e,r){return(e=bK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bK(t){var e=xK(t,"string");return typeof e=="symbol"?e:e+""}function xK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wK=()=>ie(qt),_K=()=>{var t=wK(),e=ie(li),r=ie(MP);return xm(Rw(Rw({},t),{},{scale:r}),e)},EK=()=>ie(dy),Ny=(t,e)=>e,FP=(t,e,r)=>r,jy=(t,e,r,n)=>n,TK=V(li,t=>Jd(t,e=>e.coordinate)),Oy=V([Gs,Ny,FP,jy],kP),zP=V([Oy,Za],Iy),AK=(t,e,r)=>{if(e!=null){var n=Gs(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},UP=V([Gs,Ny,FP,jy],NP),Yu=V([ii,ai,et,Wt,li,jy,UP,$l],CP),IK=V([Oy,Yu],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),BP=V(li,zP,AP),SK=V([UP,zP,Ga,qt,BP,$l,Ny],jP),PK=V([Oy],t=>({isActive:t.active,activeIndex:t.index})),kK=(t,e,r,n,i,a,s,o)=>{if(!(!t||!e||!n||!i||!a)){var l=oB(t.chartX,t.chartY,e,r,o);if(l){var c=cB(l,e),u=Z9(c,s,a,n,i),h=lB(e,a,u,l);return{activeIndex:String(u),activeCoordinate:h}}}};function Fm(){return Fm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Fm.apply(null,arguments)}function Dw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Dc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Dw(Object(r),!0).forEach(function(n){CK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Dw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function CK(t,e,r){return(e=NK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NK(t){var e=jK(t,"string");return typeof e=="symbol"?e:e+""}function jK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OK(t){var{coordinate:e,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:l,chartName:c}=t,u=e,h=r,m=n;if(!o||!u||c!=="ScatterChart"&&l!=="axis")return null;var p,y;if(c==="ScatterChart")p=u,y=ZB;else if(c==="BarChart")p=XB(s,u,i,a),y=k8;else if(s==="radial"){var{cx:b,cy:g,radius:_,startAngle:T,endAngle:E}=VI(u);p={cx:b,cy:g,startAngle:T,endAngle:E,innerRadius:_,outerRadius:_},y=O8}else p={points:R8(s,u,i)},y=NI;var O=typeof o=="object"&&"className"in o?o.className:void 0,R=Dc(Dc(Dc(Dc({stroke:"#ccc",pointerEvents:"none"},i),p),qe(o,!1)),{},{payload:h,payloadIndex:m,className:Me("recharts-tooltip-cursor",O)});return w.isValidElement(o)?w.cloneElement(o,R):w.createElement(y,R)}function RK(t){var e=_K(),r=II(),n=$g(),i=EK();return w.createElement(OK,Fm({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var HP=w.createContext(null),DK=()=>w.useContext(HP),WP={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||l,m),y=r?r+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,y=new Array(p);m<p;m++)y[m]=h[m].fn;return y},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,m,p,y){var b=r?r+c:c;if(!this._events[b])return!1;var g=this._events[b],_=arguments.length,T,E;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,m),!0;case 5:return g.fn.call(g.context,u,h,m,p),!0;case 6:return g.fn.call(g.context,u,h,m,p,y),!0}for(E=1,T=new Array(_-1);E<_;E++)T[E-1]=arguments[E];g.fn.apply(g.context,T)}else{var O=g.length,R;for(E=0;E<O;E++)switch(g[E].once&&this.removeListener(c,g[E].fn,void 0,!0),_){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,u);break;case 3:g[E].fn.call(g[E].context,u,h);break;case 4:g[E].fn.call(g[E].context,u,h,m);break;default:if(!T)for(R=1,T=new Array(_-1);R<_;R++)T[R-1]=arguments[R];g[E].fn.apply(g[E].context,T)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,m){var p=r?r+c:c;if(!this._events[p])return this;if(!u)return s(this,p),this;var y=this._events[p];if(y.fn)y.fn===u&&(!m||y.once)&&(!h||y.context===h)&&s(this,p);else{for(var b=0,g=[],_=y.length;b<_;b++)(y[b].fn!==u||m&&!y[b].once||h&&y[b].context!==h)&&g.push(y[b]);g.length?this._events[p]=g.length===1?g[0]:g:s(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(WP);var MK=WP.exports;const LK=Ui(MK);var hl=new LK,zm="recharts.syncEvent.tooltip",Mw="recharts.syncEvent.brush";function $K(t,e){if(e){var r=Number.parseInt(e,10);if(!$r(r))return t?.[r]}}var VK={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},qP=Ur({name:"options",initialState:VK,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),FK=qP.reducer,{createEventEmitter:zK}=qP.actions;function UK(t){return t.tooltip.syncInteraction}var BK={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},KP=Ur({name:"chartData",initialState:BK,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:Lw,setDataStartEndIndexes:HK,setComputedData:eee}=KP.actions,WK=KP.reducer,GP=()=>{};function qK(){var t=ie(hy),e=ie(fy),r=sr(),n=ie(FS),i=ie(li),a=$g(),s=Lg(),o=ie(l=>l.rootProps.className);w.useEffect(()=>{if(t==null)return GP;var l=(c,u,h)=>{if(e!==h&&t===c){if(n==="index"){r(u);return}if(i!=null){var m;if(typeof n=="function"){var p={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},y=n(i,p);m=i[y]}else n==="value"&&(m=i.find(D=>String(D.value)===u.payload.label));var{coordinate:b}=u.payload;if(m==null||u.payload.active===!1||b==null||s==null){r($m({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:g,y:_}=b,T=Math.min(g,s.x+s.width),E=Math.min(_,s.y+s.height),O={x:a==="horizontal"?m.coordinate:T,y:a==="horizontal"?E:m.coordinate},R=$m({active:u.payload.active,coordinate:O,dataKey:u.payload.dataKey,index:String(m.index),label:u.payload.label});r(R)}}};return hl.on(zm,l),()=>{hl.off(zm,l)}},[o,r,e,t,n,i,a,s])}function KK(){var t=ie(hy),e=ie(fy),r=sr();w.useEffect(()=>{if(t==null)return GP;var n=(i,a,s)=>{e!==s&&t===i&&r(HK(a))};return hl.on(Mw,n),()=>{hl.off(Mw,n)}},[r,e,t])}function GK(){var t=sr();w.useEffect(()=>{t(zK())},[t]),qK(),KK()}function YK(t,e,r,n,i,a){var s=ie(m=>AK(m,t,e)),o=ie(fy),l=ie(hy),c=ie(FS),u=ie(UK),h=u?.active;w.useEffect(()=>{if(!h&&l!=null&&o!=null){var m=$m({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});hl.emit(zm,l,m,o)}},[h,r,s,i,n,o,l,c,a])}function $w(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$w(Object(r),!0).forEach(function(n){ZK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$w(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ZK(t,e,r){return(e=XK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XK(t){var e=QK(t,"string");return typeof e=="symbol"?e:e+""}function QK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JK(t){return t.dataKey}function eG(t,e){return w.isValidElement(t)?w.cloneElement(t,e):typeof t=="function"?w.createElement(t,e):w.createElement(PB,e)}var Fw=[],tG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!kl.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function zw(t){var e=Wa(t,tG),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:l,offset:c,payloadUniqBy:u,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:y,cursor:b,shared:g,trigger:_,defaultIndex:T,portal:E,axisId:O}=e,R=sr(),D=typeof T=="number"?String(T):T;w.useEffect(()=>{R(N7({shared:g,trigger:_,axisId:O,active:r,defaultIndex:D}))},[R,g,_,O,r,D]);var I=Lg(),A=CI(),P=I7(g),{activeIndex:j,isActive:N}=ie(Ve=>PK(Ve,P,_,D)),k=ie(Ve=>SK(Ve,P,_,D)),C=ie(Ve=>BP(Ve,P,_,D)),Q=ie(Ve=>IK(Ve,P,_,D)),oe=k,X=DK(),ee=r??N,[he,ye]=GU([oe,ee]),ze=P==="axis"?C:void 0;YK(P,_,Q,ze,j,ee);var se=E??X;if(se==null)return null;var q=oe??Fw;ee||(q=Fw),o&&q.length&&(q=hU(oe.filter(Ve=>Ve.value!=null&&(Ve.hide!==!0||e.includeHidden)),u,JK));var J=q.length>0,tt=w.createElement(DB,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:l,active:ee,coordinate:Q,hasPayload:J,offset:c,position:h,reverseDirection:m,useTranslate3d:p,viewBox:I,wrapperStyle:y,lastBoundingBox:he,innerRef:ye,hasPortalFromProps:!!E},eG(s,Vw(Vw({},e),{},{payload:q,label:ze,active:ee,coordinate:Q,accessibilityLayer:A})));return w.createElement(w.Fragment,null,Xm.createPortal(tt,se),ee&&w.createElement(RK,{cursor:b,tooltipEventType:P,coordinate:Q,payload:oe,index:j}))}var YP={},ZP={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=0,i={}){typeof i!="object"&&(i={});let a=null,s=null,o=null,l=0,c=null,u;const{leading:h=!1,trailing:m=!0,maxWait:p}=i,y="maxWait"in i,b=y?Math.max(Number(p)||0,n):0,g=I=>(a!==null&&(u=r.apply(s,a)),a=s=null,l=I,u),_=I=>(l=I,c=setTimeout(R,n),h&&a!==null?g(I):u),T=I=>(c=null,m&&a!==null?g(I):u),E=I=>{if(o===null)return!0;const A=I-o,P=A>=n||A<0,j=y&&I-l>=b;return P||j},O=I=>{const A=o===null?0:I-o,P=n-A,j=b-(I-l);return y?Math.min(P,j):P},R=()=>{const I=Date.now();if(E(I))return T(I);c=setTimeout(R,O(I))},D=function(...I){const A=Date.now(),P=E(A);if(a=I,s=this,o=A,P){if(c===null)return _(A);if(y)return clearTimeout(c),c=setTimeout(R,n),g(A)}return c===null&&(c=setTimeout(R,n)),u};return D.cancel=()=>{c!==null&&clearTimeout(c),l=0,o=a=s=c=null},D.flush=()=>c===null?u:T(Date.now()),D}t.debounce=e})(ZP);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ZP;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return e.debounce(n,i,{leading:s,maxWait:i,trailing:o})}t.throttle=r})(YP);var rG=YP.throttle;const nG=Ui(rG);var Fo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function Uw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Uw(Object(r),!0).forEach(function(n){iG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Uw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iG(t,e,r){return(e=aG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aG(t){var e=sG(t,"string");return typeof e=="symbol"?e:e+""}function sG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bw=w.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:c,debounce:u=0,id:h,className:m,onResize:p,style:y={}}=t,b=w.useRef(null),g=w.useRef();g.current=p,w.useImperativeHandle(e,()=>b.current);var[_,T]=w.useState({containerWidth:n.width,containerHeight:n.height}),E=w.useCallback((R,D)=>{T(I=>{var A=Math.round(R),P=Math.round(D);return I.containerWidth===A&&I.containerHeight===P?I:{containerWidth:A,containerHeight:P}})},[]);w.useEffect(()=>{var R=P=>{var j,{width:N,height:k}=P[0].contentRect;E(N,k),(j=g.current)===null||j===void 0||j.call(g,N,k)};u>0&&(R=nG(R,u,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),{width:I,height:A}=b.current.getBoundingClientRect();return E(I,A),D.observe(b.current),()=>{D.disconnect()}},[E,u]);var O=w.useMemo(()=>{var{containerWidth:R,containerHeight:D}=_;if(R<0||D<0)return null;Fo(ha(i)||ha(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),Fo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var I=ha(i)?R:i,A=ha(a)?D:a;return r&&r>0&&(I?A=I/r:A&&(I=A*r),l&&A>l&&(A=l)),Fo(I>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,A,i,a,s,o,r),w.Children.map(c,P=>w.cloneElement(P,{width:I,height:A,style:bf({width:I,height:A},P.props.style)}))},[r,c,a,l,o,s,_,i]);return w.createElement("div",{id:h?"".concat(h):void 0,className:Me("recharts-responsive-container",m),style:bf(bf({},y),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:l}),ref:b},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},O))});function Hw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Um(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Hw(Object(r),!0).forEach(function(n){oG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Hw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function oG(t,e,r){return(e=lG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lG(t){var e=cG(t,"string");return typeof e=="symbol"?e:e+""}function cG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var as={widthCache:{},cacheCount:0},uG=2e3,dG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Ww="recharts_measurement_span";function hG(t){var e=Um({},t);return Object.keys(e).forEach(r=>{e[r]||delete e[r]}),e}var zo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||kl.isSsr)return{width:0,height:0};var n=hG(r),i=JSON.stringify({text:e,copyStyle:n});if(as.widthCache[i])return as.widthCache[i];try{var a=document.getElementById(Ww);a||(a=document.createElement("span"),a.setAttribute("id",Ww),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=Um(Um({},dG),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),l={width:o.width,height:o.height};return as.widthCache[i]=l,++as.cacheCount>uG&&(as.cacheCount=0,as.widthCache={}),l}catch{return{width:0,height:0}}},qw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Kw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,mG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,XP={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},pG=Object.keys(XP),hs="NaN";function gG(t,e){return t*XP[e]}class lr{static parse(e){var r,[,n,i]=(r=mG.exec(e))!==null&&r!==void 0?r:[];return new lr(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,$r(e)&&(this.unit=""),r!==""&&!fG.test(r)&&(this.num=NaN,this.unit=""),pG.includes(r)&&(this.num=gG(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return $r(this.num)}}function QP(t){if(t.includes(hs))return hs;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=qw.exec(e))!==null&&r!==void 0?r:[],s=lr.parse(n??""),o=lr.parse(a??""),l=i==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return hs;e=e.replace(qw,l.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var c,[,u,h,m]=(c=Kw.exec(e))!==null&&c!==void 0?c:[],p=lr.parse(u??""),y=lr.parse(m??""),b=h==="+"?p.add(y):p.subtract(y);if(b.isNaN())return hs;e=e.replace(Kw,b.toString())}return e}var Gw=/\(([^()]*)\)/;function yG(t){for(var e=t,r;(r=Gw.exec(e))!=null;){var[,n]=r;e=e.replace(Gw,QP(n))}return e}function vG(t){var e=t.replace(/\s+/g,"");return e=yG(e),e=QP(e),e}function bG(t){try{return vG(t)}catch{return hs}}function xf(t){var e=bG(t.slice(5,-1));return e===hs?"":e}var xG=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],wG=["dx","dy","angle","className","breakAll"];function Bm(){return Bm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Bm.apply(null,arguments)}function Yw(t,e){if(t==null)return{};var r,n,i=_G(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function _G(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var JP=/[ \f\n\r\t\v\u2028\u2029]+/,ek=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];lt(e)||(r?i=e.toString().split(""):i=e.toString().split(JP));var a=i.map(o=>({word:o,width:zo(o,n).width})),s=r?0:zo(" ",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},EG=(t,e,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:l}=t,c=te(a),u=s,h=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((k,C)=>{var{word:Q,width:oe}=C,X=k[k.length-1];if(X&&(n==null||i||X.width+oe+r<Number(n)))X.words.push(Q),X.width+=oe+r;else{var ee={words:[Q],width:oe};k.push(ee)}return k},[])},m=h(e),p=j=>j.reduce((N,k)=>N.width>k.width?N:k);if(!c||i)return m;var y=m.length>a||p(m).width>Number(n);if(!y)return m;for(var b="…",g=j=>{var N=u.slice(0,j),k=ek({breakAll:l,style:o,children:N+b}).wordsWithComputedWidth,C=h(k),Q=C.length>a||p(C).width>Number(n);return[Q,C]},_=0,T=u.length-1,E=0,O;_<=T&&E<=u.length-1;){var R=Math.floor((_+T)/2),D=R-1,[I,A]=g(D),[P]=g(R);if(!I&&!P&&(_=R+1),I&&P&&(T=R-1),!I&&P){O=A;break}E++}return O||m},Zw=t=>{var e=lt(t)?[]:t.toString().split(JP);return[{words:e}]},TG=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=t;if((e||r)&&!kl.isSsr){var o,l,c=ek({breakAll:a,children:n,style:i});if(c){var{wordsWithComputedWidth:u,spaceWidth:h}=c;o=u,l=h}else return Zw(n);return EG({breakAll:a,children:n,maxLines:s,style:i},o,l,e,r)}return Zw(n)},Xw="#808080",Ry=w.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:c=Xw}=t,u=Yw(t,xG),h=w.useMemo(()=>TG({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:m,dy:p,angle:y,className:b,breakAll:g}=u,_=Yw(u,wG);if(!In(r)||!In(n))return null;var T=r+(te(m)?m:0),E=n+(te(p)?p:0),O;switch(l){case"start":O=xf("calc(".concat(a,")"));break;case"middle":O=xf("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:O=xf("calc(".concat(h.length-1," * -").concat(i,")"));break}var R=[];if(s){var D=h[0].width,{width:I}=u;R.push("scale(".concat(te(I)?I/D:1,")"))}return y&&R.push("rotate(".concat(y,", ").concat(T,", ").concat(E,")")),R.length&&(_.transform=R.join(" ")),w.createElement("text",Bm({},qe(_,!0),{ref:e,x:T,y:E,className:Me("recharts-text",b),textAnchor:o,fill:c.includes("url")?Xw:c}),h.map((A,P)=>{var j=A.words.join(g?"":" ");return w.createElement("tspan",{x:T,dy:P===0?O:i,key:"".concat(j,"-").concat(P)},j)}))});Ry.displayName="Text";var AG=["offset"],IG=["labelRef"];function Qw(t,e){if(t==null)return{};var r,n,i=SG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function SG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Jw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ht(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jw(Object(r),!0).forEach(function(n){PG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function PG(t,e,r){return(e=kG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kG(t){var e=CG(t,"string");return typeof e=="symbol"?e:e+""}function CG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ln(){return Ln=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ln.apply(null,arguments)}var NG=t=>{var{value:e,formatter:r}=t,n=lt(t.children)?e:t.children;return typeof r=="function"?r(n):n},Dy=t=>t!=null&&typeof t=="function",jG=(t,e)=>{var r=Dr(e-t),n=Math.min(Math.abs(e-t),360);return r*n},OG=(t,e,r)=>{var{position:n,viewBox:i,offset:a,className:s}=t,{cx:o,cy:l,innerRadius:c,outerRadius:u,startAngle:h,endAngle:m,clockWise:p}=i,y=(c+u)/2,b=jG(h,m),g=b>=0?1:-1,_,T;n==="insideStart"?(_=h+g*a,T=p):n==="insideEnd"?(_=m-g*a,T=!p):n==="end"&&(_=m+g*a,T=p),T=b<=0?T:!T;var E=Ut(o,l,y,_),O=Ut(o,l,y,_+(T?1:-1)*359),R="M".concat(E.x,",").concat(E.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(T?0:1,`,
    `).concat(O.x,",").concat(O.y),D=lt(t.id)?il("recharts-radial-line-"):t.id;return w.createElement("text",Ln({},r,{dominantBaseline:"central",className:Me("recharts-radial-bar-label",s)}),w.createElement("defs",null,w.createElement("path",{id:D,d:R})),w.createElement("textPath",{xlinkHref:"#".concat(D)},e))},RG=t=>{var{viewBox:e,offset:r,position:n}=t,{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(n==="outside"){var{x:h,y:m}=Ut(i,a,o+r,u);return{x:h,y:m,textAnchor:h>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:y,y:b}=Ut(i,a,p,u);return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},DG=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,{x:a,y:s,width:o,height:l}=e,c=l>=0?1:-1,u=c*n,h=c>0?"end":"start",m=c>0?"start":"end",p=o>=0?1:-1,y=p*n,b=p>0?"end":"start",g=p>0?"start":"end";if(i==="top"){var _={x:a+o/2,y:s-c*n,textAnchor:"middle",verticalAnchor:h};return ht(ht({},_),r?{height:Math.max(s-r.y,0),width:o}:{})}if(i==="bottom"){var T={x:a+o/2,y:s+l+u,textAnchor:"middle",verticalAnchor:m};return ht(ht({},T),r?{height:Math.max(r.y+r.height-(s+l),0),width:o}:{})}if(i==="left"){var E={x:a-y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"};return ht(ht({},E),r?{width:Math.max(E.x-r.x,0),height:l}:{})}if(i==="right"){var O={x:a+o+y,y:s+l/2,textAnchor:g,verticalAnchor:"middle"};return ht(ht({},O),r?{width:Math.max(r.x+r.width-O.x,0),height:l}:{})}var R=r?{width:o,height:l}:{};return i==="insideLeft"?ht({x:a+y,y:s+l/2,textAnchor:g,verticalAnchor:"middle"},R):i==="insideRight"?ht({x:a+o-y,y:s+l/2,textAnchor:b,verticalAnchor:"middle"},R):i==="insideTop"?ht({x:a+o/2,y:s+u,textAnchor:"middle",verticalAnchor:m},R):i==="insideBottom"?ht({x:a+o/2,y:s+l-u,textAnchor:"middle",verticalAnchor:h},R):i==="insideTopLeft"?ht({x:a+y,y:s+u,textAnchor:g,verticalAnchor:m},R):i==="insideTopRight"?ht({x:a+o-y,y:s+u,textAnchor:b,verticalAnchor:m},R):i==="insideBottomLeft"?ht({x:a+y,y:s+l-u,textAnchor:g,verticalAnchor:h},R):i==="insideBottomRight"?ht({x:a+o-y,y:s+l-u,textAnchor:b,verticalAnchor:h},R):i&&typeof i=="object"&&(te(i.x)||ha(i.x))&&(te(i.y)||ha(i.y))?ht({x:a+Fi(i.x,o),y:s+Fi(i.y,l),textAnchor:"end",verticalAnchor:"end"},R):ht({x:a+o/2,y:s+l/2,textAnchor:"middle",verticalAnchor:"middle"},R)},MG=t=>"cx"in t&&te(t.cx);function xr(t){var{offset:e=5}=t,r=Qw(t,AG),n=ht({offset:e},r),{viewBox:i,position:a,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:h}=n,m=Lg(),p=i||m;if(!p||lt(s)&&lt(o)&&!w.isValidElement(l)&&typeof l!="function")return null;if(w.isValidElement(l)){var{labelRef:y}=n,b=Qw(n,IG);return w.cloneElement(l,b)}var g;if(typeof l=="function"){if(g=w.createElement(l,n),w.isValidElement(g))return g}else g=NG(n);var _=MG(p),T=qe(n,!0);if(_&&(a==="insideStart"||a==="insideEnd"||a==="end"))return OG(n,g,T);var E=_?RG(n):DG(n,p);return w.createElement(Ry,Ln({ref:h,className:Me("recharts-label",c)},T,E,{breakAll:u}),g)}xr.displayName="Label";var tk=t=>{var{cx:e,cy:r,angle:n,startAngle:i,endAngle:a,r:s,radius:o,innerRadius:l,outerRadius:c,x:u,y:h,top:m,left:p,width:y,height:b,clockWise:g,labelViewBox:_}=t;if(_)return _;if(te(y)&&te(b)){if(te(u)&&te(h))return{x:u,y:h,width:y,height:b};if(te(m)&&te(p))return{x:m,y:p,width:y,height:b}}if(te(u)&&te(h))return{x:u,y:h,width:0,height:0};if(te(e)&&te(r))return{cx:e,cy:r,startAngle:i||n||0,endAngle:a||n||0,innerRadius:l||0,outerRadius:c||o||s||0,clockWise:g};if(t.viewBox)return t.viewBox},LG=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?w.createElement(xr,Ln({key:"label-implicit"},n)):In(t)?w.createElement(xr,Ln({key:"label-implicit",value:t},n)):w.isValidElement(t)?t.type===xr?w.cloneElement(t,ht({key:"label-implicit"},n)):w.createElement(xr,Ln({key:"label-implicit",content:t},n)):Dy(t)?w.createElement(xr,Ln({key:"label-implicit",content:t},n)):t&&typeof t=="object"?w.createElement(xr,Ln({},t,{key:"label-implicit"},n)):null},$G=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:i,labelRef:a}=e,s=tk(e),o=pA(i,xr).map((c,u)=>w.cloneElement(c,{viewBox:r||s,key:"label-".concat(u)}));if(!n)return o;var l=LG(e.label,r||s,a);return[l,...o]};xr.parseViewBox=tk;xr.renderCallByParent=$G;var rk={},nk={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(nk);var ik={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(ik);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=nk,r=ik,n=Gd;function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(rk);var VG=rk.last;const FG=Ui(VG);var zG=["valueAccessor"],UG=["data","dataKey","clockWise","id","textBreakAll"];function Zu(){return Zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zu.apply(null,arguments)}function e_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function t_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?e_(Object(r),!0).forEach(function(n){BG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BG(t,e,r){return(e=HG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HG(t){var e=WG(t,"string");return typeof e=="symbol"?e:e+""}function WG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r_(t,e){if(t==null)return{};var r,n,i=qG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function qG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var KG=t=>Array.isArray(t.value)?FG(t.value):t.value;function Ea(t){var{valueAccessor:e=KG}=t,r=r_(t,zG),{data:n,dataKey:i,clockWise:a,id:s,textBreakAll:o}=r,l=r_(r,UG);return!n||!n.length?null:w.createElement(zi,{className:"recharts-label-list"},n.map((c,u)=>{var h=lt(i)?e(c,u):Tr(c&&c.payload,i),m=lt(s)?{}:{id:"".concat(s,"-").concat(u)};return w.createElement(xr,Zu({},qe(c,!0),l,m,{parentViewBox:c.parentViewBox,value:h,textBreakAll:o,viewBox:xr.parseViewBox(lt(a)?c:t_(t_({},c),{},{clockWise:a})),key:"label-".concat(u),index:u}))}))}Ea.displayName="LabelList";function GG(t,e){return t?t===!0?w.createElement(Ea,{key:"labelList-implicit",data:e}):w.isValidElement(t)||Dy(t)?w.createElement(Ea,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?w.createElement(Ea,Zu({data:e},t,{key:"labelList-implicit"})):null:null}function YG(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:n}=t,i=pA(n,Ea).map((s,o)=>w.cloneElement(s,{data:e,key:"labelList-".concat(o)}));if(!r)return i;var a=GG(t.label,e);return[a,...i]}Ea.renderCallByParent=YG;function Hm(){return Hm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hm.apply(null,arguments)}var ak=t=>{var{cx:e,cy:r,r:n,className:i}=t,a=Me("recharts-dot",i);return e===+e&&r===+r&&n===+n?w.createElement("circle",Hm({},qe(t,!1),xg(t),{className:a,cx:e,cy:r,r:n})):null},ZG={radiusAxis:{},angleAxis:{}},sk=Ur({name:"polarAxis",initialState:ZG,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:tee,removeRadiusAxis:ree,addAngleAxis:nee,removeAngleAxis:iee}=sk.actions,XG=sk.reducer,QG={countOfBars:0,cartesianItems:[],polarItems:[]},ok=Ur({name:"graphicalItems",initialState:QG,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,i=Bn(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},removeCartesianGraphicalItem(t,e){var r=Bn(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Bn(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addBar:aee,removeBar:see,addCartesianGraphicalItem:JG,replaceCartesianGraphicalItem:eY,removeCartesianGraphicalItem:tY,addPolarGraphicalItem:oee,removePolarGraphicalItem:lee}=ok.actions,rY=ok.reducer;function n_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function i_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?n_(Object(r),!0).forEach(function(n){nY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nY(t,e,r){return(e=iY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iY(t){var e=aY(t,"string");return typeof e=="symbol"?e:e+""}function aY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sY(t){var e=sr(),r=w.useRef(null);return w.useEffect(()=>{var n=i_(i_({},t),{},{stackId:nB(t.stackId)});r.current===null?e(JG(n)):r.current!==n&&e(eY({prev:r.current,next:n})),r.current=n},[e,t]),w.useEffect(()=>()=>{r.current&&(e(tY(r.current)),r.current=null)},[e]),null}function oY(t){var{fn:e,args:r}=t,n=sr(),i=mr();return w.useEffect(()=>{if(!i){var a=e(r);return n(k7(a)),()=>{n(C7(a))}}},[e,r,n,i]),null}var lY=()=>{};function cY(t){var{legendPayload:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?lY:(r(wB(e)),()=>{r(_B(e))}),[r,n,e]),null}function uY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(il(e)),n=w.useRef(t);return n.current!==t&&(r.current=il(e),n.current=t),r.current}var dY=V([Wt],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),hY=V([dY,ii,ai],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),fY=t=>{var e=mr();return ie(r=>xh(r,"xAxis",t,e))},mY=t=>{var e=mr();return ie(r=>xh(r,"yAxis",t,e))},My=()=>ie(hY),pY=()=>ie(yK);function a_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function s_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a_(Object(r),!0).forEach(function(n){gY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gY(t,e,r){return(e=yY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yY(t){var e=vY(t,"string");return typeof e=="symbol"?e:e+""}function vY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bY=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=t;if(i===!1||e.x==null||e.y==null)return null;var s=s_(s_({index:r,dataKey:a,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},qe(i,!1)),xg(i)),o;return w.isValidElement(i)?o=w.cloneElement(i,s):typeof i=="function"?o=i(s):o=w.createElement(ak,s),w.createElement(zi,{className:"recharts-active-dot"},o)};function xY(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:i}=t,a=ie(dl),s=pY();if(e==null||s==null)return null;var o=e.find(l=>s.includes(l.payload));return lt(o)?null:bY({point:o,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var wY=["children"];function _Y(t,e){if(t==null)return{};var r,n,i=EY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function EY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var o_=()=>{},lk=w.createContext({addErrorBar:o_,removeErrorBar:o_}),TY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},ck=w.createContext(TY);function AY(t){var{children:e}=t,r=_Y(t,wY);return w.createElement(ck.Provider,{value:r},e)}var IY=()=>w.useContext(ck),SY=t=>{var{children:e,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,data:s,stackId:o,hide:l,type:c,barSize:u}=t,[h,m]=w.useState([]),p=w.useCallback(g=>{m(_=>[..._,g])},[m]),y=w.useCallback(g=>{m(_=>_.filter(T=>T!==g))},[m]),b=mr();return w.createElement(lk.Provider,{value:{addErrorBar:p,removeErrorBar:y}},w.createElement(sY,{type:c,data:s,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,errorBars:h,stackId:o,hide:l,barSize:u,isPanorama:b}),e)};function PY(t){var{addErrorBar:e,removeErrorBar:r}=w.useContext(lk);return w.useEffect(()=>(e(t),()=>{r(t)}),[e,r,t]),null}var kY=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function uk(t,e,r){return(e=CY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CY(t){var e=NY(t,"string");return typeof e=="symbol"?e:e+""}function NY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fl(){return fl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fl.apply(null,arguments)}function jY(t,e){if(t==null)return{};var r,n,i=OY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function OY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function RY(t){var{direction:e,width:r,dataKey:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o}=t,l=jY(t,kY),c=qe(l,!1),{data:u,dataPointFormatter:h,xAxisId:m,yAxisId:p,errorBarOffset:y}=IY(),b=fY(m),g=mY(p);if(b?.scale==null||g?.scale==null||u==null||e==="x"&&b.type!=="number")return null;var _=u.map(T=>{var{x:E,y:O,value:R,errorVal:D}=h(T,n,e);if(!D)return null;var I=[],A,P;if(Array.isArray(D)?[A,P]=D:A=P=D,e==="x"){var{scale:j}=b,N=O+y,k=N+r,C=N-r,Q=j(R-A),oe=j(R+P);I.push({x1:oe,y1:k,x2:oe,y2:C}),I.push({x1:Q,y1:N,x2:oe,y2:N}),I.push({x1:Q,y1:k,x2:Q,y2:C})}else if(e==="y"){var{scale:X}=g,ee=E+y,he=ee-r,ye=ee+r,ze=X(R-A),se=X(R+P);I.push({x1:he,y1:se,x2:ye,y2:se}),I.push({x1:ee,y1:ze,x2:ee,y2:se}),I.push({x1:he,y1:ze,x2:ye,y2:ze})}var q="".concat(E+y,"px ").concat(O+y,"px");return w.createElement(zi,fl({className:"recharts-errorBar",key:"bar-".concat(I.map(J=>"".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)))},c),I.map(J=>{var tt=i?{transformOrigin:"".concat(J.x1-5,"px")}:void 0;return w.createElement(Mu,{from:{transform:"scaleY(0)",transformOrigin:q},to:{transform:"scaleY(1)",transformOrigin:q},begin:a,easing:o,isActive:i,duration:s,key:"line-".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2),style:{transformOrigin:q}},w.createElement("line",fl({},J,{style:tt})))}))});return w.createElement(zi,{className:"recharts-errorBars"},_)}var dk=w.createContext(void 0);function DY(t){var e=w.useContext(dk);return t??e??"x"}function MY(t){var{direction:e,children:r}=t;return w.createElement(dk.Provider,{value:e},r)}var hk={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function LY(t){var e=DY(t.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s}=Wa(t,hk);return w.createElement(w.Fragment,null,w.createElement(PY,{dataKey:t.dataKey,direction:e}),w.createElement(RY,fl({},t,{direction:e,width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s})))}class fk extends w.Component{render(){return w.createElement(LY,this.props)}}uk(fk,"defaultProps",hk);uk(fk,"displayName","ErrorBar");function mk(t,e){var r,n,i=ie(c=>oi(c,t)),a=ie(c=>Gi(c,e)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:yr.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:vr.allowDataOverflow,l=s||o;return{needClip:l,needClipX:s,needClipY:o}}function $Y(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=My(),{needClipX:a,needClipY:s,needClip:o}=mk(e,r);if(!o)return null;var{x:l,y:c,width:u,height:h}=i;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?l:l-u/2,y:s?c:c-h/2,width:a?u:u*2,height:s?h:h*2}))}var VY=t=>{var{chartData:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?()=>{}:(r(Lw(e)),()=>{r(Lw(void 0))}),[e,r,n]),null},l_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},pk=Ur({name:"brush",initialState:l_,reducers:{setBrushSettings(t,e){return e.payload==null?l_:e.payload}}}),{setBrushSettings:cee}=pk.actions,FY=pk.reducer;function zY(t,e,r){return(e=UY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UY(t){var e=BY(t,"string");return typeof e=="symbol"?e:e+""}function BY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ly{static create(e){return new Ly(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}zY(Ly,"EPS",1e-4);function HY(t){return(t%180+180)%180}var WY=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=HY(i),s=a*Math.PI/180,o=Math.atan(n/r),l=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(l)},qY={dots:[],areas:[],lines:[]},gk=Ur({name:"referenceElements",initialState:qY,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Bn(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Bn(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Bn(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:uee,removeDot:dee,addArea:hee,removeArea:fee,addLine:mee,removeLine:pee}=gk.actions,KY=gk.reducer,GY=w.createContext(void 0),YY=t=>{var{children:e}=t,[r]=w.useState("".concat(il("recharts"),"-clip")),n=My();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return w.createElement(GY.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:i,y:a,height:o,width:s}))),e)};function wf(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function yk(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function ZY(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return WY(n,r)}function XY(t,e,r){var n=r==="width",{x:i,y:a,width:s,height:o}=t;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function Xu(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function QY(t,e){return yk(t,e+1)}function JY(t,e,r,n,i){for(var a=(n||[]).slice(),{start:s,end:o}=e,l=0,c=1,u=s,h=function(){var y=n?.[l];if(y===void 0)return{v:yk(n,c)};var b=l,g,_=()=>(g===void 0&&(g=r(y,b)),g),T=y.coordinate,E=l===0||Xu(t,T,_,u,o);E||(l=0,u=s,c+=1),E&&(u=T+t*(_()/2+i),l+=c)},m;c<=a.length;)if(m=h(),m)return m.v;return[]}function c_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c_(Object(r),!0).forEach(function(n){eZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function eZ(t,e,r){return(e=tZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tZ(t){var e=rZ(t,"string");return typeof e=="symbol"?e:e+""}function rZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nZ(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:o}=e,{end:l}=e,c=function(m){var p=a[m],y,b=()=>(y===void 0&&(y=r(p,m)),y);if(m===s-1){var g=t*(p.coordinate+t*b()/2-l);a[m]=p=Xt(Xt({},p),{},{tickCoord:g>0?p.coordinate-g*t:p.coordinate})}else a[m]=p=Xt(Xt({},p),{},{tickCoord:p.coordinate});var _=Xu(t,p.tickCoord,b,o,l);_&&(l=p.tickCoord-t*(b()/2+i),a[m]=Xt(Xt({},p),{},{isShow:!0}))},u=s-1;u>=0;u--)c(u);return a}function iZ(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,{start:l,end:c}=e;if(a){var u=n[o-1],h=r(u,o-1),m=t*(u.coordinate+t*h/2-c);s[o-1]=u=Xt(Xt({},u),{},{tickCoord:m>0?u.coordinate-m*t:u.coordinate});var p=Xu(t,u.tickCoord,()=>h,l,c);p&&(c=u.tickCoord-t*(h/2+i),s[o-1]=Xt(Xt({},u),{},{isShow:!0}))}for(var y=a?o-1:o,b=function(T){var E=s[T],O,R=()=>(O===void 0&&(O=r(E,T)),O);if(T===0){var D=t*(E.coordinate-t*R()/2-l);s[T]=E=Xt(Xt({},E),{},{tickCoord:D<0?E.coordinate-D*t:E.coordinate})}else s[T]=E=Xt(Xt({},E),{},{tickCoord:E.coordinate});var I=Xu(t,E.tickCoord,R,l,c);I&&(l=E.tickCoord+t*(R()/2+i),s[T]=Xt(Xt({},E),{},{isShow:!0}))},g=0;g<y;g++)b(g);return s}function $y(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:o,interval:l,tickFormatter:c,unit:u,angle:h}=t;if(!i||!i.length||!n)return[];if(te(l)||kl.isSsr){var m;return(m=QY(i,te(l)?l:0))!==null&&m!==void 0?m:[]}var p=[],y=o==="top"||o==="bottom"?"width":"height",b=u&&y==="width"?zo(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(E,O)=>{var R=typeof c=="function"?c(E.value,O):E.value;return y==="width"?ZY(zo(R,{fontSize:e,letterSpacing:r}),b,h):zo(R,{fontSize:e,letterSpacing:r})[y]},_=i.length>=2?Dr(i[1].coordinate-i[0].coordinate):1,T=XY(a,_,y);return l==="equidistantPreserveStart"?JY(_,T,g,i,s):(l==="preserveStart"||l==="preserveStartEnd"?p=iZ(_,T,g,i,s,l==="preserveStartEnd"):p=nZ(_,T,g,i,s),p.filter(E=>E.isShow))}var aZ=["viewBox"],sZ=["viewBox"];function fs(){return fs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fs.apply(null,arguments)}function u_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?u_(Object(r),!0).forEach(function(n){Vy(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function d_(t,e){if(t==null)return{};var r,n,i=oZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function oZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Vy(t,e,r){return(e=lZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lZ(t){var e=cZ(t,"string");return typeof e=="symbol"?e:e+""}function cZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yi extends w.Component{constructor(e){super(e),this.tickRefs=w.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,r){var{viewBox:n}=e,i=d_(e,aZ),a=this.props,{viewBox:s}=a,o=d_(a,sZ);return!wf(n,s)||!wf(i,o)||!wf(r,this.state)}getTickLineCoord(e){var{x:r,y:n,width:i,height:a,orientation:s,tickSize:o,mirror:l,tickMargin:c}=this.props,u,h,m,p,y,b,g=l?-1:1,_=e.tickSize||o,T=te(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=h=e.coordinate,p=n+ +!l*a,m=p-g*_,b=m-g*c,y=T;break;case"left":m=p=e.coordinate,h=r+ +!l*i,u=h-g*_,y=u-g*c,b=T;break;case"right":m=p=e.coordinate,h=r+ +l*i,u=h+g*_,y=u+g*c,b=T;break;default:u=h=e.coordinate,p=n+ +l*a,m=p+g*_,b=m+g*c,y=T;break}return{line:{x1:u,y1:m,x2:h,y2:p},tick:{x:y,y:b}}}getTickTextAnchor(){var{orientation:e,mirror:r}=this.props,n;switch(e){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:e,mirror:r}=this.props;switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:e,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:o}=this.props,l=bt(bt(bt({},qe(this.props,!1)),qe(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var c=+(a==="top"&&!s||a==="bottom"&&s);l=bt(bt({},l),{},{x1:e,y1:r+c*i,x2:e+n,y2:r+c*i})}else{var u=+(a==="left"&&!s||a==="right"&&s);l=bt(bt({},l),{},{x1:e+u*n,y1:r,x2:e+u*n,y2:r+i})}return w.createElement("line",fs({},l,{className:Me("recharts-cartesian-axis-line",Da(o,"className"))}))}static renderTickItem(e,r,n){var i,a=Me(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(e))i=w.cloneElement(e,bt(bt({},r),{},{className:a}));else if(typeof e=="function")i=e(bt(bt({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=Me(s,e.className)),i=w.createElement(Ry,fs({},r,{className:s}),n)}return i}renderTicks(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:a,tick:s,tickFormatter:o,unit:l}=this.props,c=$y(bt(bt({},this.props),{},{ticks:n}),e,r),u=this.getTickTextAnchor(),h=this.getTickVerticalAnchor(),m=qe(this.props,!1),p=qe(s,!1),y=bt(bt({},m),{},{fill:"none"},qe(i,!1)),b=c.map((g,_)=>{var{line:T,tick:E}=this.getTickLineCoord(g),O=bt(bt(bt(bt({textAnchor:u,verticalAnchor:h},m),{},{stroke:"none",fill:a},p),E),{},{index:_,payload:g,visibleTicksCount:c.length,tickFormatter:o});return w.createElement(zi,fs({className:"recharts-cartesian-axis-tick",key:"tick-".concat(g.value,"-").concat(g.coordinate,"-").concat(g.tickCoord)},Rz(this.props,g,_)),i&&w.createElement("line",fs({},y,T,{className:Me("recharts-cartesian-axis-tick-line",Da(i,"className"))})),s&&Yi.renderTickItem(s,O,"".concat(typeof o=="function"?o(g.value,_):g.value).concat(l||"")))});return b.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:e,width:r,height:n,className:i,hide:a}=this.props;if(a)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:w.createElement(zi,{className:Me("recharts-cartesian-axis",i),ref:o=>{if(o){var l=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var u=window.getComputedStyle(c).fontSize,h=window.getComputedStyle(c).letterSpacing;(u!==this.state.fontSize||h!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),xr.renderCallByParent(this.props))}}Vy(Yi,"displayName","CartesianAxis");Vy(Yi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var uZ=["x1","y1","x2","y2","key"],dZ=["offset"],hZ=["xAxisId","yAxisId"],fZ=["xAxisId","yAxisId"];function h_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function er(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?h_(Object(r),!0).forEach(function(n){mZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function mZ(t,e,r){return(e=pZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:e+""}function gZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ga(){return ga=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ga.apply(null,arguments)}function Qu(t,e){if(t==null)return{};var r,n,i=yZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var vZ=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:o}=t;return w.createElement("rect",{x:n,y:i,ry:o,width:a,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function vk(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:i,x2:a,y2:s,key:o}=e,l=Qu(e,uZ),c=qe(l,!1),{offset:u}=c,h=Qu(c,dZ);r=w.createElement("line",ga({},h,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function bZ(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=Qu(t,hZ),l=i.map((c,u)=>{var h=er(er({},o),{},{x1:e,y1:c,x2:e+r,y2:c,key:"line-".concat(u),index:u});return vk(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function xZ(t){var{y:e,height:r,vertical:n=!0,verticalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=Qu(t,fZ),l=i.map((c,u)=>{var h=er(er({},o),{},{x1:c,y1:e,x2:c,y2:e+r,key:"line-".concat(u),index:u});return vk(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function wZ(t){var{horizontalFill:e,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:o,horizontal:l=!0}=t;if(!l||!e||!e.length)return null;var c=o.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==c[0]&&c.unshift(0);var u=c.map((h,m)=>{var p=!c[m+1],y=p?i+s-h:c[m+1]-h;if(y<=0)return null;var b=m%e.length;return w.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:y,width:a,stroke:"none",fill:e[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function _Z(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,verticalPoints:l}=t;if(!e||!r||!r.length)return null;var c=l.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==c[0]&&c.unshift(0);var u=c.map((h,m)=>{var p=!c[m+1],y=p?i+s-h:c[m+1]-h;if(y<=0)return null;var b=m%r.length;return w.createElement("rect",{key:"react-".concat(m),x:h,y:a,width:y,height:o,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var EZ=(t,e)=>{var{xAxis:r,width:n,height:i,offset:a}=t;return wI($y(er(er(er({},Yi.defaultProps),r),{},{ticks:_I(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,e)},TZ=(t,e)=>{var{yAxis:r,width:n,height:i,offset:a}=t;return wI($y(er(er(er({},Yi.defaultProps),r),{},{ticks:_I(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,e)},AZ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Wm(t){var e=SI(),r=PI(),n=II(),i=er(er({},Wa(t,AZ)),{},{x:te(t.x)?t.x:n.left,y:te(t.y)?t.y:n.top,width:te(t.width)?t.width:n.width,height:te(t.height)?t.height:n.height}),{xAxisId:a,yAxisId:s,x:o,y:l,width:c,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,y=mr(),b=ie(P=>kw(P,"xAxis",a,y)),g=ie(P=>kw(P,"yAxis",s,y));if(!te(c)||c<=0||!te(u)||u<=0||!te(o)||o!==+o||!te(l)||l!==+l)return null;var _=i.verticalCoordinatesGenerator||EZ,T=i.horizontalCoordinatesGenerator||TZ,{horizontalPoints:E,verticalPoints:O}=i;if((!E||!E.length)&&typeof T=="function"){var R=m&&m.length,D=T({yAxis:g?er(er({},g),{},{ticks:R?m:g.ticks}):void 0,width:e,height:r,offset:n},R?!0:h);Fo(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(E=D)}if((!O||!O.length)&&typeof _=="function"){var I=p&&p.length,A=_({xAxis:b?er(er({},b),{},{ticks:I?p:b.ticks}):void 0,width:e,height:r,offset:n},I?!0:h);Fo(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(O=A)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(vZ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),w.createElement(wZ,ga({},i,{horizontalPoints:E})),w.createElement(_Z,ga({},i,{verticalPoints:O})),w.createElement(bZ,ga({},i,{offset:n,horizontalPoints:E,xAxis:b,yAxis:g})),w.createElement(xZ,ga({},i,{offset:n,verticalPoints:O,xAxis:b,yAxis:g})))}Wm.displayName="CartesianGrid";var bk=(t,e,r,n)=>xh(t,"xAxis",e,n),xk=(t,e,r,n)=>wP(t,"xAxis",e,n),wk=(t,e,r,n)=>xh(t,"yAxis",r,n),_k=(t,e,r,n)=>wP(t,"yAxis",r,n),IZ=V([et,bk,wk,xk,_k],(t,e,r,n,i)=>Wi(t,"xAxis")?xm(e,n,!1):xm(r,i,!1)),SZ=(t,e,r,n,i)=>i,PZ=V([KS,SZ],(t,e)=>{if(t.some(r=>r.type==="line"&&e.dataKey===r.dataKey&&e.data===r.data))return e}),kZ=V([et,bk,wk,xk,_k,PZ,IZ,AS],(t,e,r,n,i,a,s,o)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:u}=o;if(!(a==null||e==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:h,data:m}=a,p;if(m!=null&&m.length>0?p=m:p=l?.slice(c,u+1),p!=null)return GZ({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:h,bandSize:s,displayedData:p})}}),CZ=["type","layout","connectNulls","needClip"],NZ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function Ek(t,e){if(t==null)return{};var r,n,i=jZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function jZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function f_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f_(Object(r),!0).forEach(function(n){Eh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Eh(t,e,r){return(e=OZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OZ(t){var e=RZ(t,"string");return typeof e=="symbol"?e:e+""}function RZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ds(){return Ds=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ds.apply(null,arguments)}var DZ=t=>{var{dataKey:e,name:r,stroke:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:EI(r,e),payload:t}]};function MZ(t){var{dataKey:e,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:l}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:e,nameKey:void 0,name:EI(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:l}}}var Tk=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function LZ(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],i=0;i<e;++i)n=[...n,...r];return n}var $Z=(t,e,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return Tk(e,t);for(var i=Math.floor(t/n),a=t%n,s=e-t,o=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>a){o=[...r.slice(0,l),a-c];break}var u=o.length%2===0?[0,s]:[s];return[...LZ(r,i),...o,...u].map(h=>"".concat(h,"px")).join(", ")};function VZ(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=Me("recharts-line-dot",typeof t!="boolean"?t.className:"");r=w.createElement(ak,Ds({},e,{className:n}))}return r}function FZ(t,e){return t==null?!1:e?!0:t.length===1}function zZ(t){var{clipPathId:e,points:r,props:n}=t,{dot:i,dataKey:a,needClip:s}=n;if(!FZ(r,i))return null;var o=gA(i),l=qe(n,!1),c=qe(i,!0),u=r.map((m,p)=>{var y=Kr(Kr(Kr({key:"dot-".concat(p),r:3},l),c),{},{index:p,cx:m.x,cy:m.y,dataKey:a,value:m.value,payload:m.payload,points:r});return VZ(i,y)}),h={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):null};return w.createElement(zi,Ds({className:"recharts-line-dots",key:"dots"},h),u)}function qm(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:i,props:a,showLabels:s}=t,{type:o,layout:l,connectNulls:c,needClip:u}=a,h=Ek(a,CZ),m=Kr(Kr({},qe(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):null,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(NI,Ds({},m,{pathRef:r})),w.createElement(zZ,{points:n,clipPathId:e,props:a}),s&&Ea.renderCallByParent(a,n))}function UZ(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function BZ(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=t,{points:s,strokeDasharray:o,isAnimationActive:l,animationBegin:c,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:y,onAnimationEnd:b,onAnimationStart:g}=r,_=i.current,T=uY(r,"recharts-line-"),[E,O]=w.useState(!1),R=w.useCallback(()=>{typeof b=="function"&&b(),O(!1)},[b]),D=w.useCallback(()=>{typeof g=="function"&&g(),O(!0)},[g]),I=UZ(n.current),A=a.current;return w.createElement(Mu,{begin:c,duration:u,isActive:l,easing:h,from:{t:0},to:{t:1},onAnimationEnd:R,onAnimationStart:D,key:T},P=>{var{t:j}=P,N=mo(A,I+A),k=Math.min(N(j),I),C;if(o){var Q="".concat(o).split(/[,\s]+/gim).map(ee=>parseFloat(ee));C=$Z(k,I,Q)}else C=Tk(I,k);if(_){var oe=_.length/s.length,X=j===1?s:s.map((ee,he)=>{var ye=Math.floor(he*oe);if(_[ye]){var ze=_[ye],se=mo(ze.x,ee.x),q=mo(ze.y,ee.y);return Kr(Kr({},ee),{},{x:se(j),y:q(j)})}if(m){var J=mo(p*2,ee.x),tt=mo(y/2,ee.y);return Kr(Kr({},ee),{},{x:J(j),y:tt(j)})}return Kr(Kr({},ee),{},{x:ee.x,y:ee.y})});return i.current=X,w.createElement(qm,{props:r,points:X,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:C})}return j>0&&I>0&&(i.current=s,a.current=k),w.createElement(qm,{props:r,points:s,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:C})})}function HZ(t){var{clipPathId:e,props:r}=t,{points:n,isAnimationActive:i}=r,a=w.useRef(null),s=w.useRef(0),o=w.useRef(null),l=a.current;return i&&n&&n.length&&l!==n?w.createElement(BZ,{props:r,clipPathId:e,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:o}):w.createElement(qm,{props:r,points:n,clipPathId:e,pathRef:o,showLabels:!0})}var WZ=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:Tr(t.payload,e)});class qZ extends w.Component{constructor(){super(...arguments),Eh(this,"id",il("recharts-line-"))}render(){var e,{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:h,id:m,needClip:p,layout:y}=this.props;if(r)return null;var b=Me("recharts-line",a),g=lt(m)?this.id:m,{r:_=3,strokeWidth:T=2}=(e=qe(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},E=gA(n),O=_*2+T;return w.createElement(w.Fragment,null,w.createElement(zi,{className:b},p&&w.createElement("defs",null,w.createElement($Y,{clipPathId:g,xAxisId:s,yAxisId:o}),!E&&w.createElement("clipPath",{id:"clipPath-dots-".concat(g)},w.createElement("rect",{x:c-O/2,y:l-O/2,width:u+O,height:h+O}))),w.createElement(HZ,{props:this.props,clipPathId:g}),w.createElement(MY,{direction:y==="horizontal"?"y":"x"},w.createElement(AY,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:WZ,errorBarOffset:0},this.props.children))),w.createElement(xY,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var Ak={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!kl.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function KZ(t){var e=Wa(t,Ak),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:o,dot:l,hide:c,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:y}=e,b=Ek(e,NZ),{needClip:g}=mk(p,y),{height:_,width:T,x:E,y:O}=My(),R=$g(),D=mr(),I=w.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),A=ie(P=>kZ(P,p,y,D,I));return R!=="horizontal"&&R!=="vertical"?null:w.createElement(qZ,Ds({},b,{connectNulls:o,dot:l,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:u,hide:c,label:h,legendType:m,xAxisId:p,yAxisId:y,points:A,layout:R,height:_,width:T,left:E,top:O,needClip:g}))}function GZ(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:o,displayedData:l}=t;return l.map((c,u)=>{var h=Tr(c,s);return e==="horizontal"?{x:wx({axis:r,ticks:i,bandSize:o,entry:c,index:u}),y:lt(h)?null:n.scale(h),value:h,payload:c}:{x:lt(h)?null:r.scale(h),y:wx({axis:n,ticks:a,bandSize:o,entry:c,index:u}),value:h,payload:c}})}class Ju extends w.PureComponent{render(){return w.createElement(SY,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},w.createElement(cY,{legendPayload:DZ(this.props)}),w.createElement(oY,{fn:MZ,args:this.props}),w.createElement(KZ,this.props))}}Eh(Ju,"displayName","Line");Eh(Ju,"defaultProps",Ak);function m_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function p_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?m_(Object(r),!0).forEach(function(n){YZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YZ(t,e,r){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZZ(t){var e=XZ(t,"string");return typeof e=="symbol"?e:e+""}function XZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QZ={xAxis:{},yAxis:{},zAxis:{}},Ik=Ur({name:"cartesianAxis",initialState:QZ,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=p_(p_({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:JZ,removeXAxis:eX,addYAxis:tX,removeYAxis:rX,addZAxis:gee,removeZAxis:yee,updateYAxisWidth:nX}=Ik.actions,iX=Ik.reducer,aX=["children"],sX=["dangerouslySetInnerHTML","ticks"];function Sk(t,e,r){return(e=oX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Km(){return Km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Km.apply(null,arguments)}function Pk(t,e){if(t==null)return{};var r,n,i=cX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function cX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function uX(t){var e=sr(),r=w.useMemo(()=>{var{children:a}=t,s=Pk(t,aX);return s},[t]),n=ie(a=>oi(a,r.id)),i=r===n;return w.useEffect(()=>(e(JZ(r)),()=>{e(eX(r))}),[r,e]),i?t.children:null}var dX=t=>{var{xAxisId:e,className:r}=t,n=ie(AI),i=mr(),a="xAxis",s=ie(p=>Ks(p,a,e,i)),o=ie(p=>xP(p,a,e,i)),l=ie(p=>m7(p,e)),c=ie(p=>b7(p,e));if(l==null||c==null)return null;var{dangerouslySetInnerHTML:u,ticks:h}=t,m=Pk(t,sX);return w.createElement(Yi,Km({},m,{scale:s,x:c.x,y:c.y,width:l.width,height:l.height,className:Me("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},hX=t=>{var e,r,n,i,a;return w.createElement(uX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter},w.createElement(dX,t))};class ed extends w.Component{render(){return w.createElement(hX,this.props)}}Sk(ed,"displayName","XAxis");Sk(ed,"defaultProps",{allowDataOverflow:yr.allowDataOverflow,allowDecimals:yr.allowDecimals,allowDuplicatedCategory:yr.allowDuplicatedCategory,height:yr.height,hide:!1,mirror:yr.mirror,orientation:yr.orientation,padding:yr.padding,reversed:yr.reversed,scale:yr.scale,tickCount:yr.tickCount,type:yr.type,xAxisId:0});var fX=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,s=0;if(e){e.forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,l=i+a,c=s+l+o+(r?n:0);return Math.round(c)}return 0},mX=["dangerouslySetInnerHTML","ticks"];function kk(t,e,r){return(e=pX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pX(t){var e=gX(t,"string");return typeof e=="symbol"?e:e+""}function gX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gm(){return Gm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gm.apply(null,arguments)}function yX(t,e){if(t==null)return{};var r,n,i=vX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function bX(t){var e=sr();return w.useEffect(()=>(e(tX(t)),()=>{e(rX(t))}),[t,e]),null}var xX=t=>{var e,{yAxisId:r,className:n,width:i,label:a}=t,s=w.useRef(null),o=w.useRef(null),l=ie(AI),c=mr(),u=sr(),h="yAxis",m=ie(E=>Ks(E,h,r,c)),p=ie(E=>w7(E,r)),y=ie(E=>x7(E,r)),b=ie(E=>xP(E,h,r,c));if(w.useLayoutEffect(()=>{var E;if(!(i!=="auto"||!p||Dy(a)||w.isValidElement(a))){var O=s.current,R=O==null||(E=O.tickRefs)===null||E===void 0?void 0:E.current,{tickSize:D,tickMargin:I}=O.props,A=fX({ticks:R,label:o.current,labelGapWithTick:5,tickSize:D,tickMargin:I});Math.round(p.width)!==Math.round(A)&&u(nX({id:r,width:A}))}},[s,s==null||(e=s.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p?.width,p,u,a,r,i]),p==null||y==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=t,T=yX(t,mX);return w.createElement(Yi,Gm({},T,{ref:s,labelRef:o,scale:m,x:y.x,y:y.y,width:p.width,height:p.height,className:Me("recharts-".concat(h," ").concat(h),n),viewBox:l,ticks:b}))},wX=t=>{var e,r,n,i,a;return w.createElement(w.Fragment,null,w.createElement(bX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter}),w.createElement(xX,t))},_X={allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,hide:!1,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tickCount:vr.tickCount,type:vr.type,width:vr.width,yAxisId:0};class td extends w.Component{render(){return w.createElement(wX,this.props)}}kk(td,"displayName","YAxis");kk(td,"defaultProps",_X);var EX={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vl=w;function TX(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var AX=typeof Object.is=="function"?Object.is:TX,IX=Vl.useSyncExternalStore,SX=Vl.useRef,PX=Vl.useEffect,kX=Vl.useMemo,CX=Vl.useDebugValue;EX.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=SX(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=kX(function(){function l(p){if(!c){if(c=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var y=s.value;if(i(y,p))return h=y}return h=p}if(y=h,AX(u,p))return y;var b=n(p);return i!==void 0&&i(y,b)?(u=p,y):(u=p,h=b)}var c=!1,u,h,m=r===void 0?null:r;return[function(){return l(e())},m===null?void 0:function(){return l(m())}]},[e,r,n,i]);var o=IX(t,a[0],a[1]);return PX(function(){s.hasValue=!0,s.value=o},[o]),CX(o),o};function NX(t){t()}function jX(){let t=null,e=null;return{clear(){t=null,e=null},notify(){NX(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var g_={notify(){},get:()=>[]};function OX(t,e){let r,n=g_,i=0,a=!1;function s(b){u();const g=n.subscribe(b);let _=!1;return()=>{_||(_=!0,g(),h())}}function o(){n.notify()}function l(){y.onStateChange&&y.onStateChange()}function c(){return a}function u(){i++,r||(r=t.subscribe(l),n=jX())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=g_)}function m(){a||(a=!0,u())}function p(){a&&(a=!1,h())}const y={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return y}var RX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",DX=RX(),MX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",LX=MX(),$X=()=>DX||LX?w.useLayoutEffect:w.useEffect,VX=$X(),_f=Symbol.for("react-redux-context"),Ef=typeof globalThis<"u"?globalThis:{};function FX(){if(!w.createContext)return{};const t=Ef[_f]??(Ef[_f]=new Map);let e=t.get(w.createContext);return e||(e=w.createContext(null),t.set(w.createContext,e)),e}var zX=FX();function UX(t){const{children:e,context:r,serverState:n,store:i}=t,a=w.useMemo(()=>{const l=OX(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),s=w.useMemo(()=>i.getState(),[i]);VX(()=>{const{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,s]);const o=r||zX;return w.createElement(o.Provider,{value:a},e)}var BX=UX,HX=(t,e)=>e,Fy=V([HX,et,Cq,jt,DP,li,TK,Wt],kK),zy=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},Ck=Vr("mouseClick"),Nk=Pl();Nk.startListening({actionCreator:Ck,effect:(t,e)=>{var r=t.payload,n=Fy(e.getState(),zy(r));n?.activeIndex!=null&&e.dispatch(O7({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Ym=Vr("mouseMove"),jk=Pl();jk.startListening({actionCreator:Ym,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ay(n,n.tooltip.settings.shared),a=Fy(n,zy(r));i==="axis"&&(a?.activeIndex!=null?e.dispatch(PP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(SP()))}});function WX(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var y_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Ok=Ur({name:"rootProps",initialState:y_,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:y_.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),qX=Ok.reducer,{updateOptions:KX}=Ok.actions,Rk=Ur({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:vee}=Rk.actions,GX=Rk.reducer,Dk=Vr("keyDown"),Mk=Vr("focus"),Uy=Pl();Uy.startListening({actionCreator:Dk,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Iy(i,Za(r))),o=li(r);if(a==="Enter"){var l=Yu(r,"axis","hover",String(i.index));e.dispatch(Vm({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:l}));return}var c=A7(r),u=c==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,m=s+h*u;if(!(o==null||m>=o.length||m<0)){var p=Yu(r,"axis","hover",String(m));e.dispatch(Vm({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});Uy.startListening({actionCreator:Mk,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=Yu(r,"axis","hover",String(a));e.dispatch(Vm({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Nr=Vr("externalEvent"),Lk=Pl();Lk.startListening({actionCreator:Nr,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:mK(r),activeDataKey:hK(r),activeIndex:dl(r),activeLabel:$P(r),activeTooltipIndex:dl(r),isTooltipActive:pK(r)};t.payload.handler(n,t.payload.reactEvent)}}});var YX=V([Gs],t=>t.tooltipItemPayloads),ZX=V([YX,$l,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=e(a,r);return s}}}),$k=Vr("touchMove"),Vk=Pl();Vk.startListening({actionCreator:$k,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ay(n,n.tooltip.settings.shared);if(i==="axis"){var a=Fy(n,zy({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&e.dispatch(PP({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(dB),u=(s=l.getAttribute(hB))!==null&&s!==void 0?s:void 0,h=ZX(e.getState(),c,u);e.dispatch(j7({activeDataKey:u,activeIndex:c,activeCoordinate:h}))}}});var XX=aI({brush:FY,cartesianAxis:iX,chartData:WK,graphicalItems:rY,layout:M9,legend:EB,options:FK,polarAxis:XG,polarOptions:GX,referenceElements:KY,rootProps:qX,tooltip:R7}),QX=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return o9({reducer:XX,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([Nk.middleware,jk.middleware,Uy.middleware,Lk.middleware,Vk.middleware]),devTools:{serialize:{replacer:WX},name:"recharts-".concat(r)}})};function JX(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=mr(),a=w.useRef(null);if(i)return r;a.current==null&&(a.current=QX(e,n));var s=kg;return w.createElement(BX,{context:s,store:a.current},r)}function eQ(t){var{layout:e,width:r,height:n,margin:i}=t,a=sr(),s=mr();return w.useEffect(()=>{s||(a(O9(e)),a(R9({width:r,height:n})),a(j9(i)))},[a,s,e,r,n,i]),null}function tQ(t){var e=sr();return w.useEffect(()=>{e(KX(t))},[e,t]),null}var rQ=["children"];function nQ(t,e){if(t==null)return{};var r,n,i=iQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function iQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function rd(){return rd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},rd.apply(null,arguments)}var aQ={width:"100%",height:"100%"},sQ=w.forwardRef((t,e)=>{var r=SI(),n=PI(),i=CI();if(!Ou(r)||!Ou(n))return null;var{children:a,otherAttributes:s,title:o,desc:l}=t,c,u;return typeof s.tabIndex=="number"?c=s.tabIndex:c=i?0:void 0,typeof s.role=="string"?u=s.role:u=i?"application":void 0,w.createElement(yA,rd({},s,{title:o,desc:l,role:u,tabIndex:c,width:r,height:n,style:aQ,ref:e}),a)}),oQ=t=>{var{children:e}=t,r=ie(ih);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return w.createElement(yA,{width:n,height:i,x:s,y:a},e)},v_=w.forwardRef((t,e)=>{var{children:r}=t,n=nQ(t,rQ),i=mr();return i?w.createElement(oQ,null,r):w.createElement(sQ,rd({ref:e},n),r)});function lQ(){var t=sr(),[e,r]=w.useState(null),n=ie(uB);return w.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;tn(a)&&a!==n&&t(D9(a))}},[e,t,n]),r}function b_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function cQ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?b_(Object(r),!0).forEach(function(n){uQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function uQ(t,e,r){return(e=dQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dQ(t){var e=hQ(t,"string");return typeof e=="symbol"?e:e+""}function hQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fQ=w.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:y,onTouchStart:b,style:g,width:_}=t,T=sr(),[E,O]=w.useState(null),[R,D]=w.useState(null);GK();var I=lQ(),A=w.useCallback(q=>{I(q),typeof e=="function"&&e(q),O(q),D(q)},[I,e,O,D]),P=w.useCallback(q=>{T(Ck(q)),T(Nr({handler:a,reactEvent:q}))},[T,a]),j=w.useCallback(q=>{T(Ym(q)),T(Nr({handler:c,reactEvent:q}))},[T,c]),N=w.useCallback(q=>{T(SP()),T(Nr({handler:u,reactEvent:q}))},[T,u]),k=w.useCallback(q=>{T(Ym(q)),T(Nr({handler:h,reactEvent:q}))},[T,h]),C=w.useCallback(()=>{T(Mk())},[T]),Q=w.useCallback(q=>{T(Dk(q.key))},[T]),oe=w.useCallback(q=>{T(Nr({handler:s,reactEvent:q}))},[T,s]),X=w.useCallback(q=>{T(Nr({handler:o,reactEvent:q}))},[T,o]),ee=w.useCallback(q=>{T(Nr({handler:l,reactEvent:q}))},[T,l]),he=w.useCallback(q=>{T(Nr({handler:m,reactEvent:q}))},[T,m]),ye=w.useCallback(q=>{T(Nr({handler:b,reactEvent:q}))},[T,b]),ze=w.useCallback(q=>{T($k(q)),T(Nr({handler:y,reactEvent:q}))},[T,y]),se=w.useCallback(q=>{T(Nr({handler:p,reactEvent:q}))},[T,p]);return w.createElement(HP.Provider,{value:E},w.createElement(Uz.Provider,{value:R},w.createElement("div",{className:Me("recharts-wrapper",n),style:cQ({position:"relative",cursor:"default",width:_,height:i},g),onClick:P,onContextMenu:oe,onDoubleClick:X,onFocus:C,onKeyDown:Q,onMouseDown:ee,onMouseEnter:j,onMouseLeave:N,onMouseMove:k,onMouseUp:he,onTouchEnd:se,onTouchMove:ze,onTouchStart:ye,ref:A},r)))}),mQ=["children","className","width","height","style","compact","title","desc"];function pQ(t,e){if(t==null)return{};var r,n,i=gQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function gQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var yQ=w.forwardRef((t,e)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:l,desc:c}=t,u=pQ(t,mQ),h=qe(u,!1);return o?w.createElement(v_,{otherAttributes:h,title:l,desc:c},r):w.createElement(fQ,{className:n,style:s,width:i,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},w.createElement(v_,{otherAttributes:h,title:l,desc:c,ref:e},w.createElement(YY,null,r)))}),vQ=["width","height"];function Zm(){return Zm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zm.apply(null,arguments)}function bQ(t,e){if(t==null)return{};var r,n,i=xQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function xQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var wQ={top:5,right:5,bottom:5,left:5},_Q={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:wQ,reverseStackOrder:!1,syncMethod:"index"},EQ=w.forwardRef(function(e,r){var n,i=Wa(e.categoricalChartProps,_Q),{width:a,height:s}=i,o=bQ(i,vQ);if(!Ou(a)||!Ou(s))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,categoricalChartProps:m}=e,p={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return w.createElement(JX,{preloadedState:{options:p},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:l},w.createElement(VY,{chartData:m.data}),w.createElement(eQ,{width:a,height:s,layout:i.layout,margin:i.margin}),w.createElement(tQ,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),w.createElement(yQ,Zm({},o,{width:a,height:s,ref:r})))}),TQ=["axis"],x_=w.forwardRef((t,e)=>w.createElement(EQ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:TQ,tooltipPayloadSearcher:$K,categoricalChartProps:t,ref:e}));function AQ(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})}function IQ(t){const e=typeof t=="string"?new Date(t):t;return e.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})+" "+e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}const SQ=({images:t})=>{const[e,r]=w.useState(!1),n=t.map(s=>{let o;const l={excellent:95,good:80,fair:60,poor:30};return s.healthAnalysis?.overallHealth&&l[s.healthAnalysis.overallHealth]?o=l[s.healthAnalysis.overallHealth]:typeof s.healthAnalysis?.confidence=="number"&&(o=s.healthAnalysis.confidence<=1?s.healthAnalysis.confidence*100:s.healthAnalysis.confidence),{id:s.id,date:AQ(s.timestamp),dateTime:IQ(s.timestamp),rawDate:s.timestamp,score:typeof o=="number"?o:null,url:s.url}}).sort((s,o)=>new Date(s.rawDate).getTime()-new Date(o.rawDate).getTime()),i=n.map(s=>({dateTime:s.dateTime,score:s.score})),a=s=>{const{key:o,cx:l,cy:c}=s;return d.jsx("circle",{cx:l,cy:c,r:4,stroke:"#2A7F3E",strokeWidth:2,fill:"#fff"},o)};return d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-base font-semibold text-[#2A7F3E]",children:"Evolución de Salud"}),d.jsx(me,{size:"sm",variant:"outline",onClick:()=>r(!0),children:"Ampliar"})]}),d.jsx("div",{className:"w-full h-48",children:d.jsx(Bw,{width:"100%",height:"100%",children:d.jsxs(x_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(Wm,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(ed,{dataKey:"dateTime",tick:{fontSize:12,fill:"#888"}}),d.jsx(td,{domain:[0,100],tick:{fontSize:12,fill:"#888"},width:32}),d.jsx(zw,{contentStyle:{fontSize:13,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(Ju,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:6},connectNulls:!1})]})})}),d.jsx("div",{className:"mt-4 overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-10 h-10 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})}),d.jsx(ke,{children:e&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-2",onClick:()=>r(!1),children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto p-6 relative",onClick:s=>s.stopPropagation(),children:[d.jsx(me,{size:"icon-sm",variant:"ghost",className:"absolute top-2 right-2",onClick:()=>r(!1),children:"×"}),d.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#2A7F3E]",children:"Evolución de Salud (Ampliado)"}),d.jsx("div",{className:"w-full h-72 mb-6",children:d.jsx(Bw,{width:"100%",height:"100%",children:d.jsxs(x_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(Wm,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(ed,{dataKey:"dateTime",tick:{fontSize:13,fill:"#888"}}),d.jsx(td,{domain:[0,100],tick:{fontSize:13,fill:"#888"},width:36}),d.jsx(zw,{contentStyle:{fontSize:14,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(Ju,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:7},connectNulls:!1})]})})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-12 h-12 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})})]})})})]})},PQ=({plant:t,onAddPhoto:e})=>{const r=w.useMemo(()=>{if(!t.images||t.images.length===0)return[];const a=[...t.images].sort((u,h)=>new Date(u.timestamp).getTime()-new Date(h.timestamp).getTime()),s=[],o=30*24*60*60*1e3;let l=new Date(a[0].timestamp),c=[];return a.forEach((u,h)=>{const m=new Date(u.timestamp);if(m.getTime()-l.getTime()<=o)c.push(u);else{if(c.length>0){const p=c.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),y=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...c],startDate:new Date(c[0].timestamp),endDate:new Date(c[c.length-1].timestamp),avgHealthScore:y,trend:s.length>0?y>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:c.length})}l=m,c=[u]}if(h===a.length-1&&c.length>0){const p=c.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),y=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...c],startDate:new Date(c[0].timestamp),endDate:new Date(c[c.length-1].timestamp),avgHealthScore:y,trend:s.length>0?y>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:c.length})}}),s},[t.images]);function n(a){if(a.length<2)return null;const s=a[a.length-1]-a[0];return s>5?{icon:"⬆️",label:"Mejorando",color:"text-green-600 bg-green-50"}:s<-5?{icon:"⬇️",label:"Declive",color:"text-red-600 bg-red-50"}:{icon:"➡️",label:"Estable",color:"text-gray-600 bg-gray-50"}}if(r.length===0)return d.jsxs(Sr,{className:"mt-6",children:[d.jsx(jd,{children:d.jsxs(dg,{className:"flex items-center",children:[d.jsx(NC,{className:"w-5 h-5 mr-2 text-primary"}),"Evolución de tu Planta"]})}),d.jsx(Jn,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx(_n,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"¡Comienza a documentar la evolución!"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:"Agrega más fotos a lo largo del tiempo para ver cómo progresa tu planta."}),d.jsxs(me,{onClick:e,className:"gap-2",children:[d.jsx(rp,{className:"w-4 h-4"}),"Agregar Primera Foto"]})]})})]});const i=r.map(a=>a.avgHealthScore??0);return n(i),d.jsx(Sr,{className:"mt-6",children:d.jsx(Jn,{className:"mt-4 space-y-6",children:d.jsx(SQ,{images:t.images||[]})})})},kQ=({isOpen:t,onClose:e,onPhotoAdded:r,plantName:n})=>{const[i,a]=w.useState("choose"),[s,o]=w.useState(null),[l,c]=w.useState(""),[u,h]=w.useState(null),[m,p]=w.useState(!1),y=w.useRef(null),{addToast:b}=zs(),g=w.useCallback(()=>{a("choose"),o(null),c(""),h(null),p(!1)},[]),_=w.useCallback(()=>{g(),e()},[g,e]),T=w.useCallback(C=>{const Q=new FileReader;Q.onload=oe=>{const X=oe.target?.result;o(X),a("preview")},Q.readAsDataURL(C)},[]),E=w.useCallback(()=>{y.current&&y.current.click()},[]),O=w.useCallback(()=>{E()},[E]),R=w.useCallback(C=>{const Q=C.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){h("Por favor selecciona un archivo de imagen válido.");return}if(Q.size>5*1024*1024){h("La imagen es demasiado grande. Máximo 5MB.");return}T(Q)}},[T]),D=w.useCallback(async()=>{if(s)try{a("uploading"),p(!0),await r(s,l.trim()||void 0),a("success"),p(!1),b({type:"success",title:"Foto agregada exitosamente",message:`Nueva imagen añadida a ${n}`}),setTimeout(()=>{_()},1500)}catch(C){h(C instanceof Error?C.message:"Error al subir la imagen"),a("error"),p(!1)}},[s,l,r,n,b,_]),I=()=>(console.log("[AddPhotoModal] Renderizando botón Tomar Foto"),console.log("[AddPhotoModal] Renderizando botón Elegir de Galería"),d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[d.jsxs("div",{children:[d.jsx(_n,{className:"w-16 h-16 text-primary mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Agregar Nueva Foto"}),d.jsxs("p",{className:"text-muted-foreground",children:["Documenta el progreso de ",d.jsx("span",{className:"font-medium",children:n})]})]}),d.jsxs("div",{className:"grid gap-4",children:[d.jsxs(me,{variant:"primary",size:"lg",onClick:O,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(_n,{className:"w-6 h-6"}),"Tomar Foto"]}),d.jsxs(me,{variant:"secondary",size:"lg",onClick:E,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(N_,{className:"w-6 h-6"}),"Elegir de Galería"]})]}),d.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:R,className:"hidden","data-testid":"file-input"})]})),A=()=>d.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Vista Previa"}),d.jsxs("p",{className:"text-muted-foreground",children:["Revisa la imagen antes de agregar a ",n]})]}),s&&d.jsxs("div",{className:"space-y-4 pb-8 sm:pb-0",children:[d.jsx("div",{className:"aspect-video max-h-80 mx-auto rounded-lg overflow-hidden border",children:d.jsx("img",{src:s,alt:"Vista previa",className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium",children:"Nota (opcional)"}),d.jsx("textarea",{value:l,onChange:C=>c(C.target.value),placeholder:"Agrega una nota sobre esta foto...",className:"w-full p-3 border border-neutral-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:200}),d.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[l.length,"/200"]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),className:"flex-1",children:"Cambiar Imagen"}),d.jsxs(me,{variant:"primary",onClick:D,className:"flex-1 gap-2",children:[d.jsx(Bt,{className:"w-4 h-4"}),"Analizar y Guardar"]})]})]})]}),P=()=>d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center space-y-6 py-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx(ya,{className:"w-16 h-16 text-primary mx-auto animate-spin"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:m?"Analizando imagen...":"Subiendo foto..."}),d.jsx("p",{className:"text-muted-foreground",children:m?"La IA está evaluando la salud de tu planta":"Guardando la nueva imagen en tu jardín"})]})]}),d.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:d.jsx("div",{className:"bg-primary h-2 rounded-full animate-pulse",style:{width:"70%"}})})]}),j=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Un,{className:"w-16 h-16 text-success-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"¡Foto agregada!"}),d.jsxs("p",{className:"text-muted-foreground",children:["La nueva imagen ha sido añadida al progreso de ",n]})]})]}),N=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Lr,{className:"w-16 h-16 text-error-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al subir"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:u||"Hubo un problema al procesar la imagen"}),d.jsxs("div",{className:"flex gap-3 justify-center",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),children:"Intentar de Nuevo"}),d.jsx(me,{variant:"primary",onClick:_,children:"Cerrar"})]})]})]}),k=()=>{switch(i){case"choose":return I();case"preview":return A();case"uploading":return P();case"success":return j();case"error":return N();default:return I()}};return d.jsx(ke,{children:t&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:C=>{C.target===C.currentTarget&&i!=="uploading"&&_()},children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md",children:d.jsx(Sr,{children:d.jsxs(Jn,{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(np,{className:"w-5 h-5 text-primary"}),d.jsx("span",{className:"font-medium text-sm text-muted-foreground",children:"NUEVA FOTO"})]}),i!=="uploading"&&d.jsx(me,{variant:"ghost",size:"icon-sm",onClick:_,children:d.jsx(ni,{className:"w-4 h-4"})})]}),k()]})})})})})},CQ=({plant:t})=>{const{careProfile:e,healthScore:r,lastWatered:n,dateAdded:i}=t,a=t.images?.[0]?.healthAnalysis,s=n?Math.floor((Date.now()-new Date(n).getTime())/(1e3*60*60*24)):null,o=Math.floor((Date.now()-new Date(i).getTime())/(1e3*60*60*24)),c=r>=85?{text:"Excelente",color:"text-green-500",icon:Un,emoji:"🌟"}:r>=70?{text:"Buena",color:"text-green-400",icon:Un,emoji:"✅"}:r>=50?{text:"Regular",color:"text-yellow-500",icon:tp,emoji:"⚠️"}:{text:"Necesita atención",color:"text-red-500",icon:Jr,emoji:"🆘"},h=(()=>{if(!s||!e?.wateringFrequency)return{text:"Sin datos",color:"text-gray-500",urgent:!1};const y=s>=e.wateringFrequency;return s>e.wateringFrequency+2?{text:"Riego urgente",color:"text-red-500",urgent:!0}:y?{text:"Necesita riego",color:"text-yellow-500",urgent:!0}:{text:"Bien hidratada",color:"text-green-500",urgent:!1}})(),m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},p={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsx(L.div,{variants:m,initial:"hidden",animate:"visible",children:d.jsxs(Sr,{variant:"glass",className:"content-spacing-sm element-spacing",children:[t.description&&d.jsx("div",{className:"mb-4",children:d.jsx("p",{className:"text-base text-neutral-700 dark:text-neutral-200 leading-relaxed",children:t.description})}),d.jsx(L.div,{variants:p,className:"w-full mb-3",children:d.jsxs("div",{className:"w-full flex items-center justify-between bg-green-100 dark:bg-green-900/30 rounded-lg px-4 py-2 mb-2",children:[d.jsxs("span",{className:"flex items-center gap-2 text-green-700 text-base font-bold",children:[d.jsx(Un,{className:"w-5 h-5"}),r,"% ",c.text]}),d.jsxs("span",{className:"flex items-center gap-1 text-contrast-soft text-sm align-baseline",children:[d.jsx(Xc,{className:"w-4 h-4"}),"Día ",o]})]})}),d.jsxs(L.div,{variants:p,className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:je("flex items-center space-x-3 p-3 rounded-lg",h.urgent?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"),children:[d.jsx(id,{className:je("w-5 h-5",h.color)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Riego"}),d.jsx("p",{className:je("font-semibold text-sm",h.color),children:h.text}),s!==null&&d.jsxs("p",{className:"text-xs text-contrast-soft",children:["Hace ",s," día",s!==1?"s":""]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[d.jsx(Ii,{className:"w-5 h-5 text-blue-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Luz"}),d.jsx("p",{className:"font-semibold text-sm text-blue-600 dark:text-blue-400",children:e?.sunlightRequirement||"No especificado"}),t.lightRequirements&&d.jsx("p",{className:"text-xs text-contrast-soft capitalize",children:t.lightRequirements.replace("_"," ")})]})]}),t.plantEnvironment&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[d.jsx(L_,{className:"w-5 h-5 text-purple-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Ambiente"}),d.jsx("p",{className:"font-semibold text-sm text-purple-600 dark:text-purple-400 capitalize",children:t.plantEnvironment==="ambos"?"Interior/Exterior":t.plantEnvironment})]})]}),e?.temperatureRange&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[d.jsx($_,{className:"w-5 h-5 text-orange-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Temperatura"}),d.jsxs("p",{className:"font-semibold text-sm text-orange-600 dark:text-orange-400",children:[e.temperatureRange.min,"°-",e.temperatureRange.max,"°C"]})]})]})]}),a?.issues&&a.issues.length>0&&d.jsx(L.div,{variants:p,className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Jr,{className:"w-5 h-5 text-red-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-red-700 dark:text-red-300 text-sm mb-1",children:[a.issues.length," problema",a.issues.length!==1?"s":""," detectado",a.issues.length!==1?"s":""]}),d.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[a.issues[0].description,a.issues.length>1&&` y ${a.issues.length-1} más...`]})]})]})}),d.jsx("br",{}),t.personality?.communicationStyle&&d.jsx(L.div,{variants:p,className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Uo,{className:"w-5 h-5 text-green-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-green-700 dark:text-green-300 text-sm mb-1",children:["🤖 Personalidad: ",t.personality.communicationStyle]}),t.personality.catchphrases&&t.personality.catchphrases.length>0&&d.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 italic",children:['"',t.personality.catchphrases[0],'"']})]})]})})]})})},NQ=({plant:t,onAddPhoto:e})=>{const[r,n]=w.useState("evolution"),i=t.images?.[0]?.healthAnalysis,a=i?.issues&&i.issues.length>0,s=t.images&&t.images.length>1,o=[{id:"evolution",title:"Evolución y Progreso",icon:d.jsx(jC,{className:"w-5 h-5"}),badge:s?`${t.images?.length||0} fotos`:"Nueva",component:d.jsx(PQ,{plant:t,onAddPhoto:e}),priority:1},{id:"health",title:"Análisis de Salud",icon:d.jsx(OC,{className:"w-5 h-5"}),badge:a?"Atención":"Saludable",component:d.jsx(Az,{analysis:i}),priority:a?1:3},{id:"care",title:"Perfil de Cuidados",icon:d.jsx(RC,{className:"w-5 h-5"}),badge:t.careProfile?"Completo":"Pendiente",component:d.jsx(_z,{plant:t}),priority:t.careProfile?2:1},...t.funFacts&&t.funFacts.length>0?[{id:"funfacts",title:"Datos Curiosos",icon:d.jsx(Bt,{className:"w-5 h-5"}),component:d.jsx(Ez,{species:t.species,funFacts:t.funFacts}),priority:4}]:[]].filter(l=>l.id==="health"?!!i:!0).sort((l,c)=>l.priority-c.priority);return d.jsx("div",{className:"flex flex-col gap-y-1",children:o.map(l=>{const c=r===l.id,u=l.id==="health";return l.id==="care"?d.jsxs(Sr,{variant:"default",radius:"default",className:je("border border-[#E5E5E5] rounded-[8px] transition-all duration-200","bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(c?"":l.id),className:je("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none","bg-white","rounded-t-[8px]"),style:{position:c?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:l.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:l.title})]}),d.jsx(L.div,{animate:{rotate:c?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16,transition:"transform .2s"},children:d.jsx(Nv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:c&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[l.component,d.jsx("div",{style:{paddingBottom:8}})]})})})]},l.id):d.jsxs(Sr,{variant:"default",radius:"default",className:je("border border-[#E0E0E0] rounded-[8px] transition-all duration-200",c&&u?"bg-[#FAFAFA]":"bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(c?"":l.id),className:je("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none",c&&u?"bg-[#FAFAFA]":"bg-white","rounded-t-[8px]"),style:{position:c?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:l.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:l.title})]}),u&&d.jsx("span",{className:"ml-2 px-[6px] py-[2px] text-xs font-medium rounded-[4px] bg-[#E0F2E9] text-[#2A7F3E] align-middle",style:{lineHeight:"1.2"},children:l.badge}),d.jsx(L.div,{animate:{rotate:c?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16},children:d.jsx(Nv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:c&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[l.component,u&&d.jsx("div",{style:{paddingBottom:8}})]})})})]},l.id)})})},w_=()=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"relative h-96 w-full overflow-hidden bg-gradient-to-br from-muted/50 to-muted",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 via-background/20 to-transparent"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-8 w-64"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx(pe,{className:"h-8 w-24 rounded-full"}),d.jsx(pe,{className:"h-8 w-32 rounded-full"}),d.jsx(pe,{className:"h-8 w-20 rounded-full"})]})]})})]}),d.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-6 flex items-center",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-48"}),d.jsx(pe,{className:"h-4 w-64"})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx(pe,{className:"h-4 w-full"}),d.jsx(pe,{className:"h-4 w-5/6"}),d.jsx(pe,{className:"h-4 w-4/5"}),d.jsx(pe,{className:"h-4 w-3/4"})]}),d.jsxs("div",{className:"mt-8 space-y-4",children:[d.jsxs("div",{className:"flex items-center mb-4",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-32"}),d.jsx(pe,{className:"h-4 w-56"})]})]}),[1,2,3].map(t=>d.jsxs("div",{className:"flex items-start bg-muted/20 rounded-xl p-4",children:[d.jsx(pe,{className:"h-5 w-5 rounded-full mr-4 mt-1"}),d.jsx(pe,{className:"h-4 w-full"})]},t))]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-6",children:[d.jsx(pe,{className:"h-12 w-12 mx-auto mb-3"}),d.jsx(pe,{className:"h-6 w-32 mx-auto mb-2"}),d.jsx(pe,{className:"h-4 w-48 mx-auto"})]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-40"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>d.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[d.jsx(pe,{className:"h-8 w-8 mb-2"}),d.jsx(pe,{className:"h-4 w-16 mb-1"}),d.jsx(pe,{className:"h-5 w-24"})]},t))})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pe,{className:"h-5 w-5 mr-2"}),d.jsx(pe,{className:"h-6 w-32"})]}),d.jsx(pe,{className:"h-4 w-16"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4,5,6].map(t=>d.jsx(pe,{className:"aspect-square rounded-xl"},t))})]})]}),d.jsxs("div",{className:"fixed bottom-4 right-4 z-40 flex flex-col-reverse gap-3",children:[[1,2,3].map(t=>d.jsx(pe,{className:"h-14 w-14 rounded-full"},t)),d.jsx(pe,{className:"h-16 w-16 rounded-full"})]})]}),jQ=()=>{const{plantId:t}=Jm(),e=ar(),{plant:r,loading:n,error:i}=fg(t),{addPlantImage:a}=pz(),[s,o]=w.useState(!1),l=async(c,u)=>{if(!t)throw new Error("Plant ID is required");return new Promise((h,m)=>{a({plantId:t,imageDataUrl:c,note:u},{onSuccess:()=>h(),onError:p=>m(p)})})};return n?d.jsx(w_,{}):i?d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Lr,{className:"w-16 h-16 text-destructive mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Ocurrió un Error"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:i}),d.jsx(me,{onClick:()=>window.location.reload(),className:"mt-4",children:"Intentar de nuevo"})]})}):r?d.jsx(w.Suspense,{fallback:d.jsx(w_,{}),children:d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[d.jsx(wz,{plant:r}),d.jsxs("main",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.2},children:d.jsx(CQ,{plant:r})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15,duration:.2},children:d.jsx(NQ,{plant:r,onAddPhoto:()=>o(!0)})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.2},children:d.jsx(gz,{images:r.images})})]}),d.jsxs(L.div,{className:"fixed bottom-24 right-4 z-40 flex flex-col-reverse gap-3",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.25,duration:.2},children:[d.jsxs(L.button,{onClick:()=>o(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Agregar nueva foto",children:[d.jsx(_n,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Agregar foto"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Agregar foto"})]}),d.jsxs(L.button,{onClick:()=>e(At.toPlantChat(r.id)),className:"bg-blue-500 hover:bg-blue-600 text-white p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Chat con la planta",children:[d.jsx(pl,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Chat"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Chat"})]})]}),d.jsx(kQ,{isOpen:s,onClose:()=>o(!1),onPhotoAdded:l,plantName:r.nickname||r.name})]})}):d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Lr,{className:"w-16 h-16 text-muted-foreground mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold",children:"Planta no encontrada"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo encontrar la información de la planta solicitada."}),d.jsx(me,{onClick:()=>e(At.toDashboard()),className:"mt-4",children:"Volver al inicio"})]})})},OQ=({videoRef:t,canvasRef:e})=>{const[r,n]=w.useState(!1),[i,a]=w.useState(null),[s,o]=w.useState("environment"),[l,c]=w.useState(null),u=w.useRef(null),h=w.useCallback(async()=>{try{u.current&&u.current.getTracks().forEach(_=>_.stop()),c(null);const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:s,width:{ideal:1920},height:{ideal:1080},aspectRatio:16/9}});t.current&&(t.current.srcObject=g,u.current=g)}catch(g){console.error("Error accessing camera:",g),g instanceof Error?g.name==="NotAllowedError"||g.message.includes("Permission dismissed")?c("Permiso de cámara denegado. Por favor, actívalo en los ajustes de tu navegador."):c("No se pudo acceder a la cámara. Revisa los permisos y el dispositivo."):c("Ocurrió un error inesperado al acceder a la cámara.")}},[s,t]);w.useEffect(()=>(h(),()=>{u.current&&u.current.getTracks().forEach(g=>g.stop())}),[h]);const m=w.useCallback(()=>{if(!t.current||!e.current)return;const g=t.current,_=e.current,T=_.getContext("2d");if(!T)return;_.width=g.videoWidth,_.height=g.videoHeight,T.drawImage(g,0,0,g.videoWidth,g.videoHeight);const E=_.toDataURL("image/jpeg",.9);a(E),n(!0),u.current&&u.current.getTracks().forEach(O=>O.stop()),"vibrate"in navigator&&navigator.vibrate(50)},[t,e]),p=w.useCallback(()=>{a(null),n(!1),h()},[h]);return{isCapturing:r,capturedImage:i,cameraError:l,captureImage:m,retakePhoto:p,switchCamera:()=>{o(g=>g==="user"?"environment":"user")},startCamera:h,selectFromGallery:g=>{if(g&&g.type.startsWith("image/")){const _=new FileReader;_.onload=T=>{const E=T.target?.result;a(E),n(!0),u.current&&u.current.getTracks().forEach(O=>O.stop())},_.readAsDataURL(g)}}}},RQ=({error:t,onRetry:e})=>{const r=ar();return d.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center p-6",children:d.jsx("div",{className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full mx-4",children:d.jsxs("div",{className:"flex flex-col items-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:d.jsx(Lr,{size:32,className:"text-red-400"})}),d.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Camera Access Required"}),d.jsx("p",{className:"text-gray-300 text-sm mb-6 leading-relaxed",children:t}),d.jsxs("div",{className:"space-y-3 w-full",children:[d.jsxs(me,{onClick:e,children:[d.jsx(ji,{size:18,className:"mr-2"}),d.jsx("span",{children:"Try Again"})]}),d.jsx(me,{onClick:()=>r(At.toDashboard()),variant:"secondary",children:"Go Back"})]}),d.jsx("div",{className:"mt-4 p-3 bg-gray-800 rounded-lg",children:d.jsxs("p",{className:"text-gray-400 text-xs",children:[d.jsx("strong",{children:"How to enable camera:"}),d.jsx("br",{}),"1. Click the camera icon in your browser's address bar",d.jsx("br",{}),'2. Select "Allow" for camera access',d.jsx("br",{}),'3. Refresh the page or tap "Try Again"']})})]})})})},DQ=({image:t,isAnalyzing:e,onRetake:r,onAnalyze:n})=>d.jsxs(d.Fragment,{children:[d.jsx(L.img,{src:t,alt:"Captured plant",className:"absolute inset-0 w-full h-full object-cover z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[d.jsx(me,{onClick:r,variant:"secondary",disabled:e,children:"Retake"}),d.jsx(me,{onClick:n,disabled:e,children:e?d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Analyzing..."})]}):"Add Plant"})]}),e&&d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"AI is identifying your plant and creating a care profile..."})]})]}),MQ=({videoRef:t,canvasRef:e,flashEnabled:r,onCapture:n,onSwitchCamera:i,onToggleFlash:a,onSelectFromGallery:s})=>{const o=ar();return d.jsxs(d.Fragment,{children:[d.jsx(L.video,{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),d.jsx("canvas",{ref:e,className:"hidden"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 safe-area-top z-20",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(me,{onClick:()=>o(At.toDashboard()),variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(ni,{size:20})}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(me,{onClick:a,variant:"ghost",size:"icon",className:`rounded-full ${r?"bg-yellow-500 text-black hover:bg-yellow-600":"bg-black/50"}`,children:r?d.jsx(Bt,{size:20}):d.jsx(DC,{size:20})}),d.jsx(me,{onClick:i,variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(MC,{size:20})})]})]})}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[d.jsx(me,{onClick:s,size:"icon",variant:"ghost",className:"w-14 h-14 rounded-full bg-black/50",children:d.jsx(np,{size:24})}),d.jsx(L.button,{onClick:n,className:"w-20 h-20 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center ios-button",whileHover:{scale:1.05},whileTap:{scale:.95},children:d.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center",children:d.jsx(_n,{size:24,className:"text-gray-600"})})}),d.jsx("div",{className:"w-14 h-14"})]}),d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"Position your plant in the frame and tap to capture, or select from gallery"})]}),d.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:d.jsx("div",{className:"w-64 h-64 border-2 border-white/50 rounded-2xl"})})]})},LQ=()=>{const t=ar(),{createPlant:e,isCreatingPlant:r}=Nd(),n=w.useRef(null),i=w.useRef(null),{isCapturing:a,capturedImage:s,cameraError:o,captureImage:l,retakePhoto:c,switchCamera:u,startCamera:h,selectFromGallery:m}=OQ({videoRef:n,canvasRef:i}),[p,y]=w.useState(!1),b=w.useRef(null),g=()=>{if(!s)return;const E="Interior",O=new Promise((R,D)=>{e({imageDataUrl:s,location:E},{onSuccess:I=>{I?.id?t(At.toPlantDetail(I.id)):t(At.toDashboard()),R(I)},onError:I=>{D(I)}})});vT.promise(O,{loading:"Analizando imagen con IA...",success:R=>`¡Planta "${R.name}" creada con éxito!`,error:R=>`Error: ${R.message}`})},_=()=>y(E=>!E),T=E=>{const O=E.target.files?.[0];O&&m(O)};return d.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[d.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:T,className:"hidden",id:"gallery-input"}),d.jsx(ke,{mode:"wait",children:o?d.jsx(RQ,{error:o,onRetry:h},"error"):a?d.jsx(DQ,{image:s,isAnalyzing:r,onRetake:c,onAnalyze:g},"preview"):d.jsx(MQ,{videoRef:n,canvasRef:i,flashEnabled:p,onCapture:l,onSwitchCamera:u,onToggleFlash:_,onSelectFromGallery:()=>b.current?.click()},"capture")})]})},$Q=()=>{const{plantId:t}=Jm(),e=ar(),{user:r}=Cn(),n=qn(c=>c.getPlantById(t||"")),i=qn(c=>c.addChatMessage),a=qn(c=>c.isLoading),s=w.useMemo(()=>{if(!n||!n.chatHistory||n.chatHistory.length===0)return!1;const c=n.chatHistory[n.chatHistory.length-1];return a&&c.sender==="user"},[n,a]);return{plant:n,isTyping:s,handleSendMessage:async c=>{if(!(!t||!r||!c.trim()))try{await i(t,c.trim(),r.id)}catch(u){console.error("Failed to send message:",u)}},handleGoBack:()=>{e(`/plant/${t}`)},currentUser:r}},VQ=({plant:t})=>{const e=ar(),r=()=>{const n=t.healthScore/100,i=t.lastWatered?new Date(t.lastWatered).getTime():0,a=i?Math.max(0,1-(Date.now()-i)/(t.careProfile.wateringFrequency*24*60*60*1e3)):0,s=n*.6+a*.4;return s>.8?"radiante":s>.6?"feliz":s>.4?"estable":"necesitada de atención"};return d.jsx("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:d.jsxs("div",{className:"flex items-center gap-2 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>e(At.toPlantDetail(t.id)),className:"btn btn-ghost btn-circle",children:d.jsx(ip,{size:20})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h1",{className:"font-bold text-foreground truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 capitalize",children:["Se siente ",r()]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400",children:[d.jsx(k_,{className:"w-4 h-4"}),d.jsxs("span",{children:[t.healthScore,"%"]})]})]})})};var FQ={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},zQ=function(e,r,n){var i,a=FQ[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"en "+i:"hace "+i:i},UQ={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},BQ={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},HQ={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},WQ={date:bs({formats:UQ,defaultWidth:"full"}),time:bs({formats:BQ,defaultWidth:"full"}),dateTime:bs({formats:HQ,defaultWidth:"full"})},qQ={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},KQ={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},GQ=function(e,r,n,i){return r.getUTCHours()!==1?KQ[e]:qQ[e]},YQ={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},ZQ={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},XQ={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},QQ={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},JQ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},eJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},tJ=function(e,r){var n=Number(e);return n+"º"},rJ={ordinalNumber:tJ,era:cn({values:YQ,defaultWidth:"wide"}),quarter:cn({values:ZQ,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:cn({values:XQ,defaultWidth:"wide"}),day:cn({values:QQ,defaultWidth:"wide"}),dayPeriod:cn({values:JQ,defaultWidth:"wide",formattingValues:eJ,defaultFormattingWidth:"wide"})},nJ=/^(\d+)(º)?/i,iJ=/\d+/i,aJ={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},sJ={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},oJ={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},lJ={any:[/1/i,/2/i,/3/i,/4/i]},cJ={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},uJ={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},dJ={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},hJ={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},fJ={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},mJ={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},pJ={ordinalNumber:oA({matchPattern:nJ,parsePattern:iJ,valueCallback:function(e){return parseInt(e,10)}}),era:un({matchPatterns:aJ,defaultMatchWidth:"wide",parsePatterns:sJ,defaultParseWidth:"any"}),quarter:un({matchPatterns:oJ,defaultMatchWidth:"wide",parsePatterns:lJ,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:un({matchPatterns:cJ,defaultMatchWidth:"wide",parsePatterns:uJ,defaultParseWidth:"any"}),day:un({matchPatterns:dJ,defaultMatchWidth:"wide",parsePatterns:hJ,defaultParseWidth:"any"}),dayPeriod:un({matchPatterns:fJ,defaultMatchWidth:"any",parsePatterns:mJ,defaultParseWidth:"any"})},Fk={code:"es",formatDistance:zQ,formatLong:WQ,formatRelative:GQ,localize:rJ,match:pJ,options:{weekStartsOn:1,firstWeekContainsDate:1}};const gJ=t=>{switch(t){case"happy":case"excited":return"😊";case"grateful":return"🥰";case"worried":return"😟";case"sad":return"😢";default:return"🌱"}},yJ=({message:t})=>{const e=t.sender==="user",r=n=>{Sd.success("¡Gracias por tu feedback!",n?"Nos alegra que la respuesta te haya sido útil.":"Trabajaremos para mejorar las respuestas.")};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:je("flex items-end gap-2",e?"justify-end":"justify-start"),children:[!e&&d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:gJ(t.emotion)}),d.jsxs("div",{className:je("max-w-xs rounded-2xl px-4 py-2 sm:max-w-sm md:max-w-md shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm":"rounded-bl-lg bg-contrast-surface text-contrast-medium border border-contrast","rounded-[12px]"),children:[d.jsx("p",{className:"text-sm",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((n,i)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[n.type==="warning"&&"⚠️ ",n.type==="tip"&&"💡 ",n.type==="recommendation"&&"🌱 ",n.type==="observation"&&"🔎 ",n.title]}),d.jsx("div",{children:n.description}),n.affectedPlants&&n.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",n.affectedPlants.join(", ")]})]},i))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((n,i)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:n.action}),n.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",n.priority]}),n.plantIds&&n.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",n.plantIds.join(", ")]})]},i))})]}),d.jsx("p",{className:je("mt-1 text-xs",e?"text-white/80":"text-contrast-soft","text-[#888] text-[12px]"),children:cA(new Date(t.timestamp),{addSuffix:!0,locale:Fk})}),!e&&d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{"aria-label":"Respuesta útil",className:"text-green-600 hover:text-green-800 text-lg focus:outline-none",onClick:()=>r(!0),children:"👍"}),d.jsx("button",{"aria-label":"Respuesta no útil",className:"text-red-500 hover:text-red-700 text-lg focus:outline-none",onClick:()=>r(!1),children:"👎"})]})]})]})},vJ=({messages:t})=>d.jsx("div",{className:"space-y-4",children:t.map(e=>d.jsx(yJ,{message:e},e.id))}),bJ=["¿Cómo te sientes hoy?","¿Necesitas agua?","Cuéntame un dato curioso sobre ti"],xJ=({onSendMessage:t,isTyping:e})=>{const[r,n]=w.useState(""),i=w.useRef(null),a=()=>{const o=i.current?.value.trim();o&&(t(o),i.current&&(i.current.value=""))},s=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a())};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Od,{type:"text",ref:i,onKeyDown:s,placeholder:"Escribe un mensaje...",className:"pr-12",disabled:e}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(F_,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:a,disabled:!r.trim()||e,size:"icon",children:d.jsx(z_,{size:20})})]}),d.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:bJ.map(o=>d.jsx(me,{onClick:()=>n(o),disabled:e,variant:"secondary",size:"sm",children:o},o))})]})})},zk=()=>{const t={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:"🌱"}),d.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})},wJ=({plantName:t})=>d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center text-center p-8",children:[d.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-primary/10 mb-4",children:d.jsx(Bt,{className:"h-8 w-8 text-primary"})}),d.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Inicia una conversación"}),d.jsxs("p",{className:"text-muted-foreground max-w-xs",children:[t," está esperando para charlar. ¡Pregúntale sobre sus cuidados o simplemente saluda!"]})]}),_J=()=>{const{plantId:t}=Jm(),e=ar(),{loading:r,error:n}=fg(t),{plant:i,isTyping:a,handleSendMessage:s}=$Q(),o=w.useRef(null);return w.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[i?.chatHistory,a]),r?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(ya,{className:"w-12 h-12 animate-spin text-green-500"}),d.jsx("p",{className:"mt-4 text-lg",children:"Cargando chat..."})]}):n?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-red-500",children:[d.jsxs("p",{className:"mb-4",children:["Error: ",n]}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]}):i?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(VQ,{plant:i}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(ke,{children:i.chatHistory.length===0?d.jsx(wJ,{plantName:i.nickname||i.name}):d.jsx(vJ,{messages:i.chatHistory,plantNickname:i.nickname||i.name})}),a&&d.jsx(zk,{}),d.jsx("div",{ref:o})]}),d.jsx(xJ,{onSendMessage:s,isTyping:a})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx("p",{className:"mb-4",children:"Planta no encontrada."}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]})};class EJ{constructor(e,r){qr(this,"supabase");qr(this,"cache");this.supabase=e,this.cache=r}async sendMessage(e,r,n){try{const{data:{session:i},error:a}=await this.supabase.auth.getSession();if(a||!i?.access_token)throw console.error("User session not available:",a),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:s,error:o}=await this.supabase.functions.invoke("garden-ai-chat",{body:{message:e,sessionId:r,userId:n},headers:{Authorization:`Bearer ${i.access_token}`}});if(o)throw new Error(`Garden AI service error: ${o.message}`);if(!s)throw new Error("No data received from garden AI service");return s}catch(i){throw console.error("Error in garden chat service:",i),i}}async sendMessageToGardenAI(e,r,n){try{const i=await this.buildGardenContext(r),a=n.map(y=>({role:y.sender==="user"?"user":"assistant",content:y.content})),s="amigable, motivador, experto, cálido, y con un toque de humor ligero",{data:{session:o},error:l}=await this.supabase.auth.getSession();if(l||!o?.access_token)throw console.error("User session not available:",l),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:c,error:u}=await this.supabase.functions.invoke("garden-ai-chat",{body:{userMessage:e,gardenContext:i,conversationHistory:a,tonePersona:s},headers:{Authorization:`Bearer ${o.access_token}`}});if(u)throw new Error(`Garden AI service error: ${u.message}`);if(!c)throw new Error("No data received from garden AI service");const h=typeof c=="string"?JSON.parse(c):c,m=(h.content||"").toLowerCase();return(!h.content||m.includes("no sé")||m.includes("no tengo información")||m.includes("no puedo ayudarte")||m.length<30)&&Sd.warning("Respuesta genérica","La respuesta de la IA fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{content:h.content||"Lo siento, no pude procesar tu mensaje.",insights:h.insights||[],suggestedActions:h.suggestedActions||[]}}catch(i){throw i}}async verifyFunctionAvailability(){try{const e={userMessage:"ping",gardenContext:{totalPlants:0,plantsData:[],averageHealthScore:0,commonIssues:[],careScheduleSummary:{needsWatering:[],needsFertilizing:[],healthConcerns:[]},environmentalFactors:{locations:["test"]}},conversationHistory:[]},{data:{session:r},error:n}=await this.supabase.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await this.supabase.functions.invoke("garden-ai-chat",{body:e,headers:{Authorization:`Bearer ${r.access_token}`}});return a?a.message.includes("404")||a.message.includes("not found")?{available:!1,error:"La función de chat de jardín no está disponible en este momento"}:{available:!1,error:a.message}:i&&typeof i.content=="string"?{available:!0}:{available:!1,error:"Function returned unexpected response format"}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Error desconocido"}}}async getGardenHealthSummary(e){try{const r=this.cache.getGardenSummary(e);if(r)return r;const n=await this.buildGardenContext(e),i=n.plantsData.filter(o=>o.healthScore>=80).length,a=n.careScheduleSummary.needsWatering.length+n.careScheduleSummary.healthConcerns.length,s={totalPlants:n.totalPlants,averageHealth:n.averageHealthScore,urgentActions:a,healthyPlants:i};return this.cache.setGardenSummary(e,s),s}catch(r){throw console.error("Error getting garden health summary:",r),r}}async getSuggestedQuestions(e){try{const r=await this.buildGardenContext(e),n=[];return r.totalPlants===0?(n.push("¿Cómo agrego mi primera planta?"),n.push("¿Qué tipo de planta me recomiendas para empezar?"),n):(n.push("¿Cuántas plantas tengo y cómo están?"),n.push("¿Cuál es la salud promedio de mi jardín?"),r.careScheduleSummary.healthConcerns.length>0&&(n.push("¿Qué plantas necesitan atención especial?"),n.push("¿Qué problemas de salud hay en mi jardín?")),r.plantsData.some(i=>i.healthScore>=80)&&n.push("¿Cuáles de mis plantas están más sanas?"),r.environmentalFactors.locations.length>1&&n.push("¿Cómo afecta la ubicación a mis plantas?"),r.totalPlants>5&&n.push("¿Cómo organizar mejor mi espacio de plantas?"),r.plantsData.some(i=>"lastFertilized"in i&&!!i.lastFertilized)&&n.push("¿Cuándo debo fertilizar mis plantas?"),new Set(r.plantsData.map(i=>i.species)).size>1&&n.push("¿Qué especie de planta es la más resistente en mi jardín?"),n.slice(0,6))}catch(r){return console.error("Error getting suggested questions:",r),["¿Cuántas plantas tengo y cómo están?","¿Cuál es la salud promedio de mi jardín?"]}}async refreshGardenData(e){try{this.invalidateCache(e),await this.buildGardenContext(e),console.log("[GardenChatService] Garden data refreshed for user:",e)}catch(r){throw console.error("Error refreshing garden data:",r),r}}async buildGardenContext(e){try{const r=this.cache.getGardenContext(e);if(r)return r;const{data:n,error:i}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          last_fertilized,
          care_profile,
          date_added
        `).eq("user_id",e).order("created_at",{ascending:!1});if(i)throw i;const a=n.map(y=>({id:y.id,name:y.name,nickname:y.nickname||void 0,species:y.species,location:y.location,plantEnvironment:y.plant_environment,lightRequirements:y.light_requirements,healthScore:y.health_score||85,lastWatered:y.last_watered?new Date(y.last_watered):void 0,wateringFrequency:y.care_profile?.wateringFrequency})),s=a.length,o=s>0?Math.round(a.reduce((y,b)=>y+b.healthScore,0)/s):0,l=new Date,c=[],u=[],h=[];a.forEach(y=>{if(y.lastWatered&&y.wateringFrequency){const b=new Date(y.lastWatered),g=new Date(b);g.setDate(b.getDate()+y.wateringFrequency),l>g&&c.push(y.id)}y.healthScore<70&&h.push(y.id)});const m=[...new Set(a.map(y=>y.location))],p={totalPlants:s,plantsData:a,averageHealthScore:o,commonIssues:[],careScheduleSummary:{needsWatering:c,needsFertilizing:u,healthConcerns:h},environmentalFactors:{locations:m,lightConditions:[],humidityNeeds:[]}};return this.cache.setGardenContext(e,p),p}catch(r){throw console.error("Error building garden context:",r),r}}invalidateCache(e){this.cache.invalidateCache(e),console.log("Cache invalidated for user:",e)}}const ca=new EJ(_t,Vo),TJ=()=>{const{user:t}=Cn(),[e,r]=w.useState([]),[n,i]=w.useState(!1),[a,s]=w.useState(!1),[o,l]=w.useState(null),[c,u]=w.useState(null),[h,m]=w.useState([]),[p,y]=w.useState("");w.useEffect(()=>{t?.id&&b()},[t?.id]);const b=async()=>{if(t?.id){i(!0);try{const[D,I]=await Promise.all([ca.getGardenHealthSummary(t.id),ca.getSuggestedQuestions(t.id)]);if(u(D),m(I),e.length===0&&D.totalPlants>0){const A={id:`welcome-${Date.now()}`,sender:"ai",content:`¡Hola! Soy tu asistente de jardín 🌱 

Veo que tienes ${D.totalPlants} plantas en tu jardín con una salud promedio de ${D.averageHealth}%. ${D.urgentActions>0?`Hay ${D.urgentActions} acciones que podrían necesitar tu atención.`:"¡Todo parece estar en buen estado!"}

¿En qué puedo ayudarte hoy con tu jardín?`,timestamp:new Date,context:{queryType:"general"}};r([A])}}catch(D){console.error("Error loading initial garden data:",D),l("Error al cargar la información del jardín")}finally{i(!1)}}},g=w.useCallback(async D=>{if(!t?.id||!D.trim()||a)return;const I=await ca.verifyFunctionAvailability();if(!I.available){l(`🚧 El chat de jardín no está disponible: ${I.error}`);return}const A={id:`user-${Date.now()}`,sender:"user",content:D.trim(),timestamp:new Date};y(D.trim()),r(P=>[...P,A]),s(!0),l(null);try{const P=await ca.sendMessageToGardenAI(D.trim(),t.id,e),j={id:`ai-${Date.now()}`,sender:"ai",content:P.content,timestamp:new Date,context:{plantsAnalyzed:AJ(P),queryType:IJ(D),insights:P.insights||[],suggestedActions:P.suggestedActions||[]}};if(r(N=>[...N,j]),P.suggestedActions&&P.suggestedActions.length>0){const N=await ca.getGardenHealthSummary(t.id);u(N)}}catch(P){console.error("Error sending message to garden AI:",P);let j="Error al enviar el mensaje. Por favor intenta de nuevo.";P instanceof Error&&(P.message.includes("función de chat de jardín no está disponible")?j="🚧 El chat de jardín está temporalmente no disponible. Estamos trabajando para solucionarlo.":P.message.includes("CORS")?j="🔧 Error de configuración. Por favor contacta al administrador.":P.message.includes("garden-ai-chat no existe")&&(j="⚠️ Servicio no configurado. El chat de jardín necesita configuración adicional.")),l(j),r(N=>N.slice(0,-1))}finally{s(!1)}},[t?.id,e,a]),_=w.useCallback(async()=>{p&&await g(p)},[p,g]),T=w.useCallback(()=>{r([]),l(null),t?.id&&b()},[t?.id]),E=w.useCallback(async()=>{if(t?.id){i(!0);try{await ca.refreshGardenData(t.id),await b(),console.log("[useGardenChat] Garden data refreshed successfully")}catch(D){console.error("Error refreshing garden data:",D),l("Error al actualizar los datos del jardín")}finally{i(!1)}}},[t?.id]),O=w.useMemo(()=>n,[n]),R=w.useMemo(()=>{},[t?.id,c]);return{messages:e,isLoading:O,isTyping:a,error:o,gardenSummary:c,suggestedQuestions:h,sendMessage:g,clearMessages:T,retryLastMessage:_,refreshGardenData:E,cacheStats:R}};function AJ(t){const e=[];return t.insights&&t.insights.forEach(r=>{r.affectedPlants&&e.push(...r.affectedPlants)}),t.suggestedActions&&t.suggestedActions.forEach(r=>{r.plantIds&&e.push(...r.plantIds)}),[...new Set(e)]}function IJ(t){const e=t.toLowerCase();return e.includes("salud")||e.includes("problema")||e.includes("enferm")?"health_analysis":e.includes("comparar")||e.includes("diferencia")||e.includes("mejor")?"care_comparison":e.includes("hongo")||e.includes("plaga")||e.includes("prevenir")?"disease_prevention":e.includes("crecimiento")||e.includes("progreso")||e.includes("tiempo")?"growth_tracking":"general"}const SJ=({onClose:t})=>{const[e,r]=w.useState([{name:"garden-ai-chat",available:!1}]),[n,i]=w.useState(!1),a=async()=>{i(!0);const l=[],c=await ca.verifyFunctionAvailability();l.push({name:"garden-ai-chat",available:c.available,error:c.error,lastChecked:new Date}),r(l),i(!1)};w.useEffect(()=>{a()},[]);const s=l=>l.available?d.jsx(Un,{className:"w-5 h-5 text-green-500"}):d.jsx(Lr,{className:"w-5 h-5 text-red-500"}),o=l=>l.available?"Disponible":"No disponible";return d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:l=>l.stopPropagation(),className:"w-full max-w-md",children:d.jsxs(Sr,{className:"p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(U_,{className:"w-6 h-6 text-blue-500"}),d.jsx("h3",{className:"text-lg font-semibold",children:"Diagnóstico del Sistema"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Estado de Funciones Edge"}),d.jsx("div",{className:"space-y-3",children:e.map(l=>d.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[s(l),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-sm",children:l.name}),d.jsx("p",{className:"text-xs text-muted-foreground",children:o(l)})]})]}),l.error&&d.jsxs("div",{className:"text-xs text-red-500 max-w-32 text-right",children:[l.error.substring(0,50),"..."]})]},l.name))})]}),e.some(l=>!l.available)&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(Lr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Servicios no disponibles"}),d.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Algunos servicios del chat de jardín no están funcionando. Verifica que las funciones Edge estén desplegadas en Supabase."})]})]})}),d.jsxs("div",{className:"flex gap-3 pt-3",children:[d.jsxs(me,{onClick:a,disabled:n,variant:"outline",size:"sm",className:"flex-1 gap-2",children:[d.jsx(ji,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Verificar Nuevamente"]}),d.jsx(me,{onClick:t,variant:"secondary",size:"sm",className:"flex-1",children:"Cerrar"})]})]})]})})})},Tf=({gardenSummary:t,onClearChat:e,onRefresh:r,isRefreshing:n=!1})=>{const i=ar(),[a,s]=w.useState(!1),o=c=>c>=80?"text-green-500":c>=60?"text-green-400":"text-red-500",l=c=>c>=80?"Excelente":c>=60?"Buena":"Necesita atención";return d.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[d.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>i(At.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:d.jsx(ip,{size:20})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:d.jsx(ap,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardín"}),t&&d.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(D_,{size:12}),t.totalPlants," plantas"]}),d.jsx("span",{className:`font-medium ${o(t.averageHealth)} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:l(t.averageHealth)}),t.urgentActions>0&&d.jsxs(L.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[t.urgentActions," acciones"]})]})]})]})}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnóstico del sistema",children:d.jsx(U_,{size:18})}),r&&d.jsx("button",{onClick:r,disabled:n,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardín",children:d.jsx(L.div,{animate:n?{rotate:360}:{},transition:n?{duration:1,repeat:1/0,ease:"linear"}:{},children:d.jsx(ji,{size:18})})}),d.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:d.jsx(M_,{size:20})})]})]}),d.jsx(ke,{children:a&&d.jsx(SJ,{onClose:()=>s(!1)})})]})},PJ=({message:t})=>{const e=t.sender==="user",r=()=>{if(!t.context?.queryType)return d.jsx(Uo,{size:16});switch(t.context.queryType){case"health_analysis":return d.jsx(Jr,{size:16});case"care_comparison":return d.jsx(Af,{size:16});case"disease_prevention":return d.jsx($C,{size:16});case"growth_tracking":return d.jsx(V_,{size:16});default:return d.jsx(Uo,{size:16})}},n=()=>{if(e)return"text-primary-foreground/70";if(!t.context?.queryType)return"text-green-500";switch(t.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:je("flex items-end gap-2 max-w-[85%]",e?"justify-end ml-auto":"justify-start"),children:[!e&&d.jsx(L.div,{className:je("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx("div",{className:n(),children:r()})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:je("rounded-2xl px-4 py-3 break-words shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[d.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((i,a)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[i.type==="warning"&&"⚠️ ",i.type==="tip"&&"💡 ",i.type==="recommendation"&&"🌱 ",i.type==="observation"&&"🔎 ",i.title]}),d.jsx("div",{children:i.description}),i.affectedPlants&&i.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",i.affectedPlants.join(", ")]})]},a))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((i,a)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:i.action}),i.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",i.priority]}),i.plantIds&&i.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",i.plantIds.join(", ")]})]},a))})]}),!e&&t.context?.plantsAnalyzed&&t.context.plantsAnalyzed.length>0&&d.jsxs(L.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[d.jsx(Af,{size:12}),d.jsxs("span",{children:["Analizó ",t.context.plantsAnalyzed.length," planta(s)"]})]}),d.jsx("div",{className:je("mt-2 text-xs",e?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:cA(new Date(t.timestamp),{addSuffix:!0,locale:Fk})})]})}),e&&d.jsx(L.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx(LC,{size:16,className:"text-primary"})})]})},kJ=({onSendMessage:t,isTyping:e,suggestedQuestions:r,isLoading:n=!1})=>{const[i,a]=w.useState(""),[s,o]=w.useState(!0),l=w.useRef(null),c=async()=>{if(e)return;const p=l.current?.value.trim();p&&(o(!1),l.current&&(l.current.value=""),await t(p))},u=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),c())},h=async p=>{a(""),o(!1),await t(p)},m=()=>{r.length>0&&!i&&o(!0)};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsx(ke,{children:s&&r.length>0&&!n&&d.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[d.jsx(Bt,{size:12}),d.jsx("span",{children:"Preguntas sugeridas"})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((p,y)=>d.jsx(L.button,{onClick:()=>h(p),disabled:e,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:y*.1},whileHover:{scale:1.02},whileTap:{scale:.98},children:p},p))})]})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Od,{type:"text",ref:l,onKeyDown:u,onFocus:m,placeholder:"Pregúntame sobre tu jardín...",className:"pr-12",disabled:e||n}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(F_,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:c,disabled:!i.trim()||e||n,size:"icon",className:"shrink-0",children:e?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(Bt,{size:20})}):d.jsx(z_,{size:20})})]}),n&&d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(Bt,{size:12})}),d.jsx("span",{children:"Analizando tu jardín..."})]})]})})},CJ={plants:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[d.jsx(L.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),d.jsx(L.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:d.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),d.jsx(L.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:d.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),d.jsx(L.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:d.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),d.jsx(L.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),d.jsx(L.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),d.jsx(L.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),d.jsx(L.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[d.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),d.jsx(L.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),d.jsx(L.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),d.jsx(L.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsxs(L.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[d.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),d.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),d.jsxs(L.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[d.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),d.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},NJ=({icon:t,title:e,description:r,action:n,illustration:i="plants",className:a})=>d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:je("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",a),children:[d.jsx(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:t||CJ[i]}),d.jsx(L.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:e}),d.jsx(L.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),n&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:d.jsx(me,{onClick:n.onClick,variant:"primary",size:"lg",className:"animate-glow",children:n.label})})]}),jJ=()=>{const t=ar(),e=qn(p=>p.plants),{messages:r,isLoading:n,isTyping:i,error:a,gardenSummary:s,suggestedQuestions:o,sendMessage:l,clearMessages:c,retryLastMessage:u,refreshGardenData:h}=TJ(),m=w.useRef(null);return w.useEffect(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r,i]),a&&!s?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Tf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[d.jsx(Lr,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexión"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:a}),d.jsxs(me,{onClick:h,variant:"primary",children:[d.jsx(ji,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]}):s?.totalPlants===0?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Tf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx(NJ,{illustration:"plants",title:"Tu jardín está vacío",description:"Agrega algunas plantas a tu jardín para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>t(At.toCamera())}})})]}):d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Tf,{gardenSummary:s,onClearChat:c,onRefresh:h,isRefreshing:n&&r.length>0}),r.length===0&&e.length>0&&d.jsxs("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:[d.jsx("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Chats individuales con tus plantas:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.slice(0,4).map(p=>d.jsx(Sr,{variant:"glass",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary-300 dark:hover:border-primary-600",onClick:()=>t(At.toPlantChat(p.id)),children:d.jsx(Jn,{className:"p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:d.jsx(ap,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium truncate",children:p.nickname||p.name}),d.jsx("p",{className:"text-xs text-neutral-500 truncate",children:p.species})]}),d.jsx(pl,{className:"w-4 h-4 text-neutral-400"})]})})},p.id)),e.length>4&&d.jsx(Sr,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer",onClick:()=>t(At.toDashboard()),children:d.jsx(Jn,{className:"p-3 flex items-center justify-center",children:d.jsxs("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["+",e.length-4," más"]})})})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsxs("div",{className:"p-4 space-y-4 max-w-4xl mx-auto",children:[d.jsx(ke,{children:r.map(p=>d.jsx(PJ,{message:p},p.id))}),i&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:d.jsx(zk,{})}),a&&r.length>0&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-center",children:d.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 max-w-sm",children:[d.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300 text-sm",children:[d.jsx(Lr,{size:16}),d.jsx("span",{children:a})]}),d.jsxs(me,{onClick:u,size:"sm",variant:"outline",className:"mt-2 w-full",children:[d.jsx(ji,{size:14,className:"mr-1"}),"Reintentar"]})]})}),d.jsx("div",{ref:m})]}),!1]}),d.jsx(kJ,{onSendMessage:l,isTyping:i,suggestedQuestions:o,isLoading:n})]})},OJ=w.lazy(()=>Qm(()=>import("./Settings-BHY6i4nz.js"),__vite__mapDeps([0,1,2,3,4,5]))),RJ=w.lazy(()=>Qm(()=>import("./Auth-dkmTSe6U.js"),__vite__mapDeps([6,1,2,4,5,3]))),DJ=new T_({defaultOptions:{queries:{staleTime:yi.QUERY.STALE_TIME.MEDIUM,gcTime:yi.QUERY.GC_TIME.MEDIUM,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:yi.QUERY.RETRY.COUNT,retryDelay:t=>Math.min(yi.QUERY.RETRY.DELAY*2**t,3e4)},mutations:{retry:yi.QUERY.RETRY.COUNT,retryDelay:yi.QUERY.RETRY.DELAY}}}),__=({message:t})=>d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(ml,{className:"w-12 h-12 text-green-500 animate-bounce mb-4"}),d.jsx("p",{className:"text-lg text-muted-foreground",children:t})]}),MJ=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/":window.location.pathname.startsWith("/plantitas-app")?"/plantitas-app/":"/",LJ=()=>{const{user:t,initialized:e,initialize:r}=Cn();PL(),w.useEffect(()=>{console.log("[APP] useEffect running...");try{const s=kL();return console.log("[APP] Calling initialize..."),r(),console.log("[APP] Initialize called"),()=>{console.log("[APP] Cleanup running..."),s()}}catch(s){throw eg("APP_INITIALIZATION",s),s}},[r]);const[n,i]=w.useState(!1);if(w.useEffect(()=>{const s=setTimeout(()=>{e||(console.warn("[APP] Emergency timeout - forcing app render"),i(!0))},3e3);return()=>clearTimeout(s)},[e]),!e&&!n)return d.jsx(__,{message:"Inicializando..."});const a=()=>d.jsx(Pv,{children:d.jsxs(sn,{path:"/",element:d.jsx(Z3,{}),children:[d.jsx(sn,{index:!0,element:d.jsx(gF,{})}),d.jsx(sn,{path:"camera",element:d.jsx(LQ,{})}),d.jsx(sn,{path:"settings",element:d.jsx(OJ,{})}),d.jsx(sn,{path:"garden-chat",element:d.jsx(jJ,{})}),d.jsx(sn,{path:"plant/:plantId",element:d.jsx(jQ,{})}),d.jsx(sn,{path:"plant/:plantId/chat",element:d.jsx(_J,{})}),d.jsx(sn,{path:"*",element:d.jsx(Lh,{to:xt.dashboard,replace:!0})})]})});return d.jsx(A_,{client:DJ,children:d.jsx(xL,{children:d.jsx(IL,{children:d.jsx(X3,{children:d.jsxs(yC,{basename:MJ(),future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[d.jsx(yL,{position:"top-center",richColors:!0}),d.jsx(jL,{}),d.jsx(w.Suspense,{fallback:d.jsx(__,{message:"Cargando..."}),children:d.jsxs(Pv,{children:[d.jsx(sn,{path:xt.auth,element:t?d.jsx(Lh,{to:xt.dashboard,replace:!0}):d.jsx(RJ,{})}),d.jsx(sn,{path:"/*",element:t?d.jsx(a,{}):d.jsx(Lh,{to:xt.auth,replace:!0})})]})})]})})})})})},$J=w.createContext(void 0),VJ=({children:t,defaultTheme:e="system",storageKey:r="vite-ui-theme"})=>{const[n,i]=w.useState(()=>localStorage.getItem(r)||e),a=w.useMemo(()=>n==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,[n]);w.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(a),localStorage.setItem(r,n)},[a,n,r]);const s={theme:n,setTheme:i,resolvedTheme:a};return d.jsx($J.Provider,{value:s,children:t})};console.log("[MOBILE] 🚨 Main.tsx loading started");console.log("[MOBILE] Location:",window.location.href);console.log("[MOBILE] Pathname:",window.location.pathname);console.log("[MOBILE] User Agent:",navigator.userAgent);window.addEventListener("error",t=>{console.error("[GLOBAL] Uncaught error:",t.error),console.error("[GLOBAL] Error details:",{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,stack:t.error?.stack})});window.addEventListener("unhandledrejection",t=>{console.error("[GLOBAL] Unhandled promise rejection:",t.reason),console.error("[GLOBAL] Promise:",t.promise)});try{OL(),console.log("[MOBILE] Debug system initialized")}catch(t){console.error("[MOBILE] Debug system failed:",t)}const Uk=new T_;function FJ(){const{user:t}=Cn();return H.useEffect(()=>{t?.id&&Uk.prefetchQuery({queryKey:["plants",t.id],queryFn:()=>ds.getUserPlantSummaries(t.id),staleTime:1e3*60*5})},[t?.id]),null}console.log("[MOBILE] Looking for root container...");const Bk=document.getElementById("root");if(!Bk)throw eg("ROOT_CONTAINER","Root container not found"),new Error("Root container not found");console.log("[MOBILE] Root container found, creating React root...");try{const t=If.createRoot(Bk);console.log("[MOBILE] React root created, rendering App..."),t.render(d.jsx(H.StrictMode,{children:d.jsx(VJ,{children:d.jsxs(A_,{client:Uk,children:[d.jsx(FJ,{}),d.jsx(LJ,{})]})})})),console.log("[MOBILE] App render called successfully")}catch(t){throw eg("REACT_RENDER",t),t}export{me as B,Cn as a,Q3 as b,je as c,YJ as d,H3 as g,Y3 as u};
