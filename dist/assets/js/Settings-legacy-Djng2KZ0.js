!function(){function e(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./query-legacy-ZvuW6rIy.js","./vendor-legacy-CMtrHmhA.js","./index-legacy-BWzKXsTd.js","./router-legacy-BP4270OX.js","./ui-legacy-BTYIp0tI.js","./supabase-legacy-CwN3zXIV.js"],function(t,n){"use strict";var r,a,s,o,i,l,c,d,u,p,g,m,h,f,x,b,y,v,w,j,k,N,S,C,E,I,D,P,O;return{setters:[e=>{r=e.j},e=>{a=e.r,s=e.R,o=e.b},e=>{i=e.u,l=e.a,c=e.c,d=e.b,u=e.d,p=e.B},e=>{g=e.u},e=>{m=e.m,h=e.u,f=e.A,x=e.q,b=e.X,y=e.aa,v=e.ab,w=e.e,j=e.M,k=e.I,N=e.ac,S=e.r,C=e.n,E=e.ad,I=e.O,D=e.j,P=e.ae,O=e.a8},null],execute:function(){const n=(e,t)=>t.some(t=>e instanceof t);let B,R;const L=new WeakMap,A=new WeakMap,M=new WeakMap;let $={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return L.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return z(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function T(e){$=e($)}function W(e){return(R||(R=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_(this),t),z(this.request)}:function(...t){return z(e.apply(_(this),t))}}function F(e){return"function"==typeof e?W(e):(e instanceof IDBTransaction&&function(e){if(L.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",s),e.removeEventListener("abort",s)},a=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",s),e.addEventListener("abort",s)});L.set(e,t)}(e),n(e,B||(B=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,$):e)}function z(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",s)},a=()=>{t(z(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",s)});return M.set(t,e),t}(e);if(A.has(e))return A.get(e);const t=F(e);return t!==e&&(A.set(e,t),M.set(t,e)),t}const _=e=>M.get(e);const q=["get","getKey","getAll","getAllKeys","count"],V=["put","add","delete","clear"],U=new Map;function H(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(U.get(t))return U.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=V.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!q.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,a?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),a&&s.done]))[0]};return U.set(t,s),s}T(e=>({...e,get:(t,n,r)=>H(t,n)||e.get(t,n,r),has:(t,n)=>!!H(t,n)||e.has(t,n)}));const J=["continue","continuePrimaryKey","advance"],K={},X=new WeakMap,G=new WeakMap,Z={get(e,t){if(!J.includes(t))return e[t];let n=K[t];return n||(n=K[t]=function(...e){X.set(this,G.get(this)[t](...e))}),n}};async function*Q(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const n=new Proxy(t,Z);for(G.set(n,t),M.set(n,_(t));t;)yield n,t=await(X.get(n)||t.continue()),X.delete(n)}function Y(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}T(e=>({...e,get:(t,n,r)=>Y(t,n)?Q:e.get(t,n,r),has:(t,n)=>Y(t,n)||e.has(t,n)}));const ee=new class{constructor(){e(this,"db",null)}async init(){return this.db||(this.db=await function(e,t,{blocked:n,upgrade:r,blocking:a,terminated:s}={}){const o=indexedDB.open(e,t),i=z(o);return r&&o.addEventListener("upgradeneeded",e=>{r(z(o.result),e.oldVersion,e.newVersion,z(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),i.then(e=>{s&&e.addEventListener("close",()=>s()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}("PlantCareDB",1,{upgrade(e){const t=e.createObjectStore("plants",{keyPath:"id"});t.createIndex("by-health","healthScore"),t.createIndex("by-date","dateAdded"),e.createObjectStore("images",{keyPath:"id"}),e.createObjectStore("settings",{keyPath:"key"})}})),this.db}async savePlant(e){const t=await this.init();await t.put("plants",e);const n=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(n))}async getPlant(e){const t=await this.init();return await t.get("plants",e)}async getAllPlants(){const e=await this.init();return(await e.getAll("plants")).map(e=>({...e,dateAdded:new Date(e.dateAdded),lastWatered:e.lastWatered?new Date(e.lastWatered):void 0,lastFertilized:e.lastFertilized?new Date(e.lastFertilized):void 0,images:e.images.map(e=>({...e,timestamp:new Date(e.timestamp)})),chatHistory:e.chatHistory.map(e=>({...e,timestamp:new Date(e.timestamp)})),notifications:e.notifications.map(e=>({...e,scheduledFor:new Date(e.scheduledFor)}))}))}async deletePlant(e){const t=await this.init();await t.delete("plants",e);const n=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(n))}async saveImageBlob(e,t,n){const r=await this.init();await r.put("images",{id:e,plantId:t,blob:n,timestamp:new Date})}async getImageBlob(e){const t=await this.init(),n=await t.get("images",e);return null==n?void 0:n.blob}async saveSetting(e,t){const n=await this.init();await n.put("settings",{key:e,value:t})}async getSetting(e){const t=await this.init(),n=await t.get("settings",e);return null==n?void 0:n.value}async exportData(){const e=await this.getAllPlants(),t={theme:await this.getSetting("theme"),notifications:await this.getSetting("notifications")};return JSON.stringify({plants:e,settings:t,exportDate:(new Date).toISOString(),version:"1.0.0"},null,2)}async importData(e){try{const t=JSON.parse(e);if(t.plants)for(const e of t.plants)await this.savePlant(e);if(t.settings)for(const[e,n]of Object.entries(t.settings))void 0!==n&&await this.saveSetting(e,n)}catch(t){throw new Error("Invalid data format")}}async clearAllData(){const e=await this.init();await e.clear("plants"),await e.clear("images"),await e.clear("settings"),localStorage.removeItem("plants")}},te=({title:e,children:t,delay:n=0})=>r.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*n},className:"space-y-3",children:[r.jsx("h2",{className:"text-lg font-bold text-foreground px-4",children:e}),r.jsx("div",{className:"bg-muted/50 rounded-2xl overflow-hidden",children:t})]});function ne(e,t,{checkForDefaultPrevented:n=!0}={}){return function(r){if(null==e||e(r),!1===n||!r.defaultPrevented)return null==t?void 0:t(r)}}function re(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function ae(...e){return t=>{let n=!1;const r=e.map(e=>{const r=re(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){const n=r[t];"function"==typeof n?n():re(e[t],null)}}}}function se(...e){return a.useCallback(ae(...e),e)}function oe(...e){const t=e[0];if(1===e.length)return t;const n=()=>{const n=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const r=n.reduce((t,{useScope:n,scopeName:r})=>({...t,...n(e)[`__scope${r}`]}),{});return a.useMemo(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return n.scopeName=t.scopeName,n}var ie=null!==globalThis&&void 0!==globalThis&&globalThis.document?a.useLayoutEffect:()=>{},le=s[" useInsertionEffect ".trim().toString()]||ie;function ce({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,o,i]=function({defaultProp:e,onChange:t}){const[n,r]=a.useState(e),s=a.useRef(n),o=a.useRef(t);return le(()=>{o.current=t},[t]),a.useEffect(()=>{var e;s.current!==n&&(null===(e=o.current)||void 0===e||e.call(o,n),s.current=n)},[n,s]),[n,r,o]}({defaultProp:t,onChange:n}),l=void 0!==e,c=l?e:s;{const t=a.useRef(void 0!==e);a.useEffect(()=>{const e=t.current;if(e!==l){const t=e?"controlled":"uncontrolled",n=l?"controlled":"uncontrolled";console.warn(`${r} is changing from ${t} to ${n}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`)}t.current=l},[l,r])}const d=a.useCallback(t=>{if(l){const r=function(e){return"function"==typeof e}(t)?t(e):t;var n;if(r!==e)null===(n=i.current)||void 0===n||n.call(i,r)}else o(t)},[l,e,o,i]);return[c,d]}function de(e){const t=a.forwardRef((e,t)=>{const{children:n,...r}=e;if(a.isValidElement(n)){const e=function(e){var t,n;let r=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,a=r&&"isReactWarning"in r&&r.isReactWarning;if(a)return e.ref;if(r=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a)return e.props.ref;return e.props.ref||e.ref}(n),s=function(e,t){const n={...t};for(const r in t){const a=e[r],s=t[r];/^on[A-Z]/.test(r)?a&&s?n[r]=(...e)=>{const t=s(...e);return a(...e),t}:a&&(n[r]=a):"style"===r?n[r]={...a,...s}:"className"===r&&(n[r]=[a,s].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==a.Fragment&&(s.ref=t?ae(t,e):e),a.cloneElement(n,s)}return a.Children.count(n)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ue=Symbol("radix.slottable");function pe(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ue}var ge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{const n=function(e){const t=de(e),n=a.forwardRef((e,n)=>{const{children:s,...o}=e,i=a.Children.toArray(s),l=i.find(pe);if(l){const e=l.props.children,s=i.map(t=>t===l?a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null:t);return r.jsx(t,{...o,ref:n,children:a.isValidElement(e)?a.cloneElement(e,void 0,s):null})}return r.jsx(t,{...o,ref:n,children:s})});return n.displayName=`${e}.Slot`,n}(`Primitive.${t}`),s=a.forwardRef((e,a)=>{const{asChild:s,...o}=e,i=s?n:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),r.jsx(i,{...o,ref:a})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),me="Switch",[he,fe]=function(e,t=[]){let n=[];const s=()=>{const t=n.map(e=>a.createContext(e));return function(n){const r=(null==n?void 0:n[e])||t;return a.useMemo(()=>({[`__scope${e}`]:{...n,[e]:r}}),[n,r])}};return s.scopeName=e,[function(t,s){const o=a.createContext(s),i=n.length;n=[...n,s];const l=t=>{var n;const{scope:s,children:l,...c}=t,d=(null==s||null===(n=s[e])||void 0===n?void 0:n[i])||o,u=a.useMemo(()=>c,Object.values(c));return r.jsx(d.Provider,{value:u,children:l})};return l.displayName=t+"Provider",[l,function(n,r){var l;const c=(null==r||null===(l=r[e])||void 0===l?void 0:l[i])||o,d=a.useContext(c);if(d)return d;if(void 0!==s)return s;throw new Error(`\`${n}\` must be used within \`${t}\``)}]},oe(s,...t)]}(me),[xe,be]=he(me),ye=a.forwardRef((e,t)=>{const{__scopeSwitch:n,name:s,checked:o,defaultChecked:i,required:l,disabled:c,value:d="on",onCheckedChange:u,form:p,...g}=e,[m,h]=a.useState(null),f=se(t,e=>h(e)),x=a.useRef(!1),b=!m||(p||!!m.closest("form")),[y,v]=ce({prop:o,defaultProp:null!=i&&i,onChange:u,caller:me});return r.jsxs(xe,{scope:n,checked:y,disabled:c,children:[r.jsx(ge.button,{type:"button",role:"switch","aria-checked":y,"aria-required":l,"data-state":ke(y),"data-disabled":c?"":void 0,disabled:c,value:d,...g,ref:f,onClick:ne(e.onClick,e=>{v(e=>!e),b&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})}),b&&r.jsx(je,{control:m,bubbles:!x.current,name:s,value:d,checked:y,required:l,disabled:c,form:p,style:{transform:"translateX(-100%)"}})]})});ye.displayName=me;var ve="SwitchThumb",we=a.forwardRef((e,t)=>{const{__scopeSwitch:n,...a}=e,s=be(ve,n);return r.jsx(ge.span,{"data-state":ke(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})});we.displayName=ve;var je=a.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:s=!0,...o},i)=>{const l=a.useRef(null),c=se(l,i),d=function(e){const t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(n),u=function(e){const[t,n]=a.useState(void 0);return ie(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const t=new ResizeObserver(t=>{if(!Array.isArray(t))return;if(!t.length)return;const r=t[0];let a,s;if("borderBoxSize"in r){const e=r.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,s=t.blockSize}else a=e.offsetWidth,s=e.offsetHeight;n({width:a,height:s})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}n(void 0)},[e]),t}(t);return a.useEffect(()=>{const e=l.current;if(!e)return;const t=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(t,"checked").set;if(d!==n&&r){const t=new Event("click",{bubbles:s});r.call(e,n),e.dispatchEvent(t)}},[d,n,s]),r.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:c,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function ke(e){return e?"checked":"unchecked"}je.displayName="SwitchBubbleInput";var Ne=ye,Se=we;const Ce=a.forwardRef(({className:e,...t},n)=>r.jsx(Ne,{className:c("peer inline-flex h-7 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:r.jsx(Se,{className:c("pointer-events-none block h-6 w-6 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ce.displayName=Ne.displayName;const Ee=({icon:e,label:t,value:n,onClick:a,isLast:s=!1,type:i="button",disabled:l=!1,toggleState:d=!1,onToggleChange:u})=>{const p=o.useId(),g=r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-background",children:r.jsx(e,{size:18,className:"text-muted-foreground"})}),r.jsx("span",{className:"font-medium text-foreground",children:t})]}),r.jsxs("div",{className:"flex items-center gap-2",children:["button"===i&&r.jsxs(r.Fragment,{children:[n&&r.jsx("span",{className:"text-sm text-muted-foreground",children:n}),r.jsx(h,{size:16,className:"text-muted-foreground/50"})]}),"toggle"===i&&r.jsx(Ce,{id:p,checked:d,onCheckedChange:u,"aria-label":t})]})]}),m=c("flex w-full items-center justify-between p-3 text-left",!s&&"border-b border-background",a&&"transition-colors hover:bg-background/50");return"button"===i?r.jsx("button",{onClick:a,className:m,disabled:l,children:g}):r.jsx("label",{htmlFor:p,className:c(m,"cursor-pointer"),children:g})},Ie=()=>{const[e,t]=a.useState(!1),{data:n=[]}=d(),r=e=>e.toISOString().split("T")[0],s=e=>{if(null==e)return"";const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t.replace(/"/g,'""')}"`:t},o=async e=>{t(!0);try{const t={exportDate:(new Date).toISOString(),plantCount:n.length,plants:n.map(t=>{var n;return{id:t.id,name:t.name,nickname:t.nickname,species:t.species,location:t.location,plantEnvironment:t.plantEnvironment,lightRequirements:t.lightRequirements,healthScore:t.healthScore,lastWatered:null===(n=t.lastWatered)||void 0===n?void 0:n.toISOString(),...e.includeImages&&{profileImageUrl:t.profileImageUrl},...e.includeChats&&{chatHistory:[]}}}),metadata:{version:"1.0.0",source:"Plant Care Companion"}},a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});i(a,`plantas-backup-${r(new Date)}.json`)}catch(a){throw console.error("Error exporting to JSON:",a),new Error("Failed to export data as JSON")}finally{t(!1)}},i=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)};return{exportData:async e=>{if(0===n.length)throw new Error("No hay plantas para exportar");switch(e.format){case"json":return o(e);case"csv":return(async e=>{t(!0);try{const t=["ID","Nombre","Apodo","Especie","Ubicación","Ambiente","Luz Requerida","Puntuación Salud","Último Riego"];e.includeImages&&t.push("Imagen Principal");const a=[t.join(",")];n.forEach(t=>{const n=[s(t.id),s(t.name),s(t.nickname||""),s(t.species),s(t.location),s(t.plantEnvironment||""),s(t.lightRequirements||""),s(t.healthScore||""),s(t.lastWatered?r(t.lastWatered):"")];e.includeImages&&n.push(s(t.profileImageUrl||"")),a.push(n.join(","))});const o=a.join("\n"),l=new Blob([o],{type:"text/csv;charset=utf-8;"});i(l,`plantas-${r(new Date)}.csv`)}catch(a){throw console.error("Error exporting to CSV:",a),new Error("Failed to export data as CSV")}finally{t(!1)}})(e);default:throw new Error("Formato de exportación no soportado")}},isExporting:e,getExportSize:()=>{const e=1024*n.length,t=e/1048576;return{plantCount:n.length,estimatedSize:t>1?`${t.toFixed(1)} MB`:`${Math.round(e/1024)} KB`}},createAutoBackup:async()=>{try{const e=localStorage.getItem("last-auto-backup"),t=(new Date).getTime(),n=6048e5;(!e||t-parseInt(e)>n)&&(await o({format:"json",includeImages:!1,includeChats:!1}),localStorage.setItem("last-auto-backup",t.toString()))}catch(e){console.warn("Auto-backup failed:",e)}},availableFormats:["json","csv"]}},De=({isOpen:e,onClose:t})=>{const[n,s]=a.useState("json"),[o,i]=a.useState(!0),[l,c]=a.useState(!1),{exportData:d,isExporting:g,getExportSize:h}=Ie(),{showSuccess:N,showError:S}=u(),{plantCount:C,estimatedSize:E}=h();return e?r.jsx(f,{children:r.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:r.jsxs(m.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-hidden",children:[r.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:r.jsx(x,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Exportar Datos"}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Descarga una copia de tus datos de plantas"})]})]}),r.jsx("button",{onClick:t,disabled:g,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar modal",children:r.jsx(b,{className:"w-5 h-5"})})]})}),r.jsxs("div",{className:"p-6 space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Plantas a exportar:"}),r.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:C})]}),r.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[r.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Tamaño estimado:"}),r.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:E})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Formato de archivo"}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx("button",{onClick:()=>s("json"),disabled:g,className:`\n                    p-4 rounded-lg border-2 transition-all text-left\n                    ${"json"===n?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}\n                  `,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(y,{className:"w-5 h-5 "+("json"===n?"text-blue-600":"text-gray-500")}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium "+("json"===n?"text-blue-900 dark:text-blue-100":"text-gray-900 dark:text-gray-100"),children:"JSON"}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Completo, reimportable"})]})]})}),r.jsx("button",{onClick:()=>s("csv"),disabled:g,className:`\n                    p-4 rounded-lg border-2 transition-all text-left\n                    ${"csv"===n?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}\n                  `,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(v,{className:"w-5 h-5 "+("csv"===n?"text-blue-600":"text-gray-500")}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium "+("csv"===n?"text-blue-900 dark:text-blue-100":"text-gray-900 dark:text-gray-100"),children:"CSV"}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Para Excel/Sheets"})]})]})})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Incluir en la exportación"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:o,onChange:e=>i(e.target.checked),disabled:g,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsx(w,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Metadatos de imágenes"})]}),r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer opacity-50",children:[r.jsx("input",{type:"checkbox",checked:l,onChange:e=>c(e.target.checked),disabled:!0,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),r.jsx(j,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Historial de chat (próximamente)"})]})]})]}),r.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx(k,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-blue-800 dark:text-blue-200 font-medium mb-1",children:"Sobre la exportación"}),r.jsx("p",{className:"text-blue-700 dark:text-blue-300 leading-relaxed",children:"Los datos exportados incluyen toda la información de tus plantas: nombres, especies, cuidados, fechas de riego y ubicaciones. Las imágenes se incluyen como referencias URL."})]})]})})]}),r.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end",children:[r.jsx(p,{variant:"outline",onClick:t,disabled:g,children:"Cancelar"}),r.jsxs(p,{onClick:async()=>{try{await d({format:n,includeImages:o,includeChats:l}),N("Exportación completada",`Se descargaron los datos de ${C} plantas en formato ${n.toUpperCase()}.`),t()}catch(e){S("Error en la exportación",e instanceof Error?e.message:"No se pudo completar la exportación.")}},disabled:g||0===C,loading:g,className:"flex items-center gap-2",children:[r.jsx(x,{className:"w-4 h-4"}),g?"Exportando...":"Exportar Datos"]})]})]})})}):null},Pe={User:O,LogOut:P,Sun:D,Moon:I,Bell:E,Download:x,Trash2:C,HelpCircle:S,Shield:N,Info:k};t("default",()=>{const{settingsSections:e,isExportModalOpen:t,setIsExportModalOpen:n}=(()=>{const{isDark:e,toggleTheme:t}=i(),{signOut:n,profile:r}=l(),s=g(),[o,c]=a.useState(!1),d=async()=>{if(window.confirm("¿Estás seguro de que quieres cerrar sesión?"))try{await n(),s("/auth")}catch(e){console.error("Error signing out:",e)}},u=()=>{c(!0)},p=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar todos tus datos? Esta acción es irreversible."))try{await ee.clearAllData(),await d()}catch(e){console.error("Error clearing data:",e)}};return{settingsSections:a.useMemo(()=>[{title:"Cuenta",items:[{id:"signout",icon:"LogOut",label:"Cerrar sesión",type:"button",onClick:d}]},{title:"Preferencias",items:[{id:"theme",icon:e?"Sun":"Moon",label:"Modo Oscuro",type:"toggle",toggleState:e,onToggleChange:t}]},{title:"Datos",items:[{id:"export",icon:"Download",label:"Exportar mis datos",type:"button",onClick:u,disabled:!r||!1},{id:"delete",icon:"Trash2",label:"Eliminar mis datos",type:"button",onClick:p,disabled:!r||!1}]},{title:"Soporte",items:[]}],[e,r,d,t]),isExportModalOpen:o,setIsExportModalOpen:c}})();return r.jsxs("div",{className:"p-4 space-y-6",children:[r.jsxs("header",{children:[r.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Configuración"}),r.jsx("p",{className:"text-muted-foreground",children:"Gestiona tu cuenta y preferencias de la app."})]}),e.map((e,t)=>r.jsx(te,{title:e.title,delay:t,children:e.items.map((t,n)=>{const a=Pe[t.icon],s=n===e.items.length-1;return"toggle"===t.type?r.jsx(Ee,{icon:a,label:t.label,isLast:s,type:"toggle",toggleState:"toggleState"in t&&t.toggleState,onToggleChange:"onToggleChange"in t?t.onToggleChange:void 0},t.id):r.jsx(Ee,{icon:a,label:t.label,value:"value"in t&&"string"==typeof t.value?t.value:void 0,onClick:"onClick"in t?t.onClick:void 0,isLast:s,type:"button",disabled:"disabled"in t&&t.disabled},t.id)})},e.title)),r.jsx(De,{isOpen:t,onClose:()=>n(!1)})]})})}}})}();
