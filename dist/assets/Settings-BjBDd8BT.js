import{j as e,R as t,g as s,h as r,i as a,X as n,k as i,F as o,I as c,M as l,l as d,m as u,n as h,o as p,p as m,q as g,d as f,L as y,U as b}from"./ui-Bk1S1bfB.js";import{r as x,a as v}from"./vendor-B7436CdZ.js";import{S as w,p as j,r as k,s as I,a as R,n as S,i as C,b as N,t as E,f as D,c as O,d as Q,e as T,g as P,u as L,h as B,P as F,j as M,k as U,m as A,l as q,o as _,A as W,B as z}from"./index-X1jrh_es.js";import{u as $}from"./router-FRsZEvam.js";import"../node_modules/lucide-react/dist/esm/icons/inspection-panel.js";import"../node_modules/lucide-react/dist/esm/icons/test-tube-diagonal.js";import"../node_modules/lucide-react/dist/esm/icons/test-tube.js";import"../node_modules/lucide-react/dist/esm/icons/test-tubes.js";import"./utils-ksFrU8AV.js";import"./firebase-CDdb9pRW.js";import"../node_modules/motion-dom/dist/es/value/types/test.mjs";var H=class extends w{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=j(),this.options.experimental_prefetchInRender||this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#a=void 0;#n=void 0;#i;#o;#s;#t;#c;#l;#d;#u;#h;#p;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),V(this.#r,this.options)?this.#g():this.updateResult(),this.#f())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return J(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return J(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#y(),this.#b(),this.#r.removeObserver(this)}setOptions(e){const t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof k(this.options.enabled,this.#r))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#r.setOptions(this.options),t._defaulted&&!I(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});const r=this.hasListeners();r&&K(this.#r,s,this.options,t)&&this.#g(),this.updateResult(),!r||this.#r===s&&k(this.options.enabled,this.#r)===k(t.enabled,this.#r)&&R(this.options.staleTime,this.#r)===R(t.staleTime,this.#r)||this.#v();const a=this.#w();!r||this.#r===s&&k(this.options.enabled,this.#r)===k(t.enabled,this.#r)&&a===this.#p||this.#j(a)}getOptimisticResult(e){const t=this.#e.getQueryCache().build(this.#e,e),s=this.createResult(t,e);return function(e,t){if(!I(e.getCurrentResult(),t))return!0;return!1}(this,s)&&(this.#n=s,this.#o=this.options,this.#i=this.#r.state),s}getCurrentResult(){return this.#n}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),Reflect.get(e,s))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#g({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#g(e){this.#x();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(S)),t}#v(){this.#y();const e=R(this.options.staleTime,this.#r);if(C||this.#n.isStale||!N(e))return;const t=E(this.#n.dataUpdatedAt,e)+1;this.#u=setTimeout(()=>{this.#n.isStale||this.updateResult()},t)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#j(e){this.#b(),this.#p=e,!C&&!1!==k(this.options.enabled,this.#r)&&N(this.#p)&&0!==this.#p&&(this.#h=setInterval(()=>{(this.options.refetchIntervalInBackground||D.isFocused())&&this.#g()},this.#p))}#f(){this.#v(),this.#j(this.#w())}#y(){this.#u&&(clearTimeout(this.#u),this.#u=void 0)}#b(){this.#h&&(clearInterval(this.#h),this.#h=void 0)}createResult(e,t){const s=this.#r,r=this.options,a=this.#n,n=this.#i,i=this.#o,o=e!==s?e.state:this.#a,{state:c}=e;let l,d={...c},u=!1;if(t._optimisticResults){const a=this.hasListeners(),n=!a&&V(e,t),i=a&&K(e,s,t,r);(n||i)&&(d={...d,...O(c.data,e.options)}),"isRestoring"===t._optimisticResults&&(d.fetchStatus="idle")}let{error:h,errorUpdatedAt:p,status:m}=d;l=d.data;let g=!1;if(void 0!==t.placeholderData&&void 0===l&&"pending"===m){let e;a?.isPlaceholderData&&t.placeholderData===i?.placeholderData?(e=a.data,g=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,void 0!==e&&(m="success",l=Q(a?.data,e,t),u=!0)}if(t.select&&void 0!==l&&!g)if(a&&l===n?.data&&t.select===this.#c)l=this.#l;else try{this.#c=t.select,l=t.select(l),l=Q(a?.data,l,t),this.#l=l,this.#t=null}catch(I){this.#t=I}this.#t&&(h=this.#t,l=this.#l,p=Date.now(),m="error");const f="fetching"===d.fetchStatus,y="pending"===m,b="error"===m,x=y&&f,v=void 0!==l,w={status:m,fetchStatus:d.fetchStatus,isPending:y,isSuccess:"success"===m,isError:b,isInitialLoading:x,isLoading:x,data:l,dataUpdatedAt:d.dataUpdatedAt,error:h,errorUpdatedAt:p,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>o.dataUpdateCount||d.errorUpdateCount>o.errorUpdateCount,isFetching:f,isRefetching:f&&!y,isLoadingError:b&&!v,isPaused:"paused"===d.fetchStatus,isPlaceholderData:u,isRefetchError:b&&v,isStale:G(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==k(t.enabled,e)};if(this.options.experimental_prefetchInRender){const t=e=>{"error"===w.status?e.reject(w.error):void 0!==w.data&&e.resolve(w.data)},r=()=>{const e=this.#s=w.promise=j();t(e)},a=this.#s;switch(a.status){case"pending":e.queryHash===s.queryHash&&t(a);break;case"fulfilled":"error"!==w.status&&w.data===a.value||r();break;case"rejected":"error"===w.status&&w.error===a.reason||r()}}return w}updateResult(){const e=this.#n,t=this.createResult(this.#r,this.options);if(this.#i=this.#r.state,this.#o=this.options,void 0!==this.#i.data&&(this.#d=this.#r),I(t,e))return;this.#n=t;this.#k({listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#m.size)return!0;const r=new Set(s??this.#m);return this.options.throwOnError&&r.add("error"),Object.keys(this.#n).some(t=>{const s=t;return this.#n[s]!==e[s]&&r.has(s)})})()})}#x(){const e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;const t=this.#r;this.#r=e,this.#a=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#f()}#k(e){T.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#n)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function V(e,t){return function(e,t){return!1!==k(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&J(e,t,t.refetchOnMount)}function J(e,t,s){if(!1!==k(t.enabled,e)&&"static"!==R(t.staleTime,e)){const r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&G(e,t)}return!1}function K(e,t,s,r){return(e!==t||!1===k(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&G(e,s)}function G(e,t){return!1!==k(t.enabled,e)&&e.isStaleByTime(R(t.staleTime,e))}var Y=x.createContext(!1);Y.Provider;var X=x.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),Z=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function ee(e,t,s){const r=x.useContext(Y),a=x.useContext(X),n=L(),i=n.defaultQueryOptions(e);n.getDefaultOptions().queries?._experimental_beforeQuery?.(i),i._optimisticResults=r?"isRestoring":"optimistic",(e=>{if(e.suspense){const t=e=>"static"===e?e:Math.max(e??1e3,1e3),s=e.staleTime;e.staleTime="function"==typeof s?(...e)=>t(s(...e)):t(s),"number"==typeof e.gcTime&&(e.gcTime=Math.max(e.gcTime,1e3))}})(i),((e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))})(i,a),(e=>{x.useEffect(()=>{e.clearReset()},[e])})(a);const o=!n.getQueryCache().get(i.queryHash),[c]=x.useState(()=>new t(n,i)),l=c.getOptimisticResult(i),d=!r&&!1!==e.subscribed;if(x.useSyncExternalStore(x.useCallback(e=>{const t=d?c.subscribe(T.batchCalls(e)):S;return c.updateResult(),t},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),x.useEffect(()=>{c.setOptions(i)},[i,c]),((e,t)=>e?.suspense&&t.isPending)(i,l))throw Z(i,c,a);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&void 0===e.data||P(s,[e.error,r])))({result:l,errorResetBoundary:a,throwOnError:i.throwOnError,query:n.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw l.error;if(n.getDefaultOptions().queries?._experimental_afterQuery?.(i,l),i.experimental_prefetchInRender&&!C&&((e,t)=>e.isLoading&&e.isFetching&&!t)(l,r)){const e=o?Z(i,c,a):n.getQueryCache().get(i.queryHash)?.promise;e?.catch(S).finally(()=>{c.updateResult()})}return i.notifyOnChangeProps?l:c.trackResult(l)}const te="Plantitas",se="1.0.0",re="28 de julio de 2025, 15:25",ae=()=>{const e=B(e=>e.user);return ee({queryKey:["plants",e?.id],queryFn:async()=>e?M.getUserPlantSummaries(e.id):Promise.resolve([]),enabled:!!e,staleTime:F.QUERY.STALE_TIME.MEDIUM,gcTime:F.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]},H)},ne=(e,t)=>t.some(t=>e instanceof t);let ie,oe;const ce=new WeakMap,le=new WeakMap,de=new WeakMap;let ue={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return ce.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return ge(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function he(e){ue=e(ue)}function pe(e){return(oe||(oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(fe(this),t),ge(this.request)}:function(...t){return ge(e.apply(fe(this),t))}}function me(e){return"function"==typeof e?pe(e):(e instanceof IDBTransaction&&function(e){if(ce.has(e))return;const t=new Promise((t,s)=>{const r=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",n),e.removeEventListener("abort",n)},a=()=>{t(),r()},n=()=>{s(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",n),e.addEventListener("abort",n)});ce.set(e,t)}(e),ne(e,ie||(ie=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,ue):e)}function ge(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,s)=>{const r=()=>{e.removeEventListener("success",a),e.removeEventListener("error",n)},a=()=>{t(ge(e.result)),r()},n=()=>{s(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",n)});return de.set(t,e),t}(e);if(le.has(e))return le.get(e);const t=me(e);return t!==e&&(le.set(e,t),de.set(t,e)),t}const fe=e=>de.get(e);const ye=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],xe=new Map;function ve(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(xe.get(t))return xe.get(t);const s=t.replace(/FromIndex$/,""),r=t!==s,a=be.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!ye.includes(s))return;const n=async function(e,...t){const n=this.transaction(e,a?"readwrite":"readonly");let i=n.store;return r&&(i=i.index(t.shift())),(await Promise.all([i[s](...t),a&&n.done]))[0]};return xe.set(t,n),n}he(e=>({...e,get:(t,s,r)=>ve(t,s)||e.get(t,s,r),has:(t,s)=>!!ve(t,s)||e.has(t,s)}));const we=["continue","continuePrimaryKey","advance"],je={},ke=new WeakMap,Ie=new WeakMap,Re={get(e,t){if(!we.includes(t))return e[t];let s=je[t];return s||(s=je[t]=function(...e){ke.set(this,Ie.get(this)[t](...e))}),s}};async function*Se(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;const s=new Proxy(t,Re);for(Ie.set(s,t),de.set(s,fe(t));t;)yield s,t=await(ke.get(s)||t.continue()),ke.delete(s)}function Ce(e,t){return t===Symbol.asyncIterator&&ne(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&ne(e,[IDBIndex,IDBObjectStore])}he(e=>({...e,get:(t,s,r)=>Ce(t,s)?Se:e.get(t,s,r),has:(t,s)=>Ce(t,s)||e.has(t,s)}));const Ne=new class{db=null;async init(){return this.db||(this.db=await function(e,t,{blocked:s,upgrade:r,blocking:a,terminated:n}={}){const i=indexedDB.open(e,t),o=ge(i);return r&&i.addEventListener("upgradeneeded",e=>{r(ge(i.result),e.oldVersion,e.newVersion,ge(i.transaction),e)}),s&&i.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),o.then(e=>{n&&e.addEventListener("close",()=>n()),a&&e.addEventListener("versionchange",e=>a(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("PlantCareDB",1,{upgrade(e){const t=e.createObjectStore("plants",{keyPath:"id"});t.createIndex("by-health","healthScore"),t.createIndex("by-date","dateAdded"),e.createObjectStore("images",{keyPath:"id"}),e.createObjectStore("settings",{keyPath:"key"})}})),this.db}async savePlant(e){const t=await this.init();await t.put("plants",e);const s=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(s))}async getPlant(e){const t=await this.init();return await t.get("plants",e)}async getAllPlants(){const e=await this.init();return(await e.getAll("plants")).map(e=>({...e,dateAdded:new Date(e.dateAdded),lastWatered:e.lastWatered?new Date(e.lastWatered):void 0,lastFertilized:e.lastFertilized?new Date(e.lastFertilized):void 0,images:e.images.map(e=>({...e,timestamp:new Date(e.timestamp)})),chatHistory:e.chatMessages?.map(e=>({...e,timestamp:new Date(e.timestamp)}))||[],notifications:e.notifications.map(e=>({...e,createdAt:new Date(e.createdAt)}))}))}async deletePlant(e){const t=await this.init();await t.delete("plants",e);const s=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(s))}async saveImageBlob(e,t,s){const r=await this.init();await r.put("images",{id:e,plantId:t,blob:s,timestamp:new Date})}async getImageBlob(e){const t=await this.init(),s=await t.get("images",e);return s?.blob}async saveSetting(e,t){const s=await this.init();await s.put("settings",{key:e,value:t})}async getSetting(e){const t=await this.init(),s=await t.get("settings",e);return s?.value}async exportData(){const e=await this.getAllPlants(),t={theme:await this.getSetting("theme"),notifications:await this.getSetting("notifications")};return JSON.stringify({plants:e,settings:t,exportDate:(new Date).toISOString(),version:"1.0.0"},null,2)}async importData(e){try{const t=JSON.parse(e);if(t.plants)for(const e of t.plants)await this.savePlant(e);if(t.settings)for(const[e,s]of Object.entries(t.settings))void 0!==s&&await this.saveSetting(e,s)}catch(t){throw new Error("Invalid data format")}}async clearAllData(){const e=await this.init();await e.clear("plants"),await e.clear("images"),await e.clear("settings"),localStorage.removeItem("plants")}};var Ee=({title:t,children:s,delay:r=0})=>e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*r},className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground px-4",children:t}),e.jsx("div",{className:"bg-muted/50 rounded-2xl overflow-hidden",children:s})]});const De=x.forwardRef(({className:r,...a},n)=>e.jsx(t,{className:q("peer inline-flex h-7 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...a,ref:n,children:e.jsx(s,{className:q("pointer-events-none block h-6 w-6 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));De.displayName=t.displayName;var Oe=({icon:t,label:s,value:a,onClick:n,isLast:i=!1,type:o="button",disabled:c=!1,toggleState:l=!1,onToggleChange:d})=>{const u=v.useId(),h=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-background",children:e.jsx(t,{size:18,className:"text-muted-foreground"})}),e.jsx("span",{className:"font-medium text-foreground",children:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:["button"===o&&e.jsxs(e.Fragment,{children:[a&&e.jsx("span",{className:"text-sm text-muted-foreground",children:a}),e.jsx(r,{size:16,className:"text-muted-foreground/50"})]}),"toggle"===o&&e.jsx(De,{id:u,checked:l,onCheckedChange:d,"aria-label":s})]})]}),p=q("flex w-full items-center justify-between p-3 text-left",!i&&"border-b border-background",n&&"transition-colors hover:bg-background/50");return"button"===o?e.jsx("button",{onClick:n,className:p,disabled:c,children:h}):e.jsx("label",{htmlFor:u,className:q(p,"cursor-pointer"),children:h})};const Qe=()=>{const[e,t]=x.useState(!1),{data:s=[]}=ae(),r=e=>e.toISOString().split("T")[0],a=e=>{if(null==e)return"";const t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")?`"${t.replace(/"/g,'""')}"`:t},n=async e=>{t(!0);try{const t={exportDate:(new Date).toISOString(),plantCount:s.length,plants:s.map(t=>({id:t.id,name:t.name,nickname:t.nickname,species:t.species,location:t.location,plantEnvironment:t.plantEnvironment,lightRequirements:t.lightRequirements,healthScore:t.healthScore,lastWatered:t.lastWatered?.toISOString(),...e.includeImages&&{profileImageUrl:t.profileImageUrl},...e.includeChats&&{chatHistory:[]}})),metadata:{version:"1.0.0",source:"Plant Care Companion"}},a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});i(a,`plantas-backup-${r(new Date)}.json`)}catch(a){throw new Error("Failed to export data as JSON")}finally{t(!1)}},i=(e,t)=>{const s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)};return{exportData:async e=>{if(0===s.length)throw new Error("No hay plantas para exportar");switch(e.format){case"json":return n(e);case"csv":return(async e=>{t(!0);try{const t=["ID","Nombre","Apodo","Especie","Ubicación","Ambiente","Luz Requerida","Puntuación Salud","Último Riego"];e.includeImages&&t.push("Imagen Principal");const n=[t.join(",")];s.forEach(t=>{const s=[a(t.id),a(t.name),a(t.nickname||""),a(t.species),a(t.location),a(t.plantEnvironment||""),a(t.lightRequirements||""),a(t.healthScore||""),a(t.lastWatered?r(t.lastWatered):"")];e.includeImages&&s.push(a(t.profileImageUrl||"")),n.push(s.join(","))});const o=n.join("\n"),c=new Blob([o],{type:"text/csv;charset=utf-8;"});i(c,`plantas-${r(new Date)}.csv`)}catch(n){throw new Error("Failed to export data as CSV")}finally{t(!1)}})(e);default:throw new Error("Formato de exportación no soportado")}},isExporting:e,getExportSize:()=>{const e=1024*s.length,t=e/1048576;return{plantCount:s.length,estimatedSize:t>1?`${t.toFixed(1)} MB`:`${Math.round(e/1024)} KB`}},createAutoBackup:async()=>{try{const e=localStorage.getItem("last-auto-backup"),t=(new Date).getTime(),s=6048e5;(!e||t-parseInt(e)>s)&&(await n({format:"json",includeImages:!1,includeChats:!1}),localStorage.setItem("last-auto-backup",t.toString()))}catch(e){}},availableFormats:["json","csv"]}},Te=({isOpen:t,onClose:s})=>{const[r,u]=x.useState("json"),[h,p]=x.useState(!0),[m,g]=x.useState(!1),{exportData:f,isExporting:y,getExportSize:b}=Qe(),{showSuccess:v,showError:w}=_(),{plantCount:j,estimatedSize:k}=b();return t?e.jsx(W,{children:e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs(A.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:e=>e.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(a,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"Exportar Datos"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Descarga una copia de tus datos de plantas"})]})]}),e.jsx("button",{onClick:s,disabled:y,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar modal",children:e.jsx(n,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Plantas a exportar:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:j})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Tamaño estimado:"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:k})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Formato de archivo"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>u("json"),disabled:y,className:`\n                    p-4 rounded-lg border-2 transition-all text-left\n                    ${"json"===r?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}\n                  `,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"w-5 h-5 "+("json"===r?"text-blue-600":"text-gray-500")}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium "+("json"===r?"text-blue-900 dark:text-blue-100":"text-gray-900 dark:text-gray-100"),children:"JSON"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Completo, reimportable"})]})]})}),e.jsx("button",{onClick:()=>u("csv"),disabled:y,className:`\n                    p-4 rounded-lg border-2 transition-all text-left\n                    ${"csv"===r?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}\n                  `,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"w-5 h-5 "+("csv"===r?"text-blue-600":"text-gray-500")}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium "+("csv"===r?"text-blue-900 dark:text-blue-100":"text-gray-900 dark:text-gray-100"),children:"CSV"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Para Excel/Sheets"})]})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Incluir en la exportación"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:e=>p(e.target.checked),disabled:y,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx(c,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Metadatos de imágenes"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer opacity-50",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:e=>g(e.target.checked),disabled:!0,className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx(l,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Historial de chat (próximamente)"})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-blue-800 dark:text-blue-200 font-medium mb-1",children:"Sobre la exportación"}),e.jsx("p",{className:"text-blue-700 dark:text-blue-300 leading-relaxed",children:"Los datos exportados incluyen toda la información de tus plantas: nombres, especies, cuidados, fechas de riego y ubicaciones. Las imágenes se incluyen como referencias URL."})]})]})})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end",children:[e.jsx(z,{variant:"outline",onClick:s,disabled:y,children:"Cancelar"}),e.jsxs(z,{onClick:async()=>{try{await f({format:r,includeImages:h,includeChats:m}),v("Exportación completada",`Se descargaron los datos de ${j} plantas en formato ${r.toUpperCase()}.`),s()}catch(e){w("Error en la exportación",e instanceof Error?e.message:"No se pudo completar la exportación.")}},disabled:y||0===j,loading:y,className:"flex items-center gap-2",children:[e.jsx(a,{className:"w-4 h-4"}),y?"Exportando...":"Exportar Datos"]})]})]})})}):null},Pe={User:b,LogOut:y,Sun:f,Moon:g,Bell:m,Download:a,Trash2:p,HelpCircle:h,Shield:u,Info:d};var Le=()=>{const{settingsSections:t,isExportModalOpen:s,setIsExportModalOpen:r}=(()=>{const{isDark:e,toggleTheme:t}=U(),{signOut:s,profile:r}=B(),a=$(),[n,i]=x.useState(!1),o=async()=>{if(window.confirm("¿Estás seguro de que quieres cerrar sesión?"))try{await s(),a("/auth")}catch(e){}},c=()=>{i(!0)},l=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar todos tus datos? Esta acción es irreversible."))try{await Ne.clearAllData(),await o()}catch(e){}};return{settingsSections:x.useMemo(()=>[{title:"Cuenta",items:[{id:"signout",icon:"LogOut",label:"Cerrar sesión",type:"button",onClick:o}]},{title:"Preferencias",items:[{id:"theme",icon:e?"Sun":"Moon",label:"Modo Oscuro",type:"toggle",toggleState:e,onToggleChange:t}]},{title:"Datos",items:[{id:"export",icon:"Download",label:"Exportar mis datos",type:"button",onClick:c,disabled:!r||!1},{id:"delete",icon:"Trash2",label:"Eliminar mis datos",type:"button",onClick:l,disabled:!r||!1}]},{title:"Soporte",items:[{id:"about",icon:"Info",label:"Acerca de Plantitas",value:`${te} v${se} (${re})`,onClick:()=>{},type:"button"}]}],[e,r,o,t]),isExportModalOpen:n,setIsExportModalOpen:i}})();return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Configuración"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestiona tu cuenta y preferencias de la app."})]}),t.map((t,s)=>e.jsx(Ee,{title:t.title,delay:s,children:t.items.map((s,r)=>{const a=Pe[s.icon],n=r===t.items.length-1;return"toggle"===s.type?e.jsx(Oe,{icon:a,label:s.label,isLast:n,type:"toggle",toggleState:"toggleState"in s&&s.toggleState,onToggleChange:"onToggleChange"in s?s.onToggleChange:void 0},s.id):e.jsx(Oe,{icon:a,label:s.label,value:"value"in s&&"string"==typeof s.value?s.value:void 0,onClick:"onClick"in s?s.onClick:void 0,isLast:n,type:"button",disabled:"disabled"in s&&s.disabled},s.id)})},t.title)),e.jsx(Te,{isOpen:s,onClose:()=>r(!1)})]})};export{Le as default};
//# sourceMappingURL=Settings-BjBDd8BT.js.map
