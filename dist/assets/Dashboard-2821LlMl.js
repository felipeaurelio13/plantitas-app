import{u as W,p as P,r as n,a as y,j as e,m as r,A as u,T as g,n as N,L as A,P as O}from"./index-DJn3qQTM.js";import{u as I}from"./useQuery-B5n1QGWj.js";import{C as b,a as v,b as T,c as w,d as z}from"./Card-I9waaeNI.js";import{L as B,D as k,S as l,W as E}from"./skeleton-BMAfmNZw.js";import{S as p}from"./sun-DeIF2K3R.js";import{H as F}from"./heart-C1po5BSB.js";import{S,B as L}from"./Button-CIBeVTkW.js";import{I as M}from"./Input-gtXZFX4H.js";import"./eye-Bqpe03M5.js";const D=()=>{const t=W(s=>s.user);return I({queryKey:["plants",t==null?void 0:t.id],queryFn:()=>t?P.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:1e3*60*2,gcTime:1e3*60*10,refetchOnWindowFocus:!1,refetchOnMount:!0,refetchOnReconnect:!0})},H=n.memo(({score:t})=>{const s=n.useMemo(()=>t>=80?{color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",icon:e.jsx(S,{className:"w-4 h-4 mr-1 text-green-400"}),status:"Excelente"}:t>=60?{color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",icon:e.jsx(p,{className:"w-4 h-4 mr-1 text-yellow-400"}),status:"Buena"}:{color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",icon:e.jsx(g,{className:"w-4 h-4 mr-1 text-red-400"}),status:"Atención"},[t]);return e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{className:"relative w-24 h-2 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden",children:e.jsx(r.div,{className:`absolute top-0 left-0 h-full rounded-full ${s.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}})}),e.jsxs("span",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400",children:[t,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700",children:[s.icon,e.jsx("span",{className:s.textColor,children:s.status})]})]})});H.displayName="PlantHealthIndicator";const C=n.memo(({plant:t,index:s})=>{const d=y(),{needsWatering:o,isFavorite:x}=n.useMemo(()=>{const m=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,a=t.healthScore>=80;return{needsWatering:m,isFavorite:a}},[t.lastWatered,t.wateringFrequency,t.healthScore]),c=()=>d(N.toPlantDetail(t.id)),h=Math.min(s,6);return e.jsx(r.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{delay:h*.03,duration:.3,ease:"easeOut"},whileHover:{y:-2},className:"group",children:e.jsxs(b,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:c,className:"overflow-hidden border-2 hover:border-primary-300 dark:hover:border-primary-600 transition-all duration-200 p-4 mb-4",children:[e.jsx(v,{className:"pb-2 flex-shrink-0 space-y-0",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[t.profileImageUrl?e.jsx(B,{src:t.profileImageUrl,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:e.jsx(p,{size:24})}),e.jsx(u,{children:x&&e.jsx(r.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(F,{size:12,className:"text-white fill-current"})})}),e.jsx(u,{children:o&&e.jsx(r.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(r.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:e.jsx(k,{size:12,className:"text-white"})})})})]}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsx(T,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),e.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),e.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:e.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:["📍 ",t.location]})})]})]})}),e.jsxs(w,{className:"pt-2 pb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("div",{className:"relative w-24 h-[6px] bg-[#EEE] rounded-full overflow-hidden flex-shrink-0",children:e.jsx(r.div,{className:`absolute top-0 left-0 h-full rounded-full ${t.healthScore>=80?"bg-green-400":t.healthScore>=60?"bg-yellow-300":"bg-red-300"}`,initial:{width:0},animate:{width:`${t.healthScore}%`},transition:{duration:.5,ease:"easeOut"}})}),e.jsxs("span",{className:"text-xs font-semibold text-neutral-500 dark:text-neutral-400 ml-1 min-w-[32px] text-right",children:[t.healthScore,"%"]}),e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ml-auto ${t.healthScore>=80?"bg-green-500/10 text-green-700":t.healthScore>=60?"bg-yellow-400/10 text-yellow-700":"bg-red-400/10 text-red-700"}`,style:{padding:"4px 8px"},children:[t.healthScore>=80?e.jsx(S,{className:"w-4 h-4 mr-1 text-green-400"}):t.healthScore>=60?e.jsx(p,{className:"w-4 h-4 mr-1 text-yellow-400"}):e.jsx(g,{className:"w-4 h-4 mr-1 text-red-400"}),e.jsx("span",{children:t.healthScore>=80?"Excelente":t.healthScore>=60?"Buena":"Atención"})]})]}),t.healthScore<40&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[e.jsx(g,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),e.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),e.jsx(r.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});C.displayName="PlantCard";const q=()=>e.jsxs(b,{variant:"elevated",size:"default",className:"overflow-hidden",children:[e.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[e.jsx(l,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(v,{className:"p-0",children:[e.jsx(l,{className:"h-6 w-3/4"}),e.jsx(l,{className:"h-4 w-1/2 mt-2"})]}),e.jsx(w,{className:"p-0 mt-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"w-16 h-1.5"}),e.jsx(l,{className:"w-8 h-3"})]})})]})]}),e.jsx(z,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx(l,{className:"h-4 w-1/3"}),e.jsx(l,{className:"w-8 h-8 rounded"})]})})]}),$=()=>{const t=y();return e.jsxs(r.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[e.jsxs(r.div,{className:"relative w-24 h-24 mb-6",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[e.jsx(E,{className:"absolute top-0 left-0 w-8 h-8 text-sky-400 opacity-60"}),e.jsx(A,{className:"w-24 h-24 text-green-500"}),e.jsx(k,{className:"absolute bottom-0 right-0 w-10 h-10 text-blue-400 opacity-70"})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2",children:"Tu jardín está vacío"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-sm mb-6",children:"Añade tu primera planta para empezar a monitorizar su salud y cuidados."}),e.jsxs(L,{size:"lg",onClick:()=>t(N.toCamera()),children:[e.jsx(O,{className:"mr-2"}),"Añadir Planta"]})]})},Y=()=>{const{data:t=[],isLoading:s,error:d}=D(),[o,x]=n.useState(""),[c,h]=n.useState("name"),m=n.useMemo(()=>[...t].filter(a=>a.name.toLowerCase().includes(o.toLowerCase())||a.species.toLowerCase().includes(o.toLowerCase())).sort((a,i)=>{var f,j;switch(c){case"health":return(i.healthScore||0)-(a.healthScore||0);case"lastWatered":return(((f=i.lastWatered)==null?void 0:f.getTime())||0)-(((j=a.lastWatered)==null?void 0:j.getTime())||0);default:return a.name.localeCompare(i.name)}}),[t,o,c]);return s?e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Buscando tus plantas..."})]}),e.jsx(l,{className:"h-10 w-10 rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((a,i)=>e.jsx(q,{},i))})]}):d?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"text-xl text-red-500 text-center",children:[e.jsx("p",{children:"Ocurrió un error al cargar tus plantas:"}),e.jsx("p",{className:"text-sm mt-2",children:d.message})]})}):e.jsxs("div",{className:"container-spacing element-spacing",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[e.jsx("header",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-contrast-high",children:"Mi Jardín"}),e.jsxs("p",{className:"text-contrast-medium",children:[t.length," ",t.length===1?"planta":"plantas"," en tu colección"]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 mt-6 mb-6",children:[e.jsx(M,{type:"text",placeholder:"Buscar por nombre o especie...",value:o,onChange:a=>x(a.target.value),className:"max-w-md w-full mx-auto"}),e.jsxs("div",{className:"relative w-full max-w-xs",children:[e.jsxs("select",{value:c,onChange:a=>h(a.target.value),className:"appearance-none bg-white border border-green-300 rounded-[8px] px-4 py-2 h-10 text-green-700 font-medium shadow-sm focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors duration-150 w-full pr-8",style:{borderWidth:"1px"},children:[e.jsx("option",{value:"name",children:"Ordenar por Nombre"}),e.jsx("option",{value:"health",children:"Ordenar por Salud"}),e.jsx("option",{value:"lastWatered",children:"Ordenar por Riego"})]}),e.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-green-400 text-base",children:"▼"})]})]}),e.jsx(u,{children:m.length>0?e.jsx(r.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.02}}},children:m.map((a,i)=>e.jsx(C,{plant:a,index:Math.min(i,8)},a.id))}):e.jsx($,{})})]})};export{Y as default};
