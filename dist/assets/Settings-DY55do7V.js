var ee=Object.defineProperty;var te=(t,e,n)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var I=(t,e,n)=>te(t,typeof e!="symbol"?e+"":e,n);import{c as p,i as ne,u as ie,a as se,r as h,j as a,m as oe,e as x,R as ae}from"./index-fgwvdg1Q.js";import{b as re,u as q,e as ce,c as de,P as $,d as le,T as ue}from"./index-CKzwPx0o.js";import{S as he}from"./sun-Cs3EpE-X.js";import{U as fe}from"./user-B-g-qJMQ.js";/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=p("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=p("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=p("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=p("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=p("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=p("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=p("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=p("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);class xe{constructor(){I(this,"registration",null)}async init(){if("serviceWorker"in navigator&&"Notification"in window)try{this.registration=await navigator.serviceWorker.register("/sw.js"),console.log("Service Worker registered successfully")}catch(e){console.error("Service Worker registration failed:",e)}}async requestPermission(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support notifications"),!1)}async scheduleWateringReminder(e){if(!await this.requestPermission())return;const i=new Date;i.setDate(i.getDate()+e.careProfile.wateringFrequency);const s={id:`watering-${e.id}-${Date.now()}`,type:"watering",title:`ðŸ’§ ${e.nickname||e.name} necesita agua`,message:`Es hora de regar tu ${e.species}. Â¡No olvides cuidar de tu planta!`,priority:"medium",scheduledFor:i,completed:!1};this.storeNotification(e.id,s),this.registration&&await this.registration.showNotification(s.title,{body:s.message,icon:"/plant-icon.svg",badge:"/plant-icon.svg",tag:s.id,requireInteraction:!0})}async scheduleHealthCheckReminder(e){if(!await this.requestPermission())return;const i=new Date;i.setDate(i.getDate()+7);const s={id:`health-${e.id}-${Date.now()}`,type:"health_check",title:`ðŸŒ± RevisiÃ³n de salud para ${e.nickname||e.name}`,message:`Es hora de revisar cÃ³mo estÃ¡ tu ${e.species}. Â¡Toma una foto para ver su progreso!`,priority:"low",scheduledFor:i,completed:!1};this.storeNotification(e.id,s),this.registration&&await this.registration.showNotification(s.title,{body:s.message,icon:"/plant-icon.svg",badge:"/plant-icon.svg",tag:s.id})}async sendUrgentAlert(e,n){if(!await this.requestPermission())return;const s={id:`urgent-${e.id}-${Date.now()}`,type:"general",title:`ðŸš¨ Â¡${e.nickname||e.name} necesita atenciÃ³n urgente!`,message:n,priority:"high",scheduledFor:new Date,completed:!1};this.storeNotification(e.id,s),this.registration&&await this.registration.showNotification(s.title,{body:s.message,icon:"/plant-icon.svg",badge:"/plant-icon.svg",tag:s.id,requireInteraction:!0})}storeNotification(e,n){const i=localStorage.getItem(`notifications-${e}`),s=i?JSON.parse(i):[];s.push(n),localStorage.setItem(`notifications-${e}`,JSON.stringify(s))}async getNotifications(e){const n=localStorage.getItem(`notifications-${e}`);return n?JSON.parse(n).map(s=>({...s,scheduledFor:new Date(s.scheduledFor)})):[]}async markNotificationCompleted(e){}}const ke=new xe,N=(t,e)=>e.some(n=>t instanceof n);let A,R;function De(){return A||(A=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ie(){return R||(R=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const j=new WeakMap,P=new WeakMap,k=new WeakMap;function Pe(t){const e=new Promise((n,i)=>{const s=()=>{t.removeEventListener("success",c),t.removeEventListener("error",o)},c=()=>{n(y(t.result)),s()},o=()=>{i(t.error),s()};t.addEventListener("success",c),t.addEventListener("error",o)});return k.set(e,t),e}function Ce(t){if(j.has(t))return;const e=new Promise((n,i)=>{const s=()=>{t.removeEventListener("complete",c),t.removeEventListener("error",o),t.removeEventListener("abort",o)},c=()=>{n(),s()},o=()=>{i(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",c),t.addEventListener("error",o),t.addEventListener("abort",o)});j.set(t,e)}let E={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return j.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function H(t){E=t(E)}function Ne(t){return Ie().includes(t)?function(...e){return t.apply(B(this),e),y(this.request)}:function(...e){return y(t.apply(B(this),e))}}function je(t){return typeof t=="function"?Ne(t):(t instanceof IDBTransaction&&Ce(t),N(t,De())?new Proxy(t,E):t)}function y(t){if(t instanceof IDBRequest)return Pe(t);if(P.has(t))return P.get(t);const e=je(t);return e!==t&&(P.set(t,e),k.set(e,t)),e}const B=t=>k.get(t);function Ee(t,e,{blocked:n,upgrade:i,blocking:s,terminated:c}={}){const o=indexedDB.open(t,e),d=y(o);return i&&o.addEventListener("upgradeneeded",r=>{i(y(o.result),r.oldVersion,r.newVersion,y(o.transaction),r)}),n&&o.addEventListener("blocked",r=>n(r.oldVersion,r.newVersion,r)),d.then(r=>{c&&r.addEventListener("close",()=>c()),s&&r.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),d}const Be=["get","getKey","getAll","getAllKeys","count"],Me=["put","add","delete","clear"],C=new Map;function T(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(C.get(e))return C.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=Me.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Be.includes(n)))return;const c=async function(o,...d){const r=this.transaction(o,s?"readwrite":"readonly");let l=r.store;return i&&(l=l.index(d.shift())),(await Promise.all([l[n](...d),s&&r.done]))[0]};return C.set(e,c),c}H(t=>({...t,get:(e,n,i)=>T(e,n)||t.get(e,n,i),has:(e,n)=>!!T(e,n)||t.has(e,n)}));const Oe=["continue","continuePrimaryKey","advance"],L={},M=new WeakMap,_=new WeakMap,Ae={get(t,e){if(!Oe.includes(e))return t[e];let n=L[e];return n||(n=L[e]=function(...i){M.set(this,_.get(this)[e](...i))}),n}};async function*Re(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,Ae);for(_.set(n,e),k.set(n,B(e));e;)yield n,e=await(M.get(n)||e.continue()),M.delete(n)}function F(t,e){return e===Symbol.asyncIterator&&N(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&N(t,[IDBIndex,IDBObjectStore])}H(t=>({...t,get(e,n,i){return F(e,n)?Re:t.get(e,n,i)},has(e,n){return F(e,n)||t.has(e,n)}}));class Te{constructor(){I(this,"db",null)}async init(){return this.db?this.db:(this.db=await Ee("PlantCareDB",1,{upgrade(e){const n=e.createObjectStore("plants",{keyPath:"id"});n.createIndex("by-health","healthScore"),n.createIndex("by-date","dateAdded"),e.createObjectStore("images",{keyPath:"id"}),e.createObjectStore("settings",{keyPath:"key"})}}),this.db)}async savePlant(e){await(await this.init()).put("plants",e);const i=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(i))}async getPlant(e){return await(await this.init()).get("plants",e)}async getAllPlants(){return(await(await this.init()).getAll("plants")).map(i=>({...i,dateAdded:new Date(i.dateAdded),lastWatered:i.lastWatered?new Date(i.lastWatered):void 0,lastFertilized:i.lastFertilized?new Date(i.lastFertilized):void 0,images:i.images.map(s=>({...s,timestamp:new Date(s.timestamp)})),chatHistory:i.chatHistory.map(s=>({...s,timestamp:new Date(s.timestamp)})),notifications:i.notifications.map(s=>({...s,scheduledFor:new Date(s.scheduledFor)}))}))}async deletePlant(e){await(await this.init()).delete("plants",e);const i=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(i))}async saveImageBlob(e,n,i){await(await this.init()).put("images",{id:e,plantId:n,blob:i,timestamp:new Date})}async getImageBlob(e){const i=await(await this.init()).get("images",e);return i==null?void 0:i.blob}async saveSetting(e,n){await(await this.init()).put("settings",{key:e,value:n})}async getSetting(e){const i=await(await this.init()).get("settings",e);return i==null?void 0:i.value}async exportData(){const e=await this.getAllPlants(),n={theme:await this.getSetting("theme"),notifications:await this.getSetting("notifications")};return JSON.stringify({plants:e,settings:n,exportDate:new Date().toISOString(),version:"1.0.0"},null,2)}async importData(e){try{const n=JSON.parse(e);if(n.plants)for(const i of n.plants)await this.savePlant(i);if(n.settings)for(const[i,s]of Object.entries(n.settings))s!==void 0&&await this.saveSetting(i,s)}catch{throw new Error("Invalid data format")}}async clearAllData(){const e=await this.init();await e.clear("plants"),await e.clear("images"),await e.clear("settings"),localStorage.removeItem("plants")}}const z=new Te,Le=()=>{const{isDark:t,toggleTheme:e}=ne(),{signOut:n,profile:i}=ie(),s=se(),[c,o]=h.useState(!0),d=async()=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres cerrar sesiÃ³n?"))try{await n(),s("/auth")}catch(u){console.error("Error signing out:",u)}},r=async u=>{if(u){const m=await ke.requestPermission();o(m)}else o(!1)},l=async()=>{try{const u=await z.exportData(),m=new Blob([u],{type:"application/json"}),b=URL.createObjectURL(m),g=document.createElement("a");g.href=b,g.download=`plantitas-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(b)}catch(u){console.error("Error exporting data:",u)}},f=async()=>{if(window.confirm("Â¿EstÃ¡s seguro de que quieres eliminar todos tus datos? Esta acciÃ³n es irreversible."))try{await z.clearAllData(),await d()}catch(u){console.error("Error clearing data:",u)}};return{settingsSections:h.useMemo(()=>[{title:"Cuenta",items:[{id:"profile",icon:"User",label:"Perfil",value:(i==null?void 0:i.full_name)||"Sin nombre",action:()=>{},type:"button"},{id:"logout",icon:"LogOut",label:"Cerrar SesiÃ³n",value:i==null?void 0:i.email,action:d,type:"button"}]},{title:"Preferencias",items:[{id:"theme",icon:t?"Sun":"Moon",label:"Modo Oscuro",type:"toggle",toggleState:t,onToggleChange:e},{id:"notifications",icon:"Bell",label:"Notificaciones",type:"toggle",toggleState:c,onToggleChange:r}]},{title:"Datos",items:[{id:"export",icon:"Download",label:"Exportar mis datos",action:l,type:"button"},{id:"delete",icon:"Trash2",label:"Eliminar mis datos",action:f,type:"button"}]},{title:"Soporte",items:[{id:"help",icon:"HelpCircle",label:"Ayuda y FAQ",action:()=>{},type:"button"},{id:"privacy",icon:"Shield",label:"PolÃ­tica de Privacidad",action:()=>{},type:"button"},{id:"about",icon:"Info",label:"Acerca de Plantitas",value:"v1.0.0",action:()=>{},type:"button"}]}],[t,c,i,d,e,r])}},Fe=({title:t,children:e,delay:n=0})=>a.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:"space-y-3",children:[a.jsx("h2",{className:"text-lg font-bold text-foreground px-4",children:t}),a.jsx("div",{className:"bg-muted/50 rounded-2xl overflow-hidden",children:e})]});function ze(t){const e=h.useRef({value:t,previous:t});return h.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function We(t){const[e,n]=h.useState(void 0);return re(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const i=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const c=s[0];let o,d;if("borderBoxSize"in c){const r=c.borderBoxSize,l=Array.isArray(r)?r[0]:r;o=l.inlineSize,d=l.blockSize}else o=t.offsetWidth,d=t.offsetHeight;n({width:o,height:d})});return i.observe(t,{box:"border-box"}),()=>i.unobserve(t)}else n(void 0)},[t]),e}var D="Switch",[qe,Ze]=de(D),[$e,He]=qe(D),U=h.forwardRef((t,e)=>{const{__scopeSwitch:n,name:i,checked:s,defaultChecked:c,required:o,disabled:d,value:r="on",onCheckedChange:l,form:f,...w}=t,[u,m]=h.useState(null),b=q(e,S=>m(S)),g=h.useRef(!1),O=u?f||!!u.closest("form"):!0,[v,Z]=ce({prop:s,defaultProp:c??!1,onChange:l,caller:D});return a.jsxs($e,{scope:n,checked:v,disabled:d,children:[a.jsx($.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":G(v),"data-disabled":d?"":void 0,disabled:d,value:r,...w,ref:b,onClick:le(t.onClick,S=>{Z(Y=>!Y),O&&(g.current=S.isPropagationStopped(),g.current||S.stopPropagation())})}),O&&a.jsx(K,{control:u,bubbles:!g.current,name:i,value:r,checked:v,required:o,disabled:d,form:f,style:{transform:"translateX(-100%)"}})]})});U.displayName=D;var V="SwitchThumb",J=h.forwardRef((t,e)=>{const{__scopeSwitch:n,...i}=t,s=He(V,n);return a.jsx($.span,{"data-state":G(s.checked),"data-disabled":s.disabled?"":void 0,...i,ref:e})});J.displayName=V;var _e="SwitchBubbleInput",K=h.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:i=!0,...s},c)=>{const o=h.useRef(null),d=q(o,c),r=ze(n),l=We(e);return h.useEffect(()=>{const f=o.current;if(!f)return;const w=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(w,"checked").set;if(r!==n&&m){const b=new Event("click",{bubbles:i});m.call(f,n),f.dispatchEvent(b)}},[r,n,i]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:d,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});K.displayName=_e;function G(t){return t?"checked":"unchecked"}var Q=U,Ue=J;const X=h.forwardRef(({className:t,...e},n)=>a.jsx(Q,{className:x("peer inline-flex h-7 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(Ue,{className:x("pointer-events-none block h-6 w-6 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));X.displayName=Q.displayName;const W=({icon:t,label:e,value:n,onClick:i,isLast:s=!1,type:c="button",toggleState:o=!1,onToggleChange:d})=>{const r=ae.useId(),l=a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-background",children:a.jsx(t,{size:18,className:"text-muted-foreground"})}),a.jsx("span",{className:"font-medium text-foreground",children:e})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c==="button"&&a.jsxs(a.Fragment,{children:[n&&a.jsx("span",{className:"text-sm text-muted-foreground",children:n}),a.jsx(me,{size:16,className:"text-muted-foreground/50"})]}),c==="toggle"&&a.jsx(X,{id:r,checked:o,onCheckedChange:d,"aria-label":e})]})]}),f=x("flex w-full items-center justify-between p-3 text-left",!s&&"border-b border-background",i&&"transition-colors hover:bg-background/50");return c==="button"?a.jsx("button",{onClick:i,className:f,children:l}):a.jsx("label",{htmlFor:r,className:x(f,"cursor-pointer"),children:l})},Ve={User:fe,LogOut:we,Sun:he,Moon:ve,Bell:ge,Download:ye,Trash2:ue,HelpCircle:pe,Shield:Se,Info:be},Ye=()=>{const{settingsSections:t}=Le();return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsxs("header",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"ConfiguraciÃ³n"}),a.jsx("p",{className:"text-muted-foreground",children:"Gestiona tu cuenta y preferencias de la app."})]}),t.map((e,n)=>a.jsx(Fe,{title:e.title,delay:n,children:e.items.map((i,s)=>{const c=Ve[i.icon],o=s===e.items.length-1;return i.type==="toggle"?a.jsx(W,{icon:c,label:i.label,isLast:o,type:"toggle",toggleState:i.toggleState,onToggleChange:i.onToggleChange},i.id):a.jsx(W,{icon:c,label:i.label,value:i.value||void 0,onClick:i.action,isLast:o,type:"button"},i.id)})},e.title))]})};export{Ye as default};
