var re=Object.defineProperty;var oe=(t,e,n)=>e in t?re(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var R=(t,e,n)=>oe(t,typeof e!="symbol"?e+"":e,n);import{z as S,_ as se,u as ie,a as ae,r as l,j as d,m as ce,$ as le,W as C,a0 as ue,Y as de}from"./index-DJn3qQTM.js";import{C as fe,T as he,M as pe}from"./trash-2-Bjh5UXe3.js";import{S as ge}from"./sun-DeIF2K3R.js";import{U as me}from"./user-CgNKLR_-.js";/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=S("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=S("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=S("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=S("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=S("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),D=(t,e)=>e.some(n=>t instanceof n);let O,A;function ve(){return O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ce(){return A||(A=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E=new WeakMap,j=new WeakMap,k=new WeakMap;function ke(t){const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{n(w(t.result)),o()},i=()=>{r(t.error),o()};t.addEventListener("success",s),t.addEventListener("error",i)});return k.set(e,t),e}function Ie(t){if(E.has(t))return;const e=new Promise((n,r)=>{const o=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{n(),o()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});E.set(t,e)}let N={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return E.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return w(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $(t){N=t(N)}function je(t){return Ce().includes(t)?function(...e){return t.apply(B(this),e),w(this.request)}:function(...e){return w(t.apply(B(this),e))}}function Pe(t){return typeof t=="function"?je(t):(t instanceof IDBTransaction&&Ie(t),D(t,ve())?new Proxy(t,N):t)}function w(t){if(t instanceof IDBRequest)return ke(t);if(j.has(t))return j.get(t);const e=Pe(t);return e!==t&&(j.set(t,e),k.set(e,t)),e}const B=t=>k.get(t);function De(t,e,{blocked:n,upgrade:r,blocking:o,terminated:s}={}){const i=indexedDB.open(t,e),a=w(i);return r&&i.addEventListener("upgradeneeded",c=>{r(w(i.result),c.oldVersion,c.newVersion,w(i.transaction),c)}),n&&i.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),o&&c.addEventListener("versionchange",u=>o(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const Ee=["get","getKey","getAll","getAllKeys","count"],Ne=["put","add","delete","clear"],P=new Map;function L(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P.get(e))return P.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,o=Ne.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(o||Ee.includes(n)))return;const s=async function(i,...a){const c=this.transaction(i,o?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),o&&c.done]))[0]};return P.set(e,s),s}$(t=>({...t,get:(e,n,r)=>L(e,n)||t.get(e,n,r),has:(e,n)=>!!L(e,n)||t.has(e,n)}));const Be=["continue","continuePrimaryKey","advance"],T={},M=new WeakMap,V=new WeakMap,Me={get(t,e){if(!Be.includes(e))return t[e];let n=T[e];return n||(n=T[e]=function(...r){M.set(this,V.get(this)[e](...r))}),n}};async function*Re(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const n=new Proxy(e,Me);for(V.set(n,e),k.set(n,B(e));e;)yield n,e=await(M.get(n)||e.continue()),M.delete(n)}function _(t,e){return e===Symbol.asyncIterator&&D(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&D(t,[IDBIndex,IDBObjectStore])}$(t=>({...t,get(e,n,r){return _(e,n)?Re:t.get(e,n,r)},has(e,n){return _(e,n)||t.has(e,n)}}));class Oe{constructor(){R(this,"db",null)}async init(){return this.db?this.db:(this.db=await De("PlantCareDB",1,{upgrade(e){const n=e.createObjectStore("plants",{keyPath:"id"});n.createIndex("by-health","healthScore"),n.createIndex("by-date","dateAdded"),e.createObjectStore("images",{keyPath:"id"}),e.createObjectStore("settings",{keyPath:"key"})}}),this.db)}async savePlant(e){await(await this.init()).put("plants",e);const r=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(r))}async getPlant(e){return await(await this.init()).get("plants",e)}async getAllPlants(){return(await(await this.init()).getAll("plants")).map(r=>({...r,dateAdded:new Date(r.dateAdded),lastWatered:r.lastWatered?new Date(r.lastWatered):void 0,lastFertilized:r.lastFertilized?new Date(r.lastFertilized):void 0,images:r.images.map(o=>({...o,timestamp:new Date(o.timestamp)})),chatHistory:r.chatHistory.map(o=>({...o,timestamp:new Date(o.timestamp)})),notifications:r.notifications.map(o=>({...o,scheduledFor:new Date(o.scheduledFor)}))}))}async deletePlant(e){await(await this.init()).delete("plants",e);const r=await this.getAllPlants();localStorage.setItem("plants",JSON.stringify(r))}async saveImageBlob(e,n,r){await(await this.init()).put("images",{id:e,plantId:n,blob:r,timestamp:new Date})}async getImageBlob(e){const r=await(await this.init()).get("images",e);return r==null?void 0:r.blob}async saveSetting(e,n){await(await this.init()).put("settings",{key:e,value:n})}async getSetting(e){const r=await(await this.init()).get("settings",e);return r==null?void 0:r.value}async exportData(){const e=await this.getAllPlants(),n={theme:await this.getSetting("theme"),notifications:await this.getSetting("notifications")};return JSON.stringify({plants:e,settings:n,exportDate:new Date().toISOString(),version:"1.0.0"},null,2)}async importData(e){try{const n=JSON.parse(e);if(n.plants)for(const r of n.plants)await this.savePlant(r);if(n.settings)for(const[r,o]of Object.entries(n.settings))o!==void 0&&await this.saveSetting(r,o)}catch{throw new Error("Invalid data format")}}async clearAllData(){const e=await this.init();await e.clear("plants"),await e.clear("images"),await e.clear("settings"),localStorage.removeItem("plants")}}const z=new Oe,Ae=()=>{const{isDark:t,toggleTheme:e}=se(),{signOut:n,profile:r}=ie(),o=ae(),s=async()=>{if(window.confirm("¿Estás seguro de que quieres cerrar sesión?"))try{await n(),o("/auth")}catch(u){console.error("Error signing out:",u)}},i=async()=>{try{const u=await z.exportData(),f=new Blob([u],{type:"application/json"}),h=URL.createObjectURL(f),p=document.createElement("a");p.href=h,p.download=`plantitas-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(h)}catch(u){console.error("Error exporting data:",u)}},a=async()=>{if(window.confirm("¿Estás seguro de que quieres eliminar todos tus datos? Esta acción es irreversible."))try{await z.clearAllData(),await s()}catch(u){console.error("Error clearing data:",u)}};return{settingsSections:l.useMemo(()=>[{title:"Cuenta",items:[{id:"signout",icon:"LogOut",label:"Cerrar sesión",type:"button",onClick:s}]},{title:"Preferencias",items:[{id:"theme",icon:t?"Sun":"Moon",label:"Modo Oscuro",type:"toggle",toggleState:t,onToggleChange:e}]},{title:"Datos",items:[{id:"export",icon:"Download",label:"Exportar mis datos",type:"button",onClick:i,disabled:!r||!1},{id:"delete",icon:"Trash2",label:"Eliminar mis datos",type:"button",onClick:a,disabled:!r||!1}]},{title:"Soporte",items:[]}],[t,r,s,e])}},Le=({title:t,children:e,delay:n=0})=>d.jsxs(ce.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.1},className:"space-y-3",children:[d.jsx("h2",{className:"text-lg font-bold text-foreground px-4",children:t}),d.jsx("div",{className:"bg-muted/50 rounded-2xl overflow-hidden",children:e})]});function Te(t,e,{checkForDefaultPrevented:n=!0}={}){return function(o){if(t==null||t(o),n===!1||!o.defaultPrevented)return e==null?void 0:e(o)}}function W(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function U(...t){return e=>{let n=!1;const r=t.map(o=>{const s=W(o,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let o=0;o<r.length;o++){const s=r[o];typeof s=="function"?s():W(t[o],null)}}}}function H(...t){return l.useCallback(U(...t),t)}function _e(t,e=[]){let n=[];function r(s,i){const a=l.createContext(i),c=n.length;n=[...n,i];const u=h=>{var y;const{scope:p,children:g,...m}=h,b=((y=p==null?void 0:p[t])==null?void 0:y[c])||a,x=l.useMemo(()=>m,Object.values(m));return d.jsx(b.Provider,{value:x,children:g})};u.displayName=s+"Provider";function f(h,p){var b;const g=((b=p==null?void 0:p[t])==null?void 0:b[c])||a,m=l.useContext(g);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[u,f]}const o=()=>{const s=n.map(i=>l.createContext(i));return function(a){const c=(a==null?void 0:a[t])||s;return l.useMemo(()=>({[`__scope${t}`]:{...a,[t]:c}}),[a,c])}};return o.scopeName=t,[r,ze(o,...e)]}function ze(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((a,{useScope:c,scopeName:u})=>{const h=c(s)[`__scope${u}`];return{...a,...h}},{});return l.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return n.scopeName=e.scopeName,n}var q=globalThis!=null&&globalThis.document?l.useLayoutEffect:()=>{},We=le[" useInsertionEffect ".trim().toString()]||q;function Fe({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[o,s,i]=$e({defaultProp:e,onChange:n}),a=t!==void 0,c=a?t:o;{const f=l.useRef(t!==void 0);l.useEffect(()=>{const h=f.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=a},[a,r])}const u=l.useCallback(f=>{var h;if(a){const p=Ve(f)?f(t):f;p!==t&&((h=i.current)==null||h.call(i,p))}else s(f)},[a,t,s,i]);return[c,u]}function $e({defaultProp:t,onChange:e}){const[n,r]=l.useState(t),o=l.useRef(n),s=l.useRef(e);return We(()=>{s.current=e},[e]),l.useEffect(()=>{var i;o.current!==n&&((i=s.current)==null||i.call(s,n),o.current=n)},[n,o]),[n,r,s]}function Ve(t){return typeof t=="function"}function Ue(t){const e=l.useRef({value:t,previous:t});return l.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function He(t){const[e,n]=l.useState(void 0);return q(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const s=o[0];let i,a;if("borderBoxSize"in s){const c=s.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,a=u.blockSize}else i=t.offsetWidth,a=t.offsetHeight;n({width:i,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}function qe(t){const e=Je(t),n=l.forwardRef((r,o)=>{const{children:s,...i}=r,a=l.Children.toArray(s),c=a.find(Ge);if(c){const u=c.props.children,f=a.map(h=>h===c?l.Children.count(u)>1?l.Children.only(null):l.isValidElement(u)?u.props.children:null:h);return d.jsx(e,{...i,ref:o,children:l.isValidElement(u)?l.cloneElement(u,void 0,f):null})}return d.jsx(e,{...i,ref:o,children:s})});return n.displayName=`${t}.Slot`,n}function Je(t){const e=l.forwardRef((n,r)=>{const{children:o,...s}=n;if(l.isValidElement(o)){const i=Ye(o),a=Xe(s,o.props);return o.type!==l.Fragment&&(a.ref=r?U(r,i):i),l.cloneElement(o,a)}return l.Children.count(o)>1?l.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Ke=Symbol("radix.slottable");function Ge(t){return l.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ke}function Xe(t,e){const n={...e};for(const r in e){const o=t[r],s=e[r];/^on[A-Z]/.test(r)?o&&s?n[r]=(...a)=>{const c=s(...a);return o(...a),c}:o&&(n[r]=o):r==="style"?n[r]={...o,...s}:r==="className"&&(n[r]=[o,s].filter(Boolean).join(" "))}return{...t,...n}}function Ye(t){var r,o;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(o=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:o.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var Ze=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],J=Ze.reduce((t,e)=>{const n=qe(`Primitive.${e}`),r=l.forwardRef((o,s)=>{const{asChild:i,...a}=o,c=i?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(c,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),I="Switch",[Qe,ut]=_e(I),[et,tt]=Qe(I),K=l.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:o,defaultChecked:s,required:i,disabled:a,value:c="on",onCheckedChange:u,form:f,...h}=t,[p,g]=l.useState(null),m=H(e,v=>g(v)),b=l.useRef(!1),x=p?f||!!p.closest("form"):!0,[y,te]=Fe({prop:o,defaultProp:s??!1,onChange:u,caller:I});return d.jsxs(et,{scope:n,checked:y,disabled:a,children:[d.jsx(J.button,{type:"button",role:"switch","aria-checked":y,"aria-required":i,"data-state":Z(y),"data-disabled":a?"":void 0,disabled:a,value:c,...h,ref:m,onClick:Te(t.onClick,v=>{te(ne=>!ne),x&&(b.current=v.isPropagationStopped(),b.current||v.stopPropagation())})}),x&&d.jsx(Y,{control:p,bubbles:!b.current,name:r,value:c,checked:y,required:i,disabled:a,form:f,style:{transform:"translateX(-100%)"}})]})});K.displayName=I;var G="SwitchThumb",X=l.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,o=tt(G,n);return d.jsx(J.span,{"data-state":Z(o.checked),"data-disabled":o.disabled?"":void 0,...r,ref:e})});X.displayName=G;var nt="SwitchBubbleInput",Y=l.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...o},s)=>{const i=l.useRef(null),a=H(i,s),c=Ue(n),u=He(e);return l.useEffect(()=>{const f=i.current;if(!f)return;const h=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&g){const m=new Event("click",{bubbles:r});g.call(f,n),f.dispatchEvent(m)}},[c,n,r]),d.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...o,tabIndex:-1,ref:a,style:{...o.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Y.displayName=nt;function Z(t){return t?"checked":"unchecked"}var Q=K,rt=X;const ee=l.forwardRef(({className:t,...e},n)=>d.jsx(Q,{className:C("peer inline-flex h-7 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:d.jsx(rt,{className:C("pointer-events-none block h-6 w-6 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ee.displayName=Q.displayName;const F=({icon:t,label:e,value:n,onClick:r,isLast:o=!1,type:s="button",disabled:i=!1,toggleState:a=!1,onToggleChange:c})=>{const u=ue.useId(),f=d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-background",children:d.jsx(t,{size:18,className:"text-muted-foreground"})}),d.jsx("span",{className:"font-medium text-foreground",children:e})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[s==="button"&&d.jsxs(d.Fragment,{children:[n&&d.jsx("span",{className:"text-sm text-muted-foreground",children:n}),d.jsx(fe,{size:16,className:"text-muted-foreground/50"})]}),s==="toggle"&&d.jsx(ee,{id:u,checked:a,onCheckedChange:c,"aria-label":e})]})]}),h=C("flex w-full items-center justify-between p-3 text-left",!o&&"border-b border-background",r&&"transition-colors hover:bg-background/50");return s==="button"?d.jsx("button",{onClick:r,className:h,disabled:i,children:f}):d.jsx("label",{htmlFor:u,className:C(h,"cursor-pointer"),children:f})},ot={User:me,LogOut:Se,Sun:ge,Moon:pe,Bell:be,Download:we,Trash2:he,HelpCircle:ye,Shield:xe,Info:de},dt=()=>{const{settingsSections:t}=Ae();return d.jsxs("div",{className:"p-4 space-y-6",children:[d.jsxs("header",{children:[d.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Configuración"}),d.jsx("p",{className:"text-muted-foreground",children:"Gestiona tu cuenta y preferencias de la app."})]}),t.map((e,n)=>d.jsx(Le,{title:e.title,delay:n,children:e.items.map((r,o)=>{const s=ot[r.icon],i=o===e.items.length-1;return r.type==="toggle"?d.jsx(F,{icon:s,label:r.label,isLast:i,type:"toggle",toggleState:"toggleState"in r?r.toggleState:!1,onToggleChange:"onToggleChange"in r?r.onToggleChange:void 0},r.id):d.jsx(F,{icon:s,label:r.label,value:"value"in r&&typeof r.value=="string"?r.value:void 0,onClick:"onClick"in r?r.onClick:void 0,isLast:i,type:"button",disabled:"disabled"in r?r.disabled:!1},r.id)})},e.title))]})};export{dt as default};
