import{j as e,A as a,h as t,i as r,k as s,f as i,l as n,m as l,U as o,d,n as c,o as u,T as m,a as x,c as h,p,q as g,r as f,s as y,M as b}from"./ui-wPK-3RQ8.js";import{r as v,a as j}from"./vendor-B7436CdZ.js";import{n as w,m as N,A as k,c as C,a as z,u as L}from"./index-CIXUsfK_.js";import{a as M}from"./router-CZ3lJY9Y.js";import{b as P,a as W,d as S,e as A,f as T}from"./utils-CRBKYUSN.js";import"../node_modules/lucide-react/dist/esm/icons/inspection-panel.js";import"../node_modules/lucide-react/dist/esm/icons/test-tube-diagonal.js";import"../node_modules/lucide-react/dist/esm/icons/test-tube.js";import"../node_modules/lucide-react/dist/esm/icons/test-tubes.js";import"./firebase-xL_IlaqF.js";import"../node_modules/motion-dom/dist/es/value/types/test.mjs";var D=()=>e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Diagnósticos del Sistema"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sistema funcionando correctamente"})]});var R=({gardenSummary:l,onClearChat:o,onRefresh:d,isRefreshing:c=!1})=>{const u=M(),[m,x]=v.useState(!1);return e.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[e.jsx("button",{onClick:()=>u(w.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:e.jsx(a,{size:20})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:e.jsx(t,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardín"}),l&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(r,{size:12}),l.totalPlants," plantas"]}),e.jsx("span",{className:`font-medium ${h=l.averageHealth,h>=80?"text-green-500":h>=60?"text-green-400":"text-red-500"} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:(e=>e>=80?"Excelente":e>=60?"Buena":"Necesita atención")(l.averageHealth)}),l.urgentActions>0&&e.jsxs(N.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[l.urgentActions," acciones"]})]})]})]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>x(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnóstico del sistema",children:e.jsx(s,{size:18})}),d&&e.jsx("button",{onClick:d,disabled:c,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardín",children:e.jsx(N.div,{animate:c?{rotate:360}:{},transition:c?{duration:1,repeat:1/0,ease:"linear"}:{},children:e.jsx(i,{size:18})})}),e.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:e.jsx(n,{size:20})})]})]}),e.jsx(k,{children:m&&e.jsx(D,{})})]});var h},H={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},B={date:P({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},defaultWidth:"full"}),time:P({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:P({formats:{full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},F={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},I={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},_={code:"es",formatDistance:function(e,a,t){var r,s=H[e];return r="string"==typeof s?s:1===a?s.one:s.other.replace("{{count}}",a.toString()),null!=t&&t.addSuffix?t.comparison&&t.comparison>0?"en "+r:"hace "+r:r},formatLong:B,formatRelative:function(e,a,t,r){return 1!==a.getUTCHours()?I[e]:F[e]},localize:{ordinalNumber:function(e,a){return Number(e)+"º"},era:W({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},defaultWidth:"wide"}),quarter:W({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:W({values:{narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},defaultWidth:"wide"}),day:W({values:{narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},defaultWidth:"wide"}),dayPeriod:W({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:A({matchPattern:/^(\d+)(º)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}}),era:S({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},defaultParseWidth:"any"}),quarter:S({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:S({matchPatterns:{narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},defaultParseWidth:"any"}),day:S({matchPatterns:{narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:S({matchPatterns:{narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},defaultParseWidth:"any"})},options:{weekStartsOn:1,firstWeekContainsDate:1}};var E=({message:a})=>{const t="user"===a.sender;return e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:C("flex items-end gap-2 max-w-[85%]",t?"justify-end ml-auto":"justify-start"),children:[!t&&e.jsx(N.div,{className:C("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:e.jsx("div",{className:(()=>{if(t)return"text-primary-foreground/70";if(!a.context?.queryType)return"text-green-500";switch(a.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}})(),children:(()=>{if(!a.context?.queryType)return e.jsx(d,{size:16});switch(a.context.queryType){case"health_analysis":return e.jsx(m,{size:16});case"care_comparison":return e.jsx(l,{size:16});case"disease_prevention":return e.jsx(u,{size:16});case"growth_tracking":return e.jsx(c,{size:16});default:return e.jsx(d,{size:16})}})()})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:C("rounded-2xl px-4 py-3 break-words shadow-adaptive",t?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[e.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:a.content}),a.context?.insights&&a.context.insights.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),e.jsx("ul",{className:"space-y-1",children:a.context.insights.map((a,t)=>e.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"font-medium",children:["warning"===a.type&&"⚠️ ","tip"===a.type&&"💡 ","recommendation"===a.type&&"🌱 ","observation"===a.type&&"🔎 ",a.title]}),e.jsx("div",{children:a.description}),a.affectedPlants&&a.affectedPlants.length>0&&e.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",a.affectedPlants.join(", ")]})]},t))})]}),a.context?.suggestedActions&&a.context.suggestedActions.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),e.jsx("ul",{className:"space-y-1",children:a.context.suggestedActions.map((a,t)=>e.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"font-medium",children:a.action}),a.priority&&e.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",a.priority]}),a.plantIds&&a.plantIds.length>0&&e.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",a.plantIds.join(", ")]})]},t))})]}),!t&&a.context?.plantsAnalyzed&&a.context.plantsAnalyzed.length>0&&e.jsxs(N.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[e.jsx(l,{size:12}),e.jsxs("span",{children:["Analizó ",a.context.plantsAnalyzed.length," planta(s)"]})]}),e.jsx("div",{className:C("mt-2 text-xs",t?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:T(new Date(a.timestamp),{addSuffix:!0,locale:_})})]})}),t&&e.jsx(N.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:e.jsx(o,{size:16,className:"text-primary"})})]})};const Q=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,X=z,V=(e,a)=>t=>{var r;if(null==(null==a?void 0:a.variants))return X(e,null==t?void 0:t.class,null==t?void 0:t.className);const{variants:s,defaultVariants:i}=a,n=Object.keys(s).map(e=>{const a=null==t?void 0:t[e],r=null==i?void 0:i[e];if(null===a)return null;const n=Q(a)||Q(r);return s[e][n]}),l=t&&Object.entries(t).reduce((e,a)=>{let[t,r]=a;return void 0===r||(e[t]=r),e},{}),o=null==a||null===(r=a.compoundVariants)||void 0===r?void 0:r.reduce((e,a)=>{let{class:t,className:r,...s}=a;return Object.entries(s).every(e=>{let[a,t]=e;return Array.isArray(t)?t.includes({...i,...l}[a]):{...i,...l}[a]===t})?[...e,t,r]:e},[]);return X(e,n,o,null==t?void 0:t.class,null==t?void 0:t.className)},Y=V("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),O=j.forwardRef(({className:a,variant:t,size:r,fullWidth:s,loading:i=!1,leftIcon:n,rightIcon:l,children:o,disabled:d,...c},u)=>{const m=d||i;return e.jsxs(N.button,{whileTap:m?void 0:{scale:.96},whileHover:m?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:C(Y({variant:t,size:r,fullWidth:s,className:a})),disabled:m,ref:u,...c,children:[i&&e.jsx(N.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),n&&!i&&e.jsx("span",{className:"mr-2 -ml-1",children:n}),e.jsx("span",{className:C("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(e=>"string"==typeof e||"number"==typeof e||j.isValidElement(e)):"string"==typeof o||"number"==typeof o||j.isValidElement(o)?o:null}),l&&e.jsx("span",{className:"ml-2 -mr-1",children:l})]})});O.displayName="Button";const q=V("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Z=j.forwardRef(({className:a,variant:t,size:r,state:s,label:i,helperText:n,errorMessage:o,successMessage:d,leftIcon:c,rightIcon:u,loading:m=!1,showPasswordToggle:g=!1,floatingLabel:f=!1,type:y,disabled:b,value:j,defaultValue:w,...z},L)=>{const[M,P]=v.useState(!1),[W,S]=v.useState(!1),[A,T]=v.useState(j||w||""),D=v.useRef(null),R=v.useCallback(e=>{D.current=e,"function"==typeof L?L(e):L&&(L.current=e)},[L]),H=o?"error":d?"success":s,B=Boolean(A)||M,F=g?W?"text":"password":y;v.useEffect(()=>{void 0!==j&&T(j)},[j]);return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative",children:[i&&!f&&e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),e.jsxs("div",{className:"relative",children:[c&&e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:c}),i&&f&&e.jsx(N.label,{onClick:()=>{D.current?.focus()},animate:{scale:B?.85:1,y:B?-24:0,x:B?4:c?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:C("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",B&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),e.jsx("input",{ref:R,type:F,value:A,disabled:b||m,className:C(q({variant:t,size:r,state:H}),c&&"pl-10",(u||g||m)&&"pr-10",f&&B&&"pt-6 pb-2",(!r||"default"===r)&&"py-[12px]","placeholder-[#777]",a),style:{...z.style},onFocus:e=>{P(!0),z.onFocus?.(e)},onBlur:e=>{P(!1),z.onBlur?.(e)},onChange:e=>{T(e.target.value),z.onChange?.(e)},...z}),e.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[m&&e.jsx(N.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:e.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!m&&"error"===H&&e.jsx(x,{className:"w-4 h-4 text-error-500"}),!m&&"success"===H&&e.jsx(h,{className:"w-4 h-4 text-success-500"}),g&&!m&&e.jsx("button",{type:"button",onClick:()=>S(!W),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:W?e.jsx(p,{className:"w-4 h-4"}):e.jsx(l,{className:"w-4 h-4"})}),u&&!m&&e.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:u})]})]}),e.jsx(k,{children:M&&e.jsx(N.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:C("absolute inset-0 rounded-xl pointer-events-none","error"===H&&"ring-2 ring-error-500/20","success"===H&&"ring-2 ring-success-500/20","default"===H&&"ring-2 ring-primary-500/20")})})]}),e.jsx(k,{mode:"wait",children:(n||o||d)&&e.jsxs(N.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[o&&e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),e.jsx("span",{className:"text-error-600 dark:text-error-400",children:o})]}),d&&!o&&e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),e.jsx("span",{className:"text-success-600 dark:text-success-400",children:d})]}),n&&!o&&!d&&e.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:n})]})})]})});Z.displayName="Input";var G=({onSendMessage:a,isTyping:t,suggestedQuestions:r,isLoading:s=!1})=>{const[i,n]=v.useState(""),[l,o]=v.useState(!0),d=v.useRef(null),c=async()=>{if(t)return;const e=d.current?.value.trim();e&&(o(!1),d.current&&(d.current.value=""),await a(e))};return e.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:e.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[e.jsx(k,{children:l&&r.length>0&&!s&&e.jsxs(N.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(g,{size:12}),e.jsx("span",{children:"Preguntas sugeridas"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((r,s)=>e.jsx(N.button,{onClick:()=>(async e=>{n(""),o(!1),await a(e)})(r),disabled:t,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.1*s},whileHover:{scale:1.02},whileTap:{scale:.98},children:r},r))})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Z,{type:"text",ref:d,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c())},onFocus:()=>{r.length>0&&!i&&o(!0)},placeholder:"Pregúntame sobre tu jardín...",className:"pr-12",disabled:t||s}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:e.jsx(f,{size:16})})]}),e.jsx(O,{"aria-label":"Enviar mensaje",onClick:c,disabled:!i.trim()||t||s,size:"icon",className:"shrink-0",children:t?e.jsx(N.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(g,{size:20})}):e.jsx(y,{size:20})})]}),s&&e.jsxs(N.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[e.jsx(N.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(g,{size:12})}),e.jsx("span",{children:"Analizando tu jardín..."})]})]})})};var K=()=>{const a={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return e.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:"🌱"}),e.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[e.jsx(N.div,{variants:a,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),e.jsx(N.div,{variants:a,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),e.jsx(N.div,{variants:a,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})};const U={plants:e.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:e.jsxs(N.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[e.jsx(N.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),e.jsx(N.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:e.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),e.jsx(N.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:e.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),e.jsx(N.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:e.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:e.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:e.jsxs(N.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[e.jsx(N.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),e.jsx(N.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),e.jsx(N.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),e.jsx(N.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:e.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:e.jsxs(N.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[e.jsx(N.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),e.jsx(N.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),e.jsxs(N.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[e.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),e.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),e.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:e.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:e.jsxs(N.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[e.jsx(N.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),e.jsx(N.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),e.jsx(N.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),e.jsx(N.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:e.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:e.jsxs(N.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[e.jsxs(N.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[e.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),e.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),e.jsxs(N.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[e.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),e.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},$=({icon:a,title:t,description:r,action:s,illustration:i="plants",className:n})=>e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:C("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",n),children:[e.jsx(N.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:a||U[i]}),e.jsx(N.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:t}),e.jsx(N.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),s&&e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:e.jsx(O,{onClick:s.onClick,variant:"primary",size:"lg",className:"animate-glow",children:s.label})})]}),J=V("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),ee=j.forwardRef(({className:a,variant:t,size:r,radius:s,interactive:i,hover:n=!1,loading:l=!1,children:o,ariaLabel:d,...c},u)=>e.jsx(N.div,{whileHover:i&&!l?{scale:n?1.02:1.01,y:n?-4:-2}:void 0,whileTap:i&&!l?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:C(J({variant:t,size:r,radius:s,interactive:i}),l&&"animate-pulse",a),ref:u,...c,children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),e.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));ee.displayName="Card";j.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:C("flex flex-col space-y-1.5 pb-4",a),...t})).displayName="CardHeader";j.forwardRef(({className:a,...t},r)=>e.jsx("h3",{ref:r,className:C("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",a),...t})).displayName="CardTitle";j.forwardRef(({className:a,...t},r)=>e.jsx("p",{ref:r,className:C("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",a),...t})).displayName="CardDescription";const ae=j.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:C("",a),...t}));ae.displayName="CardContent";j.forwardRef(({className:a,...t},r)=>e.jsx("div",{ref:r,className:C("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",a),...t})).displayName="CardFooter";var te=()=>{const a=M(),r=L(e=>e.plants),{messages:s,isLoading:n,sendMessage:l}=(()=>{const[e,a]=v.useState(!1);return{messages:[],isLoading:e,sendMessage:async e=>(a(!0),await new Promise(e=>setTimeout(e,1e3)),a(!1),{content:"Respuesta simulada del jardín AI"}),refreshData:async()=>{}}})(),o=v.useRef(null);return v.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[s,isTyping]),error&&!gardenSummary?e.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[e.jsx(R,{gardenSummary:gardenSummary}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[e.jsx(x,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexión"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:error}),e.jsxs(O,{onClick:refreshGardenData,variant:"primary",children:[e.jsx(i,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]}):0===gardenSummary?.totalPlants?e.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[e.jsx(R,{gardenSummary:gardenSummary}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx($,{illustration:"plants",title:"Tu jardín está vacío",description:"Agrega algunas plantas a tu jardín para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>a(w.toCamera())}})})]}):e.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[e.jsx(R,{gardenSummary:gardenSummary,onClearChat:clearMessages,onRefresh:refreshGardenData,isRefreshing:n&&s.length>0}),0===s.length&&r.length>0&&e.jsxs("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:[e.jsx("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Chats individuales con tus plantas:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.slice(0,4).map(r=>e.jsx(ee,{variant:"glass",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary-300 dark:hover:border-primary-600",onClick:()=>a(w.toPlantChat(r.id)),children:e.jsx(ae,{className:"p-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:e.jsx(t,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:r.nickname||r.name}),e.jsx("p",{className:"text-xs text-neutral-500 truncate",children:r.species})]}),e.jsx(b,{className:"w-4 h-4 text-neutral-400"})]})})},r.id)),r.length>4&&e.jsx(ee,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer",onClick:()=>a(w.toDashboard()),children:e.jsx(ae,{className:"p-3 flex items-center justify-center",children:e.jsxs("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["+",r.length-4," más"]})})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[e.jsxs("div",{className:"p-4 space-y-4 max-w-4xl mx-auto",children:[e.jsx(k,{children:s.map(a=>e.jsx(E,{message:a},a.id))}),isTyping&&e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:e.jsx(K,{})}),error&&s.length>0&&e.jsx(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-center",children:e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 max-w-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300 text-sm",children:[e.jsx(x,{size:16}),e.jsx("span",{children:error})]}),e.jsxs(O,{onClick:retryLastMessage,size:"sm",variant:"outline",className:"mt-2 w-full",children:[e.jsx(i,{size:14,className:"mr-1"}),"Reintentar"]})]})}),e.jsx("div",{ref:o})]}),!1]}),e.jsx(G,{onSendMessage:l,isTyping:isTyping,suggestedQuestions:suggestedQuestions,isLoading:n})]})};export{te as default};
