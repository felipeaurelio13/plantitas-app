import{B as v,r as g,j as e,m as x,u as b,D as I,R as y,c as j}from"./index-DrqidrQV.js";import{B as M}from"./Button-vPdajJSs.js";import{u as N}from"./usePlantMutations-D_qInL8k.js";import{a as A}from"./usePlantDetail-DmKFgZ8W.js";import{A as z}from"./Card-DtKCPuc5.js";/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=v("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=v("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=v("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),D=(a,{onIntersect:i,threshold:s=0,rootMargin:c="0px",once:n=!0})=>{g.useEffect(()=>{const r=a.current;if(!r)return;const t=new IntersectionObserver(([l])=>{l.isIntersecting&&(i(),n&&t.unobserve(r))},{threshold:s,rootMargin:c});return t.observe(r),()=>{t.unobserve(r)}},[a,i,s,c,n])},B=({src:a,alt:i,className:s="",placeholder:c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjNmNGY2Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzlDQTNBRiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+",onLoad:n,onError:r})=>{const[t,l]=g.useState(!1),[o,d]=g.useState(!1),[u,p]=g.useState(!1),m=g.useRef(null);D(m,{onIntersect:()=>p(!0),threshold:.1});const h=()=>{l(!0),n==null||n()},f=()=>{d(!0),r==null||r()};return e.jsxs("div",{ref:m,className:`relative overflow-hidden ${s}`,children:[!t&&!o&&e.jsx(x.img,{src:c,alt:"",className:"w-full h-full object-cover filter blur-sm",initial:{opacity:1},animate:{opacity:u?.5:1}}),u&&!o&&e.jsx(x.img,{src:a,alt:i,className:"w-full h-full object-cover",onLoad:h,onError:f,initial:{opacity:0},animate:{opacity:t?1:0},transition:{duration:.3}}),o&&e.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 mx-auto mb-2 text-gray-400",children:e.jsx("svg",{fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Error loading image"})]})}),u&&!t&&!o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-800",children:e.jsx("div",{className:"w-6 h-6 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"})})]})},L=({plant:a,variant:i="primary",size:s="sm",showLabel:c=!0,className:n=""})=>{const{updatePlantHealthMutation:r,isUpdatingPlantHealth:t}=N(),l=b(h=>h.user),{addToast:o}=I(),{plant:d}=A(a.id),u=async()=>{if(!(l!=null&&l.id)){o({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnóstico"});return}if(!d){o({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log("🩺 [Button] Actualizando diagnóstico para:",a.name),r({plant:d,userId:l.id})},p=e.jsxs(e.Fragment,{children:[t?e.jsx(x.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:e.jsx(y,{size:s.includes("icon")?16:14})}):e.jsx(z,{size:s.includes("icon")?16:14}),c&&!s.includes("icon")&&e.jsx("span",{className:"ml-2 text-xs",children:t?"Analizando...":"Analizar"})]}),m=s.includes("icon");return e.jsx(M,{onClick:u,disabled:t||!d,size:s,variant:i,className:n,"aria-label":m?`Actualizar diagnóstico de salud para ${a.name}`:void 0,title:m?`Actualizar diagnóstico de salud para ${a.name}`:void 0,children:p})};function W({className:a,...i}){return e.jsx("div",{className:j("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",a),...i})}export{w as D,B as L,C as M,W as S,L as U,P as W};
