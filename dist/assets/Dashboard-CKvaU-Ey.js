import{c as B,r as l,u as f,j as e,m as i,A as g,T as D,n as j,a as F,t as H,P as w,b as O,L as T}from"./index-IWlstUSv.js";import{C as k,a as C,b as U,c as S,d as I,M as $}from"./Card-C-20Zba6.js";import{L as R,U as Q,S as h,W as G}from"./skeleton-By94OR74.js";import{B as L,S as J}from"./Button-DJtJhVfV.js";import{S as W}from"./sun-BGxn3_Au.js";import{H as _}from"./heart-B4hyXJDK.js";import{u as q,C as K,I as V}from"./usePlantMutations-BJp3ryRm.js";import{L as X}from"./usePlantDetail-DLl7IC-K.js";import{I as Y}from"./Input-DHfS_pDa.js";import"./index-Bnwr932r.js";import"./eye-BR_0WJm5.js";/**
 * @license lucide-react v0.411.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=B("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]),z=l.memo(({score:a})=>{const r=l.useMemo(()=>a>=80?{color:"bg-success-500",textColor:"text-success-600 dark:text-success-400",emoji:"🌱",status:"Excelente"}:a>=60?{color:"bg-warning-500",textColor:"text-warning-600 dark:text-warning-400",emoji:"🌿",status:"Bien"}:{color:"bg-error-500",textColor:"text-error-600 dark:text-error-400",emoji:"🥺",status:"Necesita cuidados"},[a]);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative w-20 h-2 bg-neutral-200 dark:bg-neutral-700 rounded-full overflow-hidden",children:[e.jsx(i.div,{className:`absolute top-0 left-0 h-full rounded-full ${r.color}`,initial:{width:0},animate:{width:`${a}%`},transition:{duration:.5,ease:"easeOut"}}),a>=90&&e.jsx(i.div,{className:"absolute inset-0 flex items-center justify-center",initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:3,repeat:1/0},children:e.jsx(J,{size:8,className:"text-white"})})]}),e.jsxs("span",{className:F("text-xs font-semibold",r.textColor),children:[a,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("span",{children:r.emoji}),e.jsx("span",{className:r.textColor,children:r.status})]})]})});z.displayName="PlantHealthIndicator";const P=l.memo(({plant:a,index:r})=>{const n=f(),{isFavorite:c}=l.useMemo(()=>({isFavorite:a.healthScore>=80}),[a.healthScore]),d=()=>n(j.toPlantDetail(a.id)),m=s=>{s.stopPropagation(),n(j.toPlantChat(a.id))},u=Math.min(r,6);return e.jsx(i.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{delay:u*.03,duration:.3,ease:"easeOut"},whileHover:{y:-2},className:"group h-full",children:e.jsxs(k,{variant:"glass",size:"default",radius:"lg",interactive:!0,hover:!0,onClick:d,className:"h-full overflow-hidden border-2 hover:border-primary-300 dark:hover:border-primary-600 transition-all duration-200 flex flex-col radius",children:[e.jsx(C,{className:"content-spacing-sm pb-2 flex-shrink-0",children:e.jsxs("div",{className:"flex items-start space-x-3 sm:space-x-4",children:[e.jsxs("div",{className:"relative w-16 h-16 sm:w-18 sm:h-18 radius overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[a.profileImageUrl?e.jsx(R,{src:a.profileImageUrl,alt:a.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:e.jsx(W,{size:24,className:"sm:w-6 sm:h-6"})}),e.jsx(g,{children:c&&e.jsx(i.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 sm:w-7 sm:h-7 bg-error-500 radius-full flex items-center justify-center shadow-prominent",children:e.jsx(_,{size:12,className:"sm:w-3 sm:h-3 text-white fill-current"})})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(U,{className:"text-heading-4 text-neutral-900 dark:text-neutral-100 truncate mb-1 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:a.nickname||a.name,children:a.nickname||a.name}),a.nickname&&e.jsx("p",{className:"text-xs text-neutral-500 dark:text-neutral-400 truncate mb-1",title:a.name,children:a.name}),e.jsx("p",{className:"text-body-small text-neutral-600 dark:text-neutral-400 truncate mb-2",title:a.species,children:a.species}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 radius-sm text-caption text-neutral-600 dark:text-neutral-400",children:["📍 ",a.location]})})]})]})}),e.jsx(S,{className:"content-spacing-sm flex-1",children:e.jsxs("div",{className:"element-spacing-sm",children:[e.jsx("div",{className:"mb-2",children:e.jsx(z,{score:a.healthScore})}),a.healthScore<40&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[e.jsx(D,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),e.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]}),e.jsxs("div",{className:"flex items-center justify-between text-caption text-neutral-500 dark:text-neutral-400 mt-2 mb-2",children:[e.jsx("span",{children:"Salud general"}),e.jsx("span",{className:"font-medium",children:a.healthScore>=80?"Excelente":a.healthScore>=60?"Buena":a.healthScore>=40?"Regular":"Necesita atención"})]})]})}),e.jsx(I,{className:"content-spacing-sm bg-neutral-50/80 dark:bg-neutral-900/50 backdrop-blur-sm border-t border-neutral-200/50 dark:border-neutral-700/50 flex-shrink-0 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("div",{className:"text-caption text-neutral-500 dark:text-neutral-400",children:a.healthScore>=80?"🌱 Saludable":a.healthScore>=60?"🌿 Bien":a.healthScore>=40?"🍃 Regular":"🥺 Necesita atención"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{plant:a,variant:"ghost",size:"icon-sm",showLabel:!1,className:"opacity-70 hover:opacity-100 transition-opacity"}),e.jsx(L,{size:"sm",variant:"ghost",onClick:m,className:"opacity-70 hover:opacity-100 transition-opacity","aria-label":`Chatear con ${a.nickname||a.name}`,children:e.jsx($,{size:16,className:"sm:w-4 sm:h-4"})})]})]})}),e.jsx(i.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});P.displayName="PlantCard";const ee=()=>e.jsxs(k,{variant:"elevated",size:"default",className:"overflow-hidden",children:[e.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[e.jsx(h,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(C,{className:"p-0",children:[e.jsx(h,{className:"h-6 w-3/4"}),e.jsx(h,{className:"h-4 w-1/2 mt-2"})]}),e.jsx(S,{className:"p-0 mt-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-16 h-1.5"}),e.jsx(h,{className:"w-8 h-3"})]})})]})]}),e.jsx(I,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx(h,{className:"h-4 w-1/3"}),e.jsx(h,{className:"w-8 h-8 rounded"})]})})]}),ae=()=>{const[a,r]=l.useState(!1),n=f(),{createPlant:c,isCreatingPlant:d}=q();l.useEffect(()=>{const s=t=>{t.key==="Escape"&&r(!1)};return a&&document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[a]);const m=[{id:"camera",icon:K,label:"Tomar Foto",color:"bg-blue-500",action:()=>{r(!1),n(j.toCamera())}},{id:"gallery",icon:V,label:"Galería",color:"bg-purple-500",action:()=>u()}],u=l.useCallback(()=>{const s=document.createElement("input");s.type="file",s.accept="image/*",s.onchange=async t=>{var y;const o=(y=t.target.files)==null?void 0:y[0];if(o){const b=new FileReader;b.onload=async A=>{var N;const v=(N=A.target)==null?void 0:N.result;if(v){r(!1);const E=new Promise((p,M)=>{c({imageDataUrl:v,location:"Interior"},{onSuccess:x=>{x!=null&&x.id&&n(j.toPlantDetail(x.id)),p(x)},onError:x=>{console.error("Failed to create plant:",x),M(x)}})});H.promise(E,{loading:"Analizando imagen... La IA está trabajando.",success:p=>`¡Planta "${p.name}" creada con éxito!`,error:p=>`Error: ${p.message}`})}},b.readAsDataURL(o)}},s.click()},[c,n]);return e.jsxs(e.Fragment,{children:[e.jsx(i.button,{onClick:()=>r(!a),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:d?1:1.05},whileTap:{scale:d?1:.95},disabled:d,"aria-label":a?"Cerrar menú":"Agregar planta","aria-expanded":a,children:e.jsx(g,{mode:"wait",children:d?e.jsx(i.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:e.jsx(X,{className:"w-6 h-6 animate-spin"})},"loading"):e.jsx(i.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:a?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:e.jsx(w,{className:"w-6 h-6"})},"plus")})}),e.jsx(g,{children:a&&e.jsx(i.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:m.map((s,t)=>e.jsxs(i.button,{onClick:s.action,className:`w-12 h-12 ${s.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:t*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(m.length-t)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":s.label,children:[e.jsx(s.icon,{className:"w-5 h-5"}),e.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:e.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[s.label,e.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},s.id))})}),e.jsx(g,{children:a&&e.jsx(i.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>r(!1)})})]})},se=()=>{const a=f();return e.jsxs(i.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[e.jsxs(i.div,{className:"relative w-24 h-24 mb-6",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[e.jsx(G,{className:"absolute top-0 left-0 w-8 h-8 text-sky-400 opacity-60"}),e.jsx(T,{className:"w-24 h-24 text-green-500"}),e.jsx(Z,{className:"absolute bottom-0 right-0 w-10 h-10 text-blue-400 opacity-70"})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 mb-2",children:"Tu jardín está vacío"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-sm mb-6",children:"Añade tu primera planta para empezar a monitorizar su salud y cuidados."}),e.jsxs(L,{size:"lg",onClick:()=>a(j.toCamera()),children:[e.jsx(w,{className:"mr-2"}),"Añadir Planta"]})]})},ue=()=>{const{data:a=[],isLoading:r,error:n}=O(),[c,d]=l.useState(""),[m,u]=l.useState("name"),s=l.useMemo(()=>!a||a.length===0?[]:[...a].filter(t=>t.name.toLowerCase().includes(c.toLowerCase())||t.species.toLowerCase().includes(c.toLowerCase())).sort((t,o)=>{switch(m){case"health":return(o.healthScore||0)-(t.healthScore||0);default:return t.name.localeCompare(o.name)}}),[a,c,m]);return r&&a.length===0?e.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Buscando tus plantas..."})]}),e.jsx(h,{className:"h-10 w-10 rounded-full"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((t,o)=>e.jsx(ee,{},o))})]}):n?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsxs("div",{className:"text-xl text-red-500 text-center",children:[e.jsx("p",{children:"Ocurrió un error al cargar tus plantas:"}),e.jsx("p",{className:"text-sm mt-2",children:n.message})]})}):e.jsxs("div",{className:"container-spacing element-spacing",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-heading-2 text-contrast-high",children:"Mi Jardín"}),e.jsxs("p",{className:"text-caption text-contrast-medium",children:[a.length," ",a.length===1?"planta":"plantas"," en tu colección"]})]}),e.jsx(ae,{})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row element-spacing-sm",children:[e.jsx(Y,{type:"text",placeholder:"Buscar por nombre o especie...",value:c,onChange:t=>d(t.target.value),className:"flex-grow"}),e.jsxs("select",{value:m,onChange:t=>u(t.target.value),className:"bg-contrast-surface border border-contrast radius-sm px-3 py-2 h-10 text-contrast-medium focus-contrast text-ui",children:[e.jsx("option",{value:"name",children:"Ordenar por Nombre"}),e.jsx("option",{value:"health",children:"Ordenar por Salud"})]})]}),e.jsx(g,{children:s.length>0?e.jsx(i.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.02}}},children:s.map((t,o)=>e.jsx(P,{plant:t,index:Math.min(o,8)},t.id))}):e.jsx(se,{})})]})};export{ue as default};
