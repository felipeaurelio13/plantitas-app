const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Settings-Df0fELxP.js","assets/js/query-DbrUQU2d.js","assets/js/vendor-DZ-WnDgw.js","assets/js/router-8pqLaH9a.js","assets/js/ui-DPEBMuFB.js","assets/js/supabase-pWErzozG.js","assets/js/Auth-By8LHb_Y.js"])))=>i.map(i=>d[i]);
var Hk=Object.defineProperty;var Wk=(t,e,r)=>e in t?Hk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var yr=(t,e,r)=>Wk(t,typeof e!="symbol"?e+"":e,r);import{j as d,u as fd,a as Ti,b as G_,Q as Y_,c as Z_}from"./query-DbrUQU2d.js";import{a as fp,b as H,r as w,c as qk,g as Hi}from"./vendor-DZ-WnDgw.js";import{_ as mp}from"./supabase-pWErzozG.js";import{u as ar,a as X_,L as Kk,O as Gk,b as pp,B as Yk,R as Wv,c as sn,N as Kh}from"./router-8pqLaH9a.js";import{A as ke,m as L,X as Wi,I as Q_,T as En,C as Jr,a as Si,L as xa,P as gp,b as Gn,c as yp,H as au,B as Go,S as Zk,W as Xk,d as J_,R as ji,e as er,f as wa,D as xc,g as eE,E as Qk,h as Vf,M as wc,i as tE,j as Jk,k as eN,l as tN,n as rN,U as rE,o as nE,p as nN,q as iN,r as iE,s as aE,t as aN,u as md,v as sE,w as su,x as oE,y as sN,z as qv,F as vp,G as cE,J as lE,K as Kv,N as oN,O as uE,Q as bp,V as dE,Y as cN,Z as lN,_ as uN,$ as dN,a0 as hN,a1 as Gv,a2 as fN,a3 as mN,a4 as hE,a5 as fE,a6 as mE,a7 as pN,a8 as gN}from"./ui-DPEBMuFB.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Ff={},Yv=fp;Ff.createRoot=Yv.createRoot,Ff.hydrateRoot=Yv.hydrateRoot;const Zv=t=>{let e;const r=new Set,n=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const m=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>c,subscribe:l=>(r.add(l),()=>r.delete(l))},c=e=t(n,i,o);return o},yN=t=>t?Zv(t):Zv,vN=t=>t;function bN(t,e=vN){const r=H.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return H.useDebugValue(r),r}const Xv=t=>{const e=yN(t),r=n=>bN(e,n);return Object.assign(r,e),r},xp=t=>t?Xv(t):Xv;var pE=Symbol.for("immer-nothing"),Qv=Symbol.for("immer-draftable"),Sr=Symbol.for("immer-state");function Gr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Is=Object.getPrototypeOf;function Pa(t){return!!t&&!!t[Sr]}function Yn(t){return t?gE(t)||Array.isArray(t)||!!t[Qv]||!!t.constructor?.[Qv]||gd(t)||yd(t):!1}var xN=Object.prototype.constructor.toString();function gE(t){if(!t||typeof t!="object")return!1;const e=Is(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===xN}function ou(t,e){pd(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function pd(t){const e=t[Sr];return e?e.type_:Array.isArray(t)?1:gd(t)?2:yd(t)?3:0}function zf(t,e){return pd(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function yE(t,e,r){const n=pd(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function wN(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function gd(t){return t instanceof Map}function yd(t){return t instanceof Set}function ca(t){return t.copy_||t.base_}function Uf(t,e){if(gd(t))return new Map(t);if(yd(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=gE(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Sr];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Is(t),n)}else{const n=Is(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function wp(t,e=!1){return vd(t)||Pa(t)||!Yn(t)||(pd(t)>1&&(t.set=t.add=t.clear=t.delete=_N),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>wp(n,!0))),t}function _N(){Gr(2)}function vd(t){return Object.isFrozen(t)}var EN={};function Ca(t){const e=EN[t];return e||Gr(0,t),e}var Yo;function vE(){return Yo}function TN(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Jv(t,e){e&&(Ca("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Bf(t){Hf(t),t.drafts_.forEach(AN),t.drafts_=null}function Hf(t){t===Yo&&(Yo=t.parent_)}function e0(t){return Yo=TN(Yo,t)}function AN(t){const e=t[Sr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function t0(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Sr].modified_&&(Bf(e),Gr(4)),Yn(t)&&(t=cu(e,t),e.parent_||lu(e,t)),e.patches_&&Ca("Patches").generateReplacementPatches_(r[Sr].base_,t,e.patches_,e.inversePatches_)):t=cu(e,r,[]),Bf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==pE?t:void 0}function cu(t,e,r){if(vd(e))return e;const n=e[Sr];if(!n)return ou(e,(i,a)=>r0(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return lu(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),ou(a,(o,c)=>r0(t,n,i,o,c,r,s)),lu(t,i,!1),r&&t.patches_&&Ca("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function r0(t,e,r,n,i,a,s){if(Pa(i)){const o=a&&e&&e.type_!==3&&!zf(e.assigned_,n)?a.concat(n):void 0,c=cu(t,i,o);if(yE(r,n,c),Pa(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Yn(i)&&!vd(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;cu(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&lu(t,i)}}function lu(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&wp(e,r)}function SN(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:vE(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=_p;r&&(i=[n],a=Zo);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var _p={get(t,e){if(e===Sr)return t;const r=ca(t);if(!zf(r,e))return IN(t,r,e);const n=r[e];return t.finalized_||!Yn(n)?n:n===Gh(t.base_,e)?(Yh(t),t.copy_[e]=qf(n,t)):n},has(t,e){return e in ca(t)},ownKeys(t){return Reflect.ownKeys(ca(t))},set(t,e,r){const n=bE(ca(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=Gh(ca(t),e),a=i?.[Sr];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(wN(r,i)&&(r!==void 0||zf(t.base_,e)))return!0;Yh(t),Wf(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return Gh(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,Yh(t),Wf(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=ca(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gr(11)},getPrototypeOf(t){return Is(t.base_)},setPrototypeOf(){Gr(12)}},Zo={};ou(_p,(t,e)=>{Zo[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Zo.deleteProperty=function(t,e){return Zo.set.call(this,t,e,void 0)};Zo.set=function(t,e,r){return _p.set.call(this,t[0],e,r,t[0])};function Gh(t,e){const r=t[Sr];return(r?ca(r):t)[e]}function IN(t,e,r){const n=bE(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function bE(t,e){if(!(e in t))return;let r=Is(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Is(r)}}function Wf(t){t.modified_||(t.modified_=!0,t.parent_&&Wf(t.parent_))}function Yh(t){t.copy_||(t.copy_=Uf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var PN=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...l){return s.produce(c,u=>r.call(this,u,...l))}}typeof r!="function"&&Gr(6),n!==void 0&&typeof n!="function"&&Gr(7);let i;if(Yn(e)){const a=e0(this),s=qf(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Bf(a):Hf(a)}return Jv(a,n),t0(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===pE&&(i=void 0),this.autoFreeze_&&wp(i,!0),n){const a=[],s=[];Ca("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Gr(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Yn(t)||Gr(8),Pa(t)&&(t=Bn(t));const e=e0(this),r=qf(t,void 0);return r[Sr].isManual_=!0,Hf(e),r}finishDraft(t,e){const r=t&&t[Sr];(!r||!r.isManual_)&&Gr(9);const{scope_:n}=r;return Jv(n,e),t0(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=Ca("Patches").applyPatches_;return Pa(t)?n(t,e):this.produce(t,i=>n(i,e))}};function qf(t,e){const r=gd(t)?Ca("MapSet").proxyMap_(t,e):yd(t)?Ca("MapSet").proxySet_(t,e):SN(t,e);return(e?e.scope_:vE()).drafts_.push(r),r}function Bn(t){return Pa(t)||Gr(10,t),xE(t)}function xE(t){if(!Yn(t)||vd(t))return t;const e=t[Sr];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Uf(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Uf(t,!0);return ou(r,(n,i)=>{yE(r,n,xE(i))}),e&&(e.finalized_=!1),r}var Ir=new PN,Se=Ir.produce;Ir.produceWithPatches.bind(Ir);Ir.setAutoFreeze.bind(Ir);Ir.setUseStrictShallowCopy.bind(Ir);Ir.applyPatches.bind(Ir);Ir.createDraft.bind(Ir);Ir.finishDraft.bind(Ir);const CN=()=>{};var n0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},kN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],c=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},_E={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|l>>6,p=l&63;c||(p=64,s||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):kN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const l=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||l==null||h==null)throw new NN;const m=a<<2|o>>4;if(n.push(m),l!==64){const p=o<<4&240|l>>2;if(n.push(p),h!==64){const v=l<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class NN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const jN=function(t){const e=wE(t);return _E.encodeByteArray(e,!0)},uu=function(t){return jN(t).replace(/\./g,"")},EE=function(t){try{return _E.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=()=>ON().__FIREBASE_DEFAULTS__,DN=()=>{if(typeof process>"u"||typeof n0>"u")return;const t=n0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},MN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&EE(t[1]);return e&&JSON.parse(e)},bd=()=>{try{return CN()||RN()||DN()||MN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},TE=t=>bd()?.emulatorHosts?.[t],AE=t=>{const e=TE(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},SE=()=>bd()?.config,IE=t=>bd()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ep(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[uu(JSON.stringify(r)),uu(JSON.stringify(s)),""].join(".")}const Lo={};function $N(){const t={prod:[],emulator:[]};for(const e of Object.keys(Lo))Lo[e]?t.emulator.push(e):t.prod.push(e);return t}function VN(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let i0=!1;function Tp(t,e){if(typeof window>"u"||typeof document>"u"||!za(window.location.host)||Lo[t]===e||Lo[t]||i0)return;Lo[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=$N().prod.length>0;function s(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{i0=!0,s()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=VN(n),p=r("text"),v=document.getElementById(p)||document.createElement("span"),b=r("learnmore"),g=document.getElementById(b)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;o(E),u(g,b);const j=l();c(T,_),E.append(T,v,g,j),document.body.appendChild(E)}a?(v.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function zN(){const t=bd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function BN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function HN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WN(){const t=tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function qN(){return!zN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KN(){try{return typeof indexedDB=="object"}catch{return!1}}function GN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN="FirebaseError";class Cn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=YN,Object.setPrototypeOf(this,Cn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_c.prototype.create)}}class _c{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?ZN(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Cn(i,o,n)}}function ZN(t,e){return t.replace(XN,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const XN=/\{\$([^}]+)}/g;function QN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ka(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(a0(a)&&a0(s)){if(!ka(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function a0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Po(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Co(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function JN(t,e){const r=new ej(t,e);return r.subscribe.bind(r)}class ej{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");tj(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Zh),i.error===void 0&&(i.error=Zh),i.complete===void 0&&(i.complete=Zh);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tj(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Zh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class Oi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rj=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new LN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ij(e))try{this.getOrInitializeService({instanceIdentifier:la})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=la){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=la){return this.instances.has(e)}getOptions(e=la){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:nj(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=la){return this.component?this.component.multipleInstances?e:la:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function nj(t){return t===la?void 0:t}function ij(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new rj(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const sj={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},oj=xe.INFO,cj={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},lj=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=cj[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ap{constructor(e){this.name=e,this._logLevel=oj,this._logHandler=lj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?sj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const uj=(t,e)=>e.some(r=>t instanceof r);let s0,o0;function dj(){return s0||(s0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hj(){return o0||(o0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CE=new WeakMap,Kf=new WeakMap,kE=new WeakMap,Xh=new WeakMap,Sp=new WeakMap;function fj(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Ii(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&CE.set(r,t)}).catch(()=>{}),Sp.set(e,t),e}function mj(t){if(Kf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});Kf.set(t,e)}let Gf={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Kf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ii(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function pj(t){Gf=t(Gf)}function gj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Qh(this),e,...r);return kE.set(n,e.sort?e.sort():[e]),Ii(n)}:hj().includes(t)?function(...e){return t.apply(Qh(this),e),Ii(CE.get(this))}:function(...e){return Ii(t.apply(Qh(this),e))}}function yj(t){return typeof t=="function"?gj(t):(t instanceof IDBTransaction&&mj(t),uj(t,dj())?new Proxy(t,Gf):t)}function Ii(t){if(t instanceof IDBRequest)return fj(t);if(Xh.has(t))return Xh.get(t);const e=yj(t);return e!==t&&(Xh.set(t,e),Sp.set(e,t)),e}const Qh=t=>Sp.get(t);function vj(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Ii(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Ii(s.result),c.oldVersion,c.newVersion,Ii(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const bj=["get","getKey","getAll","getAllKeys","count"],xj=["put","add","delete","clear"],Jh=new Map;function c0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Jh.get(e))return Jh.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=xj.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||bj.includes(r)))return;const a=async function(s,...o){const c=this.transaction(s,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&c.done]))[0]};return Jh.set(e,a),a}pj(t=>({...t,get:(e,r,n)=>c0(e,r)||t.get(e,r,n),has:(e,r)=>!!c0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(_j(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function _j(t){return t.getComponent()?.type==="VERSION"}const Yf="@firebase/app",l0="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn=new Ap("@firebase/app"),Ej="@firebase/app-compat",Tj="@firebase/analytics-compat",Aj="@firebase/analytics",Sj="@firebase/app-check-compat",Ij="@firebase/app-check",Pj="@firebase/auth",Cj="@firebase/auth-compat",kj="@firebase/database",Nj="@firebase/data-connect",jj="@firebase/database-compat",Oj="@firebase/functions",Rj="@firebase/functions-compat",Dj="@firebase/installations",Mj="@firebase/installations-compat",Lj="@firebase/messaging",$j="@firebase/messaging-compat",Vj="@firebase/performance",Fj="@firebase/performance-compat",zj="@firebase/remote-config",Uj="@firebase/remote-config-compat",Bj="@firebase/storage",Hj="@firebase/storage-compat",Wj="@firebase/firestore",qj="@firebase/ai",Kj="@firebase/firestore-compat",Gj="firebase",Yj="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="[DEFAULT]",Zj={[Yf]:"fire-core",[Ej]:"fire-core-compat",[Aj]:"fire-analytics",[Tj]:"fire-analytics-compat",[Ij]:"fire-app-check",[Sj]:"fire-app-check-compat",[Pj]:"fire-auth",[Cj]:"fire-auth-compat",[kj]:"fire-rtdb",[Nj]:"fire-data-connect",[jj]:"fire-rtdb-compat",[Oj]:"fire-fn",[Rj]:"fire-fn-compat",[Dj]:"fire-iid",[Mj]:"fire-iid-compat",[Lj]:"fire-fcm",[$j]:"fire-fcm-compat",[Vj]:"fire-perf",[Fj]:"fire-perf-compat",[zj]:"fire-rc",[Uj]:"fire-rc-compat",[Bj]:"fire-gcs",[Hj]:"fire-gcs-compat",[Wj]:"fire-fst",[Kj]:"fire-fst-compat",[qj]:"fire-vertex","fire-js":"fire-js",[Gj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const du=new Map,Xj=new Map,Xf=new Map;function u0(t,e){try{t.container.addComponent(e)}catch(r){Zn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Na(t){const e=t.name;if(Xf.has(e))return Zn.debug(`There were multiple attempts to register component ${e}.`),!1;Xf.set(e,t);for(const r of du.values())u0(r,t);for(const r of Xj.values())u0(r,t);return!0}function xd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _r(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Pi=new _c("app","Firebase",Qj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Oi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=Yj;function NE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Zf,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Pi.create("bad-app-name",{appName:String(i)});if(r||(r=SE()),!r)throw Pi.create("no-options");const a=du.get(i);if(a){if(ka(r,a.options)&&ka(n,a.config))return a;throw Pi.create("duplicate-app",{appName:i})}const s=new aj(i);for(const c of Xf.values())s.addComponent(c);const o=new Jj(r,n,s);return du.set(i,o),o}function Ip(t=Zf){const e=du.get(t);if(!e&&t===Zf&&SE())return NE();if(!e)throw Pi.create("no-app",{appName:t});return e}function mn(t,e,r){let n=Zj[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Zn.warn(s.join(" "));return}Na(new Oi(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO="firebase-heartbeat-database",tO=1,Xo="firebase-heartbeat-store";let ef=null;function jE(){return ef||(ef=vj(eO,tO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Pi.create("idb-open",{originalErrorMessage:t.message})})),ef}async function rO(t){try{const r=(await jE()).transaction(Xo),n=await r.objectStore(Xo).get(OE(t));return await r.done,n}catch(e){if(e instanceof Cn)Zn.warn(e.message);else{const r=Pi.create("idb-get",{originalErrorMessage:e?.message});Zn.warn(r.message)}}}async function d0(t,e){try{const n=(await jE()).transaction(Xo,"readwrite");await n.objectStore(Xo).put(e,OE(t)),await n.done}catch(r){if(r instanceof Cn)Zn.warn(r.message);else{const n=Pi.create("idb-set",{originalErrorMessage:r?.message});Zn.warn(n.message)}}}function OE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=1024,iO=30;class aO{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new oO(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=h0();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>iO){const i=cO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Zn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=h0(),{heartbeatsToSend:r,unsentEntries:n}=sO(this._heartbeatsCache.heartbeats),i=uu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Zn.warn(e),""}}}function h0(){return new Date().toISOString().substring(0,10)}function sO(t,e=nO){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),f0(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),f0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class oO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KN()?GN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await rO(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return d0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return d0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function f0(t){return uu(JSON.stringify({version:2,heartbeats:t})).length}function cO(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(t){Na(new Oi("platform-logger",e=>new wj(e),"PRIVATE")),Na(new Oi("heartbeat",e=>new aO(e),"PRIVATE")),mn(Yf,l0,t),mn(Yf,l0,"esm2020"),mn("fire-js","")}lO("");var uO="firebase",dO="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn(uO,dO,"app");function RE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hO=RE,DE=new _c("auth","Firebase",RE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=new Ap("@firebase/auth");function fO(t,...e){hu.logLevel<=xe.WARN&&hu.warn(`Auth (${Ua}): ${t}`,...e)}function Wl(t,...e){hu.logLevel<=xe.ERROR&&hu.error(`Auth (${Ua}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,...e){throw Pp(t,...e)}function pn(t,...e){return Pp(t,...e)}function ME(t,e,r){const n={...hO(),[e]:r};return new _c("auth","Firebase",n).create(e,{appName:t.name})}function Hn(t){return ME(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Pp(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return DE.create(t,...e)}function le(t,e,...r){if(!t)throw Pp(e,...r)}function Vn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wl(e),new Error(e)}function Xn(t,e){t||Vn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(){return typeof self<"u"&&self.location?.href||""}function mO(){return m0()==="http:"||m0()==="https:"}function m0(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mO()||BN()||"connection"in navigator)?navigator.onLine:!0}function gO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,r){this.shortDelay=e,this.longDelay=r,Xn(r>e,"Short delay should be less than long delay!"),this.isMobile=FN()||HN()}get(){return pO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(t,e){Xn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],bO=new Tc(3e4,6e4);function qi(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ki(t,e,r,n,i={}){return $E(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=Ec({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...a};return UN()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&za(t.emulatorConfig.host)&&(l.credentials="include"),LE.fetch()(await VE(t,t.config.apiHost,r,o),l)})}async function $E(t,e,r){t._canInitEmulator=!1;const n={...yO,...e};try{const i=new wO(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw gl(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw gl(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw gl(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw gl(t,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw ME(t,u,l);en(t,u)}}catch(i){if(i instanceof Cn)throw i;en(t,"network-request-failed",{message:String(i)})}}async function Ac(t,e,r,n,i={}){const a=await Ki(t,e,r,n,i);return"mfaPendingCredential"in a&&en(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function VE(t,e,r,n){const i=`${e}${r}?${n}`,a=t,s=a.config.emulator?Cp(t.config,i):`${t.config.apiScheme}://${i}`;return vO.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function xO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class wO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(pn(this.auth,"network-request-failed")),bO.get())})}}function gl(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=pn(t,e,n);return i.customData._tokenResponse=r,i}function p0(t){return t!==void 0&&t.enterprise!==void 0}class _O{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return xO(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function EO(t,e){return Ki(t,"GET","/v2/recaptchaConfig",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TO(t,e){return Ki(t,"POST","/v1/accounts:delete",e)}async function fu(t,e){return Ki(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $o(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function AO(t,e=!1){const r=dr(t),n=await r.getIdToken(e),i=kp(n);le(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:n,authTime:$o(tf(i.auth_time)),issuedAtTime:$o(tf(i.iat)),expirationTime:$o(tf(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function tf(t){return Number(t)*1e3}function kp(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Wl("JWT malformed, contained fewer than 3 sections"),null;try{const i=EE(r);return i?JSON.parse(i):(Wl("Failed to decode base64 JWT payload"),null)}catch(i){return Wl("Caught error parsing JWT payload as JSON",i?.toString()),null}}function g0(t){const e=kp(t);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qo(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Cn&&SO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function SO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=$o(this.lastLoginAt),this.creationTime=$o(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mu(t){const e=t.auth,r=await t.getIdToken(),n=await Qo(t,fu(e,{idToken:r}));le(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?FE(i.providerUserInfo):[],s=CO(t.providerData,a),o=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,l=o?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Jf(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(t,u)}async function PO(t){const e=dr(t);await mu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function CO(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function FE(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kO(t,e){const r=await $E(t,{},async()=>{const n=Ec({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=await VE(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&za(t.emulatorConfig.host)&&(c.credentials="include"),LE.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function NO(t,e){return Ki(t,"POST","/v2/accounts:revokeToken",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):g0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){le(e.length!==0,"internal-error");const r=g0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await kO(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new bs;return n&&(le(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(le(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(le(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bs,this.toJSON())}_performRefresh(){return Vn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new IO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Jf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Qo(this,this.stsTokenManager.getToken(this.auth,e));return le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return AO(this,e)}reload(){return PO(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await mu(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_r(this.auth.app))return Promise.reject(Hn(this.auth));const e=await this.getIdToken();return await Qo(this,TO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,s=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:b}=r;le(h&&b,e,"internal-error");const g=bs.fromJSON(this.name,b);le(typeof h=="string",e,"internal-error"),hi(n,e.name),hi(i,e.name),le(typeof m=="boolean",e,"internal-error"),le(typeof p=="boolean",e,"internal-error"),hi(a,e.name),hi(s,e.name),hi(o,e.name),hi(c,e.name),hi(l,e.name),hi(u,e.name);const _=new Zr({uid:h,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:a,tenantId:o,stsTokenManager:g,createdAt:l,lastLoginAt:u});return v&&Array.isArray(v)&&(_.providerData=v.map(T=>({...T}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new bs;i.updateFromServerResponse(r);const a=new Zr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await mu(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];le(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?FE(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,o=new bs;o.updateFromIdToken(n);const c=new Zr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Jf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0=new Map;function Fn(t){Xn(t instanceof Function,"Expected a class definition");let e=y0.get(t);return e?(Xn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,y0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}zE.type="NONE";const v0=zE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ql(t,e,r){return`firebase:${t}:${e}:${r}`}class xs{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=ql(this.userKey,i.apiKey,a),this.fullPersistenceKey=ql("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await fu(this.auth,{idToken:e}).catch(()=>{});return r?Zr._fromGetAccountInfoResponse(this.auth,r,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new xs(Fn(v0),e,n);const i=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let a=i[0]||Fn(v0);const s=ql(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const u=await l._get(s);if(u){let h;if(typeof u=="string"){const m=await fu(e,{idToken:u}).catch(()=>{});if(!m)break;h=await Zr._fromGetAccountInfoResponse(e,m,u)}else h=Zr._fromJSON(e,u);l!==a&&(o=h),a=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new xs(a,e,n):(a=c[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==a)try{await l._remove(s)}catch{}})),new xs(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(UE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(KE(e))return"Blackberry";if(GE(e))return"Webos";if(BE(e))return"Safari";if((e.includes("chrome/")||HE(e))&&!e.includes("edge/"))return"Chrome";if(qE(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function UE(t=tr()){return/firefox\//i.test(t)}function BE(t=tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HE(t=tr()){return/crios\//i.test(t)}function WE(t=tr()){return/iemobile/i.test(t)}function qE(t=tr()){return/android/i.test(t)}function KE(t=tr()){return/blackberry/i.test(t)}function GE(t=tr()){return/webos/i.test(t)}function Np(t=tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function jO(t=tr()){return Np(t)&&!!window.navigator?.standalone}function OO(){return WN()&&document.documentMode===10}function YE(t=tr()){return Np(t)||qE(t)||GE(t)||KE(t)||/windows phone/i.test(t)||WE(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(t,e=[]){let r;switch(t){case"Browser":r=b0(tr());break;case"Worker":r=`${b0(tr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ua}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const c=e(a);s(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DO(t,e={}){return Ki(t,"GET","/v2/passwordPolicy",qi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MO=6;class LO{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??MO,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new x0(this),this.idTokenSubscription=new x0(this),this.beforeStateQueue=new RO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Fn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await xs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await fu(this,{idToken:e}),n=await Zr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_r(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===s)&&o?.user&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await mu(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=gO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_r(this.app))return Promise.reject(Hn(this));const r=e?dr(e):null;return r&&le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _r(this.app)?Promise.reject(Hn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _r(this.app)?Promise.reject(Hn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await DO(this),r=new LO(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _c("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await NO(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Fn(e)||this._popupRedirectResolver;le(r,this,"argument-error"),this.redirectPersistenceManager=await xs.create(this,[Fn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(_r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&fO(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ba(t){return dr(t)}class x0{constructor(e){this.auth=e,this.observer=null,this.addObserver=JN(r=>this.observer=r)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VO(t){wd=t}function XE(t){return wd.loadJS(t)}function FO(){return wd.recaptchaEnterpriseScript}function zO(){return wd.gapiScript}function UO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class BO{constructor(){this.enterprise=new HO}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class HO{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const WO="recaptcha-enterprise",QE="NO_RECAPTCHA";class qO{constructor(e){this.type=WO,this.auth=Ba(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{EO(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new _O(c);return a.tenantId==null?a._agentRecaptchaConfig=l:a._tenantRecaptchaConfigs[a.tenantId]=l,s(l.siteKey)}}).catch(c=>{o(c)})})}function i(a,s,o){const c=window.grecaptcha;p0(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(l=>{s(l)}).catch(()=>{s(QE)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BO().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&p0(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let c=FO();c.length!==0&&(c+=o),XE(c).then(()=>{i(o,a,s)}).catch(l=>{s(l)})}}).catch(o=>{s(o)})})}}async function w0(t,e,r,n=!1,i=!1){const a=new qO(t);let s;if(i)s=QE;else try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function em(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await w0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await w0(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(t,e){const r=xd(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(ka(a,e??{}))return i;en(i,"already-initialized")}return r.initialize({options:e})}function GO(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Fn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function YO(t,e,r){const n=Ba(t);le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=JE(e),{host:s,port:o}=ZO(e),c=o===null?"":`:${o}`,l={url:`${a}//${s}${c}/`},u=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){le(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),le(ka(l,n.config.emulator)&&ka(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,za(s)?(Ep(`${a}//${s}${c}`),Tp("Auth",!0)):XO()}function JE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ZO(t){const e=JE(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:_0(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:_0(s)}}}function _0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function XO(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Vn("not implemented")}_getIdTokenResponse(e){return Vn("not implemented")}_linkToIdToken(e,r){return Vn("not implemented")}_getReauthenticationResolver(e){return Vn("not implemented")}}async function QO(t,e){return Ki(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JO(t,e){return Ac(t,"POST","/v1/accounts:signInWithPassword",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eR(t,e){return Ac(t,"POST","/v1/accounts:signInWithEmailLink",qi(t,e))}async function tR(t,e){return Ac(t,"POST","/v1/accounts:signInWithEmailLink",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends jp{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Jo(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Jo(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return em(e,r,"signInWithPassword",JO);case"emailLink":return eR(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return em(e,n,"signUpPassword",QO);case"emailLink":return tR(e,{idToken:r,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ws(t,e){return Ac(t,"POST","/v1/accounts:signInWithIdp",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="http://localhost";class ja extends jp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ja(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):en("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const s=new ja(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return ws(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ws(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ws(e,r)}buildRequest(){const e={requestUri:rR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ec(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iR(t){const e=Po(Co(t)).link,r=e?Po(Co(e)).deep_link_id:null,n=Po(Co(t)).deep_link_id;return(n?Po(Co(n)).link:null)||n||r||e||t}class Op{constructor(e){const r=Po(Co(e)),n=r.apiKey??null,i=r.oobCode??null,a=nR(r.mode??null);le(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=iR(e);try{return new Op(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){this.providerId=zs.PROVIDER_ID}static credential(e,r){return Jo._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Op.parseLink(r);return le(n,"argument-error"),Jo._fromEmailAndCode(e,n.code,n.tenantId)}}zs.PROVIDER_ID="password";zs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc extends e1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Sc{constructor(){super("facebook.com")}static credential(e){return ja._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bi.credential(e.oauthAccessToken)}catch{return null}}}bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Sc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ja._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xi.credential(r,n)}catch{return null}}}xi.GOOGLE_SIGN_IN_METHOD="google.com";xi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Sc{constructor(){super("github.com")}static credential(e){return ja._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wi.credential(e.oauthAccessToken)}catch{return null}}}wi.GITHUB_SIGN_IN_METHOD="github.com";wi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Sc{constructor(){super("twitter.com")}static credential(e,r){return ja._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return _i.credential(r,n)}catch{return null}}}_i.TWITTER_SIGN_IN_METHOD="twitter.com";_i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aR(t,e){return Ac(t,"POST","/v1/accounts:signUp",qi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Zr._fromIdTokenResponse(e,n,i),s=E0(n);return new Oa({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=E0(n);return new Oa({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function E0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends Cn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,pu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new pu(e,r,n,i)}}function t1(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?pu._fromErrorAndOperation(t,a,e,n):a})}async function sR(t,e,r=!1){const n=await Qo(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Oa._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(t,e,r=!1){const{auth:n}=t;if(_r(n.app))return Promise.reject(Hn(n));const i="reauthenticate";try{const a=await Qo(t,t1(n,i,e,t),r);le(a.idToken,n,"internal-error");const s=kp(a.idToken);le(s,n,"internal-error");const{sub:o}=s;return le(t.uid===o,n,"user-mismatch"),Oa._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&en(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r1(t,e,r=!1){if(_r(t.app))return Promise.reject(Hn(t));const n="signIn",i=await t1(t,n,e),a=await Oa._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function cR(t,e){return r1(Ba(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n1(t){const e=Ba(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function lR(t,e,r){if(_r(t.app))return Promise.reject(Hn(t));const n=Ba(t),s=await em(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",aR).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&n1(t),c}),o=await Oa._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function uR(t,e,r){return _r(t.app)?Promise.reject(Hn(t)):cR(dr(t),zs.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&n1(t),n})}function dR(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function hR(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function fR(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function mR(t){return dr(t).signOut()}const gu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(gu,"1"),this.storage.removeItem(gu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR=1e3,gR=10;class a1 extends i1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=YE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);OO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,gR):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},pR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}a1.type="LOCAL";const yR=a1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1 extends i1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}s1.type="SESSION";const o1=s1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new _d(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async l=>l(r.origin,a)),c=await vR(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_d.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,c)=>{const l=Rp("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(){return window}function xR(t){gn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(){return typeof gn().WorkerGlobalScope<"u"&&typeof gn().importScripts=="function"}async function wR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _R(){return navigator?.serviceWorker?.controller||null}function ER(){return c1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1="firebaseLocalStorageDb",TR=1,yu="firebaseLocalStorage",u1="fbase_key";class Ic{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ed(t,e){return t.transaction([yu],e?"readwrite":"readonly").objectStore(yu)}function AR(){const t=indexedDB.deleteDatabase(l1);return new Ic(t).toPromise()}function tm(){const t=indexedDB.open(l1,TR);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(yu,{keyPath:u1})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(yu)?e(n):(n.close(),await AR(),e(await tm()))})})}async function T0(t,e,r){const n=Ed(t,!0).put({[u1]:e,value:r});return new Ic(n).toPromise()}async function SR(t,e){const r=Ed(t,!1).get(e),n=await new Ic(r).toPromise();return n===void 0?null:n.value}function A0(t,e){const r=Ed(t,!0).delete(e);return new Ic(r).toPromise()}const IR=800,PR=3;class d1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await tm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>PR)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return c1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_d._getInstance(ER()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await wR(),!this.activeServiceWorker)return;this.sender=new bR(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_R()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await tm();return await T0(e,gu,"1"),await A0(e,gu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>T0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>SR(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>A0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Ed(i,!1).getAll();return new Ic(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}d1.type="LOCAL";const CR=d1;new Tc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t,e){return e?Fn(e):(le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp extends jp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ws(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ws(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ws(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function NR(t){return r1(t.auth,new Dp(t),t.bypassAuthState)}function jR(t){const{auth:e,user:r}=t;return le(r,e,"internal-error"),oR(r,new Dp(t),t.bypassAuthState)}async function OR(t){const{auth:e,user:r}=t;return le(r,e,"internal-error"),sR(r,new Dp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NR;case"linkViaPopup":case"linkViaRedirect":return OR;case"reauthViaPopup":case"reauthViaRedirect":return jR;default:en(this.auth,"internal-error")}}resolve(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR=new Tc(2e3,1e4);class ms extends h1{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ms.currentPopupAction&&ms.currentPopupAction.cancel(),ms.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return le(e,this.auth,"internal-error"),e}async onExecution(){Xn(this.filter.length===1,"Popup operations only handle one event");const e=Rp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(pn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(pn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ms.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,RR.get())};e()}}ms.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR="pendingRedirect",Kl=new Map;class MR extends h1{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Kl.get(this.auth._key());if(!e){try{const n=await LR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Kl.set(this.auth._key(),e)}return this.bypassAuthState||Kl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LR(t,e){const r=FR(e),n=VR(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function $R(t,e){Kl.set(t._key(),e)}function VR(t){return Fn(t._redirectPersistence)}function FR(t){return ql(DR,t.config.apiKey,t.name)}async function zR(t,e,r=!1){if(_r(t.app))return Promise.reject(Hn(t));const n=Ba(t),i=kR(n,e),s=await new MR(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR=10*60*1e3;class BR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!HR(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!f1(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(pn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=UR&&this.cachedEventUids.clear(),this.cachedEventUids.has(S0(e))}saveEventToCache(e){this.cachedEventUids.add(S0(e)),this.lastProcessedEventTime=Date.now()}}function S0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function f1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function HR(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WR(t,e={}){return Ki(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KR=/^https?/;async function GR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await WR(t);for(const r of e)try{if(YR(r))return}catch{}en(t,"unauthorized-domain")}function YR(t){const e=Qf(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!KR.test(r))return!1;if(qR.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=new Tc(3e4,6e4);function I0(){const t=gn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function XR(t){return new Promise((e,r)=>{function n(){I0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{I0(),r(pn(t,"network-request-failed"))},timeout:ZR.get()})}if(gn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(gn().gapi?.load)n();else{const i=UO("iframefcb");return gn()[i]=()=>{gapi.load?n():r(pn(t,"network-request-failed"))},XE(`${zO()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw Gl=null,e})}let Gl=null;function QR(t){return Gl=Gl||XR(t),Gl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=new Tc(5e3,15e3),e2="__/auth/iframe",t2="emulator/auth/iframe",r2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function i2(t){const e=t.config;le(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Cp(e,t2):`https://${t.config.authDomain}/${e2}`,n={apiKey:e.apiKey,appName:t.name,v:Ua},i=n2.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Ec(n).slice(1)}`}async function a2(t){const e=await QR(t),r=gn().gapi;return le(r,t,"internal-error"),e.open({where:document.body,url:i2(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:r2,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=pn(t,"network-request-failed"),o=gn().setTimeout(()=>{a(s)},JR.get());function c(){gn().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},o2=500,c2=600,l2="_blank",u2="http://localhost";class P0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function d2(t,e,r,n=o2,i=c2){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...s2,width:n.toString(),height:i.toString(),top:a,left:s},l=tr().toLowerCase();r&&(o=HE(l)?l2:r),UE(l)&&(e=e||u2,c.scrollbars="yes");const u=Object.entries(c).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(jO(l)&&o!=="_self")return h2(e||"",o),new P0(null);const h=window.open(e||"",o,u);le(h,t,"popup-blocked");try{h.focus()}catch{}return new P0(h)}function h2(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2="__/auth/handler",m2="emulator/auth/handler",p2=encodeURIComponent("fac");async function C0(t,e,r,n,i,a){le(t.config.authDomain,t,"auth-domain-config-required"),le(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ua,eventId:i};if(e instanceof e1){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",QN(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof Sc){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const c=await t._getAppCheckToken(),l=c?`#${p2}=${encodeURIComponent(c)}`:"";return`${g2(t)}?${Ec(o).slice(1)}${l}`}function g2({config:t}){return t.emulator?Cp(t,m2):`https://${t.authDomain}/${f2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf="webStorageSupport";class y2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=o1,this._completeRedirectFn=zR,this._overrideRedirectResult=$R}async _openPopup(e,r,n,i){Xn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await C0(e,r,n,Qf(),i);return d2(e,a,Rp())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await C0(e,r,n,Qf(),i);return xR(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Xn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await a2(e),n=new BR(e);return r.register("authEvent",i=>(le(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(rf,{type:rf},i=>{const a=i?.[0]?.[rf];a!==void 0&&r(!!a),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=GR(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return YE()||BE()||Np()}}const v2=y2;var k0="@firebase/auth",N0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function w2(t){Na(new Oi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;le(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZE(t)},l=new $O(n,i,a,c);return GO(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Na(new Oi("auth-internal",e=>{const r=Ba(e.getProvider("auth").getImmediate());return(n=>new b2(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),mn(k0,N0,x2(t)),mn(k0,N0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=5*60,E2=IE("authIdTokenMaxAge")||_2;let j0=null;const T2=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>E2)return;const i=r?.token;j0!==i&&(j0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function A2(t=Ip()){const e=xd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=KO(t,{popupRedirectResolver:v2,persistence:[CR,yR,o1]}),n=IE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=T2(a.toString());hR(r,s,()=>s(r.currentUser)),dR(r,o=>s(o))}}const i=TE("auth");return i&&YO(r,`http://${i}`),r}function S2(){return document.getElementsByTagName("head")?.[0]??document}VO({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=pn("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",S2().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});w2("Browser");var O0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ci,m1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,A){function P(){}P.prototype=A.prototype,S.D=A.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(O,N,C){for(var k=Array(arguments.length-2),Q=2;Q<arguments.length;Q++)k[Q-2]=arguments[Q];return A.prototype[N].apply(O,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,A,P){P||(P=0);var O=Array(16);if(typeof A=="string")for(var N=0;16>N;++N)O[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;16>N;++N)O[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=S.g[0],P=S.g[1],N=S.g[2];var C=S.g[3],k=A+(C^P&(N^C))+O[0]+3614090360&4294967295;A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[1]+3905402710&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[2]+606105819&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[3]+3250441966&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[4]+4118548399&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[5]+1200080426&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[6]+2821735955&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[7]+4249261313&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[8]+1770035416&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[9]+2336552879&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[10]+4294925233&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[11]+2304563134&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[12]+1804603682&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[13]+4254626195&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[14]+2792965006&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[15]+1236535329&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(N^C&(P^N))+O[1]+4129170786&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[6]+3225465664&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[11]+643717713&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[0]+3921069994&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[5]+3593408605&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[10]+38016083&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[15]+3634488961&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[4]+3889429448&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[9]+568446438&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[14]+3275163606&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[3]+4107603335&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[8]+1163531501&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[13]+2850285829&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[2]+4243563512&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[7]+1735328473&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[12]+2368359562&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(P^N^C)+O[5]+4294588738&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[8]+2272392833&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[11]+1839030562&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[14]+4259657740&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[1]+2763975236&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[4]+1272893353&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[7]+4139469664&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[10]+3200236656&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[13]+681279174&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[0]+3936430074&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[3]+3572445317&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[6]+76029189&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[9]+3654602809&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[12]+3873151461&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[15]+530742520&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[2]+3299628645&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(N^(P|~C))+O[0]+4096336452&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[7]+1126891415&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[14]+2878612391&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[5]+4237533241&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[12]+1700485571&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[3]+2399980690&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[10]+4293915773&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[1]+2240044497&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[8]+1873313359&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[15]+4264355552&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[6]+2734768916&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[13]+1309151649&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[4]+4149444226&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[11]+3174756917&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[2]+718787259&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[9]+3951481745&4294967295,S.g[0]=S.g[0]+A&4294967295,S.g[1]=S.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+N&4294967295,S.g[3]=S.g[3]+C&4294967295}n.prototype.u=function(S,A){A===void 0&&(A=S.length);for(var P=A-this.blockSize,O=this.B,N=this.h,C=0;C<A;){if(N==0)for(;C<=P;)i(this,S,C),C+=this.blockSize;if(typeof S=="string"){for(;C<A;)if(O[N++]=S.charCodeAt(C++),N==this.blockSize){i(this,O),N=0;break}}else for(;C<A;)if(O[N++]=S[C++],N==this.blockSize){i(this,O),N=0;break}}this.h=N,this.o+=A},n.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var A=1;A<S.length-8;++A)S[A]=0;var P=8*this.o;for(A=S.length-8;A<S.length;++A)S[A]=P&255,P/=256;for(this.u(S),S=Array(16),A=P=0;4>A;++A)for(var O=0;32>O;O+=8)S[P++]=this.g[A]>>>O&255;return S};function a(S,A){var P=o;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=A(S)}function s(S,A){this.h=A;for(var P=[],O=!0,N=S.length-1;0<=N;N--){var C=S[N]|0;O&&C==A||(P[N]=C,O=!1)}this.g=P}var o={};function c(S){return-128<=S&&128>S?a(S,function(A){return new s([A|0],0>A?-1:0)}):new s([S|0],0>S?-1:0)}function l(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return g(l(-S));for(var A=[],P=1,O=0;S>=P;O++)A[O]=S/P|0,P*=4294967296;return new s(A,0)}function u(S,A){if(S.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S.charAt(0)=="-")return g(u(S.substring(1),A));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=l(Math.pow(A,8)),O=h,N=0;N<S.length;N+=8){var C=Math.min(8,S.length-N),k=parseInt(S.substring(N,N+C),A);8>C?(C=l(Math.pow(A,C)),O=O.j(C).add(l(k))):(O=O.j(P),O=O.add(l(k)))}return O}var h=c(0),m=c(1),p=c(16777216);t=s.prototype,t.m=function(){if(b(this))return-g(this).m();for(var S=0,A=1,P=0;P<this.g.length;P++){var O=this.i(P);S+=(0<=O?O:4294967296+O)*A,A*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(v(this))return"0";if(b(this))return"-"+g(this).toString(S);for(var A=l(Math.pow(S,6)),P=this,O="";;){var N=j(P,A).g;P=_(P,N.j(A));var C=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=N,v(P))return C+O;for(;6>C.length;)C="0"+C;O=C+O}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function v(S){if(S.h!=0)return!1;for(var A=0;A<S.g.length;A++)if(S.g[A]!=0)return!1;return!0}function b(S){return S.h==-1}t.l=function(S){return S=_(this,S),b(S)?-1:v(S)?0:1};function g(S){for(var A=S.g.length,P=[],O=0;O<A;O++)P[O]=~S.g[O];return new s(P,~S.h).add(m)}t.abs=function(){return b(this)?g(this):this},t.add=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0,N=0;N<=A;N++){var C=O+(this.i(N)&65535)+(S.i(N)&65535),k=(C>>>16)+(this.i(N)>>>16)+(S.i(N)>>>16);O=k>>>16,C&=65535,k&=65535,P[N]=k<<16|C}return new s(P,P[P.length-1]&-2147483648?-1:0)};function _(S,A){return S.add(g(A))}t.j=function(S){if(v(this)||v(S))return h;if(b(this))return b(S)?g(this).j(g(S)):g(g(this).j(S));if(b(S))return g(this.j(g(S)));if(0>this.l(p)&&0>S.l(p))return l(this.m()*S.m());for(var A=this.g.length+S.g.length,P=[],O=0;O<2*A;O++)P[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<S.g.length;N++){var C=this.i(O)>>>16,k=this.i(O)&65535,Q=S.i(N)>>>16,oe=S.i(N)&65535;P[2*O+2*N]+=k*oe,T(P,2*O+2*N),P[2*O+2*N+1]+=C*oe,T(P,2*O+2*N+1),P[2*O+2*N+1]+=k*Q,T(P,2*O+2*N+1),P[2*O+2*N+2]+=C*Q,T(P,2*O+2*N+2)}for(O=0;O<A;O++)P[O]=P[2*O+1]<<16|P[2*O];for(O=A;O<2*A;O++)P[O]=0;return new s(P,0)};function T(S,A){for(;(S[A]&65535)!=S[A];)S[A+1]+=S[A]>>>16,S[A]&=65535,A++}function E(S,A){this.g=S,this.h=A}function j(S,A){if(v(A))throw Error("division by zero");if(v(S))return new E(h,h);if(b(S))return A=j(g(S),A),new E(g(A.g),g(A.h));if(b(A))return A=j(S,g(A)),new E(g(A.g),A.h);if(30<S.g.length){if(b(S)||b(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,O=A;0>=O.l(S);)P=R(P),O=R(O);var N=D(P,1),C=D(O,1);for(O=D(O,2),P=D(P,2);!v(O);){var k=C.add(O);0>=k.l(S)&&(N=N.add(P),C=k),O=D(O,1),P=D(P,1)}return A=_(S,N.j(A)),new E(N,A)}for(N=h;0<=S.l(A);){for(P=Math.max(1,Math.floor(S.m()/A.m())),O=Math.ceil(Math.log(P)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),C=l(P),k=C.j(A);b(k)||0<k.l(S);)P-=O,C=l(P),k=C.j(A);v(C)&&(C=m),N=N.add(C),S=_(S,k)}return new E(N,S)}t.A=function(S){return j(this,S).h},t.and=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)&S.i(O);return new s(P,this.h&S.h)},t.or=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)|S.i(O);return new s(P,this.h|S.h)},t.xor=function(S){for(var A=Math.max(this.g.length,S.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)^S.i(O);return new s(P,this.h^S.h)};function R(S){for(var A=S.g.length+1,P=[],O=0;O<A;O++)P[O]=S.i(O)<<1|S.i(O-1)>>>31;return new s(P,S.h)}function D(S,A){var P=A>>5;A%=32;for(var O=S.g.length-P,N=[],C=0;C<O;C++)N[C]=0<A?S.i(C+P)>>>A|S.i(C+P+1)<<32-A:S.i(C+P);return new s(N,S.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,m1=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=u,Ci=s}).apply(typeof O0<"u"?O0:typeof self<"u"?self:typeof window<"u"?window:{});var yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var p1,ko,g1,Yl,rm,y1,v1,b1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,x){return f==Array.prototype||f==Object.prototype||(f[y]=x.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof yl=="object"&&yl];for(var y=0;y<f.length;++y){var x=f[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(f,y){if(y)e:{var x=n;f=f.split(".");for(var I=0;I<f.length-1;I++){var M=f[I];if(!(M in x))break e;x=x[M]}f=f[f.length-1],I=x[f],y=y(I),y!=I&&y!=null&&e(x,f,{configurable:!0,writable:!0,value:y})}}function a(f,y){f instanceof String&&(f+="");var x=0,I=!1,M={next:function(){if(!I&&x<f.length){var $=x++;return{value:y($,f[$]),done:!1}}return I=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(f){return f||function(){return a(this,function(y,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function c(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function l(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function u(f,y,x){return f.call.apply(f.bind,arguments)}function h(f,y,x){if(!f)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,I),f.apply(y,M)}}return function(){return f.apply(y,arguments)}}function m(f,y,x){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,y){var x=Array.prototype.slice.call(arguments,1);return function(){var I=x.slice();return I.push.apply(I,arguments),f.apply(this,I)}}function v(f,y){function x(){}x.prototype=y.prototype,f.aa=y.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(I,M,$){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return y.prototype[M].apply(I,W)}}function b(f){const y=f.length;if(0<y){const x=Array(y);for(let I=0;I<y;I++)x[I]=f[I];return x}return[]}function g(f,y){for(let x=1;x<arguments.length;x++){const I=arguments[x];if(c(I)){const M=f.length||0,$=I.length||0;f.length=M+$;for(let W=0;W<$;W++)f[M+W]=I[W]}else f.push(I)}}class _{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function j(f){return j[" "](f),f}j[" "]=function(){};var R=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(f,y,x){for(const I in f)y.call(x,f[I],I,f)}function S(f,y){for(const x in f)y.call(void 0,f[x],x,f)}function A(f){const y={};for(const x in f)y[x]=f[x];return y}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(f,y){let x,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(x in I)f[x]=I[x];for(let $=0;$<P.length;$++)x=P[$],Object.prototype.hasOwnProperty.call(I,x)&&(f[x]=I[x])}}function N(f){var y=1;f=f.split(":");const x=[];for(;0<y&&f.length;)x.push(f.shift()),y--;return f.length&&x.push(f.join(":")),x}function C(f){o.setTimeout(()=>{throw f},0)}function k(){var f=ye;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class Q{constructor(){this.h=this.g=null}add(y,x){const I=oe.get();I.set(y,x),this.h?this.h.next=I:this.g=I,this.h=I}}var oe=new _(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,he=!1,ye=new Q,Ue=()=>{const f=o.Promise.resolve(void 0);ee=()=>{f.then(se)}};var se=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(x){C(x)}var y=oe;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}he=!1};function q(){this.s=this.s,this.C=this.C}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var rt=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const x=()=>{};o.addEventListener("test",x,y),o.removeEventListener("test",x,y)}catch{}return f}();function Fe(f,y){if(J.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,I=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(R){e:{try{j(y.nodeName);var M=!0;break e}catch{}M=!1}M||(y=null)}}else x=="mouseover"?y=f.fromElement:x=="mouseout"&&(y=f.toElement);this.relatedTarget=y,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ze[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Fe.aa.h.call(this)}}v(Fe,J);var ze={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),rn=0;function G(f,y,x,I,M){this.listener=f,this.proxy=null,this.src=y,this.type=x,this.capture=!!I,this.ha=M,this.key=++rn,this.da=this.fa=!1}function de(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function be(f){this.src=f,this.g={},this.h=0}be.prototype.add=function(f,y,x,I,M){var $=f.toString();f=this.g[$],f||(f=this.g[$]=[],this.h++);var W=dt(f,y,I,M);return-1<W?(y=f[W],x||(y.fa=!1)):(y=new G(y,this.src,$,!!I,M),y.fa=x,f.push(y)),y};function B(f,y){var x=y.type;if(x in f.g){var I=f.g[x],M=Array.prototype.indexOf.call(I,y,void 0),$;($=0<=M)&&Array.prototype.splice.call(I,M,1),$&&(de(y),f.g[x].length==0&&(delete f.g[x],f.h--))}}function dt(f,y,x,I){for(var M=0;M<f.length;++M){var $=f[M];if(!$.da&&$.listener==y&&$.capture==!!x&&$.ha==I)return M}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),vt={};function bt(f,y,x,I,M){if(Array.isArray(y)){for(var $=0;$<y.length;$++)bt(f,y[$],x,I,M);return null}return x=Yc(x),f&&f[Cr]?f.K(y,x,l(I)?!!I.capture:!1,M):rr(f,y,x,!1,I,M)}function rr(f,y,x,I,M,$){if(!y)throw Error("Invalid event type");var W=l(M)?!!M.capture:!!M,Me=nn(f);if(Me||(f[Te]=Me=new be(f)),x=Me.add(y,x,I,W,$),x.proxy)return x;if(I=Ji(),x.proxy=I,I.src=f,I.listener=x,f.addEventListener)rt||(M=W),M===void 0&&(M=!1),f.addEventListener(y.toString(),I,M);else if(f.attachEvent)f.attachEvent(Gc(y.toString()),I);else if(f.addListener&&f.removeListener)f.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Ji(){function f(x){return y.call(f.src,f.listener,x)}const y=nr;return f}function kr(f,y,x,I,M){if(Array.isArray(y))for(var $=0;$<y.length;$++)kr(f,y[$],x,I,M);else I=l(I)?!!I.capture:!!I,x=Yc(x),f&&f[Cr]?(f=f.i,y=String(y).toString(),y in f.g&&($=f.g[y],x=dt($,x,I,M),-1<x&&(de($[x]),Array.prototype.splice.call($,x,1),$.length==0&&(delete f.g[y],f.h--)))):f&&(f=nn(f))&&(y=f.g[y.toString()],f=-1,y&&(f=dt(y,x,I,M)),(x=-1<f?y[f]:null)&&to(x))}function to(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[Cr])B(y.i,f);else{var x=f.type,I=f.proxy;y.removeEventListener?y.removeEventListener(x,I,f.capture):y.detachEvent?y.detachEvent(Gc(x),I):y.addListener&&y.removeListener&&y.removeListener(I),(x=nn(y))?(B(x,f),x.h==0&&(x.src=null,y[Te]=null)):de(f)}}}function Gc(f){return f in vt?vt[f]:vt[f]="on"+f}function nr(f,y){if(f.da)f=!0;else{y=new Fe(y,this);var x=f.listener,I=f.ha||f.src;f.fa&&to(f),f=x.call(I,y)}return f}function nn(f){return f=f[Te],f instanceof be?f:null}var ro="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yc(f){return typeof f=="function"?f:(f[ro]||(f[ro]=function(y){return f.handleEvent(y)}),f[ro])}function at(){q.call(this),this.i=new be(this),this.M=this,this.F=null}v(at,q),at.prototype[Cr]=!0,at.prototype.removeEventListener=function(f,y,x,I){kr(this,f,y,x,I)};function Ot(f,y){var x,I=f.F;if(I)for(x=[];I;I=I.F)x.push(I);if(f=f.M,I=y.type||y,typeof y=="string")y=new J(y,f);else if(y instanceof J)y.target=y.target||f;else{var M=y;y=new J(I,f),O(y,M)}if(M=!0,x)for(var $=x.length-1;0<=$;$--){var W=y.g=x[$];M=ea(W,I,!0,y)&&M}if(W=y.g=f,M=ea(W,I,!0,y)&&M,M=ea(W,I,!1,y)&&M,x)for($=0;$<x.length;$++)W=y.g=x[$],M=ea(W,I,!1,y)&&M}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var x=f.g[y],I=0;I<x.length;I++)de(x[I]);delete f.g[y],f.h--}}this.F=null},at.prototype.K=function(f,y,x,I){return this.i.add(String(f),y,!1,x,I)},at.prototype.L=function(f,y,x,I){return this.i.add(String(f),y,!0,x,I)};function ea(f,y,x,I){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var M=!0,$=0;$<y.length;++$){var W=y[$];if(W&&!W.da&&W.capture==x){var Me=W.listener,Mt=W.ha||W.src;W.fa&&B(f.i,W),M=Me.call(Mt,I)!==!1&&M}}return M&&!I.defaultPrevented}function ts(f,y,x){if(typeof f=="function")x&&(f=m(f,x));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function jn(f){f.g=ts(()=>{f.g=null,f.i&&(f.i=!1,jn(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class Zc extends q{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:jn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(f){q.call(this),this.h=f,this.g={}}v(Nr,q);var Xc=[];function Qc(f){D(f.g,function(y,x){this.g.hasOwnProperty(x)&&to(y)},f),f.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),Qc(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rs=o.JSON.stringify,Jc=o.JSON.parse,Rh=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function ta(){}ta.prototype.h=null;function Wr(f){return f.h||(f.h=f.i())}function el(){}var ra={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ns(){J.call(this,"d")}v(ns,J);function is(){J.call(this,"c")}v(is,J);var ce={},st=null;function ot(){return st=st||new at}ce.La="serverreachability";function qt(f){J.call(this,ce.La,f)}v(qt,J);function an(f){const y=ot();Ot(y,new qt(y))}ce.STAT_EVENT="statevent";function ht(f,y){J.call(this,ce.STAT_EVENT,f),this.stat=y}v(ht,J);function Re(f){const y=ot();Ot(y,new ht(y,f))}ce.Ma="timingevent";function na(f,y){J.call(this,ce.Ma,f),this.size=y}v(na,J);function Rt(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function tl(f,y,x,I,M,$){f.info(function(){if(f.g)if($)for(var W="",Me=$.split("&"),Mt=0;Mt<Me.length;Mt++){var Ie=Me[Mt].split("=");if(1<Ie.length){var Kt=Ie[0];Ie=Ie[1];var Gt=Kt.split("_");W=2<=Gt.length&&Gt[1]=="type"?W+(Kt+"="+Ie+"&"):W+(Kt+"=redacted&")}}else W=null;else W=$;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+y+`
`+x+`
`+W})}function On(f,y,x,I,M,$,W){f.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+y+`
`+x+`
`+$+" "+W})}function ia(f,y,x,I){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+Tk(f,x)+(I?" "+I:"")})}function Ek(f,y){f.info(function(){return"TIMEOUT: "+y})}Dt.prototype.info=function(){};function Tk(f,y){if(!f.g)return y;if(!y)return null;try{var x=JSON.parse(y);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var I=x[f];if(!(2>I.length)){var M=I[1];if(Array.isArray(M)&&!(1>M.length)){var $=M[0];if($!="noop"&&$!="stop"&&$!="close")for(var W=1;W<M.length;W++)M[W]=""}}}}return rs(x)}catch{return y}}var rl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Dh;function nl(){}v(nl,ta),nl.prototype.g=function(){return new XMLHttpRequest},nl.prototype.i=function(){return{}},Dh=new nl;function li(f,y,x,I){this.j=f,this.i=y,this.l=x,this.R=I||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ov}function ov(){this.i=null,this.g="",this.h=!1}var cv={},Mh={};function Lh(f,y,x){f.L=1,f.v=ol(Rn(y)),f.m=x,f.P=!0,lv(f,null)}function lv(f,y){f.F=Date.now(),il(f),f.A=Rn(f.v);var x=f.A,I=f.R;Array.isArray(I)||(I=[String(I)]),Ev(x.i,"t",I),f.C=0,x=f.j.J,f.h=new ov,f.g=zv(f.j,x?y:null,!f.m),0<f.O&&(f.M=new Zc(m(f.Y,f,f.g),f.O)),y=f.U,x=f.g,I=f.ca;var M="readystatechange";Array.isArray(M)||(M&&(Xc[0]=M.toString()),M=Xc);for(var $=0;$<M.length;$++){var W=bt(x,M[$],I||y.handleEvent,!1,y.h||y);if(!W)break;y.g[W.key]=W}y=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),an(),tl(f.i,f.u,f.A,f.l,f.R,f.m)}li.prototype.ca=function(f){f=f.target;const y=this.M;y&&Dn(f)==3?y.j():this.Y(f)},li.prototype.Y=function(f){try{if(f==this.g)e:{const Gt=Dn(this.g);var y=this.g.Ba();const os=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||kv(this.g)))){this.J||Gt!=4||y==7||(y==8||0>=os?an(3):an(2)),$h(this);var x=this.g.Z();this.X=x;t:if(uv(this)){var I=kv(this.g);f="";var M=I.length,$=Dn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){aa(this),no(this);var W="";break t}this.h.i=new o.TextDecoder}for(y=0;y<M;y++)this.h.h=!0,f+=this.h.i.decode(I[y],{stream:!($&&y==M-1)});I.length=0,this.h.g+=f,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=x==200,On(this.i,this.u,this.A,this.l,this.R,Gt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Mt=this.g;if((Me=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Me)){var Ie=Me;break t}}Ie=null}if(x=Ie)ia(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vh(this,x);else{this.o=!1,this.s=3,Re(12),aa(this),no(this);break e}}if(this.P){x=!0;let qr;for(;!this.J&&this.C<W.length;)if(qr=Ak(this,W),qr==Mh){Gt==4&&(this.s=4,Re(14),x=!1),ia(this.i,this.l,null,"[Incomplete Response]");break}else if(qr==cv){this.s=4,Re(15),ia(this.i,this.l,W,"[Invalid Chunk]"),x=!1;break}else ia(this.i,this.l,qr,null),Vh(this,qr);if(uv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||W.length!=0||this.h.h||(this.s=1,Re(16),x=!1),this.o=this.o&&x,!x)ia(this.i,this.l,W,"[Invalid Chunked Response]"),aa(this),no(this);else if(0<W.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Wh(Kt),Kt.M=!0,Re(11))}}else ia(this.i,this.l,W,null),Vh(this,W);Gt==4&&aa(this),this.o&&!this.J&&(Gt==4?Lv(this.j,this):(this.o=!1,il(this)))}else Uk(this.g),x==400&&0<W.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),aa(this),no(this)}}}catch{}finally{}};function uv(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Ak(f,y){var x=f.C,I=y.indexOf(`
`,x);return I==-1?Mh:(x=Number(y.substring(x,I)),isNaN(x)?cv:(I+=1,I+x>y.length?Mh:(y=y.slice(I,I+x),f.C=I+x,y)))}li.prototype.cancel=function(){this.J=!0,aa(this)};function il(f){f.S=Date.now()+f.I,dv(f,f.I)}function dv(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(m(f.ba,f),y)}function $h(f){f.B&&(o.clearTimeout(f.B),f.B=null)}li.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Ek(this.i,this.A),this.L!=2&&(an(),Re(17)),aa(this),this.s=2,no(this)):dv(this,this.S-f)};function no(f){f.j.G==0||f.J||Lv(f.j,f)}function aa(f){$h(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,Qc(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Vh(f,y){try{var x=f.j;if(x.G!=0&&(x.g==f||Fh(x.h,f))){if(!f.K&&Fh(x.h,f)&&x.G==3){try{var I=x.Da.g.parse(y)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)fl(x),dl(x);else break e;Hh(x),Re(18)}}else x.za=M[1],0<x.za-x.T&&37500>M[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rt(m(x.Za,x),6e3));if(1>=mv(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else oa(x,11)}else if((f.K||x.g==f)&&fl(x),!T(y))for(M=x.Da.g.parse(y),y=0;y<M.length;y++){let Ie=M[y];if(x.T=Ie[0],Ie=Ie[1],x.G==2)if(Ie[0]=="c"){x.K=Ie[1],x.ia=Ie[2];const Kt=Ie[3];Kt!=null&&(x.la=Kt,x.j.info("VER="+x.la));const Gt=Ie[4];Gt!=null&&(x.Aa=Gt,x.j.info("SVER="+x.Aa));const os=Ie[5];os!=null&&typeof os=="number"&&0<os&&(I=1.5*os,x.L=I,x.j.info("backChannelRequestTimeoutMs_="+I)),I=x;const qr=f.g;if(qr){const pl=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pl){var $=I.h;$.g||pl.indexOf("spdy")==-1&&pl.indexOf("quic")==-1&&pl.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(zh($,$.h),$.h=null))}if(I.D){const qh=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;qh&&(I.ya=qh,Be(I.I,I.D,qh))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),I=x;var W=f;if(I.qa=Fv(I,I.J?I.ia:null,I.W),W.K){pv(I.h,W);var Me=W,Mt=I.L;Mt&&(Me.I=Mt),Me.B&&($h(Me),il(Me)),I.g=W}else Dv(I);0<x.i.length&&hl(x)}else Ie[0]!="stop"&&Ie[0]!="close"||oa(x,7);else x.G==3&&(Ie[0]=="stop"||Ie[0]=="close"?Ie[0]=="stop"?oa(x,7):Bh(x):Ie[0]!="noop"&&x.l&&x.l.ta(Ie),x.v=0)}}an(4)}catch{}}var Sk=class{constructor(f,y){this.g=f,this.map=y}};function hv(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function fv(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function mv(f){return f.h?1:f.g?f.g.size:0}function Fh(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function zh(f,y){f.g?f.g.add(y):f.h=y}function pv(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}hv.prototype.cancel=function(){if(this.i=gv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function gv(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const x of f.g.values())y=y.concat(x.D);return y}return b(f.i)}function Ik(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var y=[],x=f.length,I=0;I<x;I++)y.push(f[I]);return y}y=[],x=0;for(I in f)y[x++]=f[I];return y}function Pk(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var y=[];f=f.length;for(var x=0;x<f;x++)y.push(x);return y}y=[],x=0;for(const I in f)y[x++]=I;return y}}}function yv(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var x=Pk(f),I=Ik(f),M=I.length,$=0;$<M;$++)y.call(void 0,I[$],x&&x[$],f)}var vv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ck(f,y){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var I=f[x].indexOf("="),M=null;if(0<=I){var $=f[x].substring(0,I);M=f[x].substring(I+1)}else $=f[x];y($,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function sa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof sa){this.h=f.h,al(this,f.j),this.o=f.o,this.g=f.g,sl(this,f.s),this.l=f.l;var y=f.i,x=new so;x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),bv(this,x),this.m=f.m}else f&&(y=String(f).match(vv))?(this.h=!1,al(this,y[1]||"",!0),this.o=io(y[2]||""),this.g=io(y[3]||"",!0),sl(this,y[4]),this.l=io(y[5]||"",!0),bv(this,y[6]||"",!0),this.m=io(y[7]||"")):(this.h=!1,this.i=new so(null,this.h))}sa.prototype.toString=function(){var f=[],y=this.j;y&&f.push(ao(y,xv,!0),":");var x=this.g;return(x||y=="file")&&(f.push("//"),(y=this.o)&&f.push(ao(y,xv,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(ao(x,x.charAt(0)=="/"?jk:Nk,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",ao(x,Rk)),f.join("")};function Rn(f){return new sa(f)}function al(f,y,x){f.j=x?io(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function sl(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function bv(f,y,x){y instanceof so?(f.i=y,Dk(f.i,f.h)):(x||(y=ao(y,Ok)),f.i=new so(y,f.h))}function Be(f,y,x){f.i.set(y,x)}function ol(f){return Be(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function io(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ao(f,y,x){return typeof f=="string"?(f=encodeURI(f).replace(y,kk),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function kk(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var xv=/[#\/\?@]/g,Nk=/[#\?:]/g,jk=/[#\?]/g,Ok=/[#\?@]/g,Rk=/#/g;function so(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function ui(f){f.g||(f.g=new Map,f.h=0,f.i&&Ck(f.i,function(y,x){f.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=so.prototype,t.add=function(f,y){ui(this),this.i=null,f=as(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(y),this.h+=1,this};function wv(f,y){ui(f),y=as(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function _v(f,y){return ui(f),y=as(f,y),f.g.has(y)}t.forEach=function(f,y){ui(this),this.g.forEach(function(x,I){x.forEach(function(M){f.call(y,M,I,this)},this)},this)},t.na=function(){ui(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),x=[];for(let I=0;I<y.length;I++){const M=f[I];for(let $=0;$<M.length;$++)x.push(y[I])}return x},t.V=function(f){ui(this);let y=[];if(typeof f=="string")_v(this,f)&&(y=y.concat(this.g.get(as(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)y=y.concat(f[x])}return y},t.set=function(f,y){return ui(this),this.i=null,f=as(this,f),_v(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function Ev(f,y,x){wv(f,y),0<x.length&&(f.i=null,f.g.set(as(f,y),b(x)),f.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var x=0;x<y.length;x++){var I=y[x];const $=encodeURIComponent(String(I)),W=this.V(I);for(I=0;I<W.length;I++){var M=$;W[I]!==""&&(M+="="+encodeURIComponent(String(W[I]))),f.push(M)}}return this.i=f.join("&")};function as(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function Dk(f,y){y&&!f.j&&(ui(f),f.i=null,f.g.forEach(function(x,I){var M=I.toLowerCase();I!=M&&(wv(this,I),Ev(this,M,x))},f)),f.j=y}function Mk(f,y){const x=new Dt;if(o.Image){const I=new Image;I.onload=p(di,x,"TestLoadImage: loaded",!0,y,I),I.onerror=p(di,x,"TestLoadImage: error",!1,y,I),I.onabort=p(di,x,"TestLoadImage: abort",!1,y,I),I.ontimeout=p(di,x,"TestLoadImage: timeout",!1,y,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=f}else y(!1)}function Lk(f,y){const x=new Dt,I=new AbortController,M=setTimeout(()=>{I.abort(),di(x,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:I.signal}).then($=>{clearTimeout(M),$.ok?di(x,"TestPingServer: ok",!0,y):di(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(M),di(x,"TestPingServer: error",!1,y)})}function di(f,y,x,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(x)}catch{}}function $k(){this.g=new Rh}function Vk(f,y,x){const I=x||"";try{yv(f,function(M,$){let W=M;l(M)&&(W=rs(M)),y.push(I+$+"="+encodeURIComponent(W))})}catch(M){throw y.push(I+"type="+encodeURIComponent("_badmap")),M}}function cl(f){this.l=f.Ub||null,this.j=f.eb||!1}v(cl,ta),cl.prototype.g=function(){return new ll(this.l,this.j)},cl.prototype.i=function(f){return function(){return f}}({});function ll(f,y){at.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(ll,at),t=ll.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,co(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,co(this)),this.g&&(this.readyState=3,co(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tv(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tv(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?oo(this):co(this),this.readyState==3&&Tv(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,oo(this))},t.Qa=function(f){this.g&&(this.response=f,oo(this))},t.ga=function(){this.g&&oo(this)};function oo(f){f.readyState=4,f.l=null,f.j=null,f.v=null,co(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=y.next();return f.join(`\r
`)};function co(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ll.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Av(f){let y="";return D(f,function(x,I){y+=I,y+=":",y+=x,y+=`\r
`}),y}function Uh(f,y,x){e:{for(I in x){var I=!1;break e}I=!0}I||(x=Av(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):Be(f,y,x))}function nt(f){at.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(nt,at);var Fk=/^https?$/i,zk=["POST","PUT"];t=nt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,x,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Dh.g(),this.v=this.o?Wr(this.o):Wr(Dh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch($){Sv(this,$);return}if(f=x||"",x=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)x.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const $ of I.keys())x.set($,I.get($));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),M=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(zk,y,void 0))||I||M||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,W]of x)this.g.setRequestHeader($,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Cv(this),this.u=!0,this.g.send(f),this.u=!1}catch($){Sv(this,$)}};function Sv(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,Iv(f),ul(f)}function Iv(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),ul(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ul(this,!0)),nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Pv(this):this.bb())},t.bb=function(){Pv(this)};function Pv(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Dn(f)!=4||f.Z()!=2)){if(f.u&&Dn(f)==4)ts(f.Ea,0,f);else if(Ot(f,"readystatechange"),Dn(f)==4){f.h=!1;try{const W=f.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var I;if(I=W===0){var M=String(f.D).match(vv)[1]||null;!M&&o.self&&o.self.location&&(M=o.self.location.protocol.slice(0,-1)),I=!Fk.test(M?M.toLowerCase():"")}x=I}if(x)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var $=2<Dn(f)?f.g.statusText:""}catch{$=""}f.l=$+" ["+f.Z()+"]",Iv(f)}}finally{ul(f)}}}}function ul(f,y){if(f.g){Cv(f);const x=f.g,I=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Ot(f,"ready");try{x.onreadystatechange=I}catch{}}}function Cv(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Dn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Dn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),Jc(y)}};function kv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function Uk(f){const y={};f=(f.g&&2<=Dn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<f.length;I++){if(T(f[I]))continue;var x=N(f[I]);const M=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=y[M]||[];y[M]=$,$.push(x)}S(y,function(I){return I.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(f,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||y}function Nv(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=lo("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=lo("baseRetryDelayMs",5e3,f),this.cb=lo("retryDelaySeedMs",1e4,f),this.Wa=lo("forwardChannelMaxRetries",2,f),this.wa=lo("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new hv(f&&f.concurrentRequestLimit),this.Da=new $k,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Nv.prototype,t.la=8,t.G=1,t.connect=function(f,y,x,I){Re(0),this.W=f,this.H=y||{},x&&I!==void 0&&(this.H.OSID=x,this.H.OAID=I),this.F=this.X,this.I=Fv(this,null,this.W),hl(this)};function Bh(f){if(jv(f),f.G==3){var y=f.U++,x=Rn(f.I);if(Be(x,"SID",f.K),Be(x,"RID",y),Be(x,"TYPE","terminate"),uo(f,x),y=new li(f,f.j,y),y.L=2,y.v=ol(Rn(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=y.v,x=!0),x||(y.g=zv(y.j,null),y.g.ea(y.v)),y.F=Date.now(),il(y)}Vv(f)}function dl(f){f.g&&(Wh(f),f.g.cancel(),f.g=null)}function jv(f){dl(f),f.u&&(o.clearTimeout(f.u),f.u=null),fl(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function hl(f){if(!fv(f.h)&&!f.s){f.s=!0;var y=f.Ga;ee||Ue(),he||(ee(),he=!0),ye.add(y,f),f.B=0}}function Bk(f,y){return mv(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(m(f.Ga,f,y),$v(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const M=new li(this,this.j,f);let $=this.o;if(this.S&&($?($=A($),O($,this.S)):$=this.S),this.m!==null||this.O||(M.H=$,$=null),this.P)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var I=this.i[x];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(y+=I,4096<y){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=Rv(this,M,y),x=Rn(this.I),Be(x,"RID",f),Be(x,"CVER",22),this.D&&Be(x,"X-HTTP-Session-Id",this.D),uo(this,x),$&&(this.O?y="headers="+encodeURIComponent(String(Av($)))+"&"+y:this.m&&Uh(x,this.m,$)),zh(this.h,M),this.Ua&&Be(x,"TYPE","init"),this.P?(Be(x,"$req",y),Be(x,"SID","null"),M.T=!0,Lh(M,x,null)):Lh(M,x,y),this.G=2}}else this.G==3&&(f?Ov(this,f):this.i.length==0||fv(this.h)||Ov(this))};function Ov(f,y){var x;y?x=y.l:x=f.U++;const I=Rn(f.I);Be(I,"SID",f.K),Be(I,"RID",x),Be(I,"AID",f.T),uo(f,I),f.m&&f.o&&Uh(I,f.m,f.o),x=new li(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Rv(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),zh(f.h,x),Lh(x,I,y)}function uo(f,y){f.H&&D(f.H,function(x,I){Be(y,I,x)}),f.l&&yv({},function(x,I){Be(y,I,x)})}function Rv(f,y,x){x=Math.min(f.i.length,x);var I=f.l?m(f.l.Na,f.l,f):null;e:{var M=f.i;let $=-1;for(;;){const W=["count="+x];$==-1?0<x?($=M[0].g,W.push("ofs="+$)):$=0:W.push("ofs="+$);let Me=!0;for(let Mt=0;Mt<x;Mt++){let Ie=M[Mt].g;const Kt=M[Mt].map;if(Ie-=$,0>Ie)$=Math.max(0,M[Mt].g-100),Me=!1;else try{Vk(Kt,W,"req"+Ie+"_")}catch{I&&I(Kt)}}if(Me){I=W.join("&");break e}}}return f=f.i.splice(0,x),y.D=f,I}function Dv(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;ee||Ue(),he||(ee(),he=!0),ye.add(y,f),f.v=0}}function Hh(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(m(f.Fa,f),$v(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Mv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),dl(this),Mv(this))};function Wh(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Mv(f){f.g=new li(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=Rn(f.qa);Be(y,"RID","rpc"),Be(y,"SID",f.K),Be(y,"AID",f.T),Be(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&Be(y,"TO",f.ja),Be(y,"TYPE","xmlhttp"),uo(f,y),f.m&&f.o&&Uh(y,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=ol(Rn(y)),x.m=null,x.P=!0,lv(x,f)}t.Za=function(){this.C!=null&&(this.C=null,dl(this),Hh(this),Re(19))};function fl(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function Lv(f,y){var x=null;if(f.g==y){fl(f),Wh(f),f.g=null;var I=2}else if(Fh(f.h,y))x=y.D,pv(f.h,y),I=1;else return;if(f.G!=0){if(y.o)if(I==1){x=y.m?y.m.length:0,y=Date.now()-y.F;var M=f.B;I=ot(),Ot(I,new na(I,x)),hl(f)}else Dv(f);else if(M=y.s,M==3||M==0&&0<y.X||!(I==1&&Bk(f,y)||I==2&&Hh(f)))switch(x&&0<x.length&&(y=f.h,y.i=y.i.concat(x)),M){case 1:oa(f,5);break;case 4:oa(f,10);break;case 3:oa(f,6);break;default:oa(f,2)}}}function $v(f,y){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*y}function oa(f,y){if(f.j.info("Error code "+y),y==2){var x=m(f.fb,f),I=f.Xa;const M=!I;I=new sa(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||al(I,"https"),ol(I),M?Mk(I.toString(),x):Lk(I.toString(),x)}else Re(2);f.G=0,f.l&&f.l.sa(y),Vv(f),jv(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Vv(f){if(f.G=0,f.ka=[],f.l){const y=gv(f.h);(y.length!=0||f.i.length!=0)&&(g(f.ka,y),g(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function Fv(f,y,x){var I=x instanceof sa?Rn(x):new sa(x);if(I.g!="")y&&(I.g=y+"."+I.g),sl(I,I.s);else{var M=o.location;I=M.protocol,y=y?y+"."+M.hostname:M.hostname,M=+M.port;var $=new sa(null);I&&al($,I),y&&($.g=y),M&&sl($,M),x&&($.l=x),I=$}return x=f.D,y=f.ya,x&&y&&Be(I,x,y),Be(I,"VER",f.la),uo(f,I),I}function zv(f,y,x){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new nt(new cl({eb:x})):new nt(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uv(){}t=Uv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ml(){}ml.prototype.g=function(f,y){return new gr(f,y)};function gr(f,y){at.call(this),this.g=new Nv(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!T(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new ss(this)}v(gr,at),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Bh(this.g)},gr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=rs(f),f=x);y.i.push(new Sk(y.Ya++,f)),y.G==3&&hl(y)},gr.prototype.N=function(){this.g.l=null,delete this.j,Bh(this.g),delete this.g,gr.aa.N.call(this)};function Bv(f){ns.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const x in y){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}v(Bv,ns);function Hv(){is.call(this),this.status=1}v(Hv,is);function ss(f){this.g=f}v(ss,Uv),ss.prototype.ua=function(){Ot(this.g,"a")},ss.prototype.ta=function(f){Ot(this.g,new Bv(f))},ss.prototype.sa=function(f){Ot(this.g,new Hv)},ss.prototype.ra=function(){Ot(this.g,"b")},ml.prototype.createWebChannel=ml.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,b1=function(){return new ml},v1=function(){return ot()},y1=ce,rm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},rl.NO_ERROR=0,rl.TIMEOUT=8,rl.HTTP_ERROR=6,Yl=rl,sv.COMPLETE="complete",g1=sv,el.EventType=ra,ra.OPEN="a",ra.CLOSE="b",ra.ERROR="c",ra.MESSAGE="d",at.prototype.listen=at.prototype.K,ko=el,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,p1=nt}).apply(typeof yl<"u"?yl:typeof self<"u"?self:typeof window<"u"?window:{});const R0="@firebase/firestore",D0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Us="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new Ap("@firebase/firestore");function us(){return Ra.logLevel}function Y(t,...e){if(Ra.logLevel<=xe.DEBUG){const r=e.map(Mp);Ra.debug(`Firestore (${Us}): ${t}`,...r)}}function Qn(t,...e){if(Ra.logLevel<=xe.ERROR){const r=e.map(Mp);Ra.error(`Firestore (${Us}): ${t}`,...r)}}function Ps(t,...e){if(Ra.logLevel<=xe.WARN){const r=e.map(Mp);Ra.warn(`Firestore (${Us}): ${t}`,...r)}}function Mp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,x1(t,n,r)}function x1(t,e,r){let n=`FIRESTORE (${Us}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Qn(n),new Error(n)}function Ne(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||x1(e,i,n)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends Cn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Xt.UNAUTHENTICATED))}shutdown(){}}class P2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class C2{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ne(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new ki;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new ki,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Y("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new ki)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ne(typeof n.accessToken=="string",31837,{l:n}),new w1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new Xt(e)}}class k2{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class N2{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new k2(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class j2{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ne(this.o===void 0,3512);const n=a=>{a.error!=null&&Y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Y("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new M0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ne(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new M0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=O2(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function we(t,e){return t<e?-1:t>e?1:0}function nm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return nf(i)===nf(a)?we(i,a):nf(i)?1:-1}return we(t.length,e.length)}const R2=55296,D2=57343;function nf(t){const e=t.charCodeAt(0);return e>=R2&&e<=D2}function Cs(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="__name__";class cn{constructor(e,r,n){r===void 0?r=0:r>e.length&&ue(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ue(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return cn.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof cn?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=cn.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return we(e.length,r.length)}static compareSegments(e,r){const n=cn.isNumericId(e),i=cn.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?cn.extractNumericId(e).compare(cn.extractNumericId(r)):nm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ci.fromString(e.substring(4,e.length-2))}}class Xe extends cn{construct(e,r,n){return new Xe(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new re(U.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Xe(r)}static emptyPath(){return new Xe([])}}const M2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends cn{construct(e,r,n){return new zt(e,r,n)}static isValidIdentifier(e){return M2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===L0}static keyField(){return new zt([L0])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new re(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new re(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new re(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new re(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(r)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.path=e}static fromPath(e){return new ae(Xe.fromString(e))}static fromName(e){return new ae(Xe.fromString(e).popFirst(5))}static empty(){return new ae(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Xe.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ae(new Xe(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(t,e,r){if(!r)throw new re(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $2(t,e,r,n){if(e===!0&&n===!0)throw new re(U.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function $0(t){if(!ae.isDocumentKey(t))throw new re(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function $p(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function ec(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=$p(t);throw new re(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(t,e){const r={typeString:t};return e&&(r.value=e),r}function Pc(t,e){if(!_1(t))throw new re(U.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new re(U.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0=-62135596800,F0=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*F0);return new qe(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new re(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<V0)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/F0}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pc(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-V0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:pt("string",qe._jsonSchemaVersion),seconds:pt("number"),nanoseconds:pt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new qe(0,0))}static max(){return new fe(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc=-1;function V2(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(n===1e9?new qe(r+1,0):new qe(r,n));return new Ri(i,ae.empty(),e)}function F2(t){return new Ri(t.readTime,t.key,tc)}class Ri{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ri(fe.min(),ae.empty(),tc)}static max(){return new Ri(fe.max(),ae.empty(),tc)}}function z2(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ae.comparator(t.documentKey,e.documentKey),r!==0?r:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class B2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bs(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==U2)throw t;Y("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new z((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof z?r:z.resolve(r)}catch(r){return z.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):z.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):z.reject(r)}static resolve(e){return new z((r,n)=>{r(e)})}static reject(e){return new z((r,n)=>{n(e)})}static waitFor(e){return new z((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},c=>n(c))}),s=!0,a===i&&r()})}static or(e){let r=z.resolve(!1);for(const n of e)r=r.next(i=>i?z.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new z((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let c=0;c<a;c++){const l=c;r(e[l]).next(u=>{s[l]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new z((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function H2(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Hs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Td.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp=-1;function Ad(t){return t==null}function vu(t){return t===0&&1/t==-1/0}function W2(t){return typeof t=="number"&&Number.isInteger(t)&&!vu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="";function q2(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=z0(e)),e=K2(t.get(r),e);return z0(e)}function K2(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case E1:r+="";break;default:r+=a}}return r}function z0(t){return t+E1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ha(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function T1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,r){this.comparator=e,this.root=r||Vt.EMPTY}insert(e,r){return new Qe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new Qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vl(this.root,e,this.comparator,!1)}getReverseIterator(){return new vl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vl(this.root,e,this.comparator,!0)}}class vl{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Vt.RED,this.left=i??Vt.EMPTY,this.right=a??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Vt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Vt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new B0(this.data.getIterator())}getIteratorFrom(e){return new B0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof At)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new At(this.comparator);return r.data=e,r}}class B0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Xr([])}unionWith(e){let r=new At(zt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Cs(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new A1("Invalid base64 string: "+a):a}}(e);return new Bt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Bt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const G2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Di(t){if(Ne(!!t,39018),typeof t=="string"){let e=0;const r=G2.exec(t);if(Ne(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mi(t){return typeof t=="string"?Bt.fromBase64String(t):Bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="server_timestamp",I1="__type__",P1="__previous_value__",C1="__local_write_time__";function Fp(t){return(t?.mapValue?.fields||{})[I1]?.stringValue===S1}function Sd(t){const e=t.mapValue.fields[P1];return Fp(e)?Sd(e):e}function rc(t){const e=Di(t.mapValue.fields[C1].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e,r,n,i,a,s,o,c,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=u}}const bu="(default)";class nc{constructor(e,r){this.projectId=e,this.database=r||bu}static empty(){return new nc("","")}get isDefaultDatabase(){return this.database===bu}isEqual(e){return e instanceof nc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="__type__",Z2="__max__",bl={mapValue:{}},N1="__vector__",xu="value";function Li(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fp(t)?4:Q2(t)?9007199254740991:X2(t)?10:11:ue(28295,{value:t})}function Tn(t,e){if(t===e)return!0;const r=Li(t);if(r!==Li(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rc(t).isEqual(rc(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Di(i.timestampValue),o=Di(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Mi(i.bytesValue).isEqual(Mi(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return ct(i.geoPointValue.latitude)===ct(a.geoPointValue.latitude)&&ct(i.geoPointValue.longitude)===ct(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return ct(i.integerValue)===ct(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=ct(i.doubleValue),o=ct(a.doubleValue);return s===o?vu(s)===vu(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Cs(t.arrayValue.values||[],e.arrayValue.values||[],Tn);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(U0(s)!==U0(o))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(o[c]===void 0||!Tn(s[c],o[c])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function ic(t,e){return(t.values||[]).find(r=>Tn(r,e))!==void 0}function ks(t,e){if(t===e)return 0;const r=Li(t),n=Li(e);if(r!==n)return we(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=ct(a.integerValue||a.doubleValue),c=ct(s.integerValue||s.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return H0(t.timestampValue,e.timestampValue);case 4:return H0(rc(t),rc(e));case 5:return nm(t.stringValue,e.stringValue);case 6:return function(a,s){const o=Mi(a),c=Mi(s);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),c=s.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=we(o[l],c[l]);if(u!==0)return u}return we(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=we(ct(a.latitude),ct(s.latitude));return o!==0?o:we(ct(a.longitude),ct(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return W0(t.arrayValue,e.arrayValue);case 10:return function(a,s){const o=a.fields||{},c=s.fields||{},l=o[xu]?.arrayValue,u=c[xu]?.arrayValue,h=we(l?.values?.length||0,u?.values?.length||0);return h!==0?h:W0(l,u)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===bl.mapValue&&s===bl.mapValue)return 0;if(a===bl.mapValue)return 1;if(s===bl.mapValue)return-1;const o=a.fields||{},c=Object.keys(o),l=s.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const m=nm(c[h],u[h]);if(m!==0)return m;const p=ks(o[c[h]],l[u[h]]);if(p!==0)return p}return we(c.length,u.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:r})}}function H0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const r=Di(t),n=Di(e),i=we(r.seconds,n.seconds);return i!==0?i:we(r.nanos,n.nanos)}function W0(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=ks(r[i],n[i]);if(a)return a}return we(r.length,n.length)}function Ns(t){return im(t)}function im(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Di(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Mi(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ae.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=im(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${im(r.fields[s])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function Zl(t){switch(Li(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Sd(t);return e?16+Zl(e):16;case 5:return 2*t.stringValue.length;case 6:return Mi(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Zl(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Ha(n.fields,(a,s)=>{i+=a.length+Zl(s)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function am(t){return!!t&&"integerValue"in t}function zp(t){return!!t&&"arrayValue"in t}function q0(t){return!!t&&"nullValue"in t}function K0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xl(t){return!!t&&"mapValue"in t}function X2(t){return(t?.mapValue?.fields||{})[k1]?.stringValue===N1}function Vo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ha(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Vo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Vo(t.arrayValue.values[r]);return e}return{...t}}function Q2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Z2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Xl(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vo(r)}setAll(e){let r=zt.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=Vo(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());Xl(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Tn(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Xl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ha(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Dr(Vo(this.value))}}function j1(t){const e=[];return Ha(t.fields,(r,n)=>{const i=new zt([r]);if(Xl(n)){const a=j1(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Qt(e,0,fe.min(),fe.min(),fe.min(),Dr.empty(),0)}static newFoundDocument(e,r,n,i){return new Qt(e,1,r,fe.min(),n,i,0)}static newNoDocument(e,r){return new Qt(e,2,r,fe.min(),fe.min(),Dr.empty(),0)}static newUnknownDocument(e,r){return new Qt(e,3,r,fe.min(),fe.min(),Dr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,r){this.position=e,this.inclusive=r}}function G0(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=ae.comparator(ae.fromName(s.referenceValue),r.key):n=ks(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function Y0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Tn(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,r="asc"){this.field=e,this.dir=r}}function J2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{}class _t extends O1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new tD(e,r,n):r==="array-contains"?new iD(e,n):r==="in"?new aD(e,n):r==="not-in"?new sD(e,n):r==="array-contains-any"?new oD(e,n):new _t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new rD(e,n):new nD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(ks(r,this.value)):r!==null&&Li(this.value)===Li(r)&&this.matchesComparison(ks(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends O1{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new An(e,r)}matches(e){return R1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function R1(t){return t.op==="and"}function D1(t){return eD(t)&&R1(t)}function eD(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function sm(t){if(t instanceof _t)return t.field.canonicalString()+t.op.toString()+Ns(t.value);if(D1(t))return t.filters.map(e=>sm(e)).join(",");{const e=t.filters.map(r=>sm(r)).join(",");return`${t.op}(${e})`}}function M1(t,e){return t instanceof _t?function(n,i){return i instanceof _t&&n.op===i.op&&n.field.isEqual(i.field)&&Tn(n.value,i.value)}(t,e):t instanceof An?function(n,i){return i instanceof An&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&M1(s,i.filters[o]),!0):!1}(t,e):void ue(19439)}function L1(t){return t instanceof _t?function(r){return`${r.field.canonicalString()} ${r.op} ${Ns(r.value)}`}(t):t instanceof An?function(r){return r.op.toString()+" {"+r.getFilters().map(L1).join(" ,")+"}"}(t):"Filter"}class tD extends _t{constructor(e,r,n){super(e,r,n),this.key=ae.fromName(n.referenceValue)}matches(e){const r=ae.comparator(e.key,this.key);return this.matchesComparison(r)}}class rD extends _t{constructor(e,r){super(e,"in",r),this.keys=$1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class nD extends _t{constructor(e,r){super(e,"not-in",r),this.keys=$1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function $1(t,e){return(e.arrayValue?.values||[]).map(r=>ae.fromName(r.referenceValue))}class iD extends _t{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return zp(r)&&ic(r.arrayValue,this.value)}}class aD extends _t{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ic(this.value.arrayValue,r)}}class sD extends _t{constructor(e,r){super(e,"not-in",r)}matches(e){if(ic(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ic(this.value.arrayValue,r)}}class oD extends _t{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!zp(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ic(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function Z0(t,e=null,r=[],n=[],i=null,a=null,s=null){return new cD(t,e,r,n,i,a,s)}function Up(t){const e=ge(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>sm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Ad(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ns(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ns(n)).join(",")),e.Te=r}return e.Te}function Bp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!J2(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!M1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Y0(t.startAt,e.startAt)&&Y0(t.endAt,e.endAt)}function om(t){return ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lD(t,e,r,n,i,a,s,o){return new Id(t,e,r,n,i,a,s,o)}function Hp(t){return new Id(t)}function X0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uD(t){return t.collectionGroup!==null}function Fo(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new At(zt.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new _u(a,n))}),r.has(zt.keyField().canonicalString())||e.Ie.push(new _u(zt.keyField(),n))}return e.Ie}function yn(t){const e=ge(t);return e.Ee||(e.Ee=dD(e,Fo(t))),e.Ee}function dD(t,e){if(t.limitType==="F")return Z0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new _u(i.field,a)});const r=t.endAt?new wu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new wu(t.startAt.position,t.startAt.inclusive):null;return Z0(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function cm(t,e,r){return new Id(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Pd(t,e){return Bp(yn(t),yn(e))&&t.limitType===e.limitType}function V1(t){return`${Up(yn(t))}|lt:${t.limitType}`}function ds(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>L1(i)).join(", ")}]`),Ad(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Ns(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Ns(i)).join(",")),`Target(${n})`}(yn(t))}; limitType=${t.limitType})`}function Cd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ae.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Fo(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,c){const l=G0(s,o,c);return s.inclusive?l<=0:l<0}(n.startAt,Fo(n),i)||n.endAt&&!function(s,o,c){const l=G0(s,o,c);return s.inclusive?l>=0:l>0}(n.endAt,Fo(n),i))}(t,e)}function hD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function F1(t){return(e,r)=>{let n=!1;for(const i of Fo(t)){const a=fD(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function fD(t,e,r){const n=t.field.isKeyField()?ae.comparator(e.key,r.key):function(a,s,o){const c=s.data.field(a),l=o.data.field(a);return c!==null&&l!==null?ks(c,l):ue(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ha(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return T1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD=new Qe(ae.comparator);function Jn(){return mD}const z1=new Qe(ae.comparator);function No(...t){let e=z1;for(const r of t)e=e.insert(r.key,r);return e}function U1(t){let e=z1;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function fa(){return zo()}function B1(){return zo()}function zo(){return new Wa(t=>t.toString(),(t,e)=>t.isEqual(e))}const pD=new Qe(ae.comparator),gD=new At(ae.comparator);function Ee(...t){let e=gD;for(const r of t)e=e.add(r);return e}const yD=new At(we);function vD(){return yD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vu(e)?"-0":e}}function H1(t){return{integerValue:""+t}}function bD(t,e){return W2(e)?H1(e):Wp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(){this._=void 0}}function xD(t,e,r){return t instanceof Eu?function(i,a){const s={fields:{[I1]:{stringValue:S1},[C1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Fp(a)&&(a=Sd(a)),a&&(s.fields[P1]=a),{mapValue:s}}(r,e):t instanceof ac?q1(t,e):t instanceof sc?K1(t,e):function(i,a){const s=W1(i,a),o=Q0(s)+Q0(i.Ae);return am(s)&&am(i.Ae)?H1(o):Wp(i.serializer,o)}(t,e)}function wD(t,e,r){return t instanceof ac?q1(t,e):t instanceof sc?K1(t,e):r}function W1(t,e){return t instanceof Tu?function(n){return am(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Eu extends kd{}class ac extends kd{constructor(e){super(),this.elements=e}}function q1(t,e){const r=G1(e);for(const n of t.elements)r.some(i=>Tn(i,n))||r.push(n);return{arrayValue:{values:r}}}class sc extends kd{constructor(e){super(),this.elements=e}}function K1(t,e){let r=G1(e);for(const n of t.elements)r=r.filter(i=>!Tn(i,n));return{arrayValue:{values:r}}}class Tu extends kd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Q0(t){return ct(t.integerValue||t.doubleValue)}function G1(t){return zp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function _D(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof ac&&i instanceof ac||n instanceof sc&&i instanceof sc?Cs(n.elements,i.elements,Tn):n instanceof Tu&&i instanceof Tu?Tn(n.Ae,i.Ae):n instanceof Eu&&i instanceof Eu}(t.transform,e.transform)}class ED{constructor(e,r){this.version=e,this.transformResults=r}}class Wn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Wn}static exists(e){return new Wn(void 0,e)}static updateTime(e){return new Wn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ql(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nd{}function Y1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new X1(t.key,Wn.none()):new Cc(t.key,t.data,Wn.none());{const r=t.data,n=Dr.empty();let i=new At(zt.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new qa(t.key,n,new Xr(i.toArray()),Wn.none())}}function TD(t,e,r){t instanceof Cc?function(i,a,s){const o=i.value.clone(),c=eb(i.fieldTransforms,a,s.transformResults);o.setAll(c),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof qa?function(i,a,s){if(!Ql(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=eb(i.fieldTransforms,a,s.transformResults),c=a.data;c.setAll(Z1(i)),c.setAll(o),a.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Uo(t,e,r,n){return t instanceof Cc?function(a,s,o,c){if(!Ql(a.precondition,s))return o;const l=a.value.clone(),u=tb(a.fieldTransforms,c,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof qa?function(a,s,o,c){if(!Ql(a.precondition,s))return o;const l=tb(a.fieldTransforms,c,s),u=s.data;return u.setAll(Z1(a)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return Ql(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function AD(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=W1(n.transform,i||null);a!=null&&(r===null&&(r=Dr.empty()),r.set(n.field,a))}return r||null}function J0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Cs(n,i,(a,s)=>_D(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cc extends Nd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class qa extends Nd{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Z1(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function eb(t,e,r){const n=new Map;Ne(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,wD(s,o,r[i]))}return n}function tb(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,xD(a,s,e))}return n}class X1 extends Nd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SD extends Nd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&TD(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Uo(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Uo(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=B1();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const c=Y1(s,o);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Cs(this.mutations,e.mutations,(r,n)=>J0(r,n))&&Cs(this.baseMutations,e.baseMutations,(r,n)=>J0(r,n))}}class qp{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ne(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return pD}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new qp(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Ae;function kD(t){switch(t){case U.OK:return ue(64938);case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function Q1(t){if(t===void 0)return Qn("GRPC error has no .code"),U.UNKNOWN;switch(t){case mt.OK:return U.OK;case mt.CANCELLED:return U.CANCELLED;case mt.UNKNOWN:return U.UNKNOWN;case mt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case mt.INTERNAL:return U.INTERNAL;case mt.UNAVAILABLE:return U.UNAVAILABLE;case mt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case mt.NOT_FOUND:return U.NOT_FOUND;case mt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case mt.ABORTED:return U.ABORTED;case mt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case mt.DATA_LOSS:return U.DATA_LOSS;default:return ue(39323,{code:t})}}(Ae=mt||(mt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=new Ci([4294967295,4294967295],0);function rb(t){const e=ND().encode(t),r=new m1;return r.update(e),new Uint8Array(r.digest())}function nb(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ci([r,n],0),new Ci([i,a],0)]}class Kp{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new jo(`Invalid padding: ${r}`);if(n<0)throw new jo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new jo(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new jo(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ci.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(Ci.fromNumber(n)));return i.compare(jD)===1&&(i=new Ci([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=rb(e),[n,i]=nb(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new Kp(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=rb(e),[n,i]=nb(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class jo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,kc.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new jd(fe.min(),i,new Qe(we),Jn(),Ee())}}class kc{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new kc(n,r,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class J1{constructor(e,r){this.targetId=e,this.Ce=r}}class eT{constructor(e,r,n=Bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class ib{constructor(){this.ve=0,this.Fe=ab(),this.Me=Bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),r=Ee(),n=Ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ue(38017,{changeType:a})}}),new kc(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=ab()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class OD{constructor(e){this.Ge=e,this.ze=new Map,this.je=Jn(),this.Je=xl(),this.He=xl(),this.Ye=new Qe(we)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(om(a))if(n===0){const s=new ae(a.path);this.et(r,s,Qt.newNoDocument(s,fe.min()))}else Ne(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),c=o?this.ct(o,e,s):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=Mi(n).toUint8Array()}catch(c){if(c instanceof A1)return Ps("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new Kp(s,i,a)}catch(c){return Ps(c instanceof jo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&om(o.target)){const c=new ae(o.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Qt.newNoDocument(c,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=Ee();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new jd(e,r,this.Ye,this.je,n);return this.je=Jn(),this.Je=xl(),this.He=xl(),this.Ye=new Qe(we),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new ib,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new At(we),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new At(we),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Y("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ib),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function xl(){return new Qe(ae.comparator)}function ab(){return new Qe(ae.comparator)}const RD={asc:"ASCENDING",desc:"DESCENDING"},DD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MD={and:"AND",or:"OR"};class LD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function lm(t,e){return t.useProto3Json||Ad(e)?e:{value:e}}function Au(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $D(t,e){return Au(t,e.toTimestamp())}function vn(t){return Ne(!!t,49232),fe.fromTimestamp(function(r){const n=Di(r);return new qe(n.seconds,n.nanos)}(t))}function Gp(t,e){return um(t,e).canonicalString()}function um(t,e){const r=function(i){return new Xe(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function rT(t){const e=Xe.fromString(t);return Ne(oT(e),10190,{key:e.toString()}),e}function dm(t,e){return Gp(t.databaseId,e.path)}function af(t,e){const r=rT(e);if(r.get(1)!==t.databaseId.projectId)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new re(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ae(iT(r))}function nT(t,e){return Gp(t.databaseId,e)}function VD(t){const e=rT(t);return e.length===4?Xe.emptyPath():iT(e)}function hm(t){return new Xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function iT(t){return Ne(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function sb(t,e,r){return{name:dm(t,e),fields:r.value.mapValue.fields}}function FD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ue(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(l,u){return l.useProto3Json?(Ne(u===void 0||typeof u=="string",58123),Bt.fromBase64String(u||"")):(Ne(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Bt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(l){const u=l.code===void 0?U.UNKNOWN:Q1(l.code);return new re(u,l.message||"")}(s);r=new eT(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=af(t,n.document.name),a=vn(n.document.updateTime),s=n.document.createTime?vn(n.document.createTime):fe.min(),o=new Dr({mapValue:{fields:n.document.fields}}),c=Qt.newFoundDocument(i,a,s,o),l=n.targetIds||[],u=n.removedTargetIds||[];r=new Jl(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=af(t,n.document),a=n.readTime?vn(n.readTime):fe.min(),s=Qt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new Jl([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=af(t,n.document),a=n.removedTargetIds||[];r=new Jl([],a,i,null)}else{if(!("filter"in e))return ue(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new CD(i,a),o=n.targetId;r=new J1(o,s)}}return r}function zD(t,e){let r;if(e instanceof Cc)r={update:sb(t,e.key,e.value)};else if(e instanceof X1)r={delete:dm(t,e.key)};else if(e instanceof qa)r={update:sb(t,e.key,e.data),updateMask:ZD(e.fieldMask)};else{if(!(e instanceof SD))return ue(16599,{Vt:e.type});r={verify:dm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof Eu)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ac)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof sc)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Tu)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw ue(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:$D(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ue(27497)}(t,e.precondition)),r}function UD(t,e){return t&&t.length>0?(Ne(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?vn(i.updateTime):vn(a);return s.isEqual(fe.min())&&(s=vn(a)),new ED(s,i.transformResults||[])}(r,e))):[]}function BD(t,e){return{documents:[nT(t,e.path)]}}function HD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=nT(t,i);const a=function(l){if(l.length!==0)return sT(An.create(l,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(l){if(l.length!==0)return l.map(u=>function(m){return{field:hs(m.field),direction:KD(m.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=lm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:r,parent:i}}function WD(t){let e=VD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ne(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=aT(h);return m instanceof An&&D1(m)?m.getFilters():[m]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(m=>function(v){return new _u(fs(v.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,Ad(m)?null:m}(r.limit));let c=null;r.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new wu(p,m)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const m=!h.before,p=h.values||[];return new wu(p,m)}(r.endAt)),lD(e,i,s,a,o,"F",c,l)}function qD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function aT(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=fs(r.unaryFilter.field);return _t.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=fs(r.unaryFilter.field);return _t.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=fs(r.unaryFilter.field);return _t.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=fs(r.unaryFilter.field);return _t.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(r){return _t.create(fs(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return An.create(r.compositeFilter.filters.map(n=>aT(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(r.compositeFilter.op))}(t):ue(30097,{filter:t})}function KD(t){return RD[t]}function GD(t){return DD[t]}function YD(t){return MD[t]}function hs(t){return{fieldPath:t.canonicalString()}}function fs(t){return zt.fromServerFormat(t.fieldPath)}function sT(t){return t instanceof _t?function(r){if(r.op==="=="){if(K0(r.value))return{unaryFilter:{field:hs(r.field),op:"IS_NAN"}};if(q0(r.value))return{unaryFilter:{field:hs(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(K0(r.value))return{unaryFilter:{field:hs(r.field),op:"IS_NOT_NAN"}};if(q0(r.value))return{unaryFilter:{field:hs(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hs(r.field),op:GD(r.op),value:r.value}}}(t):t instanceof An?function(r){const n=r.getFilters().map(i=>sT(i));return n.length===1?n[0]:{compositeFilter:{op:YD(r.op),filters:n}}}(t):ue(54877,{filter:t})}function ZD(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function oT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,r,n,i,a=fe.min(),s=fe.min(),o=Bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Ai(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.yt=e}}function QD(t){const e=WD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this.Cn=new eM}addToCollectionParentIndex(e,r){return this.Cn.add(r),z.resolve()}getCollectionParents(e,r){return z.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return z.resolve()}deleteFieldIndex(e,r){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,r){return z.resolve()}getDocumentsMatchingTarget(e,r){return z.resolve(null)}getIndexType(e,r){return z.resolve(0)}getFieldIndexes(e,r){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,r){return z.resolve(Ri.min())}getMinOffsetFromCollectionGroup(e,r){return z.resolve(Ri.min())}updateCollectionGroup(e,r,n){return z.resolve()}updateIndexEntries(e,r){return z.resolve()}}class eM{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new At(Xe.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new At(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cT=41943040;class lr{static withCacheSize(e){return new lr(e,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lr.DEFAULT_COLLECTION_PERCENTILE=10,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lr.DEFAULT=new lr(cT,lr.DEFAULT_COLLECTION_PERCENTILE,lr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lr.DISABLED=new lr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new js(0)}static cr(){return new js(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb="LruGarbageCollector",tM=1048576;function lb([t,e],[r,n]){const i=we(t,r);return i===0?we(e,n):i}class rM{constructor(e){this.Ir=e,this.buffer=new At(lb),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();lb(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class nM{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Y(cb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Hs(r)?Y(cb,"Ignoring IndexedDB error during garbage collection: ",r):await Bs(r)}await this.Vr(3e5)})}}class iM{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return z.resolve(Td.ce);const n=new rM(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Y("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(ob)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Y("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ob):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),us()<=xe.DEBUG&&Y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function aM(t,e){return new iM(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(){this.changes=new Wa(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Qt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?z.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oM{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Uo(n.mutation,i,Xr.empty(),qe.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ee()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ee()){const i=fa();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=No();return a.forEach((o,c)=>{s=s.insert(o,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=fa();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ee()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=Jn();const s=zo(),o=function(){return zo()}();return r.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof qa)?a=a.insert(l.key,l):u!==void 0?(s.set(l.key,u.mutation.getFieldMask()),Uo(u.mutation,l,u.mutation.getFieldMask(),qe.now())):s.set(l.key,Xr.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((l,u)=>s.set(l,u)),r.forEach((l,u)=>o.set(l,new oM(u,s.get(l)??null))),o))}recalculateAndSaveOverlays(e,r){const n=zo();let i=new Qe((s,o)=>s-o),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let u=n.get(c)||Xr.empty();u=o.applyToLocalView(l,u),n.set(c,u);const h=(i.get(o.batchId)||Ee()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,h=B1();u.forEach(m=>{if(!a.has(m)){const p=Y1(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,h))}return z.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ae.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):uD(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):z.resolve(fa());let o=tc,c=a;return s.next(l=>z.forEach(l,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?z.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{c=c.insert(u,m)}))).next(()=>this.populateOverlays(e,l,a)).next(()=>this.computeViews(e,c,l,Ee())).next(u=>({batchId:o,changes:U1(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ae(r)).next(n=>{let i=No();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=No();return this.indexManager.getCollectionParents(e,a).next(o=>z.forEach(o,c=>{const l=function(h,m){return new Id(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(u=>{u.forEach((h,m)=>{s=s.insert(h,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((c,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Qt.newInvalidDocument(u)))});let o=No();return s.forEach((c,l)=>{const u=a.get(c);u!==void 0&&Uo(u.mutation,l,Xr.empty(),qe.now()),Cd(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return z.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:vn(i.createTime)}}(r)),z.resolve()}getNamedQuery(e,r){return z.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:QD(i.bundledQuery),readTime:vn(i.readTime)}}(r)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this.overlays=new Qe(ae.comparator),this.qr=new Map}getOverlay(e,r){return z.resolve(this.overlays.get(r))}getOverlays(e,r){const n=fa();return z.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),z.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),z.resolve()}getOverlaysForCollection(e,r,n){const i=fa(),a=r.length+1,s=new ae(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===a&&c.largestBatchId>n&&i.set(c.getKey(),c)}return z.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Qe((l,u)=>l-u);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let u=a.get(l.largestBatchId);u===null&&(u=fa(),a=a.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=fa(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=i)););return z.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new PD(r,n));let a=this.qr.get(r);a===void 0&&(a=Ee(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(){this.Qr=new At(It.$r),this.Ur=new At(It.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new It(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new It(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ae(new Xe([])),n=new It(r,e),i=new It(r,e+1);let a=Ee();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new It(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class It{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ae.comparator(e.key,r.key)||we(e.Yr,r.Yr)}static Kr(e,r){return we(e.Yr,r.Yr)||ae.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new At(It.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ID(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new It(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return z.resolve(s)}lookupMutationBatch(e,r){return z.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Vp:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new It(r,0),i=new It(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new At(we);return r.forEach(i=>{const a=new It(i,0),s=new It(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),z.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;ae.isDocumentKey(a)||(a=a.child(""));const s=new It(new ae(a),0);let o=new At(we);return this.Zr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.Yr)),!0)},s),z.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ne(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return z.forEach(r.mutations,i=>{const a=new It(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new It(r,0),i=this.Zr.firstAfterOrEqual(n);return z.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e){this.ri=e,this.docs=function(){return new Qe(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return z.resolve(n?n.document.mutableCopy():Qt.newInvalidDocument(r))}getEntries(e,r){let n=Jn();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Qt.newInvalidDocument(i))}),z.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=Jn();const s=r.path,o=new ae(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||z2(F2(u),n)<=0||(i.has(u.key)||Cd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,r,n,i){ue(9500)}ii(e,r){return z.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new mM(this)}getSize(e){return z.resolve(this.size)}}class mM extends sM{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),z.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.persistence=e,this.si=new Wa(r=>Up(r),Bp),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new Yp,this.targetCount=0,this.ai=js.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),z.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new js(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,z.resolve()}updateTargetData(e,r){return this.Pr(r),z.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),z.waitFor(a).next(()=>i)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return z.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),z.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),z.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),z.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return z.resolve(n)}containsKey(e,r){return z.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e,r){this.ui={},this.overlays={},this.ci=new Td(0),this.li=!1,this.li=!0,this.hi=new dM,this.referenceDelegate=e(this),this.Pi=new pM(this),this.indexManager=new JD,this.remoteDocumentCache=function(i){return new fM(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new XD(r),this.Ii=new lM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new uM,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new hM(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Y("MemoryPersistence","Starting transaction:",e);const i=new gM(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return z.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class gM extends B2{constructor(e){super(),this.currentSequenceNumber=e}}class Zp{constructor(e){this.persistence=e,this.Ri=new Yp,this.Vi=null}static mi(e){return new Zp(e)}get fi(){if(this.Vi)return this.Vi;throw ue(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),z.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),z.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),z.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,n=>{const i=ae.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return z.or([()=>z.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Su{constructor(e,r){this.persistence=e,this.pi=new Wa(n=>q2(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=aM(this,r)}static mi(e,r){return new Su(e,r)}Ei(){}di(e){return z.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return z.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?z.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,fe.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Zl(e.data.value)),r}br(e,r,n){return z.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return z.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ee(),i=Ee();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new Xp(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return qN()?8:H2(tr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new yM;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(us()<=xe.DEBUG&&Y("QueryEngine","SDK will not create cache indexes for query:",ds(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(us()<=xe.DEBUG&&Y("QueryEngine","Query:",ds(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(us()<=xe.DEBUG&&Y("QueryEngine","The SDK decides to create cache indexes for query:",ds(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(r))):z.resolve())}ys(e,r){if(X0(r))return z.resolve(null);let n=yn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=cm(r,null,"F"),n=yn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=Ee(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Ds(r,o);return this.Cs(r,l,s,c.readTime)?this.ys(e,cm(r,null,"F")):this.vs(e,l,r,c)}))})))}ws(e,r,n,i){return X0(r)||i.isEqual(fe.min())?z.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?z.resolve(null):(us()<=xe.DEBUG&&Y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ds(r)),this.vs(e,s,r,V2(i,tc)).next(o=>o))})}Ds(e,r){let n=new At(F1(e));return r.forEach((i,a)=>{Cd(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return us()<=xe.DEBUG&&Y("QueryEngine","Using full collection scan to execute query:",ds(r)),this.ps.getDocumentsMatchingQuery(e,r,Ri.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="LocalStore",bM=3e8;class xM{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Qe(we),this.xs=new Wa(a=>Up(a),Bp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function wM(t,e,r,n){return new xM(t,e,r,n)}async function uT(t,e){const r=ge(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let c=Ee();for(const l of i){s.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of a){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(l=>({Ls:l,removedBatchIds:s,addedBatchIds:o}))})})}function _M(t,e){const r=ge(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const h=l.batch,m=h.keys();let p=z.resolve();return m.forEach(v=>{p=p.next(()=>u.getEntry(c,v)).next(b=>{const g=l.docVersions.get(v);Ne(g!==null,48541),b.version.compareTo(g)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),u.addEntry(b)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Ee();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function dT(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function EM(t,e){const r=ge(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const m=i.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Bt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(b,g,_){return b.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=bM?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,u)&&o.push(r.Pi.updateTargetData(a,p))});let c=Jn(),l=Ee();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(TM(a,s,e.documentUpdates).next(u=>{c=u.ks,l=u.qs})),!n.isEqual(fe.min())){const u=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return z.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,l)).next(()=>c)}).then(a=>(r.Ms=i,a))}function TM(t,e,r){let n=Ee(),i=Ee();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=Jn();return r.forEach((o,c)=>{const l=a.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(o,c.readTime),s=s.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(o,c)):Y(Qp,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{ks:s,qs:i}})}function AM(t,e){const r=ge(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Vp),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function SM(t,e){const r=ge(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,z.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ai(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function fm(t,e,r){const n=ge(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Hs(s))throw s;Y(Qp,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function ub(t,e,r){const n=ge(t);let i=fe.min(),a=Ee();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,u){const h=ge(c),m=h.xs.get(u);return m!==void 0?z.resolve(h.Ms.get(m)):h.Pi.getTargetData(l,u)}(n,s,yn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(c=>{a=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:fe.min(),r?a:Ee())).next(o=>(IM(n,hD(e),o),{documents:o,Qs:a})))}function IM(t,e,r){let n=t.Os.get(e)||fe.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class db{constructor(){this.activeTargetIds=vD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PM{constructor(){this.Mo=new db,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new db,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="ConnectivityMonitor";class fb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Y(hb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Y(hb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl=null;function mm(){return wl===null?wl=function(){return 268435456+Math.round(2147483648*Math.random())}():wl++,"0x"+wl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf="RestConnection",kM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class NM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===bu?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=mm(),o=this.zo(e,r.toUriEncodedString());Y(sf,`Sending RPC '${e}' ${s}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,a);const{host:l}=new URL(o),u=za(l);return this.Jo(e,o,c,n,u).then(h=>(Y(sf,`Received RPC '${e}' ${s}: `,h),h),h=>{throw Ps(sf,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Us}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=kM[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class OM extends NM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=mm();return new Promise((o,c)=>{const l=new p1;l.setWithCredentials(!0),l.listenOnce(g1.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Yl.NO_ERROR:const h=l.getResponseJson();Y(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Yl.TIMEOUT:Y(Yt,`RPC '${e}' ${s} timed out`),c(new re(U.DEADLINE_EXCEEDED,"Request time out"));break;case Yl.HTTP_ERROR:const m=l.getStatus();if(Y(Yt,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p?.error;if(v&&v.status&&v.message){const b=function(_){const T=_.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(T)>=0?T:U.UNKNOWN}(v.status);c(new re(b,v.message))}else c(new re(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new re(U.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{Y(Yt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Y(Yt,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}T_(e,r,n){const i=mm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=b1(),o=v1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=a.join("");Y(Yt,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=s.createWebChannel(u,c);this.I_(h);let m=!1,p=!1;const v=new jM({Yo:g=>{p?Y(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(m||(Y(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Y(Yt,`RPC '${e}' stream ${i} sending:`,g),h.send(g))},Zo:()=>h.close()}),b=(g,_,T)=>{g.listen(_,E=>{try{T(E)}catch(j){setTimeout(()=>{throw j},0)}})};return b(h,ko.EventType.OPEN,()=>{p||(Y(Yt,`RPC '${e}' stream ${i} transport opened.`),v.o_())}),b(h,ko.EventType.CLOSE,()=>{p||(p=!0,Y(Yt,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))}),b(h,ko.EventType.ERROR,g=>{p||(p=!0,Ps(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,g.name,"Message:",g.message),v.a_(new re(U.UNAVAILABLE,"The operation could not be completed")))}),b(h,ko.EventType.MESSAGE,g=>{if(!p){const _=g.data[0];Ne(!!_,16349);const T=_,E=T?.error||T[0]?.error;if(E){Y(Yt,`RPC '${e}' stream ${i} received error:`,E);const j=E.status;let R=function(A){const P=mt[A];if(P!==void 0)return Q1(P)}(j),D=E.message;R===void 0&&(R=U.INTERNAL,D="Unknown error status: "+j+" with message "+E.message),p=!0,v.a_(new re(R,D)),h.close()}else Y(Yt,`RPC '${e}' stream ${i} received:`,_),v.u_(_)}}),b(o,y1.STAT_EVENT,g=>{g.stat===rm.PROXY?Y(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===rm.NOPROXY&&Y(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function of(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(t){return new LD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb="PersistentStream";class fT{constructor(e,r,n,i,a,s,o,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new hT(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===U.RESOURCE_EXHAUSTED?(Qn(r.toString()),Qn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new re(U.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Y(mb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Y(mb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class RM extends fT{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=FD(this.serializer,e),n=function(a){if(!("targetChange"in a))return fe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?fe.min():s.readTime?vn(s.readTime):fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=hm(this.serializer),r.addTarget=function(a,s){let o;const c=s.target;if(o=om(c)?{documents:BD(a,c)}:{query:HD(a,c).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=tT(a,s.resumeToken);const l=lm(a,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(fe.min())>0){o.readTime=Au(a,s.snapshotVersion.toTimestamp());const l=lm(a,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=qD(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=hm(this.serializer),r.removeTarget=e,this.q_(r)}}class DM extends fT{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=UD(e.writeResults,e.commitTime),n=vn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=hm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>zD(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{}class LM extends MM{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,um(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new re(U.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,um(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(U.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class $M{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Qn(r),this.aa=!1):Y("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da="RemoteStore";class VM{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ka(this)&&(Y(Da,"Restarting streams for network reachability change."),await async function(c){const l=ge(c);l.Ea.add(4),await Nc(l),l.Ra.set("Unknown"),l.Ea.delete(4),await Rd(l)}(this))})}),this.Ra=new $M(n,i)}}async function Rd(t){if(Ka(t))for(const e of t.da)await e(!0)}async function Nc(t){for(const e of t.da)await e(!1)}function mT(t,e){const r=ge(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),rg(r)?tg(r):Ws(r).O_()&&eg(r,e))}function Jp(t,e){const r=ge(t),n=Ws(r);r.Ia.delete(e),n.O_()&&pT(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ka(r)&&r.Ra.set("Unknown"))}function eg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ws(t).Y_(e)}function pT(t,e){t.Va.Ue(e),Ws(t).Z_(e)}function tg(t){t.Va=new OD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ws(t).start(),t.Ra.ua()}function rg(t){return Ka(t)&&!Ws(t).x_()&&t.Ia.size>0}function Ka(t){return ge(t).Ea.size===0}function gT(t){t.Va=void 0}async function FM(t){t.Ra.set("Online")}async function zM(t){t.Ia.forEach((e,r)=>{eg(t,e)})}async function UM(t,e){gT(t),rg(t)?(t.Ra.ha(e),tg(t)):t.Ra.set("Unknown")}async function BM(t,e,r){if(t.Ra.set("Online"),e instanceof eT&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Y(Da,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Iu(t,n)}else if(e instanceof Jl?t.Va.Ze(e):e instanceof J1?t.Va.st(e):t.Va.tt(e),!r.isEqual(fe.min()))try{const n=await dT(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=a.Ia.get(l);u&&a.Ia.set(l,u.withResumeToken(c.resumeToken,s))}}),o.targetMismatches.forEach((c,l)=>{const u=a.Ia.get(c);if(!u)return;a.Ia.set(c,u.withResumeToken(Bt.EMPTY_BYTE_STRING,u.snapshotVersion)),pT(a,c);const h=new Ai(u.target,c,l,u.sequenceNumber);eg(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Y(Da,"Failed to raise snapshot:",n),await Iu(t,n)}}async function Iu(t,e,r){if(!Hs(e))throw e;t.Ea.add(1),await Nc(t),t.Ra.set("Offline"),r||(r=()=>dT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Y(Da,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Rd(t)})}function yT(t,e){return e().catch(r=>Iu(t,r,e))}async function Dd(t){const e=ge(t),r=$i(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Vp;for(;HM(e);)try{const i=await AM(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,WM(e,i)}catch(i){await Iu(e,i)}vT(e)&&bT(e)}function HM(t){return Ka(t)&&t.Ta.length<10}function WM(t,e){t.Ta.push(e);const r=$i(t);r.O_()&&r.X_&&r.ea(e.mutations)}function vT(t){return Ka(t)&&!$i(t).x_()&&t.Ta.length>0}function bT(t){$i(t).start()}async function qM(t){$i(t).ra()}async function KM(t){const e=$i(t);for(const r of t.Ta)e.ea(r.mutations)}async function GM(t,e,r){const n=t.Ta.shift(),i=qp.from(n,e,r);await yT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Dd(t)}async function YM(t,e){e&&$i(t).X_&&await async function(n,i){if(function(s){return kD(s)&&s!==U.ABORTED}(i.code)){const a=n.Ta.shift();$i(n).B_(),await yT(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Dd(n)}}(t,e),vT(t)&&bT(t)}async function pb(t,e){const r=ge(t);r.asyncQueue.verifyOperationInProgress(),Y(Da,"RemoteStore received new credentials");const n=Ka(r);r.Ea.add(3),await Nc(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Rd(r)}async function ZM(t,e){const r=ge(t);e?(r.Ea.delete(2),await Rd(r)):e||(r.Ea.add(2),await Nc(r),r.Ra.set("Unknown"))}function Ws(t){return t.ma||(t.ma=function(r,n,i){const a=ge(r);return a.sa(),new RM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:FM.bind(null,t),t_:zM.bind(null,t),r_:UM.bind(null,t),H_:BM.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),rg(t)?tg(t):t.Ra.set("Unknown")):(await t.ma.stop(),gT(t))})),t.ma}function $i(t){return t.fa||(t.fa=function(r,n,i){const a=ge(r);return a.sa(),new DM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:qM.bind(null,t),r_:YM.bind(null,t),ta:KM.bind(null,t),na:GM.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Dd(t)):(await t.fa.stop(),t.Ta.length>0&&(Y(Da,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new ng(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ig(t,e){if(Qn("AsyncQueue",`${e}: ${t}`),Hs(t))return new re(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{static emptySet(e){return new _s(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ae.comparator(r.key,n.key):(r,n)=>ae.comparator(r.key,n.key),this.keyedMap=No(),this.sortedSet=new Qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof _s)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new _s;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(){this.ga=new Qe(ae.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ue(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Os{constructor(e,r,n,i,a,s,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Os(e,r,_s.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class QM{constructor(){this.queries=yb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ge(r),a=i.queries;i.queries=yb(),a.forEach((s,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new re(U.ABORTED,"Firestore shutting down"))}}function yb(){return new Wa(t=>V1(t),Pd)}async function JM(t,e){const r=ge(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new XM,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=ig(s,`Initialization of query '${ds(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&ag(r)}async function eL(t,e){const r=ge(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function tL(t,e){const r=ge(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&ag(r)}function rL(t,e,r){const n=ge(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function ag(t){t.Ca.forEach(e=>{e.next()})}var pm,vb;(vb=pm||(pm={})).Ma="default",vb.Cache="cache";class nL{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Os(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Os.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==pm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e){this.key=e}}class wT{constructor(e){this.key=e}}class iL{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=F1(e),this.tu=new _s(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new gb,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const m=i.get(u),p=Cd(this.query,h)?h:null,v=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;m&&p?m.data.isEqual(p.data)?v!==b&&(n.track({type:3,doc:p}),g=!0):this.su(m,p)||(n.track({type:2,doc:p}),g=!0,(c&&this.eu(p,c)>0||l&&this.eu(p,l)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),g=!0):m&&!p&&(n.track({type:1,doc:m}),g=!0,(c||l)&&(o=!0)),g&&(p?(s=s.add(p),a=b?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(p,v){const b=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Rt:g})}};return b(p)-b(v)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,l=c!==this.Za;return this.Za=c,s.length!==0||l?{snapshot:new Os(this.query,e.tu,a,s,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new wT(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new xT(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ee();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Os.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const sg="SyncEngine";class aL{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class sL{constructor(e){this.key=e,this.hu=!1}}class oL{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Wa(o=>V1(o),Pd),this.Iu=new Map,this.Eu=new Set,this.du=new Qe(ae.comparator),this.Au=new Map,this.Ru=new Yp,this.Vu={},this.mu=new Map,this.fu=js.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function cL(t,e,r=!0){const n=IT(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await _T(n,e,r,!0),i}async function lL(t,e){const r=IT(t);await _T(r,e,!0,!1)}async function _T(t,e,r,n){const i=await SM(t.localStore,yn(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await uL(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&mT(t.remoteStore,i),o}async function uL(t,e,r,n,i){t.pu=(h,m,p)=>async function(b,g,_,T){let E=g.view.ru(_);E.Cs&&(E=await ub(b.localStore,g.query,!1).then(({documents:S})=>g.view.ru(S,E)));const j=T&&T.targetChanges.get(g.targetId),R=T&&T.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(E,b.isPrimaryClient,j,R);return xb(b,g.targetId,D.au),D.snapshot}(t,h,m,p);const a=await ub(t.localStore,e,!0),s=new iL(e,a.Qs),o=s.ru(a.documents),c=kc.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),l=s.applyChanges(o,t.isPrimaryClient,c);xb(t,r,l.au);const u=new aL(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function dL(t,e,r){const n=ge(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!Pd(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await fm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&Jp(n.remoteStore,i.targetId),gm(n,i.targetId)}).catch(Bs)):(gm(n,i.targetId),await fm(n.localStore,i.targetId,!0))}async function hL(t,e){const r=ge(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Jp(r.remoteStore,n.targetId))}async function fL(t,e,r){const n=xL(t);try{const i=await function(s,o){const c=ge(s),l=qe.now(),u=o.reduce((p,v)=>p.add(v.key),Ee());let h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Jn(),b=Ee();return c.Ns.getEntries(p,u).next(g=>{v=g,v.forEach((_,T)=>{T.isValidDocument()||(b=b.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,v)).next(g=>{h=g;const _=[];for(const T of o){const E=AD(T,h.get(T.key).overlayedDocument);E!=null&&_.push(new qa(T.key,E,j1(E.value.mapValue),Wn.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,_,o)}).next(g=>{m=g;const _=g.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(p,g.batchId,_)})}).then(()=>({batchId:m.batchId,changes:U1(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,c){let l=s.Vu[s.currentUser.toKey()];l||(l=new Qe(we)),l=l.insert(o,c),s.Vu[s.currentUser.toKey()]=l}(n,i.batchId,r),await jc(n,i.changes),await Dd(n.remoteStore)}catch(i){const a=ig(i,"Failed to persist write");r.reject(a)}}async function ET(t,e){const r=ge(t);try{const n=await EM(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Ne(s.hu,14607):i.removedDocuments.size>0&&(Ne(s.hu,42227),s.hu=!1))}),await jc(r,n,e)}catch(n){await Bs(n)}}function bb(t,e,r){const n=ge(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const c=ge(s);c.onlineState=o;let l=!1;c.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(o)&&(l=!0)}),l&&ag(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function mL(t,e,r){const n=ge(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new Qe(ae.comparator);s=s.insert(a,Qt.newNoDocument(a,fe.min()));const o=Ee().add(a),c=new jd(fe.min(),new Map,new Qe(we),s,o);await ET(n,c),n.du=n.du.remove(a),n.Au.delete(e),og(n)}else await fm(n.localStore,e,!1).then(()=>gm(n,e,r)).catch(Bs)}async function pL(t,e){const r=ge(t),n=e.batch.batchId;try{const i=await _M(r.localStore,e);AT(r,n,null),TT(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await jc(r,i)}catch(i){await Bs(i)}}async function gL(t,e,r){const n=ge(t);try{const i=await function(s,o){const c=ge(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(Ne(h!==null,37113),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);AT(n,e,r),TT(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await jc(n,i)}catch(i){await Bs(i)}}function TT(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function AT(t,e,r){const n=ge(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function gm(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||ST(t,n)})}function ST(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Jp(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),og(t))}function xb(t,e,r){for(const n of r)n instanceof xT?(t.Ru.addReference(n.key,e),yL(t,n)):n instanceof wT?(Y(sg,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||ST(t,n.key)):ue(19791,{wu:n})}function yL(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Y(sg,"New document in limbo: "+r),t.Eu.add(n),og(t))}function og(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ae(Xe.fromString(e)),n=t.fu.next();t.Au.set(n,new sL(r)),t.du=t.du.insert(r,n),mT(t.remoteStore,new Ai(yn(Hp(r.path)),n,"TargetPurposeLimboResolution",Td.ce))}}async function jc(t,e,r){const n=ge(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{s.push(n.pu(c,e,r).then(l=>{if((l||r)&&n.isPrimaryClient){const u=l?!l.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(l){i.push(l);const u=Xp.As(c.targetId,l);a.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,l){const u=ge(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>z.forEach(l,m=>z.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>z.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Hs(h))throw h;Y(Qp,"Failed to update sequence numbers: "+h)}for(const h of l){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),v=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,b)}}}(n.localStore,a))}async function vL(t,e){const r=ge(t);if(!r.currentUser.isEqual(e)){Y(sg,"User change. New user:",e.toKey());const n=await uT(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(c=>{c.reject(new re(U.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await jc(r,n.Ls)}}function bL(t,e){const r=ge(t),n=r.Au.get(e);if(n&&n.hu)return Ee().add(n.key);{let i=Ee();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}function IT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ET.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mL.bind(null,e),e.Pu.H_=tL.bind(null,e.eventManager),e.Pu.yu=rL.bind(null,e.eventManager),e}function xL(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=pL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gL.bind(null,e),e}class Pu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Od(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return wM(this.persistence,new vM,e.initialUser,this.serializer)}Cu(e){return new lT(Zp.mi,this.serializer)}Du(e){return new PM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Pu.provider={build:()=>new Pu};class wL extends Pu{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ne(this.persistence.referenceDelegate instanceof Su,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new nM(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?lr.withCacheSize(this.cacheSizeBytes):lr.DEFAULT;return new lT(n=>Su.mi(n,r),this.serializer)}}class ym{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>bb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=vL.bind(null,this.syncEngine),await ZM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new QM}()}createDatastore(e){const r=Od(e.databaseInfo.databaseId),n=function(a){return new OM(a)}(e.databaseInfo);return function(a,s,o,c){return new LM(a,s,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new VM(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>bb(this.syncEngine,r,0),function(){return fb.v()?new fb:new CM}())}createSyncEngine(e,r){return function(i,a,s,o,c,l,u){const h=new oL(i,a,s,o,c,l);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ge(r);Y(Da,"RemoteStore shutting down."),n.Ea.add(5),await Nc(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ym.provider={build:()=>new ym};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _L{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Qn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi="FirestoreClient";class EL{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=Lp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Y(Vi,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Y(Vi,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=ig(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function cf(t,e){t.asyncQueue.verifyOperationInProgress(),Y(Vi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await uT(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function wb(t,e){t.asyncQueue.verifyOperationInProgress();const r=await TL(t);Y(Vi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>pb(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>pb(e.remoteStore,i)),t._onlineComponents=e}async function TL(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Y(Vi,"Using user provided OfflineComponentProvider");try{await cf(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ps("Error using user provided cache. Falling back to memory cache: "+r),await cf(t,new Pu)}}else Y(Vi,"Using default OfflineComponentProvider"),await cf(t,new wL(void 0));return t._offlineComponents}async function PT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Y(Vi,"Using user provided OnlineComponentProvider"),await wb(t,t._uninitializedComponentsProvider._online)):(Y(Vi,"Using default OnlineComponentProvider"),await wb(t,new ym))),t._onlineComponents}function AL(t){return PT(t).then(e=>e.syncEngine)}async function SL(t){const e=await PT(t),r=e.eventManager;return r.onListen=cL.bind(null,e.syncEngine),r.onUnlisten=dL.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=lL.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=hL.bind(null,e.syncEngine),r}function IL(t,e,r={}){const n=new ki;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,c,l){const u=new _L({next:m=>{u.Nu(),s.enqueueAndForget(()=>eL(a,h));const p=m.docs.has(o);!p&&m.fromCache?l.reject(new re(U.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&c&&c.source==="server"?l.reject(new re(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new nL(Hp(o.path),u,{includeMetadataChanges:!0,qa:!0});return JM(a,h)}(await SL(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT="firestore.googleapis.com",Eb=!0;class Tb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new re(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kT,this.ssl=Eb}else this.host=e.host,this.ssl=e.ssl??Eb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tM)throw new re(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CT(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new re(U.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cg{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Tb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Tb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new I2;switch(n.type){case"firstParty":return new N2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new re(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=_b.get(r);n&&(Y("ComponentProvider","Removing Datastore"),_b.delete(r),n.terminate())}(this),Promise.resolve()}}function PL(t,e,r,n={}){t=ec(t,cg);const i=za(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(Ep(`https://${o}`),Tp("Firestore",!0)),a.host!==kT&&a.host!==o&&Ps("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:o,ssl:i,emulatorOptions:n};if(!ka(c,s)&&(t._setSettings(c),n.mockUserToken)){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=Xt.MOCK_USER;else{l=PE(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new re(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Xt(h)}t._authCredentials=new P2(new w1(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new lg(this.firestore,e,this._query)}}class Ct{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ct(this.firestore,e,this._key)}toJSON(){return{type:Ct._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Pc(r,Ct._jsonSchema))return new Ct(e,n||null,new ae(Xe.fromString(r.referencePath)))}}Ct._jsonSchemaVersion="firestore/documentReference/1.0",Ct._jsonSchema={type:pt("string",Ct._jsonSchemaVersion),referencePath:pt("string")};class oc extends lg{constructor(e,r,n){super(e,r,Hp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ct(this.firestore,null,new ae(e))}withConverter(e){return new oc(this.firestore,e,this._path)}}function Ab(t,e,...r){if(t=dr(t),arguments.length===1&&(e=Lp.newId()),L2("doc","path",e),t instanceof cg){const n=Xe.fromString(e,...r);return $0(n),new Ct(t,null,new ae(n))}{if(!(t instanceof Ct||t instanceof oc))throw new re(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Xe.fromString(e,...r));return $0(n),new Ct(t.firestore,t instanceof oc?t.converter:null,new ae(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sb="AsyncQueue";class Ib{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new hT(this,"async_queue_retry"),this._c=()=>{const n=of();n&&Y(Sb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=of();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=of();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new ki;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Hs(e))throw e;Y(Sb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Qn("INTERNAL UNHANDLED ERROR: ",Pb(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=ng.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:Pb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Pb(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ug extends cg{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new Ib,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ib(e),this._firestoreClient=void 0,await e}}}function CL(t,e){const r=typeof t=="object"?t:Ip(),n=typeof t=="string"?t:bu,i=xd(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=AE("firestore");a&&PL(i,...a)}return i}function NT(t){if(t._terminated)throw new re(U.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||kL(t),t._firestoreClient}function kL(t){const e=t._freezeSettings(),r=function(i,a,s,o){return new Y2(i,a,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,CT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new EL(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(Bt.fromBase64String(e))}catch(r){throw new re(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Mr(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pc(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:pt("string",Mr._jsonSchemaVersion),bytes:pt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new re(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new re(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new re(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bn._jsonSchemaVersion}}static fromJSON(e){if(Pc(e,bn._jsonSchema))return new bn(e.latitude,e.longitude)}}bn._jsonSchemaVersion="firestore/geoPoint/1.0",bn._jsonSchema={type:pt("string",bn._jsonSchemaVersion),latitude:pt("number"),longitude:pt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:xn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pc(e,xn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new xn(e.vectorValues);throw new re(U.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}xn._jsonSchemaVersion="firestore/vectorValue/1.0",xn._jsonSchema={type:pt("string",xn._jsonSchemaVersion),vectorValues:pt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL=/^__.*__$/;class jL{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new qa(e,this.data,this.fieldMask,r,this.fieldTransforms):new Cc(e,this.data,r,this.fieldTransforms)}}function OT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ac:t})}}class hg{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new hg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Cu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(OT(this.Ac)&&NL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class OL{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Od(e)}Cc(e,r,n,i=!1){return new hg({Ac:e,methodName:r,Dc:n,path:zt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function RL(t){const e=t._freezeSettings(),r=Od(t._databaseId);return new OL(t._databaseId,!!e.ignoreUndefinedProperties,r)}function DL(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);LT("Data must be an object, but it was:",s,n);const o=DT(n,s);let c,l;if(a.merge)c=new Xr(s.fieldMask),l=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=ML(e,h,r);if(!s.contains(m))throw new re(U.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);$L(u,m)||u.push(m)}c=new Xr(u),l=s.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=s.fieldTransforms;return new jL(new Dr(o),c,l)}function RT(t,e){if(MT(t=dr(t)))return LT("Unsupported field value:",e,t),DT(t,e);if(t instanceof jT)return function(n,i){if(!OT(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let c=RT(o,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return bD(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=qe.fromDate(n);return{timestampValue:Au(i.serializer,a)}}if(n instanceof qe){const a=new qe(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Au(i.serializer,a)}}if(n instanceof bn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Mr)return{bytesValue:tT(i.serializer,n._byteString)};if(n instanceof Ct){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Gp(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof xn)return function(s,o){return{mapValue:{fields:{[k1]:{stringValue:N1},[xu]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return Wp(o.serializer,l)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${$p(n)}`)}(t,e)}function DT(t,e){const r={};return T1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ha(t,(n,i)=>{const a=RT(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function MT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qe||t instanceof bn||t instanceof Mr||t instanceof Ct||t instanceof jT||t instanceof xn)}function LT(t,e,r){if(!MT(r)||!_1(r)){const n=$p(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function ML(t,e,r){if((e=dr(e))instanceof dg)return e._internalPath;if(typeof e=="string")return $T(t,e);throw Cu("Field path arguments must be of type string or ",t,!1,void 0,r)}const LL=new RegExp("[~\\*/\\[\\]]");function $T(t,e,r){if(e.search(LL)>=0)throw Cu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new dg(...e.split("."))._internalPath}catch{throw Cu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Cu(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(a||s)&&(c+=" (found",a&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new re(U.INVALID_ARGUMENT,o+t+c)}function $L(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ct(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new VL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(FT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class VL extends VT{data(){return super.data()}}function FT(t,e){return typeof e=="string"?$T(t,e):e instanceof dg?e._internalPath:e._delegate._internalPath}class FL{convertValue(e,r="none"){switch(Li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ha(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){const r=e.fields?.[xu].arrayValue?.values?.map(n=>ct(n.doubleValue));return new xn(r)}convertGeoPoint(e){return new bn(ct(e.latitude),ct(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Sd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(rc(e));default:return null}}convertTimestamp(e){const r=Di(e);return new qe(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Xe.fromString(e);Ne(oT(n),9688,{name:e});const i=new nc(n.get(1),n.get(3)),a=new ae(n.popFirst(5));return i.isEqual(r)||Qn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Oo{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _a extends VT{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new eu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(FT("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=_a._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}_a._jsonSchemaVersion="firestore/documentSnapshot/1.0",_a._jsonSchema={type:pt("string",_a._jsonSchemaVersion),bundleSource:pt("string","DocumentSnapshot"),bundleName:pt("string"),bundle:pt("string")};class eu extends _a{data(e={}){return super.data(e)}}class Bo{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Oo(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new eu(this._firestore,this._userDataWriter,n.key,n,new Oo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new re(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const c=new eu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Oo(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const c=new eu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Oo(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:UL(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new re(U.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Lp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function UL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BL(t){t=ec(t,Ct);const e=ec(t.firestore,ug);return IL(NT(e),t._key).then(r=>qL(e,t,r))}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:pt("string",Bo._jsonSchemaVersion),bundleSource:pt("string","QuerySnapshot"),bundleName:pt("string"),bundle:pt("string")};class HL extends FL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ct(this.firestore,null,r)}}function Cb(t,e,r){t=ec(t,Ct);const n=ec(t.firestore,ug),i=zL(t.converter,e);return WL(n,[DL(RL(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Wn.none())])}function WL(t,e){return function(n,i){const a=new ki;return n.asyncQueue.enqueueAndForget(async()=>fL(await AL(n),i,a)),a.promise}(NT(t),e)}function qL(t,e,r){const n=r.docs.get(e._key),i=new HL(t);return new _a(t,i,e._key,n,new Oo(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Us=i})(Ua),Na(new Oi("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new ug(new C2(n.getProvider("auth-internal")),new j2(s,n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new re(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nc(l.options.projectId,u)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),mn(R0,D0,e),mn(R0,D0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="firebasestorage.googleapis.com",KL="storageBucket",GL=2*60*1e3,YL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Cn{constructor(e,r,n=0){super(lf(e),`Firebase Storage: ${r} (${lf(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return lf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Sn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Sn||(Sn={}));function lf(t){return"storage/"+t}function ZL(){const t="An unknown error occurred, please check the error payload for server response.";return new kn(Sn.UNKNOWN,t)}function XL(){return new kn(Sn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function QL(){return new kn(Sn.CANCELED,"User canceled the upload/download.")}function JL(t){return new kn(Sn.INVALID_URL,"Invalid URL '"+t+"'.")}function e4(t){return new kn(Sn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function kb(t){return new kn(Sn.INVALID_ARGUMENT,t)}function UT(){return new kn(Sn.APP_DELETED,"The Firebase app was deleted.")}function t4(t){return new kn(Sn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qr.makeFromUrl(e,r)}catch{return new Qr(e,"")}if(n.path==="")return n;throw e4(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const s="(/(.*))?$",o=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function l(j){j.path_=decodeURIComponent(j.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},b=r===zT?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",_=new RegExp(`^https?://${b}/${i}/${g}`,"i"),E=[{regex:o,indices:c,postModify:a},{regex:p,indices:v,postModify:l},{regex:_,indices:{bucket:1,path:2},postModify:l}];for(let j=0;j<E.length;j++){const R=E[j],D=R.regex.exec(e);if(D){const S=D[R.indices.bucket];let A=D[R.indices.path];A||(A=""),n=new Qr(S,A),R.postModify(n);break}}if(n==null)throw JL(e);return n}}class r4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t,e,r){let n=1,i=null,a=null,s=!1,o=0;function c(){return o===2}let l=!1;function u(...g){l||(l=!0,e.apply(null,g))}function h(g){i=setTimeout(()=>{i=null,t(p,c())},g)}function m(){a&&clearTimeout(a)}function p(g,..._){if(l){m();return}if(g){m(),u.call(null,g,..._);return}if(c()||s){m(),u.call(null,g,..._);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let v=!1;function b(g){v||(v=!0,m(),!l&&(i!==null?(g||(o=2),clearTimeout(i),h(0)):g||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,b(!0)},r),b}function i4(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(t){return t!==void 0}function Nb(t,e,r,n){if(n<e)throw kb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw kb(`Invalid value for '${t}'. Expected ${r} or less.`)}function s4(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var ku;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ku||(ku={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o4(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e,r,n,i,a,s,o,c,l,u,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,b)=>{this.resolve_=v,this.reject_=b,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new _l(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const s=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const o=a.getErrorCode()===ku.NO_ERROR,c=a.getStatus();if(!o||o4(c,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===ku.ABORT;n(!1,new _l(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new _l(l,a))})},r=(n,i)=>{const a=this.resolve_,s=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());a4(c)?a(c):a()}catch(c){s(c)}else if(o!==null){const c=ZL();c.serverResponse=o.getErrorText(),this.errorCallback_?s(this.errorCallback_(o,c)):s(c)}else if(i.canceled){const c=this.appDelete_?UT():QL();s(c)}else{const c=XL();s(c)}};this.canceled_?r(!1,new _l(!1,null,!0)):this.backoffId_=n4(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&i4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _l{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function l4(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function u4(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function d4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function h4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function f4(t,e,r,n,i,a,s=!0,o=!1){const c=s4(t.urlParams),l=t.url+c,u=Object.assign({},t.headers);return d4(u,e),l4(u,r),u4(u,a),h4(u,n),new c4(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function p4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nu{constructor(e,r){this._service=e,r instanceof Qr?this._location=r:this._location=Qr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Nu(e,r)}get root(){const e=new Qr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return p4(this._location.path)}get storage(){return this._service}get parent(){const e=m4(this._location.path);if(e===null)return null;const r=new Qr(this._location.bucket,e);return new Nu(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw t4(e)}}function jb(t,e){const r=e?.[KL];return r==null?null:Qr.makeFromBucketSpec(r,t)}function g4(t,e,r,n={}){t.host=`${e}:${r}`;const i=za(e);i&&(Ep(`https://${t.host}/b`),Tp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:PE(a,t.app.options.projectId))}class y4{constructor(e,r,n,i,a,s=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=s,this._bucket=null,this._host=zT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=GL,this._maxUploadRetryTime=YL,this._requests=new Set,i!=null?this._bucket=Qr.makeFromBucketSpec(i,this._host):this._bucket=jb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qr.makeFromBucketSpec(this._url,e):this._bucket=jb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Nb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Nb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(_r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Nu(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new r4(UT());{const s=f4(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const Ob="@firebase/storage",Rb="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="storage";function v4(t=Ip(),e){t=dr(t);const n=xd(t,BT).getImmediate({identifier:e}),i=AE("storage");return i&&b4(n,...i),n}function b4(t,e,r,n={}){g4(t,e,r,n)}function x4(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new y4(r,n,i,e,Ua)}function w4(){Na(new Oi(BT,x4,"PUBLIC").setMultipleInstances(!0)),mn(Ob,Rb,""),mn(Ob,Rb,"esm2020")}w4();const vm={apiKey:window.__FIREBASE_CONFIG__?.apiKey,authDomain:window.__FIREBASE_CONFIG__?.authDomain,projectId:window.__FIREBASE_CONFIG__?.projectId,storageBucket:window.__FIREBASE_CONFIG__?.storageBucket,messagingSenderId:window.__FIREBASE_CONFIG__?.messagingSenderId,appId:window.__FIREBASE_CONFIG__?.appId};(!vm.apiKey||!vm.projectId)&&console.error("[Firebase] Missing configuration. Ensure .env is configured or public/firebase-config.js is loaded.");const Md=NE(vm);console.log("Firebase app initialized:",Md);const Ro=A2(Md);console.log("Firebase auth instance:",Ro);const Db=CL(Md);v4(Md);const Nn=xp((t,e)=>({user:null,initialized:!1,isLoading:!1,error:null,initialize:()=>{fR(Ro,async r=>{try{if(r){console.log("[AUTH STORE] User authenticated:",r.uid);const n=Ab(Db,"profiles",r.uid),i=await BL(n);if(i.exists()){const a=i.data();t(Se(s=>{s.user={id:r.uid,...a},s.initialized=!0,s.error=null,s.isLoading=!1}))}else{const a={id:r.uid,email:r.email,fullName:null,avatarUrl:null,preferences:{}};await Cb(n,a),t(Se(s=>{s.user=a,s.initialized=!0,s.error=null,s.isLoading=!1}))}}else t(Se(n=>{n.user=null,n.initialized=!0,n.error=null,n.isLoading=!1}))}catch(n){console.error("[AUTH STORE] Error in auth state change:",n),t(Se(i=>{i.error=n instanceof Error?n.message:"Error de autenticación",i.initialized=!0,i.isLoading=!1}))}})},signIn:async(r,n)=>{try{t(Se(i=>{i.isLoading=!0,i.error=null})),console.log("[AUTH STORE] Attempting sign in with email:",r),await uR(Ro,r,n)}catch(i){throw console.error("[AUTH STORE] Sign in error:",i),t(Se(a=>{a.error=i.message||"Error al iniciar sesión",a.isLoading=!1})),i}},signUp:async(r,n,i,a)=>{try{if(t(Se(c=>{c.isLoading=!0,c.error=null})),i&&n!==i)throw new Error("Las contraseñas no coinciden");const o=(await lR(Ro,r,n)).user;if(o){const c={id:o.uid,email:o.email,fullName:a||null,avatarUrl:null,preferences:{}},l=Ab(Db,"profiles",o.uid);await Cb(l,c)}else throw new Error("Error al crear el usuario")}catch(s){throw console.error("[AUTH STORE] Sign up error:",s),t(Se(o=>{o.error=s.message||"Error al crear la cuenta",o.isLoading=!1})),s}},signOut:async()=>{try{t(Se(r=>{r.isLoading=!0,r.error=null})),await mR(Ro)}catch(r){throw console.error("[AUTH STORE] Sign out error:",r),t(Se(n=>{n.error=r.message||"Error al cerrar sesión",n.isLoading=!1})),r}},clearError:()=>{t(Se(r=>{r.error=null}))}})),jr={initialization:{timeout:5e3,retryAttempts:2,retryDelay:1e3,emergencyFallbackTimeout:8e3},performance:{trackInitialization:!0,slowConnectionThreshold:3e3,performanceLogging:!1},ui:{showProgressIndicator:!0,progressSteps:["Conectando...","Verificando sesión...","Cargando perfil...","Inicializando..."],minLoadingTime:500}};class _4{constructor(){yr(this,"metrics");this.metrics={startTime:Date.now(),retryCount:0,errors:[],success:!1,isSlowConnection:!1,emergencyFallbackUsed:!1}}recordRetry(e){this.metrics.retryCount++,e&&this.metrics.errors.push(e)}recordError(e){this.metrics.errors.push(e)}recordSuccess(){this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime,this.metrics.success=!0,this.metrics.isSlowConnection=this.metrics.duration>jr.performance.slowConnectionThreshold}recordEmergencyFallback(){this.metrics.emergencyFallbackUsed=!0,this.metrics.endTime||(this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime)}getMetrics(){return{...this.metrics}}logPerformance(){}}const E4=()=>{const{user:t,initialized:e,initialize:r}=Nn(),[n,i]=w.useState({initialized:!1,loading:!1,error:null,progress:{step:0,message:jr.ui.progressSteps[0]},retryCount:0,emergencyFallbackUsed:!1}),a=w.useRef(null),s=w.useRef({}),o=w.useRef(!1),c=b=>{b<jr.ui.progressSteps.length&&i(g=>({...g,progress:{step:b,message:jr.ui.progressSteps[b]}}))},l=()=>{Object.values(s.current).forEach(b=>{b&&clearTimeout(b)}),s.current={}},u=()=>{a.current&&(a.current.recordSuccess(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,error:null})),l()},h=(b,g=!0)=>{a.current&&a.current.recordError(b),i(_=>({..._,error:b,loading:!g})),g&&n.retryCount<jr.initialization.retryAttempts&&m()},m=()=>{const b=n.retryCount+1;a.current&&a.current.recordRetry(`Retry attempt ${b}`),i(g=>({...g,retryCount:b,progress:{step:0,message:`Reintentando... (${b}/${jr.initialization.retryAttempts})`}})),s.current.retry=setTimeout(()=>{v()},jr.initialization.retryDelay)},p=()=>{n.emergencyFallbackUsed||(console.warn("[Auth] Emergency fallback triggered - forcing app render"),a.current&&(a.current.recordEmergencyFallback(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,emergencyFallbackUsed:!0,error:"Inicialización lenta - continuando..."})),l())},v=async()=>{i(b=>({...b,loading:!0,error:null})),c(1);try{jr.performance.trackInitialization&&!a.current&&(a.current=new _4),c(2),await r(),c(3),jr.ui.minLoadingTime>0&&await new Promise(b=>setTimeout(b,jr.ui.minLoadingTime)),u()}catch(b){const g=b instanceof Error?b.message:"Error de inicialización";h(g)}};return w.useEffect(()=>{if(!o.current){if(o.current=!0,e){u();return}return s.current.primary=setTimeout(()=>{n.initialized||h("Timeout de inicialización",!0)},jr.initialization.timeout),s.current.emergency=setTimeout(()=>{n.initialized||p()},jr.initialization.emergencyFallbackTimeout),v(),()=>{l()}}},[]),w.useEffect(()=>{e&&!n.initialized&&u()},[e,n.initialized]),{...n,user:t,metrics:a.current?.getMetrics()}};function T4(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const A4=t=>{switch(t){case"success":return P4;case"info":return k4;case"warning":return C4;case"error":return N4;default:return null}},S4=Array(12).fill(0),I4=({visible:t,className:e})=>H.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},H.createElement("div",{className:"sonner-spinner"},S4.map((r,n)=>H.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),P4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),C4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),k4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),N4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},H.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),j4=H.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},H.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),O4=()=>{const[t,e]=H.useState(document.hidden);return H.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let bm=1;class R4{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,a=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:bm++,s=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:n}),{...c,...e,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...i,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let a=n!==void 0,s;const o=i.then(async l=>{if(s=["resolve",l],H.isValidElement(l))a=!1,this.create({id:n,type:"default",message:l});else if(M4(l)&&!l.ok){a=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${l.status}`):r.error,m=typeof r.description=="function"?await r.description(`HTTP error! status: ${l.status}`):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(l instanceof Error){a=!1;const h=typeof r.error=="function"?await r.error(l):r.error,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(r.success!==void 0){a=!1;const h=typeof r.success=="function"?await r.success(l):r.success,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!H.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:m,...v})}}).catch(async l=>{if(s=["reject",l],r.error!==void 0){a=!1;const u=typeof r.error=="function"?await r.error(l):r.error,h=typeof r.description=="function"?await r.description(l):r.description,p=typeof u=="object"&&!H.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:h,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((l,u)=>o.then(()=>s[0]==="reject"?u(s[1]):l(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(e,r)=>{const n=r?.id||bm++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const or=new R4,D4=(t,e)=>{const r=e?.id||bm++;return or.addToast({title:t,...e,id:r}),r},M4=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",L4=D4,$4=()=>or.toasts,V4=()=>or.getActiveToasts(),HT=Object.assign(L4,{success:or.success,info:or.info,warning:or.warning,error:or.error,custom:or.custom,message:or.message,promise:or.promise,dismiss:or.dismiss,loading:or.loading},{getHistory:$4,getToasts:V4});T4("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function El(t){return t.label!==void 0}const F4=3,z4="24px",U4="16px",Mb=4e3,B4=356,H4=14,W4=45,q4=200;function on(...t){return t.filter(Boolean).join(" ")}function K4(t){const[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}const G4=t=>{var e,r,n,i,a,s,o,c,l;const{invert:u,toast:h,unstyled:m,interacting:p,setHeights:v,visibleToasts:b,heights:g,index:_,toasts:T,expanded:E,removeToast:j,defaultRichColors:R,closeButton:D,style:S,cancelButtonStyle:A,actionButtonStyle:P,className:O="",descriptionClassName:N="",duration:C,position:k,gap:Q,expandByDefault:oe,classNames:X,icons:ee,closeButtonAriaLabel:he="Close toast"}=t,[ye,Ue]=H.useState(null),[se,q]=H.useState(null),[J,rt]=H.useState(!1),[Fe,ze]=H.useState(!1),[Cr,rn]=H.useState(!1),[G,de]=H.useState(!1),[be,B]=H.useState(!1),[dt,Te]=H.useState(0),[vt,bt]=H.useState(0),rr=H.useRef(h.duration||C||Mb),Ji=H.useRef(null),kr=H.useRef(null),to=_===0,Gc=_+1<=b,nr=h.type,nn=h.dismissible!==!1,ro=h.className||"",Yc=h.descriptionClassName||"",at=H.useMemo(()=>g.findIndex(ce=>ce.toastId===h.id)||0,[g,h.id]),Ot=H.useMemo(()=>{var ce;return(ce=h.closeButton)!=null?ce:D},[h.closeButton,D]),ea=H.useMemo(()=>h.duration||C||Mb,[h.duration,C]),ts=H.useRef(0),jn=H.useRef(0),Zc=H.useRef(0),Nr=H.useRef(null),[Xc,Qc]=k.split("-"),rs=H.useMemo(()=>g.reduce((ce,st,ot)=>ot>=at?ce:ce+st.height,0),[g,at]),Jc=O4(),Rh=h.invert||u,ta=nr==="loading";jn.current=H.useMemo(()=>at*Q+rs,[at,rs]),H.useEffect(()=>{rr.current=ea},[ea]),H.useEffect(()=>{rt(!0)},[]),H.useEffect(()=>{const ce=kr.current;if(ce){const st=ce.getBoundingClientRect().height;return bt(st),v(ot=>[{toastId:h.id,height:st,position:h.position},...ot]),()=>v(ot=>ot.filter(qt=>qt.toastId!==h.id))}},[v,h.id]),H.useLayoutEffect(()=>{if(!J)return;const ce=kr.current,st=ce.style.height;ce.style.height="auto";const ot=ce.getBoundingClientRect().height;ce.style.height=st,bt(ot),v(qt=>qt.find(ht=>ht.toastId===h.id)?qt.map(ht=>ht.toastId===h.id?{...ht,height:ot}:ht):[{toastId:h.id,height:ot,position:h.position},...qt])},[J,h.title,h.description,v,h.id,h.jsx,h.action,h.cancel]);const Wr=H.useCallback(()=>{ze(!0),Te(jn.current),v(ce=>ce.filter(st=>st.toastId!==h.id)),setTimeout(()=>{j(h)},q4)},[h,j,v,jn]);H.useEffect(()=>{if(h.promise&&nr==="loading"||h.duration===1/0||h.type==="loading")return;let ce;return E||p||Jc?(()=>{if(Zc.current<ts.current){const qt=new Date().getTime()-ts.current;rr.current=rr.current-qt}Zc.current=new Date().getTime()})():(()=>{rr.current!==1/0&&(ts.current=new Date().getTime(),ce=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),Wr()},rr.current))})(),()=>clearTimeout(ce)},[E,p,h,nr,Jc,Wr]),H.useEffect(()=>{h.delete&&(Wr(),h.onDismiss==null||h.onDismiss.call(h,h))},[Wr,h.delete]);function el(){var ce;if(ee?.loading){var st;return H.createElement("div",{className:on(X?.loader,h==null||(st=h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":nr==="loading"},ee.loading)}return H.createElement(I4,{className:on(X?.loader,h==null||(ce=h.classNames)==null?void 0:ce.loader),visible:nr==="loading"})}const ra=h.icon||ee?.[nr]||A4(nr);var ns,is;return H.createElement("li",{tabIndex:0,ref:kr,className:on(O,ro,X?.toast,h==null||(e=h.classNames)==null?void 0:e.toast,X?.default,X?.[nr],h==null||(r=h.classNames)==null?void 0:r[nr]),"data-sonner-toast":"","data-rich-colors":(ns=h.richColors)!=null?ns:R,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":J,"data-promise":!!h.promise,"data-swiped":be,"data-removed":Fe,"data-visible":Gc,"data-y-position":Xc,"data-x-position":Qc,"data-index":_,"data-front":to,"data-swiping":Cr,"data-dismissible":nn,"data-type":nr,"data-invert":Rh,"data-swipe-out":G,"data-swipe-direction":se,"data-expanded":!!(E||oe&&J),style:{"--index":_,"--toasts-before":_,"--z-index":T.length-_,"--offset":`${Fe?dt:jn.current}px`,"--initial-height":oe?"auto":`${vt}px`,...S,...h.style},onDragEnd:()=>{rn(!1),Ue(null),Nr.current=null},onPointerDown:ce=>{ce.button!==2&&(ta||!nn||(Ji.current=new Date,Te(jn.current),ce.target.setPointerCapture(ce.pointerId),ce.target.tagName!=="BUTTON"&&(rn(!0),Nr.current={x:ce.clientX,y:ce.clientY})))},onPointerUp:()=>{var ce,st,ot;if(G||!nn)return;Nr.current=null;const qt=Number(((ce=kr.current)==null?void 0:ce.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),an=Number(((st=kr.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ht=new Date().getTime()-((ot=Ji.current)==null?void 0:ot.getTime()),Re=ye==="x"?qt:an,na=Math.abs(Re)/ht;if(Math.abs(Re)>=W4||na>.11){Te(jn.current),h.onDismiss==null||h.onDismiss.call(h,h),q(ye==="x"?qt>0?"right":"left":an>0?"down":"up"),Wr(),de(!0);return}else{var Rt,Dt;(Rt=kr.current)==null||Rt.style.setProperty("--swipe-amount-x","0px"),(Dt=kr.current)==null||Dt.style.setProperty("--swipe-amount-y","0px")}B(!1),rn(!1),Ue(null)},onPointerMove:ce=>{var st,ot,qt;if(!Nr.current||!nn||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;const ht=ce.clientY-Nr.current.y,Re=ce.clientX-Nr.current.x;var na;const Rt=(na=t.swipeDirections)!=null?na:K4(k);!ye&&(Math.abs(Re)>1||Math.abs(ht)>1)&&Ue(Math.abs(Re)>Math.abs(ht)?"x":"y");let Dt={x:0,y:0};const tl=On=>1/(1.5+Math.abs(On)/20);if(ye==="y"){if(Rt.includes("top")||Rt.includes("bottom"))if(Rt.includes("top")&&ht<0||Rt.includes("bottom")&&ht>0)Dt.y=ht;else{const On=ht*tl(ht);Dt.y=Math.abs(On)<Math.abs(ht)?On:ht}}else if(ye==="x"&&(Rt.includes("left")||Rt.includes("right")))if(Rt.includes("left")&&Re<0||Rt.includes("right")&&Re>0)Dt.x=Re;else{const On=Re*tl(Re);Dt.x=Math.abs(On)<Math.abs(Re)?On:Re}(Math.abs(Dt.x)>0||Math.abs(Dt.y)>0)&&B(!0),(ot=kr.current)==null||ot.style.setProperty("--swipe-amount-x",`${Dt.x}px`),(qt=kr.current)==null||qt.style.setProperty("--swipe-amount-y",`${Dt.y}px`)}},Ot&&!h.jsx&&nr!=="loading"?H.createElement("button",{"aria-label":he,"data-disabled":ta,"data-close-button":!0,onClick:ta||!nn?()=>{}:()=>{Wr(),h.onDismiss==null||h.onDismiss.call(h,h)},className:on(X?.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(is=ee?.close)!=null?is:j4):null,(nr||h.icon||h.promise)&&h.icon!==null&&(ee?.[nr]!==null||h.icon)?H.createElement("div",{"data-icon":"",className:on(X?.icon,h==null||(i=h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||el():null,h.type!=="loading"?ra:null):null,H.createElement("div",{"data-content":"",className:on(X?.content,h==null||(a=h.classNames)==null?void 0:a.content)},H.createElement("div",{"data-title":"",className:on(X?.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?H.createElement("div",{"data-description":"",className:on(N,Yc,X?.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),H.isValidElement(h.cancel)?h.cancel:h.cancel&&El(h.cancel)?H.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||A,onClick:ce=>{El(h.cancel)&&nn&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,ce),Wr())},className:on(X?.cancelButton,h==null||(c=h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,H.isValidElement(h.action)?h.action:h.action&&El(h.action)?H.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:ce=>{El(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,ce),!ce.defaultPrevented&&Wr())},className:on(X?.actionButton,h==null||(l=h.classNames)==null?void 0:l.actionButton)},h.action.label):null)};function Lb(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Y4(t,e){const r={};return[t,e].forEach((n,i)=>{const a=i===1,s=a?"--mobile-offset":"--offset",o=a?U4:z4;function c(l){["top","right","bottom","left"].forEach(u=>{r[`${s}-${u}`]=typeof l=="number"?`${l}px`:l})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(l=>{n[l]===void 0?r[`${s}-${l}`]=o:r[`${s}-${l}`]=typeof n[l]=="number"?`${n[l]}px`:n[l]}):c(o)}),r}const Z4=H.forwardRef(function(e,r){const{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:o,className:c,offset:l,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:v,visibleToasts:b=F4,toastOptions:g,dir:_=Lb(),gap:T=H4,icons:E,containerAriaLabel:j="Notifications"}=e,[R,D]=H.useState([]),S=H.useMemo(()=>Array.from(new Set([i].concat(R.filter(se=>se.position).map(se=>se.position)))),[R,i]),[A,P]=H.useState([]),[O,N]=H.useState(!1),[C,k]=H.useState(!1),[Q,oe]=H.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=H.useRef(null),ee=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),he=H.useRef(null),ye=H.useRef(!1),Ue=H.useCallback(se=>{D(q=>{var J;return(J=q.find(rt=>rt.id===se.id))!=null&&J.delete||or.dismiss(se.id),q.filter(({id:rt})=>rt!==se.id)})},[]);return H.useEffect(()=>or.subscribe(se=>{if(se.dismiss){requestAnimationFrame(()=>{D(q=>q.map(J=>J.id===se.id?{...J,delete:!0}:J))});return}setTimeout(()=>{qk.flushSync(()=>{D(q=>{const J=q.findIndex(rt=>rt.id===se.id);return J!==-1?[...q.slice(0,J),{...q[J],...se},...q.slice(J+1)]:[se,...q]})})})}),[R]),H.useEffect(()=>{if(h!=="system"){oe(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?oe("dark"):oe("light")),typeof window>"u")return;const se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:q})=>{oe(q?"dark":"light")})}catch{se.addListener(({matches:J})=>{try{oe(J?"dark":"light")}catch(rt){console.error(rt)}})}},[h]),H.useEffect(()=>{R.length<=1&&N(!1)},[R]),H.useEffect(()=>{const se=q=>{var J;if(a.every(ze=>q[ze]||q.code===ze)){var Fe;N(!0),(Fe=X.current)==null||Fe.focus()}q.code==="Escape"&&(document.activeElement===X.current||(J=X.current)!=null&&J.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),H.useEffect(()=>{if(X.current)return()=>{he.current&&(he.current.focus({preventScroll:!0}),he.current=null,ye.current=!1)}},[X.current]),H.createElement("section",{ref:r,"aria-label":`${j} ${ee}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},S.map((se,q)=>{var J;const[rt,Fe]=se.split("-");return R.length?H.createElement("ol",{key:se,dir:_==="auto"?Lb():_,tabIndex:-1,ref:X,className:c,"data-sonner-toaster":!0,"data-sonner-theme":Q,"data-y-position":rt,"data-x-position":Fe,style:{"--front-toast-height":`${((J=A[0])==null?void 0:J.height)||0}px`,"--width":`${B4}px`,"--gap":`${T}px`,...v,...Y4(l,u)},onBlur:ze=>{ye.current&&!ze.currentTarget.contains(ze.relatedTarget)&&(ye.current=!1,he.current&&(he.current.focus({preventScroll:!0}),he.current=null))},onFocus:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,he.current=ze.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{C||N(!1)},onDragEnd:()=>N(!1),onPointerDown:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||k(!0)},onPointerUp:()=>k(!1)},R.filter(ze=>!ze.position&&q===0||ze.position===se).map((ze,Cr)=>{var rn,G;return H.createElement(G4,{key:ze.id,icons:E,index:Cr,toast:ze,defaultRichColors:m,duration:(rn=g?.duration)!=null?rn:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:n,visibleToasts:b,closeButton:(G=g?.closeButton)!=null?G:o,interacting:C,position:se,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:Ue,toasts:R.filter(de=>de.position==ze.position),heights:A.filter(de=>de.position==ze.position),setHeights:P,expandByDefault:s,gap:T,expanded:O,swipeDirections:e.swipeDirections})})):null}))});class X4{constructor(){yr(this,"listeners",new Set)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}success(e,r,n){this.emit({type:"success",title:e,message:r,duration:n})}error(e,r,n){this.emit({type:"error",title:e,message:r,duration:n})}warning(e,r,n){this.emit({type:"warning",title:e,message:r,duration:n})}info(e,r,n){this.emit({type:"info",title:e,message:r,duration:n})}}const Ld=new X4,WT=w.createContext(void 0),qs=()=>{const t=w.useContext(WT);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},Q4=t=>{switch(t){case"success":return d.jsx(Si,{size:20,className:"text-green-500"});case"error":return d.jsx(Jr,{size:20,className:"text-red-500"});case"warning":return d.jsx(En,{size:20,className:"text-yellow-500"});case"info":return d.jsx(Q_,{size:20,className:"text-blue-500"})}},J4=t=>{switch(t){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800";case"warning":return"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800";case"info":return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800"}},e$=({children:t})=>{const[e,r]=w.useState([]),n=w.useCallback(s=>{const o=`toast-${Date.now()}-${Math.random()}`,c={id:o,duration:5e3,...s};r(l=>[...l,c]),c.duration!==0&&setTimeout(()=>{i(o)},c.duration)},[]);w.useEffect(()=>Ld.subscribe(o=>{n(o)}),[n]);const i=w.useCallback(s=>{r(o=>o.filter(c=>c.id!==s))},[]),a=w.useCallback(()=>{r([])},[]);return d.jsxs(WT.Provider,{value:{toasts:e,addToast:n,removeToast:i,clearToasts:a},children:[t,d.jsx(t$,{})]})},t$=()=>{const{toasts:t,removeToast:e}=qs();return d.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:d.jsx(ke,{children:t.map(r=>d.jsx(L.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{type:"spring",damping:25,stiffness:300},className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${J4(r.type)}`,role:"alert","aria-live":"assertive",tabIndex:0,children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"flex-shrink-0 mt-0.5",children:Q4(r.type)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.title}),r.message&&d.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r.message})]}),d.jsx("button",{onClick:()=>e(r.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Cerrar notificación",children:d.jsx(Wi,{size:16})})]})},r.id))})})},yi={QUERY:{STALE_TIME:{MEDIUM:1e3*60*15},GC_TIME:{MEDIUM:1e3*60*30,LONG:1e3*60*60},RETRY:{COUNT:1,DELAY:1e3}}},ho={measureTime:async(t,e)=>typeof e=="function"?await e():e,markStart:t=>{},markEnd:t=>{},debounce:(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(void 0,n),e)}},throttle:(t,e)=>{let r;return(...n)=>{r||(t.apply(void 0,n),r=!0,setTimeout(()=>r=!1,e))}}},r$=()=>(w.useEffect(()=>{},[]),{measureTime:ho.measureTime,markStart:ho.markStart,markEnd:ho.markEnd,debounce:ho.debounce,throttle:ho.throttle}),n$=()=>{const t=()=>{const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`),typeof CSS<"u"&&CSS.supports&&CSS.supports("padding","env(safe-area-inset-top)")?(document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-bottom","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)")):(document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-bottom","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px"))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(t,100)}),"visualViewport"in window&&window.visualViewport?.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),"visualViewport"in window&&window.visualViewport?.removeEventListener("resize",t)}};const i$=()=>{const[t,e]=w.useState({isOnline:navigator.onLine});return w.useEffect(()=>{const r=()=>{const o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e({isOnline:navigator.onLine,connectionType:o?.type,effectiveType:o?.effectiveType,downlink:o?.downlink,rtt:o?.rtt})},n=()=>{console.log("[Network] Connection restored"),r()},i=()=>{console.log("[Network] Connection lost"),r()},a=()=>{console.log("[Network] Connection changed"),r()};r(),window.addEventListener("online",n),window.addEventListener("offline",i);const s=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return s&&s.addEventListener("change",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i),s&&s.removeEventListener("change",a)}},[]),t},a$=()=>{const t=i$();return{...t,quality:(()=>{if(!t.isOnline)return"offline";if(t.effectiveType)switch(t.effectiveType){case"4g":return"fast";case"3g":return"slow";case"2g":return"slow";case"slow-2g":return"slow";default:return"fast"}return t.downlink!==void 0?t.downlink>1.5?"fast":"slow":"fast"})()}},s$=()=>{const[t,e]=w.useState(!1);a$();const{user:r,initialized:n}=Nn();return null},o$=()=>{},fg=(t,e)=>{console.error(`[CRITICAL][${t}]`,e),console.warn("Production error detected:",{context:t,error:e})};function qT(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=qT(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Le(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=qT(t))&&(n&&(n+=" "),n+=e);return n}const mg="-",c$=t=>{const e=u$(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(mg);return o[0]===""&&o.length!==1&&o.shift(),KT(o,e)||l$(s)},getConflictingClassGroupIds:(s,o)=>{const c=r[s]||[];return o&&n[s]?[...c,...n[s]]:c}}},KT=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?KT(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(mg);return e.validators.find(({validator:s})=>s(a))?.classGroupId},$b=/^\[(.+)\]$/,l$=t=>{if($b.test(t)){const e=$b.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},u$=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return h$(Object.entries(t.classGroups),r).forEach(([a,s])=>{xm(s,n,a,e)}),n},xm=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:Vb(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(d$(i)){xm(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{xm(s,Vb(e,a),r,n)})})},Vb=(t,e)=>{let r=t;return e.split(mg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},d$=t=>t.isThemeGetter,h$=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,f$=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},GT="!",m$=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const c=[];let l=0,u=0,h;for(let g=0;g<o.length;g++){let _=o[g];if(l===0){if(_===i&&(n||o.slice(g,g+a)===e)){c.push(o.slice(u,g)),u=g+a;continue}if(_==="/"){h=g;continue}}_==="["?l++:_==="]"&&l--}const m=c.length===0?o:o.substring(u),p=m.startsWith(GT),v=p?m.substring(1):m,b=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},p$=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},g$=t=>({cache:f$(t.cacheSize),parseClassName:m$(t),...c$(t)}),y$=/\s+/,v$=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(y$);let o="";for(let c=s.length-1;c>=0;c-=1){const l=s[c],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=r(l);let v=!!p,b=n(v?m.substring(0,p):m);if(!b){if(!v){o=l+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=l+(o.length>0?" "+o:o);continue}v=!1}const g=p$(u).join(":"),_=h?g+GT:g,T=_+b;if(a.includes(T))continue;a.push(T);const E=i(b,v);for(let j=0;j<E.length;++j){const R=E[j];a.push(_+R)}o=l+(o.length>0?" "+o:o)}return o};function b$(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=YT(e))&&(n&&(n+=" "),n+=r);return n}const YT=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=YT(t[n]))&&(r&&(r+=" "),r+=e);return r};function x$(t,...e){let r,n,i,a=s;function s(c){const l=e.reduce((u,h)=>h(u),t());return r=g$(l),n=r.cache.get,i=r.cache.set,a=o,o(c)}function o(c){const l=n(c);if(l)return l;const u=v$(c,r);return i(c,u),u}return function(){return a(b$.apply(null,arguments))}}const He=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},ZT=/^\[(?:([a-z-]+):)?(.+)\]$/i,w$=/^\d+\/\d+$/,_$=new Set(["px","full","screen"]),E$=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,T$=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,A$=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,S$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,I$=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Mn=t=>Es(t)||_$.has(t)||w$.test(t),fi=t=>Ks(t,"length",D$),Es=t=>!!t&&!Number.isNaN(Number(t)),uf=t=>Ks(t,"number",Es),fo=t=>!!t&&Number.isInteger(Number(t)),P$=t=>t.endsWith("%")&&Es(t.slice(0,-1)),ve=t=>ZT.test(t),mi=t=>E$.test(t),C$=new Set(["length","size","percentage"]),k$=t=>Ks(t,C$,XT),N$=t=>Ks(t,"position",XT),j$=new Set(["image","url"]),O$=t=>Ks(t,j$,L$),R$=t=>Ks(t,"",M$),mo=()=>!0,Ks=(t,e,r)=>{const n=ZT.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},D$=t=>T$.test(t)&&!A$.test(t),XT=()=>!1,M$=t=>S$.test(t),L$=t=>I$.test(t),$$=()=>{const t=He("colors"),e=He("spacing"),r=He("blur"),n=He("brightness"),i=He("borderColor"),a=He("borderRadius"),s=He("borderSpacing"),o=He("borderWidth"),c=He("contrast"),l=He("grayscale"),u=He("hueRotate"),h=He("invert"),m=He("gap"),p=He("gradientColorStops"),v=He("gradientColorStopPositions"),b=He("inset"),g=He("margin"),_=He("opacity"),T=He("padding"),E=He("saturate"),j=He("scale"),R=He("sepia"),D=He("skew"),S=He("space"),A=He("translate"),P=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",ve,e],C=()=>[ve,e],k=()=>["",Mn,fi],Q=()=>["auto",Es,ve],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>["start","end","center","between","around","evenly","stretch"],ye=()=>["","0",ve],Ue=()=>["auto","avoid","all","avoid-page","page","left","right","column"],se=()=>[Es,ve];return{cacheSize:500,separator:":",theme:{colors:[mo],spacing:[Mn,fi],blur:["none","",mi,ve],brightness:se(),borderColor:[t],borderRadius:["none","","full",mi,ve],borderSpacing:C(),borderWidth:k(),contrast:se(),grayscale:ye(),hueRotate:se(),invert:ye(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[P$,fi],inset:N(),margin:N(),opacity:se(),padding:C(),saturate:se(),scale:se(),sepia:ye(),skew:se(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[mi]}],"break-after":[{"break-after":Ue()}],"break-before":[{"break-before":Ue()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),ve]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",fo,ve]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",fo,ve]}],"grid-cols":[{"grid-cols":[mo]}],"col-start-end":[{col:["auto",{span:["full",fo,ve]},ve]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[mo]}],"row-start-end":[{row:["auto",{span:[fo,ve]},ve]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...he()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...he(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...he(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ve,e]}],"min-w":[{"min-w":[ve,e,"min","max","fit"]}],"max-w":[{"max-w":[ve,e,"none","full","min","max","fit","prose",{screen:[mi]},mi]}],h:[{h:[ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",mi,fi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",uf]}],"font-family":[{font:[mo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",Es,uf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Mn,ve]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Mn,fi]}],"underline-offset":[{"underline-offset":["auto",Mn,ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),N$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",k$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},O$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:X()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Mn,ve]}],"outline-w":[{outline:[Mn,fi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Mn,fi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",mi,R$]}],"shadow-color":[{shadow:[mo]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",mi,ve]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:se()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:se()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[fo,ve]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Mn,fi,uf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},V$=x$($$),Et=null,F$=Object.freeze(Object.defineProperty({__proto__:null,supabase:Et},Symbol.toStringTag,{value:"Module"}));function Oe(...t){return V$(Le(t))}const wt={auth:"/auth",dashboard:"/",camera:"/camera",settings:"/settings",gardenChat:"/garden-chat",plantDetail:t=>`/plant/${t}`,plantChat:t=>`/plant/${t}/chat`},gt={toDashboard:()=>wt.dashboard,toCamera:()=>wt.camera,toSettings:()=>wt.settings,toGardenChat:()=>wt.gardenChat,toPlantDetail:t=>wt.plantDetail(t),toPlantChat:t=>wt.plantChat(t),toAuth:()=>wt.auth},z$=(t,e)=>t===e?!0:e===wt.dashboard?t==="/"||t.startsWith("/plant/"):e===wt.gardenChat?t===wt.gardenChat||t.includes("/chat")||t.includes("/garden-chat"):e===wt.settings?t.startsWith("/settings"):!1;let Tl;const U$=new Uint8Array(16);function B$(){if(!Tl&&(Tl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Tl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Tl(U$)}const Lt=[];for(let t=0;t<256;++t)Lt.push((t+256).toString(16).slice(1));function H$(t,e=0){return Lt[t[e+0]]+Lt[t[e+1]]+Lt[t[e+2]]+Lt[t[e+3]]+"-"+Lt[t[e+4]]+Lt[t[e+5]]+"-"+Lt[t[e+6]]+Lt[t[e+7]]+"-"+Lt[t[e+8]]+Lt[t[e+9]]+"-"+Lt[t[e+10]]+Lt[t[e+11]]+Lt[t[e+12]]+Lt[t[e+13]]+Lt[t[e+14]]+Lt[t[e+15]]}const W$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fb={randomUUID:W$};function q$(t,e,r){if(Fb.randomUUID&&!t)return Fb.randomUUID();t=t||{};const n=t.random||(t.rng||B$)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,H$(n)}const QT=5,K$=QT*1024*1024,JT=t=>{if(!t||typeof t!="string")throw new Error("URL de imagen inválida");const e=t.split(",")[1];if(!e)throw new Error("Formato de imagen inválido");const r=e.length*3/4;if(r>K$){const n=(r/1048576).toFixed(1);throw new Error(`La imagen es demasiado grande (${n}MB). El límite máximo es ${QT}MB. Por favor, usa una imagen más pequeña.`)}console.log(`[imageService] Image size validation passed: ${(r/(1024*1024)).toFixed(2)}MB`)},G$=t=>{if(!t||typeof t!="string")throw new Error("Invalid data URL: input is not a string");if(!t.startsWith("data:"))throw new Error('Invalid data URL: does not start with "data:"');const e=t.split(",");if(e.length!==2)throw new Error("Invalid data URL: incorrect format");const r=e[0].match(/:(.*?);/);if(!r)throw new Error("Invalid data URL: could not extract MIME type");const n=r[1];if(!n.startsWith("image/"))throw new Error(`Invalid data URL: not an image MIME type (${n})`);try{const i=atob(e[1]);let a=i.length;const s=new Uint8Array(a);for(;a--;)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}catch(i){throw new Error(`Invalid data URL: failed to decode base64 data - ${i instanceof Error?i.message:"Unknown error"}`)}},eA=async(t,e,r)=>{try{JT(t);const n=G$(t),i=n.type.split("/")[1],a=`${r}/${q$()}.${i}`,{error:s}=await Et.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(s)throw console.error("Error uploading image to Supabase Storage:",s),new Error(`Storage error: ${s.message}`);const{data:o}=Et.storage.from(e).getPublicUrl(a);if(!o||!o.publicUrl)throw new Error("Could not get public URL for uploaded image.");return o.publicUrl}catch(n){throw console.error("Failed to upload image:",n),n instanceof Error?new Error(`Image upload failed: ${n.message}`):new Error("An unknown error occurred during image upload.")}};function F(t,e,r){function n(o,c){var l;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(l=o._zod).traits??(l.traits=new Set),o._zod.traits.add(t),e(o,c);for(const u in s.prototype)u in o||Object.defineProperty(o,u,{value:s.prototype[u].bind(o)});o._zod.constr=s,o._zod.def=c}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var c;const l=r?.Parent?new a:this;n(l,o),(c=l._zod).deferred??(c.deferred=[]);for(const u of l._zod.deferred)u();return l}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}class cc extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const tA={};function Ma(t){return tA}function Y$(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function Z$(t,e){return typeof e=="bigint"?e.toString():e}function rA(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function pg(t){return t==null}function gg(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function X$(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}function Ge(t,e,r){Object.defineProperty(t,e,{get(){{const n=r();return t[e]=n,n}},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function yg(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function po(t){return JSON.stringify(t)}const nA=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function wm(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const Q$=rA(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function _m(t){if(wm(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(wm(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const J$=new Set(["string","number","symbol"]);function $d(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ga(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function ne(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function e5(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const t5={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function r5(t,e){const r={},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Ga(t,{...t._zod.def,shape:r,checks:[]})}function n5(t,e){const r={...t._zod.def.shape},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Ga(t,{...t._zod.def,shape:r,checks:[]})}function i5(t,e){if(!_m(e))throw new Error("Invalid input to extend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return yg(this,"shape",n),n},checks:[]};return Ga(t,r)}function a5(t,e){return Ga(t,{...t._zod.def,get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return yg(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function s5(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in n))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=t?new t({type:"optional",innerType:n[a]}):n[a])}else for(const a in n)i[a]=t?new t({type:"optional",innerType:n[a]}):n[a];return Ga(e,{...e._zod.def,shape:i,checks:[]})}function o5(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=new t({type:"nonoptional",innerType:n[a]}))}else for(const a in n)i[a]=new t({type:"nonoptional",innerType:n[a]});return Ga(e,{...e._zod.def,shape:i,checks:[]})}function Ho(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function vg(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Al(t){return typeof t=="string"?t:t?.message}function La(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=Al(t.inst?._zod.def?.error?.(t))??Al(e?.error?.(t))??Al(r.customError?.(t))??Al(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function bg(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function lc(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}const iA=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,Z$,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},aA=F("$ZodError",iA),sA=F("$ZodError",iA,{Parent:Error});function c5(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function l5(t,e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(r(s));else{let o=n,c=0;for(;c<s.path.length;){const l=s.path[c];c===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(s))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return i(t),n}const u5=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new cc;if(s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>La(c,a,Ma())));throw nA(o,i?.callee),o}return s.value},d5=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>La(c,a,Ma())));throw nA(o,i?.callee),o}return s.value},oA=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new cc;return a.issues.length?{success:!1,error:new(t??aA)(a.issues.map(s=>La(s,i,Ma())))}:{success:!0,data:a.value}},h5=oA(sA),cA=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>La(s,i,Ma())))}:{success:!0,data:a.value}},f5=cA(sA),m5=/^[cC][^\s-]{8,}$/,p5=/^[0-9a-z]+$/,g5=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,y5=/^[0-9a-vA-V]{20}$/,v5=/^[A-Za-z0-9]{27}$/,b5=/^[a-zA-Z0-9_-]{21}$/,x5=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,w5=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,zb=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,_5=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,E5="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function T5(){return new RegExp(E5,"u")}const A5=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,S5=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,I5=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,P5=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,C5=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,lA=/^[A-Za-z0-9_-]*$/,k5=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,N5=/^\+(?:[0-9]){6,14}[0-9]$/,uA="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",j5=new RegExp(`^${uA}$`);function dA(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function O5(t){return new RegExp(`^${dA(t)}$`)}function R5(t){const e=dA({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${uA}T(?:${n})$`)}const D5=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},M5=/^\d+$/,L5=/^-?\d+(?:\.\d+)?/i,$5=/true|false/i,V5=/^[^A-Z]*$/,F5=/^[^a-z]*$/,hr=F("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),hA={number:"number",bigint:"bigint",object:"date"},fA=F("$ZodCheckLessThan",(t,e)=>{hr.init(t,e);const r=hA[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),mA=F("$ZodCheckGreaterThan",(t,e)=>{hr.init(t,e);const r=hA[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),z5=F("$ZodCheckMultipleOf",(t,e)=>{hr.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):X$(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),U5=F("$ZodCheckNumberFormat",(t,e)=>{hr.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=t5[e.format];t._zod.onattach.push(s=>{const o=s._zod.bag;o.format=e.format,o.minimum=i,o.maximum=a,r&&(o.pattern=M5)}),t._zod.check=s=>{const o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:n,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}o<i&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:t})}}),B5=F("$ZodCheckMaxLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!pg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const s=bg(i);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),H5=F("$ZodCheckMinLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!pg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const s=bg(i);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),W5=F("$ZodCheckLengthEquals",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!pg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const s=bg(i),o=a>e.length;n.issues.push({origin:s,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Vd=F("$ZodCheckStringFormat",(t,e)=>{var r,n;hr.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),q5=F("$ZodCheckRegex",(t,e)=>{Vd.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),K5=F("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=V5),Vd.init(t,e)}),G5=F("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=F5),Vd.init(t,e)}),Y5=F("$ZodCheckIncludes",(t,e)=>{hr.init(t,e);const r=$d(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),Z5=F("$ZodCheckStartsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`^${$d(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),X5=F("$ZodCheckEndsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`.*${$d(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),Q5=F("$ZodCheckOverwrite",(t,e)=>{hr.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class J5{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(s=>s),i=Math.min(...n.map(s=>s.length-s.trimStart().length)),a=n.map(s=>s.slice(i)).map(s=>" ".repeat(this.indent*2)+s);for(const s of a)this.content.push(s)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const eV={major:4,minor:0,patch:5},Je=F("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=eV;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,s,o)=>{let c=Ho(a),l;for(const u of s){if(u._zod.def.when){if(!u._zod.def.when(a))continue}else if(c)continue;const h=a.issues.length,m=u._zod.check(a);if(m instanceof Promise&&o?.async===!1)throw new cc;if(l||m instanceof Promise)l=(l??Promise.resolve()).then(async()=>{await m,a.issues.length!==h&&(c||(c=Ho(a,h)))});else{if(a.issues.length===h)continue;c||(c=Ho(a,h))}}return l?l.then(()=>a):a};t._zod.run=(a,s)=>{const o=t._zod.parse(a,s);if(o instanceof Promise){if(s.async===!1)throw new cc;return o.then(c=>i(c,n,s))}return i(o,n,s)}}t["~standard"]={validate:i=>{try{const a=h5(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return f5(t,i).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),xg=F("$ZodString",(t,e)=>{Je.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??D5(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Ze=F("$ZodStringFormat",(t,e)=>{Vd.init(t,e),xg.init(t,e)}),tV=F("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=w5),Ze.init(t,e)}),rV=F("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=zb(n))}else e.pattern??(e.pattern=zb());Ze.init(t,e)}),nV=F("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=_5),Ze.init(t,e)}),iV=F("$ZodURL",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{try{const n=r.value,i=new URL(n),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:k5.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),aV=F("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=T5()),Ze.init(t,e)}),sV=F("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=b5),Ze.init(t,e)}),oV=F("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=m5),Ze.init(t,e)}),cV=F("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=p5),Ze.init(t,e)}),lV=F("$ZodULID",(t,e)=>{e.pattern??(e.pattern=g5),Ze.init(t,e)}),uV=F("$ZodXID",(t,e)=>{e.pattern??(e.pattern=y5),Ze.init(t,e)}),dV=F("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=v5),Ze.init(t,e)}),hV=F("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=R5(e)),Ze.init(t,e)}),fV=F("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=j5),Ze.init(t,e)}),mV=F("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=O5(e)),Ze.init(t,e)}),pV=F("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=x5),Ze.init(t,e)}),gV=F("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=A5),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),yV=F("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=S5),Ze.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),vV=F("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=I5),Ze.init(t,e)}),bV=F("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=P5),Ze.init(t,e),t._zod.check=r=>{const[n,i]=r.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function pA(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const xV=F("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=C5),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{pA(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function wV(t){if(!lA.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return pA(r)}const _V=F("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=lA),Ze.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{wV(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),EV=F("$ZodE164",(t,e)=>{e.pattern??(e.pattern=N5),Ze.init(t,e)});function TV(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const AV=F("$ZodJWT",(t,e)=>{Ze.init(t,e),t._zod.check=r=>{TV(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),gA=F("$ZodNumber",(t,e)=>{Je.init(t,e),t._zod.pattern=t._zod.bag.pattern??L5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),SV=F("$ZodNumber",(t,e)=>{U5.init(t,e),gA.init(t,e)}),IV=F("$ZodBoolean",(t,e)=>{Je.init(t,e),t._zod.pattern=$5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),PV=F("$ZodUnknown",(t,e)=>{Je.init(t,e),t._zod.parse=r=>r}),CV=F("$ZodNever",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),kV=F("$ZodDate",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function Ub(t,e,r){t.issues.length&&e.issues.push(...vg(r,t.issues)),e.value[r]=t.value}const NV=F("$ZodArray",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let s=0;s<i.length;s++){const o=i[s],c=e.element._zod.run({value:o,issues:[]},n);c instanceof Promise?a.push(c.then(l=>Ub(l,r,s))):Ub(c,r,s)}return a.length?Promise.all(a).then(()=>r):r}});function Sl(t,e,r){t.issues.length&&e.issues.push(...vg(r,t.issues)),e.value[r]=t.value}function Bb(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...vg(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}const jV=F("$ZodObject",(t,e)=>{Je.init(t,e);const r=rA(()=>{const h=Object.keys(e.shape);for(const p of h)if(!(e.shape[p]instanceof Je))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const m=e5(e.shape);return{shape:e.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(m)}});Ge(t._zod,"propValues",()=>{const h=e.shape,m={};for(const p in h){const v=h[p]._zod;if(v.values){m[p]??(m[p]=new Set);for(const b of v.values)m[p].add(b)}}return m});const n=h=>{const m=new J5(["shape","payload","ctx"]),p=r.value,v=T=>{const E=po(T);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};m.write("const input = payload.value;");const b=Object.create(null);let g=0;for(const T of p.keys)b[T]=`key_${g++}`;m.write("const newResult = {}");for(const T of p.keys)if(p.optionalKeys.has(T)){const E=b[T];m.write(`const ${E} = ${v(T)};`);const j=po(T);m.write(`
        if (${E}.issues.length) {
          if (input[${j}] === undefined) {
            if (${j} in input) {
              newResult[${j}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${j}, ...iss.path] : [${j}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${j} in input) newResult[${j}] = undefined;
        } else {
          newResult[${j}] = ${E}.value;
        }
        `)}else{const E=b[T];m.write(`const ${E} = ${v(T)};`),m.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${po(T)}, ...iss.path] : [${po(T)}]
          })));`),m.write(`newResult[${po(T)}] = ${E}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const _=m.compile();return(T,E)=>_(h,T,E)};let i;const a=wm,s=!tA.jitless,c=s&&Q$.value,l=e.catchall;let u;t._zod.parse=(h,m)=>{u??(u=r.value);const p=h.value;if(!a(p))return h.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),h;const v=[];if(s&&c&&m?.async===!1&&m.jitless!==!0)i||(i=n(e.shape)),h=i(h,m);else{h.value={};const E=u.shape;for(const j of u.keys){const R=E[j],D=R._zod.run({value:p[j],issues:[]},m),S=R._zod.optin==="optional"&&R._zod.optout==="optional";D instanceof Promise?v.push(D.then(A=>S?Bb(A,h,j,p):Sl(A,h,j))):S?Bb(D,h,j,p):Sl(D,h,j)}}if(!l)return v.length?Promise.all(v).then(()=>h):h;const b=[],g=u.keySet,_=l._zod,T=_.def.type;for(const E of Object.keys(p)){if(g.has(E))continue;if(T==="never"){b.push(E);continue}const j=_.run({value:p[E],issues:[]},m);j instanceof Promise?v.push(j.then(R=>Sl(R,h,E))):Sl(j,h,E)}return b.length&&h.issues.push({code:"unrecognized_keys",keys:b,input:p,inst:t}),v.length?Promise.all(v).then(()=>h):h}});function Hb(t,e,r,n){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(a=>La(a,n,Ma())))}),e}const OV=F("$ZodUnion",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ge(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ge(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Ge(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>gg(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let i=!1;const a=[];for(const s of e.options){const o=s._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)a.push(o),i=!0;else{if(o.issues.length===0)return o;a.push(o)}}return i?Promise.all(a).then(s=>Hb(s,r,t,n)):Hb(a,r,t,n)}}),RV=F("$ZodIntersection",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),s=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||s instanceof Promise?Promise.all([a,s]).then(([c,l])=>Wb(r,c,l)):Wb(r,a,s)}});function Em(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(_m(t)&&_m(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const s=Em(t[a],e[a]);if(!s.valid)return{valid:!1,mergeErrorPath:[a,...s.mergeErrorPath]};i[a]=s.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],s=Em(i,a);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Wb(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),Ho(t))return t;const n=Em(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const DV=F("$ZodEnum",(t,e)=>{Je.init(t,e);const r=Y$(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>J$.has(typeof n)).map(n=>typeof n=="string"?$d(n):n.toString()).join("|")})$`),t._zod.parse=(n,i)=>{const a=n.value;return t._zod.values.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:t}),n}}),MV=F("$ZodTransform",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(s=>(r.value=s,r));if(i instanceof Promise)throw new cc;return r.value=i,r}}),LV=F("$ZodOptional",(t,e)=>{Je.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${gg(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),$V=F("$ZodNullable",(t,e)=>{Je.init(t,e),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${gg(r.source)}|null)$`):void 0}),Ge(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),VV=F("$ZodDefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>qb(a,e)):qb(i,e)}});function qb(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const FV=F("$ZodPrefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),zV=F("$ZodNonOptional",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>Kb(a,t)):Kb(i,t)}});function Kb(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const UV=F("$ZodCatch",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ge(t._zod,"optout",()=>e.innerType._zod.optout),Ge(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(s=>La(s,n,Ma()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>La(a,n,Ma()))},input:r.value}),r.issues=[]),r)}}),BV=F("$ZodPipe",(t,e)=>{Je.init(t,e),Ge(t._zod,"values",()=>e.in._zod.values),Ge(t._zod,"optin",()=>e.in._zod.optin),Ge(t._zod,"optout",()=>e.out._zod.optout),Ge(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>Gb(a,e,n)):Gb(i,e,n)}});function Gb(t,e,r){return Ho(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}const HV=F("$ZodReadonly",(t,e)=>{Je.init(t,e),Ge(t._zod,"propValues",()=>e.innerType._zod.propValues),Ge(t._zod,"values",()=>e.innerType._zod.values),Ge(t._zod,"optin",()=>e.innerType._zod.optin),Ge(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(Yb):Yb(i)}});function Yb(t){return t.value=Object.freeze(t.value),t}const WV=F("$ZodCustom",(t,e)=>{hr.init(t,e),Je.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>Zb(a,r,n,t));Zb(i,r,n,t)}});function Zb(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(lc(i))}}class qV{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function KV(){return new qV}const Il=KV();function GV(t,e){return new t({type:"string",...ne(e)})}function YV(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ne(e)})}function Xb(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ne(e)})}function ZV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ne(e)})}function XV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ne(e)})}function QV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ne(e)})}function JV(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ne(e)})}function e3(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ne(e)})}function t3(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ne(e)})}function r3(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ne(e)})}function n3(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ne(e)})}function i3(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ne(e)})}function a3(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ne(e)})}function s3(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ne(e)})}function o3(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ne(e)})}function c3(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ne(e)})}function l3(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ne(e)})}function u3(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ne(e)})}function d3(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ne(e)})}function h3(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ne(e)})}function f3(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ne(e)})}function m3(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ne(e)})}function p3(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ne(e)})}function g3(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ne(e)})}function y3(t,e){return new t({type:"string",format:"date",check:"string_format",...ne(e)})}function v3(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ne(e)})}function b3(t,e){return new t({type:"string",format:"duration",check:"string_format",...ne(e)})}function x3(t,e){return new t({type:"number",checks:[],...ne(e)})}function w3(t,e){return new t({type:"number",coerce:!0,checks:[],...ne(e)})}function _3(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ne(e)})}function E3(t,e){return new t({type:"boolean",...ne(e)})}function T3(t){return new t({type:"unknown"})}function A3(t,e){return new t({type:"never",...ne(e)})}function S3(t,e){return new t({type:"date",...ne(e)})}function Qb(t,e){return new fA({check:"less_than",...ne(e),value:t,inclusive:!1})}function tu(t,e){return new fA({check:"less_than",...ne(e),value:t,inclusive:!0})}function Jb(t,e){return new mA({check:"greater_than",...ne(e),value:t,inclusive:!1})}function ru(t,e){return new mA({check:"greater_than",...ne(e),value:t,inclusive:!0})}function ex(t,e){return new z5({check:"multiple_of",...ne(e),value:t})}function yA(t,e){return new B5({check:"max_length",...ne(e),maximum:t})}function ju(t,e){return new H5({check:"min_length",...ne(e),minimum:t})}function vA(t,e){return new W5({check:"length_equals",...ne(e),length:t})}function I3(t,e){return new q5({check:"string_format",format:"regex",...ne(e),pattern:t})}function P3(t){return new K5({check:"string_format",format:"lowercase",...ne(t)})}function C3(t){return new G5({check:"string_format",format:"uppercase",...ne(t)})}function k3(t,e){return new Y5({check:"string_format",format:"includes",...ne(e),includes:t})}function N3(t,e){return new Z5({check:"string_format",format:"starts_with",...ne(e),prefix:t})}function j3(t,e){return new X5({check:"string_format",format:"ends_with",...ne(e),suffix:t})}function Oc(t){return new Q5({check:"overwrite",tx:t})}function O3(t){return Oc(e=>e.normalize(t))}function R3(){return Oc(t=>t.trim())}function D3(){return Oc(t=>t.toLowerCase())}function M3(){return Oc(t=>t.toUpperCase())}function L3(t,e,r){return new t({type:"array",element:e,...ne(r)})}function $3(t,e,r){return new t({type:"custom",check:"custom",fn:e,...ne(r)})}const V3=F("ZodISODateTime",(t,e)=>{hV.init(t,e),et.init(t,e)});function F3(t){return g3(V3,t)}const z3=F("ZodISODate",(t,e)=>{fV.init(t,e),et.init(t,e)});function U3(t){return y3(z3,t)}const B3=F("ZodISOTime",(t,e)=>{mV.init(t,e),et.init(t,e)});function H3(t){return v3(B3,t)}const W3=F("ZodISODuration",(t,e)=>{pV.init(t,e),et.init(t,e)});function q3(t){return b3(W3,t)}const bA=(t,e)=>{aA.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>l5(t,r)},flatten:{value:r=>c5(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},K3=F("ZodError",bA),Fd=F("ZodError",bA,{Parent:Error}),G3=u5(Fd),Y3=d5(Fd),Z3=oA(Fd),X3=cA(Fd),ut=F("ZodType",(t,e)=>(Je.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Ga(t,r,n),t.brand=()=>t,t.register=(r,n)=>(r.add(t,n),t),t.parse=(r,n)=>G3(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>Z3(t,r,n),t.parseAsync=async(r,n)=>Y3(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>X3(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(B6(r,n)),t.superRefine=r=>t.check(H6(r)),t.overwrite=r=>t.check(Oc(r)),t.optional=()=>ix(t),t.nullable=()=>ax(t),t.nullish=()=>ix(ax(t)),t.nonoptional=r=>D6(t,r),t.array=()=>_e(t),t.or=r=>A6([t,r]),t.and=r=>I6(t,r),t.transform=r=>sx(t,C6(r)),t.default=r=>j6(t,r),t.prefault=r=>R6(t,r),t.catch=r=>L6(t,r),t.pipe=r=>sx(t,r),t.readonly=()=>F6(t),t.describe=r=>{const n=t.clone();return Il.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return Il.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return Il.get(t);const n=t.clone();return Il.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),xA=F("_ZodString",(t,e)=>{xg.init(t,e),ut.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(I3(...n)),t.includes=(...n)=>t.check(k3(...n)),t.startsWith=(...n)=>t.check(N3(...n)),t.endsWith=(...n)=>t.check(j3(...n)),t.min=(...n)=>t.check(ju(...n)),t.max=(...n)=>t.check(yA(...n)),t.length=(...n)=>t.check(vA(...n)),t.nonempty=(...n)=>t.check(ju(1,...n)),t.lowercase=n=>t.check(P3(n)),t.uppercase=n=>t.check(C3(n)),t.trim=()=>t.check(R3()),t.normalize=(...n)=>t.check(O3(...n)),t.toLowerCase=()=>t.check(D3()),t.toUpperCase=()=>t.check(M3())}),Q3=F("ZodString",(t,e)=>{xg.init(t,e),xA.init(t,e),t.email=r=>t.check(YV(J3,r)),t.url=r=>t.check(e3(e6,r)),t.jwt=r=>t.check(p3(p6,r)),t.emoji=r=>t.check(t3(t6,r)),t.guid=r=>t.check(Xb(tx,r)),t.uuid=r=>t.check(ZV(Pl,r)),t.uuidv4=r=>t.check(XV(Pl,r)),t.uuidv6=r=>t.check(QV(Pl,r)),t.uuidv7=r=>t.check(JV(Pl,r)),t.nanoid=r=>t.check(r3(r6,r)),t.guid=r=>t.check(Xb(tx,r)),t.cuid=r=>t.check(n3(n6,r)),t.cuid2=r=>t.check(i3(i6,r)),t.ulid=r=>t.check(a3(a6,r)),t.base64=r=>t.check(h3(h6,r)),t.base64url=r=>t.check(f3(f6,r)),t.xid=r=>t.check(s3(s6,r)),t.ksuid=r=>t.check(o3(o6,r)),t.ipv4=r=>t.check(c3(c6,r)),t.ipv6=r=>t.check(l3(l6,r)),t.cidrv4=r=>t.check(u3(u6,r)),t.cidrv6=r=>t.check(d3(d6,r)),t.e164=r=>t.check(m3(m6,r)),t.datetime=r=>t.check(F3(r)),t.date=r=>t.check(U3(r)),t.time=r=>t.check(H3(r)),t.duration=r=>t.check(q3(r))});function K(t){return GV(Q3,t)}const et=F("ZodStringFormat",(t,e)=>{Ze.init(t,e),xA.init(t,e)}),J3=F("ZodEmail",(t,e)=>{nV.init(t,e),et.init(t,e)}),tx=F("ZodGUID",(t,e)=>{tV.init(t,e),et.init(t,e)}),Pl=F("ZodUUID",(t,e)=>{rV.init(t,e),et.init(t,e)}),e6=F("ZodURL",(t,e)=>{iV.init(t,e),et.init(t,e)}),t6=F("ZodEmoji",(t,e)=>{aV.init(t,e),et.init(t,e)}),r6=F("ZodNanoID",(t,e)=>{sV.init(t,e),et.init(t,e)}),n6=F("ZodCUID",(t,e)=>{oV.init(t,e),et.init(t,e)}),i6=F("ZodCUID2",(t,e)=>{cV.init(t,e),et.init(t,e)}),a6=F("ZodULID",(t,e)=>{lV.init(t,e),et.init(t,e)}),s6=F("ZodXID",(t,e)=>{uV.init(t,e),et.init(t,e)}),o6=F("ZodKSUID",(t,e)=>{dV.init(t,e),et.init(t,e)}),c6=F("ZodIPv4",(t,e)=>{gV.init(t,e),et.init(t,e)}),l6=F("ZodIPv6",(t,e)=>{yV.init(t,e),et.init(t,e)}),u6=F("ZodCIDRv4",(t,e)=>{vV.init(t,e),et.init(t,e)}),d6=F("ZodCIDRv6",(t,e)=>{bV.init(t,e),et.init(t,e)}),h6=F("ZodBase64",(t,e)=>{xV.init(t,e),et.init(t,e)}),f6=F("ZodBase64URL",(t,e)=>{_V.init(t,e),et.init(t,e)}),m6=F("ZodE164",(t,e)=>{EV.init(t,e),et.init(t,e)}),p6=F("ZodJWT",(t,e)=>{AV.init(t,e),et.init(t,e)}),wg=F("ZodNumber",(t,e)=>{gA.init(t,e),ut.init(t,e),t.gt=(n,i)=>t.check(Jb(n,i)),t.gte=(n,i)=>t.check(ru(n,i)),t.min=(n,i)=>t.check(ru(n,i)),t.lt=(n,i)=>t.check(Qb(n,i)),t.lte=(n,i)=>t.check(tu(n,i)),t.max=(n,i)=>t.check(tu(n,i)),t.int=n=>t.check(rx(n)),t.safe=n=>t.check(rx(n)),t.positive=n=>t.check(Jb(0,n)),t.nonnegative=n=>t.check(ru(0,n)),t.negative=n=>t.check(Qb(0,n)),t.nonpositive=n=>t.check(tu(0,n)),t.multipleOf=(n,i)=>t.check(ex(n,i)),t.step=(n,i)=>t.check(ex(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function $a(t){return x3(wg,t)}const g6=F("ZodNumberFormat",(t,e)=>{SV.init(t,e),wg.init(t,e)});function rx(t){return _3(g6,t)}const y6=F("ZodBoolean",(t,e)=>{IV.init(t,e),ut.init(t,e)});function wA(t){return E3(y6,t)}const v6=F("ZodUnknown",(t,e)=>{PV.init(t,e),ut.init(t,e)});function nx(){return T3(v6)}const b6=F("ZodNever",(t,e)=>{CV.init(t,e),ut.init(t,e)});function x6(t){return A3(b6,t)}const w6=F("ZodDate",(t,e)=>{kV.init(t,e),ut.init(t,e),t.min=(n,i)=>t.check(ru(n,i)),t.max=(n,i)=>t.check(tu(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function wn(t){return S3(w6,t)}const _6=F("ZodArray",(t,e)=>{NV.init(t,e),ut.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(ju(r,n)),t.nonempty=r=>t.check(ju(1,r)),t.max=(r,n)=>t.check(yA(r,n)),t.length=(r,n)=>t.check(vA(r,n)),t.unwrap=()=>t.element});function _e(t,e){return L3(_6,t,e)}const E6=F("ZodObject",(t,e)=>{jV.init(t,e),ut.init(t,e),Ge(t,"shape",()=>e.shape),t.keyof=()=>De(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:nx()}),t.loose=()=>t.clone({...t._zod.def,catchall:nx()}),t.strict=()=>t.clone({...t._zod.def,catchall:x6()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>i5(t,r),t.merge=r=>a5(t,r),t.pick=r=>r5(t,r),t.omit=r=>n5(t,r),t.partial=(...r)=>s5(_A,t,r[0]),t.required=(...r)=>o5(EA,t,r[0])});function Ce(t,e){const r={type:"object",get shape(){return yg(this,"shape",{...t}),this.shape},...ne(e)};return new E6(r)}const T6=F("ZodUnion",(t,e)=>{OV.init(t,e),ut.init(t,e),t.options=e.options});function A6(t,e){return new T6({type:"union",options:t,...ne(e)})}const S6=F("ZodIntersection",(t,e)=>{RV.init(t,e),ut.init(t,e)});function I6(t,e){return new S6({type:"intersection",left:t,right:e})}const Tm=F("ZodEnum",(t,e)=>{DV.init(t,e),ut.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const s of n)if(r.has(s))a[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new Tm({...e,checks:[],...ne(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const s of n)if(r.has(s))delete a[s];else throw new Error(`Key ${s} not found in enum`);return new Tm({...e,checks:[],...ne(i),entries:a})}});function De(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new Tm({type:"enum",entries:r,...ne(e)})}const P6=F("ZodTransform",(t,e)=>{MV.init(t,e),ut.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=a=>{if(typeof a=="string")r.issues.push(lc(a,r.value,e));else{const s=a;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!0),r.issues.push(lc(s))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function C6(t){return new P6({type:"transform",transform:t})}const _A=F("ZodOptional",(t,e)=>{LV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ix(t){return new _A({type:"optional",innerType:t})}const k6=F("ZodNullable",(t,e)=>{$V.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function ax(t){return new k6({type:"nullable",innerType:t})}const N6=F("ZodDefault",(t,e)=>{VV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function j6(t,e){return new N6({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const O6=F("ZodPrefault",(t,e)=>{FV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function R6(t,e){return new O6({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const EA=F("ZodNonOptional",(t,e)=>{zV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function D6(t,e){return new EA({type:"nonoptional",innerType:t,...ne(e)})}const M6=F("ZodCatch",(t,e)=>{UV.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function L6(t,e){return new M6({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const $6=F("ZodPipe",(t,e)=>{BV.init(t,e),ut.init(t,e),t.in=e.in,t.out=e.out});function sx(t,e){return new $6({type:"pipe",in:t,out:e})}const V6=F("ZodReadonly",(t,e)=>{HV.init(t,e),ut.init(t,e)});function F6(t){return new V6({type:"readonly",innerType:t})}const z6=F("ZodCustom",(t,e)=>{WV.init(t,e),ut.init(t,e)});function U6(t){const e=new hr({check:"custom"});return e._zod.check=t,e}function B6(t,e={}){return $3(z6,t,e)}function H6(t){const e=U6(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(lc(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(lc(i))}},t(r.value,r)));return e}function hn(t){return w3(wg,t)}const TA=Ce({type:De(["overwatering","underwatering","pest","disease","nutrient","light","other"]),severity:De(["low","medium","high"]),description:K().min(1),treatment:K().min(1)}),AA=Ce({overallHealth:De(["excellent","good","fair","poor"]),issues:_e(TA),recommendations:_e(K()),moistureLevel:hn().min(0).max(100),growthStage:De(["seedling","juvenile","mature","flowering","dormant"]),confidence:hn().min(0).max(100)}),SA=Ce({wateringFrequency:hn().positive(),sunlightRequirement:De(["low","medium","high"]),humidityPreference:De(["low","medium","high"]),temperatureRange:Ce({min:hn(),max:hn()}),fertilizingFrequency:hn().positive(),soilType:K().min(1),specialCare:_e(K()).optional()}),IA=Ce({traits:_e(K()).min(1),communicationStyle:De(["cheerful","wise","dramatic","calm","playful"]),catchphrases:_e(K()),moodFactors:Ce({health:hn().min(0).max(1),care:hn().min(0).max(1),attention:hn().min(0).max(1)})}),W6=Ce({species:K(),commonName:K(),variety:K().nullable().optional(),confidence:hn().min(0).max(100),generalDescription:K().min(20),funFacts:_e(K()),plantEnvironment:De(["interior","exterior","ambos"]),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]),health:AA,careProfile:SA,personality:IA}),PA=Ce({type:De(["info","warning","tip","alert"]),title:K(),message:K()}),q6=_e(PA),K6=Object.freeze(Object.defineProperty({__proto__:null,AIAnalysisResponseSchema:W6,CareProfileSchema:SA,HealthAnalysisSchema:AA,HealthIssueSchema:TA,InsightResponseSchema:q6,InsightSchema:PA,PlantPersonalitySchema:IA},Symbol.toStringTag,{value:"Module"})),{HealthAnalysisSchema:G6,CareProfileSchema:Y6,PlantPersonalitySchema:Z6,InsightResponseSchema:X6}=K6,Q6=Ce({id:K().min(1,"Image ID is required"),url:K().url("Must be a valid URL"),timestamp:wn(),healthAnalysis:G6.optional(),isProfileImage:wA()}),J6=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","plant","system"]),content:K().min(1,"Message content cannot be empty"),timestamp:wn(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]).optional(),context:Ce({insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),eF=Ce({id:K().min(1,"Notification ID is required"),type:De(["watering","fertilizing","health_check","general"]),title:K().min(1,"Title is required"),message:K().min(1,"Message is required"),priority:De(["low","medium","high"]),scheduledFor:wn(),completed:wA()}),tF=Ce({id:K().uuid(),name:K(),species:K(),variety:K().optional(),nickname:K().optional(),description:K().optional(),funFacts:_e(K()).optional(),location:K(),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),dateAdded:wn(),lastWatered:wn().optional(),lastFertilized:wn().optional(),images:_e(Q6),healthScore:$a().min(0).max(100),careProfile:Y6,personality:Z6,chatHistory:_e(J6),notifications:_e(eF)}),rF=Ce({id:K().min(1,"Plant ID is required"),name:K().min(1,"Plant name is required"),nickname:K().optional(),species:K().min(1,"Species is required"),location:K().min(1,"Location is required"),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),healthScore:$a().min(0).max(100),profileImageUrl:K().url().optional(),lastWatered:wn().optional(),wateringFrequency:$a().positive().optional()});Ce({content:K(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]),mood:K().optional()});Ce({changes:_e(K()),healthImprovement:$a(),recommendations:_e(K()),newHealthScore:$a().min(0).max(100)});tF.omit({id:!0,dateAdded:!0,chatHistory:!0,notifications:!0}).partial({images:!0,healthScore:!0,careProfile:!0,personality:!0});Ce({fullName:K().min(3,"El nombre debe tener al menos 3 caracteres"),email:K().email("Email inválido"),password:K().min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:K().min(6)}).refine(t=>t.password===t.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});Ce({email:K().email(),password:K().min(1,"Password is required")});const nF=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","ai"]),content:K().min(1,"Message content cannot be empty"),timestamp:wn(),context:Ce({plantsAnalyzed:_e(K()).optional(),queryType:De(["general","health_analysis","care_comparison","disease_prevention","growth_tracking"]).optional(),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),iF=Ce({totalPlants:$a(),plantsData:_e(rF),averageHealthScore:$a(),commonIssues:_e(K()),careScheduleSummary:Ce({needsWatering:_e(K()),needsFertilizing:_e(K()),healthConcerns:_e(K())}),environmentalFactors:Ce({locations:_e(K()),lightConditions:_e(K()),humidityNeeds:_e(K())})});Ce({id:K().uuid(),userId:K().uuid(),messages:_e(nF),createdAt:wn(),updatedAt:wn(),context:iF.optional()});Ce({content:K().min(1),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()});const aF=async t=>{try{const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e?.access_token)throw console.error("User session not available:",r),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:n,error:i}=await Et.functions.invoke("generate-plant-insights",{body:{plant:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i)throw new Error(`Failed to generate insights: ${i.message}`);return X6.parse(n)}catch(e){throw console.error("[insightService] Error generating insights:",e),e instanceof K3?new Error(`Invalid data structure for insights: ${e.message}`):e}},CA=async t=>{JT(t);const{data:{session:e},error:r}=await Et.auth.getSession();if(r||!e)throw new Error("User must be authenticated to analyze images");const{data:n,error:i}=await Et.functions.invoke("analyze-image",{body:{imageDataUrl:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i){if(console.error("Error invoking analyze-image function:",i),i.message?.includes("unsupported image"))throw new Error("La imagen no es válida. Por favor, asegúrate de que sea una foto clara de una planta.");if(i.message?.includes("OpenAI API key"))throw new Error("Servicio de análisis temporalmente no disponible. Intenta de nuevo más tarde.");const a=i.context?.msg?JSON.parse(i.context.msg).error:i.message;throw new Error(`Failed to analyze image: ${a}`)}if(n&&n.error)throw console.error("Image analysis failed with a specific error:",n.error),new Error(n.error);return n},ox=async(t,e)=>{const r="cálido, simpático, motivador, y con un toque de humor ligero",n=(t.images||[]).map(m=>({url:m.url,timestamp:m.timestamp instanceof Date?m.timestamp.toISOString():m.timestamp,...m.healthAnalysis?{healthAnalysis:m.healthAnalysis}:{}})).sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());let i=[];try{i=await aF(t)}catch(m){console.warn("[generatePlantResponse] No se pudieron generar insights para la planta:",m),i=[]}const a={...t,images:n},{data:{session:s},error:o}=await Et.auth.getSession();if(o||!s?.access_token)throw console.error("User session not available:",o),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:c,error:l}=await Et.functions.invoke("generate-plant-response",{body:{plant:a,userMessage:e,tonePersona:r,insights:i},headers:{Authorization:`Bearer ${s.access_token}`}});if(l)throw console.error("Error calling generate-plant-response function:",l),new Error("Failed to generate plant response: "+l.message);const u=(c?.content||"").toLowerCase();return(!c?.content||u.includes("no sé")||u.includes("no tengo información")||u.includes("no puedo ayudarte")||u.length<20)&&Ld.warning("Respuesta genérica","La respuesta de la planta fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{...c,insights:c?.insights||i||[],suggestedActions:c?.suggestedActions||[]}},sF=async(t,e)=>{const{data:{session:r},error:n}=await Et.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await Et.functions.invoke("complete-plant-info",{body:{species:t,commonName:e},headers:{Authorization:`Bearer ${r.access_token}`}});if(a)throw console.error("💥 [API] Error en complete-plant-info function:",a),new Error("Failed to complete plant info: "+a.message);const s=["interior","exterior","ambos"],o=["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"];return{plantEnvironment:s.includes(i.plantEnvironment)?i.plantEnvironment:"interior",lightRequirements:o.includes(i.lightRequirements)?i.lightRequirements:"luz_indirecta",description:i.description||void 0,funFacts:Array.isArray(i.funFacts)?i.funFacts:void 0}},go=(t,e,r,n)=>({id:t.id,name:t.name,species:t.species,variety:t.variety||void 0,nickname:t.nickname||void 0,description:t.description||void 0,funFacts:t.fun_facts||[],location:t.location,plantEnvironment:t.plant_environment,lightRequirements:t.light_requirements,dateAdded:new Date(t.date_added),lastWatered:t.last_watered?new Date(t.last_watered):void 0,lastFertilized:t.last_fertilized?new Date(t.last_fertilized):void 0,images:e,healthScore:t.health_score||85,careProfile:t.care_profile,personality:t.personality,chatHistory:r,notifications:n});class _g{constructor(e=Et){yr(this,"supabase");this.supabase=e}async getUserPlantSummaries(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          care_profile
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;let i=new Map;if(r.length>0){const s=r.map(l=>l.id),{data:o,error:c}=await this.supabase.from("plant_images").select("plant_id, url").in("plant_id",s).eq("is_profile_image",!0);c?console.warn("[plantService] Error fetching profile images:",c):i=new Map((o||[]).map(l=>[l.plant_id,l.url]))}return r.map(s=>({id:s.id,name:s.name,nickname:s.nickname||void 0,species:s.species,location:s.location,plantEnvironment:s.plant_environment,lightRequirements:s.light_requirements,healthScore:s.health_score||85,profileImageUrl:i.get(s.id),lastWatered:s.last_watered?new Date(s.last_watered):void 0,wateringFrequency:s.care_profile?.wateringFrequency}))}catch(r){throw console.error("Error fetching plant summaries:",r),r}}async getUserPlants(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return r.map(a=>{const s=(a.plant_images||[]).map(l=>({id:l.id,url:l.url,timestamp:new Date(l.created_at),healthAnalysis:l.health_analysis,isProfileImage:l.is_profile_image||!1})),o=(a.chat_messages||[]).map(l=>({id:l.id,sender:l.sender,content:l.content,timestamp:new Date(l.created_at),emotion:l.emotion})),c=(a.plant_notifications||[]).map(l=>({id:l.id,type:l.type,title:l.title,message:l.message,priority:l.priority||"medium",scheduledFor:new Date(l.scheduled_for),completed:l.completed||!1}));return go(a,s,o,c)})}catch(r){throw console.error("Error fetching plants:",r),r}}async getPlantById(e,r){try{const{data:n,error:i}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("id",e).eq("user_id",r).single();if(i){if(i.code==="PGRST116")return null;throw i}if(!n)return null;const a=(n.plant_images||[]).map(c=>({id:c.id,url:c.url,timestamp:new Date(c.created_at),healthAnalysis:c.health_analysis,isProfileImage:c.is_profile_image||!1})),s=(n.chat_messages||[]).map(c=>({id:c.id,sender:c.sender,content:c.content,timestamp:new Date(c.created_at),emotion:c.emotion})),o=(n.plant_notifications||[]).map(c=>({id:c.id,type:c.type,title:c.title,message:c.message,priority:c.priority||"medium",scheduledFor:new Date(c.scheduled_for),completed:c.completed||!1}));return go(n,a,s,o)}catch(n){throw console.error("Error fetching plant by ID:",n),n}}async addPlantFromAnalysis(e,r,n){try{console.log("[PlantService] Iniciando análisis IA...");const i=await CA(r);console.log("[PlantService] Resultado IA:",i);const a={name:i.commonName,species:i.species,description:i.generalDescription,funFacts:i.funFacts,variety:i.variety??void 0,nickname:i.commonName,location:n,plantEnvironment:i.plantEnvironment,lightRequirements:i.lightRequirements,dateAdded:new Date,healthScore:i.health.confidence,careProfile:i.careProfile,personality:i.personality};console.log("[PlantService] Payload a createPlant:",a);const s=await this.createPlant(a,e);return console.log("[PlantService] Planta creada:",s),(async()=>{let o=!1,c=!1;try{console.log(`[PlantService] Starting image upload for plant ${s.id}`);const l=await eA(r,"plant-images",`${e}/${s.id}`);console.log("[PlantService] Imagen subida:",l),await this.addPlantImage(s.id,{url:l,timestamp:new Date,isProfileImage:!0,healthAnalysis:i.health},e),o=!0,console.log(`[PlantService] Image upload completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Image upload failed for plant ${s.id}:`,l),alert("Error subiendo imagen: "+(l instanceof Error?l.message:JSON.stringify(l)))}try{console.log(`[PlantService] Starting chat initialization for plant ${s.id}`);const l=await ox(s,"¡Hola! Acabo de llegar. ¿Cómo te llamas?");console.log("[PlantService] Respuesta IA chat:",l),await this.addChatMessage(s.id,{sender:"plant",content:l.content,timestamp:new Date,emotion:l.emotion},e),c=!0,console.log(`[PlantService] Chat initialization completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Chat initialization failed for plant ${s.id}:`,l),alert("Error inicializando chat: "+(l instanceof Error?l.message:JSON.stringify(l)))}o&&c?console.log(`[PlantService] All background tasks for plant ${s.id} completed successfully.`):(o||c)&&console.log(`[PlantService] Background tasks for plant ${s.id} partially completed.`)})().catch(o=>{console.error(`[PlantService] Error during background tasks for plant ${s.id}:`,o),alert("Error en tareas de fondo: "+(o instanceof Error?o.message:JSON.stringify(o)))}),s}catch(i){throw console.error("Error adding plant from analysis:",i),alert("Error creando planta: "+(i instanceof Error?i.message:JSON.stringify(i))),i}}async createPlant(e,r){try{const n={user_id:r,name:e.name,species:e.species,variety:e.variety||null,nickname:e.nickname||null,description:e.description||null,fun_facts:e.funFacts||null,location:e.location,plant_environment:e.plantEnvironment||null,light_requirements:e.lightRequirements||null,date_added:e.dateAdded.toISOString(),last_watered:null,last_fertilized:null,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,updated_at:null};console.log("[PlantService] Payload a Supabase:",n);const{data:i,error:a}=await this.supabase.from("plants").insert(n).select("*").single();if(console.log("[PlantService] Respuesta Supabase:",i,a),a)throw console.error("Supabase error:",{message:a.message,details:a.details,code:a.code}),alert("Error Supabase: "+a.message),new Error(`Supabase error creating plant: ${a.message}`);if(!i)throw alert("No se pudo crear la planta en la base de datos, no se devolvieron datos."),new Error("Failed to create plant in the database, no data returned.");return go(i,[],[],[])}catch(n){throw console.error("Error creating plant:",n),alert("Error creando planta: "+(n instanceof Error?n.message:JSON.stringify(n))),n}}async updatePlantInfo(e,r,n){try{const i={};n.plantEnvironment!==void 0&&(i.plant_environment=n.plantEnvironment),n.lightRequirements!==void 0&&(i.light_requirements=n.lightRequirements),n.description!==void 0&&(i.description=n.description),n.funFacts!==void 0&&(i.fun_facts=n.funFacts);const{data:a,error:s}=await this.supabase.from("plants").update(i).eq("id",e).eq("user_id",r).select("*").single();if(s)throw console.error("Supabase error updating plant:",s),new Error(`Error updating plant: ${s.message}`);if(!a)throw new Error("Plant not found or not updated.");return go(a,[],[],[])}catch(i){throw console.error("Error updating plant info:",i),i}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await this.supabase.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await this.supabase.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}async updatePlant(e,r){try{const n={name:e.name,species:e.species,variety:e.variety,nickname:e.nickname,description:e.description,fun_facts:e.funFacts,location:e.location,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,last_watered:e.lastWatered?.toISOString(),last_fertilized:e.lastFertilized?.toISOString()},{data:i,error:a}=await this.supabase.from("plants").update(n).eq("id",e.id).eq("user_id",r).select().single();if(a)throw a;return go(i,e.images,e.chatHistory,e.notifications)}catch(n){throw console.error("Error updating plant:",n),n}}async deletePlant(e,r){try{const{error:n}=await this.supabase.from("plants").delete().eq("id",e).eq("user_id",r);if(n)throw n}catch(n){throw console.error("Error deleting plant:",n),n}}async sendChatMessageAndGetResponse(e,r,n){const i=await this.addChatMessage(e.id,r,n),a=await ox(e,r.content),s={};a.insights&&(s.insights=a.insights),a.suggestedActions&&(s.suggestedActions=a.suggestedActions);const o={sender:"plant",content:a.content,emotion:a.emotion,timestamp:new Date,...Object.keys(s).length>0?{context:s}:{}},c=await this.addChatMessage(e.id,o,n);return[i,c]}async addChatMessage(e,r,n){try{const i={plant_id:e,user_id:n,sender:r.sender,content:r.content,emotion:r.emotion||null};r.context&&(i.context=r.context);const{data:a,error:s}=await this.supabase.from("chat_messages").insert(i).select().single();if(s)throw console.error("❌ Supabase error:",s),s;return{id:a.id,sender:a.sender,content:a.content,timestamp:new Date(a.created_at),emotion:a.emotion,context:a.context||void 0}}catch(i){throw console.error("Error adding chat message:",i),i}}async addPlantImage(e,r,n){try{const i=r.url;let a="";try{const l=new URL(i).pathname.split("/"),u=l.findIndex(h=>h==="object");u!==-1&&u+2<l.length&&(a=l.slice(u+2).join("/"))}catch{console.warn("Could not extract storage path from URL:",i),a=`${n}/${e}/${Date.now()}.jpg`}const{data:s,error:o}=await this.supabase.from("plant_images").insert({plant_id:e,user_id:n,url:i,storage_path:a,is_profile_image:r.isProfileImage,health_analysis:r.healthAnalysis}).select().single();if(o)throw o;if(!s.url)throw new Error("Image URL not returned from database.");return{id:s.id,url:s.url,timestamp:new Date(s.created_at),isProfileImage:s.is_profile_image||!1,healthAnalysis:s.health_analysis}}catch(i){throw console.error("Error adding plant image:",i),new Error(`Image upload failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async setProfileImage(e,r,n){try{await this.supabase.from("plant_images").update({is_profile_image:!1}).eq("plant_id",e).eq("user_id",n);const{error:i}=await this.supabase.from("plant_images").update({is_profile_image:!0}).eq("id",r).eq("user_id",n);if(i)throw i}catch(i){throw console.error("Error setting profile image:",i),i}}async deleteImage(e,r){try{const{data:n,error:i}=await this.supabase.from("plant_images").select("storage_path").eq("id",e).eq("user_id",r).single();if(i)throw i;n?.storage_path&&await this.supabase.storage.from("plant-images").remove([n.storage_path]);const{error:a}=await this.supabase.from("plant_images").delete().eq("id",e).eq("user_id",r);if(a)throw a}catch(n){throw console.error("Error deleting image:",n),n}}}const ps=new _g(Et);class oF{constructor(){yr(this,"cache",new Map);yr(this,"CACHE_DURATIONS",{GARDEN_CONTEXT:5*60*1e3,GARDEN_SUMMARY:3*60*1e3,SUGGESTED_QUESTIONS:10*60*1e3,PLANT_DATA:2*60*1e3})}getCacheKey(e,r){return`${e}:${r}`}isValidCache(e){return e?Date.now()<e.expiresAt:!1}getCachedData(e){const r=this.cache.get(e);return this.isValidCache(r)?r.data:(r&&this.cache.delete(e),null)}setCachedData(e,r,n){const i={data:r,timestamp:Date.now(),expiresAt:Date.now()+n};this.cache.set(e,i),console.log(`[GardenCache] Cache SET for key: ${e}, expires in ${n/1e3}s`)}getGardenContext(e){const r=this.getCacheKey(e,"garden_context");return this.getCachedData(r)}setGardenContext(e,r){const n=this.getCacheKey(e,"garden_context");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_CONTEXT)}getGardenSummary(e){const r=this.getCacheKey(e,"garden_summary");return this.getCachedData(r)}setGardenSummary(e,r){const n=this.getCacheKey(e,"garden_summary");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_SUMMARY)}getSuggestedQuestions(e){const r=this.getCacheKey(e,"suggested_questions");return this.getCachedData(r)}setSuggestedQuestions(e,r){const n=this.getCacheKey(e,"suggested_questions");this.setCachedData(n,r,this.CACHE_DURATIONS.SUGGESTED_QUESTIONS)}getPlantData(e){const r=this.getCacheKey(e,"plant_data");return this.getCachedData(r)}setPlantData(e,r){const n=this.getCacheKey(e,"plant_data");this.setCachedData(n,r,this.CACHE_DURATIONS.PLANT_DATA)}invalidateCache(e,r){r?r.forEach(n=>{const i=this.getCacheKey(e,n);this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)}):Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>{this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)})}invalidateOnPlantChange(e){console.log("[GardenCache] Plant data changed, invalidating related caches"),this.invalidateCache(e,["garden_context","garden_summary","plant_data","suggested_questions"])}getCacheStats(e){const r=Array.from(this.cache.keys()),n=r.filter(s=>s.startsWith(`${e}:`));let i=0,a=0;return n.forEach(s=>{const o=this.cache.get(s);o&&(this.isValidCache(o)?i++:a++)}),{totalEntries:r.length,userEntries:n.length,validEntries:i,expiredEntries:a}}cleanup(){const e=Date.now(),r=[];this.cache.forEach((n,i)=>{e>=n.expiresAt&&r.push(i)}),r.forEach(n=>{this.cache.delete(n)}),r.length>0&&console.log(`[GardenCache] Cleaned up ${r.length} expired entries`)}clearAll(){this.cache.size,this.cache.clear()}}const Wo=new oF;typeof window<"u"&&setInterval(()=>{Wo.cleanup()},5*60*1e3);const yo=new _g,vo={isLoading:!1,error:null},qn=xp((t,e)=>({plants:[],operationStates:{add:{...vo},update:{...vo},delete:{...vo},addImage:{...vo},chat:{...vo}},selectedPlantId:null,getOperationState:r=>e().operationStates[r],getPlantById:r=>e().plants.find(n=>n.id===r),setPlant:r=>{t(Se(n=>{const i=n.plants.findIndex(a=>a.id===r.id);i!==-1?n.plants[i]=r:n.plants.push(r)}))},addPlant:async(r,n,i)=>{t(Se(a=>{a.operationStates.add.isLoading=!0,a.operationStates.add.error=null,a.operationStates.add.lastOperation="addPlant"}));try{const a=await yo.addPlantFromAnalysis(i,r,n);return t(Se(s=>{s.plants.unshift(a),s.operationStates.add.isLoading=!1})),Wo.invalidateOnPlantChange(i),a}catch(a){const s=a instanceof Error?a.message:"Failed to add plant";throw t(Se(o=>{o.operationStates.add.isLoading=!1,o.operationStates.add.error=s})),a}},updatePlant:async(r,n)=>{t(Se(i=>{i.operationStates.update.isLoading=!0,i.operationStates.update.error=null,i.operationStates.update.lastOperation=`updatePlant-${r.id}`}));try{const i=await yo.updatePlant(r,n);t(Se(a=>{const s=a.plants.findIndex(o=>o.id===i.id);s!==-1&&(a.plants[s]=i),a.operationStates.update.isLoading=!1})),Wo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to update plant";throw t(Se(s=>{s.operationStates.update.isLoading=!1,s.operationStates.update.error=a})),i}},deletePlant:async(r,n)=>{t(Se(i=>{i.operationStates.delete.isLoading=!0,i.operationStates.delete.error=null,i.operationStates.delete.lastOperation=`deletePlant-${r}`}));try{await yo.deletePlant(r,n),t(Se(i=>{i.plants=i.plants.filter(a=>a.id!==r),i.operationStates.delete.isLoading=!1})),Wo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to delete plant";throw t(Se(s=>{s.operationStates.delete.isLoading=!1,s.operationStates.delete.error=a})),i}},addChatMessage:async(r,n,i)=>{t(Se(o=>{o.operationStates.chat.isLoading=!0,o.operationStates.chat.error=null,o.operationStates.chat.lastOperation=`addChatMessage-${r}`}));const a=e().getPlantById(r);if(!a){t(Se(o=>{o.operationStates.chat.isLoading=!1,o.operationStates.chat.error="Plant not found to add message"}));return}const s={id:`temp-user-${Date.now()}`,sender:"user",content:n,timestamp:new Date};t(Se(o=>{o.plants.find(c=>c.id===r)?.chatHistory.push(s)}));try{const[o,c]=await yo.sendChatMessageAndGetResponse(a,{sender:"user",content:n,timestamp:s.timestamp},i);t(Se(l=>{const u=l.plants.find(h=>h.id===r);u&&(u.chatHistory=[...u.chatHistory.filter(h=>h.id!==s.id),o,c]),l.operationStates.chat.isLoading=!1}))}catch(o){const c=o instanceof Error?o.message:"Failed to send message";t(Se(l=>{l.operationStates.chat.isLoading=!1,l.operationStates.chat.error=c}))}},addPlantImage:async(r,n,i)=>{t(Se(a=>{a.operationStates.addImage.isLoading=!0,a.operationStates.addImage.error=null,a.operationStates.addImage.lastOperation=`addImage-${r}`}));try{const a=await yo.addPlantImage(r,{url:n,timestamp:new Date,isProfileImage:!1},i);t(Se(s=>{const o=s.plants.find(c=>c.id===r);o&&o.images.push(a),s.operationStates.addImage.isLoading=!1}))}catch(a){const s=a instanceof Error?a.message:"Failed to add image";throw t(Se(o=>{o.operationStates.addImage.isLoading=!1,o.operationStates.addImage.error=s})),a}},selectPlant:r=>t({selectedPlantId:r}),clearError:r=>{t(Se(r?n=>{n.operationStates[r].error=null}:n=>{Object.keys(n.operationStates).forEach(i=>{n.operationStates[i].error=null})}))},clearPlants:()=>t({plants:[],selectedPlantId:null})}));class cF{async updatePlantHealthDiagnosis(e){if(!e.images||e.images.length===0)throw new Error("Esta planta no tiene imágenes para analizar. Toma una foto primero.");const r=[...e.images].sort((a,s)=>s.timestamp.getTime()-a.timestamp.getTime())[0],{data:{session:n},error:i}=await Et.auth.getSession();if(i||!n?.access_token)throw console.error("💥 [Health] User session not available:",i),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");try{const a=await fetch(r.url,{method:"HEAD"});if(!a.ok)throw new Error(`Imagen no accesible: ${a.status}`)}catch(a){throw console.error("💥 [Health] Error verificando acceso a imagen:",a),new Error("La imagen de la planta no está disponible. Intenta tomar una nueva foto.")}console.log("🔬 [Health] Llamando a update-health-diagnosis...");try{const{data:a,error:s}=await Et.functions.invoke("update-health-diagnosis",{body:{imageUrl:r.url,plantName:e.name,species:e.species},headers:{Authorization:`Bearer ${n.access_token}`}});if(s)throw console.error("💥 [Health] Error en función update-health-diagnosis:",s),new Error(`Error en análisis: ${s.message}`);if(!a||!a.overallHealth)throw console.error("💥 [Health] Datos incompletos del análisis:",a),new Error("El análisis no devolvió información de salud válida.");console.log("🎯 [Health] Análisis de salud completado exitosamente:",{overallHealth:a.overallHealth,confidence:a.confidence,issuesCount:a.issues?.length||0,recommendationsCount:a.recommendations?.length||0});const c={excellent:95,good:80,fair:60,poor:30}[a.overallHealth]||a.confidence||60;return console.log("📊 [Health] Nuevo score de salud calculado:",{overallHealth:a.overallHealth,numericScore:c,confidence:a.confidence}),{healthScore:c,healthAnalysis:a,updatedImage:{...r,healthAnalysis:a}}}catch(a){console.error("💥 [Health] Error en diagnóstico primario:",a),console.log("🔄 [Health] Intentando análisis de fallback...");try{if(r.healthAnalysis&&r.healthAnalysis.overallHealth){console.log("🎯 [Health] Usando análisis existente de la imagen");const s=r.healthAnalysis;return{healthScore:{excellent:95,good:80,fair:60,poor:30}[s.overallHealth]||60,healthAnalysis:s,updatedImage:r}}}catch(s){console.error("💥 [Health] Error en fallback:",s)}throw new Error("No se pudo actualizar el diagnóstico de salud. Verifica tu conexión a internet e intenta nuevamente.")}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await Et.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await Et.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}}const cx=new cF,zd=()=>{const t=fd(),{addPlant:e,updatePlant:r,deletePlant:n}=qn.getState(),a=Nn(h=>h.user)?.id,{addToast:s}=qs(),o=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");const{imageDataUrl:m,location:p}=h;return e(m,p,a)},onSuccess:h=>{t.invalidateQueries({queryKey:["plants",a]})},onError:h=>{console.error("Failed to create plant:",h)}}),c=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return r(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.map(p=>p.id===h.id?h:p)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:h=>{t.invalidateQueries({queryKey:["plants",a]})}}),l=Ti({mutationFn:async({plant:h,userId:m})=>{console.log("🩺 [Mutation] Iniciando actualización de diagnóstico...");const p=await cx.updatePlantHealthDiagnosis(h);return await cx.updatePlantHealthScore(h.id,m,p.healthScore,p.healthAnalysis,p.updatedImage.id),console.log("✅ [Mutation] Diagnóstico actualizado exitosamente"),p},onSuccess:(h,{plant:m})=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",m.id]}),s({type:"success",title:"Diagnóstico Actualizado",message:`Nuevo estado de salud: ${h.healthScore}%`})},onError:h=>{console.error("💥 [Mutation] Error actualizando diagnóstico:",h),s({type:"error",title:"Error en Diagnóstico",message:h.message})}}),u=Ti({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return n(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.filter(p=>p.id!==h)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:()=>{t.invalidateQueries({queryKey:["plants",a]})}});return{createPlant:o.mutate,isCreatingPlant:o.isPending,updatePlant:c.mutate,isUpdatingPlant:c.isPending,updatePlantHealthMutation:l.mutate,isUpdatingPlantHealth:l.isPending,deletePlant:u.mutate,isDeletingPlant:u.isPending}},lF=()=>{const[t,e]=w.useState(!1),r=ar(),{createPlant:n,isCreatingPlant:i}=zd();w.useEffect(()=>{const o=c=>{c.key==="Escape"&&e(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]);const a=[{id:"camera",icon:Gn,label:"Tomar Foto",color:"bg-blue-500",action:()=>{e(!1),r(gt.toCamera())}},{id:"gallery",icon:yp,label:"Galería",color:"bg-purple-500",action:()=>s()}],s=w.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async c=>{const l=c.target.files?.[0];if(l){const u=new FileReader;u.onload=async h=>{const m=h.target?.result;if(m){e(!1);const p=new Promise((v,b)=>{n({imageDataUrl:m,location:"Interior"},{onSuccess:g=>{g?.id&&r(gt.toPlantDetail(g.id)),v(g)},onError:g=>{console.error("Failed to create plant:",g),b(g)}})});HT.promise(p,{loading:"Analizando imagen... La IA está trabajando.",success:v=>`¡Planta "${v.name}" creada con éxito!`,error:v=>`Error: ${v.message}`})}},u.readAsDataURL(l)}},o.click()},[n,r]);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative flex items-center",children:[d.jsx(L.button,{onClick:()=>e(!t),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},disabled:i,"aria-label":t?"Cerrar menú":"Agregar planta","aria-expanded":t,children:d.jsx(ke,{mode:"wait",children:i?d.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:d.jsx(xa,{className:"w-6 h-6 animate-spin"})},"loading"):d.jsx(L.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:t?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:d.jsx(gp,{className:"w-6 h-6"})},"plus")})}),t&&d.jsx(L.span,{initial:{opacity:0,x:10},animate:{opacity:1,x:16},exit:{opacity:0,x:10},transition:{duration:.2},className:"ml-3 px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-xs font-medium shadow-md whitespace-nowrap z-50",children:"Agregar planta"})]}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:a.map((o,c)=>d.jsxs(L.button,{onClick:o.action,className:`w-12 h-12 ${o.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:c*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(a.length-c)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":o.label,children:[d.jsx(o.icon,{className:"w-5 h-5"}),d.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:d.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[o.label,d.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},o.id))})}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)})})]})},uF=[{icon:au,path:wt.dashboard,label:"Inicio",description:"Tu jardín personal"},{icon:Go,path:wt.gardenChat,label:"Chat IA",description:"Asistente de plantas"},{icon:Zk,path:wt.settings,label:"Ajustes",description:"Configuración"}],dF=()=>{const t=X_(),e=t.pathname.startsWith("/plant/");return d.jsxs(d.Fragment,{children:[d.jsx("nav",{className:"safe-bottom fixed bottom-0 left-0 right-0 z-50 glass-enhanced border-t border-contrast","data-tour":"bottom-navigation",children:d.jsx("div",{className:"flex justify-around items-center h-20 max-w-lg mx-auto px-2",children:uF.map(r=>{const n=z$(t.pathname,r.path);return d.jsx(L.div,{className:"relative flex-1 h-full",whileTap:{scale:.92},whileHover:{scale:1.02},children:d.jsxs(Kk,{to:r.path,className:Oe("touch-target relative flex flex-col items-center justify-center w-full h-full rounded-2xl transition-all duration-200","focus-contrast",n?"text-primary-700 dark:text-primary-400":"text-neutral-700 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400"),"aria-label":`${r.label} - ${r.description}`,...n?{"aria-current":"page"}:{},...r.path===wt.gardenChat?{"data-tour":"chat-tab"}:{},onClick:i=>{const a=document.startViewTransition?.bind(document);a&&(i.preventDefault(),a(()=>{window.history.pushState({},"",r.path),window.dispatchEvent(new PopStateEvent("popstate"))}))},children:[d.jsx(ke,{children:n&&d.jsx(L.div,{layoutId:"nav-background",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:400,damping:30},className:"absolute inset-1 bg-primary-500/10 dark:bg-primary-400/10 rounded-xl"})}),d.jsx(L.div,{animate:{scale:n?1.1:1,y:n?-2:0},transition:{duration:.2},className:Oe("relative z-10",n?"text-[#2A7F3E]":"text-[#888]"),children:d.jsx(r.icon,{size:24,strokeWidth:n?2.5:2,className:"drop-shadow-sm"})}),d.jsx(L.span,{animate:{scale:n?1.05:1,fontWeight:n?600:500},transition:{duration:.2},className:"text-xs mt-1 relative z-10",children:r.label}),d.jsx(ke,{children:n&&d.jsx(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1},className:"absolute left-1/2 -translate-x-1/2 w-1 h-1 bg-primary-500 dark:bg-primary-400 rounded-full mt-1.5"})})]})},r.path)})})}),!e&&d.jsx("div",{className:"fixed bottom-20 sm:bottom-24 right-4 sm:right-6 z-40","data-tour":"add-plant-fab",children:d.jsx(lF,{})})]})},hF=()=>{const[t,e]=w.useState(navigator.onLine);return w.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t},fF=()=>{const t=hF();return d.jsxs(ke,{children:[!t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",children:d.jsx("div",{className:"bg-red-500 text-white px-4 py-2 text-center text-sm font-medium",children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(Xk,{size:16}),d.jsx("span",{children:"Sin conexión - Modo offline"})]})})}),t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",onAnimationComplete:()=>{setTimeout(()=>{const e=document.querySelector("[data-online-indicator]");e&&e.remove()},2e3)},children:d.jsx("div",{className:"bg-green-500 text-white px-4 py-2 text-center text-sm font-medium","data-online-indicator":!0,children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(J_,{size:16}),d.jsx("span",{children:"Conexión restaurada"})]})})})]})},mF="1.0.0",pF="2025-08-07T21:52:37.351Z",gF="7 de agosto de 2025, 17:52",ma={name:"Plantitas",version:mF,buildDate:gF,buildTimestamp:pF,author:"Felipe Aurelio",repository:"https://github.com/felipeaurelio13/plantitas-app"},yF=()=>`${ma.name} v${ma.version} (${ma.buildDate})`,vF=({className:t="",showVersion:e=!0,showBuildInfo:r=!1})=>d.jsxs("footer",{className:`text-center py-4 text-sm text-muted-foreground ${t}`,children:[e&&d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-foreground",children:ma.name}),d.jsx("p",{className:"text-xs opacity-75",children:yF()})]}),r&&d.jsxs("div",{className:"mt-2 text-xs opacity-50",children:[d.jsxs("p",{children:["Build: ",ma.buildTimestamp]}),d.jsxs("p",{children:["Repo: ",ma.repository]})]}),d.jsx("div",{className:"mt-2 text-xs opacity-60",children:d.jsxs("p",{children:["© 2024 ",ma.author,". Todos los derechos reservados."]})})]});function bF(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var a;const s=c=>c===null?null:JSON.parse(c,void 0),o=(a=r.getItem(i))!=null?a:null;return o instanceof Promise?o.then(s):s(o)},setItem:(i,a)=>r.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>r.removeItem(i)}}const Am=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Am(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Am(n)(r)}}}},xF=(t,e)=>(r,n,i)=>{let a={storage:bF(()=>localStorage),partialize:b=>b,version:0,merge:(b,g)=>({...g,...b}),...e},s=!1;const o=new Set,c=new Set;let l=a.storage;if(!l)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},n,i);const u=()=>{const b=a.partialize({...n()});return l.setItem(a.name,{state:b,version:a.version})},h=i.setState;i.setState=(b,g)=>{h(b,g),u()};const m=t((...b)=>{r(...b),u()},n,i);i.getInitialState=()=>m;let p;const v=()=>{var b,g;if(!l)return;s=!1,o.forEach(T=>{var E;return T((E=n())!=null?E:m)});const _=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(b=n())!=null?b:m))||void 0;return Am(l.getItem.bind(l))(a.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==a.version){if(a.migrate){const E=a.migrate(T.state,T.version);return E instanceof Promise?E.then(j=>[!0,j]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var E;const[j,R]=T;if(p=a.merge(R,(E=n())!=null?E:m),r(p,!0),j)return u()}).then(()=>{_?.(p,void 0),p=n(),s=!0,c.forEach(T=>T(p))}).catch(T=>{_?.(void 0,T)})};return i.persist={setOptions:b=>{a={...a,...b},b.storage&&(l=b.storage)},clearStorage:()=>{l?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>s,onHydrate:b=>(o.add(b),()=>{o.delete(b)}),onFinishHydration:b=>(c.add(b),()=>{c.delete(b)})},a.skipHydration||v(),p||m},wF=xF,_F=xp()(wF((t,e)=>({isDark:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1,toggleTheme:()=>{const{isDark:r}=e(),n=!r;t({isDark:n}),df(n),"vibrate"in navigator&&navigator.vibrate(50)},setTheme:r=>{t({isDark:r}),df(r)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t&&df(t.isDark)}})),df=t=>{if(typeof window>"u")return;const e=t?"dark":"light";document.documentElement.setAttribute("data-theme",e),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},EF=()=>{const t=X_(),{isDark:e}=_F(),r=t.pathname==="/camera",n=()=>{const a={"/":"Página de inicio - Tu jardín personal","/camera":"Cámara - Agregar nueva planta","/chat":"Chat con IA - Asistente de plantas","/garden-chat":"Chat del jardín - Consultas generales","/settings":"Configuración - Ajustes de la aplicación"},s=t.pathname.includes("/plant/")?"/plant":t.pathname,o=a[s]||a[t.pathname]||"Página",c=document.createElement("div");c.setAttribute("aria-live","polite"),c.setAttribute("aria-atomic","true"),c.setAttribute("class","sr-only"),c.textContent=`Navegando a ${o}`,document.body.appendChild(c),setTimeout(()=>{document.body.removeChild(c)},1e3)};w.useEffect(()=>{n(),document.startViewTransition&&document.startViewTransition?.(()=>{})},[t.pathname]),w.useEffect(()=>{const a=e?"dark":"light";document.documentElement.setAttribute("data-theme",a)},[e]);const i=()=>d.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only fixed top-4 left-4 z-50 bg-primary-600 text-white px-4 py-2 rounded-md font-medium transition-all duration-200 focus:shadow-lg",onFocus:a=>{a.currentTarget.scrollIntoView({behavior:"smooth"})},children:"Saltar al contenido principal"});return d.jsxs("div",{className:"min-h-screen bg-background text-text-primary",style:{viewTransitionName:"app-root"},children:[d.jsx(i,{}),d.jsx("h1",{className:"sr-only",children:"Plantitas - Aplicación de cuidado de plantas"}),d.jsx("main",{id:"main-content",role:"main","aria-label":"Contenido principal",className:"pb-28 min-h-screen focus:outline-none",tabIndex:-1,children:d.jsx(ke,{mode:"wait",children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"w-full h-full",children:d.jsx(Gk,{})},t.pathname)})}),d.jsx("aside",{role:"complementary","aria-label":"Información de estado",children:d.jsx(fF,{})}),!r&&d.jsx("nav",{role:"navigation","aria-label":"Navegación inferior",children:d.jsx(dF,{})}),!r&&d.jsx(vF,{className:"mt-auto pt-4 pb-20",showVersion:!0,showBuildInfo:!1}),d.jsx("style",{children:`
        @media (prefers-contrast: high) {
          :root {
            --color-background: #000000;
            --color-surface: #111111;
            --color-text-primary: #ffffff;
            --color-text-secondary: #ffffff;
            --color-border: #ffffff;
            --color-accent: #00ff00;
          }
        }

        @media (prefers-reduced-motion: reduce) {
          * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Screen reader only utility */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .sr-only.focus\\:not-sr-only:focus {
          position: static;
          width: auto;
          height: auto;
          padding: inherit;
          margin: inherit;
          overflow: visible;
          clip: auto;
          white-space: normal;
        }

        /* Enhanced focus indicators */
        *:focus-visible {
          outline: 3px solid var(--color-accent) !important;
          outline-offset: 2px !important;
          border-radius: 4px;
        }

        /* High contrast focus ring */
        @media (prefers-contrast: high) {
          *:focus-visible {
            outline: 4px solid #00ff00 !important;
            outline-offset: 3px !important;
          }
        }
      `})]})};class TF extends w.Component{constructor(r){super(r);yr(this,"handleReload",()=>{window.location.reload()});yr(this,"handleGoHome",()=>{window.location.href="/plantitas-app/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n});const i={userAgent:navigator.userAgent,platform:navigator.platform,isOnline:navigator.onLine,viewport:{width:window.innerWidth,height:window.innerHeight},url:window.location.href,timestamp:new Date().toISOString()};console.error("[ErrorBoundary] Error caught:",{error:r.message,stack:r.stack,errorInfo:n,mobileInfo:i}),console.warn("[ErrorBoundary] Production error detected:",{message:r.message,mobile:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:d.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-md w-full",children:d.jsxs("div",{className:"glass-effect rounded-2xl p-8 text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:d.jsx(En,{size:32,className:"text-red-500"})}),d.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"¡Oops! Algo salió mal"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. No te preocupes, tus plantas están seguras."}),!1,d.jsxs("div",{className:"space-y-3",children:[d.jsxs("button",{onClick:this.handleReload,className:"w-full px-4 py-3 bg-primary-500 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(ji,{size:18}),d.jsx("span",{children:"Recargar Página"})]}),d.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-4 py-3 bg-gray-600 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(au,{size:18}),d.jsx("span",{children:"Ir al Inicio"})]})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-4",children:"Si el problema persiste, intenta limpiar el caché del navegador."})]})})}):this.props.children}}const AF=()=>{const t=Nn(e=>e.user);return G_({queryKey:["plants",t?.id],queryFn:async()=>t?ps.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:yi.QUERY.STALE_TIME.MEDIUM,gcTime:yi.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]})},lx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ux=Le,Eg=(t,e)=>r=>{var n;if(e?.variants==null)return ux(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,s=Object.keys(i).map(l=>{const u=r?.[l],h=a?.[l];if(u===null)return null;const m=lx(u)||lx(h);return i[l][m]}),o=r&&Object.entries(r).reduce((l,u)=>{let[h,m]=u;return m===void 0||(l[h]=m),l},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((l,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...a,...o}[b]):{...a,...o}[b]===g})?[...l,h,m]:l},[]);return ux(t,s,c,r?.class,r?.className)},SF=Eg("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),Pr=H.forwardRef(({className:t,variant:e,size:r,radius:n,interactive:i,hover:a=!1,loading:s=!1,children:o,ariaLabel:c,...l},u)=>d.jsx(L.div,{whileHover:i&&!s?{scale:a?1.02:1.01,y:a?-4:-2}:void 0,whileTap:i&&!s?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe(SF({variant:e,size:r,radius:n,interactive:i}),s&&"animate-pulse",t),ref:u,...l,children:s?d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));Pr.displayName="Card";const Ud=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex flex-col space-y-1.5 pb-4",t),...e}));Ud.displayName="CardHeader";const Tg=H.forwardRef(({className:t,...e},r)=>d.jsx("h3",{ref:r,className:Oe("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",t),...e}));Tg.displayName="CardTitle";const IF=H.forwardRef(({className:t,...e},r)=>d.jsx("p",{ref:r,className:Oe("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",t),...e}));IF.displayName="CardDescription";const ei=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("",t),...e}));ei.displayName="CardContent";const kA=H.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",t),...e}));kA.displayName="CardFooter";const bo=new Set,Cl=new Map,Ag=({src:t,alt:e,className:r="",fallback:n,onLoad:i,onError:a,priority:s=!1,sizes:o="(max-width: 768px) 100vw, 50vw",srcSet:c,blurDataUrl:l})=>{const[u,h]=w.useState(()=>bo.has(t)),[m,p]=w.useState(!1),[v,b]=w.useState(s),g=w.useRef(null),_=w.useRef(null);w.useEffect(()=>{if(s)return;const j=new IntersectionObserver(([R])=>{R.isIntersecting&&(b(!0),j.disconnect())},{rootMargin:"50px",threshold:.1});return _.current&&j.observe(_.current),()=>j.disconnect()},[s]),w.useEffect(()=>{if(s&&!bo.has(t)&&!Cl.has(t)){const j=new Image;j.src=t,j.onload=()=>{bo.add(t),Cl.set(t,j)},j.onerror=()=>{Cl.delete(t)},Cl.set(t,j)}},[t,s]);const T=w.useCallback(()=>{bo.add(t),h(!0),i?.()},[i,t]),E=w.useCallback(()=>{bo.delete(t),p(!0),a?.()},[a,t]);return m&&n?d.jsx(d.Fragment,{children:n}):m?d.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 flex items-center justify-center ${r}`,children:d.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})}):d.jsxs("div",{ref:_,className:`relative overflow-hidden ${r}`,style:{backgroundColor:"#f0f0f0"},children:[l&&d.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full object-cover",style:{filter:"blur(10px)",transform:"scale(1.1)",opacity:u?0:1,transition:"opacity 0.3s ease-in-out"},"aria-hidden":"true"}),d.jsx(ke,{children:!u&&!l&&d.jsx(L.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"})}),v&&d.jsxs(L.picture,{initial:!1,animate:{opacity:u?1:0},children:[d.jsx("source",{type:"image/avif",srcSet:c||t}),d.jsx("source",{type:"image/webp",srcSet:c||t}),d.jsx("img",{ref:g,src:t,srcSet:c,alt:e,className:`w-full h-full object-cover ${u?"opacity-100":"opacity-0"}`,loading:s?"eager":"lazy",decoding:"async",fetchPriority:s?"high":"low",sizes:o,onLoad:T,onError:E,style:{transition:"opacity 0.3s ease-in-out, filter 0.3s ease-in-out",filter:u?"blur(0)":"blur(2px)"}})]})]})},NA=w.memo(({score:t,healthStatus:e,showDetailedStatus:r=!0,size:n="medium",animated:i=!0})=>{const s={small:{barWidth:"w-16",barHeight:"h-1.5",textSize:"text-xs",iconSize:"w-3 h-3",gap:"gap-1"},medium:{barWidth:"w-24",barHeight:"h-2",textSize:"text-xs",iconSize:"w-4 h-4",gap:"gap-2"},large:{barWidth:"w-32",barHeight:"h-3",textSize:"text-sm",iconSize:"w-5 h-5",gap:"gap-3"}}[n],o=()=>{const l=`${s.iconSize} mr-1`;return t>=80?d.jsx(er,{className:`${l} text-green-400`}):t>=60?d.jsx(wa,{className:`${l} text-yellow-400`}):t>=40?d.jsx(xc,{className:`${l} text-orange-400`}):d.jsx(En,{className:`${l} text-red-400`})};return d.jsxs("div",{className:`flex items-center ${s.gap} w-full`,children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[d.jsx("div",{className:`relative ${s.barWidth} ${s.barHeight} bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden`,children:i?d.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}}):d.jsx("div",{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,style:{width:`${t}%`}})}),d.jsxs("span",{className:`${s.textSize} font-semibold text-neutral-500 dark:text-neutral-400`,children:[t,"%"]})]}),r&&d.jsxs("div",{className:`flex items-center ${s.gap.replace("gap-","gap-1")} ${s.textSize} px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700`,children:[o(),d.jsx("span",{className:e.textColor,children:e.status})]})]})});NA.displayName="PlantHealthIndicator";const PF=(t,e)=>{const r=ar(),n=fd(),i=w.useMemo(()=>{const h=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,m=t.lastWatered?Math.floor((new Date().getTime()-new Date(t.lastWatered).getTime())/(24*60*60*1e3)):0,p=t.healthScore>=80,v=CF(t.healthScore,h,m);return{needsWatering:h,isFavorite:p,daysSinceWatered:m,healthStatus:v}},[t.lastWatered,t.wateringFrequency,t.healthScore]),a=w.useCallback(async()=>{try{await n.prefetchQuery({queryKey:["plant",t.id],queryFn:async()=>{const{supabase:h}=await mp(async()=>{const{supabase:v}=await Promise.resolve().then(()=>F$);return{supabase:v}},void 0),{data:m,error:p}=await h.from("plants").select(`
              *,
              plant_images(*)
            `).eq("id",t.id).single();if(p)throw p.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");return m},staleTime:5*60*1e3})}catch(h){console.warn("Failed to prefetch plant data:",h)}},[t.id,n]),s=w.useCallback(()=>{r(gt.toPlantDetail(t.id))},[r,t.id]),o=w.useCallback(()=>{r(gt.toPlantChat(t.id))},[r,t.id]),c=w.useCallback(()=>{s()},[s]),l=w.useCallback(()=>{a()},[a]);return{state:i,actions:{handleClick:c,handleMouseEnter:l,prefetchPlantData:a,navigateToPlant:s,navigateToChat:o},plant:t}};function CF(t,e,r){let n;if(t>=80?n={color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",status:"Excelente",priority:"low"}:t>=60?n={color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",status:"Buena",priority:"medium"}:n={color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",status:"Atención",priority:"high"},e){if(r>7)return{...n,color:"bg-red-400",textColor:"text-red-700 dark:text-red-300",status:"Necesita agua urgente",priority:"high"};if(r>3)return{...n,color:"bg-orange-400",textColor:"text-orange-700 dark:text-orange-300",status:"Necesita agua",priority:"medium"}}return n}const kF=t=>({src:t.profileImageUrl||"/placeholder-plant.jpg",alt:`${t.name} - ${t.species}`,className:"w-full h-48 object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),NF=t=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Math.min(t*.1,.5)},whileHover:{y:-4,transition:{duration:.2}},whileTap:{scale:.98,transition:{duration:.1}}}),jA=w.memo(({plant:t,index:e})=>{const{state:r,actions:n}=PF(t),{needsWatering:i,isFavorite:a,healthStatus:s}=r,{handleClick:o,handleMouseEnter:c}=n,l=kF(t),u=NF(e);return d.jsx(L.div,{...u,className:"group",children:d.jsxs(Pr,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:o,onMouseEnter:c,className:"overflow-hidden border border-green-200/60 hover:border-green-300/80 dark:hover:border-green-600 transition-all duration-300 p-4 mb-4 shadow-sm hover:shadow-lg hover:shadow-green-100/30 bg-white/80 backdrop-blur-sm",children:[d.jsx(Ud,{className:"pb-2 flex-shrink-0 space-y-0",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[d.jsx(Ag,{...l,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",priority:e<4,sizes:"(max-width: 768px) 20vw, 10vw",fallback:d.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:d.jsx(wa,{size:24})})}),d.jsx(ke,{children:a&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(eE,{size:12,className:"text-white fill-current"})})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:d.jsx(xc,{size:12,className:"text-white"})})})})]}),d.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[d.jsx(Tg,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),d.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),d.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:d.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:["📍 ",t.location]})})]})]})}),d.jsxs(ei,{className:"pt-2 pb-0",children:[d.jsx(NA,{score:t.healthScore,healthStatus:s,size:"medium",animated:!0}),t.healthScore<40&&d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[d.jsx(En,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),d.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),d.jsx(L.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});jA.displayName="PlantCard";function pe({className:t,...e}){return d.jsx("div",{className:Oe("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",t),...e})}const jF=()=>d.jsxs(Pr,{variant:"elevated",size:"default",className:"overflow-hidden",children:[d.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[d.jsx(pe,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs(Ud,{className:"p-0",children:[d.jsx(pe,{className:"h-6 w-3/4"}),d.jsx(pe,{className:"h-4 w-1/2 mt-2"})]}),d.jsx(ei,{className:"p-0 mt-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(pe,{className:"w-16 h-1.5"}),d.jsx(pe,{className:"w-8 h-3"})]})})]})]}),d.jsx(kA,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:d.jsxs("div",{className:"flex justify-between items-center w-full",children:[d.jsx(pe,{className:"h-4 w-1/3"}),d.jsx(pe,{className:"w-8 h-8 rounded"})]})})]}),OF=Eg("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),me=H.forwardRef(({className:t,variant:e,size:r,fullWidth:n,loading:i=!1,leftIcon:a,rightIcon:s,children:o,disabled:c,...l},u)=>{const h=c||i;return d.jsxs(L.button,{whileTap:h?void 0:{scale:.96},whileHover:h?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:Oe(OF({variant:e,size:r,fullWidth:n,className:t})),disabled:h,ref:u,...l,children:[i&&d.jsx(L.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),a&&!i&&d.jsx("span",{className:"mr-2 -ml-1",children:a}),d.jsx("span",{className:Oe("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(m=>typeof m=="string"||typeof m=="number"||H.isValidElement(m)):typeof o=="string"||typeof o=="number"||H.isValidElement(o)?o:null}),s&&d.jsx("span",{className:"ml-2 -mr-1",children:s})]})});me.displayName="Button";const RF=Eg("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Bd=H.forwardRef(({className:t,variant:e,size:r,state:n,label:i,helperText:a,errorMessage:s,successMessage:o,leftIcon:c,rightIcon:l,loading:u=!1,showPasswordToggle:h=!1,floatingLabel:m=!1,type:p,disabled:v,value:b,defaultValue:g,..._},T)=>{const[E,j]=w.useState(!1),[R,D]=w.useState(!1),[S,A]=w.useState(b||g||""),P=w.useRef(null),O=w.useCallback(he=>{P.current=he,typeof T=="function"?T(he):T&&(T.current=he)},[T]),N=s?"error":o?"success":n,C=!!S||E,k=h?R?"text":"password":p;w.useEffect(()=>{b!==void 0&&A(b)},[b]);const Q=he=>{j(!0),_.onFocus?.(he)},oe=he=>{j(!1),_.onBlur?.(he)},X=he=>{A(he.target.value),_.onChange?.(he)},ee=()=>{P.current?.focus()};return d.jsxs("div",{className:"w-full",children:[d.jsxs("div",{className:"relative",children:[i&&!m&&d.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),d.jsxs("div",{className:"relative",children:[c&&d.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:c}),i&&m&&d.jsx(L.label,{onClick:ee,animate:{scale:C?.85:1,y:C?-24:0,x:C?4:c?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",C&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),d.jsx("input",{ref:O,type:k,value:S,disabled:v||u,className:Oe(RF({variant:e,size:r,state:N}),c&&"pl-10",(l||h||u)&&"pr-10",m&&C&&"pt-6 pb-2",(!r||r==="default")&&"py-[12px]","placeholder-[#777]",t),style:{..._.style},onFocus:Q,onBlur:oe,onChange:X,..._}),d.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[u&&d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:d.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!u&&N==="error"&&d.jsx(Jr,{className:"w-4 h-4 text-error-500"}),!u&&N==="success"&&d.jsx(Si,{className:"w-4 h-4 text-success-500"}),h&&!u&&d.jsx("button",{type:"button",onClick:()=>D(!R),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:R?d.jsx(Qk,{className:"w-4 h-4"}):d.jsx(Vf,{className:"w-4 h-4"})}),l&&!u&&d.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:l})]})]}),d.jsx(ke,{children:E&&d.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:Oe("absolute inset-0 rounded-xl pointer-events-none",N==="error"&&"ring-2 ring-error-500/20",N==="success"&&"ring-2 ring-success-500/20",N==="default"&&"ring-2 ring-primary-500/20")})})]}),d.jsx(ke,{mode:"wait",children:(a||s||o)&&d.jsxs(L.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[s&&d.jsxs(d.Fragment,{children:[d.jsx(Jr,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),d.jsx("span",{className:"text-error-600 dark:text-error-400",children:s})]}),o&&!s&&d.jsxs(d.Fragment,{children:[d.jsx(Si,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),d.jsx("span",{className:"text-success-600 dark:text-success-400",children:o})]}),a&&!s&&!o&&d.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:a})]})})]})});Bd.displayName="Input";const DF={default:xa,ai:nE,camera:Gn,upload:rE,download:rN,sync:tN,search:eN,save:Jk,delete:tE,chat:wc},MF={sm:{icon:"w-4 h-4",text:"text-sm",gap:"gap-2"},md:{icon:"w-5 h-5",text:"text-base",gap:"gap-3"},lg:{icon:"w-6 h-6",text:"text-lg",gap:"gap-4"}},LF=({message:t,type:e="default",size:r="md",className:n=""})=>{const i=DF[e],a=MF[r];return d.jsxs("div",{className:`flex items-center justify-center ${a.gap} ${n}`,children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"flex-shrink-0",children:d.jsx(i,{className:`${a.icon} text-primary-500`})}),d.jsx("span",{className:`${a.text} text-gray-600 dark:text-gray-400 font-medium`,children:t})]})},$F={LoadingPlants:t=>d.jsx(LF,{message:"Cargando tu jardín...",type:"default",...t})},Sm=({children:t,content:e,position:r="top",delay:n=300,disabled:i=!1,className:a=""})=>{const[s,o]=w.useState(!1),[c,l]=w.useState({x:0,y:0}),u=w.useRef(null),h=w.useRef(),m=()=>{i||(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(u.current){const g=u.current.getBoundingClientRect(),_=window.pageYOffset||document.documentElement.scrollTop,T=window.pageXOffset||document.documentElement.scrollLeft;let E,j;switch(r){case"top":E=g.left+T+g.width/2,j=g.top+_-8;break;case"bottom":E=g.left+T+g.width/2,j=g.bottom+_+8;break;case"left":E=g.left+T-8,j=g.top+_+g.height/2;break;case"right":E=g.right+T+8,j=g.top+_+g.height/2;break;default:E=g.left+T+g.width/2,j=g.top+_-8}l({x:E,y:j}),o(!0)}},n))},p=()=>{h.current&&clearTimeout(h.current),o(!1)};w.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const v=()=>{const g="absolute z-[9999] px-2 py-1 text-xs font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-md shadow-lg pointer-events-none max-w-xs";switch(r){case"top":return`${g} -translate-x-1/2 -translate-y-full`;case"bottom":return`${g} -translate-x-1/2`;case"left":return`${g} -translate-x-full -translate-y-1/2`;case"right":return`${g} -translate-y-1/2`;default:return`${g} -translate-x-1/2 -translate-y-full`}},b=()=>{const g="absolute w-2 h-2 bg-gray-900 dark:bg-gray-700 transform rotate-45";switch(r){case"top":return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`;case"bottom":return`${g} left-1/2 -translate-x-1/2 -top-1`;case"left":return`${g} top-1/2 -translate-y-1/2 left-full -translate-x-1/2`;case"right":return`${g} top-1/2 -translate-y-1/2 -left-1`;default:return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`}};return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:u,onMouseEnter:m,onMouseLeave:p,onFocus:m,onBlur:p,className:`inline-block ${a}`,children:t}),typeof document<"u"&&fp.createPortal(d.jsx(ke,{children:s&&d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:v(),style:{left:c.x,top:c.y},children:[e,d.jsx("div",{className:b()})]})}),document.body)]})},VF={network:{icon:J_,color:"text-orange-500",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Verificar conexión",action:"help"}]},validation:{icon:En,color:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-800",defaultActions:[{label:"Corregir",action:"retry"}]},server:{icon:En,color:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Reportar problema",action:"help"}]},unknown:{icon:nN,color:"text-gray-500",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800",defaultActions:[{label:"Reintentar",action:"retry"}]}},FF=({title:t,message:e,type:r="unknown",onRetry:n,onDismiss:i,actions:a,className:s=""})=>{const o=VF[r],c=o.icon,l=h=>{switch(h){case"retry":n?.();break;case"help":console.log("Help requested for error type:",r);break}},u=()=>a?a.map((h,m)=>d.jsx(me,{variant:h.variant||"outline",size:"sm",onClick:h.onClick,children:h.label},m)):o.defaultActions.map((h,m)=>d.jsxs(me,{variant:m===0?"primary":"outline",size:"sm",onClick:()=>l(h.action),disabled:h.action==="retry"&&!n,children:[h.action==="retry"&&d.jsx(ji,{className:"w-4 h-4 mr-1"}),h.action==="help"&&d.jsx(iN,{className:"w-4 h-4 mr-1"}),h.label]},m));return d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
        ${o.bgColor} 
        ${o.borderColor} 
        border rounded-lg p-4 
        ${s}
      `,children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:`${o.color} flex-shrink-0 mt-0.5`,children:d.jsx(c,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:t}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e}),d.jsx("div",{className:"flex flex-wrap gap-2",children:u()})]}),i&&d.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar error",children:d.jsx(Wi,{className:"w-4 h-4"})})]})})},zF={LoadingPlantsError:t=>d.jsx(FF,{type:"server",title:"Error al Cargar Plantas",message:"No se pudieron cargar tus plantas. Intenta refrescar la página.",...t})},UF=({isOpen:t,onComplete:e,onSkip:r,steps:n})=>{const[i,a]=w.useState(0),[s,o]=w.useState(null),[c,l]=w.useState({x:0,y:0}),u=n[i],h=i===n.length-1,m=i===0;w.useEffect(()=>{if(!t||!u?.target)return;const g=document.querySelector(u.target);if(g){o(g);const _=g.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,E=window.pageXOffset||document.documentElement.scrollLeft;let j,R;switch(u.position){case"top":j=_.left+E+_.width/2,R=_.top+T-20;break;case"bottom":j=_.left+E+_.width/2,R=_.bottom+T+20;break;case"left":j=_.left+E-20,R=_.top+T+_.height/2;break;case"right":j=_.right+E+20,R=_.top+T+_.height/2;break;default:j=window.innerWidth/2,R=window.innerHeight/2}l({x:j,y:R}),g.scrollIntoView({behavior:"smooth",block:"center"})}else o(null),l({x:window.innerWidth/2,y:window.innerHeight/2})},[t,u,i]);const p=()=>{h?e():a(g=>g+1)},v=()=>{m||a(g=>g-1)},b=()=>{if(!u?.position||u.position==="center")return"-translate-x-1/2 -translate-y-1/2";switch(u.position){case"top":return"-translate-x-1/2 -translate-y-full";case"bottom":return"-translate-x-1/2";case"left":return"-translate-x-full -translate-y-1/2";case"right":return"-translate-y-1/2";default:return"-translate-x-1/2 -translate-y-1/2"}};return t?d.jsx(ke,{children:d.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60"}),s&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute pointer-events-none",style:{left:s.getBoundingClientRect().left+window.pageXOffset,top:s.getBoundingClientRect().top+window.pageYOffset,width:s.getBoundingClientRect().width,height:s.getBoundingClientRect().height,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(34, 197, 94, 0.5)",borderRadius:"8px"}}),d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 max-w-sm ${b()}`,style:{left:c.x,top:c.y},children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(er,{className:"w-5 h-5 text-green-500"}),d.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["Paso ",i+1," de ",n.length]})]}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Omitir tour",children:d.jsx(Wi,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:u.title}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:u.description})]}),u.action&&d.jsx("div",{className:"mb-4",children:d.jsx(me,{variant:"outline",size:"sm",onClick:u.action.onClick,className:"w-full",children:u.action.label})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs(me,{variant:"ghost",size:"sm",onClick:v,disabled:m,className:"flex items-center gap-1",children:[d.jsx(iE,{className:"w-4 h-4"}),"Anterior"]}),d.jsx("div",{className:"flex gap-1",children:n.map((g,_)=>d.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${_===i?"bg-green-500":_<i?"bg-green-300":"bg-gray-300"}`},_))}),d.jsxs(me,{size:"sm",onClick:p,className:"flex items-center gap-1",children:[h?"Finalizar":"Siguiente",!h&&d.jsx(aE,{className:"w-4 h-4"})]})]}),d.jsx("div",{className:"mt-4 text-center",children:d.jsx("button",{onClick:r,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Omitir tour"})})]})]})}):null},kl="1.0.0",dx="plantitas-onboarding-state",BF=()=>{const t=ar(),[e,r]=w.useState(()=>{try{const u=localStorage.getItem(dx);if(u){const h=JSON.parse(u);return h.currentVersion!==kl?{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:kl}:h}}catch(u){console.warn("Error loading onboarding state:",u)}return{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:kl}});w.useEffect(()=>{try{localStorage.setItem(dx,JSON.stringify(e))}catch(u){console.warn("Error saving onboarding state:",u)}},[e]);const n=u=>{r(h=>({...h,...u}))};return{state:e,shouldShowTour:()=>!e.hasCompletedTour,completeTour:()=>{n({hasCompletedTour:!0})},markFirstPlantAdded:()=>{n({hasAddedFirstPlant:!0})},markChatUsed:()=>{n({hasUsedChat:!0})},resetOnboarding:()=>{r({hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:kl})},getTourSteps:()=>[{id:"welcome",title:"¡Bienvenido a Plantitas! 🌱",description:"Tu asistente personal para el cuidado de plantas. Te ayudaremos a mantener tus plantas saludables y felices.",position:"center"},{id:"add-plant",title:"Agrega tu primera planta",description:"Usa el botón flotante para tomar una foto de tu planta. Nuestra IA la identificará automáticamente.",target:'[data-tour="add-plant-fab"]',position:"left",action:{label:"Ir a cámara",onClick:()=>t(gt.toCamera())}},{id:"navigation",title:"Navegación principal",description:"Usa la navegación inferior para moverte entre el jardín, chat IA y configuraciones.",target:'[data-tour="bottom-navigation"]',position:"top"},{id:"chat-ai",title:"Chat con IA experta",description:"Haz preguntas sobre cuidado de plantas, identificación o cualquier duda que tengas.",target:'[data-tour="chat-tab"]',position:"top",action:{label:"Probar chat",onClick:()=>t(gt.toGardenChat())}},{id:"search-filter",title:"Busca y organiza",description:"Usa la búsqueda y filtros para encontrar rápidamente tus plantas cuando tengas muchas.",target:'[data-tour="search-input"]',position:"bottom"},{id:"complete",title:"¡Listo para empezar! 🎉",description:"Ya conoces lo básico. ¡Comienza agregando tu primera planta y explorando todas las funciones!",position:"center"}]}},hx=({type:t,title:e,message:r,onDismiss:n,autoHide:i=!1,duration:a=8e3,actions:s})=>{const[o,c]=w.useState(!0),l=ar();w.useEffect(()=>{if(i&&a>0){const v=setTimeout(()=>{c(!1),n?.()},a);return()=>clearTimeout(v)}},[i,a,n]);const u=()=>{c(!1),n?.()};if(!o)return null;const m={suggestion:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",accent:"text-purple-600 dark:text-purple-400",icon:nE},tip:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",accent:"text-blue-600 dark:text-blue-400",icon:er},welcome:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",accent:"text-green-600 dark:text-green-400",icon:wc}}[t],p=m.icon;return d.jsx(ke,{children:d.jsxs(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:`
          ${m.bg} ${m.border}
          border rounded-lg p-4 shadow-md backdrop-blur-sm
          relative overflow-hidden
        `,children:[d.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 opacity-10",children:d.jsx(p,{className:"w-full h-full"})}),d.jsxs("div",{className:"relative flex items-start gap-3",children:[d.jsx("div",{className:`${m.accent} flex-shrink-0 mt-0.5`,children:d.jsx(p,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:`${m.accent} text-sm font-semibold mb-1`,children:e}),d.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-3",children:r}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s?s.map((v,b)=>d.jsx(me,{size:"sm",variant:v.variant||"outline",onClick:v.onClick,className:"text-xs",children:v.label},b)):d.jsxs(me,{size:"sm",variant:"outline",onClick:()=>l(gt.toGardenChat()),className:"text-xs flex items-center gap-1",children:["Probar Chat IA",d.jsx(aN,{className:"w-3 h-3"})]})})]}),n&&d.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar sugerencia",children:d.jsx(Wi,{className:"w-4 h-4"})})]}),i&&a>0&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10",children:d.jsx(L.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:a/1e3,ease:"linear"},className:`h-full ${m.accent.replace("text-","bg-")}`})})]})})},HF=()=>{const[t,e]=w.useState(()=>{try{const a=localStorage.getItem("dismissed-ai-highlights");return a?JSON.parse(a):[]}catch{return[]}});return{dismissHighlight:a=>{const s=[...t,a];e(s);try{localStorage.setItem("dismissed-ai-highlights",JSON.stringify(s))}catch(o){console.warn("Error saving dismissed highlights:",o)}},shouldShowHighlight:a=>!t.includes(a),resetHighlights:()=>{e([]);try{localStorage.removeItem("dismissed-ai-highlights")}catch(a){console.warn("Error resetting highlights:",a)}}}},WF=()=>{const t=ar();return d.jsxs(L.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6 max-w-lg mx-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[d.jsxs(L.div,{className:"relative w-32 h-32 mb-8",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[d.jsx(sE,{className:"absolute top-2 left-2 w-10 h-10 text-sky-400 opacity-60"}),d.jsx(md,{className:"w-32 h-32 text-green-500"}),d.jsx(xc,{className:"absolute bottom-2 right-2 w-12 h-12 text-blue-400 opacity-70"})]}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"¡Comienza tu jardín digital!"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-lg leading-relaxed",children:"Añade tu primera planta tomando una foto y deja que nuestra IA la identifique y te ayude a cuidarla."}),d.jsxs("div",{className:"mb-8 space-y-3 text-left",children:[d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Identificación automática con IA"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Recordatorios de riego personalizados"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Chat con asistente experto en plantas"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[d.jsxs(me,{size:"lg",onClick:()=>t(gt.toCamera()),className:"flex-1",children:[d.jsx(gp,{className:"mr-2"}),"Tomar Foto"]}),d.jsx(Sm,{content:"Explora las funciones de chat IA para aprender sobre plantas",children:d.jsxs(me,{size:"lg",variant:"outline",onClick:()=>t(gt.toGardenChat()),className:"flex-1",children:[d.jsx(wc,{className:"mr-2"}),"Explorar Chat IA"]})})]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6",children:"💡 Tip: Toma fotos con buena iluminación para mejores resultados"})]})},qF=()=>{const{data:t=[],isLoading:e,error:r}=AF(),[n,i]=w.useState(""),[a,s]=w.useState("name"),{shouldShowTour:o,completeTour:c,getTourSteps:l}=BF(),{shouldShowHighlight:u,dismissHighlight:h}=HF(),m=w.useMemo(()=>[...t].filter(p=>p.name.toLowerCase().includes(n.toLowerCase())||p.species.toLowerCase().includes(n.toLowerCase())).sort((p,v)=>{switch(a){case"health":return(v.healthScore||0)-(p.healthScore||0);case"lastWatered":return(v.lastWatered?.getTime()||0)-(p.lastWatered?.getTime()||0);default:return p.name.localeCompare(v.name)}}),[t,n,a]);return e?d.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[d.jsxs("header",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),d.jsx($F.LoadingPlants,{size:"sm"})]}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((p,v)=>d.jsx(jF,{},v))})]}):r?d.jsx("div",{className:"flex justify-center items-center min-h-[50vh] p-4",children:d.jsx(zF.LoadingPlantsError,{onRetry:()=>window.location.reload(),className:"max-w-md"})}):d.jsxs("div",{className:"container-spacing element-spacing bg-gradient-to-br from-green-50/30 via-white to-emerald-50/20 min-h-screen",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx("header",{className:"flex items-center justify-between border-b border-green-100/50 bg-white/70 backdrop-blur-sm pb-4 mb-6 rounded-xl px-4 py-3 shadow-sm shadow-green-100/20",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Sm,{content:"Tu jardín personal de plantas",children:d.jsx(md,{size:20,strokeWidth:2,className:"text-[#2A7F3E] flex-shrink-0"})}),d.jsx("h1",{className:"font-semibold text-[28px] leading-[1.2] text-[#222]",children:"Mi Jardín"}),d.jsx(Sm,{content:`Tienes ${t.length} ${t.length===1?"planta registrada":"plantas registradas"} en tu jardín`,children:d.jsxs("span",{className:"ml-2 bg-[#E0F2E9]/50 text-[#2A7F3E] text-sm font-medium rounded-full px-[6px] py-[2px] cursor-help",children:[t.length," ",t.length===1?"planta":"plantas"]})})]})}),t.length>0&&u("dashboard-ai-welcome")&&d.jsx("div",{className:"mb-4",children:d.jsx(hx,{type:"welcome",title:"¡Tu asistente IA está disponible!",message:"Haz preguntas sobre el cuidado de tus plantas, identifica problemas o descubre nuevos consejos.",onDismiss:()=>h("dashboard-ai-welcome"),autoHide:!0,duration:1e4})}),t.length>=3&&u("dashboard-ai-tips")&&d.jsx("div",{className:"mb-4",children:d.jsx(hx,{type:"tip",title:"Consejo del jardinero experto",message:"Con varias plantas, puedes preguntarme sobre rutinas de cuidado personalizadas para optimizar tu tiempo.",onDismiss:()=>h("dashboard-ai-tips"),autoHide:!0,duration:12e3})}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 mt-6 mb-6",children:[d.jsx(Bd,{type:"text",placeholder:"Buscar por nombre o especie...",value:n,onChange:p=>i(p.target.value),className:"max-w-md w-full mx-auto","data-tour":"search-input"}),d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsxs("select",{value:a,onChange:p=>s(p.target.value),className:"appearance-none bg-white border border-green-300 rounded-[8px] px-4 py-2 h-10 text-green-700 font-medium shadow-sm focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors duration-150 w-full pr-8",style:{borderWidth:"1px"},children:[d.jsx("option",{value:"name",children:"Ordenar por Nombre"}),d.jsx("option",{value:"health",children:"Ordenar por Salud"}),d.jsx("option",{value:"lastWatered",children:"Ordenar por Riego"})]}),d.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-green-400 text-base",children:"▼"})]})]}),d.jsx(ke,{children:m.length>0?d.jsx(L.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing card--responsive",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.01,delayChildren:0}}},children:m.map((p,v)=>d.jsx(jA,{plant:p,index:Math.min(v,8)},p.id))}):d.jsx(WF,{})}),d.jsx(UF,{isOpen:o()&&t.length===0,onComplete:c,onSkip:c,steps:l()})]})};function Im(t){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Im(t)}function fr(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Tt(t){fr(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||Im(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var KF={};function GF(){return KF}function Ou(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function fx(t){fr(1,arguments);var e=Tt(t);return e.setHours(0,0,0,0),e}var YF=864e5;function ZF(t,e){fr(2,arguments);var r=fx(t),n=fx(e),i=r.getTime()-Ou(r),a=n.getTime()-Ou(n);return Math.round((i-a)/YF)}function nu(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function XF(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function mx(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function QF(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=mx(r,n),a=Math.abs(ZF(r,n));r.setDate(r.getDate()-i*a);var s=+(mx(r,n)===-i),o=i*(a-s);return o===0?0:o}function JF(t,e){return fr(2,arguments),Tt(t).getTime()-Tt(e).getTime()}var ez={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},tz="trunc";function rz(t){return ez[tz]}function nz(t){fr(1,arguments);var e=Tt(t);return e.setHours(23,59,59,999),e}function iz(t){fr(1,arguments);var e=Tt(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function az(t){fr(1,arguments);var e=Tt(t);return nz(e).getTime()===iz(e).getTime()}function sz(t,e){fr(2,arguments);var r=Tt(t),n=Tt(e),i=nu(r,n),a=Math.abs(XF(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=nu(r,n)===-i;az(Tt(t))&&a===1&&nu(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function oz(t,e,r){fr(2,arguments);var n=JF(t,e)/1e3;return rz()(n)}var cz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},lz=function(e,r,n){var i,a=cz[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function Ts(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var uz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fz={date:Ts({formats:uz,defaultWidth:"full"}),time:Ts({formats:dz,defaultWidth:"full"}),dateTime:Ts({formats:hz,defaultWidth:"full"})},mz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pz=function(e,r,n,i){return mz[e]};function un(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[c]||t.values[o]}var l=t.argumentCallback?t.argumentCallback(e):e;return i[l]}}var gz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},bz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_z=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Ez={ordinalNumber:_z,era:un({values:gz,defaultWidth:"wide"}),quarter:un({values:yz,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:un({values:vz,defaultWidth:"wide"}),day:un({values:bz,defaultWidth:"wide"}),dayPeriod:un({values:xz,defaultWidth:"wide",formattingValues:wz,defaultFormattingWidth:"wide"})};function dn(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(o)?Az(o,function(h){return h.test(s)}):Tz(o,function(h){return h.test(s)}),l;l=t.valueCallback?t.valueCallback(c):c,l=r.valueCallback?r.valueCallback(l):l;var u=e.slice(s.length);return{value:l,rest:u}}}function Tz(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function Az(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function OA(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var Sz=/^(\d+)(th|st|nd|rd)?/i,Iz=/\d+/i,Pz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Cz={any:[/^b/i,/^(a|c)/i]},kz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Nz={any:[/1/i,/2/i,/3/i,/4/i]},jz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Oz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Rz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Dz={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Mz={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Lz={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$z={ordinalNumber:OA({matchPattern:Sz,parsePattern:Iz,valueCallback:function(e){return parseInt(e,10)}}),era:dn({matchPatterns:Pz,defaultMatchWidth:"wide",parsePatterns:Cz,defaultParseWidth:"any"}),quarter:dn({matchPatterns:kz,defaultMatchWidth:"wide",parsePatterns:Nz,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:dn({matchPatterns:jz,defaultMatchWidth:"wide",parsePatterns:Oz,defaultParseWidth:"any"}),day:dn({matchPatterns:Rz,defaultMatchWidth:"wide",parsePatterns:Dz,defaultParseWidth:"any"}),dayPeriod:dn({matchPatterns:Mz,defaultMatchWidth:"any",parsePatterns:Lz,defaultParseWidth:"any"})},Vz={code:"en-US",formatDistance:lz,formatLong:fz,formatRelative:pz,localize:Ez,match:$z,options:{weekStartsOn:0,firstWeekContainsDate:1}};function RA(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function Fz(t){return RA({},t)}var px=1440,zz=2520,hf=43200,Uz=86400;function Bz(t,e,r){var n,i;fr(2,arguments);var a=GF(),s=(n=(i=r?.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:Vz;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=nu(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var c=RA(Fz(r),{addSuffix:!!r?.addSuffix,comparison:o}),l,u;o>0?(l=Tt(e),u=Tt(t)):(l=Tt(t),u=Tt(e));var h=oz(u,l),m=(Ou(u)-Ou(l))/1e3,p=Math.round((h-m)/60),v;if(p<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,c):h<10?s.formatDistance("lessThanXSeconds",10,c):h<20?s.formatDistance("lessThanXSeconds",20,c):h<40?s.formatDistance("halfAMinute",0,c):h<60?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",1,c):p===0?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",p,c);if(p<45)return s.formatDistance("xMinutes",p,c);if(p<90)return s.formatDistance("aboutXHours",1,c);if(p<px){var b=Math.round(p/60);return s.formatDistance("aboutXHours",b,c)}else{if(p<zz)return s.formatDistance("xDays",1,c);if(p<hf){var g=Math.round(p/px);return s.formatDistance("xDays",g,c)}else if(p<Uz)return v=Math.round(p/hf),s.formatDistance("aboutXMonths",v,c)}if(v=sz(u,l),v<12){var _=Math.round(p/hf);return s.formatDistance("xMonths",_,c)}else{var T=v%12,E=Math.floor(v/12);return T<3?s.formatDistance("aboutXYears",E,c):T<9?s.formatDistance("overXYears",E,c):s.formatDistance("almostXYears",E+1,c)}}function DA(t,e){return fr(1,arguments),Bz(t,Date.now(),e)}const Hz=async t=>{const{data:e,error:r}=await Et.from("plants").select(`
      *,
      plant_images(*)
    `).eq("id",t).single();if(r)throw console.error(`Error fetching plant ${t}:`,r),r.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");const n=e;return{id:n.id,name:n.name,species:n.species,description:n.description??void 0,funFacts:n.fun_facts??void 0,variety:n.variety??void 0,nickname:n.nickname??void 0,location:n.location,plantEnvironment:n.plant_environment,lightRequirements:n.light_requirements,dateAdded:new Date(n.date_added),lastWatered:n.last_watered?new Date(n.last_watered):void 0,lastFertilized:n.last_fertilized?new Date(n.last_fertilized):void 0,healthScore:n.health_score??0,careProfile:n.care_profile,personality:n.personality,images:n.plant_images.map(i=>({id:i.id,url:i.url??"",timestamp:new Date(i.created_at),isProfileImage:i.is_profile_image??!1,healthAnalysis:i.health_analysis})),chatHistory:[],notifications:[]}},Sg=t=>{const{data:e,isLoading:r,error:n}=G_({queryKey:["plant",t],queryFn:async()=>Hz(t),enabled:!!t,staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1}),i=qn(o=>o.setPlant),a=qn(o=>o.selectPlant);w.useEffect(()=>(e&&(i(e),a(e.id)),()=>{a(null)}),[e,i,a]);const s=w.useMemo(()=>{if(!e)return[];const o=[];if(!e.images||e.images.length===0)return o;const c=e.images.map(l=>l.healthAnalysis?.confidence||null).filter(l=>l!==null);if(c.length>=3){const l=c.slice(-3);if(l[0]>l[1]&&l[1]>l[2]){const u=l[0]-l[2];o.push({type:"warning",title:"Tendencia de Salud a la Baja",message:`La salud de tu planta ha disminuido un ${u.toFixed(0)}% en las últimas revisiones.`})}}if(e.lastWatered&&e.careProfile){const l=QF(new Date,new Date(e.lastWatered)),u=e.careProfile.wateringFrequency;l>u&&o.push({type:"tip",title:"Consejo de Riego",message:`Han pasado ${l} días desde el último riego. El intervalo recomendado es de ${u} días.`})}return o},[e]);return{plant:e,insights:s,loading:r,error:n?.message||null}},Wz=()=>{const t=fd(),r=Nn(o=>o.user)?.id,{addToast:n}=qs(),i=Ti({mutationFn:async({plantId:o,imageDataUrl:c,note:l})=>{if(!r)throw new Error("User not authenticated");console.log("🖼️ [Image] Iniciando proceso de subida de imagen..."),console.log("🔬 [Image] Analizando imagen con IA...");const u=await CA(c);console.log("☁️ [Image] Subiendo imagen a Storage...");const h=await eA(c,"plant-images",`${r}/${o}`);console.log("💾 [Image] Guardando registro en base de datos...");const m=await ps.addPlantImage(o,{url:h,timestamp:new Date,isProfileImage:!1,healthAnalysis:u.health},r);return u.health?.confidence&&(console.log("🏥 [Image] Actualizando health score de la planta..."),await ps.updatePlantHealthScore(o,r,u.health.confidence,u.health,m.id)),console.log("✅ [Image] Proceso completado exitosamente"),{image:m,analysis:u,note:l}},onSuccess:(o,c)=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",c.plantId]});const{setPlant:l}=qn.getState(),u=qn.getState().getPlantById(c.plantId);if(u){const h={...u,images:[...u.images,o.image],healthScore:o.analysis.health?.confidence||u.healthScore};l(h)}n({type:"success",title:"Nueva imagen añadida",message:`Análisis completado. Salud actual: ${o.analysis.health?.confidence?.toFixed(0)||"N/A"}%`})},onError:o=>{console.error("💥 [Image] Error en proceso de subida:",o),n({type:"error",title:"Error al agregar imagen",message:o.message})}}),a=Ti({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🖼️ [Profile] Cambiando imagen de perfil..."),await ps.setProfileImage(o,c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen de perfil actualizada",message:"La imagen principal de la planta ha sido cambiada"})},onError:o=>{n({type:"error",title:"Error al cambiar imagen de perfil",message:o.message})}}),s=Ti({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🗑️ [Image] Eliminando imagen..."),await ps.deleteImage(c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen eliminada",message:"La imagen ha sido eliminada de tu planta"})},onError:o=>{n({type:"error",title:"Error al eliminar imagen",message:o.message})}});return{addPlantImage:i.mutate,isAddingImage:i.isPending,setProfileImage:a.mutate,isSettingProfileImage:a.isPending,deleteImage:s.mutate,isDeletingImage:s.isPending}};function qz({images:t}){const[e,r]=w.useState(null);if(!t||t.length===0)return d.jsx(Pr,{className:"mt-4",children:d.jsx(ei,{className:"pt-6",children:d.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[d.jsx(Gn,{className:"w-12 h-12 text-muted-foreground mb-4"}),d.jsx("p",{className:"text-muted-foreground",children:"No hay imágenes para esta planta todavía."}),d.jsx("p",{className:"text-sm text-muted-foreground/70 mt-2",children:"¡Agrega algunas fotos para seguir su progreso!"})]})})});const n=[...t].sort((c,l)=>new Date(l.timestamp).getTime()-new Date(c.timestamp).getTime()),i=c=>{r(c)},a=()=>{r(null)},s=c=>{if(e===null)return;const l=c==="prev"?(e-1+n.length)%n.length:(e+1)%n.length;r(l)},o=c=>(c instanceof Date?c:new Date(c)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"});return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold tracking-tight flex items-center",children:[d.jsx(Gn,{className:"w-5 h-5 mr-2 text-primary"}),"Galería de Imágenes"]}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," foto",n.length!==1?"s":""]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((c,l)=>d.jsxs(L.div,{className:"aspect-square relative rounded-[8px] overflow-hidden cursor-pointer group w-[80px] h-[80px]",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(l),children:[d.jsx(Ag,{src:c.url,alt:`Imagen de planta del ${o(c.timestamp)}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 rounded-[8px]"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:d.jsx("div",{className:"flex items-center text-white text-xs gap-2",children:d.jsxs("span",{className:"flex items-center",children:[d.jsx(su,{className:"w-3 h-3 mr-1"}),o(c.timestamp)]})})})}),c.isProfileImage&&d.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full font-medium",children:"Principal"})]},c.id))}),d.jsx(ke,{children:e!==null&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a,children:d.jsxs(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:c=>c.stopPropagation(),children:[d.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(Wi,{className:"w-6 h-6"})}),n.length>1&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>s("prev"),className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(iE,{className:"w-6 h-6"})}),d.jsx("button",{onClick:()=>s("next"),className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(aE,{className:"w-6 h-6"})})]}),d.jsx("img",{src:n[e].url,alt:`Imagen de planta del ${o(n[e].timestamp)}`,className:"max-w-full max-h-full object-contain rounded-lg"}),d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-black/50 text-white p-4 rounded-lg backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(su,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm",children:o(n[e].timestamp)})]}),d.jsxs("span",{className:"text-sm text-white/70",children:[e+1," de ",n.length]})]}),d.jsx("div",{className:"mt-2 text-sm flex items-center gap-2",children:(()=>{const c=n[e].healthAnalysis;if(!c)return d.jsx("span",{className:"italic text-white/60",children:"Sin análisis"});let l="🌱",u="Excelente";switch(c.overallHealth){case"excellent":l="🌱",u="Excelente";break;case"good":l="🌿",u="Buena";break;case"fair":l="🍃",u="Regular";break;case"poor":l="🥀",u="Baja";break;default:l="🌱",u=c.overallHealth}let h;const m={excellent:95,good:80,fair:60,poor:30};return c.overallHealth&&m[c.overallHealth]?h=m[c.overallHealth]:typeof c.confidence=="number"&&(h=c.confidence<=1?c.confidence*100:c.confidence),d.jsxs("span",{children:["Salud: ",d.jsx("span",{className:"font-semibold",children:u})," ",d.jsx("span",{children:l}),h!==void 0&&d.jsxs("span",{className:"ml-2",children:["(",Math.round(h),"%)"]})]})})()}),n[e].isProfileImage&&d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:"Imagen Principal"})})]})]})})})]})}const Kz=new _g,Gz=()=>{const[t,e]=w.useState(!1),r=fd(),n=Nn(o=>o.user),{addToast:i}=qs(),a=Ti({mutationFn:async({plantId:o,species:c,commonName:l})=>{if(!n)throw new Error("User not authenticated");e(!0),i({type:"info",title:"🤖 Completando información",message:`Consultando IA para ${l||c}...`,duration:3e3});try{const u=await sF(c,l);return await Kz.updatePlantInfo(o,n.id,{plantEnvironment:u.plantEnvironment,lightRequirements:u.lightRequirements,description:u.description,funFacts:u.funFacts})}catch(u){throw console.error("❌ [COMPLETAR IA] Error durante el proceso:",u),u}finally{e(!1)}},onSuccess:o=>{console.log("🔄 [COMPLETAR IA] Refrescando datos en cache..."),i({type:"success",title:"✅ ¡Información completada!",message:`Se agregaron datos de ambiente y luz para ${o.name}`,duration:5e3}),r.invalidateQueries({queryKey:["plant",o.id]}),r.invalidateQueries({queryKey:["plants"]}),console.log("✅ [COMPLETAR IA] Cache actualizado correctamente")},onError:o=>{console.error("💥 [COMPLETAR IA] Error final en la operación:",o),i({type:"error",title:"❌ Error al completar información",message:"No se pudo obtener los datos de IA. Intenta de nuevo.",duration:7e3}),e(!1)}});return{completeInfo:(o,c,l)=>a.mutate({plantId:o,species:c,commonName:l}),isCompleting:t||a.isPending,error:a.error,isSuccess:a.isSuccess}},Yz=({isOpen:t,onClose:e,onConfirm:r,title:n,description:i,confirmText:a="Confirmar",cancelText:s="Cancelar",variant:o="warning",isLoading:c=!1,preview:l})=>{const h={danger:{iconColor:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",confirmColor:"destructive"},warning:{iconColor:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",confirmColor:"warning"},info:{iconColor:"text-blue-500",bgColor:"bg-blue-50 dark:bg-blue-900/20",confirmColor:"primary"}}[o];return d.jsx(ke,{children:t&&d.jsx(d.Fragment,{children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:m=>m.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[d.jsx("div",{className:"p-6 pb-4",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:`${h.bgColor} p-3 rounded-full flex-shrink-0`,children:d.jsx(En,{className:`w-6 h-6 ${h.iconColor}`})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:n}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:i})]}),d.jsx("button",{onClick:e,disabled:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar diálogo",children:d.jsx(Wi,{className:"w-5 h-5"})})]})}),l&&d.jsx("div",{className:"px-6 pb-4",children:d.jsx("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50",children:l})}),d.jsxs("div",{className:"px-6 pb-6 flex gap-3 justify-end",children:[d.jsx(me,{variant:"outline",onClick:e,disabled:c,className:"min-w-[80px]",children:s}),d.jsx(me,{variant:h.confirmColor,onClick:r,disabled:c,loading:c,className:"min-w-[80px]",children:a})]})]})})})})},Zz=({plant:t,variant:e="primary",size:r="sm",showLabel:n=!0,className:i=""})=>{const{updatePlantHealthMutation:a,isUpdatingPlantHealth:s}=zd(),o=Nn(p=>p.user),{addToast:c}=qs(),{plant:l}=Sg(t.id),u=async()=>{if(!o?.id){c({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnóstico"});return}if(!l){c({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log("🩺 [Button] Actualizando diagnóstico para:",t.name),a({plant:l,userId:o.id})},h=d.jsxs(d.Fragment,{children:[s?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(ji,{size:r.includes("icon")?16:14})}):d.jsx(oE,{size:r.includes("icon")?16:14}),n&&!r.includes("icon")&&d.jsx("span",{className:"ml-2 text-xs",children:s?"Analizando...":"Analizar"})]}),m=r.includes("icon");return d.jsx(me,{onClick:u,disabled:s||!l,size:r,variant:e,className:i,"aria-label":m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,title:m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,children:h})},Xz=({plant:t})=>{const e=ar(),[r,n]=w.useState(!1),[i,a]=w.useState(!1),{deletePlant:s,isDeletingPlant:o}=zd(),{completeInfo:c,isCompleting:l}=Gz(),{scrollY:u}=sN(),h=qv(u,[0,300],[0,150]),m=qv(u,[0,200],[1,.3]),p=t.images?.find(C=>C.isProfileImage)||t.images?.[0],v=!t.plantEnvironment||!t.lightRequirements,b=()=>{a(!0),n(!1)},g=()=>{s(t.id,{onSuccess:()=>{e("/")}})},_=()=>{console.log("🎯 [UI] Usuario solicitó completar información con IA"),console.log("🌱 [UI] Datos de la planta:",{id:t.id,nombre:t.name,especie:t.species,ambienteActual:t.plantEnvironment||"No especificado",luzActual:t.lightRequirements||"No especificado"}),n(!1),a(!0)},T=()=>{console.log("✅ [UI] Usuario confirmó el completado automático"),a(!1),c(t.id,t.species,t.name)},E=()=>{console.log("❌ [UI] Usuario canceló el completado automático"),a(!1)},j=C=>(C instanceof Date?C:new Date(C)).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),R=C=>{switch(C){case"interior":return d.jsx(au,{className:"w-4 h-4 mr-2"});case"exterior":return d.jsx(Kv,{className:"w-4 h-4 mr-2"});case"ambos":return d.jsxs(d.Fragment,{children:[d.jsx(au,{className:"w-3 h-3 mr-1"}),d.jsx(Kv,{className:"w-3 h-3 mr-1"})]});default:return null}},D=C=>{switch(C){case"interior":return"Interior";case"exterior":return"Exterior";case"ambos":return"Interior/Exterior";default:return null}},S=C=>{switch(C){case"poca_luz":return d.jsx(oN,{className:"w-4 h-4 mr-2"});case"luz_indirecta":return d.jsx(wa,{className:"w-4 h-4 mr-2 opacity-60"});case"luz_directa_parcial":return d.jsx(wa,{className:"w-4 h-4 mr-2 opacity-80"});case"pleno_sol":return d.jsx(wa,{className:"w-4 h-4 mr-2"});default:return null}},A=C=>{switch(C){case"poca_luz":return"Poca luz";case"luz_indirecta":return"Luz indirecta";case"luz_directa_parcial":return"Sol parcial";case"pleno_sol":return"Pleno sol";default:return null}},P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},O={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:120}}},N={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6}}};return w.useEffect(()=>{const C=()=>n(!1);if(r)return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[r]),d.jsxs(L.div,{className:"relative h-96 w-full overflow-hidden",variants:P,initial:"hidden",animate:"visible",children:[d.jsx(L.div,{className:"absolute inset-0 scale-110",style:{y:h,opacity:m},children:p?d.jsx(Ag,{src:p.url,alt:t.name,className:"h-full w-full object-cover"}):d.jsx("div",{className:"h-full w-full bg-gradient-to-br from-green-400 via-green-500 to-green-600",children:d.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})})}),d.jsxs(L.div,{className:"absolute inset-0",variants:N,children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,0.6)] to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/30"}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background/60 to-transparent"})]}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top z-20",children:d.jsxs(L.div,{className:"flex items-center justify-between",variants:O,children:[d.jsx(me,{"aria-label":"Volver atrás",variant:"ghost",size:"icon",onClick:()=>e("/"),className:"bg-black/30 text-white backdrop-blur-lg rounded-full border border-white/20 hover:bg-black/50 transition-all duration-300",children:d.jsx(vp,{size:20})}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("div",{className:"relative",children:[d.jsx(me,{"aria-label":"Más opciones",variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),n(k=>!k)},className:"bg-neutral-800/90 text-white backdrop-blur-lg rounded-full border border-neutral-600 hover:bg-neutral-700 transition-all duration-300 dark:bg-neutral-200/90 dark:text-neutral-900 dark:border-neutral-400 dark:hover:bg-neutral-300",children:d.jsx(cE,{size:20})}),d.jsx(ke,{children:r&&d.jsx(L.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 mt-2 w-48 origin-top-right rounded-xl bg-background/95 backdrop-blur-lg shadow-xl ring-1 ring-black/10 focus:outline-none z-30 border border-border/50",onClick:C=>C.stopPropagation(),children:d.jsxs("div",{className:"py-2",children:[v&&d.jsxs("button",{onClick:_,disabled:l,className:"flex w-full items-center px-4 py-3 text-sm text-contrast-high hover:bg-contrast-surface transition-colors rounded-lg mx-2",children:[l?d.jsx(xa,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(er,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:l?"Completando...":"Completar con IA"})]}),d.jsx("div",{className:"flex w-full items-center px-2 py-1",children:d.jsx(Zz,{plant:t,variant:"outline",size:"sm",showLabel:!0,className:"w-full"})}),d.jsxs("button",{onClick:b,disabled:o,className:"flex w-full items-center px-4 py-3 text-sm text-error-600 dark:text-error-500 hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors rounded-lg mx-2 font-medium",children:[o?d.jsx(xa,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(tE,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:o?"Eliminando...":"Eliminar planta"})]})]})})})]})})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom z-10",children:d.jsxs(L.div,{className:"space-y-4",variants:O,children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(L.h1,{className:"text-[24px] font-bold text-white drop-shadow-lg",variants:O,children:t.nickname||t.name}),d.jsx(L.p,{className:"text-[16px] text-white/90 font-medium",variants:O,children:t.species})]}),d.jsxs(L.div,{className:"flex flex-wrap gap-2 pt-2 max-h-32 overflow-y-auto",variants:O,children:[t.location&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(lE,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm font-medium",children:t.location})]}),t.dateAdded&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(su,{className:"w-4 h-4 mr-2"}),d.jsxs("span",{className:"text-sm font-medium",children:["Desde ",j(t.dateAdded)]})]}),t.plantEnvironment&&D(t.plantEnvironment)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[R(t.plantEnvironment),d.jsx("span",{className:"text-sm font-medium",children:D(t.plantEnvironment)})]}),t.lightRequirements&&A(t.lightRequirements)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[S(t.lightRequirements),d.jsx("span",{className:"text-sm font-medium",children:A(t.lightRequirements)})]}),t.images&&t.images.length>0&&d.jsx("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:d.jsxs("span",{className:"text-sm font-medium",children:[t.images.length," foto",t.images.length!==1?"s":""]})})]})]})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:E,children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:C=>C.stopPropagation(),className:"bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[d.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:d.jsx(er,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Completar con IA"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Información automática"})]})]}),d.jsxs("div",{className:"space-y-3 mb-6",children:[d.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"¿Quieres que la IA complete la información faltante de esta planta?"}),d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🌱"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🔬"}),d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.species})]})]}),d.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d.jsx("p",{className:"font-medium mb-1",children:"La IA agregará:"}),d.jsxs("ul",{className:"space-y-1",children:[d.jsx("li",{children:"• Ambiente recomendado (interior/exterior)"}),d.jsx("li",{children:"• Necesidades de luz específicas"})]})]})]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx(me,{variant:"outline",onClick:E,className:"flex-1",disabled:l,children:"Cancelar"}),d.jsx(me,{onClick:T,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",disabled:l,children:l?d.jsxs(d.Fragment,{children:[d.jsx(xa,{className:"w-4 h-4 mr-2 animate-spin"}),"Completando..."]}):d.jsxs(d.Fragment,{children:[d.jsx(er,{className:"w-4 h-4 mr-2"}),"Completar"]})})]})]})})}),d.jsx(Yz,{isOpen:i,onClose:()=>a(!1),onConfirm:g,title:"Eliminar Planta",description:`¿Estás seguro de que quieres eliminar "${t.nickname||t.name}"? Esta acción es irreversible y se perderán todos los datos, fotos y mensajes de chat asociados.`,confirmText:"Eliminar Definitivamente",cancelText:"Cancelar",variant:"danger",isLoading:o,preview:d.jsxs("div",{className:"flex items-center gap-3",children:[p&&d.jsx("img",{src:p.url,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[t.species," • ",t.images?.length||0," fotos"]})]})]})})]})},Qz=({plant:t})=>{const{careProfile:e,personality:r}=t;if(!e)return d.jsx("div",{className:"bg-background p-6 rounded-lg shadow-lg w-full text-center",children:d.jsx("p",{className:"text-muted-foreground",children:"No hay perfil de cuidados disponible para esta planta."})});const n=[{icon:d.jsx(xc,{size:20,strokeWidth:2,color:"#555"}),label:"RIEGO",value:`Cada ${e.wateringFrequency} días`},{icon:d.jsx(wa,{size:20,strokeWidth:2,color:"#555"}),label:"LUZ SOLAR",value:e.sunlightRequirement},{icon:d.jsx(sE,{size:20,strokeWidth:2,color:"#555"}),label:"HUMEDAD",value:e.humidityPreference},{icon:d.jsx(uE,{size:20,strokeWidth:2,color:"#555"}),label:"TEMPERATURA IDEAL",value:`${e.temperatureRange.min}°C - ${e.temperatureRange.max}°C`},{icon:d.jsx(er,{size:20,strokeWidth:2,color:"#555"}),label:"FERTILIZACIÓN",value:`Cada ${e.fertilizingFrequency} días`},{icon:d.jsx(bp,{size:20,strokeWidth:2,color:"#555"}),label:"TIPO DE SUELO",value:e.soilType}];return d.jsxs("div",{className:"w-full",style:{lineHeight:"1.4"},children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-6 mb-4",style:{gap:"24px 16px"},children:n.map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start",children:[d.jsxs("div",{className:"flex items-center mb-1",children:[i.icon,d.jsx("span",{className:"ml-2 text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:i.label})]}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i.value})]},a))}),e.specialCare&&e.specialCare.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Cuidados Especiales"}),d.jsx("ul",{className:"list-none pl-0 ml-4",style:{lineHeight:"1.5"},children:e.specialCare.map((i,a)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:i})]},a))})]}),d.jsx("hr",{className:"my-6",style:{border:"none",borderTop:"1px solid #EEE",margin:"24px 0"}}),r&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx(Go,{size:20,strokeWidth:2,color:"#555",className:"mr-2"}),d.jsx("span",{className:"text-[18px] font-semibold text-[#333]",children:"Personalidad de la Planta"})]}),r.communicationStyle&&d.jsx("div",{className:Array.isArray(r.communicationStyle)&&r.communicationStyle.length>1?"grid grid-cols-2 gap-x-4 mb-3":"flex justify-center mb-3",children:(Array.isArray(r.communicationStyle)?r.communicationStyle:[r.communicationStyle]).map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start mb-2",children:[d.jsx("span",{className:"text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:"ESTILO"}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i})]},a))}),r.catchphrases&&r.catchphrases.length>0&&d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mb-2",children:"Frases Típicas"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:r.catchphrases.map((i,a)=>d.jsx("span",{className:"inline-block bg-[#F0FDF6] text-[#046A38] text-[14px] px-2 py-1 rounded-[4px] font-medium",style:{padding:"4px 8px",marginRight:8,marginBottom:8},children:i},a))})]})]})]})},Jz=({funFacts:t})=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsxs(L.div,{className:"bg-white/0 dark:bg-transparent p-3 sm:p-4 w-full",variants:e,initial:"hidden",animate:"visible",children:[t&&t.length>0&&d.jsxs(L.div,{variants:r,children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-full mr-4",children:d.jsx(er,{className:"w-6 h-6 text-yellow-500"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Datos Curiosos"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Descubre cosas increíbles sobre esta planta"})]})]}),d.jsx("div",{className:"grid gap-4",children:t.map((n,i)=>d.jsxs(L.div,{className:"group flex items-start bg-yellow-500/5 hover:bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 transition-all duration-300 hover:shadow-md",variants:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[d.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:d.jsxs("div",{className:"relative",children:[d.jsx(dE,{className:"w-5 h-5 text-yellow-500 group-hover:text-yellow-600 transition-colors"}),d.jsx("div",{className:"absolute -inset-2 bg-yellow-500/20 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pulse"})]})}),d.jsx("p",{className:"text-foreground/90 leading-relaxed font-medium group-hover:text-foreground transition-colors",children:n})]},i))})]}),(!t||t.length===0)&&d.jsx(L.div,{className:"mt-8 flex items-center justify-center p-6 bg-muted/30 rounded-xl border border-dashed border-muted-foreground/20",variants:r,children:d.jsxs("div",{className:"text-center",children:[d.jsx(er,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),d.jsx("p",{className:"text-muted-foreground font-medium",children:"No hay datos curiosos disponibles"}),d.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"¡Pronto agregaremos información interesante!"})]})})]})},eU=()=>d.jsx(md,{className:"w-5 h-5 text-[#EF9A9A]","aria-label":"Problema de hoja seca"}),tU=({analysis:t})=>{if(!t)return null;const e=t.issues&&t.issues.length>0;return d.jsxs("div",{className:"w-full",role:"region","aria-label":"Análisis de salud de la planta",style:{lineHeight:"1.4"},children:[e?d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[16px] text-[#333] mt-3",children:"Problemas Detectados"}),d.jsxs("p",{className:"mb-2 text-[14px] text-[#D32F2F] font-medium",style:{marginTop:12,marginBottom:8},children:[t.issues.length," problema",t.issues.length!==1?"s":""," detectado",t.issues.length!==1?"s":""]}),d.jsx("ul",{className:"",children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start",style:{marginBottom:n<t.issues.length-1?16:0,paddingBottom:n<t.issues.length-1?16:0,borderBottom:n<t.issues.length-1?"1px solid #EEE":"none"},children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center mt-1",children:eU()}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"font-semibold text-[15px] text-[#333]",children:r.type}),d.jsx("p",{className:"text-[14px] text-[#555] mt-1",children:r.description})]})]},n))}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Tratamientos Sugeridos"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r.treatment})]},n))})]})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[d.jsx("span",{className:"text-4xl mb-2",role:"img","aria-label":"Planta saludable",children:"🌱"}),d.jsx(cN,{className:"w-12 h-12 text-green-500 mb-3","aria-label":"Todo en orden"}),d.jsxs("h4",{className:"font-semibold text-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:["¡Todo en orden!",d.jsx("span",{className:"text-base","aria-hidden":"true",children:"🌱"})]}),d.jsx("p",{className:"text-muted-foreground",children:"El análisis inicial no detectó problemas de salud significativos."})]}),t.recommendations&&t.recommendations.length>0&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Recomendaciones Adicionales"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.recommendations.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r})]},n))})]})]})};var Hd={},MA={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(MA);var Ig={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(Ig);var Pg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(Pg);var Wd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const l=r[a];o?l==="\\"&&a+1<i?(a++,s+=r[a]):l===o?o="":s+=l:c?l==='"'||l==="'"?o=l:l==="]"?(c=!1,n.push(s),s=""):s+=l:l==="["?(c=!0,s&&(n.push(s),s="")):l==="."?s&&(n.push(s),s=""):s+=l,a++}return s&&n.push(s),n}t.toPath=e})(Wd);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MA,r=Ig,n=Pg,i=Wd;function a(o,c,l){if(o==null)return l;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return l;const u=o[c];return u===void 0?r.isDeepKey(c)?a(o,i.toPath(c),l):l:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=o[c];return u===void 0?l:u}default:{if(Array.isArray(c))return s(o,c,l);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return l;const u=o[c];return u===void 0?l:u}}}function s(o,c,l){if(c.length===0)return l;let u=o;for(let h=0;h<c.length;h++){if(u==null||e.isUnsafeProperty(c[h]))return l;u=u[c[h]]}return u===void 0?l:u}t.get=a})(Hd);var rU=Hd.get;const Va=Hi(rU);var LA={exports:{}},Ve={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cg=Symbol.for("react.transitional.element"),kg=Symbol.for("react.portal"),qd=Symbol.for("react.fragment"),Kd=Symbol.for("react.strict_mode"),Gd=Symbol.for("react.profiler"),Yd=Symbol.for("react.consumer"),Zd=Symbol.for("react.context"),Xd=Symbol.for("react.forward_ref"),Qd=Symbol.for("react.suspense"),Jd=Symbol.for("react.suspense_list"),eh=Symbol.for("react.memo"),th=Symbol.for("react.lazy"),nU=Symbol.for("react.view_transition"),iU=Symbol.for("react.client.reference");function Ur(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Cg:switch(t=t.type,t){case qd:case Gd:case Kd:case Qd:case Jd:case nU:return t;default:switch(t=t&&t.$$typeof,t){case Zd:case Xd:case th:case eh:return t;case Yd:return t;default:return e}}case kg:return e}}}Ve.ContextConsumer=Yd;Ve.ContextProvider=Zd;Ve.Element=Cg;Ve.ForwardRef=Xd;Ve.Fragment=qd;Ve.Lazy=th;Ve.Memo=eh;Ve.Portal=kg;Ve.Profiler=Gd;Ve.StrictMode=Kd;Ve.Suspense=Qd;Ve.SuspenseList=Jd;Ve.isContextConsumer=function(t){return Ur(t)===Yd};Ve.isContextProvider=function(t){return Ur(t)===Zd};Ve.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Cg};Ve.isForwardRef=function(t){return Ur(t)===Xd};Ve.isFragment=function(t){return Ur(t)===qd};Ve.isLazy=function(t){return Ur(t)===th};Ve.isMemo=function(t){return Ur(t)===eh};Ve.isPortal=function(t){return Ur(t)===kg};Ve.isProfiler=function(t){return Ur(t)===Gd};Ve.isStrictMode=function(t){return Ur(t)===Kd};Ve.isSuspense=function(t){return Ur(t)===Qd};Ve.isSuspenseList=function(t){return Ur(t)===Jd};Ve.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===qd||t===Gd||t===Kd||t===Qd||t===Jd||typeof t=="object"&&t!==null&&(t.$$typeof===th||t.$$typeof===eh||t.$$typeof===Zd||t.$$typeof===Yd||t.$$typeof===Xd||t.$$typeof===iU||t.getModuleId!==void 0)};Ve.typeOf=Ur;LA.exports=Ve;var aU=LA.exports,Lr=t=>t===0?0:t>0?1:-1,Vr=t=>typeof t=="number"&&t!=+t,pa=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,te=t=>(typeof t=="number"||t instanceof Number)&&!Vr(t),In=t=>te(t)||typeof t=="string",sU=0,uc=t=>{var e=++sU;return"".concat(t||"").concat(e)},Fi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!te(e)&&typeof e!="string")return n;var a;if(pa(e)){if(r==null)return n;var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return Vr(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},$A=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},xo=(t,e)=>te(t)&&te(e)?r=>t+r*(e-t):()=>e;function VA(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):Va(n,e))===r)}var lt=t=>t===null||typeof t>"u",Ng=t=>lt(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),oU=["viewBox","children"],cU=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],gx=["points","pathLength"],ff={svg:oU,polygon:gx,polyline:gx},jg=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Og=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(w.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{jg.includes(i)&&(n[i]=a=>r[i](r,a))}),n},lU=(t,e,r)=>n=>(t(e,r,n),null),uU=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];jg.includes(i)&&typeof a=="function"&&(n||(n={}),n[i]=lU(a,e,r))}),n},yx=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",vx=null,mf=null,FA=t=>{if(t===vx&&Array.isArray(mf))return mf;var e=[];return w.Children.forEach(t,r=>{lt(r)||(aU.isFragment(r)?e=e.concat(FA(r.props.children)):e.push(r))}),mf=e,vx=t,e};function zA(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>yx(i)):n=[yx(e)],FA(t).forEach(i=>{var a=Va(i,"type.displayName")||Va(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var UA=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,dU=(t,e,r,n)=>{var i,a=(i=n&&ff?.[n])!==null&&i!==void 0?i:[];return e.startsWith("data-")||typeof t!="function"&&(n&&a.includes(e)||cU.includes(e))||r&&jg.includes(e)},Ke=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;dU((s=n)===null||s===void 0?void 0:s[a],a,e,r)&&(i[a]=n[a])}),i},hU=["children","width","height","viewBox","className","style","title","desc"];function Pm(){return Pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Pm.apply(null,arguments)}function fU(t,e){if(t==null)return{};var r,n,i=mU(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function mU(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var BA=w.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:c,desc:l}=t,u=fU(t,hU),h=a||{width:n,height:i,x:0,y:0},m=Le("recharts-surface",s);return w.createElement("svg",Pm({},Ke(u,!0,"svg"),{className:m,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),w.createElement("title",null,c),w.createElement("desc",null,l),r)}),pU=["children","className"];function Cm(){return Cm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Cm.apply(null,arguments)}function gU(t,e){if(t==null)return{};var r,n,i=yU(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yU(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var zi=w.forwardRef((t,e)=>{var{children:r,className:n}=t,i=gU(t,pU),a=Le("recharts-layer",n);return w.createElement("g",Cm({className:a},Ke(i,!0),{ref:e}),r)}),vU=w.createContext(null);function it(t){return function(){return t}}const km=Math.PI,Nm=2*km,ua=1e-6,bU=Nm-ua;function HA(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function xU(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return HA;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class wU{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?HA:xU(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=n-e,l=i-r,u=s-e,h=o-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>ua)if(!(Math.abs(h*c-l*u)>ua)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-s,v=i-o,b=c*c+l*l,g=p*p+v*v,_=Math.sqrt(b),T=Math.sqrt(m),E=a*Math.tan((km-Math.acos((b+m-g)/(2*_*T)))/2),j=E/T,R=E/_;Math.abs(j-1)>ua&&this._append`L${e+j*u},${r+j*h}`,this._append`A${a},${a},0,0,${+(h*p>u*v)},${this._x1=e+R*c},${this._y1=r+R*l}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),c=n*Math.sin(i),l=e+o,u=r+c,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>ua||Math.abs(this._y1-u)>ua)&&this._append`L${l},${u}`,n&&(m<0&&(m=m%Nm+Nm),m>bU?this._append`A${n},${n},0,1,${h},${e-o},${r-c}A${n},${n},0,1,${h},${this._x1=l},${this._y1=u}`:m>ua&&this._append`A${n},${n},0,${+(m>=km)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function WA(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new wU(e)}function Rg(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function qA(t){this._context=t}qA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function rh(t){return new qA(t)}function KA(t){return t[0]}function GA(t){return t[1]}function YA(t,e){var r=it(!0),n=null,i=rh,a=null,s=WA(o);t=typeof t=="function"?t:t===void 0?KA:it(t),e=typeof e=="function"?e:e===void 0?GA:it(e);function o(c){var l,u=(c=Rg(c)).length,h,m=!1,p;for(n==null&&(a=i(p=s())),l=0;l<=u;++l)!(l<u&&r(h=c[l],l,c))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(h,l,c),+e(h,l,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(t=typeof c=="function"?c:it(+c),o):t},o.y=function(c){return arguments.length?(e=typeof c=="function"?c:it(+c),o):e},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:it(!!c),o):r},o.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),o):i},o.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),o):n},o}function Nl(t,e,r){var n=null,i=it(!0),a=null,s=rh,o=null,c=WA(l);t=typeof t=="function"?t:t===void 0?KA:it(+t),e=typeof e=="function"?e:it(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?GA:it(+r);function l(h){var m,p,v,b=(h=Rg(h)).length,g,_=!1,T,E=new Array(b),j=new Array(b);for(a==null&&(o=s(T=c())),m=0;m<=b;++m){if(!(m<b&&i(g=h[m],m,h))===_)if(_=!_)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=m-1;v>=p;--v)o.point(E[v],j[v]);o.lineEnd(),o.areaEnd()}_&&(E[m]=+t(g,m,h),j[m]=+e(g,m,h),o.point(n?+n(g,m,h):E[m],r?+r(g,m,h):j[m]))}if(T)return o=null,T+""||null}function u(){return YA().defined(i).curve(s).context(a)}return l.x=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),n=null,l):t},l.x0=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),l):t},l.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:it(+h),l):n},l.y=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),r=null,l):e},l.y0=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),l):e},l.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:it(+h),l):r},l.lineX0=l.lineY0=function(){return u().x(t).y(e)},l.lineY1=function(){return u().x(t).y(r)},l.lineX1=function(){return u().x(n).y(e)},l.defined=function(h){return arguments.length?(i=typeof h=="function"?h:it(!!h),l):i},l.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),l):s},l.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),l):a},l}class ZA{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function _U(t){return new ZA(t,!0)}function EU(t){return new ZA(t,!1)}function Ru(){}function Du(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function XA(t){this._context=t}XA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Du(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Du(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function TU(t){return new XA(t)}function QA(t){this._context=t}QA.prototype={areaStart:Ru,areaEnd:Ru,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Du(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function AU(t){return new QA(t)}function JA(t){this._context=t}JA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Du(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function SU(t){return new JA(t)}function eS(t){this._context=t}eS.prototype={areaStart:Ru,areaEnd:Ru,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function IU(t){return new eS(t)}function bx(t){return t<0?-1:1}function xx(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(bx(a)+bx(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function wx(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function pf(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function Mu(t){this._context=t}Mu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:pf(this,this._t0,wx(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,pf(this,wx(this,r=xx(this,t,e)),r);break;default:pf(this,this._t0,r=xx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function tS(t){this._context=new rS(t)}(tS.prototype=Object.create(Mu.prototype)).point=function(t,e){Mu.prototype.point.call(this,e,t)};function rS(t){this._context=t}rS.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function PU(t){return new Mu(t)}function CU(t){return new tS(t)}function nS(t){this._context=t}nS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=_x(t),i=_x(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function _x(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function kU(t){return new nS(t)}function nh(t,e){this._context=t,this._t=e}nh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function NU(t){return new nh(t,.5)}function jU(t){return new nh(t,0)}function OU(t){return new nh(t,1)}function Rs(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function jm(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function RU(t,e){return t[e]}function DU(t){const e=[];return e.key=t,e}function MU(){var t=it([]),e=jm,r=Rs,n=RU;function i(a){var s=Array.from(t.apply(this,arguments),DU),o,c=s.length,l=-1,u;for(const h of a)for(o=0,++l;o<c;++o)(s[o][l]=[0,+n(h,s[o].key,l,a)]).data=h;for(o=0,u=Rg(e(s));o<c;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:it(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:it(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?jm:typeof a=="function"?a:it(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??Rs,i):r},i}function LU(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}Rs(t,e)}}function $U(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Rs(t,e)}}function VU(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,c=0,l=0;o<s;++o){for(var u=t[e[o]],h=u[n][1]||0,m=u[n-1][1]||0,p=(h-m)/2,v=0;v<o;++v){var b=t[e[v]],g=b[n][1]||0,_=b[n-1][1]||0;p+=g-_}c+=h,l+=p*h}i[n-1][1]+=i[n-1][0]=r,c&&(r-=l/c)}i[n-1][1]+=i[n-1][0]=r,Rs(t,e)}}var iS={},aS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}t.uniqBy=e})(aS);var Dg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(Dg);var sS={},ih={},oS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(oS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=oS;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(ih);var cS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(cS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=ih,r=cS;function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(sS);var lS={},uS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Hd;function r(n){return function(i){return e.get(i,n)}}t.property=r})(uS);var dS={},gf={},yf={},Mg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(Mg);var Lg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(Lg);var ah={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(ah);var Ex;function FU(){return Ex||(Ex=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$g(),r=Mg,n=Lg,i=ah;function a(h,m,p){return typeof p!="function"?e.isMatch(h,m):s(h,m,function v(b,g,_,T,E,j){const R=p(b,g,_,T,E,j);return R!==void 0?!!R:s(b,g,v,j)},new Map)}function s(h,m,p,v){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,p,v);case"function":return Object.keys(m).length>0?s(h,{...m},p,v):i.eq(h,m);default:return r.isObject(h)?typeof m=="string"?m==="":!0:i.eq(h,m)}}function o(h,m,p,v){if(m==null)return!0;if(Array.isArray(m))return l(h,m,p,v);if(m instanceof Map)return c(h,m,p,v);if(m instanceof Set)return u(h,m,p,v);const b=Object.keys(m);if(h==null)return b.length===0;if(b.length===0)return!0;if(v&&v.has(m))return v.get(m)===h;v&&v.set(m,h);try{for(let g=0;g<b.length;g++){const _=b[g];if(!n.isPrimitive(h)&&!(_ in h)||m[_]===void 0&&h[_]!==void 0||m[_]===null&&h[_]!==null||!p(h[_],m[_],_,h,m,v))return!1}return!0}finally{v&&v.delete(m)}}function c(h,m,p,v){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,g]of m.entries()){const _=h.get(b);if(p(_,g,b,h,m,v)===!1)return!1}return!0}function l(h,m,p,v){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let g=0;g<m.length;g++){const _=m[g];let T=!1;for(let E=0;E<h.length;E++){if(b.has(E))continue;const j=h[E];let R=!1;if(p(j,_,g,h,m,v)&&(R=!0),R){b.add(E),T=!0;break}}if(!T)return!1}return!0}function u(h,m,p,v){return m.size===0?!0:h instanceof Set?l([...h],[...m],p,v):!1}t.isMatchWith=a,t.isSetMatch=u}(yf)),yf}var Tx;function $g(){return Tx||(Tx=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=FU();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r}(gf)),gf}var hS={},Vg={},Fg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Fg);var sh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(sh);var oh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",l="[object Set]",u="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",v="[object Error]",b="[object DataView]",g="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",j="[object BigUint64Array]",R="[object Int8Array]",D="[object Int16Array]",S="[object Int32Array]",A="[object BigInt64Array]",P="[object Float32Array]",O="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=u,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=j,t.booleanTag=i,t.dataViewTag=b,t.dateTag=o,t.errorTag=v,t.float32ArrayTag=P,t.float64ArrayTag=O,t.functionTag=h,t.int16ArrayTag=D,t.int32ArrayTag=S,t.int8ArrayTag=R,t.mapTag=c,t.numberTag=n,t.objectTag=p,t.regexpTag=e,t.setTag=l,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=T,t.uint32ArrayTag=E,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=_})(oh);var fS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(fS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Fg,r=sh,n=oh,i=Lg,a=fS;function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,m,p=new Map,v=void 0){const b=v?.(u,h,m,p);if(b!=null)return b;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[_,T]of u)g.set(_,o(T,_,m,p,v));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const _ of u)g.add(o(_,void 0,m,p,v));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(a.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),c(g,u,m,p,v),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),c(g,u,m,p,v),g}if(u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),c(g,u,m,p,v),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,m,p,v),g}if(typeof u=="object"&&l(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),c(g,u,m,p,v),g}return u}function c(u,h,m=u,p,v){const b=[...Object.keys(h),...e.getSymbols(h)];for(let g=0;g<b.length;g++){const _=b[g],T=Object.getOwnPropertyDescriptor(u,_);(T==null||T.writable)&&(u[_]=o(h[_],_,m,p,v))}}function l(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=c})(Vg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Vg;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(hS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$g(),r=hS;function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(dS);var mS={},pS={},gS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Vg,r=oh;function n(i,a){return e.cloneDeepWith(i,(s,o,c,l)=>{const u=a?.(s,o,c,l);if(u!=null)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i?.valueOf());return e.copyProperties(h,i),h}case r.argumentsTag:{const h={};return e.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(gS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=gS;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(pS);var yS={},zg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(zg);var vS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sh;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})(vS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Ig,r=zg,n=vS,i=Wd;function a(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?c=i.toPath(o):c=[o],c.length===0)return!1;let l=s;for(let u=0;u<c.length;u++){const h=c[u];if((l==null||!Object.hasOwn(l,h))&&!((Array.isArray(l)||n.isArguments(l))&&r.isIndex(h)&&h<l.length))return!1;l=l[h]}return!0}t.has=a})(yS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$g(),r=Pg,n=pS,i=Hd,a=yS;function s(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(l){const u=i.get(l,o);return u===void 0?a.has(l,o):c===void 0?u===void 0:e.isMatch(u,c)}}t.matchesProperty=s})(mS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Dg,r=uS,n=dS,i=mS;function a(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=a})(lS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aS,r=Dg,n=sS,i=lS;function a(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),i.iteratee(o)):[]}t.uniqBy=a})(iS);var zU=iS.uniqBy;const Ax=Hi(zU);function UU(t,e,r){return e===!0?Ax(t,r):typeof e=="function"?Ax(t,e):t}var bS={exports:{}},xS={},wS={exports:{}},_S={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ds=w;function BU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var HU=typeof Object.is=="function"?Object.is:BU,WU=Ds.useState,qU=Ds.useEffect,KU=Ds.useLayoutEffect,GU=Ds.useDebugValue;function YU(t,e){var r=e(),n=WU({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return KU(function(){i.value=r,i.getSnapshot=e,vf(i)&&a({inst:i})},[t,r,e]),qU(function(){return vf(i)&&a({inst:i}),t(function(){vf(i)&&a({inst:i})})},[t]),GU(r),r}function vf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!HU(t,r)}catch{return!0}}function ZU(t,e){return e()}var XU=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ZU:YU;_S.useSyncExternalStore=Ds.useSyncExternalStore!==void 0?Ds.useSyncExternalStore:XU;wS.exports=_S;var QU=wS.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ch=w,JU=QU;function e9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var t9=typeof Object.is=="function"?Object.is:e9,r9=JU.useSyncExternalStore,n9=ch.useRef,i9=ch.useEffect,a9=ch.useMemo,s9=ch.useDebugValue;xS.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=n9(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=a9(function(){function c(p){if(!l){if(l=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,t9(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var l=!1,u,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=r9(t,a[0],a[1]);return i9(function(){s.hasValue=!0,s.value=o},[o]),s9(o),o};bS.exports=xS;var o9=bS.exports,Ug=w.createContext(null),c9=t=>t,sr=()=>{var t=w.useContext(Ug);return t?t.store.dispatch:c9},iu=()=>{},l9=()=>iu,u9=(t,e)=>t===e;function ie(t){var e=w.useContext(Ug);return o9.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:l9,e?e.store.getState:iu,e?e.store.getState:iu,e?t:iu,u9)}function d9(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function h9(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function f9(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var Sx=t=>Array.isArray(t)?t:[t];function m9(t){const e=Array.isArray(t[0])?t[0]:t;return f9(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function p9(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var g9=class{constructor(t){this.value=t}deref(){return this.value}},y9=typeof WeakRef<"u"?WeakRef:g9,v9=0,Ix=1;function jl(){return{s:v9,v:void 0,o:null,p:null}}function ES(t,e={}){let r=jl();const{resultEqualityCheck:n}=e;let i,a=0;function s(){let o=r;const{length:c}=arguments;for(let h=0,m=c;h<m;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let v=o.o;v===null&&(o.o=v=new WeakMap);const b=v.get(p);b===void 0?(o=jl(),v.set(p,o)):o=b}else{let v=o.p;v===null&&(o.p=v=new Map);const b=v.get(p);b===void 0?(o=jl(),v.set(p,o)):o=b}}const l=o;let u;if(o.s===Ix)u=o.v;else if(u=t.apply(null,arguments),a++,n){const h=i?.deref?.()??i;h!=null&&n(h,u)&&(u=h,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new y9(u):u}return l.s=Ix,l.v=u,u}return s.clearCache=()=>{r=jl(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function b9(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,s=0,o,c={},l=i.pop();typeof l=="object"&&(c=l,l=i.pop()),d9(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const u={...r,...c},{memoize:h,memoizeOptions:m=[],argsMemoize:p=ES,argsMemoizeOptions:v=[]}=u,b=Sx(m),g=Sx(v),_=m9(i),T=h(function(){return a++,l.apply(null,arguments)},...b),E=p(function(){s++;const R=p9(_,arguments);return o=T.apply(null,R),o},...g);return Object.assign(E,{resultFunc:l,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var V=b9(ES),x9=Object.assign((t,e=V)=>{h9(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>x9}),TS={},AS={},SS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=e(n),o=e(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};t.compareValues=r})(SS);var IS={},Bg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Bg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Bg,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}t.isKey=i})(IS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=SS,r=IS,n=Wd;function i(a,s,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const l=(p,v)=>{let b=p;for(let g=0;g<v.length&&b!=null;++g)b=b[v[g]];return b},u=(p,v)=>v==null||p==null?v:typeof p=="object"&&"key"in p?Object.hasOwn(v,p.key)?v[p.key]:l(v,p.path):typeof p=="function"?p(v):Array.isArray(p)?l(v,p):typeof v=="object"?v[p]:v,h=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(v=>u(v,p))})).slice().sort((p,v)=>{for(let b=0;b<h.length;b++){const g=e.compareValues(p.criteria[b],v.criteria[b],o[b]);if(g!==0)return g}return 0}).map(p=>p.original)}t.orderBy=i})(AS);var PS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),s=(o,c)=>{for(let l=0;l<o.length;l++){const u=o[l];Array.isArray(u)&&c<a?s(u,c+1):i.push(u)}};return s(r,0),i}t.flatten=e})(PS);var Hg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zg,r=ih,n=Mg,i=ah;function a(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&e.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?i.eq(c[o],s):!1}t.isIterateeCall=a})(Hg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=AS,r=PS,n=Hg;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(a,r.flatten(s),["asc"])}t.sortBy=i})(TS);var w9=TS.sortBy;const lh=Hi(w9);var CS=t=>t.legend.settings,_9=t=>t.legend.size,E9=t=>t.legend.payload;V([E9,CS],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?lh(n,r):n});var Ol=1;function T9(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-e.height)>Ol||Math.abs(s.left-e.left)>Ol||Math.abs(s.top-e.top)>Ol||Math.abs(s.width-e.width)>Ol)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function $t(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var A9=typeof Symbol=="function"&&Symbol.observable||"@@observable",Px=A9,bf=()=>Math.random().toString(36).substring(7).split("").join("."),S9={INIT:`@@redux/INIT${bf()}`,REPLACE:`@@redux/REPLACE${bf()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${bf()}`},Lu=S9;function Wg(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function kS(t,e,r){if(typeof t!="function")throw new Error($t(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($t(1));return r(kS)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function l(){s===a&&(s=new Map,a.forEach((g,_)=>{s.set(_,g)}))}function u(){if(c)throw new Error($t(3));return i}function h(g){if(typeof g!="function")throw new Error($t(4));if(c)throw new Error($t(5));let _=!0;l();const T=o++;return s.set(T,g),function(){if(_){if(c)throw new Error($t(6));_=!1,l(),s.delete(T),a=null}}}function m(g){if(!Wg(g))throw new Error($t(7));if(typeof g.type>"u")throw new Error($t(8));if(typeof g.type!="string")throw new Error($t(17));if(c)throw new Error($t(9));try{c=!0,i=n(i,g)}finally{c=!1}return(a=s).forEach(T=>{T()}),g}function p(g){if(typeof g!="function")throw new Error($t(10));n=g,m({type:Lu.REPLACE})}function v(){const g=h;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error($t(11));function T(){const j=_;j.next&&j.next(u())}return T(),{unsubscribe:g(T)}},[Px](){return this}}}return m({type:Lu.INIT}),{dispatch:m,subscribe:h,getState:u,replaceReducer:p,[Px]:v}}function I9(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Lu.INIT})>"u")throw new Error($t(12));if(typeof r(void 0,{type:Lu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function NS(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{I9(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const l={};for(let u=0;u<n.length;u++){const h=n[u],m=r[h],p=s[h],v=m(p,o);if(typeof v>"u")throw o&&o.type,new Error($t(14));l[h]=v,c=c||v!==p}return c=c||n.length!==Object.keys(s).length,c?l:s}}function $u(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function P9(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error($t(15))};const s={getState:i.getState,dispatch:(c,...l)=>a(c,...l)},o=t.map(c=>c(s));return a=$u(...o)(i.dispatch),{...i,dispatch:a}}}function jS(t){return Wg(t)&&"type"in t&&typeof t.type=="string"}function OS(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var C9=OS(),k9=OS,N9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$u:$u.apply(null,arguments)};function Fr(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Tr(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>jS(n)&&n.type===t,r}var RS=class Do extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Do.prototype)}static get[Symbol.species](){return Do}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Do(...e[0].concat(this)):new Do(...e.concat(this))}};function Cx(t){return Yn(t)?Se(t,()=>{}):t}function Rl(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function j9(t){return typeof t=="boolean"}var O9=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new RS;return r&&(j9(r)?s.push(C9):s.push(k9(r.extraArgument))),s},R9="RTK_autoBatch",kx=t=>e=>{setTimeout(e,t)},D9=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:kx(10):t.type==="callback"?t.queueNotification:kx(t.timeout),l=()=>{s=!1,a&&(a=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),m=n.subscribe(h);return o.add(u),()=>{m(),o.delete(u)}},dispatch(u){try{return i=!u?.meta?.[R9],a=!i,a&&(s||(s=!0,c(l))),n.dispatch(u)}finally{i=!0}}})},M9=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new RS(t);return n&&i.push(D9(typeof n=="object"?n:void 0)),i};function L9(t){const e=O9(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Wg(r))o=NS(r);else throw new Error(Tr(1));let c;typeof n=="function"?c=n(e):c=e();let l=$u;i&&(l=N9({trace:!1,...typeof i=="object"&&i}));const u=P9(...c),h=M9(u);let m=typeof s=="function"?s(h):h();const p=l(...m);return kS(o,a,p)}function DS(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Tr(28));if(o in e)throw new Error(Tr(29));return e[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function $9(t){return typeof t=="function"}function V9(t,e){let[r,n,i]=DS(e),a;if($9(t))a=()=>Cx(t());else{const o=Cx(t);a=()=>o}function s(o=a(),c){let l=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return l.filter(u=>!!u).length===0&&(l=[i]),l.reduce((u,h)=>{if(h)if(Pa(u)){const p=h(u,c);return p===void 0?u:p}else{if(Yn(u))return Se(u,m=>h(m,c));{const m=h(u,c);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},o)}return s.getInitialState=a,s}var F9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",z9=(t=21)=>{let e="",r=t;for(;r--;)e+=F9[Math.random()*64|0];return e},U9=Symbol.for("rtk-slice-createasyncthunk");function B9(t,e){return`${t}/${e}`}function H9({creators:t}={}){const e=t?.asyncThunk?.[U9];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Tr(11));const s=(typeof n.reducers=="function"?n.reducers(q9()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(E,j){const R=typeof E=="string"?E:E.type;if(!R)throw new Error(Tr(12));if(R in c.sliceCaseReducersByType)throw new Error(Tr(13));return c.sliceCaseReducersByType[R]=j,l},addMatcher(E,j){return c.sliceMatchers.push({matcher:E,reducer:j}),l},exposeAction(E,j){return c.actionCreators[E]=j,l},exposeCaseReducer(E,j){return c.sliceCaseReducersByName[E]=j,l}};o.forEach(E=>{const j=s[E],R={reducerName:E,type:B9(i,E),createNotation:typeof n.reducers=="function"};G9(j)?Z9(R,j,l,e):K9(R,j,l)});function u(){const[E={},j=[],R=void 0]=typeof n.extraReducers=="function"?DS(n.extraReducers):[n.extraReducers],D={...E,...c.sliceCaseReducersByType};return V9(n.initialState,S=>{for(let A in D)S.addCase(A,D[A]);for(let A of c.sliceMatchers)S.addMatcher(A.matcher,A.reducer);for(let A of j)S.addMatcher(A.matcher,A.reducer);R&&S.addDefaultCase(R)})}const h=E=>E,m=new Map,p=new WeakMap;let v;function b(E,j){return v||(v=u()),v(E,j)}function g(){return v||(v=u()),v.getInitialState()}function _(E,j=!1){function R(S){let A=S[E];return typeof A>"u"&&j&&(A=Rl(p,R,g)),A}function D(S=h){const A=Rl(m,j,()=>new WeakMap);return Rl(A,S,()=>{const P={};for(const[O,N]of Object.entries(n.selectors??{}))P[O]=W9(N,S,()=>Rl(p,S,g),j);return P})}return{reducerPath:E,getSelectors:D,get selectors(){return D(R)},selectSlice:R}}const T={name:i,reducer:b,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,..._(a),injectInto(E,{reducerPath:j,...R}={}){const D=j??a;return E.inject({reducerPath:D,reducer:b},R),{...T,..._(D,!0)}}};return T}}function W9(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var Br=H9();function q9(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function K9({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!Y9(n))throw new Error(Tr(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?Fr(t,s):Fr(t))}function G9(t){return t._reducerDefinitionType==="asyncThunk"}function Y9(t){return t._reducerDefinitionType==="reducerWithPrepare"}function Z9({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Tr(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:l,options:u}=r,h=i(t,a,u);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),c&&n.addCase(h.rejected,c),l&&n.addMatcher(h.settled,l),n.exposeCaseReducer(e,{fulfilled:s||Dl,pending:o||Dl,rejected:c||Dl,settled:l||Dl})}function Dl(){}var X9="task",MS="listener",LS="completed",qg="cancelled",Q9=`task-${qg}`,J9=`task-${LS}`,Om=`${MS}-${qg}`,eB=`${MS}-${LS}`,uh=class{constructor(t){yr(this,"name","TaskAbortError");yr(this,"message");this.code=t,this.message=`${X9} ${qg} (reason: ${t})`}},Kg=(t,e)=>{if(typeof t!="function")throw new TypeError(Tr(32))},Vu=()=>{},$S=(t,e=Vu)=>(t.catch(e),t),VS=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Ea=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Ta=t=>{if(t.aborted){const{reason:e}=t;throw new uh(e)}};function FS(t,e){let r=Vu;return new Promise((n,i)=>{const a=()=>i(new uh(t.reason));if(t.aborted){a();return}r=VS(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=Vu})}var tB=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof uh?"cancelled":"rejected",error:r}}finally{e?.()}},Fu=t=>e=>$S(FS(t,e).then(r=>(Ta(t),r))),zS=t=>{const e=Fu(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:As}=Object,Nx={},dh="listenerMiddleware",rB=(t,e)=>{const r=n=>VS(t,()=>Ea(n,t.reason));return(n,i)=>{Kg(n);const a=new AbortController;r(a);const s=tB(async()=>{Ta(t),Ta(a.signal);const o=await n({pause:Fu(a.signal),delay:zS(a.signal),signal:a.signal});return Ta(a.signal),o},()=>Ea(a,J9));return i?.autoJoin&&e.push(s.catch(Vu)),{result:Fu(t)(s),cancel(){Ea(a,Q9)}}}},nB=(t,e)=>{const r=async(n,i)=>{Ta(e);let a=()=>{};const o=[new Promise((c,l)=>{let u=t({predicate:n,effect:(h,m)=>{m.unsubscribe(),c([h,m.getState(),m.getOriginalState()])}});a=()=>{u(),l()}})];i!=null&&o.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await FS(e,Promise.race(o));return Ta(e),c}finally{a()}};return(n,i)=>$S(r(n,i))},US=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=Fr(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Tr(21));return Kg(a),{predicate:i,type:e,effect:a}},BS=As(t=>{const{type:e,predicate:r,effect:n}=US(t);return{id:z9(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Tr(22))}}},{withTypes:()=>BS}),jx=(t,e)=>{const{type:r,effect:n,predicate:i}=US(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},Rm=t=>{t.pending.forEach(e=>{Ea(e,Om)})},iB=t=>()=>{t.forEach(Rm),t.clear()},Ox=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},HS=As(Fr(`${dh}/add`),{withTypes:()=>HS}),aB=Fr(`${dh}/removeAll`),WS=As(Fr(`${dh}/remove`),{withTypes:()=>WS}),sB=(...t)=>{console.error(`${dh}/error`,...t)},Rc=(t={})=>{const e=new Map,{extra:r,onError:n=sB}=t;Kg(n);const i=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Rm(u)}),a=u=>{const h=jx(e,u)??BS(u);return i(h)};As(a,{withTypes:()=>a});const s=u=>{const h=jx(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Rm(h)),!!h};As(s,{withTypes:()=>s});const o=async(u,h,m,p)=>{const v=new AbortController,b=nB(a,v.signal),g=[];try{u.pending.add(v),await Promise.resolve(u.effect(h,As({},m,{getOriginalState:p,condition:(_,T)=>b(_,T).then(Boolean),take:b,delay:zS(v.signal),pause:Fu(v.signal),extra:r,signal:v.signal,fork:rB(v.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((_,T,E)=>{_!==v&&(Ea(_,Om),E.delete(_))})},cancel:()=>{Ea(v,Om),u.pending.delete(v)},throwIfCancelled:()=>{Ta(v.signal)}})))}catch(_){_ instanceof uh||Ox(n,_,{raisedBy:"effect"})}finally{await Promise.all(g),Ea(v,eB),u.pending.delete(v)}},c=iB(e);return{middleware:u=>h=>m=>{if(!jS(m))return h(m);if(HS.match(m))return a(m.payload);if(aB.match(m)){c();return}if(WS.match(m))return s(m.payload);let p=u.getState();const v=()=>{if(p===Nx)throw new Error(Tr(23));return p};let b;try{if(b=h(m),e.size>0){const g=u.getState(),_=Array.from(e.values());for(const T of _){let E=!1;try{E=T.predicate(m,g,p)}catch(j){E=!1,Ox(n,j,{raisedBy:"predicate"})}E&&o(T,m,u,v)}}}finally{p=Nx}return b},startListening:a,stopListening:s,clearListeners:c}};function Tr(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var oB={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},qS=Br({name:"chartLayout",initialState:oB,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:cB,setLayout:lB,setChartSize:uB,setScale:dB}=qS.actions,hB=qS.reducer;function Rx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Dx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Rx(Object(r),!0).forEach(function(n){fB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fB(t,e,r){return(e=mB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mB(t){var e=pB(t,"string");return typeof e=="symbol"?e:e+""}function pB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zu=Math.PI/180,gB=t=>t*180/Math.PI,Ut=(t,e,r,n)=>({x:t+Math.cos(-zu*n)*r,y:e+Math.sin(-zu*n)*r}),yB=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},vB=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},bB=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,s=vB({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:s,angle:gB(c),angleInRadian:c}},xB=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},wB=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return t+s*360},_B=(t,e)=>{var{x:r,y:n}=t,{radius:i,angle:a}=bB({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(i<s||i>o||i===0)return null;var{startAngle:c,endAngle:l}=xB(e),u=a,h;if(c<=l){for(;u>l;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=l}else{for(;u>c;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=c}return h?Dx(Dx({},e),{},{radius:i,angle:wB(u,e)}):null};function Mx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Mx(Object(r),!0).forEach(function(n){EB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EB(t,e,r){return(e=TB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TB(t){var e=AB(t,"string");return typeof e=="symbol"?e:e+""}function AB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ar(t,e,r){return lt(t)||lt(e)?r:In(e)?Va(t,e,r):typeof e=="function"?e(t):r}var SB=(t,e,r,n,i)=>{var a,s=-1,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var c=0;c<o;c++){var l=c>0?r[c-1].coordinate:r[o-1].coordinate,u=r[c].coordinate,h=c>=o-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(Lr(u-l)!==Lr(h-u)){var p=[];if(Lr(h-u)===Lr(i[1]-i[0])){m=h;var v=u+i[1]-i[0];p[0]=Math.min(v,(v+l)/2),p[1]=Math.max(v,(v+l)/2)}else{m=l;var b=h+i[1]-i[0];p[0]=Math.min(u,(b+u)/2),p[1]=Math.max(u,(b+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(t>g[0]&&t<=g[1]||t>=p[0]&&t<=p[1]){({index:s}=r[c]);break}}else{var _=Math.min(l,h),T=Math.max(l,h);if(t>(_+u)/2&&t<=(T+u)/2){({index:s}=r[c]);break}}}else if(e){for(var E=0;E<o;E++)if(E===0&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E>0&&E<o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E===o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2){({index:s}=e[E]);break}}return s},IB=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&te(t[a]))return Rr(Rr({},t),{},{[a]:t[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&te(t[s]))return Rr(Rr({},t),{},{[s]:t[s]+(i||0)})}return t},Gi=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",KS=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var i,a,s=t.map(o=>(o.coordinate===e&&(i=!0),o.coordinate===r&&(a=!0),o.coordinate));return i||s.push(e),a||s.push(r),s},GS=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:l,tickCount:u,ticks:h,niceTicks:m,axisType:p}=t;if(!s)return null;var v=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,b=i==="category"&&s.bandwidth?s.bandwidth()/v:0;if(b=p==="angleAxis"&&a&&a.length>=2?Lr(a[0]-a[1])*2*b:b,h||m){var g=(h||m||[]).map((_,T)=>{var E=n?n.indexOf(_):_;return{coordinate:s(E)+b,value:_,offset:b,index:T}});return g.filter(_=>!Vr(_.coordinate))}return c&&l?l.map((_,T)=>({coordinate:s(_)+b,value:_,index:T,offset:b})):s.ticks&&u!=null?s.ticks(u).map((_,T)=>({coordinate:s(_)+b,value:_,offset:b,index:T})):s.domain().map((_,T)=>({coordinate:s(_)+b,value:n?n[_]:_,index:T,offset:b}))},Lx=1e-4,PB=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-Lx,a=Math.max(n[0],n[1])+Lx,s=t(e[0]),o=t(e[r-1]);(s<i||s>a||o<i||o>a)&&t.domain([e[0],e[r-1]])}},CB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0,s=0;s<e;++s){var o=Vr(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1]):(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1])}},kB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0;a<e;++a){var s=Vr(t[a][r][1])?t[a][r][0]:t[a][r][1];s>=0?(t[a][r][0]=i,t[a][r][1]=i+s,i=t[a][r][1]):(t[a][r][0]=0,t[a][r][1]=0)}},NB={sign:CB,expand:LU,none:Rs,silhouette:$U,wiggle:VU,positive:kB},jB=(t,e,r)=>{var n=NB[r],i=MU().keys(e).value((a,s)=>+Ar(a,s,0)).order(jm).offset(n);return i(t)};function OB(t){return t==null?void 0:String(t)}function $x(t){var{axis:e,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!lt(i[e.dataKey])){var o=VA(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=Ar(i,lt(s)?e.dataKey:s);return lt(c)?null:e.scale(c)}var RB=t=>{var e=t.flat(2).filter(te);return[Math.min(...e),Math.max(...e)]},DB=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],MB=(t,e,r)=>{if(t!=null)return DB(Object.keys(t).reduce((n,i)=>{var a=t[i],{stackedData:s}=a,o=s.reduce((c,l)=>{var u=RB(l.slice(e,r+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Vx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Fx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Dm=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=lh(e,u=>u.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var c=i[s],l=i[s-1];a=Math.min((c.coordinate||0)-(l.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function zx(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Rr(Rr({},e),{},{dataKey:r,payload:n,value:i,name:a})}function YS(t,e){if(t)return String(t);if(typeof e=="string")return e}function LB(t,e,r,n,i){if(r==="horizontal"||r==="vertical"){var a=t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height;return a?{x:t,y:e}:null}return n?_B({x:t,y:e},n):null}var $B=(t,e,r,n)=>{var i=e.find(l=>l&&l.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:i.coordinate};if(t==="centric"){var a=i.coordinate,{radius:s}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:c}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},VB=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ii=t=>t.layout.width,ai=t=>t.layout.height,FB=t=>t.layout.scale,ZS=t=>t.layout.margin,Gg=V(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),Yg=V(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),zB="data-recharts-item-index",UB="data-recharts-item-data-key",hh=60;function Ux(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function pi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ux(Object(r),!0).forEach(function(n){BB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ux(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BB(t,e,r){return(e=HB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HB(t){var e=WB(t,"string");return typeof e=="symbol"?e:e+""}function WB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qB=t=>t.brush.height,Ht=V([ii,ai,ZS,qB,Gg,Yg,CS,_9],(t,e,r,n,i,a,s,o)=>{var c=a.reduce((v,b)=>{var{orientation:g}=b;if(!b.mirror&&!b.hide){var _=typeof b.width=="number"?b.width:hh;return pi(pi({},v),{},{[g]:v[g]+_})}return v},{left:r.left||0,right:r.right||0}),l=i.reduce((v,b)=>{var{orientation:g}=b;return!b.mirror&&!b.hide?pi(pi({},v),{},{[g]:Va(v,"".concat(g))+b.height}):v},{top:r.top||0,bottom:r.bottom||0}),u=pi(pi({},l),c),h=u.bottom;u.bottom+=n,u=IB(u,s,o);var m=t-u.left-u.right,p=e-u.top-u.bottom;return pi(pi({brushBottom:h},u),{},{width:Math.max(m,0),height:Math.max(p,0)})}),KB=V(Ht,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),XS=V(ii,ai,(t,e)=>({x:0,y:0,width:t,height:e})),GB=w.createContext(null),mr=()=>w.useContext(GB)!=null,fh=t=>t.brush,mh=V([fh,Ht,ZS],(t,e,r)=>({height:t.height,x:te(t.x)?t.x:e.left,y:te(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:te(t.width)?t.width:e.width})),Zg=()=>{var t,e=mr(),r=ie(KB),n=ie(mh),i=(t=ie(fh))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},YB={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},QS=()=>{var t;return(t=ie(Ht))!==null&&t!==void 0?t:YB},JS=()=>ie(ii),eI=()=>ie(ai),tt=t=>t.layout.layoutType,Xg=()=>ie(tt),ZB={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},tI=Br({name:"legend",initialState:ZB,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Bn(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:Dee,setLegendSettings:Mee,addLegendPayload:XB,removeLegendPayload:QB}=tI.actions,JB=tI.reducer;function Mm(){return Mm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mm.apply(null,arguments)}function Bx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Bx(Object(r),!0).forEach(function(n){e8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Bx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function e8(t,e,r){return(e=t8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t8(t){var e=r8(t,"string");return typeof e=="symbol"?e:e+""}function r8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n8(t){return Array.isArray(t)&&In(t[0])&&In(t[1])?t.join(" ~ "):t}var i8=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:l,label:u,labelFormatter:h,accessibilityLayer:m=!1}=t,p=()=>{if(a&&a.length){var R={padding:0,margin:0},D=(o?lh(a,o):a).map((S,A)=>{if(S.type==="none")return null;var P=S.formatter||s||n8,{value:O,name:N}=S,C=O,k=N;if(P){var Q=P(O,N,S,A,a);if(Array.isArray(Q))[C,k]=Q;else if(Q!=null)C=Q;else return null}var oe=xf({display:"block",paddingTop:4,paddingBottom:4,color:S.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:oe},In(k)?w.createElement("span",{className:"recharts-tooltip-item-name"},k):null,In(k)?w.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,w.createElement("span",{className:"recharts-tooltip-item-value"},C),w.createElement("span",{className:"recharts-tooltip-item-unit"},S.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:R},D)}return null},v=xf({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=xf({margin:0},i),g=!lt(u),_=g?u:"",T=Le("recharts-default-tooltip",c),E=Le("recharts-tooltip-label",l);g&&h&&a!==void 0&&a!==null&&(_=h(u,a));var j=m?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",Mm({className:T,style:v},j),w.createElement("p",{className:E,style:b},w.isValidElement(_)?_:"".concat(_)),p())},wo="recharts-tooltip-wrapper",a8={visibility:"hidden"};function s8(t){var{coordinate:e,translateX:r,translateY:n}=t;return Le(wo,{["".concat(wo,"-right")]:te(r)&&e&&te(e.x)&&r>=e.x,["".concat(wo,"-left")]:te(r)&&e&&te(e.x)&&r<e.x,["".concat(wo,"-bottom")]:te(n)&&e&&te(e.y)&&n>=e.y,["".concat(wo,"-top")]:te(n)&&e&&te(e.y)&&n<e.y})}function Hx(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:l}=t;if(a&&te(a[n]))return a[n];var u=r[n]-o-(i>0?i:0),h=r[n]+i;if(e[n])return s[n]?u:h;var m=c[n];if(m==null)return 0;if(s[n]){var p=u,v=m;return p<v?Math.max(h,m):Math.max(u,m)}if(l==null)return 0;var b=h+o,g=m+l;return b>g?Math.max(u,m):Math.max(h,m)}function o8(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function c8(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:c}=t,l,u,h;return s.height>0&&s.width>0&&r?(u=Hx({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),h=Hx({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),l=o8({translateX:u,translateY:h,useTranslate3d:o})):l=a8,{cssProperties:l,cssClasses:s8({translateX:u,translateY:h,coordinate:r})}}function Wx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ml(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wx(Object(r),!0).forEach(function(n){Lm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lm(t,e,r){return(e=l8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class d8 extends w.PureComponent{constructor(){super(...arguments),Lm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Lm(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:c,offset:l,position:u,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:v,lastBoundingBox:b,innerRef:g,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:E}=c8({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:l,position:u,reverseDirection:h,tooltipBox:{height:b.height,width:b.width},useTranslate3d:m,viewBox:p}),j=_?{}:Ml(Ml({transition:c&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),R=Ml(Ml({},j),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},v);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:R,ref:g},a)}}var h8=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Dc={isSsr:h8()},rI=()=>ie(t=>t.rootProps.accessibilityLayer);function tn(t){return Number.isFinite(t)}function Uu(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function $m(){return $m=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$m.apply(null,arguments)}function qx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?qx(Object(r),!0).forEach(function(n){f8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):qx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function f8(t,e,r){return(e=m8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:e+""}function p8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gx={curveBasisClosed:AU,curveBasisOpen:SU,curveBasis:TU,curveBumpX:_U,curveBumpY:EU,curveLinearClosed:IU,curveLinear:rh,curveMonotoneX:PU,curveMonotoneY:CU,curveNatural:kU,curveStep:NU,curveStepAfter:OU,curveStepBefore:jU},Ll=t=>tn(t.x)&&tn(t.y),_o=t=>t.x,Eo=t=>t.y,g8=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Ng(t));return(r==="curveMonotone"||r==="curveBump")&&e?Gx["".concat(r).concat(e==="vertical"?"Y":"X")]:Gx[r]||rh},y8=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,s=g8(e,i),o=a?r.filter(Ll):r,c;if(Array.isArray(n)){var l=a?n.filter(h=>Ll(h)):n,u=o.map((h,m)=>Kx(Kx({},h),{},{base:l[m]}));return i==="vertical"?c=Nl().y(Eo).x1(_o).x0(h=>h.base.x):c=Nl().x(_o).y1(Eo).y0(h=>h.base.y),c.defined(Ll).curve(s),c(u)}return i==="vertical"&&te(n)?c=Nl().y(Eo).x1(_o).x0(n):te(n)?c=Nl().x(_o).y1(Eo).y0(n):c=YA().x(_o).y(Eo),c.defined(Ll).curve(s),c(o)},nI=t=>{var{className:e,points:r,path:n,pathRef:i}=t;if((!r||!r.length)&&!n)return null;var a=r&&r.length?y8(t):n;return w.createElement("path",$m({},Ke(t,!1),Og(t),{className:Le("recharts-curve",e),d:a===null?void 0:a,ref:i}))},v8=["x","y","top","left","width","height","className"];function Vm(){return Vm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vm.apply(null,arguments)}function Yx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function b8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yx(Object(r),!0).forEach(function(n){x8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Yx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function x8(t,e,r){return(e=w8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w8(t){var e=_8(t,"string");return typeof e=="symbol"?e:e+""}function _8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function E8(t,e){if(t==null)return{};var r,n,i=T8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function T8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var A8=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),S8=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=t,c=E8(t,v8),l=b8({x:e,y:r,top:n,left:i,width:a,height:s},c);return!te(e)||!te(r)||!te(a)||!te(s)||!te(n)||!te(i)?null:w.createElement("path",Vm({},Ke(l,!0),{className:Le("recharts-cross",o),d:A8(e,r,a,s,n,i)}))};function I8(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function Zx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function P8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zx(Object(r),!0).forEach(function(n){C8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function C8(t,e,r){return(e=k8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k8(t){var e=N8(t,"string");return typeof e=="symbol"?e:e+""}function N8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ya(t,e){var r=P8({},t),n=e,i=Object.keys(e),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var iI={},aI={},sI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}t.isPlainObject=e})(sI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=sI,r=Fg,n=sh,i=oh,a=ah;function s(l,u,h){return o(l,u,void 0,void 0,void 0,void 0,h)}function o(l,u,h,m,p,v,b){const g=b(l,u,h,m,p,v);if(g!==void 0)return g;if(typeof l==typeof u)switch(typeof l){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return l===u;case"number":return l===u||Object.is(l,u);case"function":return l===u;case"object":return c(l,u,v,b)}return c(l,u,v,b)}function c(l,u,h,m){if(Object.is(l,u))return!0;let p=n.getTag(l),v=n.getTag(u);if(p===i.argumentsTag&&(p=i.objectTag),v===i.argumentsTag&&(v=i.objectTag),p!==v)return!1;switch(p){case i.stringTag:return l.toString()===u.toString();case i.numberTag:{const _=l.valueOf(),T=u.valueOf();return a.eq(_,T)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(l.valueOf(),u.valueOf());case i.regexpTag:return l.source===u.source&&l.flags===u.flags;case i.functionTag:return l===u}h=h??new Map;const b=h.get(l),g=h.get(u);if(b!=null&&g!=null)return b===u;h.set(l,u),h.set(u,l);try{switch(p){case i.mapTag:{if(l.size!==u.size)return!1;for(const[_,T]of l.entries())if(!u.has(_)||!o(T,u.get(_),_,l,u,h,m))return!1;return!0}case i.setTag:{if(l.size!==u.size)return!1;const _=Array.from(l.values()),T=Array.from(u.values());for(let E=0;E<_.length;E++){const j=_[E],R=T.findIndex(D=>o(j,D,void 0,l,u,h,m));if(R===-1)return!1;T.splice(R,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(l)!==Buffer.isBuffer(u)||l.length!==u.length)return!1;for(let _=0;_<l.length;_++)if(!o(l[_],u[_],_,l,u,h,m))return!1;return!0}case i.arrayBufferTag:return l.byteLength!==u.byteLength?!1:c(new Uint8Array(l),new Uint8Array(u),h,m);case i.dataViewTag:return l.byteLength!==u.byteLength||l.byteOffset!==u.byteOffset?!1:c(new Uint8Array(l),new Uint8Array(u),h,m);case i.errorTag:return l.name===u.name&&l.message===u.message;case i.objectTag:{if(!(c(l.constructor,u.constructor,h,m)||e.isPlainObject(l)&&e.isPlainObject(u)))return!1;const T=[...Object.keys(l),...r.getSymbols(l)],E=[...Object.keys(u),...r.getSymbols(u)];if(T.length!==E.length)return!1;for(let j=0;j<T.length;j++){const R=T[j],D=l[R];if(!Object.hasOwn(u,R))return!1;const S=u[R];if(!o(D,S,R,l,u,h,m))return!1}return!0}default:return!1}}finally{h.delete(l),h.delete(u)}}t.isEqualWith=s})(aI);var oI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(oI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=aI,r=oI;function n(i,a){return e.isEqualWith(i,a,r.noop)}t.isEqual=n})(iI);var j8=iI.isEqual;const O8=Hi(j8);function R8(t){var e={},r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...l]=o;if(typeof c=="number"){i=t.setTimeout(a.bind(null,l),c);return}a(c),i=t.setTimeout(a.bind(null,l));return}typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}var Bu=1e-4,cI=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],lI=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),Xx=(t,e)=>r=>{var n=cI(t,e);return lI(n,r)},D8=(t,e)=>r=>{var n=cI(t,e),i=[...n.map((a,s)=>a*s).slice(1),0];return lI(i,r)},Qx=function(){for(var e,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,i]=[0,0,1,1];break;case"ease":[e,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,i]=[.42,0,1,1];break;case"ease-out":[e,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,i]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([e,n,r,i]=c[1].split(")")[0].split(",").map(v=>parseFloat(v)))}}else s.length===4&&([e,n,r,i]=s);var l=Xx(e,r),u=Xx(n,i),h=D8(e,r),m=v=>v>1?1:v<0?0:v,p=v=>{for(var b=v>1?1:v,g=b,_=0;_<8;++_){var T=l(g)-b,E=h(g);if(Math.abs(T-b)<Bu||E<Bu)return u(g);g=m(g-T/E)}return u(g)};return p.isStepper=!1,p},M8=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(s,o,c)=>{var l=-(s-o)*r,u=c*n,h=c+(l-u)*i/1e3,m=c*i/1e3+s;return Math.abs(m-o)<Bu&&Math.abs(h)<Bu?[o,0]:[m,h]};return a.isStepper=!0,a.dt=i,a},L8=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Qx(t);case"spring":return M8();default:if(t.split("(")[0]==="cubic-bezier")return Qx(t)}return typeof t=="function"?t:null};function Jx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ew(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Jx(Object(r),!0).forEach(function(n){$8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Jx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $8(t,e,r){return(e=V8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V8(t){var e=F8(t,"string");return typeof e=="symbol"?e:e+""}function F8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z8=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),U8=(t,e,r)=>t.map(n=>"".concat(z8(n)," ").concat(e,"ms ").concat(r)).join(","),B8=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),dc=(t,e)=>Object.keys(e).reduce((r,n)=>ew(ew({},r),{},{[n]:t(n,e[n])}),{});function tw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tw(Object(r),!0).forEach(function(n){H8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function H8(t,e,r){return(e=W8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W8(t){var e=q8(t,"string");return typeof e=="symbol"?e:e+""}function q8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hu=(t,e,r)=>t+(e-t)*r,Fm=t=>{var{from:e,to:r}=t;return e!==r},uI=(t,e,r)=>{var n=dc((i,a)=>{if(Fm(a)){var[s,o]=t(a.from,a.to,a.velocity);return Ft(Ft({},a),{},{from:s,velocity:o})}return a},e);return r<1?dc((i,a)=>Fm(a)?Ft(Ft({},a),{},{velocity:Hu(a.velocity,n[i].velocity,r),from:Hu(a.from,n[i].from,r)}):a,e):uI(t,n,r-1)};function K8(t,e,r,n,i,a){var s,o=n.reduce((m,p)=>Ft(Ft({},m),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),c=()=>dc((m,p)=>p.from,o),l=()=>!Object.values(o).filter(Fm).length,u=null,h=m=>{s||(s=m);var p=m-s,v=p/r.dt;o=uI(r,o,v),i(Ft(Ft(Ft({},t),e),c())),s=m,l()||(u=a.setTimeout(h))};return()=>(u=a.setTimeout(h),()=>{u()})}function G8(t,e,r,n,i,a,s){var o=null,c=i.reduce((h,m)=>Ft(Ft({},h),{},{[m]:[t[m],e[m]]}),{}),l,u=h=>{l||(l=h);var m=(h-l)/n,p=dc((b,g)=>Hu(...g,r(m)),c);if(a(Ft(Ft(Ft({},t),e),p)),m<1)o=s.setTimeout(u);else{var v=dc((b,g)=>Hu(...g,r(1)),c);a(Ft(Ft(Ft({},t),e),v))}};return()=>(o=s.setTimeout(u),()=>{o()})}const Y8=(t,e,r,n,i,a)=>{var s=B8(t,e);return r.isStepper===!0?K8(t,e,r,s,i,a):G8(t,e,r,n,s,i,a)};class Z8{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}var X8=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function zm(){return zm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zm.apply(null,arguments)}function Q8(t,e){if(t==null)return{};var r,n,i=J8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function J8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function rw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rw(Object(r),!0).forEach(function(n){ga(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ga(t,e,r){return(e=eH(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eH(t){var e=tH(t,"string");return typeof e=="symbol"?e:e+""}function tH(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rH(){return R8(new Z8)}class Qg extends w.PureComponent{constructor(e,r){super(e,r),ga(this,"mounted",!1),ga(this,"manager",null),ga(this,"stopJSAnimation",null),ga(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:c,animationManager:l}=this.props;if(this.manager=l,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||c<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:r}=this.props;this.mounted=!0,!(!e||!r)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:c}=this.state;if(n){if(!r){var l={style:i?{[i]:s}:s};this.state&&c&&(i&&c[i]!==s||!i&&c!==s)&&this.setState(l);return}if(!(O8(e.to,s)&&e.canBegin&&e.isActive)){var u=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=u||a?o:e.to;if(this.state&&c){var m={style:i?{[i]:h}:h};(i&&c[i]!==h||!i&&c!==h)&&this.setState(m)}this.runAnimation(gi(gi({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:c}=e,l=Y8(r,n,L8(a),i,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=l()};this.manager.start([c,s,u,i,o])}runAnimation(e){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:c,children:l}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof l=="function"||s==="spring"){this.runJSAnimation(e);return}var u=i?{[i]:a}:a,h=U8(Object.keys(u),n,s);this.manager.start([o,r,gi(gi({},u),{},{transition:h}),n,c])}render(){var e=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:c,to:l,canBegin:u,onAnimationEnd:h,shouldReAnimate:m,onAnimationReStart:p,animationManager:v}=e,b=Q8(e,X8),g=w.Children.count(r),_=this.state.style;if(typeof r=="function")return r(_);if(!o||g===0||i<=0)return r;var T=E=>{var{style:j={},className:R}=E.props,D=w.cloneElement(E,gi(gi({},b),{},{style:gi(gi({},j),_),className:R}));return D};return g===1?T(w.Children.only(r)):w.createElement("div",null,w.Children.map(r,E=>T(E)))}}ga(Qg,"displayName","Animate");ga(Qg,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var nH=w.createContext(null);function Wu(t){var e,r,n=w.useContext(nH);return w.createElement(Qg,zm({},t,{animationManager:(e=(r=t.animationManager)!==null&&r!==void 0?r:n)!==null&&e!==void 0?e:rH()}))}function qu(){return qu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qu.apply(null,arguments)}var nw=(t,e,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,l;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>a?a:i[h];l="M".concat(t,",").concat(e+s*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(t+o*u[0],",").concat(e)),l+="L ".concat(t+r-o*u[1],",").concat(e),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(t+r,",").concat(e+s*u[1])),l+="L ".concat(t+r,",").concat(e+n-s*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(t+r-o*u[2],",").concat(e+n)),l+="L ".concat(t+o*u[3],",").concat(e+n),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(e+n-s*u[3])),l+="Z"}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);l="M ".concat(t,",").concat(e+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+o*p,",").concat(e,`
            L `).concat(t+r-o*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r,",").concat(e+s*p,`
            L `).concat(t+r,",").concat(e+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r-o*p,",").concat(e+n,`
            L `).concat(t+o*p,",").concat(e+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t,",").concat(e+n-s*p," Z")}else l="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return l},iH={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},aH=t=>{var e=Ya(t,iH),r=w.useRef(null),[n,i]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&i(_)}catch{}},[]);var{x:a,y:s,width:o,height:c,radius:l,className:u}=e,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:v,isUpdateAnimationActive:b}=e;if(a!==+a||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var g=Le("recharts-rectangle",u);return b?w.createElement(Wu,{canBegin:n>0,from:{width:o,height:c,x:a,y:s},to:{width:o,height:c,x:a,y:s},duration:m,animationEasing:h,isActive:b},_=>{var{width:T,height:E,x:j,y:R}=_;return w.createElement(Wu,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:m,isActive:v,easing:h},w.createElement("path",qu({},Ke(e,!0),{className:g,d:nw(j,R,T,E,l),ref:r})))}):w.createElement("path",qu({},Ke(e,!0),{className:g,d:nw(a,s,o,c,l)}))};function dI(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,s=Ut(e,r,n,i),o=Ut(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function Um(){return Um=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Um.apply(null,arguments)}var sH=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},$l=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:c}=t,l=o*(s?1:-1)+n,u=Math.asin(o/l)/zu,h=c?i:i+a*u,m=Ut(e,r,l,h),p=Ut(e,r,n,h),v=c?i-a*u:i,b=Ut(e,r,l*Math.cos(u*zu),v);return{center:m,circleTangency:p,lineTangency:b,theta:u}},hI=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=t,o=sH(a,s),c=a+o,l=Ut(e,r,i,a),u=Ut(e,r,i,c),h="M ".concat(l.x,",").concat(l.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var m=Ut(e,r,n,a),p=Ut(e,r,n,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},oH=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:l}=t,u=Lr(l-c),{circleTangency:h,lineTangency:m,theta:p}=$l({cx:e,cy:r,radius:i,angle:c,sign:u,cornerRadius:a,cornerIsExternal:o}),{circleTangency:v,lineTangency:b,theta:g}=$l({cx:e,cy:r,radius:i,angle:l,sign:-u,cornerRadius:a,cornerIsExternal:o}),_=o?Math.abs(c-l):Math.abs(c-l)-p-g;if(_<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):hI({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:l});var T="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:j,theta:R}=$l({cx:e,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:D,lineTangency:S,theta:A}=$l({cx:e,cy:r,radius:n,angle:l,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(c-l):Math.abs(c-l)-R-A;if(P<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+="L".concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(j.x,",").concat(j.y,"Z")}else T+="L".concat(e,",").concat(r,"Z");return T},cH={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},lH=t=>{var e=Ya(t,cH),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:u,className:h}=e;if(a<i||l===u)return null;var m=Le("recharts-sector",h),p=a-i,v=Fi(s,p,0,!0),b;return v>0&&Math.abs(l-u)<360?b=oH({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:u}):b=hI({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:l,endAngle:u}),w.createElement("path",Um({},Ke(e,!0),{className:m,d:b}))};function uH(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:c,innerRadius:l,outerRadius:u,angle:h}=e,m=Ut(o,c,l,h),p=Ut(o,c,u,h);n=m.x,i=m.y,a=p.x,s=p.y}else return dI(e);return[{x:n,y:i},{x:a,y:s}]}var fI={},mI={},pI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Bg;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(pI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=pI;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(mI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Hg,r=mI;function n(i,a,s){s&&typeof s!="number"&&e.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),c=new Array(o);for(let l=0;l<o;l++)c[l]=i,i+=s;return c}t.range=n})(fI);var dH=fI.range;const gI=Hi(dH);function Ni(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hH(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Jg(t){let e,r,n;t.length!==2?(e=Ni,r=(o,c)=>Ni(t(o),c),n=(o,c)=>t(o)-c):(e=t===Ni||t===hH?t:fH,r=t,n=t);function i(o,c,l=0,u=o.length){if(l<u){if(e(c,c)!==0)return u;do{const h=l+u>>>1;r(o[h],c)<0?l=h+1:u=h}while(l<u)}return l}function a(o,c,l=0,u=o.length){if(l<u){if(e(c,c)!==0)return u;do{const h=l+u>>>1;r(o[h],c)<=0?l=h+1:u=h}while(l<u)}return l}function s(o,c,l=0,u=o.length){const h=i(o,c,l,u-1);return h>l&&n(o[h-1],c)>-n(o[h],c)?h-1:h}return{left:i,center:s,right:a}}function fH(){return 0}function yI(t){return t===null?NaN:+t}function*mH(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const pH=Jg(Ni),Mc=pH.right;Jg(yI).center;class iw extends Map{constructor(e,r=vH){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(aw(this,e))}has(e){return super.has(aw(this,e))}set(e,r){return super.set(gH(this,e),r)}delete(e){return super.delete(yH(this,e))}}function aw({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function gH({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function yH({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function vH(t){return t!==null&&typeof t=="object"?t.valueOf():t}function bH(t=Ni){if(t===Ni)return vI;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function vI(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const xH=Math.sqrt(50),wH=Math.sqrt(10),_H=Math.sqrt(2);function Ku(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=xH?10:a>=wH?5:a>=_H?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),c=Math.round(e*l),o/l<t&&++o,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),c=Math.round(e/l),o*l<t&&++o,c*l>e&&--c),c<o&&.5<=r&&r<2?Ku(t,e,r*2):[o,c,l]}function Bm(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?Ku(e,t,r):Ku(t,e,r);if(!(a>=i))return[];const o=a-i+1,c=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)c[l]=(a-l)/-s;else for(let l=0;l<o;++l)c[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(i+l)/-s;else for(let l=0;l<o;++l)c[l]=(i+l)*s;return c}function Hm(t,e,r){return e=+e,t=+t,r=+r,Ku(t,e,r)[2]}function Wm(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?Hm(e,t,r):Hm(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function sw(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function ow(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function bI(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?vI:bH(i);n>r;){if(n-r>600){const c=n-r+1,l=e-r+1,u=Math.log(c),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(c-h)/c)*(l-c/2<0?-1:1),p=Math.max(r,Math.floor(e-l*h/c+m)),v=Math.min(n,Math.floor(e+(c-l)*h/c+m));bI(t,e,p,v,i)}const a=t[e];let s=r,o=n;for(To(t,r,e),i(t[n],a)>0&&To(t,r,n);s<o;){for(To(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?To(t,r,o):(++o,To(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function To(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function EH(t,e,r){if(t=Float64Array.from(mH(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return ow(t);if(e>=1)return sw(t);var n,i=(n-1)*e,a=Math.floor(i),s=sw(bI(t,a).subarray(0,a+1)),o=ow(t.subarray(a+1));return s+(o-s)*(i-a)}}function TH(t,e,r=yI){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function AH(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function Hr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function si(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const qm=Symbol("implicit");function ey(){var t=new iw,e=[],r=[],n=qm;function i(a){let s=t.get(a);if(s===void 0){if(n!==qm)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new iw;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return ey(e,r).unknown(n)},Hr.apply(i,arguments),i}function ty(){var t=ey().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,c=0,l=0,u=.5;delete t.unknown;function h(){var m=e().length,p=i<n,v=p?i:n,b=p?n:i;a=(b-v)/Math.max(1,m-c+l*2),o&&(a=Math.floor(a)),v+=(b-v-a*(m-c))*u,s=a*(1-c),o&&(v=Math.round(v),s=Math.round(s));var g=AH(m).map(function(_){return v+a*_});return r(p?g.reverse():g)}return t.domain=function(m){return arguments.length?(e(m),h()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(m){return arguments.length?(o=!!m,h()):o},t.padding=function(m){return arguments.length?(c=Math.min(1,l=+m),h()):c},t.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),h()):c},t.paddingOuter=function(m){return arguments.length?(l=+m,h()):l},t.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},t.copy=function(){return ty(e(),[n,i]).round(o).paddingInner(c).paddingOuter(l).align(u)},Hr.apply(h(),arguments)}function xI(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return xI(e())},t}function SH(){return xI(ty.apply(null,arguments).paddingInner(1))}function ry(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function wI(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Lc(){}var hc=.7,Gu=1/hc,Ss="\\s*([+-]?\\d+)\\s*",fc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_n="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IH=/^#([0-9a-f]{3,8})$/,PH=new RegExp(`^rgb\\(${Ss},${Ss},${Ss}\\)$`),CH=new RegExp(`^rgb\\(${_n},${_n},${_n}\\)$`),kH=new RegExp(`^rgba\\(${Ss},${Ss},${Ss},${fc}\\)$`),NH=new RegExp(`^rgba\\(${_n},${_n},${_n},${fc}\\)$`),jH=new RegExp(`^hsl\\(${fc},${_n},${_n}\\)$`),OH=new RegExp(`^hsla\\(${fc},${_n},${_n},${fc}\\)$`),cw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ry(Lc,mc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:lw,formatHex:lw,formatHex8:RH,formatHsl:DH,formatRgb:uw,toString:uw});function lw(){return this.rgb().formatHex()}function RH(){return this.rgb().formatHex8()}function DH(){return _I(this).formatHsl()}function uw(){return this.rgb().formatRgb()}function mc(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=IH.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?dw(e):r===3?new ur(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Vl(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Vl(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=PH.exec(t))?new ur(e[1],e[2],e[3],1):(e=CH.exec(t))?new ur(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=kH.exec(t))?Vl(e[1],e[2],e[3],e[4]):(e=NH.exec(t))?Vl(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=jH.exec(t))?mw(e[1],e[2]/100,e[3]/100,1):(e=OH.exec(t))?mw(e[1],e[2]/100,e[3]/100,e[4]):cw.hasOwnProperty(t)?dw(cw[t]):t==="transparent"?new ur(NaN,NaN,NaN,0):null}function dw(t){return new ur(t>>16&255,t>>8&255,t&255,1)}function Vl(t,e,r,n){return n<=0&&(t=e=r=NaN),new ur(t,e,r,n)}function MH(t){return t instanceof Lc||(t=mc(t)),t?(t=t.rgb(),new ur(t.r,t.g,t.b,t.opacity)):new ur}function Km(t,e,r,n){return arguments.length===1?MH(t):new ur(t,e,r,n??1)}function ur(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}ry(ur,Km,wI(Lc,{brighter(t){return t=t==null?Gu:Math.pow(Gu,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?hc:Math.pow(hc,t),new ur(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ur(Aa(this.r),Aa(this.g),Aa(this.b),Yu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hw,formatHex:hw,formatHex8:LH,formatRgb:fw,toString:fw}));function hw(){return`#${ya(this.r)}${ya(this.g)}${ya(this.b)}`}function LH(){return`#${ya(this.r)}${ya(this.g)}${ya(this.b)}${ya((isNaN(this.opacity)?1:this.opacity)*255)}`}function fw(){const t=Yu(this.opacity);return`${t===1?"rgb(":"rgba("}${Aa(this.r)}, ${Aa(this.g)}, ${Aa(this.b)}${t===1?")":`, ${t})`}`}function Yu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Aa(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ya(t){return t=Aa(t),(t<16?"0":"")+t.toString(16)}function mw(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,r,n)}function _I(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof Lc||(t=mc(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Yr(s,o,c,t.opacity)}function $H(t,e,r,n){return arguments.length===1?_I(t):new Yr(t,e,r,n??1)}function Yr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}ry(Yr,$H,wI(Lc,{brighter(t){return t=t==null?Gu:Math.pow(Gu,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?hc:Math.pow(hc,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new ur(wf(t>=240?t-240:t+120,i,n),wf(t,i,n),wf(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Yr(pw(this.h),Fl(this.s),Fl(this.l),Yu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Yu(this.opacity);return`${t===1?"hsl(":"hsla("}${pw(this.h)}, ${Fl(this.s)*100}%, ${Fl(this.l)*100}%${t===1?")":`, ${t})`}`}}));function pw(t){return t=(t||0)%360,t<0?t+360:t}function Fl(t){return Math.max(0,Math.min(1,t||0))}function wf(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const ny=t=>()=>t;function VH(t,e){return function(r){return t+r*e}}function FH(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function zH(t){return(t=+t)==1?EI:function(e,r){return r-e?FH(e,r,t):ny(isNaN(e)?r:e)}}function EI(t,e){var r=e-t;return r?VH(t,r):ny(isNaN(t)?e:t)}const gw=function t(e){var r=zH(e);function n(i,a){var s=r((i=Km(i)).r,(a=Km(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),l=EI(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=c(u),i.opacity=l(u),i+""}}return n.gamma=t,n}(1);function UH(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function BH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function HH(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Gs(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function WH(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Zu(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function qH(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Gs(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var Gm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_f=new RegExp(Gm.source,"g");function KH(t){return function(){return t}}function GH(t){return function(e){return t(e)+""}}function YH(t,e){var r=Gm.lastIndex=_f.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=Gm.exec(t))&&(i=_f.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Zu(n,i)})),r=_f.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?GH(c[0].x):KH(e):(e=c.length,function(l){for(var u=0,h;u<e;++u)o[(h=c[u]).i]=h.x(l);return o.join("")})}function Gs(t,e){var r=typeof e,n;return e==null||r==="boolean"?ny(e):(r==="number"?Zu:r==="string"?(n=mc(e))?(e=n,gw):YH:e instanceof mc?gw:e instanceof Date?WH:BH(e)?UH:Array.isArray(e)?HH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?qH:Zu)(t,e)}function iy(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function ZH(t,e){e===void 0&&(e=t,t=Gs);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function XH(t){return function(){return t}}function Xu(t){return+t}var yw=[0,1];function ir(t){return t}function Ym(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:XH(isNaN(e)?NaN:.5)}function QH(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function JH(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=Ym(i,n),a=r(s,a)):(n=Ym(n,i),a=r(a,s)),function(o){return a(n(o))}}function eW(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=Ym(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var c=Mc(t,o,1,n)-1;return a[c](i[c](o))}}function $c(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ph(){var t=yw,e=yw,r=Gs,n,i,a,s=ir,o,c,l;function u(){var m=Math.min(t.length,e.length);return s!==ir&&(s=QH(t[0],t[m-1])),o=m>2?eW:JH,c=l=null,h}function h(m){return m==null||isNaN(m=+m)?a:(c||(c=o(t.map(n),e,r)))(n(s(m)))}return h.invert=function(m){return s(i((l||(l=o(e,t.map(n),Zu)))(m)))},h.domain=function(m){return arguments.length?(t=Array.from(m,Xu),u()):t.slice()},h.range=function(m){return arguments.length?(e=Array.from(m),u()):e.slice()},h.rangeRound=function(m){return e=Array.from(m),r=iy,u()},h.clamp=function(m){return arguments.length?(s=m?!0:ir,u()):s!==ir},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,p){return n=m,i=p,u()}}function ay(){return ph()(ir,ir)}function tW(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Qu(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Ms(t){return t=Qu(Math.abs(t)),t?t[1]:NaN}function rW(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],c=0;i>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(i-=o,i+o)),!((c+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function nW(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var iW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pc(t){if(!(e=iW.exec(t)))throw new Error("invalid format: "+t);var e;return new sy({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}pc.prototype=sy.prototype;function sy(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}sy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function aW(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var TI;function sW(t,e){var r=Qu(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(TI=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Qu(t,Math.max(0,e+a-1))[0]}function vw(t,e){var r=Qu(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const bw={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:tW,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>vw(t*100,e),r:vw,s:sW,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function xw(t){return t}var ww=Array.prototype.map,_w=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function oW(t){var e=t.grouping===void 0||t.thousands===void 0?xw:rW(ww.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?xw:nW(ww.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(h){h=pc(h);var m=h.fill,p=h.align,v=h.sign,b=h.symbol,g=h.zero,_=h.width,T=h.comma,E=h.precision,j=h.trim,R=h.type;R==="n"?(T=!0,R="g"):bw[R]||(E===void 0&&(E=12),j=!0,R="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var D=b==="$"?r:b==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",S=b==="$"?n:/[%p]/.test(R)?s:"",A=bw[R],P=/[defgprs%]/.test(R);E=E===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function O(N){var C=D,k=S,Q,oe,X;if(R==="c")k=A(N)+k,N="";else{N=+N;var ee=N<0||1/N<0;if(N=isNaN(N)?c:A(Math.abs(N),E),j&&(N=aW(N)),ee&&+N==0&&v!=="+"&&(ee=!1),C=(ee?v==="("?v:o:v==="-"||v==="("?"":v)+C,k=(R==="s"?_w[8+TI/3]:"")+k+(ee&&v==="("?")":""),P){for(Q=-1,oe=N.length;++Q<oe;)if(X=N.charCodeAt(Q),48>X||X>57){k=(X===46?i+N.slice(Q+1):N.slice(Q))+k,N=N.slice(0,Q);break}}}T&&!g&&(N=e(N,1/0));var he=C.length+N.length+k.length,ye=he<_?new Array(_-he+1).join(m):"";switch(T&&g&&(N=e(ye+N,ye.length?_-k.length:1/0),ye=""),p){case"<":N=C+N+k+ye;break;case"=":N=C+ye+N+k;break;case"^":N=ye.slice(0,he=ye.length>>1)+C+N+k+ye.slice(he);break;default:N=ye+C+N+k;break}return a(N)}return O.toString=function(){return h+""},O}function u(h,m){var p=l((h=pc(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(Ms(m)/3)))*3,b=Math.pow(10,-v),g=_w[8+v/3];return function(_){return p(b*_)+g}}return{format:l,formatPrefix:u}}var zl,oy,AI;cW({thousands:",",grouping:[3],currency:["$",""]});function cW(t){return zl=oW(t),oy=zl.format,AI=zl.formatPrefix,zl}function lW(t){return Math.max(0,-Ms(Math.abs(t)))}function uW(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ms(e)/3)))*3-Ms(Math.abs(t)))}function dW(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ms(e)-Ms(t))+1}function SI(t,e,r,n){var i=Wm(t,e,r),a;switch(n=pc(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=uW(i,s))&&(n.precision=a),AI(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=dW(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=lW(i))&&(n.precision=a-(n.type==="%")*2);break}}return oy(n)}function Yi(t){var e=t.domain;return t.ticks=function(r){var n=e();return Bm(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return SI(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],c,l,u=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);u-- >0;){if(l=Hm(s,o,r),l===c)return n[i]=s,n[a]=o,e(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return t},t}function II(){var t=ay();return t.copy=function(){return $c(t,II())},Hr.apply(t,arguments),Yi(t)}function PI(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Xu),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return PI(t).unknown(e)},t=arguments.length?Array.from(t,Xu):[0,1],Yi(r)}function CI(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function Ew(t){return Math.log(t)}function Tw(t){return Math.exp(t)}function hW(t){return-Math.log(-t)}function fW(t){return-Math.exp(-t)}function mW(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pW(t){return t===10?mW:t===Math.E?Math.exp:e=>Math.pow(t,e)}function gW(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Aw(t){return(e,r)=>-t(-e,r)}function cy(t){const e=t(Ew,Tw),r=e.domain;let n=10,i,a;function s(){return i=gW(n),a=pW(n),r()[0]<0?(i=Aw(i),a=Aw(a),t(hW,fW)):t(Ew,Tw),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const c=r();let l=c[0],u=c[c.length-1];const h=u<l;h&&([l,u]=[u,l]);let m=i(l),p=i(u),v,b;const g=o==null?10:+o;let _=[];if(!(n%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),l>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/a(-m):v*a(m),!(b<l)){if(b>u)break;_.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/a(-m):v*a(m),!(b<l)){if(b>u)break;_.push(b)}_.length*2<g&&(_=Bm(l,u,g))}else _=Bm(m,p,Math.min(p-m,g)).map(a);return h?_.reverse():_},e.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=pc(c)).precision==null&&(c.trim=!0),c=oy(c)),o===1/0)return c;const l=Math.max(1,n*o/e.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=l?c(u):""}},e.nice=()=>r(CI(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function kI(){const t=cy(ph()).domain([1,10]);return t.copy=()=>$c(t,kI()).base(t.base()),Hr.apply(t,arguments),t}function Sw(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Iw(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function ly(t){var e=1,r=t(Sw(e),Iw(e));return r.constant=function(n){return arguments.length?t(Sw(e=+n),Iw(e)):e},Yi(r)}function NI(){var t=ly(ph());return t.copy=function(){return $c(t,NI()).constant(t.constant())},Hr.apply(t,arguments)}function Pw(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function yW(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function vW(t){return t<0?-t*t:t*t}function uy(t){var e=t(ir,ir),r=1;function n(){return r===1?t(ir,ir):r===.5?t(yW,vW):t(Pw(r),Pw(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Yi(e)}function dy(){var t=uy(ph());return t.copy=function(){return $c(t,dy()).exponent(t.exponent())},Hr.apply(t,arguments),t}function bW(){return dy.apply(null,arguments).exponent(.5)}function Cw(t){return Math.sign(t)*t*t}function xW(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function jI(){var t=ay(),e=[0,1],r=!1,n;function i(a){var s=xW(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(Cw(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Xu)).map(Cw)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return jI(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},Hr.apply(i,arguments),Yi(i)}function OI(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=TH(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[Mc(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(Ni),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return OI().domain(t).range(e).unknown(n)},Hr.apply(a,arguments)}function RI(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(c){return c!=null&&c<=c?i[Mc(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return s}return s.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,o()):[t,e]},s.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,o()):i.slice()},s.invertExtent=function(c){var l=i.indexOf(c);return l<0?[NaN,NaN]:l<1?[t,n[0]]:l>=r?[n[r-1],e]:[n[l-1],n[l]]},s.unknown=function(c){return arguments.length&&(a=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return RI().domain([t,e]).range(i).unknown(a)},Hr.apply(Yi(s),arguments)}function DI(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[Mc(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return DI().domain(t).range(e).unknown(r)},Hr.apply(i,arguments)}const Ef=new Date,Tf=new Date;function St(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const c=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return c;let l;do c.push(l=new Date(+a)),e(a,o),t(a);while(l<a&&a<s);return c},i.filter=a=>St(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(Ef.setTime(+a),Tf.setTime(+s),t(Ef),t(Tf),Math.floor(r(Ef,Tf))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const Ju=St(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ju.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?St(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):Ju);Ju.range;const zn=1e3,$r=zn*60,Un=$r*60,ti=Un*24,hy=ti*7,kw=ti*30,Af=ti*365,va=St(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*zn)},(t,e)=>(e-t)/zn,t=>t.getUTCSeconds());va.range;const fy=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getMinutes());fy.range;const my=St(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getUTCMinutes());my.range;const py=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn-t.getMinutes()*$r)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getHours());py.range;const gy=St(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getUTCHours());gy.range;const Vc=St(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$r)/ti,t=>t.getDate()-1);Vc.range;const gh=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ti,t=>t.getUTCDate()-1);gh.range;const MI=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ti,t=>Math.floor(t/ti));MI.range;function Za(t){return St(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*$r)/hy)}const yh=Za(0),ed=Za(1),wW=Za(2),_W=Za(3),Ls=Za(4),EW=Za(5),TW=Za(6);yh.range;ed.range;wW.range;_W.range;Ls.range;EW.range;TW.range;function Xa(t){return St(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/hy)}const vh=Xa(0),td=Xa(1),AW=Xa(2),SW=Xa(3),$s=Xa(4),IW=Xa(5),PW=Xa(6);vh.range;td.range;AW.range;SW.range;$s.range;IW.range;PW.range;const yy=St(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());yy.range;const vy=St(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());vy.range;const ri=St(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ri.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ri.range;const ni=St(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ni.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});ni.range;function LI(t,e,r,n,i,a){const s=[[va,1,zn],[va,5,5*zn],[va,15,15*zn],[va,30,30*zn],[a,1,$r],[a,5,5*$r],[a,15,15*$r],[a,30,30*$r],[i,1,Un],[i,3,3*Un],[i,6,6*Un],[i,12,12*Un],[n,1,ti],[n,2,2*ti],[r,1,hy],[e,1,kw],[e,3,3*kw],[t,1,Af]];function o(l,u,h){const m=u<l;m&&([l,u]=[u,l]);const p=h&&typeof h.range=="function"?h:c(l,u,h),v=p?p.range(l,+u+1):[];return m?v.reverse():v}function c(l,u,h){const m=Math.abs(u-l)/h,p=Jg(([,,g])=>g).right(s,m);if(p===s.length)return t.every(Wm(l/Af,u/Af,h));if(p===0)return Ju.every(Math.max(Wm(l,u,h),1));const[v,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return v.every(b)}return[o,c]}const[CW,kW]=LI(ni,vy,vh,MI,gy,my),[NW,jW]=LI(ri,yy,yh,Vc,py,fy);function Sf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function If(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ao(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function OW(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,c=t.shortMonths,l=So(i),u=Io(i),h=So(a),m=Io(a),p=So(s),v=Io(s),b=So(o),g=Io(o),_=So(c),T=Io(c),E={a:ee,A:he,b:ye,B:Ue,c:null,d:Mw,e:Mw,f:rq,g:hq,G:mq,H:JW,I:eq,j:tq,L:$I,m:nq,M:iq,p:se,q,Q:Vw,s:Fw,S:aq,u:sq,U:oq,V:cq,w:lq,W:uq,x:null,X:null,y:dq,Y:fq,Z:pq,"%":$w},j={a:J,A:rt,b:Fe,B:ze,c:null,d:Lw,e:Lw,f:bq,g:Cq,G:Nq,H:gq,I:yq,j:vq,L:FI,m:xq,M:wq,p:Cr,q:rn,Q:Vw,s:Fw,S:_q,u:Eq,U:Tq,V:Aq,w:Sq,W:Iq,x:null,X:null,y:Pq,Y:kq,Z:jq,"%":$w},R={a:O,A:N,b:C,B:k,c:Q,d:Rw,e:Rw,f:YW,g:Ow,G:jw,H:Dw,I:Dw,j:WW,L:GW,m:HW,M:qW,p:P,q:BW,Q:XW,s:QW,S:KW,u:$W,U:VW,V:FW,w:LW,W:zW,x:oe,X,y:Ow,Y:jw,Z:UW,"%":ZW};E.x=D(r,E),E.X=D(n,E),E.c=D(e,E),j.x=D(r,j),j.X=D(n,j),j.c=D(e,j);function D(G,de){return function(be){var B=[],dt=-1,Te=0,vt=G.length,bt,rr,Ji;for(be instanceof Date||(be=new Date(+be));++dt<vt;)G.charCodeAt(dt)===37&&(B.push(G.slice(Te,dt)),(rr=Nw[bt=G.charAt(++dt)])!=null?bt=G.charAt(++dt):rr=bt==="e"?" ":"0",(Ji=de[bt])&&(bt=Ji(be,rr)),B.push(bt),Te=dt+1);return B.push(G.slice(Te,dt)),B.join("")}}function S(G,de){return function(be){var B=Ao(1900,void 0,1),dt=A(B,G,be+="",0),Te,vt;if(dt!=be.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Te=If(Ao(B.y,0,1)),vt=Te.getUTCDay(),Te=vt>4||vt===0?td.ceil(Te):td(Te),Te=gh.offset(Te,(B.V-1)*7),B.y=Te.getUTCFullYear(),B.m=Te.getUTCMonth(),B.d=Te.getUTCDate()+(B.w+6)%7):(Te=Sf(Ao(B.y,0,1)),vt=Te.getDay(),Te=vt>4||vt===0?ed.ceil(Te):ed(Te),Te=Vc.offset(Te,(B.V-1)*7),B.y=Te.getFullYear(),B.m=Te.getMonth(),B.d=Te.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),vt="Z"in B?If(Ao(B.y,0,1)).getUTCDay():Sf(Ao(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(vt+5)%7:B.w+B.U*7-(vt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,If(B)):Sf(B)}}function A(G,de,be,B){for(var dt=0,Te=de.length,vt=be.length,bt,rr;dt<Te;){if(B>=vt)return-1;if(bt=de.charCodeAt(dt++),bt===37){if(bt=de.charAt(dt++),rr=R[bt in Nw?de.charAt(dt++):bt],!rr||(B=rr(G,be,B))<0)return-1}else if(bt!=be.charCodeAt(B++))return-1}return B}function P(G,de,be){var B=l.exec(de.slice(be));return B?(G.p=u.get(B[0].toLowerCase()),be+B[0].length):-1}function O(G,de,be){var B=p.exec(de.slice(be));return B?(G.w=v.get(B[0].toLowerCase()),be+B[0].length):-1}function N(G,de,be){var B=h.exec(de.slice(be));return B?(G.w=m.get(B[0].toLowerCase()),be+B[0].length):-1}function C(G,de,be){var B=_.exec(de.slice(be));return B?(G.m=T.get(B[0].toLowerCase()),be+B[0].length):-1}function k(G,de,be){var B=b.exec(de.slice(be));return B?(G.m=g.get(B[0].toLowerCase()),be+B[0].length):-1}function Q(G,de,be){return A(G,e,de,be)}function oe(G,de,be){return A(G,r,de,be)}function X(G,de,be){return A(G,n,de,be)}function ee(G){return s[G.getDay()]}function he(G){return a[G.getDay()]}function ye(G){return c[G.getMonth()]}function Ue(G){return o[G.getMonth()]}function se(G){return i[+(G.getHours()>=12)]}function q(G){return 1+~~(G.getMonth()/3)}function J(G){return s[G.getUTCDay()]}function rt(G){return a[G.getUTCDay()]}function Fe(G){return c[G.getUTCMonth()]}function ze(G){return o[G.getUTCMonth()]}function Cr(G){return i[+(G.getUTCHours()>=12)]}function rn(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var de=D(G+="",E);return de.toString=function(){return G},de},parse:function(G){var de=S(G+="",!1);return de.toString=function(){return G},de},utcFormat:function(G){var de=D(G+="",j);return de.toString=function(){return G},de},utcParse:function(G){var de=S(G+="",!0);return de.toString=function(){return G},de}}}var Nw={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,RW=/^%/,DW=/[\\^$*+?|[\]().{}]/g;function Pe(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function MW(t){return t.replace(DW,"\\$&")}function So(t){return new RegExp("^(?:"+t.map(MW).join("|")+")","i")}function Io(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function LW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function $W(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function VW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function FW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function zW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function jw(t,e,r){var n=kt.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Ow(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function UW(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function BW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function HW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Rw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function WW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Dw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function qW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function KW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function GW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function YW(t,e,r){var n=kt.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZW(t,e,r){var n=RW.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function XW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function QW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Mw(t,e){return Pe(t.getDate(),e,2)}function JW(t,e){return Pe(t.getHours(),e,2)}function eq(t,e){return Pe(t.getHours()%12||12,e,2)}function tq(t,e){return Pe(1+Vc.count(ri(t),t),e,3)}function $I(t,e){return Pe(t.getMilliseconds(),e,3)}function rq(t,e){return $I(t,e)+"000"}function nq(t,e){return Pe(t.getMonth()+1,e,2)}function iq(t,e){return Pe(t.getMinutes(),e,2)}function aq(t,e){return Pe(t.getSeconds(),e,2)}function sq(t){var e=t.getDay();return e===0?7:e}function oq(t,e){return Pe(yh.count(ri(t)-1,t),e,2)}function VI(t){var e=t.getDay();return e>=4||e===0?Ls(t):Ls.ceil(t)}function cq(t,e){return t=VI(t),Pe(Ls.count(ri(t),t)+(ri(t).getDay()===4),e,2)}function lq(t){return t.getDay()}function uq(t,e){return Pe(ed.count(ri(t)-1,t),e,2)}function dq(t,e){return Pe(t.getFullYear()%100,e,2)}function hq(t,e){return t=VI(t),Pe(t.getFullYear()%100,e,2)}function fq(t,e){return Pe(t.getFullYear()%1e4,e,4)}function mq(t,e){var r=t.getDay();return t=r>=4||r===0?Ls(t):Ls.ceil(t),Pe(t.getFullYear()%1e4,e,4)}function pq(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Pe(e/60|0,"0",2)+Pe(e%60,"0",2)}function Lw(t,e){return Pe(t.getUTCDate(),e,2)}function gq(t,e){return Pe(t.getUTCHours(),e,2)}function yq(t,e){return Pe(t.getUTCHours()%12||12,e,2)}function vq(t,e){return Pe(1+gh.count(ni(t),t),e,3)}function FI(t,e){return Pe(t.getUTCMilliseconds(),e,3)}function bq(t,e){return FI(t,e)+"000"}function xq(t,e){return Pe(t.getUTCMonth()+1,e,2)}function wq(t,e){return Pe(t.getUTCMinutes(),e,2)}function _q(t,e){return Pe(t.getUTCSeconds(),e,2)}function Eq(t){var e=t.getUTCDay();return e===0?7:e}function Tq(t,e){return Pe(vh.count(ni(t)-1,t),e,2)}function zI(t){var e=t.getUTCDay();return e>=4||e===0?$s(t):$s.ceil(t)}function Aq(t,e){return t=zI(t),Pe($s.count(ni(t),t)+(ni(t).getUTCDay()===4),e,2)}function Sq(t){return t.getUTCDay()}function Iq(t,e){return Pe(td.count(ni(t)-1,t),e,2)}function Pq(t,e){return Pe(t.getUTCFullYear()%100,e,2)}function Cq(t,e){return t=zI(t),Pe(t.getUTCFullYear()%100,e,2)}function kq(t,e){return Pe(t.getUTCFullYear()%1e4,e,4)}function Nq(t,e){var r=t.getUTCDay();return t=r>=4||r===0?$s(t):$s.ceil(t),Pe(t.getUTCFullYear()%1e4,e,4)}function jq(){return"+0000"}function $w(){return"%"}function Vw(t){return+t}function Fw(t){return Math.floor(+t/1e3)}var cs,UI,BI;Oq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Oq(t){return cs=OW(t),UI=cs.format,cs.parse,BI=cs.utcFormat,cs.utcParse,cs}function Rq(t){return new Date(t)}function Dq(t){return t instanceof Date?+t:+new Date(+t)}function by(t,e,r,n,i,a,s,o,c,l){var u=ay(),h=u.invert,m=u.domain,p=l(".%L"),v=l(":%S"),b=l("%I:%M"),g=l("%I %p"),_=l("%a %d"),T=l("%b %d"),E=l("%B"),j=l("%Y");function R(D){return(c(D)<D?p:o(D)<D?v:s(D)<D?b:a(D)<D?g:n(D)<D?i(D)<D?_:T:r(D)<D?E:j)(D)}return u.invert=function(D){return new Date(h(D))},u.domain=function(D){return arguments.length?m(Array.from(D,Dq)):m().map(Rq)},u.ticks=function(D){var S=m();return t(S[0],S[S.length-1],D??10)},u.tickFormat=function(D,S){return S==null?R:l(S)},u.nice=function(D){var S=m();return(!D||typeof D.range!="function")&&(D=e(S[0],S[S.length-1],D??10)),D?m(CI(S,D)):u},u.copy=function(){return $c(u,by(t,e,r,n,i,a,s,o,c,l))},u}function Mq(){return Hr.apply(by(NW,jW,ri,yy,yh,Vc,py,fy,va,UI).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Lq(){return Hr.apply(by(CW,kW,ni,vy,vh,gh,gy,my,va,BI).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bh(){var t=0,e=1,r,n,i,a,s=ir,o=!1,c;function l(h){return h==null||isNaN(h=+h)?c:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),l):[t,e]},l.clamp=function(h){return arguments.length?(o=!!h,l):o},l.interpolator=function(h){return arguments.length?(s=h,l):s};function u(h){return function(m){var p,v;return arguments.length?([p,v]=m,s=h(p,v),l):[s(0),s(1)]}}return l.range=u(Gs),l.rangeRound=u(iy),l.unknown=function(h){return arguments.length?(c=h,l):c},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),l}}function Zi(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function HI(){var t=Yi(bh()(ir));return t.copy=function(){return Zi(t,HI())},si.apply(t,arguments)}function WI(){var t=cy(bh()).domain([1,10]);return t.copy=function(){return Zi(t,WI()).base(t.base())},si.apply(t,arguments)}function qI(){var t=ly(bh());return t.copy=function(){return Zi(t,qI()).constant(t.constant())},si.apply(t,arguments)}function xy(){var t=uy(bh());return t.copy=function(){return Zi(t,xy()).exponent(t.exponent())},si.apply(t,arguments)}function $q(){return xy.apply(null,arguments).exponent(.5)}function KI(){var t=[],e=ir;function r(n){if(n!=null&&!isNaN(n=+n))return e((Mc(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Ni),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>EH(t,a/n))},r.copy=function(){return KI(e).domain(t)},si.apply(r,arguments)}function xh(){var t=0,e=.5,r=1,n=1,i,a,s,o,c,l=ir,u,h=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+u(b))-a)*(n*b<n*a?o:c),l(h?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([t,e,r]=b,i=u(t=+t),a=u(e=+e),s=u(r=+r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p):[t,e,r]},p.clamp=function(b){return arguments.length?(h=!!b,p):h},p.interpolator=function(b){return arguments.length?(l=b,p):l};function v(b){return function(g){var _,T,E;return arguments.length?([_,T,E]=g,l=ZH(b,[_,T,E]),p):[l(0),l(.5),l(1)]}}return p.range=v(Gs),p.rangeRound=v(iy),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return u=b,i=b(t),a=b(e),s=b(r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p}}function GI(){var t=Yi(xh()(ir));return t.copy=function(){return Zi(t,GI())},si.apply(t,arguments)}function YI(){var t=cy(xh()).domain([.1,1,10]);return t.copy=function(){return Zi(t,YI()).base(t.base())},si.apply(t,arguments)}function ZI(){var t=ly(xh());return t.copy=function(){return Zi(t,ZI()).constant(t.constant())},si.apply(t,arguments)}function wy(){var t=uy(xh());return t.copy=function(){return Zi(t,wy()).exponent(t.exponent())},si.apply(t,arguments)}function Vq(){return wy.apply(null,arguments).exponent(.5)}const Mo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ty,scaleDiverging:GI,scaleDivergingLog:YI,scaleDivergingPow:wy,scaleDivergingSqrt:Vq,scaleDivergingSymlog:ZI,scaleIdentity:PI,scaleImplicit:qm,scaleLinear:II,scaleLog:kI,scaleOrdinal:ey,scalePoint:SH,scalePow:dy,scaleQuantile:OI,scaleQuantize:RI,scaleRadial:jI,scaleSequential:HI,scaleSequentialLog:WI,scaleSequentialPow:xy,scaleSequentialQuantile:KI,scaleSequentialSqrt:$q,scaleSequentialSymlog:qI,scaleSqrt:bW,scaleSymlog:NI,scaleThreshold:DI,scaleTime:Mq,scaleUtc:Lq,tickFormat:SI},Symbol.toStringTag,{value:"Module"}));var Qa=t=>t.chartData,Fq=V([Qa],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),XI=(t,e,r,n)=>n?Fq(t):Qa(t);function Vs(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(tn(e)&&tn(r))return!0}return!1}function zw(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function zq(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(tn(r))i=r;else if(typeof r=="function")return;if(tn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Vs(s))return s}}function Uq(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Vs(n))return zw(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,s,o;if(i==="auto")e!=null&&(s=Math.min(...e));else if(te(i))s=i;else if(typeof i=="function")try{e!=null&&(s=i(e?.[0]))}catch{}else if(typeof i=="string"&&Vx.test(i)){var c=Vx.exec(i);if(c==null||e==null)s=void 0;else{var l=+c[1];s=e[0]-l}}else s=e?.[0];if(a==="auto")e!=null&&(o=Math.max(...e));else if(te(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e?.[1]))}catch{}else if(typeof a=="string"&&Fx.test(a)){var u=Fx.exec(a);if(u==null||e==null)o=void 0;else{var h=+u[1];o=e[1]+h}}else o=e?.[1];var m=[s,o];if(Vs(m))return e==null?m:zw(m,e,r)}}}var Ys=1e9,Bq={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Ey,Ye=!0,zr="[DecimalError] ",Sa=zr+"Invalid argument: ",_y=zr+"Exponent out of range: ",Zs=Math.floor,da=Math.pow,Hq=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Er,Pt=1e7,We=7,QI=9007199254740991,rd=Zs(QI/We),Z={};Z.absoluteValue=Z.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Z.comparedTo=Z.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Z.decimalPlaces=Z.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*We;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Z.dividedBy=Z.div=function(t){return Kn(this,new this.constructor(t))};Z.dividedToIntegerBy=Z.idiv=function(t){var e=this,r=e.constructor;return $e(Kn(e,new r(t),0,1),r.precision)};Z.equals=Z.eq=function(t){return!this.cmp(t)};Z.exponent=function(){return yt(this)};Z.greaterThan=Z.gt=function(t){return this.cmp(t)>0};Z.greaterThanOrEqualTo=Z.gte=function(t){return this.cmp(t)>=0};Z.isInteger=Z.isint=function(){return this.e>this.d.length-2};Z.isNegative=Z.isneg=function(){return this.s<0};Z.isPositive=Z.ispos=function(){return this.s>0};Z.isZero=function(){return this.s===0};Z.lessThan=Z.lt=function(t){return this.cmp(t)<0};Z.lessThanOrEqualTo=Z.lte=function(t){return this.cmp(t)<1};Z.logarithm=Z.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Er))throw Error(zr+"NaN");if(r.s<1)throw Error(zr+(r.s?"NaN":"-Infinity"));return r.eq(Er)?new n(0):(Ye=!1,e=Kn(gc(r,a),gc(t,a),a),Ye=!0,$e(e,i))};Z.minus=Z.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?tP(e,t):JI(e,(t.s=-t.s,t))};Z.modulo=Z.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(zr+"NaN");return r.s?(Ye=!1,e=Kn(r,t,0,1).times(t),Ye=!0,r.minus(e)):$e(new n(r),i)};Z.naturalExponential=Z.exp=function(){return eP(this)};Z.naturalLogarithm=Z.ln=function(){return gc(this)};Z.negated=Z.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Z.plus=Z.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?JI(e,t):tP(e,(t.s=-t.s,t))};Z.precision=Z.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Sa+t);if(e=yt(i)+1,n=i.d.length-1,r=n*We+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Z.squareRoot=Z.sqrt=function(){var t,e,r,n,i,a,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(zr+"NaN")}for(t=yt(o),Ye=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=fn(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=Zs((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(i.toString()),r=c.precision,i=s=r+3;;)if(a=n,n=a.plus(Kn(o,a,s+2)).times(.5),fn(a.d).slice(0,s)===(e=fn(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if($e(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Ye=!0,$e(n,r)};Z.times=Z.mul=function(t){var e,r,n,i,a,s,o,c,l,u=this,h=u.constructor,m=u.d,p=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,c=m.length,l=p.length,c<l&&(a=m,m=p,p=a,s=c,c=l,l=s),a=[],s=c+l,n=s;n--;)a.push(0);for(n=l;--n>=0;){for(e=0,i=c+n;i>n;)o=a[i]+p[n]*m[i-n-1]+e,a[i--]=o%Pt|0,e=o/Pt|0;a[i]=(a[i]+e)%Pt|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ye?$e(t,h.precision):t};Z.toDecimalPlaces=Z.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Pn(t,0,Ys),e===void 0?e=n.rounding:Pn(e,0,8),$e(r,t+yt(r)+1,e))};Z.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Fa(n,!0):(Pn(t,0,Ys),e===void 0?e=i.rounding:Pn(e,0,8),n=$e(new i(n),t+1,e),r=Fa(n,!0,t+1)),r};Z.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?Fa(i):(Pn(t,0,Ys),e===void 0?e=a.rounding:Pn(e,0,8),n=$e(new a(i),t+yt(i)+1,e),r=Fa(n.abs(),!1,t+yt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Z.toInteger=Z.toint=function(){var t=this,e=t.constructor;return $e(new e(t),yt(t)+1,e.rounding)};Z.toNumber=function(){return+this};Z.toPower=Z.pow=function(t){var e,r,n,i,a,s,o=this,c=o.constructor,l=12,u=+(t=new c(t));if(!t.s)return new c(Er);if(o=new c(o),!o.s){if(t.s<1)throw Error(zr+"Infinity");return o}if(o.eq(Er))return o;if(n=c.precision,t.eq(Er))return $e(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=u<0?-u:u)<=QI){for(i=new c(Er),e=Math.ceil(n/We+4),Ye=!1;r%2&&(i=i.times(o),Bw(i.d,e)),r=Zs(r/2),r!==0;)o=o.times(o),Bw(o.d,e);return Ye=!0,t.s<0?new c(Er).div(i):$e(i,n)}}else if(a<0)throw Error(zr+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Ye=!1,i=t.times(gc(o,n+l)),Ye=!0,i=eP(i),i.s=a,i};Z.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=yt(i),n=Fa(i,r<=a.toExpNeg||r>=a.toExpPos)):(Pn(t,1,Ys),e===void 0?e=a.rounding:Pn(e,0,8),i=$e(new a(i),t,e),r=yt(i),n=Fa(i,t<=r||r<=a.toExpNeg,t)),n};Z.toSignificantDigits=Z.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Pn(t,1,Ys),e===void 0?e=n.rounding:Pn(e,0,8)),$e(new n(r),t,e)};Z.toString=Z.valueOf=Z.val=Z.toJSON=Z[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=yt(t),r=t.constructor;return Fa(t,e<=r.toExpNeg||e>=r.toExpPos)};function JI(t,e){var r,n,i,a,s,o,c,l,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Ye?$e(e,h):e;if(c=t.d,l=e.d,s=t.e,i=e.e,c=c.slice(),a=s-i,a){for(a<0?(n=c,a=-a,o=l.length):(n=l,i=s,o=c.length),s=Math.ceil(h/We),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=l.length,o-a<0&&(a=o,n=l,l=c,c=n),r=0;a;)r=(c[--a]=c[a]+l[a]+r)/Pt|0,c[a]%=Pt;for(r&&(c.unshift(r),++i),o=c.length;c[--o]==0;)c.pop();return e.d=c,e.e=i,Ye?$e(e,h):e}function Pn(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Sa+t)}function fn(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=We-n.length,r&&(a+=vi(r)),a+=n;s=t[e],n=s+"",r=We-n.length,r&&(a+=vi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Kn=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Pt|0,s=a/Pt|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,c;if(a!=s)c=a>s?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=i[o]){c=n[o]>i[o]?1:-1;break}return c}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Pt+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,c,l,u,h,m,p,v,b,g,_,T,E,j,R,D,S,A,P=n.constructor,O=n.s==i.s?1:-1,N=n.d,C=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(zr+"Division by zero");for(c=n.e-i.e,S=C.length,R=N.length,p=new P(O),v=p.d=[],l=0;C[l]==(N[l]||0);)++l;if(C[l]>(N[l]||0)&&--c,a==null?T=a=P.precision:s?T=a+(yt(n)-yt(i))+1:T=a,T<0)return new P(0);if(T=T/We+2|0,l=0,S==1)for(u=0,C=C[0],T++;(l<R||u)&&T--;l++)E=u*Pt+(N[l]||0),v[l]=E/C|0,u=E%C|0;else{for(u=Pt/(C[0]+1)|0,u>1&&(C=t(C,u),N=t(N,u),S=C.length,R=N.length),j=S,b=N.slice(0,S),g=b.length;g<S;)b[g++]=0;A=C.slice(),A.unshift(0),D=C[0],C[1]>=Pt/2&&++D;do u=0,o=e(C,b,S,g),o<0?(_=b[0],S!=g&&(_=_*Pt+(b[1]||0)),u=_/D|0,u>1?(u>=Pt&&(u=Pt-1),h=t(C,u),m=h.length,g=b.length,o=e(h,b,m,g),o==1&&(u--,r(h,S<m?A:C,m))):(u==0&&(o=u=1),h=C.slice()),m=h.length,m<g&&h.unshift(0),r(b,h,g),o==-1&&(g=b.length,o=e(C,b,S,g),o<1&&(u++,r(b,S<g?A:C,g))),g=b.length):o===0&&(u++,b=[0]),v[l++]=u,o&&b[0]?b[g++]=N[j]||0:(b=[N[j]],g=1);while((j++<R||b[0]!==void 0)&&T--)}return v[0]||v.shift(),p.e=c,$e(p,s?a+yt(p)+1:a)}}();function eP(t,e){var r,n,i,a,s,o,c=0,l=0,u=t.constructor,h=u.precision;if(yt(t)>16)throw Error(_y+yt(t));if(!t.s)return new u(Er);for(Ye=!1,o=h,s=new u(.03125);t.abs().gte(.1);)t=t.times(s),l+=5;for(n=Math.log(da(2,l))/Math.LN10*2+5|0,o+=n,r=i=a=new u(Er),u.precision=o;;){if(i=$e(i.times(t),o),r=r.times(++c),s=a.plus(Kn(i,r,o)),fn(s.d).slice(0,o)===fn(a.d).slice(0,o)){for(;l--;)a=$e(a.times(a),o);return u.precision=h,e==null?(Ye=!0,$e(a,h)):a}a=s}}function yt(t){for(var e=t.e*We,r=t.d[0];r>=10;r/=10)e++;return e}function Pf(t,e,r){if(e>t.LN10.sd())throw Ye=!0,r&&(t.precision=r),Error(zr+"LN10 precision limit exceeded");return $e(new t(t.LN10),e)}function vi(t){for(var e="";t--;)e+="0";return e}function gc(t,e){var r,n,i,a,s,o,c,l,u,h=1,m=10,p=t,v=p.d,b=p.constructor,g=b.precision;if(p.s<1)throw Error(zr+(p.s?"NaN":"-Infinity"));if(p.eq(Er))return new b(0);if(e==null?(Ye=!1,l=g):l=e,p.eq(10))return e==null&&(Ye=!0),Pf(b,l);if(l+=m,b.precision=l,r=fn(v),n=r.charAt(0),a=yt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(t),r=fn(p.d),n=r.charAt(0),h++;a=yt(p),n>1?(p=new b("0."+r),a++):p=new b(n+"."+r.slice(1))}else return c=Pf(b,l+2,g).times(a+""),p=gc(new b(n+"."+r.slice(1)),l-m).plus(c),b.precision=g,e==null?(Ye=!0,$e(p,g)):p;for(o=s=p=Kn(p.minus(Er),p.plus(Er),l),u=$e(p.times(p),l),i=3;;){if(s=$e(s.times(u),l),c=o.plus(Kn(s,new b(i),l)),fn(c.d).slice(0,l)===fn(o.d).slice(0,l))return o=o.times(2),a!==0&&(o=o.plus(Pf(b,l+2,g).times(a+""))),o=Kn(o,new b(h),l),b.precision=g,e==null?(Ye=!0,$e(o,g)):o;o=c,i+=2}}function Uw(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=Zs(r/We),t.d=[],n=(r+1)%We,r<0&&(n+=We),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=We;n<i;)t.d.push(+e.slice(n,n+=We));e=e.slice(n),n=We-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ye&&(t.e>rd||t.e<-rd))throw Error(_y+r)}else t.s=0,t.e=0,t.d=[0];return t}function $e(t,e,r){var n,i,a,s,o,c,l,u,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=We,i=e,l=h[u=0];else{if(u=Math.ceil((n+1)/We),a=h.length,u>=a)return t;for(l=a=h[u],s=1;a>=10;a/=10)s++;n%=We,i=n-We+s}if(r!==void 0&&(a=da(10,s-i-1),o=l/a%10|0,c=e<0||h[u+1]!==void 0||l%a,c=r<4?(o||c)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?i>0?l/da(10,s-i):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return c?(a=yt(t),h.length=1,e=e-a-1,h[0]=da(10,(We-e%We)%We),t.e=Zs(-e/We)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=da(10,We-n),h[u]=i>0?(l/da(10,s-i)%da(10,i)|0)*a:0),c)for(;;)if(u==0){(h[0]+=a)==Pt&&(h[0]=1,++t.e);break}else{if(h[u]+=a,h[u]!=Pt)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Ye&&(t.e>rd||t.e<-rd))throw Error(_y+yt(t));return t}function tP(t,e){var r,n,i,a,s,o,c,l,u,h,m=t.constructor,p=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Ye?$e(e,p):e;if(c=t.d,h=e.d,n=e.e,l=t.e,c=c.slice(),s=l-n,s){for(u=s<0,u?(r=c,s=-s,o=h.length):(r=h,n=l,o=c.length),i=Math.max(Math.ceil(p/We),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=c.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(c[i]!=h[i]){u=c[i]<h[i];break}s=0}for(u&&(r=c,c=h,h=r,e.s=-e.s),o=c.length,i=h.length-o;i>0;--i)c[o++]=0;for(i=h.length;i>s;){if(c[--i]<h[i]){for(a=i;a&&c[--a]===0;)c[a]=Pt-1;--c[a],c[i]+=Pt}c[i]-=h[i]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ye?$e(e,p):e):new m(0)}function Fa(t,e,r){var n,i=yt(t),a=fn(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+vi(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+vi(-i-1)+a,r&&(n=r-s)>0&&(a+=vi(n))):i>=s?(a+=vi(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+vi(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=vi(n))),t.s<0?"-"+a:a}function Bw(t,e){if(t.length>e)return t.length=e,!0}function rP(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Sa+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return Uw(s,a.toString())}else if(typeof a!="string")throw Error(Sa+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,Hq.test(a))Uw(s,a);else throw Error(Sa+a)}if(i.prototype=Z,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=rP,i.config=i.set=Wq,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function Wq(t){if(!t||typeof t!="object")throw Error(zr+"Object expected");var e,r,n,i=["precision",1,Ys,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(Zs(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(Sa+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Sa+r+": "+n);return this}var Ey=rP(Bq);Er=new Ey(1);const je=Ey;var qq=t=>t,nP={},iP=t=>t===nP,Hw=t=>function e(){return arguments.length===0||arguments.length===1&&iP(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},aP=(t,e)=>t===1?e:Hw(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==nP).length;return a>=t?e(...n):aP(t-a,Hw(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var l=n.map(u=>iP(u)?o.shift():u);return e(...l,...o)}))}),wh=t=>aP(t.length,t),Zm=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},Kq=wh((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),Gq=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return qq;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,c)=>c(o),a(...arguments))}},Xm=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),sP=t=>{var e=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e&&i.every((s,o)=>{var c;return s===((c=e)===null||c===void 0?void 0:c[o])})||(e=i,r=t(...i)),r}};function oP(t){var e;return t===0?e=1:e=Math.floor(new je(t).abs().log(10).toNumber())+1,e}function cP(t,e,r){for(var n=new je(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}wh((t,e,r)=>{var n=+t,i=+e;return n+r*(i-n)});wh((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});wh((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var lP=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},uP=(t,e,r)=>{if(t.lte(0))return new je(0);var n=oP(t.toNumber()),i=new je(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new je(Math.ceil(a.div(s).toNumber())).add(r).mul(s),c=o.mul(i);return e?new je(c.toNumber()):new je(Math.ceil(c.toNumber()))},Yq=(t,e,r)=>{var n=new je(1),i=new je(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new je(10).pow(oP(t)-1),i=new je(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new je(Math.floor(t)))}else t===0?i=new je(Math.floor((e-1)/2)):r||(i=new je(Math.floor(t)));var s=Math.floor((e-1)/2),o=Gq(Kq(c=>i.add(new je(c-s).mul(n)).toNumber()),Zm);return o(0,e)},dP=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new je(0),tickMin:new je(0),tickMax:new je(0)};var s=uP(new je(r).sub(e).div(n-1),i,a),o;e<=0&&r>=0?o=new je(0):(o=new je(e).add(r).div(2),o=o.sub(new je(o).mod(s)));var c=Math.ceil(o.sub(e).div(s).toNumber()),l=Math.ceil(new je(r).sub(o).div(s).toNumber()),u=c+l+1;return u>n?dP(e,r,n,i,a+1):(u<n&&(l=r>0?l+(n-u):l,c=r>0?c:c+(n-u)),{step:s,tickMin:o.sub(new je(c).mul(s)),tickMax:o.add(new je(l).mul(s))})};function Zq(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=lP([e,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,...Zm(0,n-1).map(()=>1/0)]:[...Zm(0,n-1).map(()=>-1/0),o];return e>r?Xm(c):c}if(s===o)return Yq(s,n,i);var{step:l,tickMin:u,tickMax:h}=dP(s,o,a,i,0),m=cP(u,h.add(new je(.1).mul(l)),l);return e>r?Xm(m):m}function Xq(t,e){var[r,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=lP([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(e,2),c=uP(new je(s).sub(a).div(o-1),i,0),l=[...cP(new je(a),new je(s),c),s];return i===!1&&(l=l.map(u=>Math.round(u))),r>n?Xm(l):l}var Qq=sP(Zq),Jq=sP(Xq),e7=t=>t.rootProps.barCategoryGap,_h=t=>t.rootProps.stackOffset,Ty=t=>t.options.chartName,Ay=t=>t.rootProps.syncId,hP=t=>t.rootProps.syncMethod,Sy=t=>t.options.eventEmitter,Ln={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},xr={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Eh=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},t7={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:Ln.reversed,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:Ln.type,unit:void 0},r7={allowDataOverflow:xr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:xr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:xr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:xr.scale,tick:xr.tick,tickCount:xr.tickCount,ticks:void 0,type:xr.type,unit:void 0},n7={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ln.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},i7={allowDataOverflow:xr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:xr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:xr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:xr.scale,tick:xr.tick,tickCount:xr.tickCount,ticks:void 0,type:"category",unit:void 0},Iy=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?n7:t7,Py=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?i7:r7,Th=t=>t.polarOptions,Cy=V([ii,ai,Ht],yB),fP=V([Th,Cy],(t,e)=>{if(t!=null)return Fi(t.innerRadius,e,0)}),mP=V([Th,Cy],(t,e)=>{if(t!=null)return Fi(t.outerRadius,e,e*.8)}),a7=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},pP=V([Th],a7);V([Iy,pP],Eh);var gP=V([Cy,fP,mP],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});V([Py,gP],Eh);var s7=V([tt,Th,fP,mP,ii,ai],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:l}=e;return{cx:Fi(s,i,i/2),cy:Fi(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:l,clockWise:!1}}}),Nt=(t,e)=>e,Ah=(t,e,r)=>r;function Ww(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function nd(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ww(Object(r),!0).forEach(function(n){o7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function o7(t,e,r){return(e=c7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c7(t){var e=l7(t,"string");return typeof e=="symbol"?e:e+""}function l7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Qm=[0,"auto"],vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},oi=(t,e)=>{var r=t.cartesianAxis.xAxis[e];return r??vr},br={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Qm,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:hh},Xi=(t,e)=>{var r=t.cartesianAxis.yAxis[e];return r??br},u7={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ky=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??u7},pr=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Xi(t,r);case"zAxis":return ky(t,r);case"angleAxis":return Iy(t,r);case"radiusAxis":return Py(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},d7=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Xi(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Fc=(t,e,r)=>{switch(e){case"xAxis":return oi(t,r);case"yAxis":return Xi(t,r);case"angleAxis":return Iy(t,r);case"radiusAxis":return Py(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},yP=t=>t.graphicalItems.countOfBars>0;function vP(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var bP=t=>t.graphicalItems.cartesianItems,h7=V([Nt,Ah],vP),xP=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),zc=V([bP,pr,h7],xP),wP=t=>t.filter(e=>e.stackId===void 0),f7=V([zc],wP),_P=t=>t.map(e=>e.data).filter(Boolean).flat(1),m7=V([zc],_P),EP=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},Sh=V([m7,XI],EP),TP=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Ar(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Ar(i,n)}))):t.map(n=>({value:n})),Ih=V([Sh,pr,zc],TP);function AP(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Ja(t){return t.filter(e=>In(e)||e instanceof Date).map(Number).filter(e=>Vr(e)===!1)}function p7(t,e,r){return!r||typeof e!="number"||Vr(e)?[]:r.length?Ja(r.flatMap(n=>{var i=Ar(t,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!tn(a)||!tn(s)))return[e-a,e+s]})):[]}var SP=(t,e,r)=>{var n={},i=e.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,c=o.map(l=>l.dataKey);return[s,{stackedData:jB(t,c,r),graphicalItems:o}]}))},g7=V([Sh,zc,_h],SP),IP=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:i}=e;if(r!=="zAxis"){var a=MB(t,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},y7=V([g7,Qa,Nt],IP),PP=(t,e,r,n)=>r.length>0?t.flatMap(i=>r.flatMap(a=>{var s,o,c=(s=a.errorBars)===null||s===void 0?void 0:s.filter(u=>AP(n,u)),l=Ar(i,(o=e.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:l,errorDomain:p7(i,l,c)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:Ar(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),v7=V(Sh,pr,f7,Nt,PP);function b7(t){var{value:e}=t;if(In(e)||e instanceof Date)return e}var x7=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Ja(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},w7=(t,e,r)=>{var n=t.map(b7).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&$A(n))?gI(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Ny=t=>{var e;if(t==null||!("domain"in t))return Qm;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=Ja(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:Qm},jy=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},CP=t=>t.referenceElements.dots,Xs=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),_7=V([CP,Nt,Ah],Xs),kP=t=>t.referenceElements.areas,E7=V([kP,Nt,Ah],Xs),NP=t=>t.referenceElements.lines,T7=V([NP,Nt,Ah],Xs),jP=(t,e)=>{var r=Ja(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},A7=V(_7,Nt,jP),OP=(t,e)=>{var r=Ja(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},S7=V([E7,Nt],OP),RP=(t,e)=>{var r=Ja(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},I7=V(T7,Nt,RP),P7=V(A7,I7,S7,(t,e,r)=>jy(t,r,e)),C7=V([pr],Ny),DP=(t,e,r,n,i)=>{var a=zq(e,t.allowDataOverflow);return a??Uq(e,jy(r,i,x7(n)),t.allowDataOverflow)},k7=V([pr,C7,y7,v7,P7],DP),N7=[0,1],MP=(t,e,r,n,i,a,s)=>{if(!(t==null||r==null||r.length===0)){var{dataKey:o,type:c}=t,l=Gi(e,a);return l&&o==null?gI(0,r.length):c==="category"?w7(n,t,l):i==="expand"?N7:s}},Oy=V([pr,tt,Sh,Ih,_h,Nt,k7],MP),LP=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:s}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(Ng(a));return o in Mo?o:"point"}}},Uc=V([pr,tt,yP,Ty,Nt],LP);function j7(t){if(t!=null){if(t in Mo)return Mo[t]();var e="scale".concat(Ng(t));if(e in Mo)return Mo[e]()}}function Ry(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=j7(e);if(i!=null){var a=i.domain(r).range(n);return PB(a),a}}}var $P=(t,e,r)=>{var n=Ny(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Vs(t))return Qq(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Vs(t))return Jq(t,e.tickCount,e.allowDecimals)}},Dy=V([Oy,Fc,Uc],$P),VP=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Vs(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],s=e[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return e},O7=V([pr,Oy,Dy,Nt],VP),R7=V(Ih,pr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(Ja(t.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),FP=V(R7,tt,e7,Ht,(t,e,r,n)=>n,(t,e,r,n,i)=>{if(!tn(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var s=Fi(r,t*a),o=t*a/2;return o-s-(o-s)/a*s}return 0}),D7=(t,e)=>{var r=oi(t,e);return r==null||typeof r.padding!="string"?0:FP(t,"xAxis",e,r.padding)},M7=(t,e)=>{var r=Xi(t,e);return r==null||typeof r.padding!="string"?0:FP(t,"yAxis",e,r.padding)},L7=V(oi,D7,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),$7=V(Xi,M7,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),V7=V([Ht,L7,mh,fh,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),F7=V([Ht,tt,$7,mh,fh,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Bc=(t,e,r,n)=>{var i;switch(e){case"xAxis":return V7(t,r,n);case"yAxis":return F7(t,r,n);case"zAxis":return(i=ky(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return pP(t);case"radiusAxis":return gP(t,r);default:return}},zP=V([pr,Bc],Eh),Qs=V([pr,Uc,O7,zP],Ry);V(zc,Nt,(t,e)=>t.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>AP(e,r)));function UP(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var Ph=(t,e)=>e,Ch=(t,e,r)=>r,z7=V(Gg,Ph,Ch,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(UP)),U7=V(Yg,Ph,Ch,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(UP)),BP=(t,e)=>({width:t.width,height:e.height}),B7=(t,e)=>{var r=typeof e.width=="number"?e.width:hh;return{width:r,height:t.height}},H7=V(Ht,oi,BP),W7=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},q7=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},K7=V(ai,Ht,z7,Ph,Ch,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=BP(e,o);s==null&&(s=W7(e,n,t));var l=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(l)*c.height,s+=(l?-1:1)*c.height}),a}),G7=V(ii,Ht,U7,Ph,Ch,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=B7(e,o);s==null&&(s=q7(e,n,t));var l=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(l)*c.width,s+=(l?-1:1)*c.width}),a}),Y7=(t,e)=>{var r=Ht(t),n=oi(t,e);if(n!=null){var i=K7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},Z7=(t,e)=>{var r=Ht(t),n=Xi(t,e);if(n!=null){var i=G7(t,n.orientation,n.mirror),a=i[e];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},X7=V(Ht,Xi,(t,e)=>{var r=typeof e.width=="number"?e.width:hh;return{width:r,height:t.height}}),HP=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=Gi(t,n),c=e.map(l=>l.value);if(s&&o&&a==="category"&&i&&$A(c))return c}},My=V([tt,Ih,pr,Nt],HP),WP=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=Gi(t,n);if(s&&(i==="number"||a!=="auto"))return e.map(o=>o.value)}},Ly=V([tt,Ih,Fc,Nt],WP),qw=V([tt,d7,Uc,Qs,My,Ly,Bc,Dy,Nt],(t,e,r,n,i,a,s,o,c)=>{if(e==null)return null;var l=Gi(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:l,niceTicks:o,range:s,realScaleType:r,scale:n}}),Q7=(t,e,r,n,i,a,s,o,c)=>{if(!(e==null||n==null)){var l=Gi(t,c),{type:u,ticks:h,tickCount:m}=e,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=u==="category"&&n.bandwidth?n.bandwidth()/p:0;v=c==="angleAxis"&&a!=null&&a.length>=2?Lr(a[0]-a[1])*2*v:v;var b=h||i;if(b){var g=b.map((_,T)=>{var E=s?s.indexOf(_):_;return{index:T,coordinate:n(E)+v,value:_,offset:v}});return g.filter(_=>!Vr(_.coordinate))}return l&&o?o.map((_,T)=>({coordinate:n(_)+v,value:_,index:T,offset:v})):n.ticks?n.ticks(m).map(_=>({coordinate:n(_)+v,value:_,offset:v})):n.domain().map((_,T)=>({coordinate:n(_)+v,value:s?s[_]:_,index:T,offset:v}))}},qP=V([tt,Fc,Uc,Qs,Dy,Bc,My,Ly,Nt],Q7),J7=(t,e,r,n,i,a,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Gi(t,s),{tickCount:c}=e,l=0;return l=s==="angleAxis"&&n?.length>=2?Lr(n[0]-n[1])*2*l:l,o&&a?a.map((u,h)=>({coordinate:r(u)+l,value:u,index:h,offset:l})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+l,value:u,offset:l})):r.domain().map((u,h)=>({coordinate:r(u)+l,value:i?i[u]:u,index:h,offset:l}))}},KP=V([tt,Fc,Qs,Bc,My,Ly,Nt],J7),kh=V(pr,Qs,(t,e)=>{if(!(t==null||e==null))return nd(nd({},t),{},{scale:e})}),eK=V([pr,Uc,Oy,zP],Ry);V((t,e,r)=>ky(t,r),eK,(t,e)=>{if(!(t==null||e==null))return nd(nd({},t),{},{scale:e})});var tK=V([tt,Gg,Yg],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),GP=t=>t.options.defaultTooltipEventType,YP=t=>t.options.validateTooltipEventTypes;function ZP(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function $y(t,e){var r=GP(t),n=YP(t);return ZP(e,r,n)}function rK(t){return ie(e=>$y(e,t))}var XP=(t,e)=>{var r,n=Number(e);if(!(Vr(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},nK=t=>t.tooltip.settings,Ei={active:!1,index:null,dataKey:void 0,coordinate:void 0},iK={itemInteraction:{click:Ei,hover:Ei},axisInteraction:{click:Ei,hover:Ei},keyboardInteraction:Ei,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},QP=Br({name:"tooltip",initialState:iK,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Bn(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:aK,removeTooltipEntrySettings:sK,setTooltipSettingsState:oK,setActiveMouseOverItemIndex:cK,mouseLeaveItem:Lee,mouseLeaveChart:JP,setActiveClickItemIndex:$ee,setMouseOverAxisIndex:eC,setMouseClickAxisIndex:lK,setSyncInteraction:Jm,setKeyboardInteraction:ep}=QP.actions,uK=QP.reducer;function Kw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ul(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Kw(Object(r),!0).forEach(function(n){dK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dK(t,e,r){return(e=hK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hK(t){var e=fK(t,"string");return typeof e=="symbol"?e:e+""}function fK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mK(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function pK(t){return t.index!=null}var tC=(t,e,r,n)=>{if(e==null)return Ei;var i=mK(t,e,r);if(i==null)return Ei;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(pK(i)){if(a)return Ul(Ul({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Ul(Ul({},Ei),{},{coordinate:i.coordinate})},Vy=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!tn(n))return r;var i=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(i,Math.min(n,a)))},rC=(t,e,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var c=s[0],l=c==null?void 0:o(c.positions,a);if(l!=null)return l;var u=i?.[Number(a)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},nC=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},Hc=t=>t.options.tooltipPayloadSearcher,Js=t=>t.tooltip;function Gw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Yw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gw(Object(r),!0).forEach(function(n){gK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function gK(t,e,r){return(e=yK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yK(t){var e=vK(t,"string");return typeof e=="symbol"?e:e+""}function vK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bK(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function xK(t,e){return t??e}var iC=(t,e,r,n,i,a,s)=>{if(!(e==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:l,dataEndIndex:u}=r,h=[];return t.reduce((m,p)=>{var v,{dataDefinedOnItem:b,settings:g}=p,_=xK(b,o),T=bK(_,l,u),E=(v=g?.dataKey)!==null&&v!==void 0?v:n?.dataKey,j=g?.nameKey,R;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?R=VA(T,n.dataKey,i):R=a(T,e,c,j),Array.isArray(R))R.forEach(S=>{var A=Yw(Yw({},g),{},{name:S.name,unit:S.unit,color:void 0,fill:void 0});m.push(zx({tooltipEntrySettings:A,dataKey:S.dataKey,payload:S.payload,value:Ar(S.payload,S.dataKey),name:S.name}))});else{var D;m.push(zx({tooltipEntrySettings:g,dataKey:E,payload:R,value:Ar(R,E),name:(D=Ar(R,j))!==null&&D!==void 0?D:g?.name}))}return m},h)}},jt=t=>{var e=tt(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},eo=t=>t.tooltip.settings.axisId,Wt=t=>{var e=jt(t),r=eo(t);return Fc(t,e,r)},Fy=V([Wt,tt,yP,Ty,jt],LP),wK=V([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),_K=V([jt,eo],vP),Nh=V([wK,Wt,_K],xP),EK=V([Nh],_P),es=V([EK,Qa],EP),zy=V([es,Wt,Nh],TP),TK=V([Wt],Ny),AK=V([es,Nh,_h],SP),SK=V([AK,Qa,jt],IP),IK=V([Nh],wP),PK=V([es,Wt,IK,jt],PP),CK=V([CP,jt,eo],Xs),kK=V([CK,jt],jP),NK=V([kP,jt,eo],Xs),jK=V([NK,jt],OP),OK=V([NP,jt,eo],Xs),RK=V([OK,jt],RP),DK=V([kK,RK,jK],jy),MK=V([Wt,TK,SK,PK,DK],DP),aC=V([Wt,tt,es,zy,_h,jt,MK],MP),LK=V([aC,Wt,Fy],$P),$K=V([Wt,aC,LK,jt],VP),sC=t=>{var e=jt(t),r=eo(t),n=!1;return Bc(t,e,r,n)},oC=V([Wt,sC],Eh),cC=V([Wt,Fy,$K,oC],Ry),VK=V([tt,zy,Wt,jt],HP),FK=V([tt,zy,Wt,jt],WP),zK=(t,e,r,n,i,a,s,o)=>{if(e){var{type:c}=e,l=Gi(t,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&i!=null&&i?.length>=2?Lr(i[0]-i[1])*2*h:h,l&&s?s.map((m,p)=>({coordinate:n(m)+h,value:m,index:p,offset:h})):n.domain().map((m,p)=>({coordinate:n(m)+h,value:a?a[m]:m,index:p,offset:h}))}}},ci=V([tt,Wt,Fy,cC,sC,VK,FK,jt],zK),Uy=V([GP,YP,nK],(t,e,r)=>ZP(r.shared,t,e)),lC=t=>t.tooltip.settings.trigger,By=t=>t.tooltip.settings.defaultIndex,jh=V([Js,Uy,lC,By],tC),yc=V([jh,es],Vy),uC=V([ci,yc],XP),UK=V([jh],t=>{if(t)return t.dataKey}),dC=V([Js,Uy,lC,By],nC),BK=V([ii,ai,tt,Ht,ci,By,dC,Hc],rC),HK=V([jh,BK],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),WK=V([jh],t=>t.active),qK=V([dC,yc,Qa,Wt,uC,Hc,Uy],iC),KK=V([qK],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function Zw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Xw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Zw(Object(r),!0).forEach(function(n){GK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Zw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GK(t,e,r){return(e=YK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YK(t){var e=ZK(t,"string");return typeof e=="symbol"?e:e+""}function ZK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var XK=()=>ie(Wt),QK=()=>{var t=XK(),e=ie(ci),r=ie(cC);return Dm(Xw(Xw({},t),{},{scale:r}),e)},JK=()=>ie(Ty),Hy=(t,e)=>e,hC=(t,e,r)=>r,Wy=(t,e,r,n)=>n,eG=V(ci,t=>lh(t,e=>e.coordinate)),qy=V([Js,Hy,hC,Wy],tC),fC=V([qy,es],Vy),tG=(t,e,r)=>{if(e!=null){var n=Js(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},mC=V([Js,Hy,hC,Wy],nC),id=V([ii,ai,tt,Ht,ci,Wy,mC,Hc],rC),rG=V([qy,id],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),pC=V(ci,fC,XP),nG=V([mC,fC,Qa,Wt,pC,Hc,Hy],iC),iG=V([qy],t=>({isActive:t.active,activeIndex:t.index})),aG=(t,e,r,n,i,a,s,o)=>{if(!(!t||!e||!n||!i||!a)){var c=LB(t.chartX,t.chartY,e,r,o);if(c){var l=VB(c,e),u=SB(l,s,a,n,i),h=$B(e,a,u,c);return{activeIndex:String(u),activeCoordinate:h}}}};function tp(){return tp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},tp.apply(null,arguments)}function Qw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Bl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qw(Object(r),!0).forEach(function(n){sG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function sG(t,e,r){return(e=oG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oG(t){var e=cG(t,"string");return typeof e=="symbol"?e:e+""}function cG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lG(t){var{coordinate:e,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:c,chartName:l}=t,u=e,h=r,m=n;if(!o||!u||l!=="ScatterChart"&&c!=="axis")return null;var p,v;if(l==="ScatterChart")p=u,v=S8;else if(l==="BarChart")p=I8(s,u,i,a),v=aH;else if(s==="radial"){var{cx:b,cy:g,radius:_,startAngle:T,endAngle:E}=dI(u);p={cx:b,cy:g,startAngle:T,endAngle:E,innerRadius:_,outerRadius:_},v=lH}else p={points:uH(s,u,i)},v=nI;var j=typeof o=="object"&&"className"in o?o.className:void 0,R=Bl(Bl(Bl(Bl({stroke:"#ccc",pointerEvents:"none"},i),p),Ke(o,!1)),{},{payload:h,payloadIndex:m,className:Le("recharts-tooltip-cursor",j)});return w.isValidElement(o)?w.cloneElement(o,R):w.createElement(v,R)}function uG(t){var e=QK(),r=QS(),n=Xg(),i=JK();return w.createElement(lG,tp({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var gC=w.createContext(null),dG=()=>w.useContext(gC),yC={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function a(c,l,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||c,m),v=r?r+l:l;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},o.prototype.listeners=function(l){var u=r?r+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,v=new Array(p);m<p;m++)v[m]=h[m].fn;return v},o.prototype.listenerCount=function(l){var u=r?r+l:l,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,u,h,m,p,v){var b=r?r+l:l;if(!this._events[b])return!1;var g=this._events[b],_=arguments.length,T,E;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,m),!0;case 5:return g.fn.call(g.context,u,h,m,p),!0;case 6:return g.fn.call(g.context,u,h,m,p,v),!0}for(E=1,T=new Array(_-1);E<_;E++)T[E-1]=arguments[E];g.fn.apply(g.context,T)}else{var j=g.length,R;for(E=0;E<j;E++)switch(g[E].once&&this.removeListener(l,g[E].fn,void 0,!0),_){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,u);break;case 3:g[E].fn.call(g[E].context,u,h);break;case 4:g[E].fn.call(g[E].context,u,h,m);break;default:if(!T)for(R=1,T=new Array(_-1);R<_;R++)T[R-1]=arguments[R];g[E].fn.apply(g[E].context,T)}}return!0},o.prototype.on=function(l,u,h){return a(this,l,u,h,!1)},o.prototype.once=function(l,u,h){return a(this,l,u,h,!0)},o.prototype.removeListener=function(l,u,h,m){var p=r?r+l:l;if(!this._events[p])return this;if(!u)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===u&&(!m||v.once)&&(!h||v.context===h)&&s(this,p);else{for(var b=0,g=[],_=v.length;b<_;b++)(v[b].fn!==u||m&&!v[b].once||h&&v[b].context!==h)&&g.push(v[b]);g.length?this._events[p]=g.length===1?g[0]:g:s(this,p)}return this},o.prototype.removeAllListeners=function(l){var u;return l?(u=r?r+l:l,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(yC);var hG=yC.exports;const fG=Hi(hG);var vc=new fG,rp="recharts.syncEvent.tooltip",Jw="recharts.syncEvent.brush";function mG(t,e){if(e){var r=Number.parseInt(e,10);if(!Vr(r))return t?.[r]}}var pG={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},vC=Br({name:"options",initialState:pG,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),gG=vC.reducer,{createEventEmitter:yG}=vC.actions;function vG(t){return t.tooltip.syncInteraction}var bG={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},bC=Br({name:"chartData",initialState:bG,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:e_,setDataStartEndIndexes:xG,setComputedData:Vee}=bC.actions,wG=bC.reducer,xC=()=>{};function _G(){var t=ie(Ay),e=ie(Sy),r=sr(),n=ie(hP),i=ie(ci),a=Xg(),s=Zg(),o=ie(c=>c.rootProps.className);w.useEffect(()=>{if(t==null)return xC;var c=(l,u,h)=>{if(e!==h&&t===l){if(n==="index"){r(u);return}if(i!=null){var m;if(typeof n=="function"){var p={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},v=n(i,p);m=i[v]}else n==="value"&&(m=i.find(D=>String(D.value)===u.payload.label));var{coordinate:b}=u.payload;if(m==null||u.payload.active===!1||b==null||s==null){r(Jm({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:g,y:_}=b,T=Math.min(g,s.x+s.width),E=Math.min(_,s.y+s.height),j={x:a==="horizontal"?m.coordinate:T,y:a==="horizontal"?E:m.coordinate},R=Jm({active:u.payload.active,coordinate:j,dataKey:u.payload.dataKey,index:String(m.index),label:u.payload.label});r(R)}}};return vc.on(rp,c),()=>{vc.off(rp,c)}},[o,r,e,t,n,i,a,s])}function EG(){var t=ie(Ay),e=ie(Sy),r=sr();w.useEffect(()=>{if(t==null)return xC;var n=(i,a,s)=>{e!==s&&t===i&&r(xG(a))};return vc.on(Jw,n),()=>{vc.off(Jw,n)}},[r,e,t])}function TG(){var t=sr();w.useEffect(()=>{t(yG())},[t]),_G(),EG()}function AG(t,e,r,n,i,a){var s=ie(m=>tG(m,t,e)),o=ie(Sy),c=ie(Ay),l=ie(hP),u=ie(vG),h=u?.active;w.useEffect(()=>{if(!h&&c!=null&&o!=null){var m=Jm({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});vc.emit(rp,c,m,o)}},[h,r,s,i,n,o,c,l,a])}function t_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function r_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?t_(Object(r),!0).forEach(function(n){SG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):t_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function SG(t,e,r){return(e=IG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IG(t){var e=PG(t,"string");return typeof e=="symbol"?e:e+""}function PG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CG(t){return t.dataKey}function kG(t,e){return w.isValidElement(t)?w.cloneElement(t,e):typeof t=="function"?w.createElement(t,e):w.createElement(i8,e)}var n_=[],NG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Dc.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function i_(t){var e=Ya(t,NG),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:c,offset:l,payloadUniqBy:u,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:v,cursor:b,shared:g,trigger:_,defaultIndex:T,portal:E,axisId:j}=e,R=sr(),D=typeof T=="number"?String(T):T;w.useEffect(()=>{R(oK({shared:g,trigger:_,axisId:j,active:r,defaultIndex:D}))},[R,g,_,j,r,D]);var S=Zg(),A=rI(),P=rK(g),{activeIndex:O,isActive:N}=ie(Fe=>iG(Fe,P,_,D)),C=ie(Fe=>nG(Fe,P,_,D)),k=ie(Fe=>pC(Fe,P,_,D)),Q=ie(Fe=>rG(Fe,P,_,D)),oe=C,X=dG(),ee=r??N,[he,ye]=T9([oe,ee]),Ue=P==="axis"?k:void 0;AG(P,_,Q,Ue,O,ee);var se=E??X;if(se==null)return null;var q=oe??n_;ee||(q=n_),o&&q.length&&(q=UU(oe.filter(Fe=>Fe.value!=null&&(Fe.hide!==!0||e.includeHidden)),u,CG));var J=q.length>0,rt=w.createElement(d8,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:c,active:ee,coordinate:Q,hasPayload:J,offset:l,position:h,reverseDirection:m,useTranslate3d:p,viewBox:S,wrapperStyle:v,lastBoundingBox:he,innerRef:ye,hasPortalFromProps:!!E},kG(s,r_(r_({},e),{},{payload:q,label:Ue,active:ee,coordinate:Q,accessibilityLayer:A})));return w.createElement(w.Fragment,null,fp.createPortal(rt,se),ee&&w.createElement(uG,{cursor:b,tooltipEventType:P,coordinate:Q,payload:oe,index:O}))}var wC={},_C={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=0,i={}){typeof i!="object"&&(i={});let a=null,s=null,o=null,c=0,l=null,u;const{leading:h=!1,trailing:m=!0,maxWait:p}=i,v="maxWait"in i,b=v?Math.max(Number(p)||0,n):0,g=S=>(a!==null&&(u=r.apply(s,a)),a=s=null,c=S,u),_=S=>(c=S,l=setTimeout(R,n),h&&a!==null?g(S):u),T=S=>(l=null,m&&a!==null?g(S):u),E=S=>{if(o===null)return!0;const A=S-o,P=A>=n||A<0,O=v&&S-c>=b;return P||O},j=S=>{const A=o===null?0:S-o,P=n-A,O=b-(S-c);return v?Math.min(P,O):P},R=()=>{const S=Date.now();if(E(S))return T(S);l=setTimeout(R,j(S))},D=function(...S){const A=Date.now(),P=E(A);if(a=S,s=this,o=A,P){if(l===null)return _(A);if(v)return clearTimeout(l),l=setTimeout(R,n),g(A)}return l===null&&(l=setTimeout(R,n)),u};return D.cancel=()=>{l!==null&&clearTimeout(l),c=0,o=a=s=l=null},D.flush=()=>l===null?u:T(Date.now()),D}t.debounce=e})(_C);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_C;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return e.debounce(n,i,{leading:s,maxWait:i,trailing:o})}t.throttle=r})(wC);var jG=wC.throttle;const OG=Hi(jG);var qo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function a_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Cf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a_(Object(r),!0).forEach(function(n){RG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function RG(t,e,r){return(e=DG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DG(t){var e=MG(t,"string");return typeof e=="symbol"?e:e+""}function MG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var s_=w.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:c,children:l,debounce:u=0,id:h,className:m,onResize:p,style:v={}}=t,b=w.useRef(null),g=w.useRef();g.current=p,w.useImperativeHandle(e,()=>b.current);var[_,T]=w.useState({containerWidth:n.width,containerHeight:n.height}),E=w.useCallback((R,D)=>{T(S=>{var A=Math.round(R),P=Math.round(D);return S.containerWidth===A&&S.containerHeight===P?S:{containerWidth:A,containerHeight:P}})},[]);w.useEffect(()=>{var R=P=>{var O,{width:N,height:C}=P[0].contentRect;E(N,C),(O=g.current)===null||O===void 0||O.call(g,N,C)};u>0&&(R=OG(R,u,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),{width:S,height:A}=b.current.getBoundingClientRect();return E(S,A),D.observe(b.current),()=>{D.disconnect()}},[E,u]);var j=w.useMemo(()=>{var{containerWidth:R,containerHeight:D}=_;if(R<0||D<0)return null;qo(pa(i)||pa(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),qo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=pa(i)?R:i,A=pa(a)?D:a;return r&&r>0&&(S?A=S/r:A&&(S=A*r),c&&A>c&&(A=c)),qo(S>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,A,i,a,s,o,r),w.Children.map(l,P=>w.cloneElement(P,{width:S,height:A,style:Cf({width:S,height:A},P.props.style)}))},[r,l,a,c,o,s,_,i]);return w.createElement("div",{id:h?"".concat(h):void 0,className:Le("recharts-responsive-container",m),style:Cf(Cf({},v),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:c}),ref:b},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))});function o_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function np(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?o_(Object(r),!0).forEach(function(n){LG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LG(t,e,r){return(e=$G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $G(t){var e=VG(t,"string");return typeof e=="symbol"?e:e+""}function VG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ls={widthCache:{},cacheCount:0},FG=2e3,zG={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},c_="recharts_measurement_span";function UG(t){var e=np({},t);return Object.keys(e).forEach(r=>{e[r]||delete e[r]}),e}var Ko=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Dc.isSsr)return{width:0,height:0};var n=UG(r),i=JSON.stringify({text:e,copyStyle:n});if(ls.widthCache[i])return ls.widthCache[i];try{var a=document.getElementById(c_);a||(a=document.createElement("span"),a.setAttribute("id",c_),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=np(np({},zG),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),c={width:o.width,height:o.height};return ls.widthCache[i]=c,++ls.cacheCount>FG&&(ls.cacheCount=0,ls.widthCache={}),c}catch{return{width:0,height:0}}},l_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,u_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,BG=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,HG=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,EC={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},WG=Object.keys(EC),gs="NaN";function qG(t,e){return t*EC[e]}class cr{static parse(e){var r,[,n,i]=(r=HG.exec(e))!==null&&r!==void 0?r:[];return new cr(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Vr(e)&&(this.unit=""),r!==""&&!BG.test(r)&&(this.num=NaN,this.unit=""),WG.includes(r)&&(this.num=qG(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new cr(NaN,""):new cr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new cr(NaN,""):new cr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new cr(NaN,""):new cr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new cr(NaN,""):new cr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vr(this.num)}}function TC(t){if(t.includes(gs))return gs;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=l_.exec(e))!==null&&r!==void 0?r:[],s=cr.parse(n??""),o=cr.parse(a??""),c=i==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return gs;e=e.replace(l_,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var l,[,u,h,m]=(l=u_.exec(e))!==null&&l!==void 0?l:[],p=cr.parse(u??""),v=cr.parse(m??""),b=h==="+"?p.add(v):p.subtract(v);if(b.isNaN())return gs;e=e.replace(u_,b.toString())}return e}var d_=/\(([^()]*)\)/;function KG(t){for(var e=t,r;(r=d_.exec(e))!=null;){var[,n]=r;e=e.replace(d_,TC(n))}return e}function GG(t){var e=t.replace(/\s+/g,"");return e=KG(e),e=TC(e),e}function YG(t){try{return GG(t)}catch{return gs}}function kf(t){var e=YG(t.slice(5,-1));return e===gs?"":e}var ZG=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],XG=["dx","dy","angle","className","breakAll"];function ip(){return ip=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ip.apply(null,arguments)}function h_(t,e){if(t==null)return{};var r,n,i=QG(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function QG(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var AC=/[ \f\n\r\t\v\u2028\u2029]+/,SC=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];lt(e)||(r?i=e.toString().split(""):i=e.toString().split(AC));var a=i.map(o=>({word:o,width:Ko(o,n).width})),s=r?0:Ko(" ",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},JG=(t,e,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:c}=t,l=te(a),u=s,h=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((C,k)=>{var{word:Q,width:oe}=k,X=C[C.length-1];if(X&&(n==null||i||X.width+oe+r<Number(n)))X.words.push(Q),X.width+=oe+r;else{var ee={words:[Q],width:oe};C.push(ee)}return C},[])},m=h(e),p=O=>O.reduce((N,C)=>N.width>C.width?N:C);if(!l||i)return m;var v=m.length>a||p(m).width>Number(n);if(!v)return m;for(var b="…",g=O=>{var N=u.slice(0,O),C=SC({breakAll:c,style:o,children:N+b}).wordsWithComputedWidth,k=h(C),Q=k.length>a||p(k).width>Number(n);return[Q,k]},_=0,T=u.length-1,E=0,j;_<=T&&E<=u.length-1;){var R=Math.floor((_+T)/2),D=R-1,[S,A]=g(D),[P]=g(R);if(!S&&!P&&(_=R+1),S&&P&&(T=R-1),!S&&P){j=A;break}E++}return j||m},f_=t=>{var e=lt(t)?[]:t.toString().split(AC);return[{words:e}]},eY=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=t;if((e||r)&&!Dc.isSsr){var o,c,l=SC({breakAll:a,children:n,style:i});if(l){var{wordsWithComputedWidth:u,spaceWidth:h}=l;o=u,c=h}else return f_(n);return JG({breakAll:a,children:n,maxLines:s,style:i},o,c,e,r)}return f_(n)},m_="#808080",Ky=w.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:l=m_}=t,u=h_(t,ZG),h=w.useMemo(()=>eY({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:m,dy:p,angle:v,className:b,breakAll:g}=u,_=h_(u,XG);if(!In(r)||!In(n))return null;var T=r+(te(m)?m:0),E=n+(te(p)?p:0),j;switch(c){case"start":j=kf("calc(".concat(a,")"));break;case"middle":j=kf("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:j=kf("calc(".concat(h.length-1," * -").concat(i,")"));break}var R=[];if(s){var D=h[0].width,{width:S}=u;R.push("scale(".concat(te(S)?S/D:1,")"))}return v&&R.push("rotate(".concat(v,", ").concat(T,", ").concat(E,")")),R.length&&(_.transform=R.join(" ")),w.createElement("text",ip({},Ke(_,!0),{ref:e,x:T,y:E,className:Le("recharts-text",b),textAnchor:o,fill:l.includes("url")?m_:l}),h.map((A,P)=>{var O=A.words.join(g?"":" ");return w.createElement("tspan",{x:T,dy:P===0?j:i,key:"".concat(O,"-").concat(P)},O)}))});Ky.displayName="Text";var tY=["offset"],rY=["labelRef"];function p_(t,e){if(t==null)return{};var r,n,i=nY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function nY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function g_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?g_(Object(r),!0).forEach(function(n){iY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function iY(t,e,r){return(e=aY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aY(t){var e=sY(t,"string");return typeof e=="symbol"?e:e+""}function sY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $n(){return $n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$n.apply(null,arguments)}var oY=t=>{var{value:e,formatter:r}=t,n=lt(t.children)?e:t.children;return typeof r=="function"?r(n):n},Gy=t=>t!=null&&typeof t=="function",cY=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),360);return r*n},lY=(t,e,r)=>{var{position:n,viewBox:i,offset:a,className:s}=t,{cx:o,cy:c,innerRadius:l,outerRadius:u,startAngle:h,endAngle:m,clockWise:p}=i,v=(l+u)/2,b=cY(h,m),g=b>=0?1:-1,_,T;n==="insideStart"?(_=h+g*a,T=p):n==="insideEnd"?(_=m-g*a,T=!p):n==="end"&&(_=m+g*a,T=p),T=b<=0?T:!T;var E=Ut(o,c,v,_),j=Ut(o,c,v,_+(T?1:-1)*359),R="M".concat(E.x,",").concat(E.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(T?0:1,`,
    `).concat(j.x,",").concat(j.y),D=lt(t.id)?uc("recharts-radial-line-"):t.id;return w.createElement("text",$n({},r,{dominantBaseline:"central",className:Le("recharts-radial-bar-label",s)}),w.createElement("defs",null,w.createElement("path",{id:D,d:R})),w.createElement("textPath",{xlinkHref:"#".concat(D)},e))},uY=t=>{var{viewBox:e,offset:r,position:n}=t,{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:c,endAngle:l}=e,u=(c+l)/2;if(n==="outside"){var{x:h,y:m}=Ut(i,a,o+r,u);return{x:h,y:m,textAnchor:h>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:v,y:b}=Ut(i,a,p,u);return{x:v,y:b,textAnchor:"middle",verticalAnchor:"middle"}},dY=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,{x:a,y:s,width:o,height:c}=e,l=c>=0?1:-1,u=l*n,h=l>0?"end":"start",m=l>0?"start":"end",p=o>=0?1:-1,v=p*n,b=p>0?"end":"start",g=p>0?"start":"end";if(i==="top"){var _={x:a+o/2,y:s-l*n,textAnchor:"middle",verticalAnchor:h};return ft(ft({},_),r?{height:Math.max(s-r.y,0),width:o}:{})}if(i==="bottom"){var T={x:a+o/2,y:s+c+u,textAnchor:"middle",verticalAnchor:m};return ft(ft({},T),r?{height:Math.max(r.y+r.height-(s+c),0),width:o}:{})}if(i==="left"){var E={x:a-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"};return ft(ft({},E),r?{width:Math.max(E.x-r.x,0),height:c}:{})}if(i==="right"){var j={x:a+o+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return ft(ft({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:c}:{})}var R=r?{width:o,height:c}:{};return i==="insideLeft"?ft({x:a+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},R):i==="insideRight"?ft({x:a+o-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"},R):i==="insideTop"?ft({x:a+o/2,y:s+u,textAnchor:"middle",verticalAnchor:m},R):i==="insideBottom"?ft({x:a+o/2,y:s+c-u,textAnchor:"middle",verticalAnchor:h},R):i==="insideTopLeft"?ft({x:a+v,y:s+u,textAnchor:g,verticalAnchor:m},R):i==="insideTopRight"?ft({x:a+o-v,y:s+u,textAnchor:b,verticalAnchor:m},R):i==="insideBottomLeft"?ft({x:a+v,y:s+c-u,textAnchor:g,verticalAnchor:h},R):i==="insideBottomRight"?ft({x:a+o-v,y:s+c-u,textAnchor:b,verticalAnchor:h},R):i&&typeof i=="object"&&(te(i.x)||pa(i.x))&&(te(i.y)||pa(i.y))?ft({x:a+Fi(i.x,o),y:s+Fi(i.y,c),textAnchor:"end",verticalAnchor:"end"},R):ft({x:a+o/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},R)},hY=t=>"cx"in t&&te(t.cx);function wr(t){var{offset:e=5}=t,r=p_(t,tY),n=ft({offset:e},r),{viewBox:i,position:a,value:s,children:o,content:c,className:l="",textBreakAll:u,labelRef:h}=n,m=Zg(),p=i||m;if(!p||lt(s)&&lt(o)&&!w.isValidElement(c)&&typeof c!="function")return null;if(w.isValidElement(c)){var{labelRef:v}=n,b=p_(n,rY);return w.cloneElement(c,b)}var g;if(typeof c=="function"){if(g=w.createElement(c,n),w.isValidElement(g))return g}else g=oY(n);var _=hY(p),T=Ke(n,!0);if(_&&(a==="insideStart"||a==="insideEnd"||a==="end"))return lY(n,g,T);var E=_?uY(n):dY(n,p);return w.createElement(Ky,$n({ref:h,className:Le("recharts-label",l)},T,E,{breakAll:u}),g)}wr.displayName="Label";var IC=t=>{var{cx:e,cy:r,angle:n,startAngle:i,endAngle:a,r:s,radius:o,innerRadius:c,outerRadius:l,x:u,y:h,top:m,left:p,width:v,height:b,clockWise:g,labelViewBox:_}=t;if(_)return _;if(te(v)&&te(b)){if(te(u)&&te(h))return{x:u,y:h,width:v,height:b};if(te(m)&&te(p))return{x:m,y:p,width:v,height:b}}if(te(u)&&te(h))return{x:u,y:h,width:0,height:0};if(te(e)&&te(r))return{cx:e,cy:r,startAngle:i||n||0,endAngle:a||n||0,innerRadius:c||0,outerRadius:l||o||s||0,clockWise:g};if(t.viewBox)return t.viewBox},fY=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?w.createElement(wr,$n({key:"label-implicit"},n)):In(t)?w.createElement(wr,$n({key:"label-implicit",value:t},n)):w.isValidElement(t)?t.type===wr?w.cloneElement(t,ft({key:"label-implicit"},n)):w.createElement(wr,$n({key:"label-implicit",content:t},n)):Gy(t)?w.createElement(wr,$n({key:"label-implicit",content:t},n)):t&&typeof t=="object"?w.createElement(wr,$n({},t,{key:"label-implicit"},n)):null},mY=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:i,labelRef:a}=e,s=IC(e),o=zA(i,wr).map((l,u)=>w.cloneElement(l,{viewBox:r||s,key:"label-".concat(u)}));if(!n)return o;var c=fY(e.label,r||s,a);return[c,...o]};wr.parseViewBox=IC;wr.renderCallByParent=mY;var PC={},CC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(CC);var kC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(kC);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=CC,r=kC,n=ih;function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(PC);var pY=PC.last;const gY=Hi(pY);var yY=["valueAccessor"],vY=["data","dataKey","clockWise","id","textBreakAll"];function ad(){return ad=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ad.apply(null,arguments)}function y_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function v_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?y_(Object(r),!0).forEach(function(n){bY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function bY(t,e,r){return(e=xY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xY(t){var e=wY(t,"string");return typeof e=="symbol"?e:e+""}function wY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b_(t,e){if(t==null)return{};var r,n,i=_Y(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function _Y(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var EY=t=>Array.isArray(t.value)?gY(t.value):t.value;function Ia(t){var{valueAccessor:e=EY}=t,r=b_(t,yY),{data:n,dataKey:i,clockWise:a,id:s,textBreakAll:o}=r,c=b_(r,vY);return!n||!n.length?null:w.createElement(zi,{className:"recharts-label-list"},n.map((l,u)=>{var h=lt(i)?e(l,u):Ar(l&&l.payload,i),m=lt(s)?{}:{id:"".concat(s,"-").concat(u)};return w.createElement(wr,ad({},Ke(l,!0),c,m,{parentViewBox:l.parentViewBox,value:h,textBreakAll:o,viewBox:wr.parseViewBox(lt(a)?l:v_(v_({},l),{},{clockWise:a})),key:"label-".concat(u),index:u}))}))}Ia.displayName="LabelList";function TY(t,e){return t?t===!0?w.createElement(Ia,{key:"labelList-implicit",data:e}):w.isValidElement(t)||Gy(t)?w.createElement(Ia,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?w.createElement(Ia,ad({data:e},t,{key:"labelList-implicit"})):null:null}function AY(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:n}=t,i=zA(n,Ia).map((s,o)=>w.cloneElement(s,{data:e,key:"labelList-".concat(o)}));if(!r)return i;var a=TY(t.label,e);return[a,...i]}Ia.renderCallByParent=AY;function ap(){return ap=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ap.apply(null,arguments)}var NC=t=>{var{cx:e,cy:r,r:n,className:i}=t,a=Le("recharts-dot",i);return e===+e&&r===+r&&n===+n?w.createElement("circle",ap({},Ke(t,!1),Og(t),{className:a,cx:e,cy:r,r:n})):null},SY={radiusAxis:{},angleAxis:{}},jC=Br({name:"polarAxis",initialState:SY,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:Fee,removeRadiusAxis:zee,addAngleAxis:Uee,removeAngleAxis:Bee}=jC.actions,IY=jC.reducer,PY={countOfBars:0,cartesianItems:[],polarItems:[]},OC=Br({name:"graphicalItems",initialState:PY,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,i=Bn(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},removeCartesianGraphicalItem(t,e){var r=Bn(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Bn(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addBar:Hee,removeBar:Wee,addCartesianGraphicalItem:CY,replaceCartesianGraphicalItem:kY,removeCartesianGraphicalItem:NY,addPolarGraphicalItem:qee,removePolarGraphicalItem:Kee}=OC.actions,jY=OC.reducer;function x_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function w_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?x_(Object(r),!0).forEach(function(n){OY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function OY(t,e,r){return(e=RY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RY(t){var e=DY(t,"string");return typeof e=="symbol"?e:e+""}function DY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MY(t){var e=sr(),r=w.useRef(null);return w.useEffect(()=>{var n=w_(w_({},t),{},{stackId:OB(t.stackId)});r.current===null?e(CY(n)):r.current!==n&&e(kY({prev:r.current,next:n})),r.current=n},[e,t]),w.useEffect(()=>()=>{r.current&&(e(NY(r.current)),r.current=null)},[e]),null}function LY(t){var{fn:e,args:r}=t,n=sr(),i=mr();return w.useEffect(()=>{if(!i){var a=e(r);return n(aK(a)),()=>{n(sK(a))}}},[e,r,n,i]),null}var $Y=()=>{};function VY(t){var{legendPayload:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?$Y:(r(XB(e)),()=>{r(QB(e))}),[r,n,e]),null}function FY(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(uc(e)),n=w.useRef(t);return n.current!==t&&(r.current=uc(e),n.current=t),r.current}var zY=V([Ht],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),UY=V([zY,ii,ai],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),BY=t=>{var e=mr();return ie(r=>kh(r,"xAxis",t,e))},HY=t=>{var e=mr();return ie(r=>kh(r,"yAxis",t,e))},Yy=()=>ie(UY),WY=()=>ie(KK);function __(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function E_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?__(Object(r),!0).forEach(function(n){qY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):__(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qY(t,e,r){return(e=KY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KY(t){var e=GY(t,"string");return typeof e=="symbol"?e:e+""}function GY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YY=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=t;if(i===!1||e.x==null||e.y==null)return null;var s=E_(E_({index:r,dataKey:a,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},Ke(i,!1)),Og(i)),o;return w.isValidElement(i)?o=w.cloneElement(i,s):typeof i=="function"?o=i(s):o=w.createElement(NC,s),w.createElement(zi,{className:"recharts-active-dot"},o)};function ZY(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:i}=t,a=ie(yc),s=WY();if(e==null||s==null)return null;var o=e.find(c=>s.includes(c.payload));return lt(o)?null:YY({point:o,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var XY=["children"];function QY(t,e){if(t==null)return{};var r,n,i=JY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function JY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var T_=()=>{},RC=w.createContext({addErrorBar:T_,removeErrorBar:T_}),eZ={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},DC=w.createContext(eZ);function tZ(t){var{children:e}=t,r=QY(t,XY);return w.createElement(DC.Provider,{value:r},e)}var rZ=()=>w.useContext(DC),nZ=t=>{var{children:e,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,data:s,stackId:o,hide:c,type:l,barSize:u}=t,[h,m]=w.useState([]),p=w.useCallback(g=>{m(_=>[..._,g])},[m]),v=w.useCallback(g=>{m(_=>_.filter(T=>T!==g))},[m]),b=mr();return w.createElement(RC.Provider,{value:{addErrorBar:p,removeErrorBar:v}},w.createElement(MY,{type:l,data:s,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,errorBars:h,stackId:o,hide:c,barSize:u,isPanorama:b}),e)};function iZ(t){var{addErrorBar:e,removeErrorBar:r}=w.useContext(RC);return w.useEffect(()=>(e(t),()=>{r(t)}),[e,r,t]),null}var aZ=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function MC(t,e,r){return(e=sZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:e+""}function oZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bc(){return bc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bc.apply(null,arguments)}function cZ(t,e){if(t==null)return{};var r,n,i=lZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function lZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function uZ(t){var{direction:e,width:r,dataKey:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o}=t,c=cZ(t,aZ),l=Ke(c,!1),{data:u,dataPointFormatter:h,xAxisId:m,yAxisId:p,errorBarOffset:v}=rZ(),b=BY(m),g=HY(p);if(b?.scale==null||g?.scale==null||u==null||e==="x"&&b.type!=="number")return null;var _=u.map(T=>{var{x:E,y:j,value:R,errorVal:D}=h(T,n,e);if(!D)return null;var S=[],A,P;if(Array.isArray(D)?[A,P]=D:A=P=D,e==="x"){var{scale:O}=b,N=j+v,C=N+r,k=N-r,Q=O(R-A),oe=O(R+P);S.push({x1:oe,y1:C,x2:oe,y2:k}),S.push({x1:Q,y1:N,x2:oe,y2:N}),S.push({x1:Q,y1:C,x2:Q,y2:k})}else if(e==="y"){var{scale:X}=g,ee=E+v,he=ee-r,ye=ee+r,Ue=X(R-A),se=X(R+P);S.push({x1:he,y1:se,x2:ye,y2:se}),S.push({x1:ee,y1:Ue,x2:ee,y2:se}),S.push({x1:he,y1:Ue,x2:ye,y2:Ue})}var q="".concat(E+v,"px ").concat(j+v,"px");return w.createElement(zi,bc({className:"recharts-errorBar",key:"bar-".concat(S.map(J=>"".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2)))},l),S.map(J=>{var rt=i?{transformOrigin:"".concat(J.x1-5,"px")}:void 0;return w.createElement(Wu,{from:{transform:"scaleY(0)",transformOrigin:q},to:{transform:"scaleY(1)",transformOrigin:q},begin:a,easing:o,isActive:i,duration:s,key:"line-".concat(J.x1,"-").concat(J.x2,"-").concat(J.y1,"-").concat(J.y2),style:{transformOrigin:q}},w.createElement("line",bc({},J,{style:rt})))}))});return w.createElement(zi,{className:"recharts-errorBars"},_)}var LC=w.createContext(void 0);function dZ(t){var e=w.useContext(LC);return t??e??"x"}function hZ(t){var{direction:e,children:r}=t;return w.createElement(LC.Provider,{value:e},r)}var $C={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function fZ(t){var e=dZ(t.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s}=Ya(t,$C);return w.createElement(w.Fragment,null,w.createElement(iZ,{dataKey:t.dataKey,direction:e}),w.createElement(uZ,bc({},t,{direction:e,width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s})))}class VC extends w.Component{render(){return w.createElement(fZ,this.props)}}MC(VC,"defaultProps",$C);MC(VC,"displayName","ErrorBar");function FC(t,e){var r,n,i=ie(l=>oi(l,t)),a=ie(l=>Xi(l,e)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:vr.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:br.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function mZ(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=Yy(),{needClipX:a,needClipY:s,needClip:o}=FC(e,r);if(!o)return null;var{x:c,y:l,width:u,height:h}=i;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?c:c-u/2,y:s?l:l-h/2,width:a?u:u*2,height:s?h:h*2}))}var pZ=t=>{var{chartData:e}=t,r=sr(),n=mr();return w.useEffect(()=>n?()=>{}:(r(e_(e)),()=>{r(e_(void 0))}),[e,r,n]),null},A_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},zC=Br({name:"brush",initialState:A_,reducers:{setBrushSettings(t,e){return e.payload==null?A_:e.payload}}}),{setBrushSettings:Gee}=zC.actions,gZ=zC.reducer;function yZ(t,e,r){return(e=vZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vZ(t){var e=bZ(t,"string");return typeof e=="symbol"?e:e+""}function bZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zy{static create(e){return new Zy(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}yZ(Zy,"EPS",1e-4);function xZ(t){return(t%180+180)%180}var wZ=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=xZ(i),s=a*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},_Z={dots:[],areas:[],lines:[]},UC=Br({name:"referenceElements",initialState:_Z,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Bn(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Bn(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Bn(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:Yee,removeDot:Zee,addArea:Xee,removeArea:Qee,addLine:Jee,removeLine:ete}=UC.actions,EZ=UC.reducer,TZ=w.createContext(void 0),AZ=t=>{var{children:e}=t,[r]=w.useState("".concat(uc("recharts"),"-clip")),n=Yy();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return w.createElement(TZ.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:i,y:a,height:o,width:s}))),e)};function Nf(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function BC(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function SZ(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return wZ(n,r)}function IZ(t,e,r){var n=r==="width",{x:i,y:a,width:s,height:o}=t;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function sd(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function PZ(t,e){return BC(t,e+1)}function CZ(t,e,r,n,i){for(var a=(n||[]).slice(),{start:s,end:o}=e,c=0,l=1,u=s,h=function(){var v=n?.[c];if(v===void 0)return{v:BC(n,l)};var b=c,g,_=()=>(g===void 0&&(g=r(v,b)),g),T=v.coordinate,E=c===0||sd(t,T,_,u,o);E||(c=0,u=s,l+=1),E&&(u=T+t*(_()/2+i),c+=l)},m;l<=a.length;)if(m=h(),m)return m.v;return[]}function S_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?S_(Object(r),!0).forEach(function(n){kZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):S_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kZ(t,e,r){return(e=NZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:e+""}function jZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OZ(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:o}=e,{end:c}=e,l=function(m){var p=a[m],v,b=()=>(v===void 0&&(v=r(p,m)),v);if(m===s-1){var g=t*(p.coordinate+t*b()/2-c);a[m]=p=Zt(Zt({},p),{},{tickCoord:g>0?p.coordinate-g*t:p.coordinate})}else a[m]=p=Zt(Zt({},p),{},{tickCoord:p.coordinate});var _=sd(t,p.tickCoord,b,o,c);_&&(c=p.tickCoord-t*(b()/2+i),a[m]=Zt(Zt({},p),{},{isShow:!0}))},u=s-1;u>=0;u--)l(u);return a}function RZ(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,{start:c,end:l}=e;if(a){var u=n[o-1],h=r(u,o-1),m=t*(u.coordinate+t*h/2-l);s[o-1]=u=Zt(Zt({},u),{},{tickCoord:m>0?u.coordinate-m*t:u.coordinate});var p=sd(t,u.tickCoord,()=>h,c,l);p&&(l=u.tickCoord-t*(h/2+i),s[o-1]=Zt(Zt({},u),{},{isShow:!0}))}for(var v=a?o-1:o,b=function(T){var E=s[T],j,R=()=>(j===void 0&&(j=r(E,T)),j);if(T===0){var D=t*(E.coordinate-t*R()/2-c);s[T]=E=Zt(Zt({},E),{},{tickCoord:D<0?E.coordinate-D*t:E.coordinate})}else s[T]=E=Zt(Zt({},E),{},{tickCoord:E.coordinate});var S=sd(t,E.tickCoord,R,c,l);S&&(c=E.tickCoord+t*(R()/2+i),s[T]=Zt(Zt({},E),{},{isShow:!0}))},g=0;g<v;g++)b(g);return s}function Xy(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:o,interval:c,tickFormatter:l,unit:u,angle:h}=t;if(!i||!i.length||!n)return[];if(te(c)||Dc.isSsr){var m;return(m=PZ(i,te(c)?c:0))!==null&&m!==void 0?m:[]}var p=[],v=o==="top"||o==="bottom"?"width":"height",b=u&&v==="width"?Ko(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(E,j)=>{var R=typeof l=="function"?l(E.value,j):E.value;return v==="width"?SZ(Ko(R,{fontSize:e,letterSpacing:r}),b,h):Ko(R,{fontSize:e,letterSpacing:r})[v]},_=i.length>=2?Lr(i[1].coordinate-i[0].coordinate):1,T=IZ(a,_,v);return c==="equidistantPreserveStart"?CZ(_,T,g,i,s):(c==="preserveStart"||c==="preserveStartEnd"?p=RZ(_,T,g,i,s,c==="preserveStartEnd"):p=OZ(_,T,g,i,s),p.filter(E=>E.isShow))}var DZ=["viewBox"],MZ=["viewBox"];function ys(){return ys=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ys.apply(null,arguments)}function I_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function xt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?I_(Object(r),!0).forEach(function(n){Qy(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function P_(t,e){if(t==null)return{};var r,n,i=LZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function LZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function Qy(t,e,r){return(e=$Z(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Z(t){var e=VZ(t,"string");return typeof e=="symbol"?e:e+""}function VZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qi extends w.Component{constructor(e){super(e),this.tickRefs=w.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,r){var{viewBox:n}=e,i=P_(e,DZ),a=this.props,{viewBox:s}=a,o=P_(a,MZ);return!Nf(n,s)||!Nf(i,o)||!Nf(r,this.state)}getTickLineCoord(e){var{x:r,y:n,width:i,height:a,orientation:s,tickSize:o,mirror:c,tickMargin:l}=this.props,u,h,m,p,v,b,g=c?-1:1,_=e.tickSize||o,T=te(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=h=e.coordinate,p=n+ +!c*a,m=p-g*_,b=m-g*l,v=T;break;case"left":m=p=e.coordinate,h=r+ +!c*i,u=h-g*_,v=u-g*l,b=T;break;case"right":m=p=e.coordinate,h=r+ +c*i,u=h+g*_,v=u+g*l,b=T;break;default:u=h=e.coordinate,p=n+ +c*a,m=p+g*_,b=m+g*l,v=T;break}return{line:{x1:u,y1:m,x2:h,y2:p},tick:{x:v,y:b}}}getTickTextAnchor(){var{orientation:e,mirror:r}=this.props,n;switch(e){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:e,mirror:r}=this.props;switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:e,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:o}=this.props,c=xt(xt(xt({},Ke(this.props,!1)),Ke(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var l=+(a==="top"&&!s||a==="bottom"&&s);c=xt(xt({},c),{},{x1:e,y1:r+l*i,x2:e+n,y2:r+l*i})}else{var u=+(a==="left"&&!s||a==="right"&&s);c=xt(xt({},c),{},{x1:e+u*n,y1:r,x2:e+u*n,y2:r+i})}return w.createElement("line",ys({},c,{className:Le("recharts-cartesian-axis-line",Va(o,"className"))}))}static renderTickItem(e,r,n){var i,a=Le(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(e))i=w.cloneElement(e,xt(xt({},r),{},{className:a}));else if(typeof e=="function")i=e(xt(xt({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=Le(s,e.className)),i=w.createElement(Ky,ys({},r,{className:s}),n)}return i}renderTicks(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:a,tick:s,tickFormatter:o,unit:c}=this.props,l=Xy(xt(xt({},this.props),{},{ticks:n}),e,r),u=this.getTickTextAnchor(),h=this.getTickVerticalAnchor(),m=Ke(this.props,!1),p=Ke(s,!1),v=xt(xt({},m),{},{fill:"none"},Ke(i,!1)),b=l.map((g,_)=>{var{line:T,tick:E}=this.getTickLineCoord(g),j=xt(xt(xt(xt({textAnchor:u,verticalAnchor:h},m),{},{stroke:"none",fill:a},p),E),{},{index:_,payload:g,visibleTicksCount:l.length,tickFormatter:o});return w.createElement(zi,ys({className:"recharts-cartesian-axis-tick",key:"tick-".concat(g.value,"-").concat(g.coordinate,"-").concat(g.tickCoord)},uU(this.props,g,_)),i&&w.createElement("line",ys({},v,T,{className:Le("recharts-cartesian-axis-tick-line",Va(i,"className"))})),s&&Qi.renderTickItem(s,j,"".concat(typeof o=="function"?o(g.value,_):g.value).concat(c||"")))});return b.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:e,width:r,height:n,className:i,hide:a}=this.props;if(a)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:w.createElement(zi,{className:Le("recharts-cartesian-axis",i),ref:o=>{if(o){var c=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(c);var l=c[0];if(l){var u=window.getComputedStyle(l).fontSize,h=window.getComputedStyle(l).letterSpacing;(u!==this.state.fontSize||h!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(l).fontSize,letterSpacing:window.getComputedStyle(l).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),wr.renderCallByParent(this.props))}}Qy(Qi,"displayName","CartesianAxis");Qy(Qi,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var FZ=["x1","y1","x2","y2","key"],zZ=["offset"],UZ=["xAxisId","yAxisId"],BZ=["xAxisId","yAxisId"];function C_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?C_(Object(r),!0).forEach(function(n){HZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HZ(t,e,r){return(e=WZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WZ(t){var e=qZ(t,"string");return typeof e=="symbol"?e:e+""}function qZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ba(){return ba=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ba.apply(null,arguments)}function od(t,e){if(t==null)return{};var r,n,i=KZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function KZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var GZ=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:o}=t;return w.createElement("rect",{x:n,y:i,ry:o,width:a,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function HC(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:i,x2:a,y2:s,key:o}=e,c=od(e,FZ),l=Ke(c,!1),{offset:u}=l,h=od(l,zZ);r=w.createElement("line",ba({},h,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function YZ(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=od(t,UZ),c=i.map((l,u)=>{var h=Jt(Jt({},o),{},{x1:e,y1:l,x2:e+r,y2:l,key:"line-".concat(u),index:u});return HC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function ZZ(t){var{y:e,height:r,vertical:n=!0,verticalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=od(t,BZ),c=i.map((l,u)=>{var h=Jt(Jt({},o),{},{x1:l,y1:e,x2:l,y2:e+r,key:"line-".concat(u),index:u});return HC(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function XZ(t){var{horizontalFill:e,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:o,horizontal:c=!0}=t;if(!c||!e||!e.length)return null;var l=o.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var u=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%e.length;return w.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:v,width:a,stroke:"none",fill:e[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function QZ(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,verticalPoints:c}=t;if(!e||!r||!r.length)return null;var l=c.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var u=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%r.length;return w.createElement("rect",{key:"react-".concat(m),x:h,y:a,width:v,height:o,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var JZ=(t,e)=>{var{xAxis:r,width:n,height:i,offset:a}=t;return KS(Xy(Jt(Jt(Jt({},Qi.defaultProps),r),{},{ticks:GS(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,e)},eX=(t,e)=>{var{yAxis:r,width:n,height:i,offset:a}=t;return KS(Xy(Jt(Jt(Jt({},Qi.defaultProps),r),{},{ticks:GS(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,e)},tX={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function sp(t){var e=JS(),r=eI(),n=QS(),i=Jt(Jt({},Ya(t,tX)),{},{x:te(t.x)?t.x:n.left,y:te(t.y)?t.y:n.top,width:te(t.width)?t.width:n.width,height:te(t.height)?t.height:n.height}),{xAxisId:a,yAxisId:s,x:o,y:c,width:l,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,v=mr(),b=ie(P=>qw(P,"xAxis",a,v)),g=ie(P=>qw(P,"yAxis",s,v));if(!te(l)||l<=0||!te(u)||u<=0||!te(o)||o!==+o||!te(c)||c!==+c)return null;var _=i.verticalCoordinatesGenerator||JZ,T=i.horizontalCoordinatesGenerator||eX,{horizontalPoints:E,verticalPoints:j}=i;if((!E||!E.length)&&typeof T=="function"){var R=m&&m.length,D=T({yAxis:g?Jt(Jt({},g),{},{ticks:R?m:g.ticks}):void 0,width:e,height:r,offset:n},R?!0:h);qo(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(E=D)}if((!j||!j.length)&&typeof _=="function"){var S=p&&p.length,A=_({xAxis:b?Jt(Jt({},b),{},{ticks:S?p:b.ticks}):void 0,width:e,height:r,offset:n},S?!0:h);qo(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(j=A)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(GZ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),w.createElement(XZ,ba({},i,{horizontalPoints:E})),w.createElement(QZ,ba({},i,{verticalPoints:j})),w.createElement(YZ,ba({},i,{offset:n,horizontalPoints:E,xAxis:b,yAxis:g})),w.createElement(ZZ,ba({},i,{offset:n,verticalPoints:j,xAxis:b,yAxis:g})))}sp.displayName="CartesianGrid";var WC=(t,e,r,n)=>kh(t,"xAxis",e,n),qC=(t,e,r,n)=>KP(t,"xAxis",e,n),KC=(t,e,r,n)=>kh(t,"yAxis",r,n),GC=(t,e,r,n)=>KP(t,"yAxis",r,n),rX=V([tt,WC,KC,qC,GC],(t,e,r,n,i)=>Gi(t,"xAxis")?Dm(e,n,!1):Dm(r,i,!1)),nX=(t,e,r,n,i)=>i,iX=V([bP,nX],(t,e)=>{if(t.some(r=>r.type==="line"&&e.dataKey===r.dataKey&&e.data===r.data))return e}),aX=V([tt,WC,KC,qC,GC,iX,rX,XI],(t,e,r,n,i,a,s,o)=>{var{chartData:c,dataStartIndex:l,dataEndIndex:u}=o;if(!(a==null||e==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:h,data:m}=a,p;if(m!=null&&m.length>0?p=m:p=c?.slice(l,u+1),p!=null)return TX({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:h,bandSize:s,displayedData:p})}}),sX=["type","layout","connectNulls","needClip"],oX=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function YC(t,e){if(t==null)return{};var r,n,i=cX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function cX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function k_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?k_(Object(r),!0).forEach(function(n){Oh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Oh(t,e,r){return(e=lX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lX(t){var e=uX(t,"string");return typeof e=="symbol"?e:e+""}function uX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fs(){return Fs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Fs.apply(null,arguments)}var dX=t=>{var{dataKey:e,name:r,stroke:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:YS(r,e),payload:t}]};function hX(t){var{dataKey:e,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:c}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:e,nameKey:void 0,name:YS(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:c}}}var ZC=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function fX(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],i=0;i<e;++i)n=[...n,...r];return n}var mX=(t,e,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return ZC(e,t);for(var i=Math.floor(t/n),a=t%n,s=e-t,o=[],c=0,l=0;c<r.length;l+=r[c],++c)if(l+r[c]>a){o=[...r.slice(0,c),a-l];break}var u=o.length%2===0?[0,s]:[s];return[...fX(r,i),...o,...u].map(h=>"".concat(h,"px")).join(", ")};function pX(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=Le("recharts-line-dot",typeof t!="boolean"?t.className:"");r=w.createElement(NC,Fs({},e,{className:n}))}return r}function gX(t,e){return t==null?!1:e?!0:t.length===1}function yX(t){var{clipPathId:e,points:r,props:n}=t,{dot:i,dataKey:a,needClip:s}=n;if(!gX(r,i))return null;var o=UA(i),c=Ke(n,!1),l=Ke(i,!0),u=r.map((m,p)=>{var v=Kr(Kr(Kr({key:"dot-".concat(p),r:3},c),l),{},{index:p,cx:m.x,cy:m.y,dataKey:a,value:m.value,payload:m.payload,points:r});return pX(i,v)}),h={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):null};return w.createElement(zi,Fs({className:"recharts-line-dots",key:"dots"},h),u)}function op(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:i,props:a,showLabels:s}=t,{type:o,layout:c,connectNulls:l,needClip:u}=a,h=YC(a,sX),m=Kr(Kr({},Ke(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):null,points:n,type:o,layout:c,connectNulls:l,strokeDasharray:i??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(nI,Fs({},m,{pathRef:r})),w.createElement(yX,{points:n,clipPathId:e,props:a}),s&&Ia.renderCallByParent(a,n))}function vX(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function bX(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=t,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:l,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:v,onAnimationEnd:b,onAnimationStart:g}=r,_=i.current,T=FY(r,"recharts-line-"),[E,j]=w.useState(!1),R=w.useCallback(()=>{typeof b=="function"&&b(),j(!1)},[b]),D=w.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),S=vX(n.current),A=a.current;return w.createElement(Wu,{begin:l,duration:u,isActive:c,easing:h,from:{t:0},to:{t:1},onAnimationEnd:R,onAnimationStart:D,key:T},P=>{var{t:O}=P,N=xo(A,S+A),C=Math.min(N(O),S),k;if(o){var Q="".concat(o).split(/[,\s]+/gim).map(ee=>parseFloat(ee));k=mX(C,S,Q)}else k=ZC(S,C);if(_){var oe=_.length/s.length,X=O===1?s:s.map((ee,he)=>{var ye=Math.floor(he*oe);if(_[ye]){var Ue=_[ye],se=xo(Ue.x,ee.x),q=xo(Ue.y,ee.y);return Kr(Kr({},ee),{},{x:se(O),y:q(O)})}if(m){var J=xo(p*2,ee.x),rt=xo(v/2,ee.y);return Kr(Kr({},ee),{},{x:J(O),y:rt(O)})}return Kr(Kr({},ee),{},{x:ee.x,y:ee.y})});return i.current=X,w.createElement(op,{props:r,points:X,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})}return O>0&&S>0&&(i.current=s,a.current=C),w.createElement(op,{props:r,points:s,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})})}function xX(t){var{clipPathId:e,props:r}=t,{points:n,isAnimationActive:i}=r,a=w.useRef(null),s=w.useRef(0),o=w.useRef(null),c=a.current;return i&&n&&n.length&&c!==n?w.createElement(bX,{props:r,clipPathId:e,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:o}):w.createElement(op,{props:r,points:n,clipPathId:e,pathRef:o,showLabels:!0})}var wX=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:Ar(t.payload,e)});class _X extends w.Component{constructor(){super(...arguments),Oh(this,"id",uc("recharts-line-"))}render(){var e,{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:c,left:l,width:u,height:h,id:m,needClip:p,layout:v}=this.props;if(r)return null;var b=Le("recharts-line",a),g=lt(m)?this.id:m,{r:_=3,strokeWidth:T=2}=(e=Ke(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},E=UA(n),j=_*2+T;return w.createElement(w.Fragment,null,w.createElement(zi,{className:b},p&&w.createElement("defs",null,w.createElement(mZ,{clipPathId:g,xAxisId:s,yAxisId:o}),!E&&w.createElement("clipPath",{id:"clipPath-dots-".concat(g)},w.createElement("rect",{x:l-j/2,y:c-j/2,width:u+j,height:h+j}))),w.createElement(xX,{props:this.props,clipPathId:g}),w.createElement(hZ,{direction:v==="horizontal"?"y":"x"},w.createElement(tZ,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:wX,errorBarOffset:0},this.props.children))),w.createElement(ZY,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var XC={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Dc.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function EX(t){var e=Ya(t,XC),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:o,dot:c,hide:l,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:v}=e,b=YC(e,oX),{needClip:g}=FC(p,v),{height:_,width:T,x:E,y:j}=Yy(),R=Xg(),D=mr(),S=w.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),A=ie(P=>aX(P,p,v,D,S));return R!=="horizontal"&&R!=="vertical"?null:w.createElement(_X,Fs({},b,{connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:u,hide:l,label:h,legendType:m,xAxisId:p,yAxisId:v,points:A,layout:R,height:_,width:T,left:E,top:j,needClip:g}))}function TX(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:o,displayedData:c}=t;return c.map((l,u)=>{var h=Ar(l,s);return e==="horizontal"?{x:$x({axis:r,ticks:i,bandSize:o,entry:l,index:u}),y:lt(h)?null:n.scale(h),value:h,payload:l}:{x:lt(h)?null:r.scale(h),y:$x({axis:n,ticks:a,bandSize:o,entry:l,index:u}),value:h,payload:l}})}class cd extends w.PureComponent{render(){return w.createElement(nZ,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},w.createElement(VY,{legendPayload:dX(this.props)}),w.createElement(LY,{fn:hX,args:this.props}),w.createElement(EX,this.props))}}Oh(cd,"displayName","Line");Oh(cd,"defaultProps",XC);function N_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function j_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?N_(Object(r),!0).forEach(function(n){AX(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AX(t,e,r){return(e=SX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SX(t){var e=IX(t,"string");return typeof e=="symbol"?e:e+""}function IX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PX={xAxis:{},yAxis:{},zAxis:{}},QC=Br({name:"cartesianAxis",initialState:PX,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=j_(j_({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:CX,removeXAxis:kX,addYAxis:NX,removeYAxis:jX,addZAxis:tte,removeZAxis:rte,updateYAxisWidth:OX}=QC.actions,RX=QC.reducer,DX=["children"],MX=["dangerouslySetInnerHTML","ticks"];function JC(t,e,r){return(e=LX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LX(t){var e=$X(t,"string");return typeof e=="symbol"?e:e+""}function $X(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cp(){return cp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},cp.apply(null,arguments)}function ek(t,e){if(t==null)return{};var r,n,i=VX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function VX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function FX(t){var e=sr(),r=w.useMemo(()=>{var{children:a}=t,s=ek(t,DX);return s},[t]),n=ie(a=>oi(a,r.id)),i=r===n;return w.useEffect(()=>(e(CX(r)),()=>{e(kX(r))}),[r,e]),i?t.children:null}var zX=t=>{var{xAxisId:e,className:r}=t,n=ie(XS),i=mr(),a="xAxis",s=ie(p=>Qs(p,a,e,i)),o=ie(p=>qP(p,a,e,i)),c=ie(p=>H7(p,e)),l=ie(p=>Y7(p,e));if(c==null||l==null)return null;var{dangerouslySetInnerHTML:u,ticks:h}=t,m=ek(t,MX);return w.createElement(Qi,cp({},m,{scale:s,x:l.x,y:l.y,width:c.width,height:c.height,className:Le("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},UX=t=>{var e,r,n,i,a;return w.createElement(FX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter},w.createElement(zX,t))};class ld extends w.Component{render(){return w.createElement(UX,this.props)}}JC(ld,"displayName","XAxis");JC(ld,"defaultProps",{allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,height:vr.height,hide:!1,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tickCount:vr.tickCount,type:vr.type,xAxisId:0});var BX=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,s=0;if(e){e.forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,c=i+a,l=s+c+o+(r?n:0);return Math.round(l)}return 0},HX=["dangerouslySetInnerHTML","ticks"];function tk(t,e,r){return(e=WX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lp.apply(null,arguments)}function KX(t,e){if(t==null)return{};var r,n,i=GX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function GX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function YX(t){var e=sr();return w.useEffect(()=>(e(NX(t)),()=>{e(jX(t))}),[t,e]),null}var ZX=t=>{var e,{yAxisId:r,className:n,width:i,label:a}=t,s=w.useRef(null),o=w.useRef(null),c=ie(XS),l=mr(),u=sr(),h="yAxis",m=ie(E=>Qs(E,h,r,l)),p=ie(E=>X7(E,r)),v=ie(E=>Z7(E,r)),b=ie(E=>qP(E,h,r,l));if(w.useLayoutEffect(()=>{var E;if(!(i!=="auto"||!p||Gy(a)||w.isValidElement(a))){var j=s.current,R=j==null||(E=j.tickRefs)===null||E===void 0?void 0:E.current,{tickSize:D,tickMargin:S}=j.props,A=BX({ticks:R,label:o.current,labelGapWithTick:5,tickSize:D,tickMargin:S});Math.round(p.width)!==Math.round(A)&&u(OX({id:r,width:A}))}},[s,s==null||(e=s.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p?.width,p,u,a,r,i]),p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=t,T=KX(t,HX);return w.createElement(Qi,lp({},T,{ref:s,labelRef:o,scale:m,x:v.x,y:v.y,width:p.width,height:p.height,className:Le("recharts-".concat(h," ").concat(h),n),viewBox:c,ticks:b}))},XX=t=>{var e,r,n,i,a;return w.createElement(w.Fragment,null,w.createElement(YX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter}),w.createElement(ZX,t))},QX={allowDataOverflow:br.allowDataOverflow,allowDecimals:br.allowDecimals,allowDuplicatedCategory:br.allowDuplicatedCategory,hide:!1,mirror:br.mirror,orientation:br.orientation,padding:br.padding,reversed:br.reversed,scale:br.scale,tickCount:br.tickCount,type:br.type,width:br.width,yAxisId:0};class ud extends w.Component{render(){return w.createElement(XX,this.props)}}tk(ud,"displayName","YAxis");tk(ud,"defaultProps",QX);var JX={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wc=w;function eQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tQ=typeof Object.is=="function"?Object.is:eQ,rQ=Wc.useSyncExternalStore,nQ=Wc.useRef,iQ=Wc.useEffect,aQ=Wc.useMemo,sQ=Wc.useDebugValue;JX.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=nQ(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=aQ(function(){function c(p){if(!l){if(l=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,tQ(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var l=!1,u,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=rQ(t,a[0],a[1]);return iQ(function(){s.hasValue=!0,s.value=o},[o]),sQ(o),o};function oQ(t){t()}function cQ(){let t=null,e=null;return{clear(){t=null,e=null},notify(){oQ(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var O_={notify(){},get:()=>[]};function lQ(t,e){let r,n=O_,i=0,a=!1;function s(b){u();const g=n.subscribe(b);let _=!1;return()=>{_||(_=!0,g(),h())}}function o(){n.notify()}function c(){v.onStateChange&&v.onStateChange()}function l(){return a}function u(){i++,r||(r=t.subscribe(c),n=cQ())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=O_)}function m(){a||(a=!0,u())}function p(){a&&(a=!1,h())}const v={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:l,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return v}var uQ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",dQ=uQ(),hQ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",fQ=hQ(),mQ=()=>dQ||fQ?w.useLayoutEffect:w.useEffect,pQ=mQ(),jf=Symbol.for("react-redux-context"),Of=typeof globalThis<"u"?globalThis:{};function gQ(){if(!w.createContext)return{};const t=Of[jf]??(Of[jf]=new Map);let e=t.get(w.createContext);return e||(e=w.createContext(null),t.set(w.createContext,e)),e}var yQ=gQ();function vQ(t){const{children:e,context:r,serverState:n,store:i}=t,a=w.useMemo(()=>{const c=lQ(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),s=w.useMemo(()=>i.getState(),[i]);pQ(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,s]);const o=r||yQ;return w.createElement(o.Provider,{value:a},e)}var bQ=vQ,xQ=(t,e)=>e,Jy=V([xQ,tt,s7,jt,oC,ci,eG,Ht],aG),ev=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},rk=Fr("mouseClick"),nk=Rc();nk.startListening({actionCreator:rk,effect:(t,e)=>{var r=t.payload,n=Jy(e.getState(),ev(r));n?.activeIndex!=null&&e.dispatch(lK({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var up=Fr("mouseMove"),ik=Rc();ik.startListening({actionCreator:up,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=$y(n,n.tooltip.settings.shared),a=Jy(n,ev(r));i==="axis"&&(a?.activeIndex!=null?e.dispatch(eC({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(JP()))}});function wQ(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var R_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},ak=Br({name:"rootProps",initialState:R_,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:R_.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),_Q=ak.reducer,{updateOptions:EQ}=ak.actions,sk=Br({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:nte}=sk.actions,TQ=sk.reducer,ok=Fr("keyDown"),ck=Fr("focus"),tv=Rc();tv.startListening({actionCreator:ok,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Vy(i,es(r))),o=ci(r);if(a==="Enter"){var c=id(r,"axis","hover",String(i.index));e.dispatch(ep({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:c}));return}var l=tK(r),u=l==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,m=s+h*u;if(!(o==null||m>=o.length||m<0)){var p=id(r,"axis","hover",String(m));e.dispatch(ep({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});tv.startListening({actionCreator:ck,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=id(r,"axis","hover",String(a));e.dispatch(ep({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Or=Fr("externalEvent"),lk=Rc();lk.startListening({actionCreator:Or,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:HK(r),activeDataKey:UK(r),activeIndex:yc(r),activeLabel:uC(r),activeTooltipIndex:yc(r),isTooltipActive:WK(r)};t.payload.handler(n,t.payload.reactEvent)}}});var AQ=V([Js],t=>t.tooltipItemPayloads),SQ=V([AQ,Hc,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=e(a,r);return s}}}),uk=Fr("touchMove"),dk=Rc();dk.startListening({actionCreator:uk,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=$y(n,n.tooltip.settings.shared);if(i==="axis"){var a=Jy(n,ev({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&e.dispatch(eC({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var l=c.getAttribute(zB),u=(s=c.getAttribute(UB))!==null&&s!==void 0?s:void 0,h=SQ(e.getState(),l,u);e.dispatch(cK({activeDataKey:u,activeIndex:l,activeCoordinate:h}))}}});var IQ=NS({brush:gZ,cartesianAxis:RX,chartData:wG,graphicalItems:jY,layout:hB,legend:JB,options:gG,polarAxis:IY,polarOptions:TQ,referenceElements:EZ,rootProps:_Q,tooltip:uK}),PQ=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return L9({reducer:IQ,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([nk.middleware,ik.middleware,tv.middleware,lk.middleware,dk.middleware]),devTools:{serialize:{replacer:wQ},name:"recharts-".concat(r)}})};function CQ(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=mr(),a=w.useRef(null);if(i)return r;a.current==null&&(a.current=PQ(e,n));var s=Ug;return w.createElement(bQ,{context:s,store:a.current},r)}function kQ(t){var{layout:e,width:r,height:n,margin:i}=t,a=sr(),s=mr();return w.useEffect(()=>{s||(a(lB(e)),a(uB({width:r,height:n})),a(cB(i)))},[a,s,e,r,n,i]),null}function NQ(t){var e=sr();return w.useEffect(()=>{e(EQ(t))},[e,t]),null}var jQ=["children"];function OQ(t,e){if(t==null)return{};var r,n,i=RQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function RQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function dd(){return dd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dd.apply(null,arguments)}var DQ={width:"100%",height:"100%"},MQ=w.forwardRef((t,e)=>{var r=JS(),n=eI(),i=rI();if(!Uu(r)||!Uu(n))return null;var{children:a,otherAttributes:s,title:o,desc:c}=t,l,u;return typeof s.tabIndex=="number"?l=s.tabIndex:l=i?0:void 0,typeof s.role=="string"?u=s.role:u=i?"application":void 0,w.createElement(BA,dd({},s,{title:o,desc:c,role:u,tabIndex:l,width:r,height:n,style:DQ,ref:e}),a)}),LQ=t=>{var{children:e}=t,r=ie(mh);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return w.createElement(BA,{width:n,height:i,x:s,y:a},e)},D_=w.forwardRef((t,e)=>{var{children:r}=t,n=OQ(t,jQ),i=mr();return i?w.createElement(LQ,null,r):w.createElement(MQ,dd({ref:e},n),r)});function $Q(){var t=sr(),[e,r]=w.useState(null),n=ie(FB);return w.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;tn(a)&&a!==n&&t(dB(a))}},[e,t,n]),r}function M_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function VQ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?M_(Object(r),!0).forEach(function(n){FQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FQ(t,e,r){return(e=zQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zQ(t){var e=UQ(t,"string");return typeof e=="symbol"?e:e+""}function UQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var BQ=w.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:l,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:v,onTouchStart:b,style:g,width:_}=t,T=sr(),[E,j]=w.useState(null),[R,D]=w.useState(null);TG();var S=$Q(),A=w.useCallback(q=>{S(q),typeof e=="function"&&e(q),j(q),D(q)},[S,e,j,D]),P=w.useCallback(q=>{T(rk(q)),T(Or({handler:a,reactEvent:q}))},[T,a]),O=w.useCallback(q=>{T(up(q)),T(Or({handler:l,reactEvent:q}))},[T,l]),N=w.useCallback(q=>{T(JP()),T(Or({handler:u,reactEvent:q}))},[T,u]),C=w.useCallback(q=>{T(up(q)),T(Or({handler:h,reactEvent:q}))},[T,h]),k=w.useCallback(()=>{T(ck())},[T]),Q=w.useCallback(q=>{T(ok(q.key))},[T]),oe=w.useCallback(q=>{T(Or({handler:s,reactEvent:q}))},[T,s]),X=w.useCallback(q=>{T(Or({handler:o,reactEvent:q}))},[T,o]),ee=w.useCallback(q=>{T(Or({handler:c,reactEvent:q}))},[T,c]),he=w.useCallback(q=>{T(Or({handler:m,reactEvent:q}))},[T,m]),ye=w.useCallback(q=>{T(Or({handler:b,reactEvent:q}))},[T,b]),Ue=w.useCallback(q=>{T(uk(q)),T(Or({handler:v,reactEvent:q}))},[T,v]),se=w.useCallback(q=>{T(Or({handler:p,reactEvent:q}))},[T,p]);return w.createElement(gC.Provider,{value:E},w.createElement(vU.Provider,{value:R},w.createElement("div",{className:Le("recharts-wrapper",n),style:VQ({position:"relative",cursor:"default",width:_,height:i},g),onClick:P,onContextMenu:oe,onDoubleClick:X,onFocus:k,onKeyDown:Q,onMouseDown:ee,onMouseEnter:O,onMouseLeave:N,onMouseMove:C,onMouseUp:he,onTouchEnd:se,onTouchMove:Ue,onTouchStart:ye,ref:A},r)))}),HQ=["children","className","width","height","style","compact","title","desc"];function WQ(t,e){if(t==null)return{};var r,n,i=qQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function qQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var KQ=w.forwardRef((t,e)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:c,desc:l}=t,u=WQ(t,HQ),h=Ke(u,!1);return o?w.createElement(D_,{otherAttributes:h,title:c,desc:l},r):w.createElement(BQ,{className:n,style:s,width:i,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},w.createElement(D_,{otherAttributes:h,title:c,desc:l,ref:e},w.createElement(AZ,null,r)))}),GQ=["width","height"];function dp(){return dp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},dp.apply(null,arguments)}function YQ(t,e){if(t==null)return{};var r,n,i=ZQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function ZQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var XQ={top:5,right:5,bottom:5,left:5},QQ={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:XQ,reverseStackOrder:!1,syncMethod:"index"},JQ=w.forwardRef(function(e,r){var n,i=Ya(e.categoricalChartProps,QQ),{width:a,height:s}=i,o=YQ(i,GQ);if(!Uu(a)||!Uu(s))return null;var{chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,categoricalChartProps:m}=e,p={chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return w.createElement(CQ,{preloadedState:{options:p},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:c},w.createElement(pZ,{chartData:m.data}),w.createElement(kQ,{width:a,height:s,layout:i.layout,margin:i.margin}),w.createElement(NQ,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),w.createElement(KQ,dp({},o,{width:a,height:s,ref:r})))}),eJ=["axis"],L_=w.forwardRef((t,e)=>w.createElement(JQ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:eJ,tooltipPayloadSearcher:mG,categoricalChartProps:t,ref:e}));function tJ(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})}function rJ(t){const e=typeof t=="string"?new Date(t):t;return e.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})+" "+e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}const nJ=({images:t})=>{const[e,r]=w.useState(!1),n=t.map(s=>{let o;const c={excellent:95,good:80,fair:60,poor:30};return s.healthAnalysis?.overallHealth&&c[s.healthAnalysis.overallHealth]?o=c[s.healthAnalysis.overallHealth]:typeof s.healthAnalysis?.confidence=="number"&&(o=s.healthAnalysis.confidence<=1?s.healthAnalysis.confidence*100:s.healthAnalysis.confidence),{id:s.id,date:tJ(s.timestamp),dateTime:rJ(s.timestamp),rawDate:s.timestamp,score:typeof o=="number"?o:null,url:s.url}}).sort((s,o)=>new Date(s.rawDate).getTime()-new Date(o.rawDate).getTime()),i=n.map(s=>({dateTime:s.dateTime,score:s.score})),a=s=>{const{key:o,cx:c,cy:l}=s;return d.jsx("circle",{cx:c,cy:l,r:4,stroke:"#2A7F3E",strokeWidth:2,fill:"#fff"},o)};return d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-base font-semibold text-[#2A7F3E]",children:"Evolución de Salud"}),d.jsx(me,{size:"sm",variant:"outline",onClick:()=>r(!0),children:"Ampliar"})]}),d.jsx("div",{className:"w-full h-48",children:d.jsx(s_,{width:"100%",height:"100%",children:d.jsxs(L_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(sp,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(ld,{dataKey:"dateTime",tick:{fontSize:12,fill:"#888"}}),d.jsx(ud,{domain:[0,100],tick:{fontSize:12,fill:"#888"},width:32}),d.jsx(i_,{contentStyle:{fontSize:13,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(cd,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:6},connectNulls:!1})]})})}),d.jsx("div",{className:"mt-4 overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-10 h-10 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})}),d.jsx(ke,{children:e&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-2",onClick:()=>r(!1),children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto p-6 relative",onClick:s=>s.stopPropagation(),children:[d.jsx(me,{size:"icon-sm",variant:"ghost",className:"absolute top-2 right-2",onClick:()=>r(!1),children:"×"}),d.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#2A7F3E]",children:"Evolución de Salud (Ampliado)"}),d.jsx("div",{className:"w-full h-72 mb-6",children:d.jsx(s_,{width:"100%",height:"100%",children:d.jsxs(L_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(sp,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(ld,{dataKey:"dateTime",tick:{fontSize:13,fill:"#888"}}),d.jsx(ud,{domain:[0,100],tick:{fontSize:13,fill:"#888"},width:36}),d.jsx(i_,{contentStyle:{fontSize:14,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(cd,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:7},connectNulls:!1})]})})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-12 h-12 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})})]})})})]})},iJ=({plant:t,onAddPhoto:e})=>{const r=w.useMemo(()=>{if(!t.images||t.images.length===0)return[];const a=[...t.images].sort((u,h)=>new Date(u.timestamp).getTime()-new Date(h.timestamp).getTime()),s=[],o=30*24*60*60*1e3;let c=new Date(a[0].timestamp),l=[];return a.forEach((u,h)=>{const m=new Date(u.timestamp);if(m.getTime()-c.getTime()<=o)l.push(u);else{if(l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}c=m,l=[u]}if(h===a.length-1&&l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}}),s},[t.images]);function n(a){if(a.length<2)return null;const s=a[a.length-1]-a[0];return s>5?{icon:"⬆️",label:"Mejorando",color:"text-green-600 bg-green-50"}:s<-5?{icon:"⬇️",label:"Declive",color:"text-red-600 bg-red-50"}:{icon:"➡️",label:"Estable",color:"text-gray-600 bg-gray-50"}}if(r.length===0)return d.jsxs(Pr,{className:"mt-6",children:[d.jsx(Ud,{children:d.jsxs(Tg,{className:"flex items-center",children:[d.jsx(lN,{className:"w-5 h-5 mr-2 text-primary"}),"Evolución de tu Planta"]})}),d.jsx(ei,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx(Gn,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"¡Comienza a documentar la evolución!"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:"Agrega más fotos a lo largo del tiempo para ver cómo progresa tu planta."}),d.jsxs(me,{onClick:e,className:"gap-2",children:[d.jsx(gp,{className:"w-4 h-4"}),"Agregar Primera Foto"]})]})})]});const i=r.map(a=>a.avgHealthScore??0);return n(i),d.jsx(Pr,{className:"mt-6",children:d.jsx(ei,{className:"mt-4 space-y-6",children:d.jsx(nJ,{images:t.images||[]})})})},aJ=({isOpen:t,onClose:e,onPhotoAdded:r,plantName:n})=>{const[i,a]=w.useState("choose"),[s,o]=w.useState(null),[c,l]=w.useState(""),[u,h]=w.useState(null),[m,p]=w.useState(!1),v=w.useRef(null),{addToast:b}=qs(),g=w.useCallback(()=>{a("choose"),o(null),l(""),h(null),p(!1)},[]),_=w.useCallback(()=>{g(),e()},[g,e]),T=w.useCallback(k=>{const Q=new FileReader;Q.onload=oe=>{const X=oe.target?.result;o(X),a("preview")},Q.readAsDataURL(k)},[]),E=w.useCallback(()=>{v.current&&v.current.click()},[]),j=w.useCallback(()=>{E()},[E]),R=w.useCallback(k=>{const Q=k.target.files?.[0];if(Q){if(!Q.type.startsWith("image/")){h("Por favor selecciona un archivo de imagen válido.");return}if(Q.size>5*1024*1024){h("La imagen es demasiado grande. Máximo 5MB.");return}T(Q)}},[T]),D=w.useCallback(async()=>{if(s)try{a("uploading"),p(!0),await r(s,c.trim()||void 0),a("success"),p(!1),b({type:"success",title:"Foto agregada exitosamente",message:`Nueva imagen añadida a ${n}`}),setTimeout(()=>{_()},1500)}catch(k){h(k instanceof Error?k.message:"Error al subir la imagen"),a("error"),p(!1)}},[s,c,r,n,b,_]),S=()=>(console.log("[AddPhotoModal] Renderizando botón Tomar Foto"),console.log("[AddPhotoModal] Renderizando botón Elegir de Galería"),d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[d.jsxs("div",{children:[d.jsx(Gn,{className:"w-16 h-16 text-primary mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Agregar Nueva Foto"}),d.jsxs("p",{className:"text-muted-foreground",children:["Documenta el progreso de ",d.jsx("span",{className:"font-medium",children:n})]})]}),d.jsxs("div",{className:"grid gap-4",children:[d.jsxs(me,{variant:"primary",size:"lg",onClick:j,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(Gn,{className:"w-6 h-6"}),"Tomar Foto"]}),d.jsxs(me,{variant:"secondary",size:"lg",onClick:E,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(rE,{className:"w-6 h-6"}),"Elegir de Galería"]})]}),d.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:R,className:"hidden","data-testid":"file-input"})]})),A=()=>d.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Vista Previa"}),d.jsxs("p",{className:"text-muted-foreground",children:["Revisa la imagen antes de agregar a ",n]})]}),s&&d.jsxs("div",{className:"space-y-4 pb-8 sm:pb-0",children:[d.jsx("div",{className:"aspect-video max-h-80 mx-auto rounded-lg overflow-hidden border",children:d.jsx("img",{src:s,alt:"Vista previa",className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium",children:"Nota (opcional)"}),d.jsx("textarea",{value:c,onChange:k=>l(k.target.value),placeholder:"Agrega una nota sobre esta foto...",className:"w-full p-3 border border-neutral-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:200}),d.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[c.length,"/200"]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),className:"flex-1",children:"Cambiar Imagen"}),d.jsxs(me,{variant:"primary",onClick:D,className:"flex-1 gap-2",children:[d.jsx(er,{className:"w-4 h-4"}),"Analizar y Guardar"]})]})]})]}),P=()=>d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center space-y-6 py-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx(xa,{className:"w-16 h-16 text-primary mx-auto animate-spin"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:m?"Analizando imagen...":"Subiendo foto..."}),d.jsx("p",{className:"text-muted-foreground",children:m?"La IA está evaluando la salud de tu planta":"Guardando la nueva imagen en tu jardín"})]})]}),d.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:d.jsx("div",{className:"bg-primary h-2 rounded-full animate-pulse",style:{width:"70%"}})})]}),O=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Si,{className:"w-16 h-16 text-success-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"¡Foto agregada!"}),d.jsxs("p",{className:"text-muted-foreground",children:["La nueva imagen ha sido añadida al progreso de ",n]})]})]}),N=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Jr,{className:"w-16 h-16 text-error-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al subir"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:u||"Hubo un problema al procesar la imagen"}),d.jsxs("div",{className:"flex gap-3 justify-center",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),children:"Intentar de Nuevo"}),d.jsx(me,{variant:"primary",onClick:_,children:"Cerrar"})]})]})]}),C=()=>{switch(i){case"choose":return S();case"preview":return A();case"uploading":return P();case"success":return O();case"error":return N();default:return S()}};return d.jsx(ke,{children:t&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:k=>{k.target===k.currentTarget&&i!=="uploading"&&_()},children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md",children:d.jsx(Pr,{children:d.jsxs(ei,{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(yp,{className:"w-5 h-5 text-primary"}),d.jsx("span",{className:"font-medium text-sm text-muted-foreground",children:"NUEVA FOTO"})]}),i!=="uploading"&&d.jsx(me,{variant:"ghost",size:"icon-sm",onClick:_,children:d.jsx(Wi,{className:"w-4 h-4"})})]}),C()]})})})})})},sJ=({plant:t})=>{const{careProfile:e,healthScore:r,lastWatered:n,dateAdded:i}=t,a=t.images?.[0]?.healthAnalysis,s=n?Math.floor((Date.now()-new Date(n).getTime())/(1e3*60*60*24)):null,o=Math.floor((Date.now()-new Date(i).getTime())/(1e3*60*60*24)),l=r>=85?{text:"Excelente",color:"text-green-500",icon:Si,emoji:"🌟"}:r>=70?{text:"Buena",color:"text-green-400",icon:Si,emoji:"✅"}:r>=50?{text:"Regular",color:"text-yellow-500",icon:Q_,emoji:"⚠️"}:{text:"Necesita atención",color:"text-red-500",icon:En,emoji:"🆘"},h=(()=>{if(!s||!e?.wateringFrequency)return{text:"Sin datos",color:"text-gray-500",urgent:!1};const v=s>=e.wateringFrequency;return s>e.wateringFrequency+2?{text:"Riego urgente",color:"text-red-500",urgent:!0}:v?{text:"Necesita riego",color:"text-yellow-500",urgent:!0}:{text:"Bien hidratada",color:"text-green-500",urgent:!1}})(),m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},p={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsx(L.div,{variants:m,initial:"hidden",animate:"visible",children:d.jsxs(Pr,{variant:"glass",className:"content-spacing-sm element-spacing",children:[t.description&&d.jsx("div",{className:"mb-4",children:d.jsx("p",{className:"text-base text-neutral-700 dark:text-neutral-200 leading-relaxed",children:t.description})}),d.jsx(L.div,{variants:p,className:"w-full mb-3",children:d.jsxs("div",{className:"w-full flex items-center justify-between bg-green-100 dark:bg-green-900/30 rounded-lg px-4 py-2 mb-2",children:[d.jsxs("span",{className:"flex items-center gap-2 text-green-700 text-base font-bold",children:[d.jsx(Si,{className:"w-5 h-5"}),r,"% ",l.text]}),d.jsxs("span",{className:"flex items-center gap-1 text-contrast-soft text-sm align-baseline",children:[d.jsx(su,{className:"w-4 h-4"}),"Día ",o]})]})}),d.jsxs(L.div,{variants:p,className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:Oe("flex items-center space-x-3 p-3 rounded-lg",h.urgent?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"),children:[d.jsx(xc,{className:Oe("w-5 h-5",h.color)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Riego"}),d.jsx("p",{className:Oe("font-semibold text-sm",h.color),children:h.text}),s!==null&&d.jsxs("p",{className:"text-xs text-contrast-soft",children:["Hace ",s," día",s!==1?"s":""]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[d.jsx(wa,{className:"w-5 h-5 text-blue-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Luz"}),d.jsx("p",{className:"font-semibold text-sm text-blue-600 dark:text-blue-400",children:e?.sunlightRequirement||"No especificado"}),t.lightRequirements&&d.jsx("p",{className:"text-xs text-contrast-soft capitalize",children:t.lightRequirements.replace("_"," ")})]})]}),t.plantEnvironment&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[d.jsx(lE,{className:"w-5 h-5 text-purple-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Ambiente"}),d.jsx("p",{className:"font-semibold text-sm text-purple-600 dark:text-purple-400 capitalize",children:t.plantEnvironment==="ambos"?"Interior/Exterior":t.plantEnvironment})]})]}),e?.temperatureRange&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[d.jsx(uE,{className:"w-5 h-5 text-orange-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Temperatura"}),d.jsxs("p",{className:"font-semibold text-sm text-orange-600 dark:text-orange-400",children:[e.temperatureRange.min,"°-",e.temperatureRange.max,"°C"]})]})]})]}),a?.issues&&a.issues.length>0&&d.jsx(L.div,{variants:p,className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(En,{className:"w-5 h-5 text-red-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-red-700 dark:text-red-300 text-sm mb-1",children:[a.issues.length," problema",a.issues.length!==1?"s":""," detectado",a.issues.length!==1?"s":""]}),d.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[a.issues[0].description,a.issues.length>1&&` y ${a.issues.length-1} más...`]})]})]})}),d.jsx("br",{}),t.personality?.communicationStyle&&d.jsx(L.div,{variants:p,className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Go,{className:"w-5 h-5 text-green-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-green-700 dark:text-green-300 text-sm mb-1",children:["🤖 Personalidad: ",t.personality.communicationStyle]}),t.personality.catchphrases&&t.personality.catchphrases.length>0&&d.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 italic",children:['"',t.personality.catchphrases[0],'"']})]})]})})]})})},oJ=({plant:t,onAddPhoto:e})=>{const[r,n]=w.useState("evolution"),i=t.images?.[0]?.healthAnalysis,a=i?.issues&&i.issues.length>0,s=t.images&&t.images.length>1,o=[{id:"evolution",title:"Evolución y Progreso",icon:d.jsx(uN,{className:"w-5 h-5"}),badge:s?`${t.images?.length||0} fotos`:"Nueva",component:d.jsx(iJ,{plant:t,onAddPhoto:e}),priority:1},{id:"health",title:"Análisis de Salud",icon:d.jsx(dN,{className:"w-5 h-5"}),badge:a?"Atención":"Saludable",component:d.jsx(tU,{analysis:i}),priority:a?1:3},{id:"care",title:"Perfil de Cuidados",icon:d.jsx(hN,{className:"w-5 h-5"}),badge:t.careProfile?"Completo":"Pendiente",component:d.jsx(Qz,{plant:t}),priority:t.careProfile?2:1},...t.funFacts&&t.funFacts.length>0?[{id:"funfacts",title:"Datos Curiosos",icon:d.jsx(er,{className:"w-5 h-5"}),component:d.jsx(Jz,{species:t.species,funFacts:t.funFacts}),priority:4}]:[]].filter(c=>c.id==="health"?!!i:!0).sort((c,l)=>c.priority-l.priority);return d.jsx("div",{className:"flex flex-col gap-y-1",children:o.map(c=>{const l=r===c.id,u=c.id==="health";return c.id==="care"?d.jsxs(Pr,{variant:"default",radius:"default",className:Oe("border border-[#E5E5E5] rounded-[8px] transition-all duration-200","bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none","bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),d.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16,transition:"transform .2s"},children:d.jsx(Gv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:l&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,d.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id):d.jsxs(Pr,{variant:"default",radius:"default",className:Oe("border border-[#E0E0E0] rounded-[8px] transition-all duration-200",l&&u?"bg-[#FAFAFA]":"bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none",l&&u?"bg-[#FAFAFA]":"bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),u&&d.jsx("span",{className:"ml-2 px-[6px] py-[2px] text-xs font-medium rounded-[4px] bg-[#E0F2E9] text-[#2A7F3E] align-middle",style:{lineHeight:"1.2"},children:c.badge}),d.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16},children:d.jsx(Gv,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:l&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,u&&d.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id)})})},$_=()=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"relative h-96 w-full overflow-hidden bg-gradient-to-br from-muted/50 to-muted",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 via-background/20 to-transparent"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-8 w-64"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx(pe,{className:"h-8 w-24 rounded-full"}),d.jsx(pe,{className:"h-8 w-32 rounded-full"}),d.jsx(pe,{className:"h-8 w-20 rounded-full"})]})]})})]}),d.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-6 flex items-center",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-48"}),d.jsx(pe,{className:"h-4 w-64"})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx(pe,{className:"h-4 w-full"}),d.jsx(pe,{className:"h-4 w-5/6"}),d.jsx(pe,{className:"h-4 w-4/5"}),d.jsx(pe,{className:"h-4 w-3/4"})]}),d.jsxs("div",{className:"mt-8 space-y-4",children:[d.jsxs("div",{className:"flex items-center mb-4",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-32"}),d.jsx(pe,{className:"h-4 w-56"})]})]}),[1,2,3].map(t=>d.jsxs("div",{className:"flex items-start bg-muted/20 rounded-xl p-4",children:[d.jsx(pe,{className:"h-5 w-5 rounded-full mr-4 mt-1"}),d.jsx(pe,{className:"h-4 w-full"})]},t))]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-6",children:[d.jsx(pe,{className:"h-12 w-12 mx-auto mb-3"}),d.jsx(pe,{className:"h-6 w-32 mx-auto mb-2"}),d.jsx(pe,{className:"h-4 w-48 mx-auto"})]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-40"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>d.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[d.jsx(pe,{className:"h-8 w-8 mb-2"}),d.jsx(pe,{className:"h-4 w-16 mb-1"}),d.jsx(pe,{className:"h-5 w-24"})]},t))})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pe,{className:"h-5 w-5 mr-2"}),d.jsx(pe,{className:"h-6 w-32"})]}),d.jsx(pe,{className:"h-4 w-16"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4,5,6].map(t=>d.jsx(pe,{className:"aspect-square rounded-xl"},t))})]})]}),d.jsxs("div",{className:"fixed bottom-4 right-4 z-40 flex flex-col-reverse gap-3",children:[[1,2,3].map(t=>d.jsx(pe,{className:"h-14 w-14 rounded-full"},t)),d.jsx(pe,{className:"h-16 w-16 rounded-full"})]})]}),cJ=()=>{const{plantId:t}=pp(),e=ar(),{plant:r,loading:n,error:i}=Sg(t),{addPlantImage:a}=Wz(),[s,o]=w.useState(!1),c=async(l,u)=>{if(!t)throw new Error("Plant ID is required");return new Promise((h,m)=>{a({plantId:t,imageDataUrl:l,note:u},{onSuccess:()=>h(),onError:p=>m(p)})})};return n?d.jsx($_,{}):i?d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Ocurrió un Error"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:i}),d.jsx(me,{onClick:()=>window.location.reload(),className:"mt-4",children:"Intentar de nuevo"})]})}):r?d.jsx(w.Suspense,{fallback:d.jsx($_,{}),children:d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[d.jsx(Xz,{plant:r}),d.jsxs("main",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.2},children:d.jsx(sJ,{plant:r})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15,duration:.2},children:d.jsx(oJ,{plant:r,onAddPhoto:()=>o(!0)})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.2},children:d.jsx(qz,{images:r.images})})]}),d.jsxs(L.div,{className:"fixed bottom-24 right-4 z-40 flex flex-col-reverse gap-3",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.25,duration:.2},children:[d.jsxs(L.button,{onClick:()=>o(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Agregar nueva foto",children:[d.jsx(Gn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Agregar foto"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Agregar foto"})]}),d.jsxs(L.button,{onClick:()=>e(gt.toPlantChat(r.id)),className:"bg-blue-500 hover:bg-blue-600 text-white p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Chat con la planta",children:[d.jsx(wc,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Chat"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Chat"})]})]}),d.jsx(aJ,{isOpen:s,onClose:()=>o(!1),onPhotoAdded:c,plantName:r.nickname||r.name})]})}):d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-muted-foreground mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold",children:"Planta no encontrada"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo encontrar la información de la planta solicitada."}),d.jsx(me,{onClick:()=>e(gt.toDashboard()),className:"mt-4",children:"Volver al inicio"})]})})},lJ=({videoRef:t,canvasRef:e})=>{const[r,n]=w.useState(!1),[i,a]=w.useState(null),[s,o]=w.useState("environment"),[c,l]=w.useState(null),u=w.useRef(null),h=w.useCallback(async()=>{try{u.current&&u.current.getTracks().forEach(_=>_.stop()),l(null);const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:s,width:{ideal:1920},height:{ideal:1080},aspectRatio:16/9}});t.current&&(t.current.srcObject=g,u.current=g)}catch(g){console.error("Error accessing camera:",g),g instanceof Error?g.name==="NotAllowedError"||g.message.includes("Permission dismissed")?l("Permiso de cámara denegado. Por favor, actívalo en los ajustes de tu navegador."):l("No se pudo acceder a la cámara. Revisa los permisos y el dispositivo."):l("Ocurrió un error inesperado al acceder a la cámara.")}},[s,t]);w.useEffect(()=>(h(),()=>{u.current&&u.current.getTracks().forEach(g=>g.stop())}),[h]);const m=w.useCallback(()=>{if(!t.current||!e.current)return;const g=t.current,_=e.current,T=_.getContext("2d");if(!T)return;_.width=g.videoWidth,_.height=g.videoHeight,T.drawImage(g,0,0,g.videoWidth,g.videoHeight);const E=_.toDataURL("image/jpeg",.9);a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop()),"vibrate"in navigator&&navigator.vibrate(50)},[t,e]),p=w.useCallback(()=>{a(null),n(!1),h()},[h]);return{isCapturing:r,capturedImage:i,cameraError:c,captureImage:m,retakePhoto:p,switchCamera:()=>{o(g=>g==="user"?"environment":"user")},startCamera:h,selectFromGallery:g=>{if(g&&g.type.startsWith("image/")){const _=new FileReader;_.onload=T=>{const E=T.target?.result;a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop())},_.readAsDataURL(g)}}}},uJ=({error:t,onRetry:e})=>{const r=ar();return d.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center p-6",children:d.jsx("div",{className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full mx-4",children:d.jsxs("div",{className:"flex flex-col items-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:d.jsx(Jr,{size:32,className:"text-red-400"})}),d.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Camera Access Required"}),d.jsx("p",{className:"text-gray-300 text-sm mb-6 leading-relaxed",children:t}),d.jsxs("div",{className:"space-y-3 w-full",children:[d.jsxs(me,{onClick:e,children:[d.jsx(ji,{size:18,className:"mr-2"}),d.jsx("span",{children:"Try Again"})]}),d.jsx(me,{onClick:()=>r(gt.toDashboard()),variant:"secondary",children:"Go Back"})]}),d.jsx("div",{className:"mt-4 p-3 bg-gray-800 rounded-lg",children:d.jsxs("p",{className:"text-gray-400 text-xs",children:[d.jsx("strong",{children:"How to enable camera:"}),d.jsx("br",{}),"1. Click the camera icon in your browser's address bar",d.jsx("br",{}),'2. Select "Allow" for camera access',d.jsx("br",{}),'3. Refresh the page or tap "Try Again"']})})]})})})},dJ=({image:t,isAnalyzing:e,onRetake:r,onAnalyze:n})=>d.jsxs(d.Fragment,{children:[d.jsx(L.img,{src:t,alt:"Captured plant",className:"absolute inset-0 w-full h-full object-cover z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[d.jsx(me,{onClick:r,variant:"secondary",disabled:e,children:"Retake"}),d.jsx(me,{onClick:n,disabled:e,children:e?d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Analyzing..."})]}):"Add Plant"})]}),e&&d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"AI is identifying your plant and creating a care profile..."})]})]}),hJ=({videoRef:t,canvasRef:e,flashEnabled:r,onCapture:n,onSwitchCamera:i,onToggleFlash:a,onSelectFromGallery:s})=>{const o=ar();return d.jsxs(d.Fragment,{children:[d.jsx(L.video,{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),d.jsx("canvas",{ref:e,className:"hidden"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 safe-area-top z-20",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(me,{onClick:()=>o(gt.toDashboard()),variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(Wi,{size:20})}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(me,{onClick:a,variant:"ghost",size:"icon",className:`rounded-full ${r?"bg-yellow-500 text-black hover:bg-yellow-600":"bg-black/50"}`,children:r?d.jsx(er,{size:20}):d.jsx(fN,{size:20})}),d.jsx(me,{onClick:i,variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(mN,{size:20})})]})]})}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[d.jsx(me,{onClick:s,size:"icon",variant:"ghost",className:"w-14 h-14 rounded-full bg-black/50",children:d.jsx(yp,{size:24})}),d.jsx(L.button,{onClick:n,className:"w-20 h-20 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center ios-button",whileHover:{scale:1.05},whileTap:{scale:.95},children:d.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center",children:d.jsx(Gn,{size:24,className:"text-gray-600"})})}),d.jsx("div",{className:"w-14 h-14"})]}),d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"Position your plant in the frame and tap to capture, or select from gallery"})]}),d.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:d.jsx("div",{className:"w-64 h-64 border-2 border-white/50 rounded-2xl"})})]})},fJ=()=>{const t=ar(),{createPlant:e,isCreatingPlant:r}=zd(),n=w.useRef(null),i=w.useRef(null),{isCapturing:a,capturedImage:s,cameraError:o,captureImage:c,retakePhoto:l,switchCamera:u,startCamera:h,selectFromGallery:m}=lJ({videoRef:n,canvasRef:i}),[p,v]=w.useState(!1),b=w.useRef(null),g=()=>{if(!s)return;const E="Interior",j=new Promise((R,D)=>{e({imageDataUrl:s,location:E},{onSuccess:S=>{S?.id?t(gt.toPlantDetail(S.id)):t(gt.toDashboard()),R(S)},onError:S=>{D(S)}})});HT.promise(j,{loading:"Analizando imagen con IA...",success:R=>`¡Planta "${R.name}" creada con éxito!`,error:R=>`Error: ${R.message}`})},_=()=>v(E=>!E),T=E=>{const j=E.target.files?.[0];j&&m(j)};return d.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[d.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:T,className:"hidden",id:"gallery-input"}),d.jsx(ke,{mode:"wait",children:o?d.jsx(uJ,{error:o,onRetry:h},"error"):a?d.jsx(dJ,{image:s,isAnalyzing:r,onRetake:l,onAnalyze:g},"preview"):d.jsx(hJ,{videoRef:n,canvasRef:i,flashEnabled:p,onCapture:c,onSwitchCamera:u,onToggleFlash:_,onSelectFromGallery:()=>b.current?.click()},"capture")})]})},mJ=()=>{const{plantId:t}=pp(),e=ar(),{user:r}=Nn(),n=qn(l=>l.getPlantById(t||"")),i=qn(l=>l.addChatMessage),a=qn(l=>l.operationStates.chat.isLoading),s=w.useMemo(()=>{if(!n||!n.chatHistory||n.chatHistory.length===0)return!1;const l=n.chatHistory[n.chatHistory.length-1];return a&&l.sender==="user"},[n,a]);return{plant:n,isTyping:s,handleSendMessage:async l=>{if(!(!t||!r||!l.trim()))try{await i(t,l.trim(),r.id)}catch(u){console.error("Failed to send message:",u)}},handleGoBack:()=>{e(`/plant/${t}`)},currentUser:r}},pJ=({plant:t})=>{const e=ar(),r=()=>{const n=t.healthScore/100,i=t.lastWatered?new Date(t.lastWatered).getTime():0,a=i?Math.max(0,1-(Date.now()-i)/(t.careProfile.wateringFrequency*24*60*60*1e3)):0,s=n*.6+a*.4;return s>.8?"radiante":s>.6?"feliz":s>.4?"estable":"necesitada de atención"};return d.jsx("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:d.jsxs("div",{className:"flex items-center gap-2 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>e(gt.toPlantDetail(t.id)),className:"btn btn-ghost btn-circle",children:d.jsx(vp,{size:20})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h1",{className:"font-bold text-foreground truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 capitalize",children:["Se siente ",r()]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400",children:[d.jsx(eE,{className:"w-4 h-4"}),d.jsxs("span",{children:[t.healthScore,"%"]})]})]})})};var gJ={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},yJ=function(e,r,n){var i,a=gJ[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"en "+i:"hace "+i:i},vJ={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},bJ={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},xJ={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},wJ={date:Ts({formats:vJ,defaultWidth:"full"}),time:Ts({formats:bJ,defaultWidth:"full"}),dateTime:Ts({formats:xJ,defaultWidth:"full"})},_J={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},EJ={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},TJ=function(e,r,n,i){return r.getUTCHours()!==1?EJ[e]:_J[e]},AJ={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},SJ={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},IJ={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},PJ={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},CJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},kJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},NJ=function(e,r){var n=Number(e);return n+"º"},jJ={ordinalNumber:NJ,era:un({values:AJ,defaultWidth:"wide"}),quarter:un({values:SJ,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:un({values:IJ,defaultWidth:"wide"}),day:un({values:PJ,defaultWidth:"wide"}),dayPeriod:un({values:CJ,defaultWidth:"wide",formattingValues:kJ,defaultFormattingWidth:"wide"})},OJ=/^(\d+)(º)?/i,RJ=/\d+/i,DJ={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},MJ={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},LJ={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},$J={any:[/1/i,/2/i,/3/i,/4/i]},VJ={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},FJ={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},zJ={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},UJ={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},BJ={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},HJ={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},WJ={ordinalNumber:OA({matchPattern:OJ,parsePattern:RJ,valueCallback:function(e){return parseInt(e,10)}}),era:dn({matchPatterns:DJ,defaultMatchWidth:"wide",parsePatterns:MJ,defaultParseWidth:"any"}),quarter:dn({matchPatterns:LJ,defaultMatchWidth:"wide",parsePatterns:$J,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:dn({matchPatterns:VJ,defaultMatchWidth:"wide",parsePatterns:FJ,defaultParseWidth:"any"}),day:dn({matchPatterns:zJ,defaultMatchWidth:"wide",parsePatterns:UJ,defaultParseWidth:"any"}),dayPeriod:dn({matchPatterns:BJ,defaultMatchWidth:"any",parsePatterns:HJ,defaultParseWidth:"any"})},hk={code:"es",formatDistance:yJ,formatLong:wJ,formatRelative:TJ,localize:jJ,match:WJ,options:{weekStartsOn:1,firstWeekContainsDate:1}};const qJ=t=>{switch(t){case"happy":case"excited":return"😊";case"grateful":return"🥰";case"worried":return"😟";case"sad":return"😢";default:return"🌱"}},KJ=({message:t})=>{const e=t.sender==="user",r=n=>{Ld.success("¡Gracias por tu feedback!",n?"Nos alegra que la respuesta te haya sido útil.":"Trabajaremos para mejorar las respuestas.")};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2",e?"justify-end":"justify-start"),children:[!e&&d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:qJ(t.emotion)}),d.jsxs("div",{className:Oe("max-w-xs rounded-2xl px-4 py-2 sm:max-w-sm md:max-w-md shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm":"rounded-bl-lg bg-contrast-surface text-contrast-medium border border-contrast","rounded-[12px]"),children:[d.jsx("p",{className:"text-sm",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((n,i)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[n.type==="warning"&&"⚠️ ",n.type==="tip"&&"💡 ",n.type==="recommendation"&&"🌱 ",n.type==="observation"&&"🔎 ",n.title]}),d.jsx("div",{children:n.description}),n.affectedPlants&&n.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",n.affectedPlants.join(", ")]})]},i))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((n,i)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:n.action}),n.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",n.priority]}),n.plantIds&&n.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",n.plantIds.join(", ")]})]},i))})]}),d.jsx("p",{className:Oe("mt-1 text-xs",e?"text-white/80":"text-contrast-soft","text-[#888] text-[12px]"),children:DA(new Date(t.timestamp),{addSuffix:!0,locale:hk})}),!e&&d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{"aria-label":"Respuesta útil",className:"text-green-600 hover:text-green-800 text-lg focus:outline-none",onClick:()=>r(!0),children:"👍"}),d.jsx("button",{"aria-label":"Respuesta no útil",className:"text-red-500 hover:text-red-700 text-lg focus:outline-none",onClick:()=>r(!1),children:"👎"})]})]})]})},GJ=({messages:t})=>d.jsx("div",{className:"space-y-4",children:t.map(e=>d.jsx(KJ,{message:e},e.id))}),YJ=["¿Cómo te sientes hoy?","¿Necesitas agua?","Cuéntame un dato curioso sobre ti"],ZJ=({onSendMessage:t,isTyping:e})=>{const[r,n]=w.useState(""),i=w.useRef(null),a=()=>{const o=i.current?.value.trim();o&&(t(o),i.current&&(i.current.value=""))},s=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a())};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Bd,{type:"text",ref:i,onKeyDown:s,placeholder:"Escribe un mensaje...",className:"pr-12",disabled:e}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(hE,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:a,disabled:!r.trim()||e,size:"icon",children:d.jsx(fE,{size:20})})]}),d.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:YJ.map(o=>d.jsx(me,{onClick:()=>n(o),disabled:e,variant:"secondary",size:"sm",children:o},o))})]})})},fk=()=>{const t={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:"🌱"}),d.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})},XJ=({plantName:t})=>d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center text-center p-8",children:[d.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-primary/10 mb-4",children:d.jsx(er,{className:"h-8 w-8 text-primary"})}),d.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Inicia una conversación"}),d.jsxs("p",{className:"text-muted-foreground max-w-xs",children:[t," está esperando para charlar. ¡Pregúntale sobre sus cuidados o simplemente saluda!"]})]}),QJ=()=>{const{plantId:t}=pp(),e=ar(),{loading:r,error:n}=Sg(t),{plant:i,isTyping:a,handleSendMessage:s}=mJ(),o=w.useRef(null);return w.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[i?.chatHistory,a]),r?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(xa,{className:"w-12 h-12 animate-spin text-green-500"}),d.jsx("p",{className:"mt-4 text-lg",children:"Cargando chat..."})]}):n?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-red-500",children:[d.jsxs("p",{className:"mb-4",children:["Error: ",n]}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]}):i?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(pJ,{plant:i}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(ke,{children:i.chatHistory.length===0?d.jsx(XJ,{plantName:i.nickname||i.name}):d.jsx(GJ,{messages:i.chatHistory,plantNickname:i.nickname||i.name})}),a&&d.jsx(fk,{}),d.jsx("div",{ref:o})]}),d.jsx(ZJ,{onSendMessage:s,isTyping:a})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx("p",{className:"mb-4",children:"Planta no encontrada."}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]})};class JJ{constructor(e,r){yr(this,"supabase");yr(this,"cache");this.supabase=e,this.cache=r}async sendMessage(e,r,n){try{const{data:{session:i},error:a}=await this.supabase.auth.getSession();if(a||!i?.access_token)throw console.error("User session not available:",a),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:s,error:o}=await this.supabase.functions.invoke("garden-ai-chat",{body:{message:e,sessionId:r,userId:n},headers:{Authorization:`Bearer ${i.access_token}`}});if(o)throw new Error(`Garden AI service error: ${o.message}`);if(!s)throw new Error("No data received from garden AI service");return s}catch(i){throw console.error("Error in garden chat service:",i),i}}async sendMessageToGardenAI(e,r,n){try{const i=await this.buildGardenContext(r),a=n.map(v=>({role:v.sender==="user"?"user":"assistant",content:v.content})),s="amigable, motivador, experto, cálido, y con un toque de humor ligero",{data:{session:o},error:c}=await this.supabase.auth.getSession();if(c||!o?.access_token)throw console.error("User session not available:",c),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:l,error:u}=await this.supabase.functions.invoke("garden-ai-chat",{body:{userMessage:e,gardenContext:i,conversationHistory:a,tonePersona:s},headers:{Authorization:`Bearer ${o.access_token}`}});if(u)throw new Error(`Garden AI service error: ${u.message}`);if(!l)throw new Error("No data received from garden AI service");const h=typeof l=="string"?JSON.parse(l):l,m=(h.content||"").toLowerCase();return(!h.content||m.includes("no sé")||m.includes("no tengo información")||m.includes("no puedo ayudarte")||m.length<30)&&Ld.warning("Respuesta genérica","La respuesta de la IA fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{content:h.content||"Lo siento, no pude procesar tu mensaje.",insights:h.insights||[],suggestedActions:h.suggestedActions||[]}}catch(i){throw i}}async verifyFunctionAvailability(){try{const e={userMessage:"ping",gardenContext:{totalPlants:0,plantsData:[],averageHealthScore:0,commonIssues:[],careScheduleSummary:{needsWatering:[],needsFertilizing:[],healthConcerns:[]},environmentalFactors:{locations:["test"]}},conversationHistory:[]},{data:{session:r},error:n}=await this.supabase.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await this.supabase.functions.invoke("garden-ai-chat",{body:e,headers:{Authorization:`Bearer ${r.access_token}`}});return a?a.message.includes("404")||a.message.includes("not found")?{available:!1,error:"La función de chat de jardín no está disponible en este momento"}:{available:!1,error:a.message}:i&&typeof i.content=="string"?{available:!0}:{available:!1,error:"Function returned unexpected response format"}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Error desconocido"}}}async getGardenHealthSummary(e){try{const r=this.cache.getGardenSummary(e);if(r)return r;const n=await this.buildGardenContext(e),i=n.plantsData.filter(o=>o.healthScore>=80).length,a=n.careScheduleSummary.needsWatering.length+n.careScheduleSummary.healthConcerns.length,s={totalPlants:n.totalPlants,averageHealth:n.averageHealthScore,urgentActions:a,healthyPlants:i};return this.cache.setGardenSummary(e,s),s}catch(r){throw console.error("Error getting garden health summary:",r),r}}async getSuggestedQuestions(e){try{const r=await this.buildGardenContext(e),n=[];return r.totalPlants===0?(n.push("¿Cómo agrego mi primera planta?"),n.push("¿Qué tipo de planta me recomiendas para empezar?"),n):(n.push("¿Cuántas plantas tengo y cómo están?"),n.push("¿Cuál es la salud promedio de mi jardín?"),r.careScheduleSummary.healthConcerns.length>0&&(n.push("¿Qué plantas necesitan atención especial?"),n.push("¿Qué problemas de salud hay en mi jardín?")),r.plantsData.some(i=>i.healthScore>=80)&&n.push("¿Cuáles de mis plantas están más sanas?"),r.environmentalFactors.locations.length>1&&n.push("¿Cómo afecta la ubicación a mis plantas?"),r.totalPlants>5&&n.push("¿Cómo organizar mejor mi espacio de plantas?"),r.plantsData.some(i=>"lastFertilized"in i&&!!i.lastFertilized)&&n.push("¿Cuándo debo fertilizar mis plantas?"),new Set(r.plantsData.map(i=>i.species)).size>1&&n.push("¿Qué especie de planta es la más resistente en mi jardín?"),n.slice(0,6))}catch(r){return console.error("Error getting suggested questions:",r),["¿Cuántas plantas tengo y cómo están?","¿Cuál es la salud promedio de mi jardín?"]}}async refreshGardenData(e){try{this.invalidateCache(e),await this.buildGardenContext(e),console.log("[GardenChatService] Garden data refreshed for user:",e)}catch(r){throw console.error("Error refreshing garden data:",r),r}}async buildGardenContext(e){try{const r=this.cache.getGardenContext(e);if(r)return r;const{data:n,error:i}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          last_fertilized,
          care_profile,
          date_added
        `).eq("user_id",e).order("created_at",{ascending:!1});if(i)throw i;const a=n.map(v=>({id:v.id,name:v.name,nickname:v.nickname||void 0,species:v.species,location:v.location,plantEnvironment:v.plant_environment,lightRequirements:v.light_requirements,healthScore:v.health_score||85,lastWatered:v.last_watered?new Date(v.last_watered):void 0,wateringFrequency:v.care_profile?.wateringFrequency})),s=a.length,o=s>0?Math.round(a.reduce((v,b)=>v+b.healthScore,0)/s):0,c=new Date,l=[],u=[],h=[];a.forEach(v=>{if(v.lastWatered&&v.wateringFrequency){const b=new Date(v.lastWatered),g=new Date(b);g.setDate(b.getDate()+v.wateringFrequency),c>g&&l.push(v.id)}v.healthScore<70&&h.push(v.id)});const m=[...new Set(a.map(v=>v.location))],p={totalPlants:s,plantsData:a,averageHealthScore:o,commonIssues:[],careScheduleSummary:{needsWatering:l,needsFertilizing:u,healthConcerns:h},environmentalFactors:{locations:m,lightConditions:[],humidityNeeds:[]}};return this.cache.setGardenContext(e,p),p}catch(r){throw console.error("Error building garden context:",r),r}}invalidateCache(e){this.cache.invalidateCache(e),console.log("Cache invalidated for user:",e)}}const ha=new JJ(Et,Wo),eee=()=>{const{user:t}=Nn(),[e,r]=w.useState([]),[n,i]=w.useState(!1),[a,s]=w.useState(!1),[o,c]=w.useState(null),[l,u]=w.useState(null),[h,m]=w.useState([]),[p,v]=w.useState("");w.useEffect(()=>{t?.id&&b()},[t?.id]);const b=async()=>{if(t?.id){i(!0);try{const[D,S]=await Promise.all([ha.getGardenHealthSummary(t.id),ha.getSuggestedQuestions(t.id)]);if(u(D),m(S),e.length===0&&D.totalPlants>0){const A={id:`welcome-${Date.now()}`,sender:"ai",content:`¡Hola! Soy tu asistente de jardín 🌱 

Veo que tienes ${D.totalPlants} plantas en tu jardín con una salud promedio de ${D.averageHealth}%. ${D.urgentActions>0?`Hay ${D.urgentActions} acciones que podrían necesitar tu atención.`:"¡Todo parece estar en buen estado!"}

¿En qué puedo ayudarte hoy con tu jardín?`,timestamp:new Date,context:{queryType:"general"}};r([A])}}catch(D){console.error("Error loading initial garden data:",D),c("Error al cargar la información del jardín")}finally{i(!1)}}},g=w.useCallback(async D=>{if(!t?.id||!D.trim()||a)return;const S=await ha.verifyFunctionAvailability();if(!S.available){c(`🚧 El chat de jardín no está disponible: ${S.error}`);return}const A={id:`user-${Date.now()}`,sender:"user",content:D.trim(),timestamp:new Date};v(D.trim()),r(P=>[...P,A]),s(!0),c(null);try{const P=await ha.sendMessageToGardenAI(D.trim(),t.id,e),O={id:`ai-${Date.now()}`,sender:"ai",content:P.content,timestamp:new Date,context:{plantsAnalyzed:tee(P),queryType:ree(D),insights:P.insights||[],suggestedActions:P.suggestedActions||[]}};if(r(N=>[...N,O]),P.suggestedActions&&P.suggestedActions.length>0){const N=await ha.getGardenHealthSummary(t.id);u(N)}}catch(P){console.error("Error sending message to garden AI:",P);let O="Error al enviar el mensaje. Por favor intenta de nuevo.";P instanceof Error&&(P.message.includes("función de chat de jardín no está disponible")?O="🚧 El chat de jardín está temporalmente no disponible. Estamos trabajando para solucionarlo.":P.message.includes("CORS")?O="🔧 Error de configuración. Por favor contacta al administrador.":P.message.includes("garden-ai-chat no existe")&&(O="⚠️ Servicio no configurado. El chat de jardín necesita configuración adicional.")),c(O),r(N=>N.slice(0,-1))}finally{s(!1)}},[t?.id,e,a]),_=w.useCallback(async()=>{p&&await g(p)},[p,g]),T=w.useCallback(()=>{r([]),c(null),t?.id&&b()},[t?.id]),E=w.useCallback(async()=>{if(t?.id){i(!0);try{await ha.refreshGardenData(t.id),await b(),console.log("[useGardenChat] Garden data refreshed successfully")}catch(D){console.error("Error refreshing garden data:",D),c("Error al actualizar los datos del jardín")}finally{i(!1)}}},[t?.id]),j=w.useMemo(()=>n,[n]),R=w.useMemo(()=>{},[t?.id,l]);return{messages:e,isLoading:j,isTyping:a,error:o,gardenSummary:l,suggestedQuestions:h,sendMessage:g,clearMessages:T,retryLastMessage:_,refreshGardenData:E,cacheStats:R}};function tee(t){const e=[];return t.insights&&t.insights.forEach(r=>{r.affectedPlants&&e.push(...r.affectedPlants)}),t.suggestedActions&&t.suggestedActions.forEach(r=>{r.plantIds&&e.push(...r.plantIds)}),[...new Set(e)]}function ree(t){const e=t.toLowerCase();return e.includes("salud")||e.includes("problema")||e.includes("enferm")?"health_analysis":e.includes("comparar")||e.includes("diferencia")||e.includes("mejor")?"care_comparison":e.includes("hongo")||e.includes("plaga")||e.includes("prevenir")?"disease_prevention":e.includes("crecimiento")||e.includes("progreso")||e.includes("tiempo")?"growth_tracking":"general"}const nee=({onClose:t})=>{const[e,r]=w.useState([{name:"garden-ai-chat",available:!1}]),[n,i]=w.useState(!1),a=async()=>{i(!0);const c=[],l=await ha.verifyFunctionAvailability();c.push({name:"garden-ai-chat",available:l.available,error:l.error,lastChecked:new Date}),r(c),i(!1)};w.useEffect(()=>{a()},[]);const s=c=>c.available?d.jsx(Si,{className:"w-5 h-5 text-green-500"}):d.jsx(Jr,{className:"w-5 h-5 text-red-500"}),o=c=>c.available?"Disponible":"No disponible";return d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:c=>c.stopPropagation(),className:"w-full max-w-md",children:d.jsxs(Pr,{className:"p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(mE,{className:"w-6 h-6 text-blue-500"}),d.jsx("h3",{className:"text-lg font-semibold",children:"Diagnóstico del Sistema"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Estado de Funciones Edge"}),d.jsx("div",{className:"space-y-3",children:e.map(c=>d.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[s(c),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-sm",children:c.name}),d.jsx("p",{className:"text-xs text-muted-foreground",children:o(c)})]})]}),c.error&&d.jsxs("div",{className:"text-xs text-red-500 max-w-32 text-right",children:[c.error.substring(0,50),"..."]})]},c.name))})]}),e.some(c=>!c.available)&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(Jr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Servicios no disponibles"}),d.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Algunos servicios del chat de jardín no están funcionando. Verifica que las funciones Edge estén desplegadas en Supabase."})]})]})}),d.jsxs("div",{className:"flex gap-3 pt-3",children:[d.jsxs(me,{onClick:a,disabled:n,variant:"outline",size:"sm",className:"flex-1 gap-2",children:[d.jsx(ji,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Verificar Nuevamente"]}),d.jsx(me,{onClick:t,variant:"secondary",size:"sm",className:"flex-1",children:"Cerrar"})]})]})]})})})},Rf=({gardenSummary:t,onClearChat:e,onRefresh:r,isRefreshing:n=!1})=>{const i=ar(),[a,s]=w.useState(!1),o=l=>l>=80?"text-green-500":l>=60?"text-green-400":"text-red-500",c=l=>l>=80?"Excelente":l>=60?"Buena":"Necesita atención";return d.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[d.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>i(gt.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:d.jsx(vp,{size:20})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:d.jsx(bp,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardín"}),t&&d.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(oE,{size:12}),t.totalPlants," plantas"]}),d.jsx("span",{className:`font-medium ${o(t.averageHealth)} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:c(t.averageHealth)}),t.urgentActions>0&&d.jsxs(L.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[t.urgentActions," acciones"]})]})]})]})}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnóstico del sistema",children:d.jsx(mE,{size:18})}),r&&d.jsx("button",{onClick:r,disabled:n,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardín",children:d.jsx(L.div,{animate:n?{rotate:360}:{},transition:n?{duration:1,repeat:1/0,ease:"linear"}:{},children:d.jsx(ji,{size:18})})}),d.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:d.jsx(cE,{size:20})})]})]}),d.jsx(ke,{children:a&&d.jsx(nee,{onClose:()=>s(!1)})})]})},iee=({message:t})=>{const e=t.sender==="user",r=()=>{if(!t.context?.queryType)return d.jsx(Go,{size:16});switch(t.context.queryType){case"health_analysis":return d.jsx(En,{size:16});case"care_comparison":return d.jsx(Vf,{size:16});case"disease_prevention":return d.jsx(gN,{size:16});case"growth_tracking":return d.jsx(dE,{size:16});default:return d.jsx(Go,{size:16})}},n=()=>{if(e)return"text-primary-foreground/70";if(!t.context?.queryType)return"text-green-500";switch(t.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2 max-w-[85%]",e?"justify-end ml-auto":"justify-start"),children:[!e&&d.jsx(L.div,{className:Oe("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx("div",{className:n(),children:r()})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:Oe("rounded-2xl px-4 py-3 break-words shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[d.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((i,a)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[i.type==="warning"&&"⚠️ ",i.type==="tip"&&"💡 ",i.type==="recommendation"&&"🌱 ",i.type==="observation"&&"🔎 ",i.title]}),d.jsx("div",{children:i.description}),i.affectedPlants&&i.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",i.affectedPlants.join(", ")]})]},a))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((i,a)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:i.action}),i.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",i.priority]}),i.plantIds&&i.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",i.plantIds.join(", ")]})]},a))})]}),!e&&t.context?.plantsAnalyzed&&t.context.plantsAnalyzed.length>0&&d.jsxs(L.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[d.jsx(Vf,{size:12}),d.jsxs("span",{children:["Analizó ",t.context.plantsAnalyzed.length," planta(s)"]})]}),d.jsx("div",{className:Oe("mt-2 text-xs",e?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:DA(new Date(t.timestamp),{addSuffix:!0,locale:hk})})]})}),e&&d.jsx(L.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx(pN,{size:16,className:"text-primary"})})]})},aee=({onSendMessage:t,isTyping:e,suggestedQuestions:r,isLoading:n=!1})=>{const[i,a]=w.useState(""),[s,o]=w.useState(!0),c=w.useRef(null),l=async()=>{if(e)return;const p=c.current?.value.trim();p&&(o(!1),c.current&&(c.current.value=""),await t(p))},u=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),l())},h=async p=>{a(""),o(!1),await t(p)},m=()=>{r.length>0&&!i&&o(!0)};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsx(ke,{children:s&&r.length>0&&!n&&d.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[d.jsx(er,{size:12}),d.jsx("span",{children:"Preguntas sugeridas"})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((p,v)=>d.jsx(L.button,{onClick:()=>h(p),disabled:e,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:v*.1},whileHover:{scale:1.02},whileTap:{scale:.98},children:p},p))})]})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Bd,{type:"text",ref:c,onKeyDown:u,onFocus:m,placeholder:"Pregúntame sobre tu jardín...",className:"pr-12",disabled:e||n}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(hE,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:l,disabled:!i.trim()||e||n,size:"icon",className:"shrink-0",children:e?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:20})}):d.jsx(fE,{size:20})})]}),n&&d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:12})}),d.jsx("span",{children:"Analizando tu jardín..."})]})]})})},see={plants:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[d.jsx(L.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),d.jsx(L.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:d.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),d.jsx(L.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:d.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),d.jsx(L.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:d.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),d.jsx(L.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),d.jsx(L.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),d.jsx(L.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),d.jsx(L.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[d.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),d.jsx(L.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),d.jsx(L.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),d.jsx(L.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsxs(L.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[d.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),d.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),d.jsxs(L.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[d.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),d.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},oee=({icon:t,title:e,description:r,action:n,illustration:i="plants",className:a})=>d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:Oe("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",a),children:[d.jsx(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:t||see[i]}),d.jsx(L.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:e}),d.jsx(L.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),n&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:d.jsx(me,{onClick:n.onClick,variant:"primary",size:"lg",className:"animate-glow",children:n.label})})]}),cee=()=>{const t=ar(),e=qn(p=>p.plants),{messages:r,isLoading:n,isTyping:i,error:a,gardenSummary:s,suggestedQuestions:o,sendMessage:c,clearMessages:l,retryLastMessage:u,refreshGardenData:h}=eee(),m=w.useRef(null);return w.useEffect(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r,i]),a&&!s?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Rf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexión"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:a}),d.jsxs(me,{onClick:h,variant:"primary",children:[d.jsx(ji,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]}):s?.totalPlants===0?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Rf,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx(oee,{illustration:"plants",title:"Tu jardín está vacío",description:"Agrega algunas plantas a tu jardín para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>t(gt.toCamera())}})})]}):d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Rf,{gardenSummary:s,onClearChat:l,onRefresh:h,isRefreshing:n&&r.length>0}),r.length===0&&e.length>0&&d.jsxs("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:[d.jsx("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Chats individuales con tus plantas:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.slice(0,4).map(p=>d.jsx(Pr,{variant:"glass",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary-300 dark:hover:border-primary-600",onClick:()=>t(gt.toPlantChat(p.id)),children:d.jsx(ei,{className:"p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:d.jsx(bp,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium truncate",children:p.nickname||p.name}),d.jsx("p",{className:"text-xs text-neutral-500 truncate",children:p.species})]}),d.jsx(wc,{className:"w-4 h-4 text-neutral-400"})]})})},p.id)),e.length>4&&d.jsx(Pr,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer",onClick:()=>t(gt.toDashboard()),children:d.jsx(ei,{className:"p-3 flex items-center justify-center",children:d.jsxs("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["+",e.length-4," más"]})})})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsxs("div",{className:"p-4 space-y-4 max-w-4xl mx-auto",children:[d.jsx(ke,{children:r.map(p=>d.jsx(iee,{message:p},p.id))}),i&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:d.jsx(fk,{})}),a&&r.length>0&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-center",children:d.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 max-w-sm",children:[d.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300 text-sm",children:[d.jsx(Jr,{size:16}),d.jsx("span",{children:a})]}),d.jsxs(me,{onClick:u,size:"sm",variant:"outline",className:"mt-2 w-full",children:[d.jsx(ji,{size:14,className:"mr-1"}),"Reintentar"]})]})}),d.jsx("div",{ref:m})]}),!1]}),d.jsx(aee,{onSendMessage:c,isTyping:i,suggestedQuestions:o,isLoading:n})]})},lee=w.lazy(()=>mp(()=>import("./Settings-Df0fELxP.js"),__vite__mapDeps([0,1,2,3,4,5]))),uee=w.lazy(()=>mp(()=>import("./Auth-By8LHb_Y.js"),__vite__mapDeps([6,1,2,4,5,3]))),dee=new Y_({defaultOptions:{queries:{staleTime:yi.QUERY.STALE_TIME.MEDIUM,gcTime:yi.QUERY.GC_TIME.MEDIUM,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:yi.QUERY.RETRY.COUNT,retryDelay:t=>Math.min(yi.QUERY.RETRY.DELAY*2**t,3e4)},mutations:{retry:yi.QUERY.RETRY.COUNT,retryDelay:yi.QUERY.RETRY.DELAY}}}),V_=({message:t})=>d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(md,{className:"w-12 h-12 text-green-500 animate-bounce mb-4"}),d.jsx("p",{className:"text-lg text-muted-foreground",children:t})]}),hee=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/":window.location.pathname.startsWith("/plantitas-app")?"/plantitas-app/":"/",fee=()=>{const t=E4();if(r$(),w.useEffect(()=>{console.log("[APP] useEffect running...");try{const r=n$();return()=>{console.log("[APP] Cleanup running..."),r()}}catch(r){throw fg("APP_INITIALIZATION",r),r}},[]),!t.initialized){const r=t.loading?t.progress.message:t.error||"Inicializando...";return d.jsx(V_,{message:r})}const e=()=>d.jsx(Wv,{children:d.jsxs(sn,{path:"/",element:d.jsx(EF,{}),children:[d.jsx(sn,{index:!0,element:d.jsx(qF,{})}),d.jsx(sn,{path:"camera",element:d.jsx(fJ,{})}),d.jsx(sn,{path:"settings",element:d.jsx(lee,{})}),d.jsx(sn,{path:"garden-chat",element:d.jsx(cee,{})}),d.jsx(sn,{path:"plant/:plantId",element:d.jsx(cJ,{})}),d.jsx(sn,{path:"plant/:plantId/chat",element:d.jsx(QJ,{})}),d.jsx(sn,{path:"*",element:d.jsx(Kh,{to:wt.dashboard,replace:!0})})]})});return d.jsx(Z_,{client:dee,children:d.jsx(e$,{children:d.jsx(TF,{children:d.jsxs(Yk,{basename:hee(),future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[d.jsx(Z4,{position:"top-center",richColors:!0}),d.jsx(s$,{}),d.jsx(w.Suspense,{fallback:d.jsx(V_,{message:"Cargando..."}),children:d.jsxs(Wv,{children:[d.jsx(sn,{path:wt.auth,element:t.user?d.jsx(Kh,{to:wt.dashboard,replace:!0}):d.jsx(uee,{})}),d.jsx(sn,{path:"/*",element:t.user?d.jsx(e,{}):d.jsx(Kh,{to:wt.auth,replace:!0})})]})})]})})})})},mee=w.createContext(void 0),pee=({children:t,defaultTheme:e="system",storageKey:r="vite-ui-theme"})=>{const[n,i]=w.useState(()=>localStorage.getItem(r)||e),a=w.useMemo(()=>n==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,[n]);w.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(a),localStorage.setItem(r,n)},[a,n,r]);const s={theme:n,setTheme:i,resolvedTheme:a};return d.jsx(mee.Provider,{value:s,children:t})};var hp,mk=-1,qc=function(t){addEventListener("pageshow",function(e){e.persisted&&(mk=e.timeStamp,t(e))},!0)},pk=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},rv=function(){var t=pk();return t&&t.activationStart||0},Ui=function(t,e){var r=pk(),n="navigate";return mk>=0?n="back-forward-cache":r&&(document.prerendering||rv()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},Kc=function(t,e,r){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver(function(i){Promise.resolve().then(function(){e(i.getEntries())})});return n.observe(Object.assign({type:t,buffered:!0},r||{})),n}}catch{}},Bi=function(t,e,r,n){var i,a;return function(s){e.value>=0&&(s||n)&&((a=e.value-(i||0))||i===void 0)&&(i=e.value,e.delta=a,e.rating=function(o,c){return o>c[1]?"poor":o>c[0]?"needs-improvement":"good"}(e.value,r),t(e))}},nv=function(t){requestAnimationFrame(function(){return requestAnimationFrame(function(){return t()})})},iv=function(t){var e=function(r){r.type!=="pagehide"&&document.visibilityState!=="hidden"||t(r)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},gk=function(t){var e=!1;return function(r){e||(t(r),e=!0)}},vs=-1,F_=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},hd=function(t){document.visibilityState==="hidden"&&vs>-1&&(vs=t.type==="visibilitychange"?t.timeStamp:0,gee())},z_=function(){addEventListener("visibilitychange",hd,!0),addEventListener("prerenderingchange",hd,!0)},gee=function(){removeEventListener("visibilitychange",hd,!0),removeEventListener("prerenderingchange",hd,!0)},yk=function(){return vs<0&&(vs=F_(),z_(),qc(function(){setTimeout(function(){vs=F_(),z_()},0)})),{get firstHiddenTime(){return vs}}},av=function(t){document.prerendering?addEventListener("prerenderingchange",function(){return t()},!0):t()},U_=[1800,3e3],yee=function(t,e){e=e||{},av(function(){var r,n=yk(),i=Ui("FCP"),a=Kc("paint",function(s){s.forEach(function(o){o.name==="first-contentful-paint"&&(a.disconnect(),o.startTime<n.firstHiddenTime&&(i.value=Math.max(o.startTime-rv(),0),i.entries.push(o),r(!0)))})});a&&(r=Bi(t,i,U_,e.reportAllChanges),qc(function(s){i=Ui("FCP"),r=Bi(t,i,U_,e.reportAllChanges),nv(function(){i.value=performance.now()-s.timeStamp,r(!0)})}))})},B_=[.1,.25],vee=function(t,e){e=e||{},yee(gk(function(){var r,n=Ui("CLS",0),i=0,a=[],s=function(c){c.forEach(function(l){if(!l.hadRecentInput){var u=a[0],h=a[a.length-1];i&&l.startTime-h.startTime<1e3&&l.startTime-u.startTime<5e3?(i+=l.value,a.push(l)):(i=l.value,a=[l])}}),i>n.value&&(n.value=i,n.entries=a,r())},o=Kc("layout-shift",s);o&&(r=Bi(t,n,B_,e.reportAllChanges),iv(function(){s(o.takeRecords()),r(!0)}),qc(function(){i=0,n=Ui("CLS",0),r=Bi(t,n,B_,e.reportAllChanges),nv(function(){return r()})}),setTimeout(r,0))}))},vk=0,Df=1/0,Hl=0,bee=function(t){t.forEach(function(e){e.interactionId&&(Df=Math.min(Df,e.interactionId),Hl=Math.max(Hl,e.interactionId),vk=Hl?(Hl-Df)/7+1:0)})},bk=function(){return hp?vk:performance.interactionCount||0},xee=function(){"interactionCount"in performance||hp||(hp=Kc("event",bee,{type:"event",buffered:!0,durationThreshold:0}))},H_=[200,500],xk=0,W_=function(){return bk()-xk},ln=[],Mf={},q_=function(t){var e=ln[ln.length-1],r=Mf[t.interactionId];if(r||ln.length<10||t.duration>e.latency){if(r)r.entries.push(t),r.latency=Math.max(r.latency,t.duration);else{var n={id:t.interactionId,latency:t.duration,entries:[t]};Mf[n.id]=n,ln.push(n)}ln.sort(function(i,a){return a.latency-i.latency}),ln.splice(10).forEach(function(i){delete Mf[i.id]})}},wee=function(t,e){e=e||{},av(function(){var r;xee();var n,i=Ui("INP"),a=function(o){o.forEach(function(u){u.interactionId&&q_(u),u.entryType==="first-input"&&!ln.some(function(h){return h.entries.some(function(m){return u.duration===m.duration&&u.startTime===m.startTime})})&&q_(u)});var c,l=(c=Math.min(ln.length-1,Math.floor(W_()/50)),ln[c]);l&&l.latency!==i.value&&(i.value=l.latency,i.entries=l.entries,n())},s=Kc("event",a,{durationThreshold:(r=e.durationThreshold)!==null&&r!==void 0?r:40});n=Bi(t,i,H_,e.reportAllChanges),s&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),iv(function(){a(s.takeRecords()),i.value<0&&W_()>0&&(i.value=0,i.entries=[]),n(!0)}),qc(function(){ln=[],xk=bk(),i=Ui("INP"),n=Bi(t,i,H_,e.reportAllChanges)}))})},K_=[2500,4e3],Lf={},_ee=function(t,e){e=e||{},av(function(){var r,n=yk(),i=Ui("LCP"),a=function(c){var l=c[c.length-1];l&&l.startTime<n.firstHiddenTime&&(i.value=Math.max(l.startTime-rv(),0),i.entries=[l],r())},s=Kc("largest-contentful-paint",a);if(s){r=Bi(t,i,K_,e.reportAllChanges);var o=gk(function(){Lf[i.id]||(a(s.takeRecords()),s.disconnect(),Lf[i.id]=!0,r(!0))});["keydown","click"].forEach(function(c){addEventListener(c,function(){return setTimeout(o,0)},!0)}),iv(o),qc(function(c){i=Ui("LCP"),r=Bi(t,i,K_,e.reportAllChanges),nv(function(){i.value=performance.now()-c.timeStamp,Lf[i.id]=!0,r(!0)})})}})};class Eee{constructor(){yr(this,"endpoint");this.endpoint=null}send(e,r){const n={event:e,payload:r,app:"plantitas-app",env:"production"};if("navigator"in window&&"sendBeacon"in navigator&&this.endpoint)try{const i=new Blob([JSON.stringify(n)],{type:"application/json"});navigator.sendBeacon(this.endpoint,i);return}catch{}this.endpoint&&fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},keepalive:!0,body:JSON.stringify(n)}).catch(()=>{})}}const Tee=new Eee;function $f(t){const e={name:t.name,value:t.value,rating:t.rating,id:t.id,navigationType:performance.getEntriesByType("navigation")?.[0]?.type,url:location.href,ts:Date.now()};Tee.send("web-vitals",e)}function Aee(){try{_ee($f,{reportAllChanges:!0}),vee($f,{reportAllChanges:!0}),wee($f,{reportAllChanges:!0})}catch{}}console.log("[MOBILE] 🚨 Main.tsx loading started");console.log("[MOBILE] Location:",window.location.href);console.log("[MOBILE] Pathname:",window.location.pathname);console.log("[MOBILE] User Agent:",navigator.userAgent);window.addEventListener("error",t=>{console.error("[GLOBAL] Uncaught error:",t.error),console.error("[GLOBAL] Error details:",{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,stack:t.error?.stack})});window.addEventListener("unhandledrejection",t=>{console.error("[GLOBAL] Unhandled promise rejection:",t.reason),console.error("[GLOBAL] Promise:",t.promise)});try{o$(),console.log("[MOBILE] Debug system initialized")}catch(t){console.error("[MOBILE] Debug system failed:",t)}const wk=new Y_;function See(){const{user:t}=Nn();return H.useEffect(()=>{t?.id&&wk.prefetchQuery({queryKey:["plants",t.id],queryFn:()=>ps.getUserPlantSummaries(t.id),staleTime:1e3*60*5})},[t?.id]),null}console.log("[MOBILE] Looking for root container...");const _k=document.getElementById("root");if(!_k)throw fg("ROOT_CONTAINER","Root container not found"),new Error("Root container not found");console.log("[MOBILE] Root container found, creating React root...");try{const t=Ff.createRoot(_k);console.log("[MOBILE] React root created, rendering App..."),t.render(d.jsx(H.StrictMode,{children:d.jsx(pee,{children:d.jsxs(Z_,{client:wk,children:[d.jsx(See,{}),d.jsx(fee,{})]})})})),console.log("[MOBILE] App render called successfully")}catch(t){throw fg("REACT_RENDER",t),t}"performance"in window&&Aee();export{me as B,Nn as a,AF as b,Oe as c,yF as g,_F as u};
