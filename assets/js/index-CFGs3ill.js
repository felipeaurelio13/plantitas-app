const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Settings-M4dtofQD.js","assets/js/query-DbrUQU2d.js","assets/js/vendor-DZ-WnDgw.js","assets/js/router-8pqLaH9a.js","assets/js/ui-DPEBMuFB.js","assets/js/supabase-pWErzozG.js","assets/js/Auth-D_VIKI1B.js"])))=>i.map(i=>d[i]);
var uN=Object.defineProperty;var dN=(t,e,r)=>e in t?uN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var yr=(t,e,r)=>dN(t,typeof e!="symbol"?e+"":e,r);import{j as d,u as pd,a as Ai,b as sE,Q as oE,c as cE}from"./query-DbrUQU2d.js";import{a as wp,b as q,r as w,c as hN,g as Hi}from"./vendor-DZ-WnDgw.js";import{_ as _p}from"./supabase-pWErzozG.js";import{u as sr,a as lE,L as fN,O as mN,b as Ep,B as pN,R as e0,c as on,N as Jh}from"./router-8pqLaH9a.js";import{A as ke,m as L,X as Wi,I as uE,T as Tn,C as Jr,a as Si,L as wa,P as Tp,b as Yn,c as Ap,H as cu,B as Xo,S as gN,W as yN,d as dE,R as Oi,e as er,f as _a,D as Ec,g as hE,E as vN,h as Hf,M as Tc,i as fE,j as bN,k as xN,l as wN,n as _N,U as mE,o as pE,p as EN,q as TN,r as gE,s as yE,t as AN,u as gd,v as vE,w as lu,x as bE,y as IN,z as t0,F as Ip,G as xE,J as wE,K as r0,N as SN,O as _E,Q as Sp,V as EE,Y as PN,Z as CN,_ as kN,$ as NN,a0 as jN,a1 as n0,a2 as ON,a3 as RN,a4 as TE,a5 as AE,a6 as IE,a7 as DN,a8 as MN}from"./ui-DPEBMuFB.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Wf={},i0=wp;Wf.createRoot=i0.createRoot,Wf.hydrateRoot=i0.hydrateRoot;const a0=t=>{let e;const r=new Set,n=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const m=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,m))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>c,subscribe:l=>(r.add(l),()=>r.delete(l))},c=e=t(n,i,o);return o},LN=t=>t?a0(t):a0,$N=t=>t;function VN(t,e=$N){const r=q.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return q.useDebugValue(r),r}const s0=t=>{const e=LN(t),r=n=>VN(e,n);return Object.assign(r,e),r},Pp=t=>t?s0(t):s0;var SE=Symbol.for("immer-nothing"),o0=Symbol.for("immer-draftable"),Ir=Symbol.for("immer-state");function Gr(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Ns=Object.getPrototypeOf;function Ca(t){return!!t&&!!t[Ir]}function Zn(t){return t?PE(t)||Array.isArray(t)||!!t[o0]||!!t.constructor?.[o0]||vd(t)||bd(t):!1}var FN=Object.prototype.constructor.toString();function PE(t){if(!t||typeof t!="object")return!1;const e=Ns(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===FN}function uu(t,e){yd(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function yd(t){const e=t[Ir];return e?e.type_:Array.isArray(t)?1:vd(t)?2:bd(t)?3:0}function Kf(t,e){return yd(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function CE(t,e,r){const n=yd(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function zN(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function vd(t){return t instanceof Map}function bd(t){return t instanceof Set}function la(t){return t.copy_||t.base_}function Gf(t,e){if(vd(t))return new Map(t);if(bd(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=PE(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[Ir];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Ns(t),n)}else{const n=Ns(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function Cp(t,e=!1){return xd(t)||Ca(t)||!Zn(t)||(yd(t)>1&&(t.set=t.add=t.clear=t.delete=UN),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Cp(n,!0))),t}function UN(){Gr(2)}function xd(t){return Object.isFrozen(t)}var BN={};function ka(t){const e=BN[t];return e||Gr(0,t),e}var Jo;function kE(){return Jo}function qN(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function c0(t,e){e&&(ka("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Yf(t){Zf(t),t.drafts_.forEach(HN),t.drafts_=null}function Zf(t){t===Jo&&(Jo=t.parent_)}function l0(t){return Jo=qN(Jo,t)}function HN(t){const e=t[Ir];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function u0(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[Ir].modified_&&(Yf(e),Gr(4)),Zn(t)&&(t=du(e,t),e.parent_||hu(e,t)),e.patches_&&ka("Patches").generateReplacementPatches_(r[Ir].base_,t,e.patches_,e.inversePatches_)):t=du(e,r,[]),Yf(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==SE?t:void 0}function du(t,e,r){if(xd(e))return e;const n=e[Ir];if(!n)return uu(e,(i,a)=>d0(t,n,e,i,a,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return hu(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),uu(a,(o,c)=>d0(t,n,i,o,c,r,s)),hu(t,i,!1),r&&t.patches_&&ka("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function d0(t,e,r,n,i,a,s){if(Ca(i)){const o=a&&e&&e.type_!==3&&!Kf(e.assigned_,n)?a.concat(n):void 0,c=du(t,i,o);if(CE(r,n,c),Ca(c))t.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Zn(i)&&!xd(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;du(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&hu(t,i)}}function hu(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Cp(e,r)}function WN(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:kE(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=kp;r&&(i=[n],a=ec);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var kp={get(t,e){if(e===Ir)return t;const r=la(t);if(!Kf(r,e))return KN(t,r,e);const n=r[e];return t.finalized_||!Zn(n)?n:n===ef(t.base_,e)?(tf(t),t.copy_[e]=Xf(n,t)):n},has(t,e){return e in la(t)},ownKeys(t){return Reflect.ownKeys(la(t))},set(t,e,r){const n=NE(la(t),e);if(n?.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=ef(la(t),e),a=i?.[Ir];if(a&&a.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(zN(r,i)&&(r!==void 0||Kf(t.base_,e)))return!0;tf(t),Qf(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return ef(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,tf(t),Qf(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=la(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){Gr(11)},getPrototypeOf(t){return Ns(t.base_)},setPrototypeOf(){Gr(12)}},ec={};uu(kp,(t,e)=>{ec[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});ec.deleteProperty=function(t,e){return ec.set.call(this,t,e,void 0)};ec.set=function(t,e,r){return kp.set.call(this,t[0],e,r,t[0])};function ef(t,e){const r=t[Ir];return(r?la(r):t)[e]}function KN(t,e,r){const n=NE(e,r);return n?"value"in n?n.value:n.get?.call(t.draft_):void 0}function NE(t,e){if(!(e in t))return;let r=Ns(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Ns(r)}}function Qf(t){t.modified_||(t.modified_=!0,t.parent_&&Qf(t.parent_))}function tf(t){t.copy_||(t.copy_=Gf(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var GN=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const a=r;r=e;const s=this;return function(c=a,...l){return s.produce(c,u=>r.call(this,u,...l))}}typeof r!="function"&&Gr(6),n!==void 0&&typeof n!="function"&&Gr(7);let i;if(Zn(e)){const a=l0(this),s=Xf(e,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Yf(a):Zf(a)}return c0(a,n),u0(i,a)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===SE&&(i=void 0),this.autoFreeze_&&Cp(i,!0),n){const a=[],s=[];ka("Patches").generateReplacementPatches_(e,i,a,s),n(a,s)}return i}else Gr(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(s,...o)=>this.produceWithPatches(s,c=>e(c,...o));let n,i;return[this.produce(e,r,(s,o)=>{n=s,i=o}),n,i]},typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof t?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Zn(t)||Gr(8),Ca(t)&&(t=Bn(t));const e=l0(this),r=Xf(t,void 0);return r[Ir].isManual_=!0,Zf(e),r}finishDraft(t,e){const r=t&&t[Ir];(!r||!r.isManual_)&&Gr(9);const{scope_:n}=r;return c0(n,e),u0(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=ka("Patches").applyPatches_;return Ca(t)?n(t,e):this.produce(t,i=>n(i,e))}};function Xf(t,e){const r=vd(t)?ka("MapSet").proxyMap_(t,e):bd(t)?ka("MapSet").proxySet_(t,e):WN(t,e);return(e?e.scope_:kE()).drafts_.push(r),r}function Bn(t){return Ca(t)||Gr(10,t),jE(t)}function jE(t){if(!Zn(t)||xd(t))return t;const e=t[Ir];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Gf(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Gf(t,!0);return uu(r,(n,i)=>{CE(r,n,jE(i))}),e&&(e.finalized_=!1),r}var Sr=new GN,Ie=Sr.produce;Sr.produceWithPatches.bind(Sr);Sr.setAutoFreeze.bind(Sr);Sr.setUseStrictShallowCopy.bind(Sr);Sr.applyPatches.bind(Sr);Sr.createDraft.bind(Sr);Sr.finishDraft.bind(Sr);const YN=()=>{};var h0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OE=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},ZN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],s=t[r++],o=t[r++],c=((i&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|s&63)}}return e.join("")},RE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],s=i+1<t.length,o=s?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,u=a>>2,h=(a&3)<<4|o>>4;let m=(o&15)<<2|l>>6,p=l&63;c||(p=64,s||(m=64)),n.push(r[u],r[h],r[m],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(OE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ZN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;const l=i<t.length?r[t.charAt(i)]:64;++i;const h=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||o==null||l==null||h==null)throw new QN;const m=a<<2|o>>4;if(n.push(m),l!==64){const p=o<<4&240|l>>2;if(n.push(p),h!==64){const v=l<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class QN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XN=function(t){const e=OE(t);return RE.encodeByteArray(e,!0)},fu=function(t){return XN(t).replace(/\./g,"")},DE=function(t){try{return RE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej=()=>JN().__FIREBASE_DEFAULTS__,tj=()=>{if(typeof process>"u"||typeof h0>"u")return;const t=h0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&DE(t[1]);return e&&JSON.parse(e)},wd=()=>{try{return YN()||ej()||tj()||rj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ME=t=>wd()?.emulatorHosts?.[t],LE=t=>{const e=ME(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},$E=()=>wd()?.config,VE=t=>wd()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Np(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...t};return[fu(JSON.stringify(r)),fu(JSON.stringify(s)),""].join(".")}const Uo={};function ij(){const t={prod:[],emulator:[]};for(const e of Object.keys(Uo))Uo[e]?t.emulator.push(e):t.prod.push(e);return t}function aj(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let f0=!1;function jp(t,e){if(typeof window>"u"||typeof document>"u"||!Ba(window.location.host)||Uo[t]===e||Uo[t]||f0)return;Uo[t]=e;function r(m){return`__firebase__banner__${m}`}const n="__firebase__banner",a=ij().prod.length>0;function s(){const m=document.getElementById(n);m&&m.remove()}function o(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function c(m,p){m.setAttribute("width","24"),m.setAttribute("id",p),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function l(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{f0=!0,s()},m}function u(m,p){m.setAttribute("id",p),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function h(){const m=aj(n),p=r("text"),v=document.getElementById(p)||document.createElement("span"),b=r("learnmore"),g=document.getElementById(b)||document.createElement("a"),_=r("preprendIcon"),T=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const E=m.element;o(E),u(g,b);const j=l();c(T,_),E.append(T,v,g,j),document.body.appendChild(E)}a?(v.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(tr())}function oj(){const t=wd()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function cj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function uj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dj(){const t=tr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function hj(){return!oj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fj(){try{return typeof indexedDB=="object"}catch{return!1}}function mj(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj="FirebaseError";class Cn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=pj,Object.setPrototypeOf(this,Cn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ac.prototype.create)}}class Ac{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],s=a?gj(a,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new Cn(i,o,n)}}function gj(t,e){return t.replace(yj,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const yj=/\{\$([^}]+)}/g;function vj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Na(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],s=e[i];if(m0(a)&&m0(s)){if(!Na(a,s))return!1}else if(a!==s)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function m0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Oo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function Ro(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function bj(t,e){const r=new xj(t,e);return r.subscribe.bind(r)}class xj{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");wj(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=rf),i.error===void 0&&(i.error=rf),i.complete===void 0&&(i.complete=rf);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wj(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function rf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(t){return t&&t._delegate?t._delegate:t}class Ri{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _j=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new nj;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tj(e))try{this.getOrInitializeService({instanceIdentifier:ua})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=ua){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ua){return this.instances.has(e)}getOptions(e=ua){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(a);n===o&&s.resolve(i)}return i}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const a=this.instances.get(n);return a&&e(a,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Ej(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ua){return this.component?this.component.multipleInstances?e:ua:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Ej(t){return t===ua?void 0:t}function Tj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new _j(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const Ij={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},Sj=xe.INFO,Pj={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},Cj=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Pj[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Op{constructor(e){this.name=e,this._logLevel=Sj,this._logHandler=Cj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Ij[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const kj=(t,e)=>e.some(r=>t instanceof r);let p0,g0;function Nj(){return p0||(p0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jj(){return g0||(g0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zE=new WeakMap,Jf=new WeakMap,UE=new WeakMap,nf=new WeakMap,Rp=new WeakMap;function Oj(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",s)},a=()=>{r(Pi(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",s)});return e.then(r=>{r instanceof IDBCursor&&zE.set(r,t)}).catch(()=>{}),Rp.set(e,t),e}function Rj(t){if(Jf.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",s),t.removeEventListener("abort",s)},a=()=>{r(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",s),t.addEventListener("abort",s)});Jf.set(t,e)}let em={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Jf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||UE.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Pi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Dj(t){em=t(em)}function Mj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(af(this),e,...r);return UE.set(n,e.sort?e.sort():[e]),Pi(n)}:jj().includes(t)?function(...e){return t.apply(af(this),e),Pi(zE.get(this))}:function(...e){return Pi(t.apply(af(this),e))}}function Lj(t){return typeof t=="function"?Mj(t):(t instanceof IDBTransaction&&Rj(t),kj(t,Nj())?new Proxy(t,em):t)}function Pi(t){if(t instanceof IDBRequest)return Oj(t);if(nf.has(t))return nf.get(t);const e=Lj(t);return e!==t&&(nf.set(t,e),Rp.set(e,t)),e}const af=t=>Rp.get(t);function $j(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const s=indexedDB.open(t,e),o=Pi(s);return n&&s.addEventListener("upgradeneeded",c=>{n(Pi(s.result),c.oldVersion,c.newVersion,Pi(s.transaction),c)}),r&&s.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{a&&c.addEventListener("close",()=>a()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}const Vj=["get","getKey","getAll","getAllKeys","count"],Fj=["put","add","delete","clear"],sf=new Map;function y0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(sf.get(e))return sf.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Fj.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Vj.includes(r)))return;const a=async function(s,...o){const c=this.transaction(s,i?"readwrite":"readonly");let l=c.store;return n&&(l=l.index(o.shift())),(await Promise.all([l[r](...o),i&&c.done]))[0]};return sf.set(e,a),a}Dj(t=>({...t,get:(e,r,n)=>y0(e,r)||t.get(e,r,n),has:(e,r)=>!!y0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(Uj(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function Uj(t){return t.getComponent()?.type==="VERSION"}const tm="@firebase/app",v0="0.14.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn=new Op("@firebase/app"),Bj="@firebase/app-compat",qj="@firebase/analytics-compat",Hj="@firebase/analytics",Wj="@firebase/app-check-compat",Kj="@firebase/app-check",Gj="@firebase/auth",Yj="@firebase/auth-compat",Zj="@firebase/database",Qj="@firebase/data-connect",Xj="@firebase/database-compat",Jj="@firebase/functions",eO="@firebase/functions-compat",tO="@firebase/installations",rO="@firebase/installations-compat",nO="@firebase/messaging",iO="@firebase/messaging-compat",aO="@firebase/performance",sO="@firebase/performance-compat",oO="@firebase/remote-config",cO="@firebase/remote-config-compat",lO="@firebase/storage",uO="@firebase/storage-compat",dO="@firebase/firestore",hO="@firebase/ai",fO="@firebase/firestore-compat",mO="firebase",pO="12.0.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="[DEFAULT]",gO={[tm]:"fire-core",[Bj]:"fire-core-compat",[Hj]:"fire-analytics",[qj]:"fire-analytics-compat",[Kj]:"fire-app-check",[Wj]:"fire-app-check-compat",[Gj]:"fire-auth",[Yj]:"fire-auth-compat",[Zj]:"fire-rtdb",[Qj]:"fire-data-connect",[Xj]:"fire-rtdb-compat",[Jj]:"fire-fn",[eO]:"fire-fn-compat",[tO]:"fire-iid",[rO]:"fire-iid-compat",[nO]:"fire-fcm",[iO]:"fire-fcm-compat",[aO]:"fire-perf",[sO]:"fire-perf-compat",[oO]:"fire-rc",[cO]:"fire-rc-compat",[lO]:"fire-gcs",[uO]:"fire-gcs-compat",[dO]:"fire-fst",[fO]:"fire-fst-compat",[hO]:"fire-vertex","fire-js":"fire-js",[mO]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=new Map,yO=new Map,nm=new Map;function b0(t,e){try{t.container.addComponent(e)}catch(r){Qn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ja(t){const e=t.name;if(nm.has(e))return Qn.debug(`There were multiple attempts to register component ${e}.`),!1;nm.set(e,t);for(const r of mu.values())b0(r,t);for(const r of yO.values())b0(r,t);return!0}function _d(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _r(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ci=new Ac("app","Firebase",vO);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ci.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=pO;function BE(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:rm,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw Ci.create("bad-app-name",{appName:String(i)});if(r||(r=$E()),!r)throw Ci.create("no-options");const a=mu.get(i);if(a){if(Na(r,a.options)&&Na(n,a.config))return a;throw Ci.create("duplicate-app",{appName:i})}const s=new Aj(i);for(const c of nm.values())s.addComponent(c);const o=new bO(r,n,s);return mu.set(i,o),o}function Dp(t=rm){const e=mu.get(t);if(!e&&t===rm&&$E())return BE();if(!e)throw Ci.create("no-app",{appName:t});return e}function pn(t,e,r){let n=gO[t]??t;r&&(n+=`-${r}`);const i=n.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const s=[`Unable to register library "${n}" with version "${e}":`];i&&s.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&a&&s.push("and"),a&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qn.warn(s.join(" "));return}ja(new Ri(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO="firebase-heartbeat-database",wO=1,tc="firebase-heartbeat-store";let of=null;function qE(){return of||(of=$j(xO,wO,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(tc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ci.create("idb-open",{originalErrorMessage:t.message})})),of}async function _O(t){try{const r=(await qE()).transaction(tc),n=await r.objectStore(tc).get(HE(t));return await r.done,n}catch(e){if(e instanceof Cn)Qn.warn(e.message);else{const r=Ci.create("idb-get",{originalErrorMessage:e?.message});Qn.warn(r.message)}}}async function x0(t,e){try{const n=(await qE()).transaction(tc,"readwrite");await n.objectStore(tc).put(e,HE(t)),await n.done}catch(r){if(r instanceof Cn)Qn.warn(r.message);else{const n=Ci.create("idb-set",{originalErrorMessage:r?.message});Qn.warn(n.message)}}}function HE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=1024,TO=30;class AO{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new SO(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=w0();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>TO){const i=PO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Qn.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=w0(),{heartbeatsToSend:r,unsentEntries:n}=IO(this._heartbeatsCache.heartbeats),i=fu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Qn.warn(e),""}}}function w0(){return new Date().toISOString().substring(0,10)}function IO(t,e=EO){const r=[];let n=t.slice();for(const i of t){const a=r.find(s=>s.agent===i.agent);if(a){if(a.dates.push(i.date),_0(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),_0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class SO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fj()?mj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await _O(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return x0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return x0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function _0(t){return fu(JSON.stringify({version:2,heartbeats:t})).length}function PO(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CO(t){ja(new Ri("platform-logger",e=>new zj(e),"PRIVATE")),ja(new Ri("heartbeat",e=>new AO(e),"PRIVATE")),pn(tm,v0,t),pn(tm,v0,"esm2020"),pn("fire-js","")}CO("");var kO="firebase",NO="12.0.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(kO,NO,"app");function WE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jO=WE,KE=new Ac("auth","Firebase",WE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pu=new Op("@firebase/auth");function OO(t,...e){pu.logLevel<=xe.WARN&&pu.warn(`Auth (${qa}): ${t}`,...e)}function Gl(t,...e){pu.logLevel<=xe.ERROR&&pu.error(`Auth (${qa}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t,...e){throw Mp(t,...e)}function gn(t,...e){return Mp(t,...e)}function GE(t,e,r){const n={...jO(),[e]:r};return new Ac("auth","Firebase",n).create(e,{appName:t.name})}function qn(t){return GE(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mp(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return KE.create(t,...e)}function le(t,e,...r){if(!t)throw Mp(e,...r)}function Vn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Gl(e),new Error(e)}function Xn(t,e){t||Vn(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(){return typeof self<"u"&&self.location?.href||""}function RO(){return E0()==="http:"||E0()==="https:"}function E0(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(RO()||lj()||"connection"in navigator)?navigator.onLine:!0}function MO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,r){this.shortDelay=e,this.longDelay=r,Xn(r>e,"Short delay should be less than long delay!"),this.isMobile=sj()||uj()}get(){return DO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lp(t,e){Xn(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],VO=new Sc(3e4,6e4);function Ki(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Gi(t,e,r,n,i={}){return ZE(t,i,async()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const o=Ic({key:t.config.apiKey,...s}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const l={method:e,headers:c,...a};return cj()||(l.referrerPolicy="no-referrer"),t.emulatorConfig&&Ba(t.emulatorConfig.host)&&(l.credentials="include"),YE.fetch()(await QE(t,t.config.apiHost,r,o),l)})}async function ZE(t,e,r){t._canInitEmulator=!1;const n={...LO,...e};try{const i=new zO(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw bl(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const o=a.ok?s.errorMessage:s.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw bl(t,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw bl(t,"email-already-in-use",s);if(c==="USER_DISABLED")throw bl(t,"user-disabled",s);const u=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw GE(t,u,l);en(t,u)}}catch(i){if(i instanceof Cn)throw i;en(t,"network-request-failed",{message:String(i)})}}async function Pc(t,e,r,n,i={}){const a=await Gi(t,e,r,n,i);return"mfaPendingCredential"in a&&en(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function QE(t,e,r,n){const i=`${e}${r}?${n}`,a=t,s=a.config.emulator?Lp(t.config,i):`${t.config.apiScheme}://${i}`;return $O.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(s).toString():s}function FO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(gn(this.auth,"network-request-failed")),VO.get())})}}function bl(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=gn(t,e,n);return i.customData._tokenResponse=r,i}function T0(t){return t!==void 0&&t.enterprise!==void 0}class UO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return FO(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function BO(t,e){return Gi(t,"GET","/v2/recaptchaConfig",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qO(t,e){return Gi(t,"POST","/v1/accounts:delete",e)}async function gu(t,e){return Gi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HO(t,e=!1){const r=rr(t),n=await r.getIdToken(e),i=$p(n);le(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,s=a?.sign_in_provider;return{claims:i,token:n,authTime:Bo(cf(i.auth_time)),issuedAtTime:Bo(cf(i.iat)),expirationTime:Bo(cf(i.exp)),signInProvider:s||null,signInSecondFactor:a?.sign_in_second_factor||null}}function cf(t){return Number(t)*1e3}function $p(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Gl("JWT malformed, contained fewer than 3 sections"),null;try{const i=DE(r);return i?JSON.parse(i):(Gl("Failed to decode base64 JWT payload"),null)}catch(i){return Gl("Caught error parsing JWT payload as JSON",i?.toString()),null}}function A0(t){const e=$p(t);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Cn&&WO(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function WO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bo(this.lastLoginAt),this.creationTime=Bo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yu(t){const e=t.auth,r=await t.getIdToken(),n=await rc(t,gu(e,{idToken:r}));le(n?.users.length,e,"internal-error");const i=n.users[0];t._notifyReloadListener(i);const a=i.providerUserInfo?.length?XE(i.providerUserInfo):[],s=YO(t.providerData,a),o=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!s?.length,l=o?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new am(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(t,u)}async function GO(t){const e=rr(t);await yu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function YO(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function XE(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZO(t,e){const r=await ZE(t,{},async()=>{const n=Ic({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,s=await QE(t,i,"/v1/token",`key=${a}`),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return t.emulatorConfig&&Ba(t.emulatorConfig.host)&&(c.credentials="include"),YE.fetch()(s,c)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function QO(t,e){return Gi(t,"POST","/v2/accounts:revokeToken",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):A0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){le(e.length!==0,"internal-error");const r=A0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await ZO(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,s=new _s;return n&&(le(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),i&&(le(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),a&&(le(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _s,this.toJSON())}_performRefresh(){return Vn("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(t,e){le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:r,stsTokenManager:n,...i}){this.providerId="firebase",this.proactiveRefresh=new KO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new am(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await rc(this,this.stsTokenManager.getToken(this.auth,e));return le(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return HO(this,e)}reload(){return GO(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await yu(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_r(this.auth.app))return Promise.reject(qn(this.auth));const e=await this.getIdToken();return await rc(this,qO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,i=r.email??void 0,a=r.phoneNumber??void 0,s=r.photoURL??void 0,o=r.tenantId??void 0,c=r._redirectEventId??void 0,l=r.createdAt??void 0,u=r.lastLoginAt??void 0,{uid:h,emailVerified:m,isAnonymous:p,providerData:v,stsTokenManager:b}=r;le(h&&b,e,"internal-error");const g=_s.fromJSON(this.name,b);le(typeof h=="string",e,"internal-error"),fi(n,e.name),fi(i,e.name),le(typeof m=="boolean",e,"internal-error"),le(typeof p=="boolean",e,"internal-error"),fi(a,e.name),fi(s,e.name),fi(o,e.name),fi(c,e.name),fi(l,e.name),fi(u,e.name);const _=new Zr({uid:h,auth:e,email:i,emailVerified:m,displayName:n,isAnonymous:p,photoURL:s,phoneNumber:a,tenantId:o,stsTokenManager:g,createdAt:l,lastLoginAt:u});return v&&Array.isArray(v)&&(_.providerData=v.map(T=>({...T}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(e,r,n=!1){const i=new _s;i.updateFromServerResponse(r);const a=new Zr({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await yu(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];le(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?XE(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!a?.length,o=new _s;o.updateFromIdToken(n);const c=new Zr({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new am(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,l),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new Map;function Fn(t){Xn(t instanceof Function,"Expected a class definition");let e=I0.get(t);return e?(Xn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,I0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}JE.type="NONE";const S0=JE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yl(t,e,r){return`firebase:${t}:${e}:${r}`}class Es{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Yl(this.userKey,i.apiKey,a),this.fullPersistenceKey=Yl("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await gu(this.auth,{idToken:e}).catch(()=>{});return r?Zr._fromGetAccountInfoResponse(this.auth,r,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Es(Fn(S0),e,n);const i=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let a=i[0]||Fn(S0);const s=Yl(n,e.config.apiKey,e.name);let o=null;for(const l of r)try{const u=await l._get(s);if(u){let h;if(typeof u=="string"){const m=await gu(e,{idToken:u}).catch(()=>{});if(!m)break;h=await Zr._fromGetAccountInfoResponse(e,m,u)}else h=Zr._fromJSON(e,u);l!==a&&(o=h),a=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new Es(a,e,n):(a=c[0],o&&await a._set(s,o.toJSON()),await Promise.all(r.map(async l=>{if(l!==a)try{await l._remove(s)}catch{}})),new Es(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(n1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(e1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a1(e))return"Blackberry";if(s1(e))return"Webos";if(t1(e))return"Safari";if((e.includes("chrome/")||r1(e))&&!e.includes("edge/"))return"Chrome";if(i1(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function e1(t=tr()){return/firefox\//i.test(t)}function t1(t=tr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function r1(t=tr()){return/crios\//i.test(t)}function n1(t=tr()){return/iemobile/i.test(t)}function i1(t=tr()){return/android/i.test(t)}function a1(t=tr()){return/blackberry/i.test(t)}function s1(t=tr()){return/webos/i.test(t)}function Vp(t=tr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function XO(t=tr()){return Vp(t)&&!!window.navigator?.standalone}function JO(){return dj()&&document.documentMode===10}function o1(t=tr()){return Vp(t)||i1(t)||s1(t)||a1(t)||/windows phone/i.test(t)||n1(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(t,e=[]){let r;switch(t){case"Browser":r=P0(tr());break;case"Worker":r=`${P0(tr())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${qa}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((s,o)=>{try{const c=e(a);s(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tR(t,e={}){return Gi(t,"GET","/v2/passwordPolicy",Ki(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=6;class nR{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??rR,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new C0(this),this.idTokenSubscription=new C0(this),this.beforeStateQueue=new eR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Fn(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Es.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await gu(this,{idToken:e}),n=await Zr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_r(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=this.redirectUser?._redirectEventId,s=n?._redirectEventId,o=await this.tryRedirectSignIn(e);(!a||a===s)&&o?.user&&(n=o.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await yu(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_r(this.app))return Promise.reject(qn(this));const r=e?rr(e):null;return r&&le(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _r(this.app)?Promise.reject(qn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _r(this.app)?Promise.reject(qn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fn(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await tR(this),r=new nR(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ac("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await QO(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Fn(e)||this._popupRedirectResolver;le(r,this,"argument-error"),this.redirectPersistenceManager=await Es.create(this,[Fn(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(o,this,"internal-error"),o.then(()=>{s||a(this.currentUser)}),typeof r=="function"){const c=e.addObserver(r,n,i);return()=>{s=!0,c()}}else{const c=e.addObserver(r);return()=>{s=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(_r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&OO(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ha(t){return rr(t)}class C0{constructor(e){this.auth=e,this.observer=null,this.addObserver=bj(r=>this.observer=r)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ed={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function aR(t){Ed=t}function l1(t){return Ed.loadJS(t)}function sR(){return Ed.recaptchaEnterpriseScript}function oR(){return Ed.gapiScript}function cR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class lR{constructor(){this.enterprise=new uR}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class uR{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const dR="recaptcha-enterprise",u1="NO_RECAPTCHA";class hR{constructor(e){this.type=dR,this.auth=Ha(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(s,o)=>{BO(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const l=new UO(c);return a.tenantId==null?a._agentRecaptchaConfig=l:a._tenantRecaptchaConfigs[a.tenantId]=l,s(l.siteKey)}}).catch(c=>{o(c)})})}function i(a,s,o){const c=window.grecaptcha;T0(c)?c.enterprise.ready(()=>{c.enterprise.execute(a,{action:e}).then(l=>{s(l)}).catch(()=>{s(u1)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lR().execute("siteKey",{action:"verify"}):new Promise((a,s)=>{n(this.auth).then(o=>{if(!r&&T0(window.grecaptcha))i(o,a,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let c=sR();c.length!==0&&(c+=o),l1(c).then(()=>{i(o,a,s)}).catch(l=>{s(l)})}}).catch(o=>{s(o)})})}}async function k0(t,e,r,n=!1,i=!1){const a=new hR(t);let s;if(i)s=u1;else try{s=await a.verify(r)}catch{s=await a.verify(r,!0)}const o={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,l=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:l,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function sm(t,e,r,n,i){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await k0(t,e,r,r==="getOobCode");return n(t,a)}else return n(t,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await k0(t,e,r,r==="getOobCode");return n(t,s)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(t,e){const r=_d(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(Na(a,e??{}))return i;en(i,"already-initialized")}return r.initialize({options:e})}function mR(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Fn);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function pR(t,e,r){const n=Ha(t);le(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=d1(e),{host:s,port:o}=gR(e),c=o===null?"":`:${o}`,l={url:`${a}//${s}${c}/`},u=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){le(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),le(Na(l,n.config.emulator)&&Na(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=l,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,Ba(s)?(Np(`${a}//${s}${c}`),jp("Auth",!0)):yR()}function d1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function gR(t){const e=d1(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:N0(n.substr(a.length+1))}}else{const[a,s]=n.split(":");return{host:a,port:N0(s)}}}function N0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function yR(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Vn("not implemented")}_getIdTokenResponse(e){return Vn("not implemented")}_linkToIdToken(e,r){return Vn("not implemented")}_getReauthenticationResolver(e){return Vn("not implemented")}}async function vR(t,e){return Gi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bR(t,e){return Pc(t,"POST","/v1/accounts:signInWithPassword",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(t,e){return Pc(t,"POST","/v1/accounts:signInWithEmailLink",Ki(t,e))}async function wR(t,e){return Pc(t,"POST","/v1/accounts:signInWithEmailLink",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc extends Fp{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new nc(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new nc(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sm(e,r,"signInWithPassword",bR);case"emailLink":return xR(e,{email:this._email,oobCode:this._password});default:en(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return sm(e,n,"signUpPassword",vR);case"emailLink":return wR(e,{idToken:r,email:this._email,oobCode:this._password});default:en(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ts(t,e){return Pc(t,"POST","/v1/accounts:signInWithIdp",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="http://localhost";class Oa extends Fp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Oa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):en("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i,...a}=r;if(!n||!i)return null;const s=new Oa(n,i);return s.idToken=a.idToken||void 0,s.accessToken=a.accessToken||void 0,s.secret=a.secret,s.nonce=a.nonce,s.pendingToken=a.pendingToken||null,s}_getIdTokenResponse(e){const r=this.buildRequest();return Ts(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ts(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ts(e,r)}buildRequest(){const e={requestUri:_R,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Ic(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TR(t){const e=Oo(Ro(t)).link,r=e?Oo(Ro(e)).deep_link_id:null,n=Oo(Ro(t)).deep_link_id;return(n?Oo(Ro(n)).link:null)||n||r||e||t}class zp{constructor(e){const r=Oo(Ro(e)),n=r.apiKey??null,i=r.oobCode??null,a=ER(r.mode??null);le(n&&i&&a,"argument-error"),this.apiKey=n,this.operation=a,this.code=i,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=TR(e);try{return new zp(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(){this.providerId=Hs.PROVIDER_ID}static credential(e,r){return nc._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=zp.parseLink(r);return le(n,"argument-error"),nc._fromEmailAndCode(e,n.code,n.tenantId)}}Hs.PROVIDER_ID="password";Hs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc extends h1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Cc{constructor(){super("facebook.com")}static credential(e){return Oa._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xi.credential(e.oauthAccessToken)}catch{return null}}}xi.FACEBOOK_SIGN_IN_METHOD="facebook.com";xi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends Cc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Oa._fromParams({providerId:wi.PROVIDER_ID,signInMethod:wi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return wi.credentialFromTaggedObject(e)}static credentialFromError(e){return wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return wi.credential(r,n)}catch{return null}}}wi.GOOGLE_SIGN_IN_METHOD="google.com";wi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends Cc{constructor(){super("github.com")}static credential(e){return Oa._fromParams({providerId:_i.PROVIDER_ID,signInMethod:_i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _i.credentialFromTaggedObject(e)}static credentialFromError(e){return _i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _i.credential(e.oauthAccessToken)}catch{return null}}}_i.GITHUB_SIGN_IN_METHOD="github.com";_i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Cc{constructor(){super("twitter.com")}static credential(e,r){return Oa._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ei.credential(r,n)}catch{return null}}}Ei.TWITTER_SIGN_IN_METHOD="twitter.com";Ei.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AR(t,e){return Pc(t,"POST","/v1/accounts:signUp",Ki(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await Zr._fromIdTokenResponse(e,n,i),s=j0(n);return new Ra({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=j0(n);return new Ra({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function j0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends Cn{constructor(e,r,n,i){super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,vu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new vu(e,r,n,i)}}function f1(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?vu._fromErrorAndOperation(t,a,e,n):a})}async function IR(t,e,r=!1){const n=await rc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Ra._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SR(t,e,r=!1){const{auth:n}=t;if(_r(n.app))return Promise.reject(qn(n));const i="reauthenticate";try{const a=await rc(t,f1(n,i,e,t),r);le(a.idToken,n,"internal-error");const s=$p(a.idToken);le(s,n,"internal-error");const{sub:o}=s;return le(t.uid===o,n,"user-mismatch"),Ra._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&en(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m1(t,e,r=!1){if(_r(t.app))return Promise.reject(qn(t));const n="signIn",i=await f1(t,n,e),a=await Ra._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function PR(t,e){return m1(Ha(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p1(t){const e=Ha(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CR(t,e,r){if(_r(t.app))return Promise.reject(qn(t));const n=Ha(t),s=await sm(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AR).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&p1(t),c}),o=await Ra._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(o.user),o}function kR(t,e,r){return _r(t.app)?Promise.reject(qn(t)):PR(rr(t),Hs.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&p1(t),n})}function NR(t,e,r,n){return rr(t).onIdTokenChanged(e,r,n)}function jR(t,e,r){return rr(t).beforeAuthStateChanged(e,r)}function OR(t,e,r,n){return rr(t).onAuthStateChanged(e,r,n)}function RR(t){return rr(t).signOut()}const bu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(bu,"1"),this.storage.removeItem(bu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=1e3,MR=10;class y1 extends g1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=o1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,o,c)=>{this.notifyListeners(s,c)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);JO()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,MR):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},DR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}y1.type="LOCAL";const LR=y1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1 extends g1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}v1.type="SESSION";const b1=v1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Td(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,s=this.handlersMap[i];if(!s?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async l=>l(r.origin,a)),c=await $R(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,s;return new Promise((o,c)=>{const l=Up("",20);i.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(h){const m=h;if(m.data.eventId===l)switch(m.data.status){case"ack":clearTimeout(u),a=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(m.data.response);break;default:clearTimeout(u),clearTimeout(a),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(){return window}function FR(t){yn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(){return typeof yn().WorkerGlobalScope<"u"&&typeof yn().importScripts=="function"}async function zR(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function UR(){return navigator?.serviceWorker?.controller||null}function BR(){return x1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1="firebaseLocalStorageDb",qR=1,xu="firebaseLocalStorage",_1="fbase_key";class kc{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Ad(t,e){return t.transaction([xu],e?"readwrite":"readonly").objectStore(xu)}function HR(){const t=indexedDB.deleteDatabase(w1);return new kc(t).toPromise()}function om(){const t=indexedDB.open(w1,qR);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(xu,{keyPath:_1})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(xu)?e(n):(n.close(),await HR(),e(await om()))})})}async function O0(t,e,r){const n=Ad(t,!0).put({[_1]:e,value:r});return new kc(n).toPromise()}async function WR(t,e){const r=Ad(t,!1).get(e),n=await new kc(r).toPromise();return n===void 0?null:n.value}function R0(t,e){const r=Ad(t,!0).delete(e);return new kc(r).toPromise()}const KR=800,GR=3;class E1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await om(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>GR)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return x1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Td._getInstance(BR()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await zR(),!this.activeServiceWorker)return;this.sender=new VR(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||UR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await om();return await O0(e,bu,"1"),await R0(e,bu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>O0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>WR(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>R0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Ad(i,!1).getAll();return new kc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),KR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}E1.type="LOCAL";const YR=E1;new Sc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZR(t,e){return e?Fn(e):(le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp extends Fp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ts(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ts(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ts(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function QR(t){return m1(t.auth,new Bp(t),t.bypassAuthState)}function XR(t){const{auth:e,user:r}=t;return le(r,e,"internal-error"),SR(r,new Bp(t),t.bypassAuthState)}async function JR(t){const{auth:e,user:r}=t;return le(r,e,"internal-error"),IR(r,new Bp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:s,type:o}=e;if(s){this.reject(s);return}const c={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QR;case"linkViaPopup":case"linkViaRedirect":return JR;case"reauthViaPopup":case"reauthViaRedirect":return XR;default:en(this.auth,"internal-error")}}resolve(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2=new Sc(2e3,1e4);class ys extends T1{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,ys.currentPopupAction&&ys.currentPopupAction.cancel(),ys.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return le(e,this.auth,"internal-error"),e}async onExecution(){Xn(this.filter.length===1,"Popup operations only handle one event");const e=Up();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(gn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ys.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,e2.get())};e()}}ys.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2="pendingRedirect",Zl=new Map;class r2 extends T1{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Zl.get(this.auth._key());if(!e){try{const n=await n2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Zl.set(this.auth._key(),e)}return this.bypassAuthState||Zl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n2(t,e){const r=s2(e),n=a2(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function i2(t,e){Zl.set(t._key(),e)}function a2(t){return Fn(t._redirectPersistence)}function s2(t){return Yl(t2,t.config.apiKey,t.name)}async function o2(t,e,r=!1){if(_r(t.app))return Promise.reject(qn(t));const n=Ha(t),i=ZR(n,e),s=await new r2(n,i,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2=10*60*1e3;class l2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!u2(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!A1(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(gn(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c2&&this.cachedEventUids.clear(),this.cachedEventUids.has(D0(e))}saveEventToCache(e){this.cachedEventUids.add(D0(e)),this.lastProcessedEventTime=Date.now()}}function D0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function A1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function u2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return A1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d2(t,e={}){return Gi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,f2=/^https?/;async function m2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await d2(t);for(const r of e)try{if(p2(r))return}catch{}en(t,"unauthorized-domain")}function p2(t){const e=im(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!f2.test(r))return!1;if(h2.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g2=new Sc(3e4,6e4);function M0(){const t=yn().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function y2(t){return new Promise((e,r)=>{function n(){M0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{M0(),r(gn(t,"network-request-failed"))},timeout:g2.get()})}if(yn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(yn().gapi?.load)n();else{const i=cR("iframefcb");return yn()[i]=()=>{gapi.load?n():r(gn(t,"network-request-failed"))},l1(`${oR()}?onload=${i}`).catch(a=>r(a))}}).catch(e=>{throw Ql=null,e})}let Ql=null;function v2(t){return Ql=Ql||y2(t),Ql}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2=new Sc(5e3,15e3),x2="__/auth/iframe",w2="emulator/auth/iframe",_2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T2(t){const e=t.config;le(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Lp(e,w2):`https://${t.config.authDomain}/${x2}`,n={apiKey:e.apiKey,appName:t.name,v:qa},i=E2.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${Ic(n).slice(1)}`}async function A2(t){const e=await v2(t),r=yn().gapi;return le(r,t,"internal-error"),e.open({where:document.body,url:T2(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_2,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const s=gn(t,"network-request-failed"),o=yn().setTimeout(()=>{a(s)},b2.get());function c(){yn().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S2=500,P2=600,C2="_blank",k2="http://localhost";class L0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N2(t,e,r,n=S2,i=P2){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c={...I2,width:n.toString(),height:i.toString(),top:a,left:s},l=tr().toLowerCase();r&&(o=r1(l)?C2:r),e1(l)&&(e=e||k2,c.scrollbars="yes");const u=Object.entries(c).reduce((m,[p,v])=>`${m}${p}=${v},`,"");if(XO(l)&&o!=="_self")return j2(e||"",o),new L0(null);const h=window.open(e||"",o,u);le(h,t,"popup-blocked");try{h.focus()}catch{}return new L0(h)}function j2(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="__/auth/handler",R2="emulator/auth/handler",D2=encodeURIComponent("fac");async function $0(t,e,r,n,i,a){le(t.config.authDomain,t,"auth-domain-config-required"),le(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:qa,eventId:i};if(e instanceof h1){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",vj(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))s[u]=h}if(e instanceof Cc){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(s.scopes=u.join(","))}t.tenantId&&(s.tid=t.tenantId);const o=s;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const c=await t._getAppCheckToken(),l=c?`#${D2}=${encodeURIComponent(c)}`:"";return`${M2(t)}?${Ic(o).slice(1)}${l}`}function M2({config:t}){return t.emulator?Lp(t,R2):`https://${t.authDomain}/${O2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lf="webStorageSupport";class L2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=b1,this._completeRedirectFn=o2,this._overrideRedirectResult=i2}async _openPopup(e,r,n,i){Xn(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const a=await $0(e,r,n,im(),i);return N2(e,a,Up())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await $0(e,r,n,im(),i);return FR(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(Xn(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await A2(e),n=new l2(e);return r.register("authEvent",i=>(le(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(lf,{type:lf},i=>{const a=i?.[0]?.[lf];a!==void 0&&r(!!a),en(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=m2(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return o1()||t1()||Vp()}}const $2=L2;var V0="@firebase/auth",F0="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function z2(t){ja(new Ri("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;le(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:s,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c1(t)},l=new iR(n,i,a,c);return mR(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ja(new Ri("auth-internal",e=>{const r=Ha(e.getProvider("auth").getImmediate());return(n=>new V2(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),pn(V0,F0,F2(t)),pn(V0,F0,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=5*60,B2=VE("authIdTokenMaxAge")||U2;let z0=null;const q2=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>B2)return;const i=r?.token;z0!==i&&(z0=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function H2(t=Dp()){const e=_d(t,"auth");if(e.isInitialized())return e.getImmediate();const r=fR(t,{popupRedirectResolver:$2,persistence:[YR,LR,b1]}),n=VE("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const s=q2(a.toString());jR(r,s,()=>s(r.currentUser)),NR(r,o=>s(o))}}const i=ME("auth");return i&&pR(r,`http://${i}`),r}function W2(){return document.getElementsByTagName("head")?.[0]??document}aR({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=gn("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",W2().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});z2("Browser");var U0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ki,I1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function P(){}P.prototype=A.prototype,I.D=A.prototype,I.prototype=new P,I.prototype.constructor=I,I.C=function(O,N,C){for(var k=Array(arguments.length-2),J=2;J<arguments.length;J++)k[J-2]=arguments[J];return A.prototype[N].apply(O,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,A,P){P||(P=0);var O=Array(16);if(typeof A=="string")for(var N=0;16>N;++N)O[N]=A.charCodeAt(P++)|A.charCodeAt(P++)<<8|A.charCodeAt(P++)<<16|A.charCodeAt(P++)<<24;else for(N=0;16>N;++N)O[N]=A[P++]|A[P++]<<8|A[P++]<<16|A[P++]<<24;A=I.g[0],P=I.g[1],N=I.g[2];var C=I.g[3],k=A+(C^P&(N^C))+O[0]+3614090360&4294967295;A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[1]+3905402710&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[2]+606105819&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[3]+3250441966&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[4]+4118548399&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[5]+1200080426&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[6]+2821735955&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[7]+4249261313&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[8]+1770035416&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[9]+2336552879&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[10]+4294925233&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[11]+2304563134&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(C^P&(N^C))+O[12]+1804603682&4294967295,A=P+(k<<7&4294967295|k>>>25),k=C+(N^A&(P^N))+O[13]+4254626195&4294967295,C=A+(k<<12&4294967295|k>>>20),k=N+(P^C&(A^P))+O[14]+2792965006&4294967295,N=C+(k<<17&4294967295|k>>>15),k=P+(A^N&(C^A))+O[15]+1236535329&4294967295,P=N+(k<<22&4294967295|k>>>10),k=A+(N^C&(P^N))+O[1]+4129170786&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[6]+3225465664&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[11]+643717713&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[0]+3921069994&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[5]+3593408605&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[10]+38016083&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[15]+3634488961&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[4]+3889429448&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[9]+568446438&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[14]+3275163606&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[3]+4107603335&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[8]+1163531501&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(N^C&(P^N))+O[13]+2850285829&4294967295,A=P+(k<<5&4294967295|k>>>27),k=C+(P^N&(A^P))+O[2]+4243563512&4294967295,C=A+(k<<9&4294967295|k>>>23),k=N+(A^P&(C^A))+O[7]+1735328473&4294967295,N=C+(k<<14&4294967295|k>>>18),k=P+(C^A&(N^C))+O[12]+2368359562&4294967295,P=N+(k<<20&4294967295|k>>>12),k=A+(P^N^C)+O[5]+4294588738&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[8]+2272392833&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[11]+1839030562&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[14]+4259657740&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[1]+2763975236&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[4]+1272893353&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[7]+4139469664&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[10]+3200236656&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[13]+681279174&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[0]+3936430074&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[3]+3572445317&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[6]+76029189&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(P^N^C)+O[9]+3654602809&4294967295,A=P+(k<<4&4294967295|k>>>28),k=C+(A^P^N)+O[12]+3873151461&4294967295,C=A+(k<<11&4294967295|k>>>21),k=N+(C^A^P)+O[15]+530742520&4294967295,N=C+(k<<16&4294967295|k>>>16),k=P+(N^C^A)+O[2]+3299628645&4294967295,P=N+(k<<23&4294967295|k>>>9),k=A+(N^(P|~C))+O[0]+4096336452&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[7]+1126891415&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[14]+2878612391&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[5]+4237533241&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[12]+1700485571&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[3]+2399980690&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[10]+4293915773&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[1]+2240044497&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[8]+1873313359&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[15]+4264355552&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[6]+2734768916&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[13]+1309151649&4294967295,P=N+(k<<21&4294967295|k>>>11),k=A+(N^(P|~C))+O[4]+4149444226&4294967295,A=P+(k<<6&4294967295|k>>>26),k=C+(P^(A|~N))+O[11]+3174756917&4294967295,C=A+(k<<10&4294967295|k>>>22),k=N+(A^(C|~P))+O[2]+718787259&4294967295,N=C+(k<<15&4294967295|k>>>17),k=P+(C^(N|~A))+O[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(N+(k<<21&4294967295|k>>>11))&4294967295,I.g[2]=I.g[2]+N&4294967295,I.g[3]=I.g[3]+C&4294967295}n.prototype.u=function(I,A){A===void 0&&(A=I.length);for(var P=A-this.blockSize,O=this.B,N=this.h,C=0;C<A;){if(N==0)for(;C<=P;)i(this,I,C),C+=this.blockSize;if(typeof I=="string"){for(;C<A;)if(O[N++]=I.charCodeAt(C++),N==this.blockSize){i(this,O),N=0;break}}else for(;C<A;)if(O[N++]=I[C++],N==this.blockSize){i(this,O),N=0;break}}this.h=N,this.o+=A},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;var P=8*this.o;for(A=I.length-8;A<I.length;++A)I[A]=P&255,P/=256;for(this.u(I),I=Array(16),A=P=0;4>A;++A)for(var O=0;32>O;O+=8)I[P++]=this.g[A]>>>O&255;return I};function a(I,A){var P=o;return Object.prototype.hasOwnProperty.call(P,I)?P[I]:P[I]=A(I)}function s(I,A){this.h=A;for(var P=[],O=!0,N=I.length-1;0<=N;N--){var C=I[N]|0;O&&C==A||(P[N]=C,O=!1)}this.g=P}var o={};function c(I){return-128<=I&&128>I?a(I,function(A){return new s([A|0],0>A?-1:0)}):new s([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return g(l(-I));for(var A=[],P=1,O=0;I>=P;O++)A[O]=I/P|0,P*=4294967296;return new s(A,0)}function u(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return g(u(I.substring(1),A));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=l(Math.pow(A,8)),O=h,N=0;N<I.length;N+=8){var C=Math.min(8,I.length-N),k=parseInt(I.substring(N,N+C),A);8>C?(C=l(Math.pow(A,C)),O=O.j(C).add(l(k))):(O=O.j(P),O=O.add(l(k)))}return O}var h=c(0),m=c(1),p=c(16777216);t=s.prototype,t.m=function(){if(b(this))return-g(this).m();for(var I=0,A=1,P=0;P<this.g.length;P++){var O=this.i(P);I+=(0<=O?O:4294967296+O)*A,A*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(b(this))return"-"+g(this).toString(I);for(var A=l(Math.pow(I,6)),P=this,O="";;){var N=j(P,A).g;P=_(P,N.j(A));var C=((0<P.g.length?P.g[0]:P.h)>>>0).toString(I);if(P=N,v(P))return C+O;for(;6>C.length;)C="0"+C;O=C+O}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function b(I){return I.h==-1}t.l=function(I){return I=_(this,I),b(I)?-1:v(I)?0:1};function g(I){for(var A=I.g.length,P=[],O=0;O<A;O++)P[O]=~I.g[O];return new s(P,~I.h).add(m)}t.abs=function(){return b(this)?g(this):this},t.add=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],O=0,N=0;N<=A;N++){var C=O+(this.i(N)&65535)+(I.i(N)&65535),k=(C>>>16)+(this.i(N)>>>16)+(I.i(N)>>>16);O=k>>>16,C&=65535,k&=65535,P[N]=k<<16|C}return new s(P,P[P.length-1]&-2147483648?-1:0)};function _(I,A){return I.add(g(A))}t.j=function(I){if(v(this)||v(I))return h;if(b(this))return b(I)?g(this).j(g(I)):g(g(this).j(I));if(b(I))return g(this.j(g(I)));if(0>this.l(p)&&0>I.l(p))return l(this.m()*I.m());for(var A=this.g.length+I.g.length,P=[],O=0;O<2*A;O++)P[O]=0;for(O=0;O<this.g.length;O++)for(var N=0;N<I.g.length;N++){var C=this.i(O)>>>16,k=this.i(O)&65535,J=I.i(N)>>>16,oe=I.i(N)&65535;P[2*O+2*N]+=k*oe,T(P,2*O+2*N),P[2*O+2*N+1]+=C*oe,T(P,2*O+2*N+1),P[2*O+2*N+1]+=k*J,T(P,2*O+2*N+1),P[2*O+2*N+2]+=C*J,T(P,2*O+2*N+2)}for(O=0;O<A;O++)P[O]=P[2*O+1]<<16|P[2*O];for(O=A;O<2*A;O++)P[O]=0;return new s(P,0)};function T(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function E(I,A){this.g=I,this.h=A}function j(I,A){if(v(A))throw Error("division by zero");if(v(I))return new E(h,h);if(b(I))return A=j(g(I),A),new E(g(A.g),g(A.h));if(b(A))return A=j(I,g(A)),new E(g(A.g),A.h);if(30<I.g.length){if(b(I)||b(A))throw Error("slowDivide_ only works with positive integers.");for(var P=m,O=A;0>=O.l(I);)P=R(P),O=R(O);var N=D(P,1),C=D(O,1);for(O=D(O,2),P=D(P,2);!v(O);){var k=C.add(O);0>=k.l(I)&&(N=N.add(P),C=k),O=D(O,1),P=D(P,1)}return A=_(I,N.j(A)),new E(N,A)}for(N=h;0<=I.l(A);){for(P=Math.max(1,Math.floor(I.m()/A.m())),O=Math.ceil(Math.log(P)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),C=l(P),k=C.j(A);b(k)||0<k.l(I);)P-=O,C=l(P),k=C.j(A);v(C)&&(C=m),N=N.add(C),I=_(I,k)}return new E(N,I)}t.A=function(I){return j(this,I).h},t.and=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)&I.i(O);return new s(P,this.h&I.h)},t.or=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)|I.i(O);return new s(P,this.h|I.h)},t.xor=function(I){for(var A=Math.max(this.g.length,I.g.length),P=[],O=0;O<A;O++)P[O]=this.i(O)^I.i(O);return new s(P,this.h^I.h)};function R(I){for(var A=I.g.length+1,P=[],O=0;O<A;O++)P[O]=I.i(O)<<1|I.i(O-1)>>>31;return new s(P,I.h)}function D(I,A){var P=A>>5;A%=32;for(var O=I.g.length-P,N=[],C=0;C<O;C++)N[C]=0<A?I.i(C+P)>>>A|I.i(C+P+1)<<32-A:I.i(C+P);return new s(N,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,I1=n,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=u,ki=s}).apply(typeof U0<"u"?U0:typeof self<"u"?self:typeof window<"u"?window:{});var xl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var S1,Do,P1,Xl,cm,C1,k1,N1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,y,x){return f==Array.prototype||f==Object.prototype||(f[y]=x.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof xl=="object"&&xl];for(var y=0;y<f.length;++y){var x=f[y];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var n=r(this);function i(f,y){if(y)e:{var x=n;f=f.split(".");for(var S=0;S<f.length-1;S++){var M=f[S];if(!(M in x))break e;x=x[M]}f=f[f.length-1],S=x[f],y=y(S),y!=S&&y!=null&&e(x,f,{configurable:!0,writable:!0,value:y})}}function a(f,y){f instanceof String&&(f+="");var x=0,S=!1,M={next:function(){if(!S&&x<f.length){var $=x++;return{value:y($,f[$]),done:!1}}return S=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(f){return f||function(){return a(this,function(y,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},o=this||self;function c(f){var y=typeof f;return y=y!="object"?y:f?Array.isArray(f)?"array":y:"null",y=="array"||y=="object"&&typeof f.length=="number"}function l(f){var y=typeof f;return y=="object"&&f!=null||y=="function"}function u(f,y,x){return f.call.apply(f.bind,arguments)}function h(f,y,x){if(!f)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,S),f.apply(y,M)}}return function(){return f.apply(y,arguments)}}function m(f,y,x){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,m.apply(null,arguments)}function p(f,y){var x=Array.prototype.slice.call(arguments,1);return function(){var S=x.slice();return S.push.apply(S,arguments),f.apply(this,S)}}function v(f,y){function x(){}x.prototype=y.prototype,f.aa=y.prototype,f.prototype=new x,f.prototype.constructor=f,f.Qb=function(S,M,$){for(var H=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)H[Me-2]=arguments[Me];return y.prototype[M].apply(S,H)}}function b(f){const y=f.length;if(0<y){const x=Array(y);for(let S=0;S<y;S++)x[S]=f[S];return x}return[]}function g(f,y){for(let x=1;x<arguments.length;x++){const S=arguments[x];if(c(S)){const M=f.length||0,$=S.length||0;f.length=M+$;for(let H=0;H<$;H++)f[M+H]=S[H]}else f.push(S)}}class _{constructor(y,x){this.i=y,this.j=x,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function T(f){return/^[\s\xa0]*$/.test(f)}function E(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function j(f){return j[" "](f),f}j[" "]=function(){};var R=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function D(f,y,x){for(const S in f)y.call(x,f[S],S,f)}function I(f,y){for(const x in f)y.call(void 0,f[x],x,f)}function A(f){const y={};for(const x in f)y[x]=f[x];return y}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(f,y){let x,S;for(let M=1;M<arguments.length;M++){S=arguments[M];for(x in S)f[x]=S[x];for(let $=0;$<P.length;$++)x=P[$],Object.prototype.hasOwnProperty.call(S,x)&&(f[x]=S[x])}}function N(f){var y=1;f=f.split(":");const x=[];for(;0<y&&f.length;)x.push(f.shift()),y--;return f.length&&x.push(f.join(":")),x}function C(f){o.setTimeout(()=>{throw f},0)}function k(){var f=ye;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}class J{constructor(){this.h=this.g=null}add(y,x){const S=oe.get();S.set(y,x),this.h?this.h.next=S:this.g=S,this.h=S}}var oe=new _(()=>new X,f=>f.reset());class X{constructor(){this.next=this.g=this.h=null}set(y,x){this.h=y,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let te,he=!1,ye=new J,Be=()=>{const f=o.Promise.resolve(void 0);te=()=>{f.then(se)}};var se=()=>{for(var f;f=k();){try{f.h.call(f.g)}catch(x){C(x)}var y=oe;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}he=!1};function W(){this.s=this.s,this.C=this.C}W.prototype.s=!1,W.prototype.ma=function(){this.s||(this.s=!0,this.N())},W.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var rt=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const x=()=>{};o.addEventListener("test",x,y),o.removeEventListener("test",x,y)}catch{}return f}();function Fe(f,y){if(ee.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var x=this.type=f.type,S=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(R){e:{try{j(y.nodeName);var M=!0;break e}catch{}M=!1}M||(y=null)}}else x=="mouseover"?y=f.fromElement:x=="mouseout"&&(y=f.toElement);this.relatedTarget=y,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:ze[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Fe.aa.h.call(this)}}v(Fe,ee);var ze={2:"touch",3:"pen",4:"mouse"};Fe.prototype.h=function(){Fe.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),nn=0;function Y(f,y,x,S,M){this.listener=f,this.proxy=null,this.src=y,this.type=x,this.capture=!!S,this.ha=M,this.key=++nn,this.da=this.fa=!1}function de(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function be(f){this.src=f,this.g={},this.h=0}be.prototype.add=function(f,y,x,S,M){var $=f.toString();f=this.g[$],f||(f=this.g[$]=[],this.h++);var H=dt(f,y,S,M);return-1<H?(y=f[H],x||(y.fa=!1)):(y=new Y(y,this.src,$,!!S,M),y.fa=x,f.push(y)),y};function B(f,y){var x=y.type;if(x in f.g){var S=f.g[x],M=Array.prototype.indexOf.call(S,y,void 0),$;($=0<=M)&&Array.prototype.splice.call(S,M,1),$&&(de(y),f.g[x].length==0&&(delete f.g[x],f.h--))}}function dt(f,y,x,S){for(var M=0;M<f.length;++M){var $=f[M];if(!$.da&&$.listener==y&&$.capture==!!x&&$.ha==S)return M}return-1}var Te="closure_lm_"+(1e6*Math.random()|0),xt={};function wt(f,y,x,S,M){if(Array.isArray(y)){for(var $=0;$<y.length;$++)wt(f,y[$],x,S,M);return null}return x=Xc(x),f&&f[Cr]?f.K(y,x,l(S)?!!S.capture:!1,M):nr(f,y,x,!1,S,M)}function nr(f,y,x,S,M,$){if(!y)throw Error("Invalid event type");var H=l(M)?!!M.capture:!!M,Me=an(f);if(Me||(f[Te]=Me=new be(f)),x=Me.add(y,x,S,H,$),x.proxy)return x;if(S=ea(),x.proxy=S,S.src=f,S.listener=x,f.addEventListener)rt||(M=H),M===void 0&&(M=!1),f.addEventListener(y.toString(),S,M);else if(f.attachEvent)f.attachEvent(Qc(y.toString()),S);else if(f.addListener&&f.removeListener)f.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return x}function ea(){function f(x){return y.call(f.src,f.listener,x)}const y=ir;return f}function kr(f,y,x,S,M){if(Array.isArray(y))for(var $=0;$<y.length;$++)kr(f,y[$],x,S,M);else S=l(S)?!!S.capture:!!S,x=Xc(x),f&&f[Cr]?(f=f.i,y=String(y).toString(),y in f.g&&($=f.g[y],x=dt($,x,S,M),-1<x&&(de($[x]),Array.prototype.splice.call($,x,1),$.length==0&&(delete f.g[y],f.h--)))):f&&(f=an(f))&&(y=f.g[y.toString()],f=-1,y&&(f=dt(y,x,S,M)),(x=-1<f?y[f]:null)&&so(x))}function so(f){if(typeof f!="number"&&f&&!f.da){var y=f.src;if(y&&y[Cr])B(y.i,f);else{var x=f.type,S=f.proxy;y.removeEventListener?y.removeEventListener(x,S,f.capture):y.detachEvent?y.detachEvent(Qc(x),S):y.addListener&&y.removeListener&&y.removeListener(S),(x=an(y))?(B(x,f),x.h==0&&(x.src=null,y[Te]=null)):de(f)}}}function Qc(f){return f in xt?xt[f]:xt[f]="on"+f}function ir(f,y){if(f.da)f=!0;else{y=new Fe(y,this);var x=f.listener,S=f.ha||f.src;f.fa&&so(f),f=x.call(S,y)}return f}function an(f){return f=f[Te],f instanceof be?f:null}var oo="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xc(f){return typeof f=="function"?f:(f[oo]||(f[oo]=function(y){return f.handleEvent(y)}),f[oo])}function at(){W.call(this),this.i=new be(this),this.M=this,this.F=null}v(at,W),at.prototype[Cr]=!0,at.prototype.removeEventListener=function(f,y,x,S){kr(this,f,y,x,S)};function Ot(f,y){var x,S=f.F;if(S)for(x=[];S;S=S.F)x.push(S);if(f=f.M,S=y.type||y,typeof y=="string")y=new ee(y,f);else if(y instanceof ee)y.target=y.target||f;else{var M=y;y=new ee(S,f),O(y,M)}if(M=!0,x)for(var $=x.length-1;0<=$;$--){var H=y.g=x[$];M=ta(H,S,!0,y)&&M}if(H=y.g=f,M=ta(H,S,!0,y)&&M,M=ta(H,S,!1,y)&&M,x)for($=0;$<x.length;$++)H=y.g=x[$],M=ta(H,S,!1,y)&&M}at.prototype.N=function(){if(at.aa.N.call(this),this.i){var f=this.i,y;for(y in f.g){for(var x=f.g[y],S=0;S<x.length;S++)de(x[S]);delete f.g[y],f.h--}}this.F=null},at.prototype.K=function(f,y,x,S){return this.i.add(String(f),y,!1,x,S)},at.prototype.L=function(f,y,x,S){return this.i.add(String(f),y,!0,x,S)};function ta(f,y,x,S){if(y=f.i.g[String(y)],!y)return!0;y=y.concat();for(var M=!0,$=0;$<y.length;++$){var H=y[$];if(H&&!H.da&&H.capture==x){var Me=H.listener,Mt=H.ha||H.src;H.fa&&B(f.i,H),M=Me.call(Mt,S)!==!1&&M}}return M&&!S.defaultPrevented}function is(f,y,x){if(typeof f=="function")x&&(f=m(f,x));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:o.setTimeout(f,y||0)}function jn(f){f.g=is(()=>{f.g=null,f.i&&(f.i=!1,jn(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}class Jc extends W{constructor(y,x){super(),this.m=y,this.l=x,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:jn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(f){W.call(this),this.h=f,this.g={}}v(Nr,W);var el=[];function tl(f){D(f.g,function(y,x){this.g.hasOwnProperty(x)&&so(y)},f),f.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),tl(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var as=o.JSON.stringify,rl=o.JSON.parse,Fh=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function ra(){}ra.prototype.h=null;function Hr(f){return f.h||(f.h=f.i())}function nl(){}var na={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ss(){ee.call(this,"d")}v(ss,ee);function os(){ee.call(this,"c")}v(os,ee);var ce={},st=null;function ot(){return st=st||new at}ce.La="serverreachability";function Wt(f){ee.call(this,ce.La,f)}v(Wt,ee);function sn(f){const y=ot();Ot(y,new Wt(y))}ce.STAT_EVENT="statevent";function ht(f,y){ee.call(this,ce.STAT_EVENT,f),this.stat=y}v(ht,ee);function Re(f){const y=ot();Ot(y,new ht(y,f))}ce.Ma="timingevent";function ia(f,y){ee.call(this,ce.Ma,f),this.size=y}v(ia,ee);function Rt(f,y){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},y)}function Dt(){this.g=!0}Dt.prototype.xa=function(){this.g=!1};function il(f,y,x,S,M,$){f.info(function(){if(f.g)if($)for(var H="",Me=$.split("&"),Mt=0;Mt<Me.length;Mt++){var Se=Me[Mt].split("=");if(1<Se.length){var Kt=Se[0];Se=Se[1];var Gt=Kt.split("_");H=2<=Gt.length&&Gt[1]=="type"?H+(Kt+"="+Se+"&"):H+(Kt+"=redacted&")}}else H=null;else H=$;return"XMLHTTP REQ ("+S+") [attempt "+M+"]: "+y+`
`+x+`
`+H})}function On(f,y,x,S,M,$,H){f.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+M+"]: "+y+`
`+x+`
`+$+" "+H})}function aa(f,y,x,S){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+qk(f,x)+(S?" "+S:"")})}function Bk(f,y){f.info(function(){return"TIMEOUT: "+y})}Dt.prototype.info=function(){};function qk(f,y){if(!f.g)return y;if(!y)return null;try{var x=JSON.parse(y);if(x){for(f=0;f<x.length;f++)if(Array.isArray(x[f])){var S=x[f];if(!(2>S.length)){var M=S[1];if(Array.isArray(M)&&!(1>M.length)){var $=M[0];if($!="noop"&&$!="stop"&&$!="close")for(var H=1;H<M.length;H++)M[H]=""}}}}return as(x)}catch{return y}}var al={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},zh;function sl(){}v(sl,ra),sl.prototype.g=function(){return new XMLHttpRequest},sl.prototype.i=function(){return{}},zh=new sl;function ui(f,y,x,S){this.j=f,this.i=y,this.l=x,this.R=S||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new gv}function gv(){this.i=null,this.g="",this.h=!1}var yv={},Uh={};function Bh(f,y,x){f.L=1,f.v=ul(Rn(y)),f.m=x,f.P=!0,vv(f,null)}function vv(f,y){f.F=Date.now(),ol(f),f.A=Rn(f.v);var x=f.A,S=f.R;Array.isArray(S)||(S=[String(S)]),jv(x.i,"t",S),f.C=0,x=f.j.J,f.h=new gv,f.g=Zv(f.j,x?y:null,!f.m),0<f.O&&(f.M=new Jc(m(f.Y,f,f.g),f.O)),y=f.U,x=f.g,S=f.ca;var M="readystatechange";Array.isArray(M)||(M&&(el[0]=M.toString()),M=el);for(var $=0;$<M.length;$++){var H=wt(x,M[$],S||y.handleEvent,!1,y.h||y);if(!H)break;y.g[H.key]=H}y=f.H?A(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),sn(),il(f.i,f.u,f.A,f.l,f.R,f.m)}ui.prototype.ca=function(f){f=f.target;const y=this.M;y&&Dn(f)==3?y.j():this.Y(f)},ui.prototype.Y=function(f){try{if(f==this.g)e:{const Gt=Dn(this.g);var y=this.g.Ba();const us=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||Vv(this.g)))){this.J||Gt!=4||y==7||(y==8||0>=us?sn(3):sn(2)),qh(this);var x=this.g.Z();this.X=x;t:if(bv(this)){var S=Vv(this.g);f="";var M=S.length,$=Dn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){sa(this),co(this);var H="";break t}this.h.i=new o.TextDecoder}for(y=0;y<M;y++)this.h.h=!0,f+=this.h.i.decode(S[y],{stream:!($&&y==M-1)});S.length=0,this.h.g+=f,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=x==200,On(this.i,this.u,this.A,this.l,this.R,Gt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,Mt=this.g;if((Me=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(Me)){var Se=Me;break t}}Se=null}if(x=Se)aa(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hh(this,x);else{this.o=!1,this.s=3,Re(12),sa(this),co(this);break e}}if(this.P){x=!0;let Wr;for(;!this.J&&this.C<H.length;)if(Wr=Hk(this,H),Wr==Uh){Gt==4&&(this.s=4,Re(14),x=!1),aa(this.i,this.l,null,"[Incomplete Response]");break}else if(Wr==yv){this.s=4,Re(15),aa(this.i,this.l,H,"[Invalid Chunk]"),x=!1;break}else aa(this.i,this.l,Wr,null),Hh(this,Wr);if(bv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||H.length!=0||this.h.h||(this.s=1,Re(16),x=!1),this.o=this.o&&x,!x)aa(this.i,this.l,H,"[Invalid Chunked Response]"),sa(this),co(this);else if(0<H.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),Qh(Kt),Kt.M=!0,Re(11))}}else aa(this.i,this.l,H,null),Hh(this,H);Gt==4&&sa(this),this.o&&!this.J&&(Gt==4?Wv(this.j,this):(this.o=!1,ol(this)))}else cN(this.g),x==400&&0<H.indexOf("Unknown SID")?(this.s=3,Re(12)):(this.s=0,Re(13)),sa(this),co(this)}}}catch{}finally{}};function bv(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function Hk(f,y){var x=f.C,S=y.indexOf(`
`,x);return S==-1?Uh:(x=Number(y.substring(x,S)),isNaN(x)?yv:(S+=1,S+x>y.length?Uh:(y=y.slice(S,S+x),f.C=S+x,y)))}ui.prototype.cancel=function(){this.J=!0,sa(this)};function ol(f){f.S=Date.now()+f.I,xv(f,f.I)}function xv(f,y){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Rt(m(f.ba,f),y)}function qh(f){f.B&&(o.clearTimeout(f.B),f.B=null)}ui.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(Bk(this.i,this.A),this.L!=2&&(sn(),Re(17)),sa(this),this.s=2,co(this)):xv(this,this.S-f)};function co(f){f.j.G==0||f.J||Wv(f.j,f)}function sa(f){qh(f);var y=f.M;y&&typeof y.ma=="function"&&y.ma(),f.M=null,tl(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function Hh(f,y){try{var x=f.j;if(x.G!=0&&(x.g==f||Wh(x.h,f))){if(!f.K&&Wh(x.h,f)&&x.G==3){try{var S=x.Da.g.parse(y)}catch{S=null}if(Array.isArray(S)&&S.length==3){var M=S;if(M[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<f.F)gl(x),ml(x);else break e;Zh(x),Re(18)}}else x.za=M[1],0<x.za-x.T&&37500>M[2]&&x.F&&x.v==0&&!x.C&&(x.C=Rt(m(x.Za,x),6e3));if(1>=Ev(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else ca(x,11)}else if((f.K||x.g==f)&&gl(x),!T(y))for(M=x.Da.g.parse(y),y=0;y<M.length;y++){let Se=M[y];if(x.T=Se[0],Se=Se[1],x.G==2)if(Se[0]=="c"){x.K=Se[1],x.ia=Se[2];const Kt=Se[3];Kt!=null&&(x.la=Kt,x.j.info("VER="+x.la));const Gt=Se[4];Gt!=null&&(x.Aa=Gt,x.j.info("SVER="+x.Aa));const us=Se[5];us!=null&&typeof us=="number"&&0<us&&(S=1.5*us,x.L=S,x.j.info("backChannelRequestTimeoutMs_="+S)),S=x;const Wr=f.g;if(Wr){const vl=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vl){var $=S.h;$.g||vl.indexOf("spdy")==-1&&vl.indexOf("quic")==-1&&vl.indexOf("h2")==-1||($.j=$.l,$.g=new Set,$.h&&(Kh($,$.h),$.h=null))}if(S.D){const Xh=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xh&&(S.ya=Xh,qe(S.I,S.D,Xh))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-f.F,x.j.info("Handshake RTT: "+x.R+"ms")),S=x;var H=f;if(S.qa=Yv(S,S.J?S.ia:null,S.W),H.K){Tv(S.h,H);var Me=H,Mt=S.L;Mt&&(Me.I=Mt),Me.B&&(qh(Me),ol(Me)),S.g=H}else qv(S);0<x.i.length&&pl(x)}else Se[0]!="stop"&&Se[0]!="close"||ca(x,7);else x.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?ca(x,7):Yh(x):Se[0]!="noop"&&x.l&&x.l.ta(Se),x.v=0)}}sn(4)}catch{}}var Wk=class{constructor(f,y){this.g=f,this.map=y}};function wv(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _v(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ev(f){return f.h?1:f.g?f.g.size:0}function Wh(f,y){return f.h?f.h==y:f.g?f.g.has(y):!1}function Kh(f,y){f.g?f.g.add(y):f.h=y}function Tv(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}wv.prototype.cancel=function(){if(this.i=Av(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Av(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let y=f.i;for(const x of f.g.values())y=y.concat(x.D);return y}return b(f.i)}function Kk(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var y=[],x=f.length,S=0;S<x;S++)y.push(f[S]);return y}y=[],x=0;for(S in f)y[x++]=f[S];return y}function Gk(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var y=[];f=f.length;for(var x=0;x<f;x++)y.push(x);return y}y=[],x=0;for(const S in f)y[x++]=S;return y}}}function Iv(f,y){if(f.forEach&&typeof f.forEach=="function")f.forEach(y,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,y,void 0);else for(var x=Gk(f),S=Kk(f),M=S.length,$=0;$<M;$++)y.call(void 0,S[$],x&&x[$],f)}var Sv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yk(f,y){if(f){f=f.split("&");for(var x=0;x<f.length;x++){var S=f[x].indexOf("="),M=null;if(0<=S){var $=f[x].substring(0,S);M=f[x].substring(S+1)}else $=f[x];y($,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function oa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof oa){this.h=f.h,cl(this,f.j),this.o=f.o,this.g=f.g,ll(this,f.s),this.l=f.l;var y=f.i,x=new ho;x.i=y.i,y.g&&(x.g=new Map(y.g),x.h=y.h),Pv(this,x),this.m=f.m}else f&&(y=String(f).match(Sv))?(this.h=!1,cl(this,y[1]||"",!0),this.o=lo(y[2]||""),this.g=lo(y[3]||"",!0),ll(this,y[4]),this.l=lo(y[5]||"",!0),Pv(this,y[6]||"",!0),this.m=lo(y[7]||"")):(this.h=!1,this.i=new ho(null,this.h))}oa.prototype.toString=function(){var f=[],y=this.j;y&&f.push(uo(y,Cv,!0),":");var x=this.g;return(x||y=="file")&&(f.push("//"),(y=this.o)&&f.push(uo(y,Cv,!0),"@"),f.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&f.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&f.push("/"),f.push(uo(x,x.charAt(0)=="/"?Xk:Qk,!0))),(x=this.i.toString())&&f.push("?",x),(x=this.m)&&f.push("#",uo(x,eN)),f.join("")};function Rn(f){return new oa(f)}function cl(f,y,x){f.j=x?lo(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function ll(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function Pv(f,y,x){y instanceof ho?(f.i=y,tN(f.i,f.h)):(x||(y=uo(y,Jk)),f.i=new ho(y,f.h))}function qe(f,y,x){f.i.set(y,x)}function ul(f){return qe(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function lo(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function uo(f,y,x){return typeof f=="string"?(f=encodeURI(f).replace(y,Zk),x&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Zk(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var Cv=/[#\/\?@]/g,Qk=/[#\?:]/g,Xk=/[#\?]/g,Jk=/[#\?@]/g,eN=/#/g;function ho(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function di(f){f.g||(f.g=new Map,f.h=0,f.i&&Yk(f.i,function(y,x){f.add(decodeURIComponent(y.replace(/\+/g," ")),x)}))}t=ho.prototype,t.add=function(f,y){di(this),this.i=null,f=cs(this,f);var x=this.g.get(f);return x||this.g.set(f,x=[]),x.push(y),this.h+=1,this};function kv(f,y){di(f),y=cs(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function Nv(f,y){return di(f),y=cs(f,y),f.g.has(y)}t.forEach=function(f,y){di(this),this.g.forEach(function(x,S){x.forEach(function(M){f.call(y,M,S,this)},this)},this)},t.na=function(){di(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),x=[];for(let S=0;S<y.length;S++){const M=f[S];for(let $=0;$<M.length;$++)x.push(y[S])}return x},t.V=function(f){di(this);let y=[];if(typeof f=="string")Nv(this,f)&&(y=y.concat(this.g.get(cs(this,f))));else{f=Array.from(this.g.values());for(let x=0;x<f.length;x++)y=y.concat(f[x])}return y},t.set=function(f,y){return di(this),this.i=null,f=cs(this,f),Nv(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},t.get=function(f,y){return f?(f=this.V(f),0<f.length?String(f[0]):y):y};function jv(f,y,x){kv(f,y),0<x.length&&(f.i=null,f.g.set(cs(f,y),b(x)),f.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var x=0;x<y.length;x++){var S=y[x];const $=encodeURIComponent(String(S)),H=this.V(S);for(S=0;S<H.length;S++){var M=$;H[S]!==""&&(M+="="+encodeURIComponent(String(H[S]))),f.push(M)}}return this.i=f.join("&")};function cs(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function tN(f,y){y&&!f.j&&(di(f),f.i=null,f.g.forEach(function(x,S){var M=S.toLowerCase();S!=M&&(kv(this,S),jv(this,M,x))},f)),f.j=y}function rN(f,y){const x=new Dt;if(o.Image){const S=new Image;S.onload=p(hi,x,"TestLoadImage: loaded",!0,y,S),S.onerror=p(hi,x,"TestLoadImage: error",!1,y,S),S.onabort=p(hi,x,"TestLoadImage: abort",!1,y,S),S.ontimeout=p(hi,x,"TestLoadImage: timeout",!1,y,S),o.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=f}else y(!1)}function nN(f,y){const x=new Dt,S=new AbortController,M=setTimeout(()=>{S.abort(),hi(x,"TestPingServer: timeout",!1,y)},1e4);fetch(f,{signal:S.signal}).then($=>{clearTimeout(M),$.ok?hi(x,"TestPingServer: ok",!0,y):hi(x,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(M),hi(x,"TestPingServer: error",!1,y)})}function hi(f,y,x,S,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),S(x)}catch{}}function iN(){this.g=new Fh}function aN(f,y,x){const S=x||"";try{Iv(f,function(M,$){let H=M;l(M)&&(H=as(M)),y.push(S+$+"="+encodeURIComponent(H))})}catch(M){throw y.push(S+"type="+encodeURIComponent("_badmap")),M}}function dl(f){this.l=f.Ub||null,this.j=f.eb||!1}v(dl,ra),dl.prototype.g=function(){return new hl(this.l,this.j)},dl.prototype.i=function(f){return function(){return f}}({});function hl(f,y){at.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(hl,at),t=hl.prototype,t.open=function(f,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,mo(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||o).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fo(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,mo(this)),this.g&&(this.readyState=3,mo(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ov(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ov(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?fo(this):mo(this),this.readyState==3&&Ov(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,fo(this))},t.Qa=function(f){this.g&&(this.response=f,fo(this))},t.ga=function(){this.g&&fo(this)};function fo(f){f.readyState=4,f.l=null,f.j=null,f.v=null,mo(f)}t.setRequestHeader=function(f,y){this.u.append(f,y)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var x=y.next();!x.done;)x=x.value,f.push(x[0]+": "+x[1]),x=y.next();return f.join(`\r
`)};function mo(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(hl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Rv(f){let y="";return D(f,function(x,S){y+=S,y+=":",y+=x,y+=`\r
`}),y}function Gh(f,y,x){e:{for(S in x){var S=!1;break e}S=!0}S||(x=Rv(x),typeof f=="string"?x!=null&&encodeURIComponent(String(x)):qe(f,y,x))}function nt(f){at.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(nt,at);var sN=/^https?$/i,oN=["POST","PUT"];t=nt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,y,x,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():zh.g(),this.v=this.o?Hr(this.o):Hr(zh),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch($){Dv(this,$);return}if(f=x||"",x=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var M in S)x.set(M,S[M]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const $ of S.keys())x.set($,S.get($));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(x.keys()).find($=>$.toLowerCase()=="content-type"),M=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(oN,y,void 0))||S||M||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$,H]of x)this.g.setRequestHeader($,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$v(this),this.u=!0,this.g.send(f),this.u=!1}catch($){Dv(this,$)}};function Dv(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,Mv(f),fl(f)}function Mv(f){f.A||(f.A=!0,Ot(f,"complete"),Ot(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Ot(this,"complete"),Ot(this,"abort"),fl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fl(this,!0)),nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Lv(this):this.bb())},t.bb=function(){Lv(this)};function Lv(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Dn(f)!=4||f.Z()!=2)){if(f.u&&Dn(f)==4)is(f.Ea,0,f);else if(Ot(f,"readystatechange"),Dn(f)==4){f.h=!1;try{const H=f.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var x;if(!(x=y)){var S;if(S=H===0){var M=String(f.D).match(Sv)[1]||null;!M&&o.self&&o.self.location&&(M=o.self.location.protocol.slice(0,-1)),S=!sN.test(M?M.toLowerCase():"")}x=S}if(x)Ot(f,"complete"),Ot(f,"success");else{f.m=6;try{var $=2<Dn(f)?f.g.statusText:""}catch{$=""}f.l=$+" ["+f.Z()+"]",Mv(f)}}finally{fl(f)}}}}function fl(f,y){if(f.g){$v(f);const x=f.g,S=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Ot(f,"ready");try{x.onreadystatechange=S}catch{}}}function $v(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Dn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Dn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&y.indexOf(f)==0&&(y=y.substring(f.length)),rl(y)}};function Vv(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function cN(f){const y={};f=(f.g&&2<=Dn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<f.length;S++){if(T(f[S]))continue;var x=N(f[S]);const M=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const $=y[M]||[];y[M]=$,$.push(x)}I(y,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function po(f,y,x){return x&&x.internalChannelParams&&x.internalChannelParams[f]||y}function Fv(f){this.Aa=0,this.i=[],this.j=new Dt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=po("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=po("baseRetryDelayMs",5e3,f),this.cb=po("retryDelaySeedMs",1e4,f),this.Wa=po("forwardChannelMaxRetries",2,f),this.wa=po("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new wv(f&&f.concurrentRequestLimit),this.Da=new iN,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Fv.prototype,t.la=8,t.G=1,t.connect=function(f,y,x,S){Re(0),this.W=f,this.H=y||{},x&&S!==void 0&&(this.H.OSID=x,this.H.OAID=S),this.F=this.X,this.I=Yv(this,null,this.W),pl(this)};function Yh(f){if(zv(f),f.G==3){var y=f.U++,x=Rn(f.I);if(qe(x,"SID",f.K),qe(x,"RID",y),qe(x,"TYPE","terminate"),go(f,x),y=new ui(f,f.j,y),y.L=2,y.v=ul(Rn(x)),x=!1,o.navigator&&o.navigator.sendBeacon)try{x=o.navigator.sendBeacon(y.v.toString(),"")}catch{}!x&&o.Image&&(new Image().src=y.v,x=!0),x||(y.g=Zv(y.j,null),y.g.ea(y.v)),y.F=Date.now(),ol(y)}Gv(f)}function ml(f){f.g&&(Qh(f),f.g.cancel(),f.g=null)}function zv(f){ml(f),f.u&&(o.clearTimeout(f.u),f.u=null),gl(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function pl(f){if(!_v(f.h)&&!f.s){f.s=!0;var y=f.Ga;te||Be(),he||(te(),he=!0),ye.add(y,f),f.B=0}}function lN(f,y){return Ev(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=y.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Rt(m(f.Ga,f,y),Kv(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const M=new ui(this,this.j,f);let $=this.o;if(this.S&&($?($=A($),O($,this.S)):$=this.S),this.m!==null||this.O||(M.H=$,$=null),this.P)e:{for(var y=0,x=0;x<this.i.length;x++){t:{var S=this.i[x];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(y+=S,4096<y){y=x;break e}if(y===4096||x===this.i.length-1){y=x+1;break e}}y=1e3}else y=1e3;y=Bv(this,M,y),x=Rn(this.I),qe(x,"RID",f),qe(x,"CVER",22),this.D&&qe(x,"X-HTTP-Session-Id",this.D),go(this,x),$&&(this.O?y="headers="+encodeURIComponent(String(Rv($)))+"&"+y:this.m&&Gh(x,this.m,$)),Kh(this.h,M),this.Ua&&qe(x,"TYPE","init"),this.P?(qe(x,"$req",y),qe(x,"SID","null"),M.T=!0,Bh(M,x,null)):Bh(M,x,y),this.G=2}}else this.G==3&&(f?Uv(this,f):this.i.length==0||_v(this.h)||Uv(this))};function Uv(f,y){var x;y?x=y.l:x=f.U++;const S=Rn(f.I);qe(S,"SID",f.K),qe(S,"RID",x),qe(S,"AID",f.T),go(f,S),f.m&&f.o&&Gh(S,f.m,f.o),x=new ui(f,f.j,x,f.B+1),f.m===null&&(x.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Bv(f,x,1e3),x.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Kh(f.h,x),Bh(x,S,y)}function go(f,y){f.H&&D(f.H,function(x,S){qe(y,S,x)}),f.l&&Iv({},function(x,S){qe(y,S,x)})}function Bv(f,y,x){x=Math.min(f.i.length,x);var S=f.l?m(f.l.Na,f.l,f):null;e:{var M=f.i;let $=-1;for(;;){const H=["count="+x];$==-1?0<x?($=M[0].g,H.push("ofs="+$)):$=0:H.push("ofs="+$);let Me=!0;for(let Mt=0;Mt<x;Mt++){let Se=M[Mt].g;const Kt=M[Mt].map;if(Se-=$,0>Se)$=Math.max(0,M[Mt].g-100),Me=!1;else try{aN(Kt,H,"req"+Se+"_")}catch{S&&S(Kt)}}if(Me){S=H.join("&");break e}}}return f=f.i.splice(0,x),y.D=f,S}function qv(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;te||Be(),he||(te(),he=!0),ye.add(y,f),f.v=0}}function Zh(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Rt(m(f.Fa,f),Kv(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Hv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Rt(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Re(10),ml(this),Hv(this))};function Qh(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Hv(f){f.g=new ui(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var y=Rn(f.qa);qe(y,"RID","rpc"),qe(y,"SID",f.K),qe(y,"AID",f.T),qe(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&qe(y,"TO",f.ja),qe(y,"TYPE","xmlhttp"),go(f,y),f.m&&f.o&&Gh(y,f.m,f.o),f.L&&(f.g.I=f.L);var x=f.g;f=f.ia,x.L=1,x.v=ul(Rn(y)),x.m=null,x.P=!0,vv(x,f)}t.Za=function(){this.C!=null&&(this.C=null,ml(this),Zh(this),Re(19))};function gl(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function Wv(f,y){var x=null;if(f.g==y){gl(f),Qh(f),f.g=null;var S=2}else if(Wh(f.h,y))x=y.D,Tv(f.h,y),S=1;else return;if(f.G!=0){if(y.o)if(S==1){x=y.m?y.m.length:0,y=Date.now()-y.F;var M=f.B;S=ot(),Ot(S,new ia(S,x)),pl(f)}else qv(f);else if(M=y.s,M==3||M==0&&0<y.X||!(S==1&&lN(f,y)||S==2&&Zh(f)))switch(x&&0<x.length&&(y=f.h,y.i=y.i.concat(x)),M){case 1:ca(f,5);break;case 4:ca(f,10);break;case 3:ca(f,6);break;default:ca(f,2)}}}function Kv(f,y){let x=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(x*=2),x*y}function ca(f,y){if(f.j.info("Error code "+y),y==2){var x=m(f.fb,f),S=f.Xa;const M=!S;S=new oa(S||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||cl(S,"https"),ul(S),M?rN(S.toString(),x):nN(S.toString(),x)}else Re(2);f.G=0,f.l&&f.l.sa(y),Gv(f),zv(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function Gv(f){if(f.G=0,f.ka=[],f.l){const y=Av(f.h);(y.length!=0||f.i.length!=0)&&(g(f.ka,y),g(f.ka,f.i),f.h.i.length=0,b(f.i),f.i.length=0),f.l.ra()}}function Yv(f,y,x){var S=x instanceof oa?Rn(x):new oa(x);if(S.g!="")y&&(S.g=y+"."+S.g),ll(S,S.s);else{var M=o.location;S=M.protocol,y=y?y+"."+M.hostname:M.hostname,M=+M.port;var $=new oa(null);S&&cl($,S),y&&($.g=y),M&&ll($,M),x&&($.l=x),S=$}return x=f.D,y=f.ya,x&&y&&qe(S,x,y),qe(S,"VER",f.la),go(f,S),S}function Zv(f,y,x){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=f.Ca&&!f.pa?new nt(new dl({eb:x})):new nt(f.pa),y.Ha(f.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qv(){}t=Qv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function yl(){}yl.prototype.g=function(f,y){return new gr(f,y)};function gr(f,y){at.call(this),this.g=new Fv(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!T(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!T(y)&&(this.g.D=y,f=this.h,f!==null&&y in f&&(f=this.h,y in f&&delete f[y])),this.j=new ls(this)}v(gr,at),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Yh(this.g)},gr.prototype.o=function(f){var y=this.g;if(typeof f=="string"){var x={};x.__data__=f,f=x}else this.u&&(x={},x.__data__=as(f),f=x);y.i.push(new Wk(y.Ya++,f)),y.G==3&&pl(y)},gr.prototype.N=function(){this.g.l=null,delete this.j,Yh(this.g),delete this.g,gr.aa.N.call(this)};function Xv(f){ss.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const x in y){f=x;break e}f=void 0}(this.i=f)&&(f=this.i,y=y!==null&&f in y?y[f]:void 0),this.data=y}else this.data=f}v(Xv,ss);function Jv(){os.call(this),this.status=1}v(Jv,os);function ls(f){this.g=f}v(ls,Qv),ls.prototype.ua=function(){Ot(this.g,"a")},ls.prototype.ta=function(f){Ot(this.g,new Xv(f))},ls.prototype.sa=function(f){Ot(this.g,new Jv)},ls.prototype.ra=function(){Ot(this.g,"b")},yl.prototype.createWebChannel=yl.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,N1=function(){return new yl},k1=function(){return ot()},C1=ce,cm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},al.NO_ERROR=0,al.TIMEOUT=8,al.HTTP_ERROR=6,Xl=al,pv.COMPLETE="complete",P1=pv,nl.EventType=na,na.OPEN="a",na.CLOSE="b",na.ERROR="c",na.MESSAGE="d",at.prototype.listen=at.prototype.K,Do=nl,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,S1=nt}).apply(typeof xl<"u"?xl:typeof self<"u"?self:typeof window<"u"?window:{});const B0="@firebase/firestore",q0="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ws="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=new Op("@firebase/firestore");function fs(){return Da.logLevel}function Z(t,...e){if(Da.logLevel<=xe.DEBUG){const r=e.map(qp);Da.debug(`Firestore (${Ws}): ${t}`,...r)}}function Jn(t,...e){if(Da.logLevel<=xe.ERROR){const r=e.map(qp);Da.error(`Firestore (${Ws}): ${t}`,...r)}}function js(t,...e){if(Da.logLevel<=xe.WARN){const r=e.map(qp);Da.warn(`Firestore (${Ws}): ${t}`,...r)}}function qp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,j1(t,n,r)}function j1(t,e,r){let n=`FIRESTORE (${Ws}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Jn(n),new Error(n)}function Ne(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||j1(e,i,n)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Cn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class K2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Qt.UNAUTHENTICATED))}shutdown(){}}class G2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class Y2{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Ne(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve();let a=new Hn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Hn,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=a;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Hn)}},0),s()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ne(typeof n.accessToken=="string",31837,{l:n}),new O1(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new Qt(e)}}class Z2{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Q2{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new Z2(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Qt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class X2{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Ne(this.o===void 0,3512);const n=a=>{a.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const s=a.token!==this.m;return this.m=a.token,Z("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new H0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Ne(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new H0(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=J2(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function we(t,e){return t<e?-1:t>e?1:0}function lm(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const i=t.charAt(n),a=e.charAt(n);if(i!==a)return uf(i)===uf(a)?we(i,a):uf(i)?1:-1}return we(t.length,e.length)}const eD=55296,tD=57343;function uf(t){const e=t.charCodeAt(0);return e>=eD&&e<=tD}function Os(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="__name__";class ln{constructor(e,r,n){r===void 0?r=0:r>e.length&&ue(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ue(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ln.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ln?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=ln.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return we(e.length,r.length)}static compareSegments(e,r){const n=ln.isNumericId(e),i=ln.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?ln.extractNumericId(e).compare(ln.extractNumericId(r)):lm(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ki.fromString(e.substring(4,e.length-2))}}class Ue extends ln{construct(e,r,n){return new Ue(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new G(F.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Ue(r)}static emptyPath(){return new Ue([])}}const rD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class zt extends ln{construct(e,r,n){return new zt(e,r,n)}static isValidIdentifier(e){return rD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),zt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===W0}static keyField(){return new zt([W0])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let s=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new G(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(s=!s,i++):o!=="."||s?(n+=o,i++):(a(),i++)}if(a(),s)throw new G(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new zt(r)}static emptyPath(){return new zt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.path=e}static fromPath(e){return new ne(Ue.fromString(e))}static fromName(e){return new ne(Ue.fromString(e).popFirst(5))}static empty(){return new ne(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ue.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new Ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(t,e,r){if(!r)throw new G(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function nD(t,e,r,n){if(e===!0&&n===!0)throw new G(F.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function K0(t){if(!ne.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function G0(t){if(ne.isDocumentKey(t))throw new G(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function D1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Id(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue(12329,{type:typeof t})}function Ma(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Id(t);throw new G(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(t,e){const r={typeString:t};return e&&(r.value=e),r}function Nc(t,e){if(!D1(t))throw new G(F.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const s=t[n];if(i&&typeof s!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&s!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new G(F.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=-62135596800,Z0=1e6;class Ke{static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*Z0);return new Ke(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new G(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Y0)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Z0}_compareTo(e){return this.seconds===e.seconds?we(this.nanoseconds,e.nanoseconds):we(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ke._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nc(e,Ke._jsonSchema))return new Ke(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Y0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ke._jsonSchemaVersion="firestore/timestamp/1.0",Ke._jsonSchema={type:gt("string",Ke._jsonSchemaVersion),seconds:gt("number"),nanoseconds:gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{static fromTimestamp(e){return new fe(e)}static min(){return new fe(new Ke(0,0))}static max(){return new fe(new Ke(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic=-1;function iD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=fe.fromTimestamp(n===1e9?new Ke(r+1,0):new Ke(r,n));return new Di(i,ne.empty(),e)}function aD(t){return new Di(t.readTime,t.key,ic)}class Di{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Di(fe.min(),ne.empty(),ic)}static max(){return new Di(fe.max(),ne.empty(),ic)}}function sD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ne.comparator(t.documentKey,e.documentKey),r!==0?r:we(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class cD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ks(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==oD)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new U((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof U?r:U.resolve(r)}catch(r){return U.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):U.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):U.reject(r)}static resolve(e){return new U((r,n)=>{r(e)})}static reject(e){return new U((r,n)=>{n(e)})}static waitFor(e){return new U((r,n)=>{let i=0,a=0,s=!1;e.forEach(o=>{++i,o.next(()=>{++a,s&&a===i&&r()},c=>n(c))}),s=!0,a===i&&r()})}static or(e){let r=U.resolve(!1);for(const n of e)r=r.next(i=>i?U.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new U((n,i)=>{const a=e.length,s=new Array(a);let o=0;for(let c=0;c<a;c++){const l=c;r(e[l]).next(u=>{s[l]=u,++o,o===a&&n(s)},u=>i(u))}})}static doWhile(e,r){return new U((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function lD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Gs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Sd.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp=-1;function Pd(t){return t==null}function wu(t){return t===0&&1/t==-1/0}function uD(t){return typeof t=="number"&&Number.isInteger(t)&&!wu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="";function dD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=Q0(e)),e=hD(t.get(r),e);return Q0(e)}function hD(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case M1:r+="";break;default:r+=a}}return r}function Q0(t){return t+M1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X0(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Wa(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function L1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,r){this.comparator=e,this.root=r||Vt.EMPTY}insert(e,r){return new Xe(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Vt.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vt.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wl(this.root,e,this.comparator,!1)}getReverseIterator(){return new wl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wl(this.root,e,this.comparator,!0)}}class wl{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vt{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Vt.RED,this.left=i??Vt.EMPTY,this.right=a??Vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Vt(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Vt.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}}Vt.EMPTY=null,Vt.RED=!0,Vt.BLACK=!1;Vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Vt(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new J0(this.data.getIterator())}getIteratorFrom(e){return new J0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof It)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new It(this.comparator);return r.data=e,r}}class J0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.fields=e,e.sort(zt.comparator)}static empty(){return new Qr([])}unionWith(e){let r=new It(zt.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Qr(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Os(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new $1("Invalid base64 string: "+a):a}}(e);return new Bt(r)}static fromUint8Array(e){const r=function(i){let a="";for(let s=0;s<i.length;++s)a+=String.fromCharCode(i[s]);return a}(e);return new Bt(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return we(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const fD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mi(t){if(Ne(!!t,39018),typeof t=="string"){let e=0;const r=fD.exec(t);if(Ne(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ct(t.seconds),nanos:ct(t.nanos)}}function ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Li(t){return typeof t=="string"?Bt.fromBase64String(t):Bt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="server_timestamp",F1="__type__",z1="__previous_value__",U1="__local_write_time__";function Kp(t){return(t?.mapValue?.fields||{})[F1]?.stringValue===V1}function Cd(t){const e=t.mapValue.fields[z1];return Kp(e)?Cd(e):e}function ac(t){const e=Mi(t.mapValue.fields[U1].timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,r,n,i,a,s,o,c,l,u){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l,this.isUsingEmulator=u}}const _u="(default)";class sc{constructor(e,r){this.projectId=e,this.database=r||_u}static empty(){return new sc("","")}get isDefaultDatabase(){return this.database===_u}isEqual(e){return e instanceof sc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="__type__",pD="__max__",_l={mapValue:{}},q1="__vector__",Eu="value";function $i(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Kp(t)?4:yD(t)?9007199254740991:gD(t)?10:11:ue(28295,{value:t})}function An(t,e){if(t===e)return!0;const r=$i(t);if(r!==$i(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ac(t).isEqual(ac(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const s=Mi(i.timestampValue),o=Mi(a.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return Li(i.bytesValue).isEqual(Li(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return ct(i.geoPointValue.latitude)===ct(a.geoPointValue.latitude)&&ct(i.geoPointValue.longitude)===ct(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return ct(i.integerValue)===ct(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const s=ct(i.doubleValue),o=ct(a.doubleValue);return s===o?wu(s)===wu(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return Os(t.arrayValue.values||[],e.arrayValue.values||[],An);case 10:case 11:return function(i,a){const s=i.mapValue.fields||{},o=a.mapValue.fields||{};if(X0(s)!==X0(o))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(o[c]===void 0||!An(s[c],o[c])))return!1;return!0}(t,e);default:return ue(52216,{left:t})}}function oc(t,e){return(t.values||[]).find(r=>An(r,e))!==void 0}function Rs(t,e){if(t===e)return 0;const r=$i(t),n=$i(e);if(r!==n)return we(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return we(t.booleanValue,e.booleanValue);case 2:return function(a,s){const o=ct(a.integerValue||a.doubleValue),c=ct(s.integerValue||s.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return eb(t.timestampValue,e.timestampValue);case 4:return eb(ac(t),ac(e));case 5:return lm(t.stringValue,e.stringValue);case 6:return function(a,s){const o=Li(a),c=Li(s);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const o=a.split("/"),c=s.split("/");for(let l=0;l<o.length&&l<c.length;l++){const u=we(o[l],c[l]);if(u!==0)return u}return we(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const o=we(ct(a.latitude),ct(s.latitude));return o!==0?o:we(ct(a.longitude),ct(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return tb(t.arrayValue,e.arrayValue);case 10:return function(a,s){const o=a.fields||{},c=s.fields||{},l=o[Eu]?.arrayValue,u=c[Eu]?.arrayValue,h=we(l?.values?.length||0,u?.values?.length||0);return h!==0?h:tb(l,u)}(t.mapValue,e.mapValue);case 11:return function(a,s){if(a===_l.mapValue&&s===_l.mapValue)return 0;if(a===_l.mapValue)return 1;if(s===_l.mapValue)return-1;const o=a.fields||{},c=Object.keys(o),l=s.fields||{},u=Object.keys(l);c.sort(),u.sort();for(let h=0;h<c.length&&h<u.length;++h){const m=lm(c[h],u[h]);if(m!==0)return m;const p=Rs(o[c[h]],l[u[h]]);if(p!==0)return p}return we(c.length,u.length)}(t.mapValue,e.mapValue);default:throw ue(23264,{he:r})}}function eb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return we(t,e);const r=Mi(t),n=Mi(e),i=we(r.seconds,n.seconds);return i!==0?i:we(r.nanos,n.nanos)}function tb(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=Rs(r[i],n[i]);if(a)return a}return we(r.length,n.length)}function Ds(t){return um(t)}function um(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Mi(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Li(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return ne.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=um(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const s of n)a?a=!1:i+=",",i+=`${s}:${um(r.fields[s])}`;return i+"}"}(t.mapValue):ue(61005,{value:t})}function Jl(t){switch($i(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cd(t);return e?16+Jl(e):16;case 5:return 2*t.stringValue.length;case 6:return Li(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Jl(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Wa(n.fields,(a,s)=>{i+=a.length+Jl(s)}),i}(t.mapValue);default:throw ue(13486,{value:t})}}function rb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function dm(t){return!!t&&"integerValue"in t}function Gp(t){return!!t&&"arrayValue"in t}function nb(t){return!!t&&"nullValue"in t}function ib(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function eu(t){return!!t&&"mapValue"in t}function gD(t){return(t?.mapValue?.fields||{})[B1]?.stringValue===q1}function qo(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Wa(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=qo(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=qo(t.arrayValue.values[r]);return e}return{...t}}function yD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===pD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!eu(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=qo(r)}setAll(e){let r=zt.emptyPath(),n={},i=[];e.forEach((s,o)=>{if(!r.isImmediateParentOf(o)){const c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}s?n[o.lastSegment()]=qo(s):i.push(o.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());eu(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return An(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];eu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Wa(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Dr(qo(this.value))}}function H1(t){const e=[];return Wa(t.fields,(r,n)=>{const i=new zt([r]);if(eu(n)){const a=H1(n.mapValue).fields;if(a.length===0)e.push(i);else for(const s of a)e.push(i.child(s))}else e.push(i)}),new Qr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,r,n,i,a,s,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Xt(e,0,fe.min(),fe.min(),fe.min(),Dr.empty(),0)}static newFoundDocument(e,r,n,i){return new Xt(e,1,r,fe.min(),n,i,0)}static newNoDocument(e,r){return new Xt(e,2,r,fe.min(),fe.min(),Dr.empty(),0)}static newUnknownDocument(e,r){return new Xt(e,3,r,fe.min(),fe.min(),Dr.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,r){this.position=e,this.inclusive=r}}function ab(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],s=t.position[i];if(a.field.isKeyField()?n=ne.comparator(ne.fromName(s.referenceValue),r.key):n=Rs(s,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function sb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!An(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,r="asc"){this.field=e,this.dir=r}}function vD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{}class pt extends W1{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new xD(e,r,n):r==="array-contains"?new ED(e,n):r==="in"?new TD(e,n):r==="not-in"?new AD(e,n):r==="array-contains-any"?new ID(e,n):new pt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new wD(e,n):new _D(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Rs(r,this.value)):r!==null&&$i(this.value)===$i(r)&&this.matchesComparison(Rs(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tn extends W1{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new tn(e,r)}matches(e){return K1(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function K1(t){return t.op==="and"}function G1(t){return bD(t)&&K1(t)}function bD(t){for(const e of t.filters)if(e instanceof tn)return!1;return!0}function hm(t){if(t instanceof pt)return t.field.canonicalString()+t.op.toString()+Ds(t.value);if(G1(t))return t.filters.map(e=>hm(e)).join(",");{const e=t.filters.map(r=>hm(r)).join(",");return`${t.op}(${e})`}}function Y1(t,e){return t instanceof pt?function(n,i){return i instanceof pt&&n.op===i.op&&n.field.isEqual(i.field)&&An(n.value,i.value)}(t,e):t instanceof tn?function(n,i){return i instanceof tn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,s,o)=>a&&Y1(s,i.filters[o]),!0):!1}(t,e):void ue(19439)}function Z1(t){return t instanceof pt?function(r){return`${r.field.canonicalString()} ${r.op} ${Ds(r.value)}`}(t):t instanceof tn?function(r){return r.op.toString()+" {"+r.getFilters().map(Z1).join(" ,")+"}"}(t):"Filter"}class xD extends pt{constructor(e,r,n){super(e,r,n),this.key=ne.fromName(n.referenceValue)}matches(e){const r=ne.comparator(e.key,this.key);return this.matchesComparison(r)}}class wD extends pt{constructor(e,r){super(e,"in",r),this.keys=Q1("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class _D extends pt{constructor(e,r){super(e,"not-in",r),this.keys=Q1("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Q1(t,e){return(e.arrayValue?.values||[]).map(r=>ne.fromName(r.referenceValue))}class ED extends pt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Gp(r)&&oc(r.arrayValue,this.value)}}class TD extends pt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&oc(this.value.arrayValue,r)}}class AD extends pt{constructor(e,r){super(e,"not-in",r)}matches(e){if(oc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!oc(this.value.arrayValue,r)}}class ID extends pt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Gp(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>oc(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(e,r=null,n=[],i=[],a=null,s=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=s,this.endAt=o,this.Te=null}}function ob(t,e=null,r=[],n=[],i=null,a=null,s=null){return new SD(t,e,r,n,i,a,s)}function Yp(t){const e=ge(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>hm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Pd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ds(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ds(n)).join(",")),e.Te=r}return e.Te}function Zp(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!vD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Y1(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sb(t.startAt,e.startAt)&&sb(t.endAt,e.endAt)}function fm(t){return ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,r=null,n=[],i=[],a=null,s="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=s,this.startAt=o,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function PD(t,e,r,n,i,a,s,o){return new Ys(t,e,r,n,i,a,s,o)}function Qp(t){return new Ys(t)}function cb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function X1(t){return t.collectionGroup!==null}function Ho(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let o=new It(zt.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new cc(a,n))}),r.has(zt.keyField().canonicalString())||e.Ie.push(new cc(zt.keyField(),n))}return e.Ie}function vn(t){const e=ge(t);return e.Ee||(e.Ee=CD(e,Ho(t))),e.Ee}function CD(t,e){if(t.limitType==="F")return ob(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new cc(i.field,a)});const r=t.endAt?new Tu(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tu(t.startAt.position,t.startAt.inclusive):null;return ob(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function mm(t,e){const r=t.filters.concat([e]);return new Ys(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function pm(t,e,r){return new Ys(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function kd(t,e){return Zp(vn(t),vn(e))&&t.limitType===e.limitType}function J1(t){return`${Yp(vn(t))}|lt:${t.limitType}`}function ms(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>Z1(i)).join(", ")}]`),Pd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Ds(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Ds(i)).join(",")),`Target(${n})`}(vn(t))}; limitType=${t.limitType})`}function Nd(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ne.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of Ho(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(s,o,c){const l=ab(s,o,c);return s.inclusive?l<=0:l<0}(n.startAt,Ho(n),i)||n.endAt&&!function(s,o,c){const l=ab(s,o,c);return s.inclusive?l>=0:l>0}(n.endAt,Ho(n),i))}(t,e)}function kD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function eT(t){return(e,r)=>{let n=!1;for(const i of Ho(t)){const a=ND(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function ND(t,e,r){const n=t.field.isKeyField()?ne.comparator(e.key,r.key):function(a,s,o){const c=s.data.field(a),l=o.data.field(a);return c!==null&&l!==null?Rs(c,l):ue(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ue(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Wa(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return L1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=new Xe(ne.comparator);function ei(){return jD}const tT=new Xe(ne.comparator);function Mo(...t){let e=tT;for(const r of t)e=e.insert(r.key,r);return e}function rT(t){let e=tT;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ma(){return Wo()}function nT(){return Wo()}function Wo(){return new Ka(t=>t.toString(),(t,e)=>t.isEqual(e))}const OD=new Xe(ne.comparator),RD=new It(ne.comparator);function Ee(...t){let e=RD;for(const r of t)e=e.add(r);return e}const DD=new It(we);function MD(){return DD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wu(e)?"-0":e}}function iT(t){return{integerValue:""+t}}function LD(t,e){return uD(e)?iT(e):Xp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(){this._=void 0}}function $D(t,e,r){return t instanceof Au?function(i,a){const s={fields:{[F1]:{stringValue:V1},[U1]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Kp(a)&&(a=Cd(a)),a&&(s.fields[z1]=a),{mapValue:s}}(r,e):t instanceof lc?sT(t,e):t instanceof uc?oT(t,e):function(i,a){const s=aT(i,a),o=lb(s)+lb(i.Ae);return dm(s)&&dm(i.Ae)?iT(o):Xp(i.serializer,o)}(t,e)}function VD(t,e,r){return t instanceof lc?sT(t,e):t instanceof uc?oT(t,e):r}function aT(t,e){return t instanceof Iu?function(n){return dm(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Au extends jd{}class lc extends jd{constructor(e){super(),this.elements=e}}function sT(t,e){const r=cT(e);for(const n of t.elements)r.some(i=>An(i,n))||r.push(n);return{arrayValue:{values:r}}}class uc extends jd{constructor(e){super(),this.elements=e}}function oT(t,e){let r=cT(e);for(const n of t.elements)r=r.filter(i=>!An(i,n));return{arrayValue:{values:r}}}class Iu extends jd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function lb(t){return ct(t.integerValue||t.doubleValue)}function cT(t){return Gp(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function FD(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof lc&&i instanceof lc||n instanceof uc&&i instanceof uc?Os(n.elements,i.elements,An):n instanceof Iu&&i instanceof Iu?An(n.Ae,i.Ae):n instanceof Au&&i instanceof Au}(t.transform,e.transform)}class zD{constructor(e,r){this.version=e,this.transformResults=r}}class Wn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Wn}static exists(e){return new Wn(void 0,e)}static updateTime(e){return new Wn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Od{}function lT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new dT(t.key,Wn.none()):new jc(t.key,t.data,Wn.none());{const r=t.data,n=Dr.empty();let i=new It(zt.comparator);for(let a of e.fields)if(!i.has(a)){let s=r.field(a);s===null&&a.length>1&&(a=a.popLast(),s=r.field(a)),s===null?n.delete(a):n.set(a,s),i=i.add(a)}return new Ga(t.key,n,new Qr(i.toArray()),Wn.none())}}function UD(t,e,r){t instanceof jc?function(i,a,s){const o=i.value.clone(),c=db(i.fieldTransforms,a,s.transformResults);o.setAll(c),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,r):t instanceof Ga?function(i,a,s){if(!tu(i.precondition,a))return void a.convertToUnknownDocument(s.version);const o=db(i.fieldTransforms,a,s.transformResults),c=a.data;c.setAll(uT(i)),c.setAll(o),a.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,r):function(i,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,r)}function Ko(t,e,r,n){return t instanceof jc?function(a,s,o,c){if(!tu(a.precondition,s))return o;const l=a.value.clone(),u=hb(a.fieldTransforms,c,s);return l.setAll(u),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof Ga?function(a,s,o,c){if(!tu(a.precondition,s))return o;const l=hb(a.fieldTransforms,c,s),u=s.data;return u.setAll(uT(a)),u.setAll(l),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(a,s,o){return tu(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,r)}function BD(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=aT(n.transform,i||null);a!=null&&(r===null&&(r=Dr.empty()),r.set(n.field,a))}return r||null}function ub(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Os(n,i,(a,s)=>FD(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jc extends Od{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ga extends Od{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function uT(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function db(t,e,r){const n=new Map;Ne(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let i=0;i<r.length;i++){const a=t[i],s=a.transform,o=e.data.field(a.field);n.set(a.field,VD(s,o,r[i]))}return n}function hb(t,e,r){const n=new Map;for(const i of t){const a=i.transform,s=r.data.field(i.field);n.set(i.field,$D(a,s,e))}return n}class dT extends Od{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qD extends Od{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&UD(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Ko(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Ko(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=nT();return this.mutations.forEach(i=>{const a=e.get(i.key),s=a.overlayedDocument;let o=this.applyToLocalView(s,a.mutatedFields);o=r.has(i.key)?null:o;const c=lT(s,o);c!==null&&n.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(fe.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Ee())}isEqual(e){return this.batchId===e.batchId&&Os(this.mutations,e.mutations,(r,n)=>ub(r,n))&&Os(this.baseMutations,e.baseMutations,(r,n)=>ub(r,n))}}class Jp{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){Ne(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let i=function(){return OD}();const a=e.mutations;for(let s=0;s<a.length;s++)i=i.insert(a[s].key,n[s].version);return new Jp(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Ae;function GD(t){switch(t){case F.OK:return ue(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return ue(15467,{code:t})}}function hT(t){if(t===void 0)return Jn("GRPC error has no .code"),F.UNKNOWN;switch(t){case mt.OK:return F.OK;case mt.CANCELLED:return F.CANCELLED;case mt.UNKNOWN:return F.UNKNOWN;case mt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case mt.INTERNAL:return F.INTERNAL;case mt.UNAVAILABLE:return F.UNAVAILABLE;case mt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case mt.NOT_FOUND:return F.NOT_FOUND;case mt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case mt.ABORTED:return F.ABORTED;case mt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case mt.DATA_LOSS:return F.DATA_LOSS;default:return ue(39323,{code:t})}}(Ae=mt||(mt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD=new ki([4294967295,4294967295],0);function fb(t){const e=YD().encode(t),r=new I1;return r.update(e),new Uint8Array(r.digest())}function mb(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ki([r,n],0),new ki([i,a],0)]}class eg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Lo(`Invalid padding: ${r}`);if(n<0)throw new Lo(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Lo(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Lo(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=ki.fromNumber(this.ge)}ye(e,r,n){let i=e.add(r.multiply(ki.fromNumber(n)));return i.compare(ZD)===1&&(i=new ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=fb(e),[n,i]=mb(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);if(!this.we(s))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),s=new eg(a,i,r);return n.forEach(o=>s.insert(o)),s}insert(e){if(this.ge===0)return;const r=fb(e),[n,i]=mb(r);for(let a=0;a<this.hashCount;a++){const s=this.ye(n,i,a);this.Se(s)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Lo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Oc.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Rd(fe.min(),i,new Xe(we),ei(),Ee())}}class Oc{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Oc(n,r,Ee(),Ee(),Ee())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,r,n,i){this.be=e,this.removedTargetIds=r,this.key=n,this.De=i}}class fT{constructor(e,r){this.targetId=e,this.Ce=r}}class mT{constructor(e,r,n=Bt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class pb{constructor(){this.ve=0,this.Fe=gb(),this.Me=Bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),r=Ee(),n=Ee();return this.Fe.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:ue(38017,{changeType:a})}}),new Oc(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=gb()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class QD{constructor(e){this.Ge=e,this.ze=new Map,this.je=ei(),this.Je=El(),this.He=El(),this.Ye=new Xe(we)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((n,i)=>{this.rt(i)&&r(i)})}st(e){const r=e.targetId,n=e.Ce.count,i=this.ot(r);if(i){const a=i.target;if(fm(a))if(n===0){const s=new ne(a.path);this.et(r,s,Xt.newNoDocument(s,fe.min()))}else Ne(n===1,20013,{expectedCount:n});else{const s=this._t(r);if(s!==n){const o=this.ut(e),c=o?this.ct(o,e,s):1;if(c!==0){this.it(r);const l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,l)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let s,o;try{s=Li(n).toUint8Array()}catch(c){if(c instanceof $1)return js("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new eg(s,i,a)}catch(c){return js(c instanceof Lo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.ge===0?null:o}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const s=this.Ge.ht(),o=`projects/${s.projectId}/databases/${s.database}/documents/${a.path.canonicalString()}`;e.mightContain(o)||(this.et(r,a,null),i++)}),i}Tt(e){const r=new Map;this.ze.forEach((a,s)=>{const o=this.ot(s);if(o){if(a.current&&fm(o.target)){const c=new ne(o.target.path);this.It(c).has(s)||this.Et(s,c)||this.et(s,c,Xt.newNoDocument(c,e))}a.Be&&(r.set(s,a.ke()),a.qe())}});let n=Ee();this.He.forEach((a,s)=>{let o=!0;s.forEachWhile(c=>{const l=this.ot(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(a))}),this.je.forEach((a,s)=>s.setReadTime(e));const i=new Rd(e,r,this.Ye,this.je,n);return this.je=ei(),this.Je=El(),this.He=El(),this.Ye=new Xe(we),i}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,r)?i.Qe(r,1):i.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new pb,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new It(we),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new It(we),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Z("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new pb),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function El(){return new Xe(ne.comparator)}function gb(){return new Xe(ne.comparator)}const XD={asc:"ASCENDING",desc:"DESCENDING"},JD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eM={and:"AND",or:"OR"};class tM{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function gm(t,e){return t.useProto3Json||Pd(e)?e:{value:e}}function Su(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function rM(t,e){return Su(t,e.toTimestamp())}function bn(t){return Ne(!!t,49232),fe.fromTimestamp(function(r){const n=Mi(r);return new Ke(n.seconds,n.nanos)}(t))}function tg(t,e){return ym(t,e).canonicalString()}function ym(t,e){const r=function(i){return new Ue(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function gT(t){const e=Ue.fromString(t);return Ne(wT(e),10190,{key:e.toString()}),e}function vm(t,e){return tg(t.databaseId,e.path)}function df(t,e){const r=gT(e);if(r.get(1)!==t.databaseId.projectId)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new G(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ne(vT(r))}function yT(t,e){return tg(t.databaseId,e)}function nM(t){const e=gT(t);return e.length===4?Ue.emptyPath():vT(e)}function bm(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function vT(t){return Ne(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function yb(t,e,r){return{name:vm(t,e),fields:r.value.mapValue.fields}}function iM(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ue(39313,{state:l})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(l,u){return l.useProto3Json?(Ne(u===void 0||typeof u=="string",58123),Bt.fromBase64String(u||"")):(Ne(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Bt.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,o=s&&function(l){const u=l.code===void 0?F.UNKNOWN:hT(l.code);return new G(u,l.message||"")}(s);r=new mT(n,i,a,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=df(t,n.document.name),a=bn(n.document.updateTime),s=n.document.createTime?bn(n.document.createTime):fe.min(),o=new Dr({mapValue:{fields:n.document.fields}}),c=Xt.newFoundDocument(i,a,s,o),l=n.targetIds||[],u=n.removedTargetIds||[];r=new ru(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=df(t,n.document),a=n.readTime?bn(n.readTime):fe.min(),s=Xt.newNoDocument(i,a),o=n.removedTargetIds||[];r=new ru([],o,s.key,s)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=df(t,n.document),a=n.removedTargetIds||[];r=new ru([],a,i,null)}else{if(!("filter"in e))return ue(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,s=new KD(i,a),o=n.targetId;r=new fT(o,s)}}return r}function aM(t,e){let r;if(e instanceof jc)r={update:yb(t,e.key,e.value)};else if(e instanceof dT)r={delete:vm(t,e.key)};else if(e instanceof Ga)r={update:yb(t,e.key,e.data),updateMask:mM(e.fieldMask)};else{if(!(e instanceof qD))return ue(16599,{Vt:e.type});r={verify:vm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,s){const o=s.transform;if(o instanceof Au)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof lc)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof uc)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Iu)return{fieldPath:s.field.canonicalString(),increment:o.Ae};throw ue(20930,{transform:s.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:rM(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ue(27497)}(t,e.precondition)),r}function sM(t,e){return t&&t.length>0?(Ne(e!==void 0,14353),t.map(r=>function(i,a){let s=i.updateTime?bn(i.updateTime):bn(a);return s.isEqual(fe.min())&&(s=bn(a)),new zD(s,i.transformResults||[])}(r,e))):[]}function oM(t,e){return{documents:[yT(t,e.path)]}}function cM(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=yT(t,i);const a=function(l){if(l.length!==0)return xT(tn.create(l,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const s=function(l){if(l.length!==0)return l.map(u=>function(m){return{field:ps(m.field),direction:dM(m.dir)}}(u))}(e.orderBy);s&&(r.structuredQuery.orderBy=s);const o=gm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ft:r,parent:i}}function lM(t){let e=nM(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){Ne(n===1,65062);const u=r.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let a=[];r.where&&(a=function(h){const m=bT(h);return m instanceof tn&&G1(m)?m.getFilters():[m]}(r.where));let s=[];r.orderBy&&(s=function(h){return h.map(m=>function(v){return new cc(gs(v.field),function(g){switch(g){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(m))}(r.orderBy));let o=null;r.limit&&(o=function(h){let m;return m=typeof h=="object"?h.value:h,Pd(m)?null:m}(r.limit));let c=null;r.startAt&&(c=function(h){const m=!!h.before,p=h.values||[];return new Tu(p,m)}(r.startAt));let l=null;return r.endAt&&(l=function(h){const m=!h.before,p=h.values||[];return new Tu(p,m)}(r.endAt)),PD(e,i,s,a,o,"F",c,l)}function uM(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function bT(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=gs(r.unaryFilter.field);return pt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=gs(r.unaryFilter.field);return pt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=gs(r.unaryFilter.field);return pt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=gs(r.unaryFilter.field);return pt.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(t):t.fieldFilter!==void 0?function(r){return pt.create(gs(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return tn.create(r.compositeFilter.filters.map(n=>bT(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(r.compositeFilter.op))}(t):ue(30097,{filter:t})}function dM(t){return XD[t]}function hM(t){return JD[t]}function fM(t){return eM[t]}function ps(t){return{fieldPath:t.canonicalString()}}function gs(t){return zt.fromServerFormat(t.fieldPath)}function xT(t){return t instanceof pt?function(r){if(r.op==="=="){if(ib(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NAN"}};if(nb(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ib(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NOT_NAN"}};if(nb(r.value))return{unaryFilter:{field:ps(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ps(r.field),op:hM(r.op),value:r.value}}}(t):t instanceof tn?function(r){const n=r.getFilters().map(i=>xT(i));return n.length===1?n[0]:{compositeFilter:{op:fM(r.op),filters:n}}}(t):ue(54877,{filter:t})}function mM(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function wT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,r,n,i,a=fe.min(),s=fe.min(),o=Bt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new Ii(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.yt=e}}function gM(t){const e=lM({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?pm(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(){this.Cn=new vM}addToCollectionParentIndex(e,r){return this.Cn.add(r),U.resolve()}getCollectionParents(e,r){return U.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return U.resolve()}deleteFieldIndex(e,r){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,r){return U.resolve()}getDocumentsMatchingTarget(e,r){return U.resolve(null)}getIndexType(e,r){return U.resolve(0)}getFieldIndexes(e,r){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,r){return U.resolve(Di.min())}getMinOffsetFromCollectionGroup(e,r){return U.resolve(Di.min())}updateCollectionGroup(e,r,n){return U.resolve()}updateIndexEntries(e,r){return U.resolve()}}class vM{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new It(Ue.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new It(Ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_T=41943040;class ur{static withCacheSize(e){return new ur(e,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ur.DEFAULT_COLLECTION_PERCENTILE=10,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ur.DEFAULT=new ur(_T,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ur.DISABLED=new ur(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ms(0)}static cr(){return new Ms(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb="LruGarbageCollector",bM=1048576;function xb([t,e],[r,n]){const i=we(t,r);return i===0?we(e,n):i}class xM{constructor(e){this.Ir=e,this.buffer=new It(xb),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();xb(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class wM{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Z(bb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Gs(r)?Z(bb,"Ignoring IndexedDB error during garbage collection: ",r):await Ks(r)}await this.Vr(3e5)})}}class _M{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return U.resolve(Sd.ce);const n=new xM(r);return this.mr.forEachTarget(e,i=>n.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>n.Ar(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(vb)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vb):this.yr(e,r))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,i,a,s,o,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,s=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(n=h,o=Date.now(),this.removeTargets(e,n,r))).next(h=>(a=h,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(h=>(l=Date.now(),fs()<=xe.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${i} in `+(o-s)+`ms
	Removed ${a} targets in `+(c-o)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:h})))}}function EM(t,e){return new _M(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(){this.changes=new Ka(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Xt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?U.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Ko(n.mutation,i,Qr.empty(),Ke.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Ee()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Ee()){const i=ma();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let s=Mo();return a.forEach((o,c)=>{s=s.insert(o,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,r){const n=ma();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Ee()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((s,o)=>{r.set(s,o)})})}computeViews(e,r,n,i){let a=ei();const s=Wo(),o=function(){return Wo()}();return r.forEach((c,l)=>{const u=n.get(l.key);i.has(l.key)&&(u===void 0||u.mutation instanceof Ga)?a=a.insert(l.key,l):u!==void 0?(s.set(l.key,u.mutation.getFieldMask()),Ko(u.mutation,l,u.mutation.getFieldMask(),Ke.now())):s.set(l.key,Qr.empty())}),this.recalculateAndSaveOverlays(e,a).next(c=>(c.forEach((l,u)=>s.set(l,u)),r.forEach((l,u)=>o.set(l,new AM(u,s.get(l)??null))),o))}recalculateAndSaveOverlays(e,r){const n=Wo();let i=new Xe((s,o)=>s-o),a=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(s=>{for(const o of s)o.keys().forEach(c=>{const l=r.get(c);if(l===null)return;let u=n.get(c)||Qr.empty();u=o.applyToLocalView(l,u),n.set(c,u);const h=(i.get(o.batchId)||Ee()).add(c);i=i.insert(o.batchId,h)})}).next(()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),l=c.key,u=c.value,h=nT();u.forEach(m=>{if(!a.has(m)){const p=lT(r.get(m),n.get(m));p!==null&&h.set(m,p),a=a.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,h))}return U.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(s){return ne.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):X1(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const s=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):U.resolve(ma());let o=ic,c=a;return s.next(l=>U.forEach(l,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),a.get(u)?U.resolve():this.remoteDocumentCache.getEntry(e,u).next(m=>{c=c.insert(u,m)}))).next(()=>this.populateOverlays(e,l,a)).next(()=>this.computeViews(e,c,l,Ee())).next(u=>({batchId:o,changes:rT(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ne(r)).next(n=>{let i=Mo();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let s=Mo();return this.indexManager.getCollectionParents(e,a).next(o=>U.forEach(o,c=>{const l=function(h,m){return new Ys(m,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,c.child(a));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(u=>{u.forEach((h,m)=>{s=s.insert(h,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(s=>{a.forEach((c,l)=>{const u=l.getKey();s.get(u)===null&&(s=s.insert(u,Xt.newInvalidDocument(u)))});let o=Mo();return s.forEach((c,l)=>{const u=a.get(c);u!==void 0&&Ko(u.mutation,l,Qr.empty(),Ke.now()),Nd(r,l)&&(o=o.insert(c,l))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return U.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:bn(i.createTime)}}(r)),U.resolve()}getNamedQuery(e,r){return U.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,function(i){return{name:i.name,query:gM(i.bundledQuery),readTime:bn(i.readTime)}}(r)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(){this.overlays=new Xe(ne.comparator),this.qr=new Map}getOverlay(e,r){return U.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ma();return U.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.St(e,r,a)}),U.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.qr.delete(n)),U.resolve()}getOverlaysForCollection(e,r,n){const i=ma(),a=r.length+1,s=new ne(r.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===a&&c.largestBatchId>n&&i.set(c.getKey(),c)}return U.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new Xe((l,u)=>l-u);const s=this.overlays.getIterator();for(;s.hasNext();){const l=s.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let u=a.get(l.largestBatchId);u===null&&(u=ma(),a=a.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const o=ma(),c=a.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>o.set(l,u)),!(o.size()>=i)););return U.resolve(o)}St(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const s=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(n.key,new WD(r,n));let a=this.qr.get(r);a===void 0&&(a=Ee(),this.qr.set(r,a)),this.qr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(){this.Qr=new It(Pt.$r),this.Ur=new It(Pt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new Pt(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Gr(new Pt(e,r))}zr(e,r){e.forEach(n=>this.removeReference(n,r))}jr(e){const r=new ne(new Ue([])),n=new Pt(r,e),i=new Pt(r,e+1),a=[];return this.Ur.forEachInRange([n,i],s=>{this.Gr(s),a.push(s.key)}),a}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ne(new Ue([])),n=new Pt(r,e),i=new Pt(r,e+1);let a=Ee();return this.Ur.forEachInRange([n,i],s=>{a=a.add(s.key)}),a}containsKey(e){const r=new Pt(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Pt{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ne.comparator(e.key,r.key)||we(e.Yr,r.Yr)}static Kr(e,r){return we(e.Yr,r.Yr)||ne.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new It(Pt.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new HD(a,r,n,i);this.mutationQueue.push(s);for(const o of i)this.Zr=this.Zr.add(new Pt(o.key,a)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return U.resolve(s)}lookupMutationBatch(e,r){return U.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.ei(n),a=i<0?0:i;return U.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?Wp:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Pt(r,0),i=new Pt(r,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([n,i],s=>{const o=this.Xr(s.Yr);a.push(o)}),U.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new It(we);return r.forEach(i=>{const a=new Pt(i,0),s=new Pt(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,s],o=>{n=n.add(o.Yr)})}),U.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;ne.isDocumentKey(a)||(a=a.child(""));const s=new Pt(new ne(a),0);let o=new It(we);return this.Zr.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.Yr)),!0)},s),U.resolve(this.ti(o))}ti(e){const r=[];return e.forEach(n=>{const i=this.Xr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){Ne(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return U.forEach(r.mutations,i=>{const a=new Pt(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,r){const n=new Pt(r,0),i=this.Zr.firstAfterOrEqual(n);return U.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e){this.ri=e,this.docs=function(){return new Xe(ne.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,s=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:s}),this.size+=s-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return U.resolve(n?n.document.mutableCopy():Xt.newInvalidDocument(r))}getEntries(e,r){let n=ei();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Xt.newInvalidDocument(i))}),U.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=ei();const s=r.path,o=new ne(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:l,value:{document:u}}=c.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||sD(aD(u),n)<=0||(i.has(u.key)||Nd(r,u))&&(a=a.insert(u.key,u.mutableCopy()))}return U.resolve(a)}getAllFromCollectionGroup(e,r,n,i){ue(9500)}ii(e,r){return U.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new jM(this)}getSize(e){return U.resolve(this.size)}}class jM extends TM{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)}),U.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.persistence=e,this.si=new Ka(r=>Yp(r),Zp),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.oi=0,this._i=new rg,this.targetCount=0,this.ai=Ms.ur()}forEachTarget(e,r){return this.si.forEach((n,i)=>r(i)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),U.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Ms(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,U.resolve()}updateTargetData(e,r){return this.Pr(r),U.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.si.delete(s),a.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),U.waitFor(a).next(()=>i)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return U.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),U.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(s=>{a.push(i.markPotentiallyOrphaned(e,s))}),U.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),U.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return U.resolve(n)}containsKey(e,r){return U.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,r){this.ui={},this.overlays={},this.ci=new Sd(0),this.li=!1,this.li=!0,this.hi=new CM,this.referenceDelegate=e(this),this.Pi=new OM(this),this.indexManager=new yM,this.remoteDocumentCache=function(i){return new NM(i)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new pM(r),this.Ii=new SM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new PM,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new kM(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Z("MemoryPersistence","Starting transaction:",e);const i=new RM(this.ci.next());return this.referenceDelegate.Ei(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ai(e,r){return U.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,r)))}}class RM extends cD{constructor(e){super(),this.currentSequenceNumber=e}}class ng{constructor(e){this.persistence=e,this.Ri=new rg,this.Vi=null}static mi(e){return new ng(e)}get fi(){if(this.Vi)return this.Vi;throw ue(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),U.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),U.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),U.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach(i=>this.fi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.fi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,n=>{const i=ne.fromPath(n);return this.gi(e,i).next(a=>{a||r.removeEntry(i,fe.min())})}).next(()=>(this.Vi=null,r.apply(e)))}updateLimboDocument(e,r){return this.gi(e,r).next(n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())})}Ti(e){return 0}gi(e,r){return U.or([()=>U.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class Pu{constructor(e,r){this.persistence=e,this.pi=new Ka(n=>dD(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=EM(this,r)}static mi(e,r){return new Pu(e,r)}Ei(){}di(e){return U.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}wr(e){let r=0;return this.pr(e,n=>{r++}).next(()=>r)}pr(e,r){return U.forEach(this.pi,(n,i)=>this.br(e,n,i).next(a=>a?U.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ii(e,s=>this.br(e,s,r).next(o=>{o||(n++,a.removeEntry(s,fe.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),U.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Jl(e.data.value)),r}br(e,r,n){return U.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.pi.get(r);return U.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ig{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=i}static As(e,r){let n=Ee(),i=Ee();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new ig(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return hj()?8:lD(tr())>0?6:4}()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ys(e,r).next(s=>{a.result=s}).next(()=>{if(!a.result)return this.ws(e,r,i,n).next(s=>{a.result=s})}).next(()=>{if(a.result)return;const s=new DM;return this.Ss(e,r,s).next(o=>{if(a.result=o,this.Vs)return this.bs(e,r,s,o.size)})}).next(()=>a.result)}bs(e,r,n,i){return n.documentReadCount<this.fs?(fs()<=xe.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",ms(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(fs()<=xe.DEBUG&&Z("QueryEngine","Query:",ms(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(fs()<=xe.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",ms(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vn(r))):U.resolve())}ys(e,r){if(cb(r))return U.resolve(null);let n=vn(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=pm(r,null,"F"),n=vn(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const s=Ee(...a);return this.ps.getDocuments(e,s).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.Ds(r,o);return this.Cs(r,l,s,c.readTime)?this.ys(e,pm(r,null,"F")):this.vs(e,l,r,c)}))})))}ws(e,r,n,i){return cb(r)||i.isEqual(fe.min())?U.resolve(null):this.ps.getDocuments(e,n).next(a=>{const s=this.Ds(r,a);return this.Cs(r,s,n,i)?U.resolve(null):(fs()<=xe.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ms(r)),this.vs(e,s,r,iD(i,ic)).next(o=>o))})}Ds(e,r){let n=new It(eT(e));return r.forEach((i,a)=>{Nd(e,a)&&(n=n.add(a))}),n}Cs(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Ss(e,r,n){return fs()<=xe.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",ms(r)),this.ps.getDocumentsMatchingQuery(e,r,Di.min(),n)}vs(e,r,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(s=>{a=a.insert(s.key,s)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ag="LocalStore",LM=3e8;class $M{constructor(e,r,n,i){this.persistence=e,this.Fs=r,this.serializer=i,this.Ms=new Xe(we),this.xs=new Ka(a=>Yp(a),Zp),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new IM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ms))}}function VM(t,e,r,n){return new $M(t,e,r,n)}async function TT(t,e){const r=ge(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Bs(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const s=[],o=[];let c=Ee();for(const l of i){s.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of a){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return r.localDocuments.getDocuments(n,c).next(l=>({Ls:l,removedBatchIds:s,addedBatchIds:o}))})})}function FM(t,e){const r=ge(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Ns.newChangeBuffer({trackRemovals:!0});return function(o,c,l,u){const h=l.batch,m=h.keys();let p=U.resolve();return m.forEach(v=>{p=p.next(()=>u.getEntry(c,v)).next(b=>{const g=l.docVersions.get(v);Ne(g!==null,48541),b.version.compareTo(g)<0&&(h.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),u.addEntry(b)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,h))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Ee();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function AT(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Pi.getLastRemoteSnapshotVersion(r))}function zM(t,e){const r=ge(t),n=e.snapshotVersion;let i=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});i=r.Ms;const o=[];e.targetChanges.forEach((u,h)=>{const m=i.get(h);if(!m)return;o.push(r.Pi.removeMatchingKeys(a,u.removedDocuments,h).next(()=>r.Pi.addMatchingKeys(a,u.addedDocuments,h)));let p=m.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(h)!==null?p=p.withResumeToken(Bt.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),i=i.insert(h,p),function(b,g,_){return b.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=LM?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,p,u)&&o.push(r.Pi.updateTargetData(a,p))});let c=ei(),l=Ee();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(a,u))}),o.push(UM(a,s,e.documentUpdates).next(u=>{c=u.ks,l=u.qs})),!n.isEqual(fe.min())){const u=r.Pi.getLastRemoteSnapshotVersion(a).next(h=>r.Pi.setTargetsMetadata(a,a.currentSequenceNumber,n));o.push(u)}return U.waitFor(o).next(()=>s.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,c,l)).next(()=>c)}).then(a=>(r.Ms=i,a))}function UM(t,e,r){let n=Ee(),i=Ee();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let s=ei();return r.forEach((o,c)=>{const l=a.get(o);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(fe.min())?(e.removeEntry(o,c.readTime),s=s.insert(o,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),s=s.insert(o,c)):Z(ag,"Ignoring outdated watch update for ",o,". Current version:",l.version," Watch version:",c.version)}),{ks:s,qs:i}})}function BM(t,e){const r=ge(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Wp),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function qM(t,e){const r=ge(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.Pi.getTargetData(n,e).next(a=>a?(i=a,U.resolve(i)):r.Pi.allocateTargetId(n).next(s=>(i=new Ii(e,s,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n})}async function xm(t,e,r){const n=ge(t),i=n.Ms.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,s=>n.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Gs(s))throw s;Z(ag,`Failed to update sequence numbers for target ${e}: ${s}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function wb(t,e,r){const n=ge(t);let i=fe.min(),a=Ee();return n.persistence.runTransaction("Execute query","readwrite",s=>function(c,l,u){const h=ge(c),m=h.xs.get(u);return m!==void 0?U.resolve(h.Ms.get(m)):h.Pi.getTargetData(l,u)}(n,s,vn(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(s,o.targetId).next(c=>{a=c})}).next(()=>n.Fs.getDocumentsMatchingQuery(s,e,r?i:fe.min(),r?a:Ee())).next(o=>(HM(n,kD(e),o),{documents:o,Qs:a})))}function HM(t,e,r){let n=t.Os.get(e)||fe.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.Os.set(e,n)}class _b{constructor(){this.activeTargetIds=MD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class WM{constructor(){this.Mo=new _b,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _b,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eb="ConnectivityMonitor";class Tb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Z(Eb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Z(Eb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl=null;function wm(){return Tl===null?Tl=function(){return 268435456+Math.round(2147483648*Math.random())}():Tl++,"0x"+Tl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf="RestConnection",GM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===_u?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,r,n,i,a){const s=wm(),o=this.zo(e,r.toUriEncodedString());Z(hf,`Sending RPC '${e}' ${s}:`,o,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,a);const{host:l}=new URL(o),u=Ba(l);return this.Jo(e,o,c,n,u).then(h=>(Z(hf,`Received RPC '${e}' ${s}: `,h),h),h=>{throw js(hf,`RPC '${e}' ${s} failed with error: `,h,"url: ",o,"request:",n),h})}Ho(e,r,n,i,a,s){return this.Go(e,r,n,i,a)}jo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ws}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}zo(e,r){const n=GM[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class QM extends YM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,i,a){const s=wm();return new Promise((o,c)=>{const l=new S1;l.setWithCredentials(!0),l.listenOnce(P1.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Xl.NO_ERROR:const h=l.getResponseJson();Z(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Xl.TIMEOUT:Z(Yt,`RPC '${e}' ${s} timed out`),c(new G(F.DEADLINE_EXCEEDED,"Request time out"));break;case Xl.HTTP_ERROR:const m=l.getStatus();if(Z(Yt,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const v=p?.error;if(v&&v.status&&v.message){const b=function(_){const T=_.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(T)>=0?T:F.UNKNOWN}(v.status);c(new G(b,v.message))}else c(new G(F.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new G(F.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{l_:e,streamId:s,h_:l.getLastErrorCode(),P_:l.getLastError()})}}finally{Z(Yt,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);Z(Yt,`RPC '${e}' ${s} sending request:`,i),l.send(r,"POST",u,n,15)})}T_(e,r,n){const i=wm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=N1(),o=k1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;const u=a.join("");Z(Yt,`Creating RPC '${e}' stream ${i}: ${u}`,c);const h=s.createWebChannel(u,c);this.I_(h);let m=!1,p=!1;const v=new ZM({Yo:g=>{p?Z(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,g):(m||(Z(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),m=!0),Z(Yt,`RPC '${e}' stream ${i} sending:`,g),h.send(g))},Zo:()=>h.close()}),b=(g,_,T)=>{g.listen(_,E=>{try{T(E)}catch(j){setTimeout(()=>{throw j},0)}})};return b(h,Do.EventType.OPEN,()=>{p||(Z(Yt,`RPC '${e}' stream ${i} transport opened.`),v.o_())}),b(h,Do.EventType.CLOSE,()=>{p||(p=!0,Z(Yt,`RPC '${e}' stream ${i} transport closed`),v.a_(),this.E_(h))}),b(h,Do.EventType.ERROR,g=>{p||(p=!0,js(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,g.name,"Message:",g.message),v.a_(new G(F.UNAVAILABLE,"The operation could not be completed")))}),b(h,Do.EventType.MESSAGE,g=>{if(!p){const _=g.data[0];Ne(!!_,16349);const T=_,E=T?.error||T[0]?.error;if(E){Z(Yt,`RPC '${e}' stream ${i} received error:`,E);const j=E.status;let R=function(A){const P=mt[A];if(P!==void 0)return hT(P)}(j),D=E.message;R===void 0&&(R=F.INTERNAL,D="Unknown error status: "+j+" with message "+E.message),p=!0,v.a_(new G(R,D)),h.close()}else Z(Yt,`RPC '${e}' stream ${i} received:`,_),v.u_(_)}}),b(o,C1.STAT_EVENT,g=>{g.stat===cm.PROXY?Z(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):g.stat===cm.NOPROXY&&Z(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.__()},0),v}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(r=>r===e)}}function ff(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(t){return new tM(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=i,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,r-n);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="PersistentStream";class ST{constructor(e,r,n,i,a,s,o,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=a,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new IT(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===F.RESOURCE_EXHAUSTED?(Jn(r.toString()),Jn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.D_===r&&this.G_(n,i)},n=>{e(()=>{const i=new G(F.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)})})}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{n(()=>this.z_(i))}),this.stream.onMessage(i=>{n(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Z(Ab,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget(()=>this.D_===e?r():(Z(Ab,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class XM extends ST{constructor(e,r,n,i,a,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=iM(this.serializer,e),n=function(a){if(!("targetChange"in a))return fe.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?fe.min():s.readTime?bn(s.readTime):fe.min()}(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=bm(this.serializer),r.addTarget=function(a,s){let o;const c=s.target;if(o=fm(c)?{documents:oM(a,c)}:{query:cM(a,c).ft},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=pT(a,s.resumeToken);const l=gm(a,s.expectedCount);l!==null&&(o.expectedCount=l)}else if(s.snapshotVersion.compareTo(fe.min())>0){o.readTime=Su(a,s.snapshotVersion.toTimestamp());const l=gm(a,s.expectedCount);l!==null&&(o.expectedCount=l)}return o}(this.serializer,e);const n=uM(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=bm(this.serializer),r.removeTarget=e,this.q_(r)}}class JM extends ST{constructor(e,r,n,i,a,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,s),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=sM(e.writeResults,e.commitTime),n=bn(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=bm(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>aM(this.serializer,n))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{}class tL extends eL{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Go(e,ym(r,n),i,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new G(F.UNKNOWN,a.toString())})}Ho(e,r,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Ho(e,ym(r,n),i,s,o,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(F.UNKNOWN,s.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class rL{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Jn(r),this.aa=!1):Z("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="RemoteStore";class nL{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo(s=>{n.enqueueAndForget(async()=>{Ya(this)&&(Z(La,"Restarting streams for network reachability change."),await async function(c){const l=ge(c);l.Ea.add(4),await Rc(l),l.Ra.set("Unknown"),l.Ea.delete(4),await Md(l)}(this))})}),this.Ra=new rL(n,i)}}async function Md(t){if(Ya(t))for(const e of t.da)await e(!0)}async function Rc(t){for(const e of t.da)await e(!1)}function PT(t,e){const r=ge(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),lg(r)?cg(r):Zs(r).O_()&&og(r,e))}function sg(t,e){const r=ge(t),n=Zs(r);r.Ia.delete(e),n.O_()&&CT(r,e),r.Ia.size===0&&(n.O_()?n.L_():Ya(r)&&r.Ra.set("Unknown"))}function og(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(fe.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Zs(t).Y_(e)}function CT(t,e){t.Va.Ue(e),Zs(t).Z_(e)}function cg(t){t.Va=new QD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Zs(t).start(),t.Ra.ua()}function lg(t){return Ya(t)&&!Zs(t).x_()&&t.Ia.size>0}function Ya(t){return ge(t).Ea.size===0}function kT(t){t.Va=void 0}async function iL(t){t.Ra.set("Online")}async function aL(t){t.Ia.forEach((e,r)=>{og(t,e)})}async function sL(t,e){kT(t),lg(t)?(t.Ra.ha(e),cg(t)):t.Ra.set("Unknown")}async function oL(t,e,r){if(t.Ra.set("Online"),e instanceof mT&&e.state===2&&e.cause)try{await async function(i,a){const s=a.cause;for(const o of a.targetIds)i.Ia.has(o)&&(await i.remoteSyncer.rejectListen(o,s),i.Ia.delete(o),i.Va.removeTarget(o))}(t,e)}catch(n){Z(La,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Cu(t,n)}else if(e instanceof ru?t.Va.Ze(e):e instanceof fT?t.Va.st(e):t.Va.tt(e),!r.isEqual(fe.min()))try{const n=await AT(t.localStore);r.compareTo(n)>=0&&await function(a,s){const o=a.Va.Tt(s);return o.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){const u=a.Ia.get(l);u&&a.Ia.set(l,u.withResumeToken(c.resumeToken,s))}}),o.targetMismatches.forEach((c,l)=>{const u=a.Ia.get(c);if(!u)return;a.Ia.set(c,u.withResumeToken(Bt.EMPTY_BYTE_STRING,u.snapshotVersion)),CT(a,c);const h=new Ii(u.target,c,l,u.sequenceNumber);og(a,h)}),a.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Z(La,"Failed to raise snapshot:",n),await Cu(t,n)}}async function Cu(t,e,r){if(!Gs(e))throw e;t.Ea.add(1),await Rc(t),t.Ra.set("Offline"),r||(r=()=>AT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z(La,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Md(t)})}function NT(t,e){return e().catch(r=>Cu(t,r,e))}async function Ld(t){const e=ge(t),r=Vi(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Wp;for(;cL(e);)try{const i=await BM(e.localStore,n);if(i===null){e.Ta.length===0&&r.L_();break}n=i.batchId,lL(e,i)}catch(i){await Cu(e,i)}jT(e)&&OT(e)}function cL(t){return Ya(t)&&t.Ta.length<10}function lL(t,e){t.Ta.push(e);const r=Vi(t);r.O_()&&r.X_&&r.ea(e.mutations)}function jT(t){return Ya(t)&&!Vi(t).x_()&&t.Ta.length>0}function OT(t){Vi(t).start()}async function uL(t){Vi(t).ra()}async function dL(t){const e=Vi(t);for(const r of t.Ta)e.ea(r.mutations)}async function hL(t,e,r){const n=t.Ta.shift(),i=Jp.from(n,e,r);await NT(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ld(t)}async function fL(t,e){e&&Vi(t).X_&&await async function(n,i){if(function(s){return GD(s)&&s!==F.ABORTED}(i.code)){const a=n.Ta.shift();Vi(n).B_(),await NT(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await Ld(n)}}(t,e),jT(t)&&OT(t)}async function Ib(t,e){const r=ge(t);r.asyncQueue.verifyOperationInProgress(),Z(La,"RemoteStore received new credentials");const n=Ya(r);r.Ea.add(3),await Rc(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Md(r)}async function mL(t,e){const r=ge(t);e?(r.Ea.delete(2),await Md(r)):e||(r.Ea.add(2),await Rc(r),r.Ra.set("Unknown"))}function Zs(t){return t.ma||(t.ma=function(r,n,i){const a=ge(r);return a.sa(),new XM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:iL.bind(null,t),t_:aL.bind(null,t),r_:sL.bind(null,t),H_:oL.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),lg(t)?cg(t):t.Ra.set("Unknown")):(await t.ma.stop(),kT(t))})),t.ma}function Vi(t){return t.fa||(t.fa=function(r,n,i){const a=ge(r);return a.sa(),new JM(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:uL.bind(null,t),r_:fL.bind(null,t),ta:dL.bind(null,t),na:hL.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Ld(t)):(await t.fa.stop(),t.Ta.length>0&&(Z(La,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new Hn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const s=Date.now()+n,o=new ug(e,r,s,i,a);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dg(t,e){if(Jn("AsyncQueue",`${e}: ${t}`),Gs(t))return new G(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{static emptySet(e){return new As(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ne.comparator(r.key,n.key):(r,n)=>ne.comparator(r.key,n.key),this.keyedMap=Mo(),this.sortedSet=new Xe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof As)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new As;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(){this.ga=new Xe(ne.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ue(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ls{constructor(e,r,n,i,a,s,o,c,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,i,a){const s=[];return r.forEach(o=>{s.push({type:0,doc:o})}),new Ls(e,r,As.emptySet(r),s,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class gL{constructor(){this.queries=Pb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const i=ge(r),a=i.queries;i.queries=Pb(),a.forEach((s,o)=>{for(const c of o.Sa)c.onError(n)})})(this,new G(F.ABORTED,"Firestore shutting down"))}}function Pb(){return new Ka(t=>J1(t),kd)}async function RT(t,e){const r=ge(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.ba()&&e.Da()&&(n=2):(a=new pL,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await r.onListen(i,!0);break;case 1:a.wa=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(s){const o=dg(s,`Initialization of query '${ms(e.query)}' failed`);return void e.onError(o)}r.queries.set(i,a),a.Sa.push(e),e.va(r.onlineState),a.wa&&e.Fa(a.wa)&&hg(r)}async function DT(t,e){const r=ge(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const s=a.Sa.indexOf(e);s>=0&&(a.Sa.splice(s,1),a.Sa.length===0?i=e.Da()?0:1:!a.ba()&&e.Da()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function yL(t,e){const r=ge(t);let n=!1;for(const i of e){const a=i.query,s=r.queries.get(a);if(s){for(const o of s.Sa)o.Fa(i)&&(n=!0);s.wa=i}}n&&hg(r)}function vL(t,e,r){const n=ge(t),i=n.queries.get(e);if(i)for(const a of i.Sa)a.onError(r);n.queries.delete(e)}function hg(t){t.Ca.forEach(e=>{e.next()})}var _m,Cb;(Cb=_m||(_m={})).Ma="default",Cb.Cache="cache";class MT{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Ls(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Ls.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==_m.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.key=e}}class $T{constructor(e){this.key=e}}class bL{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=eT(e),this.tu=new As(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new Sb,i=r?r.tu:this.tu;let a=r?r.mutatedKeys:this.mutatedKeys,s=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const m=i.get(u),p=Nd(this.query,h)?h:null,v=!!m&&this.mutatedKeys.has(m.key),b=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let g=!1;m&&p?m.data.isEqual(p.data)?v!==b&&(n.track({type:3,doc:p}),g=!0):this.su(m,p)||(n.track({type:2,doc:p}),g=!0,(c&&this.eu(p,c)>0||l&&this.eu(p,l)<0)&&(o=!0)):!m&&p?(n.track({type:0,doc:p}),g=!0):m&&!p&&(n.track({type:1,doc:m}),g=!0,(c||l)&&(o=!0)),g&&(p?(s=s.add(p),a=b?a.add(u):a.delete(u)):(s=s.delete(u),a=a.delete(u)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const u=this.query.limitType==="F"?s.last():s.first();s=s.delete(u.key),a=a.delete(u.key),n.track({type:1,doc:u})}return{tu:s,iu:n,Cs:o,mutatedKeys:a}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((u,h)=>function(p,v){const b=g=>{switch(g){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{Rt:g})}};return b(p)-b(v)}(u.type,h.type)||this.eu(u.doc,h.doc)),this.ou(n),i=i??!1;const o=r&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,l=c!==this.Za;return this.Za=c,s.length!==0||l?{snapshot:new Ls(this.query,e.tu,a,s,e.mutatedKeys,c===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Sb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(r=>this.Ya=this.Ya.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ya=this.Ya.delete(r)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const r=[];return e.forEach(n=>{this.Xa.has(n)||r.push(new $T(n))}),this.Xa.forEach(n=>{e.has(n)||r.push(new LT(n))}),r}cu(e){this.Ya=e.Qs,this.Xa=Ee();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Ls.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const fg="SyncEngine";class xL{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class wL{constructor(e){this.key=e,this.hu=!1}}class _L{constructor(e,r,n,i,a,s){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Ka(o=>J1(o),kd),this.Iu=new Map,this.Eu=new Set,this.du=new Xe(ne.comparator),this.Au=new Map,this.Ru=new rg,this.Vu={},this.mu=new Map,this.fu=Ms.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function EL(t,e,r=!0){const n=qT(t);let i;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await VT(n,e,r,!0),i}async function TL(t,e){const r=qT(t);await VT(r,e,!0,!1)}async function VT(t,e,r,n){const i=await qM(t.localStore,vn(e)),a=i.targetId,s=t.sharedClientState.addLocalQueryTarget(a,r);let o;return n&&(o=await AL(t,e,a,s==="current",i.resumeToken)),t.isPrimaryClient&&r&&PT(t.remoteStore,i),o}async function AL(t,e,r,n,i){t.pu=(h,m,p)=>async function(b,g,_,T){let E=g.view.ru(_);E.Cs&&(E=await wb(b.localStore,g.query,!1).then(({documents:I})=>g.view.ru(I,E)));const j=T&&T.targetChanges.get(g.targetId),R=T&&T.targetMismatches.get(g.targetId)!=null,D=g.view.applyChanges(E,b.isPrimaryClient,j,R);return Nb(b,g.targetId,D.au),D.snapshot}(t,h,m,p);const a=await wb(t.localStore,e,!0),s=new bL(e,a.Qs),o=s.ru(a.documents),c=Oc.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),l=s.applyChanges(o,t.isPrimaryClient,c);Nb(t,r,l.au);const u=new xL(e,r,s);return t.Tu.set(e,u),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),l.snapshot}async function IL(t,e,r){const n=ge(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);if(a.length>1)return n.Iu.set(i.targetId,a.filter(s=>!kd(s,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await xm(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&sg(n.remoteStore,i.targetId),Em(n,i.targetId)}).catch(Ks)):(Em(n,i.targetId),await xm(n.localStore,i.targetId,!0))}async function SL(t,e){const r=ge(t),n=r.Tu.get(e),i=r.Iu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),sg(r.remoteStore,n.targetId))}async function PL(t,e,r){const n=DL(t);try{const i=await function(s,o){const c=ge(s),l=Ke.now(),u=o.reduce((p,v)=>p.add(v.key),Ee());let h,m;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=ei(),b=Ee();return c.Ns.getEntries(p,u).next(g=>{v=g,v.forEach((_,T)=>{T.isValidDocument()||(b=b.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,v)).next(g=>{h=g;const _=[];for(const T of o){const E=BD(T,h.get(T.key).overlayedDocument);E!=null&&_.push(new Ga(T.key,E,H1(E.value.mapValue),Wn.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,_,o)}).next(g=>{m=g;const _=g.applyToLocalDocumentSet(h,b);return c.documentOverlayCache.saveOverlays(p,g.batchId,_)})}).then(()=>({batchId:m.batchId,changes:rT(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,c){let l=s.Vu[s.currentUser.toKey()];l||(l=new Xe(we)),l=l.insert(o,c),s.Vu[s.currentUser.toKey()]=l}(n,i.batchId,r),await Dc(n,i.changes),await Ld(n.remoteStore)}catch(i){const a=dg(i,"Failed to persist write");r.reject(a)}}async function FT(t,e){const r=ge(t);try{const n=await zM(r.localStore,e);e.targetChanges.forEach((i,a)=>{const s=r.Au.get(a);s&&(Ne(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.hu=!0:i.modifiedDocuments.size>0?Ne(s.hu,14607):i.removedDocuments.size>0&&(Ne(s.hu,42227),s.hu=!1))}),await Dc(r,n,e)}catch(n){await Ks(n)}}function kb(t,e,r){const n=ge(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Tu.forEach((a,s)=>{const o=s.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(s,o){const c=ge(s);c.onlineState=o;let l=!1;c.queries.forEach((u,h)=>{for(const m of h.Sa)m.va(o)&&(l=!0)}),l&&hg(c)}(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function CL(t,e,r){const n=ge(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Au.get(e),a=i&&i.key;if(a){let s=new Xe(ne.comparator);s=s.insert(a,Xt.newNoDocument(a,fe.min()));const o=Ee().add(a),c=new Rd(fe.min(),new Map,new Xe(we),s,o);await FT(n,c),n.du=n.du.remove(a),n.Au.delete(e),mg(n)}else await xm(n.localStore,e,!1).then(()=>Em(n,e,r)).catch(Ks)}async function kL(t,e){const r=ge(t),n=e.batch.batchId;try{const i=await FM(r.localStore,e);UT(r,n,null),zT(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Dc(r,i)}catch(i){await Ks(i)}}async function NL(t,e,r){const n=ge(t);try{const i=await function(s,o){const c=ge(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let u;return c.mutationQueue.lookupMutationBatch(l,o).next(h=>(Ne(h!==null,37113),u=h.keys(),c.mutationQueue.removeMutationBatch(l,h))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,u,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,u)).next(()=>c.localDocuments.getDocuments(l,u))})}(n.localStore,e);UT(n,e,r),zT(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Dc(n,i)}catch(i){await Ks(i)}}function zT(t,e){(t.mu.get(e)||[]).forEach(r=>{r.resolve()}),t.mu.delete(e)}function UT(t,e,r){const n=ge(t);let i=n.Vu[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Vu[n.currentUser.toKey()]=i}}function Em(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(n=>{t.Ru.containsKey(n)||BT(t,n)})}function BT(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(sg(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),mg(t))}function Nb(t,e,r){for(const n of r)n instanceof LT?(t.Ru.addReference(n.key,e),jL(t,n)):n instanceof $T?(Z(fg,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||BT(t,n.key)):ue(19791,{wu:n})}function jL(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Z(fg,"New document in limbo: "+r),t.Eu.add(n),mg(t))}function mg(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ne(Ue.fromString(e)),n=t.fu.next();t.Au.set(n,new wL(r)),t.du=t.du.insert(r,n),PT(t.remoteStore,new Ii(vn(Qp(r.path)),n,"TargetPurposeLimboResolution",Sd.ce))}}async function Dc(t,e,r){const n=ge(t),i=[],a=[],s=[];n.Tu.isEmpty()||(n.Tu.forEach((o,c)=>{s.push(n.pu(c,e,r).then(l=>{if((l||r)&&n.isPrimaryClient){const u=l?!l.fromCache:r?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(l){i.push(l);const u=ig.As(c.targetId,l);a.push(u)}}))}),await Promise.all(s),n.Pu.H_(i),await async function(c,l){const u=ge(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>U.forEach(l,m=>U.forEach(m.Es,p=>u.persistence.referenceDelegate.addReference(h,m.targetId,p)).next(()=>U.forEach(m.ds,p=>u.persistence.referenceDelegate.removeReference(h,m.targetId,p)))))}catch(h){if(!Gs(h))throw h;Z(ag,"Failed to update sequence numbers: "+h)}for(const h of l){const m=h.targetId;if(!h.fromCache){const p=u.Ms.get(m),v=p.snapshotVersion,b=p.withLastLimboFreeSnapshotVersion(v);u.Ms=u.Ms.insert(m,b)}}}(n.localStore,a))}async function OL(t,e){const r=ge(t);if(!r.currentUser.isEqual(e)){Z(fg,"User change. New user:",e.toKey());const n=await TT(r.localStore,e);r.currentUser=e,function(a,s){a.mu.forEach(o=>{o.forEach(c=>{c.reject(new G(F.CANCELLED,s))})}),a.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Dc(r,n.Ls)}}function RL(t,e){const r=ge(t),n=r.Au.get(e);if(n&&n.hu)return Ee().add(n.key);{let i=Ee();const a=r.Iu.get(e);if(!a)return i;for(const s of a){const o=r.Tu.get(s);i=i.unionWith(o.view.nu)}return i}}function qT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=FT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CL.bind(null,e),e.Pu.H_=yL.bind(null,e.eventManager),e.Pu.yu=vL.bind(null,e.eventManager),e}function DL(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NL.bind(null,e),e}class ku{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Dd(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return VM(this.persistence,new MM,e.initialUser,this.serializer)}Cu(e){return new ET(ng.mi,this.serializer)}Du(e){return new WM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ku.provider={build:()=>new ku};class ML extends ku{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Ne(this.persistence.referenceDelegate instanceof Pu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new wM(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?ur.withCacheSize(this.cacheSizeBytes):ur.DEFAULT;return new ET(n=>Pu.mi(n,r),this.serializer)}}class Tm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>kb(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=OL.bind(null,this.syncEngine),await mL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new gL}()}createDatastore(e){const r=Dd(e.databaseInfo.databaseId),n=function(a){return new QM(a)}(e.databaseInfo);return function(a,s,o,c){return new tL(a,s,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,s,o){return new nL(n,i,a,s,o)}(this.localStore,this.datastore,e.asyncQueue,r=>kb(this.syncEngine,r,0),function(){return Tb.v()?new Tb:new KM}())}createSyncEngine(e,r){return function(i,a,s,o,c,l,u){const h=new _L(i,a,s,o,c,l);return u&&(h.gu=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(r){const n=ge(r);Z(La,"RemoteStore shutting down."),n.Ea.add(5),await Rc(n),n.Aa.shutdown(),n.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Tm.provider={build:()=>new Tm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Jn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fi="FirestoreClient";class LL{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Qt.UNAUTHENTICATED,this.clientId=Hp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async s=>{Z(Fi,"Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(n,s=>(Z(Fi,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=dg(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function mf(t,e){t.asyncQueue.verifyOperationInProgress(),Z(Fi,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await TT(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function jb(t,e){t.asyncQueue.verifyOperationInProgress();const r=await $L(t);Z(Fi,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Ib(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>Ib(e.remoteStore,i)),t._onlineComponents=e}async function $L(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(Fi,"Using user provided OfflineComponentProvider");try{await mf(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;js("Error using user provided cache. Falling back to memory cache: "+r),await mf(t,new ku)}}else Z(Fi,"Using default OfflineComponentProvider"),await mf(t,new ML(void 0));return t._offlineComponents}async function WT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(Fi,"Using user provided OnlineComponentProvider"),await jb(t,t._uninitializedComponentsProvider._online)):(Z(Fi,"Using default OnlineComponentProvider"),await jb(t,new Tm))),t._onlineComponents}function VL(t){return WT(t).then(e=>e.syncEngine)}async function KT(t){const e=await WT(t),r=e.eventManager;return r.onListen=EL.bind(null,e.syncEngine),r.onUnlisten=IL.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=TL.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=SL.bind(null,e.syncEngine),r}function FL(t,e,r={}){const n=new Hn;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,c,l){const u=new HT({next:m=>{u.Nu(),s.enqueueAndForget(()=>DT(a,h));const p=m.docs.has(o);!p&&m.fromCache?l.reject(new G(F.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&m.fromCache&&c&&c.source==="server"?l.reject(new G(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new MT(Qp(o.path),u,{includeMetadataChanges:!0,qa:!0});return RT(a,h)}(await KT(t),t.asyncQueue,e,r,n)),n.promise}function zL(t,e,r={}){const n=new Hn;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,o,c,l){const u=new HT({next:m=>{u.Nu(),s.enqueueAndForget(()=>DT(a,h)),m.fromCache&&c.source==="server"?l.reject(new G(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),h=new MT(o,u,{includeMetadataChanges:!0,qa:!0});return RT(a,h)}(await KT(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YT="firestore.googleapis.com",Rb=!0;class Db{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=YT,this.ssl=Rb}else this.host=e.host,this.ssl=e.ssl??Rb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_T;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<bM)throw new G(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GT(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new G(F.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $d{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Db({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Db(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new K2;switch(n.type){case"firstParty":return new Q2(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new G(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Ob.get(r);n&&(Z("ComponentProvider","Removing Datastore"),Ob.delete(r),n.terminate())}(this),Promise.resolve()}}function UL(t,e,r,n={}){t=Ma(t,$d);const i=Ba(e),a=t._getSettings(),s={...a,emulatorOptions:t._getEmulatorOptions()},o=`${e}:${r}`;i&&(Np(`https://${o}`),jp("Firestore",!0)),a.host!==YT&&a.host!==o&&js("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...a,host:o,ssl:i,emulatorOptions:n};if(!Na(c,s)&&(t._setSettings(c),n.mockUserToken)){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=Qt.MOCK_USER;else{l=FE(n.mockUserToken,t._app?.options.projectId);const h=n.mockUserToken.sub||n.mockUserToken.user_id;if(!h)throw new G(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Qt(h)}t._authCredentials=new G2(new O1(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Za(this.firestore,e,this._query)}}class yt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ni(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yt(this.firestore,e,this._key)}toJSON(){return{type:yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Nc(r,yt._jsonSchema))return new yt(e,n||null,new ne(Ue.fromString(r.referencePath)))}}yt._jsonSchemaVersion="firestore/documentReference/1.0",yt._jsonSchema={type:gt("string",yt._jsonSchemaVersion),referencePath:gt("string")};class Ni extends Za{constructor(e,r,n){super(e,r,Qp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yt(this.firestore,null,new ne(e))}withConverter(e){return new Ni(this.firestore,e,this._path)}}function BL(t,e,...r){if(t=rr(t),R1("collection","path",e),t instanceof $d){const n=Ue.fromString(e,...r);return G0(n),new Ni(t,null,n)}{if(!(t instanceof yt||t instanceof Ni))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ue.fromString(e,...r));return G0(n),new Ni(t.firestore,null,n)}}function Mb(t,e,...r){if(t=rr(t),arguments.length===1&&(e=Hp.newId()),R1("doc","path",e),t instanceof $d){const n=Ue.fromString(e,...r);return K0(n),new yt(t,null,new ne(n))}{if(!(t instanceof yt||t instanceof Ni))throw new G(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ue.fromString(e,...r));return K0(n),new yt(t.firestore,t instanceof Ni?t.converter:null,new ne(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb="AsyncQueue";class $b{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new IT(this,"async_queue_retry"),this._c=()=>{const n=ff();n&&Z(Lb,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=ff();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=ff();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const r=new Hn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Gs(e))throw e;Z(Lb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const r=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,Jn("INTERNAL UNHANDLED ERROR: ",Vb(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const i=ug.createAndSchedule(this,e,r,n,a=>this.hc(a));return this.tc.push(i),i}uc(){this.nc&&ue(47125,{Pc:Vb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function Vb(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Vd extends $d{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $b,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $b(e),this._firestoreClient=void 0,await e}}}function qL(t,e){const r=typeof t=="object"?t:Dp(),n=typeof t=="string"?t:_u,i=_d(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=LE("firestore");a&&UL(i,...a)}return i}function pg(t){if(t._terminated)throw new G(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||HL(t),t._firestoreClient}function HL(t){const e=t._freezeSettings(),r=function(i,a,s,o){return new mD(i,a,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,GT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator)}(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new LL(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(i){const a=i?._online.build();return{_offline:i?._offline.build(a),_online:a}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mr(Bt.fromBase64String(e))}catch(r){throw new G(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Mr(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nc(e,Mr._jsonSchema))return Mr.fromBase64String(e.bytes)}}Mr._jsonSchemaVersion="firestore/bytes/1.0",Mr._jsonSchema={type:gt("string",Mr._jsonSchemaVersion),bytes:gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new G(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new zt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new G(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new G(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return we(this._lat,e._lat)||we(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:xn._jsonSchemaVersion}}static fromJSON(e){if(Nc(e,xn._jsonSchema))return new xn(e.latitude,e.longitude)}}xn._jsonSchemaVersion="firestore/geoPoint/1.0",xn._jsonSchema={type:gt("string",xn._jsonSchemaVersion),latitude:gt("number"),longitude:gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:wn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nc(e,wn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new wn(e.vectorValues);throw new G(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}wn._jsonSchemaVersion="firestore/vectorValue/1.0",wn._jsonSchema={type:gt("string",wn._jsonSchemaVersion),vectorValues:gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=/^__.*__$/;class KL{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Ga(e,this.data,this.fieldMask,r,this.fieldTransforms):new jc(e,this.data,r,this.fieldTransforms)}}function QT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ac:t})}}class yg{constructor(e,r,n,i,a,s){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new yg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Nu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(QT(this.Ac)&&WL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GL{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Dd(e)}Cc(e,r,n,i=!1){return new yg({Ac:e,methodName:r,Dc:n,path:zt.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function XT(t){const e=t._freezeSettings(),r=Dd(t._databaseId);return new GL(t._databaseId,!!e.ignoreUndefinedProperties,r)}function YL(t,e,r,n,i,a={}){const s=t.Cc(a.merge||a.mergeFields?2:0,e,r,i);tA("Data must be an object, but it was:",s,n);const o=JT(n,s);let c,l;if(a.merge)c=new Qr(s.fieldMask),l=s.fieldTransforms;else if(a.mergeFields){const u=[];for(const h of a.mergeFields){const m=QL(e,h,r);if(!s.contains(m))throw new G(F.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);JL(u,m)||u.push(m)}c=new Qr(u),l=s.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=s.fieldTransforms;return new KL(new Dr(o),c,l)}function ZL(t,e,r,n=!1){return vg(r,t.Cc(n?4:3,e))}function vg(t,e){if(eA(t=rr(t)))return tA("Unsupported field value:",e,t),JT(t,e);if(t instanceof ZT)return function(n,i){if(!QT(i.Ac))throw i.Sc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,i){const a=[];let s=0;for(const o of n){let c=vg(o,i.wc(s));c==null&&(c={nullValue:"NULL_VALUE"}),a.push(c),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=rr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return LD(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Ke.fromDate(n);return{timestampValue:Su(i.serializer,a)}}if(n instanceof Ke){const a=new Ke(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Su(i.serializer,a)}}if(n instanceof xn)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Mr)return{bytesValue:pT(i.serializer,n._byteString)};if(n instanceof yt){const a=i.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw i.Sc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:tg(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof wn)return function(s,o){return{mapValue:{fields:{[B1]:{stringValue:q1},[Eu]:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw o.Sc("VectorValues must only contain numeric values.");return Xp(o.serializer,l)})}}}}}}(n,i);throw i.Sc(`Unsupported field value: ${Id(n)}`)}(t,e)}function JT(t,e){const r={};return L1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Wa(t,(n,i)=>{const a=vg(i,e.mc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function eA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof xn||t instanceof Mr||t instanceof yt||t instanceof ZT||t instanceof wn)}function tA(t,e,r){if(!eA(r)||!D1(r)){const n=Id(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function QL(t,e,r){if((e=rr(e))instanceof gg)return e._internalPath;if(typeof e=="string")return rA(t,e);throw Nu("Field path arguments must be of type string or ",t,!1,void 0,r)}const XL=new RegExp("[~\\*/\\[\\]]");function rA(t,e,r){if(e.search(XL)>=0)throw Nu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new gg(...e.split("."))._internalPath}catch{throw Nu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Nu(t,e,r,n,i){const a=n&&!n.isEmpty(),s=i!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(a||s)&&(c+=" (found",a&&(c+=` in field ${n}`),s&&(c+=` in document ${i}`),c+=")"),new G(F.INVALID_ARGUMENT,o+t+c)}function JL(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new e4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Fd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class e4 extends nA{data(){return super.data()}}function Fd(t,e){return typeof e=="string"?rA(t,e):e instanceof gg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t4(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bg{}class iA extends bg{}function r4(t,e,...r){let n=[];e instanceof bg&&n.push(e),n=n.concat(r),function(a){const s=a.filter(c=>c instanceof xg).length,o=a.filter(c=>c instanceof zd).length;if(s>1||s>0&&o>0)throw new G(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class zd extends iA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new zd(e,r,n)}_apply(e){const r=this._parse(e);return aA(e._query,r),new Za(e.firestore,e.converter,mm(e._query,r))}_parse(e){const r=XT(e.firestore);return function(a,s,o,c,l,u,h){let m;if(l.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new G(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){zb(h,u);const v=[];for(const b of h)v.push(Fb(c,a,b));m={arrayValue:{values:v}}}else m=Fb(c,a,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||zb(h,u),m=ZL(o,s,h,u==="in"||u==="not-in");return pt.create(l,u,m)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function n4(t,e,r){const n=e,i=Fd("where",t);return zd._create(i,n,r)}class xg extends bg{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new xg(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:tn.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let s=i;const o=a.getFlattenedFilters();for(const c of o)aA(s,c),s=mm(s,c)}(e._query,r),new Za(e.firestore,e.converter,mm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wg extends iA{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new wg(e,r)}_apply(e){const r=function(i,a,s){if(i.startAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new G(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cc(a,s)}(e._query,this._field,this._direction);return new Za(e.firestore,e.converter,function(i,a){const s=i.explicitOrderBy.concat([a]);return new Ys(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}function i4(t,e="asc"){const r=e,n=Fd("orderBy",t);return wg._create(n,r)}function Fb(t,e,r){if(typeof(r=rr(r))=="string"){if(r==="")throw new G(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!X1(e)&&r.indexOf("/")!==-1)throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ue.fromString(r));if(!ne.isDocumentKey(n))throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return rb(t,new ne(n))}if(r instanceof yt)return rb(t,r._key);throw new G(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Id(r)}.`)}function zb(t,e){if(!Array.isArray(t)||t.length===0)throw new G(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function aA(t,e){const r=function(i,a){for(const s of i)for(const o of s.getFlattenedFilters())if(a.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class a4{convertValue(e,r="none"){switch($i(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Li(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Wa(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){const r=e.fields?.[Eu].arrayValue?.values?.map(n=>ct(n.doubleValue));return new wn(r)}convertGeoPoint(e){return new xn(ct(e.latitude),ct(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Cd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(ac(e));default:return null}}convertTimestamp(e){const r=Mi(e);return new Ke(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ue.fromString(e);Ne(wT(n),9688,{name:e});const i=new sc(n.get(1),n.get(3)),a=new ne(n.popFirst(5));return i.isEqual(r)||Jn(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class $o{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ea extends nA{constructor(e,r,n,i,a,s){super(e,r,n,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new nu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Fd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Ea._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ea._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ea._jsonSchema={type:gt("string",Ea._jsonSchemaVersion),bundleSource:gt("string","DocumentSnapshot"),bundleName:gt("string"),bundle:gt("string")};class nu extends Ea{data(e={}){return super.data(e)}}class Is{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new $o(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new nu(this._firestore,this._userDataWriter,n.key,n,new $o(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new G(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(o=>{const c=new nu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new $o(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>a||o.type!==3).map(o=>{const c=new nu(i._firestore,i._userDataWriter,o.doc.key,o.doc,new $o(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let l=-1,u=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:o4(o.type),doc:c,oldIndex:l,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Is._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function o4(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(t){t=Ma(t,yt);const e=Ma(t.firestore,Vd);return FL(pg(e),t._key).then(r=>d4(e,t,r))}Is._jsonSchemaVersion="firestore/querySnapshot/1.0",Is._jsonSchema={type:gt("string",Is._jsonSchemaVersion),bundleSource:gt("string","QuerySnapshot"),bundleName:gt("string"),bundle:gt("string")};class sA extends a4{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mr(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new yt(this.firestore,null,r)}}function l4(t){t=Ma(t,Za);const e=Ma(t.firestore,Vd),r=pg(e),n=new sA(e);return t4(t._query),zL(r,t._query).then(i=>new Is(e,n,t,i))}function Ub(t,e,r){t=Ma(t,yt);const n=Ma(t.firestore,Vd),i=s4(t.converter,e);return u4(n,[YL(XT(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,Wn.none())])}function u4(t,e){return function(n,i){const a=new Hn;return n.asyncQueue.enqueueAndForget(async()=>PL(await VL(n),i,a)),a.promise}(pg(t),e)}function d4(t,e,r){const n=r.docs.get(e._key),i=new sA(t);return new Ea(t,i,e._key,n,new $o(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){Ws=i})(qa),ja(new Ri("firestore",(n,{instanceIdentifier:i,options:a})=>{const s=n.getProvider("app").getImmediate(),o=new Vd(new Y2(n.getProvider("auth-internal")),new X2(s,n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new G(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new sc(l.options.projectId,u)}(s,i),s);return a={useFetchStreams:r,...a},o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),pn(B0,q0,e),pn(B0,q0,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="firebasestorage.googleapis.com",h4="storageBucket",f4=2*60*1e3,m4=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn extends Cn{constructor(e,r,n=0){super(pf(e),`Firebase Storage: ${r} (${pf(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return pf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var In;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(In||(In={}));function pf(t){return"storage/"+t}function p4(){const t="An unknown error occurred, please check the error payload for server response.";return new kn(In.UNKNOWN,t)}function g4(){return new kn(In.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function y4(){return new kn(In.CANCELED,"User canceled the upload/download.")}function v4(t){return new kn(In.INVALID_URL,"Invalid URL '"+t+"'.")}function b4(t){return new kn(In.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Bb(t){return new kn(In.INVALID_ARGUMENT,t)}function cA(){return new kn(In.APP_DELETED,"The Firebase app was deleted.")}function x4(t){return new kn(In.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Xr.makeFromUrl(e,r)}catch{return new Xr(e,"")}if(n.path==="")return n;throw b4(e)}static makeFromUrl(e,r){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(j){j.path.charAt(j.path.length-1)==="/"&&(j.path_=j.path_.slice(0,-1))}const s="(/(.*))?$",o=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function l(j){j.path_=decodeURIComponent(j.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${m}`,"i"),v={bucket:1,path:3},b=r===oA?"(?:storage.googleapis.com|storage.cloud.google.com)":r,g="([^?#]*)",_=new RegExp(`^https?://${b}/${i}/${g}`,"i"),E=[{regex:o,indices:c,postModify:a},{regex:p,indices:v,postModify:l},{regex:_,indices:{bucket:1,path:2},postModify:l}];for(let j=0;j<E.length;j++){const R=E[j],D=R.regex.exec(e);if(D){const I=D[R.indices.bucket];let A=D[R.indices.path];A||(A=""),n=new Xr(I,A),R.postModify(n);break}}if(n==null)throw v4(e);return n}}class w4{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(t,e,r){let n=1,i=null,a=null,s=!1,o=0;function c(){return o===2}let l=!1;function u(...g){l||(l=!0,e.apply(null,g))}function h(g){i=setTimeout(()=>{i=null,t(p,c())},g)}function m(){a&&clearTimeout(a)}function p(g,..._){if(l){m();return}if(g){m(),u.call(null,g,..._);return}if(c()||s){m(),u.call(null,g,..._);return}n<64&&(n*=2);let E;o===1?(o=2,E=0):E=(n+Math.random())*1e3,h(E)}let v=!1;function b(g){v||(v=!0,m(),!l&&(i!==null?(g||(o=2),clearTimeout(i),h(0)):g||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,b(!0)},r),b}function E4(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){return t!==void 0}function qb(t,e,r,n){if(n<e)throw Bb(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Bb(`Invalid value for '${t}'. Expected ${r} or less.`)}function A4(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const i=e(n)+"="+e(t[n]);r=r+i+"&"}return r=r.slice(0,-1),r}var ju;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ju||(ju={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I4(t,e){const r=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,a=e.indexOf(t)!==-1;return r||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e,r,n,i,a,s,o,c,l,u,h,m=!0,p=!1){this.url_=e,this.method_=r,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.retry=m,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,b)=>{this.resolve_=v,this.reject_=b,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Al(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const s=o=>{const c=o.loaded,l=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const o=a.getErrorCode()===ju.NO_ERROR,c=a.getStatus();if(!o||I4(c,this.additionalRetryCodes_)&&this.retry){const u=a.getErrorCode()===ju.ABORT;n(!1,new Al(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;n(!0,new Al(l,a))})},r=(n,i)=>{const a=this.resolve_,s=this.reject_,o=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(o,o.getResponse());T4(c)?a(c):a()}catch(c){s(c)}else if(o!==null){const c=p4();c.serverResponse=o.getErrorText(),this.errorCallback_?s(this.errorCallback_(o,c)):s(c)}else if(i.canceled){const c=this.appDelete_?cA():y4();s(c)}else{const c=g4();s(c)}};this.canceled_?r(!1,new Al(!1,null,!0)):this.backoffId_=_4(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&E4(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Al{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function P4(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function C4(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function k4(t,e){e&&(t["X-Firebase-GMPID"]=e)}function N4(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function j4(t,e,r,n,i,a,s=!0,o=!1){const c=A4(t.urlParams),l=t.url+c,u=Object.assign({},t.headers);return k4(u,e),P4(u,r),C4(u,a),N4(u,n),new S4(l,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O4(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function R4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,r){this._service=e,r instanceof Xr?this._location=r:this._location=Xr.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Ou(e,r)}get root(){const e=new Xr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return R4(this._location.path)}get storage(){return this._service}get parent(){const e=O4(this._location.path);if(e===null)return null;const r=new Xr(this._location.bucket,e);return new Ou(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw x4(e)}}function Hb(t,e){const r=e?.[h4];return r==null?null:Xr.makeFromBucketSpec(r,t)}function D4(t,e,r,n={}){t.host=`${e}:${r}`;const i=Ba(e);i&&(Np(`https://${t.host}/b`),jp("Storage",!0)),t._isUsingEmulator=!0,t._protocol=i?"https":"http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:FE(a,t.app.options.projectId))}class M4{constructor(e,r,n,i,a,s=!1){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._isUsingEmulator=s,this._bucket=null,this._host=oA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=f4,this._maxUploadRetryTime=m4,this._requests=new Set,i!=null?this._bucket=Xr.makeFromBucketSpec(i,this._host):this._bucket=Hb(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xr.makeFromBucketSpec(this._url,e):this._bucket=Hb(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qb("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qb("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(_r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ou(this,e)}_makeRequest(e,r,n,i,a=!0){if(this._deleted)return new w4(cA());{const s=j4(e,this._appId,n,i,r,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,r){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,i).getPromise()}}const Wb="@firebase/storage",Kb="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA="storage";function L4(t=Dp(),e){t=rr(t);const n=_d(t,lA).getImmediate({identifier:e}),i=LE("storage");return i&&$4(n,...i),n}function $4(t,e,r,n={}){D4(t,e,r,n)}function V4(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new M4(r,n,i,e,qa)}function F4(){ja(new Ri(lA,V4,"PUBLIC").setMultipleInstances(!0)),pn(Wb,Kb,""),pn(Wb,Kb,"esm2020")}F4();const Am={apiKey:window.__FIREBASE_CONFIG__?.apiKey,authDomain:window.__FIREBASE_CONFIG__?.authDomain,projectId:window.__FIREBASE_CONFIG__?.projectId,storageBucket:window.__FIREBASE_CONFIG__?.storageBucket,messagingSenderId:window.__FIREBASE_CONFIG__?.messagingSenderId,appId:window.__FIREBASE_CONFIG__?.appId};(!Am.apiKey||!Am.projectId)&&console.error("[Firebase] Missing configuration. Ensure .env is configured or public/firebase-config.js is loaded.");const Ud=BE(Am);console.log("Firebase app initialized:",Ud);const Vo=H2(Ud);console.log("Firebase auth instance:",Vo);const Im=qL(Ud);L4(Ud);const Nn=Pp((t,e)=>({user:null,initialized:!1,isLoading:!1,error:null,initialize:()=>{OR(Vo,async r=>{try{if(r){console.log("[AUTH STORE] User authenticated:",r.uid);const n=Mb(Im,"profiles",r.uid),i=await c4(n);if(i.exists()){const a=i.data();t(Ie(s=>{s.user={id:r.uid,...a},s.initialized=!0,s.error=null,s.isLoading=!1}))}else{const a={id:r.uid,email:r.email,fullName:null,avatarUrl:null,preferences:{}};await Ub(n,a),t(Ie(s=>{s.user=a,s.initialized=!0,s.error=null,s.isLoading=!1}))}}else t(Ie(n=>{n.user=null,n.initialized=!0,n.error=null,n.isLoading=!1}))}catch(n){console.error("[AUTH STORE] Error in auth state change:",n),t(Ie(i=>{i.error=n instanceof Error?n.message:"Error de autenticación",i.initialized=!0,i.isLoading=!1}))}})},signIn:async(r,n)=>{try{t(Ie(i=>{i.isLoading=!0,i.error=null})),console.log("[AUTH STORE] Attempting sign in with email:",r),await kR(Vo,r,n)}catch(i){throw console.error("[AUTH STORE] Sign in error:",i),t(Ie(a=>{a.error=i.message||"Error al iniciar sesión",a.isLoading=!1})),i}},signUp:async(r,n,i,a)=>{try{if(t(Ie(c=>{c.isLoading=!0,c.error=null})),i&&n!==i)throw new Error("Las contraseñas no coinciden");const o=(await CR(Vo,r,n)).user;if(o){const c={id:o.uid,email:o.email,fullName:a||null,avatarUrl:null,preferences:{}},l=Mb(Im,"profiles",o.uid);await Ub(l,c)}else throw new Error("Error al crear el usuario")}catch(s){throw console.error("[AUTH STORE] Sign up error:",s),t(Ie(o=>{o.error=s.message||"Error al crear la cuenta",o.isLoading=!1})),s}},signOut:async()=>{try{t(Ie(r=>{r.isLoading=!0,r.error=null})),await RR(Vo)}catch(r){throw console.error("[AUTH STORE] Sign out error:",r),t(Ie(n=>{n.error=r.message||"Error al cerrar sesión",n.isLoading=!1})),r}},clearError:()=>{t(Ie(r=>{r.error=null}))}})),jr={initialization:{timeout:5e3,retryAttempts:2,retryDelay:1e3,emergencyFallbackTimeout:8e3},performance:{trackInitialization:!0,slowConnectionThreshold:3e3,performanceLogging:!1},ui:{showProgressIndicator:!0,progressSteps:["Conectando...","Verificando sesión...","Cargando perfil...","Inicializando..."],minLoadingTime:500}};class z4{constructor(){yr(this,"metrics");this.metrics={startTime:Date.now(),retryCount:0,errors:[],success:!1,isSlowConnection:!1,emergencyFallbackUsed:!1}}recordRetry(e){this.metrics.retryCount++,e&&this.metrics.errors.push(e)}recordError(e){this.metrics.errors.push(e)}recordSuccess(){this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime,this.metrics.success=!0,this.metrics.isSlowConnection=this.metrics.duration>jr.performance.slowConnectionThreshold}recordEmergencyFallback(){this.metrics.emergencyFallbackUsed=!0,this.metrics.endTime||(this.metrics.endTime=Date.now(),this.metrics.duration=this.metrics.endTime-this.metrics.startTime)}getMetrics(){return{...this.metrics}}logPerformance(){}}const U4=()=>{const{user:t,initialized:e,initialize:r}=Nn(),[n,i]=w.useState({initialized:!1,loading:!1,error:null,progress:{step:0,message:jr.ui.progressSteps[0]},retryCount:0,emergencyFallbackUsed:!1}),a=w.useRef(null),s=w.useRef({}),o=w.useRef(!1),c=b=>{b<jr.ui.progressSteps.length&&i(g=>({...g,progress:{step:b,message:jr.ui.progressSteps[b]}}))},l=()=>{Object.values(s.current).forEach(b=>{b&&clearTimeout(b)}),s.current={}},u=()=>{a.current&&(a.current.recordSuccess(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,error:null})),l()},h=(b,g=!0)=>{a.current&&a.current.recordError(b),i(_=>({..._,error:b,loading:!g})),g&&n.retryCount<jr.initialization.retryAttempts&&m()},m=()=>{const b=n.retryCount+1;a.current&&a.current.recordRetry(`Retry attempt ${b}`),i(g=>({...g,retryCount:b,progress:{step:0,message:`Reintentando... (${b}/${jr.initialization.retryAttempts})`}})),s.current.retry=setTimeout(()=>{v()},jr.initialization.retryDelay)},p=()=>{n.emergencyFallbackUsed||(console.warn("[Auth] Emergency fallback triggered - forcing app render"),a.current&&(a.current.recordEmergencyFallback(),a.current.logPerformance()),i(b=>({...b,initialized:!0,loading:!1,emergencyFallbackUsed:!0,error:"Inicialización lenta - continuando..."})),l())},v=async()=>{i(b=>({...b,loading:!0,error:null})),c(1);try{jr.performance.trackInitialization&&!a.current&&(a.current=new z4),c(2),await r(),c(3),jr.ui.minLoadingTime>0&&await new Promise(b=>setTimeout(b,jr.ui.minLoadingTime)),u()}catch(b){const g=b instanceof Error?b.message:"Error de inicialización";h(g)}};return w.useEffect(()=>{if(!o.current){if(o.current=!0,e){u();return}return s.current.primary=setTimeout(()=>{n.initialized||h("Timeout de inicialización",!0)},jr.initialization.timeout),s.current.emergency=setTimeout(()=>{n.initialized||p()},jr.initialization.emergencyFallbackTimeout),v(),()=>{l()}}},[]),w.useEffect(()=>{e&&!n.initialized&&u()},[e,n.initialized]),{...n,user:t,metrics:a.current?.getMetrics()}};function B4(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const q4=t=>{switch(t){case"success":return K4;case"info":return Y4;case"warning":return G4;case"error":return Z4;default:return null}},H4=Array(12).fill(0),W4=({visible:t,className:e})=>q.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},q.createElement("div",{className:"sonner-spinner"},H4.map((r,n)=>q.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),K4=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),G4=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Y4=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Z4=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Q4=q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},q.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),q.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),X4=()=>{const[t,e]=q.useState(document.hidden);return q.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let Sm=1;class J4{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:n,...i}=e,a=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:Sm++,s=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:n}),{...c,...e,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...i,dismissible:o,id:a}),a},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let a=n!==void 0,s;const o=i.then(async l=>{if(s=["resolve",l],q.isValidElement(l))a=!1,this.create({id:n,type:"default",message:l});else if(t$(l)&&!l.ok){a=!1;const h=typeof r.error=="function"?await r.error(`HTTP error! status: ${l.status}`):r.error,m=typeof r.description=="function"?await r.description(`HTTP error! status: ${l.status}`):r.description,v=typeof h=="object"&&!q.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(l instanceof Error){a=!1;const h=typeof r.error=="function"?await r.error(l):r.error,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!q.isValidElement(h)?h:{message:h};this.create({id:n,type:"error",description:m,...v})}else if(r.success!==void 0){a=!1;const h=typeof r.success=="function"?await r.success(l):r.success,m=typeof r.description=="function"?await r.description(l):r.description,v=typeof h=="object"&&!q.isValidElement(h)?h:{message:h};this.create({id:n,type:"success",description:m,...v})}}).catch(async l=>{if(s=["reject",l],r.error!==void 0){a=!1;const u=typeof r.error=="function"?await r.error(l):r.error,h=typeof r.description=="function"?await r.description(l):r.description,p=typeof u=="object"&&!q.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:h,...p})}}).finally(()=>{a&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),c=()=>new Promise((l,u)=>o.then(()=>s[0]==="reject"?u(s[1]):l(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(e,r)=>{const n=r?.id||Sm++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const cr=new J4,e$=(t,e)=>{const r=e?.id||Sm++;return cr.addToast({title:t,...e,id:r}),r},t$=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",r$=e$,n$=()=>cr.toasts,i$=()=>cr.getActiveToasts(),uA=Object.assign(r$,{success:cr.success,info:cr.info,warning:cr.warning,error:cr.error,custom:cr.custom,message:cr.message,promise:cr.promise,dismiss:cr.dismiss,loading:cr.loading},{getHistory:n$,getToasts:i$});B4("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Il(t){return t.label!==void 0}const a$=3,s$="24px",o$="16px",Gb=4e3,c$=356,l$=14,u$=45,d$=200;function cn(...t){return t.filter(Boolean).join(" ")}function h$(t){const[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}const f$=t=>{var e,r,n,i,a,s,o,c,l;const{invert:u,toast:h,unstyled:m,interacting:p,setHeights:v,visibleToasts:b,heights:g,index:_,toasts:T,expanded:E,removeToast:j,defaultRichColors:R,closeButton:D,style:I,cancelButtonStyle:A,actionButtonStyle:P,className:O="",descriptionClassName:N="",duration:C,position:k,gap:J,expandByDefault:oe,classNames:X,icons:te,closeButtonAriaLabel:he="Close toast"}=t,[ye,Be]=q.useState(null),[se,W]=q.useState(null),[ee,rt]=q.useState(!1),[Fe,ze]=q.useState(!1),[Cr,nn]=q.useState(!1),[Y,de]=q.useState(!1),[be,B]=q.useState(!1),[dt,Te]=q.useState(0),[xt,wt]=q.useState(0),nr=q.useRef(h.duration||C||Gb),ea=q.useRef(null),kr=q.useRef(null),so=_===0,Qc=_+1<=b,ir=h.type,an=h.dismissible!==!1,oo=h.className||"",Xc=h.descriptionClassName||"",at=q.useMemo(()=>g.findIndex(ce=>ce.toastId===h.id)||0,[g,h.id]),Ot=q.useMemo(()=>{var ce;return(ce=h.closeButton)!=null?ce:D},[h.closeButton,D]),ta=q.useMemo(()=>h.duration||C||Gb,[h.duration,C]),is=q.useRef(0),jn=q.useRef(0),Jc=q.useRef(0),Nr=q.useRef(null),[el,tl]=k.split("-"),as=q.useMemo(()=>g.reduce((ce,st,ot)=>ot>=at?ce:ce+st.height,0),[g,at]),rl=X4(),Fh=h.invert||u,ra=ir==="loading";jn.current=q.useMemo(()=>at*J+as,[at,as]),q.useEffect(()=>{nr.current=ta},[ta]),q.useEffect(()=>{rt(!0)},[]),q.useEffect(()=>{const ce=kr.current;if(ce){const st=ce.getBoundingClientRect().height;return wt(st),v(ot=>[{toastId:h.id,height:st,position:h.position},...ot]),()=>v(ot=>ot.filter(Wt=>Wt.toastId!==h.id))}},[v,h.id]),q.useLayoutEffect(()=>{if(!ee)return;const ce=kr.current,st=ce.style.height;ce.style.height="auto";const ot=ce.getBoundingClientRect().height;ce.style.height=st,wt(ot),v(Wt=>Wt.find(ht=>ht.toastId===h.id)?Wt.map(ht=>ht.toastId===h.id?{...ht,height:ot}:ht):[{toastId:h.id,height:ot,position:h.position},...Wt])},[ee,h.title,h.description,v,h.id,h.jsx,h.action,h.cancel]);const Hr=q.useCallback(()=>{ze(!0),Te(jn.current),v(ce=>ce.filter(st=>st.toastId!==h.id)),setTimeout(()=>{j(h)},d$)},[h,j,v,jn]);q.useEffect(()=>{if(h.promise&&ir==="loading"||h.duration===1/0||h.type==="loading")return;let ce;return E||p||rl?(()=>{if(Jc.current<is.current){const Wt=new Date().getTime()-is.current;nr.current=nr.current-Wt}Jc.current=new Date().getTime()})():(()=>{nr.current!==1/0&&(is.current=new Date().getTime(),ce=setTimeout(()=>{h.onAutoClose==null||h.onAutoClose.call(h,h),Hr()},nr.current))})(),()=>clearTimeout(ce)},[E,p,h,ir,rl,Hr]),q.useEffect(()=>{h.delete&&(Hr(),h.onDismiss==null||h.onDismiss.call(h,h))},[Hr,h.delete]);function nl(){var ce;if(te?.loading){var st;return q.createElement("div",{className:cn(X?.loader,h==null||(st=h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":ir==="loading"},te.loading)}return q.createElement(W4,{className:cn(X?.loader,h==null||(ce=h.classNames)==null?void 0:ce.loader),visible:ir==="loading"})}const na=h.icon||te?.[ir]||q4(ir);var ss,os;return q.createElement("li",{tabIndex:0,ref:kr,className:cn(O,oo,X?.toast,h==null||(e=h.classNames)==null?void 0:e.toast,X?.default,X?.[ir],h==null||(r=h.classNames)==null?void 0:r[ir]),"data-sonner-toast":"","data-rich-colors":(ss=h.richColors)!=null?ss:R,"data-styled":!(h.jsx||h.unstyled||m),"data-mounted":ee,"data-promise":!!h.promise,"data-swiped":be,"data-removed":Fe,"data-visible":Qc,"data-y-position":el,"data-x-position":tl,"data-index":_,"data-front":so,"data-swiping":Cr,"data-dismissible":an,"data-type":ir,"data-invert":Fh,"data-swipe-out":Y,"data-swipe-direction":se,"data-expanded":!!(E||oe&&ee),style:{"--index":_,"--toasts-before":_,"--z-index":T.length-_,"--offset":`${Fe?dt:jn.current}px`,"--initial-height":oe?"auto":`${xt}px`,...I,...h.style},onDragEnd:()=>{nn(!1),Be(null),Nr.current=null},onPointerDown:ce=>{ce.button!==2&&(ra||!an||(ea.current=new Date,Te(jn.current),ce.target.setPointerCapture(ce.pointerId),ce.target.tagName!=="BUTTON"&&(nn(!0),Nr.current={x:ce.clientX,y:ce.clientY})))},onPointerUp:()=>{var ce,st,ot;if(Y||!an)return;Nr.current=null;const Wt=Number(((ce=kr.current)==null?void 0:ce.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),sn=Number(((st=kr.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ht=new Date().getTime()-((ot=ea.current)==null?void 0:ot.getTime()),Re=ye==="x"?Wt:sn,ia=Math.abs(Re)/ht;if(Math.abs(Re)>=u$||ia>.11){Te(jn.current),h.onDismiss==null||h.onDismiss.call(h,h),W(ye==="x"?Wt>0?"right":"left":sn>0?"down":"up"),Hr(),de(!0);return}else{var Rt,Dt;(Rt=kr.current)==null||Rt.style.setProperty("--swipe-amount-x","0px"),(Dt=kr.current)==null||Dt.style.setProperty("--swipe-amount-y","0px")}B(!1),nn(!1),Be(null)},onPointerMove:ce=>{var st,ot,Wt;if(!Nr.current||!an||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;const ht=ce.clientY-Nr.current.y,Re=ce.clientX-Nr.current.x;var ia;const Rt=(ia=t.swipeDirections)!=null?ia:h$(k);!ye&&(Math.abs(Re)>1||Math.abs(ht)>1)&&Be(Math.abs(Re)>Math.abs(ht)?"x":"y");let Dt={x:0,y:0};const il=On=>1/(1.5+Math.abs(On)/20);if(ye==="y"){if(Rt.includes("top")||Rt.includes("bottom"))if(Rt.includes("top")&&ht<0||Rt.includes("bottom")&&ht>0)Dt.y=ht;else{const On=ht*il(ht);Dt.y=Math.abs(On)<Math.abs(ht)?On:ht}}else if(ye==="x"&&(Rt.includes("left")||Rt.includes("right")))if(Rt.includes("left")&&Re<0||Rt.includes("right")&&Re>0)Dt.x=Re;else{const On=Re*il(Re);Dt.x=Math.abs(On)<Math.abs(Re)?On:Re}(Math.abs(Dt.x)>0||Math.abs(Dt.y)>0)&&B(!0),(ot=kr.current)==null||ot.style.setProperty("--swipe-amount-x",`${Dt.x}px`),(Wt=kr.current)==null||Wt.style.setProperty("--swipe-amount-y",`${Dt.y}px`)}},Ot&&!h.jsx&&ir!=="loading"?q.createElement("button",{"aria-label":he,"data-disabled":ra,"data-close-button":!0,onClick:ra||!an?()=>{}:()=>{Hr(),h.onDismiss==null||h.onDismiss.call(h,h)},className:cn(X?.closeButton,h==null||(n=h.classNames)==null?void 0:n.closeButton)},(os=te?.close)!=null?os:Q4):null,(ir||h.icon||h.promise)&&h.icon!==null&&(te?.[ir]!==null||h.icon)?q.createElement("div",{"data-icon":"",className:cn(X?.icon,h==null||(i=h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||nl():null,h.type!=="loading"?na:null):null,q.createElement("div",{"data-content":"",className:cn(X?.content,h==null||(a=h.classNames)==null?void 0:a.content)},q.createElement("div",{"data-title":"",className:cn(X?.title,h==null||(s=h.classNames)==null?void 0:s.title)},h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title),h.description?q.createElement("div",{"data-description":"",className:cn(N,Xc,X?.description,h==null||(o=h.classNames)==null?void 0:o.description)},typeof h.description=="function"?h.description():h.description):null),q.isValidElement(h.cancel)?h.cancel:h.cancel&&Il(h.cancel)?q.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||A,onClick:ce=>{Il(h.cancel)&&an&&(h.cancel.onClick==null||h.cancel.onClick.call(h.cancel,ce),Hr())},className:cn(X?.cancelButton,h==null||(c=h.classNames)==null?void 0:c.cancelButton)},h.cancel.label):null,q.isValidElement(h.action)?h.action:h.action&&Il(h.action)?q.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||P,onClick:ce=>{Il(h.action)&&(h.action.onClick==null||h.action.onClick.call(h.action,ce),!ce.defaultPrevented&&Hr())},className:cn(X?.actionButton,h==null||(l=h.classNames)==null?void 0:l.actionButton)},h.action.label):null)};function Yb(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function m$(t,e){const r={};return[t,e].forEach((n,i)=>{const a=i===1,s=a?"--mobile-offset":"--offset",o=a?o$:s$;function c(l){["top","right","bottom","left"].forEach(u=>{r[`${s}-${u}`]=typeof l=="number"?`${l}px`:l})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(l=>{n[l]===void 0?r[`${s}-${l}`]=o:r[`${s}-${l}`]=typeof n[l]=="number"?`${n[l]}px`:n[l]}):c(o)}),r}const p$=q.forwardRef(function(e,r){const{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:o,className:c,offset:l,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:v,visibleToasts:b=a$,toastOptions:g,dir:_=Yb(),gap:T=l$,icons:E,containerAriaLabel:j="Notifications"}=e,[R,D]=q.useState([]),I=q.useMemo(()=>Array.from(new Set([i].concat(R.filter(se=>se.position).map(se=>se.position)))),[R,i]),[A,P]=q.useState([]),[O,N]=q.useState(!1),[C,k]=q.useState(!1),[J,oe]=q.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=q.useRef(null),te=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),he=q.useRef(null),ye=q.useRef(!1),Be=q.useCallback(se=>{D(W=>{var ee;return(ee=W.find(rt=>rt.id===se.id))!=null&&ee.delete||cr.dismiss(se.id),W.filter(({id:rt})=>rt!==se.id)})},[]);return q.useEffect(()=>cr.subscribe(se=>{if(se.dismiss){requestAnimationFrame(()=>{D(W=>W.map(ee=>ee.id===se.id?{...ee,delete:!0}:ee))});return}setTimeout(()=>{hN.flushSync(()=>{D(W=>{const ee=W.findIndex(rt=>rt.id===se.id);return ee!==-1?[...W.slice(0,ee),{...W[ee],...se},...W.slice(ee+1)]:[se,...W]})})})}),[R]),q.useEffect(()=>{if(h!=="system"){oe(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?oe("dark"):oe("light")),typeof window>"u")return;const se=window.matchMedia("(prefers-color-scheme: dark)");try{se.addEventListener("change",({matches:W})=>{oe(W?"dark":"light")})}catch{se.addListener(({matches:ee})=>{try{oe(ee?"dark":"light")}catch(rt){console.error(rt)}})}},[h]),q.useEffect(()=>{R.length<=1&&N(!1)},[R]),q.useEffect(()=>{const se=W=>{var ee;if(a.every(ze=>W[ze]||W.code===ze)){var Fe;N(!0),(Fe=X.current)==null||Fe.focus()}W.code==="Escape"&&(document.activeElement===X.current||(ee=X.current)!=null&&ee.contains(document.activeElement))&&N(!1)};return document.addEventListener("keydown",se),()=>document.removeEventListener("keydown",se)},[a]),q.useEffect(()=>{if(X.current)return()=>{he.current&&(he.current.focus({preventScroll:!0}),he.current=null,ye.current=!1)}},[X.current]),q.createElement("section",{ref:r,"aria-label":`${j} ${te}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},I.map((se,W)=>{var ee;const[rt,Fe]=se.split("-");return R.length?q.createElement("ol",{key:se,dir:_==="auto"?Yb():_,tabIndex:-1,ref:X,className:c,"data-sonner-toaster":!0,"data-sonner-theme":J,"data-y-position":rt,"data-x-position":Fe,style:{"--front-toast-height":`${((ee=A[0])==null?void 0:ee.height)||0}px`,"--width":`${c$}px`,"--gap":`${T}px`,...v,...m$(l,u)},onBlur:ze=>{ye.current&&!ze.currentTarget.contains(ze.relatedTarget)&&(ye.current=!1,he.current&&(he.current.focus({preventScroll:!0}),he.current=null))},onFocus:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,he.current=ze.relatedTarget)},onMouseEnter:()=>N(!0),onMouseMove:()=>N(!0),onMouseLeave:()=>{C||N(!1)},onDragEnd:()=>N(!1),onPointerDown:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||k(!0)},onPointerUp:()=>k(!1)},R.filter(ze=>!ze.position&&W===0||ze.position===se).map((ze,Cr)=>{var nn,Y;return q.createElement(f$,{key:ze.id,icons:E,index:Cr,toast:ze,defaultRichColors:m,duration:(nn=g?.duration)!=null?nn:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:n,visibleToasts:b,closeButton:(Y=g?.closeButton)!=null?Y:o,interacting:C,position:se,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,closeButtonAriaLabel:g?.closeButtonAriaLabel,removeToast:Be,toasts:R.filter(de=>de.position==ze.position),heights:A.filter(de=>de.position==ze.position),setHeights:P,expandByDefault:s,gap:T,expanded:O,swipeDirections:e.swipeDirections})})):null}))});class g${constructor(){yr(this,"listeners",new Set)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}emit(e){this.listeners.forEach(r=>r(e))}success(e,r,n){this.emit({type:"success",title:e,message:r,duration:n})}error(e,r,n){this.emit({type:"error",title:e,message:r,duration:n})}warning(e,r,n){this.emit({type:"warning",title:e,message:r,duration:n})}info(e,r,n){this.emit({type:"info",title:e,message:r,duration:n})}}const Bd=new g$,dA=w.createContext(void 0),Qs=()=>{const t=w.useContext(dA);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},y$=t=>{switch(t){case"success":return d.jsx(Si,{size:20,className:"text-green-500"});case"error":return d.jsx(Jr,{size:20,className:"text-red-500"});case"warning":return d.jsx(Tn,{size:20,className:"text-yellow-500"});case"info":return d.jsx(uE,{size:20,className:"text-blue-500"})}},v$=t=>{switch(t){case"success":return"border-green-200 bg-green-50 dark:bg-green-900/20 dark:border-green-800";case"error":return"border-red-200 bg-red-50 dark:bg-red-900/20 dark:border-red-800";case"warning":return"border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20 dark:border-yellow-800";case"info":return"border-blue-200 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-800"}},b$=({children:t})=>{const[e,r]=w.useState([]),n=w.useCallback(s=>{const o=`toast-${Date.now()}-${Math.random()}`,c={id:o,duration:5e3,...s};r(l=>[...l,c]),c.duration!==0&&setTimeout(()=>{i(o)},c.duration)},[]);w.useEffect(()=>Bd.subscribe(o=>{n(o)}),[n]);const i=w.useCallback(s=>{r(o=>o.filter(c=>c.id!==s))},[]),a=w.useCallback(()=>{r([])},[]);return d.jsxs(dA.Provider,{value:{toasts:e,addToast:n,removeToast:i,clearToasts:a},children:[t,d.jsx(x$,{})]})},x$=()=>{const{toasts:t,removeToast:e}=Qs();return d.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:d.jsx(ke,{children:t.map(r=>d.jsx(L.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{type:"spring",damping:25,stiffness:300},className:`max-w-sm w-full rounded-lg border p-4 shadow-lg ${v$(r.type)}`,role:"alert","aria-live":"assertive",tabIndex:0,children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("div",{className:"flex-shrink-0 mt-0.5",children:y$(r.type)}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:r.title}),r.message&&d.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:r.message})]}),d.jsx("button",{onClick:()=>e(r.id),className:"flex-shrink-0 ml-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Cerrar notificación",children:d.jsx(Wi,{size:16})})]})},r.id))})})},vi={QUERY:{STALE_TIME:{MEDIUM:1e3*60*15},GC_TIME:{MEDIUM:1e3*60*30,LONG:1e3*60*60},RETRY:{COUNT:1,DELAY:1e3}}},yo={measureTime:async(t,e)=>typeof e=="function"?await e():e,markStart:t=>{},markEnd:t=>{},debounce:(t,e)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>t.apply(void 0,n),e)}},throttle:(t,e)=>{let r;return(...n)=>{r||(t.apply(void 0,n),r=!0,setTimeout(()=>r=!1,e))}}},w$=()=>(w.useEffect(()=>{},[]),{measureTime:yo.measureTime,markStart:yo.markStart,markEnd:yo.markEnd,debounce:yo.debounce,throttle:yo.throttle}),_$=()=>{const t=()=>{const e=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${e}px`),typeof CSS<"u"&&CSS.supports&&CSS.supports("padding","env(safe-area-inset-top)")?(document.documentElement.style.setProperty("--safe-area-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-bottom","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--safe-area-left","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--safe-area-right","env(safe-area-inset-right)")):(document.documentElement.style.setProperty("--safe-area-top","0px"),document.documentElement.style.setProperty("--safe-area-bottom","0px"),document.documentElement.style.setProperty("--safe-area-left","0px"),document.documentElement.style.setProperty("--safe-area-right","0px"))};return t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",()=>{setTimeout(t,100)}),"visualViewport"in window&&window.visualViewport?.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),"visualViewport"in window&&window.visualViewport?.removeEventListener("resize",t)}};const E$=()=>{const[t,e]=w.useState({isOnline:navigator.onLine});return w.useEffect(()=>{const r=()=>{const o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;e({isOnline:navigator.onLine,connectionType:o?.type,effectiveType:o?.effectiveType,downlink:o?.downlink,rtt:o?.rtt})},n=()=>{console.log("[Network] Connection restored"),r()},i=()=>{console.log("[Network] Connection lost"),r()},a=()=>{console.log("[Network] Connection changed"),r()};r(),window.addEventListener("online",n),window.addEventListener("offline",i);const s=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return s&&s.addEventListener("change",a),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i),s&&s.removeEventListener("change",a)}},[]),t},T$=()=>{const t=E$();return{...t,quality:(()=>{if(!t.isOnline)return"offline";if(t.effectiveType)switch(t.effectiveType){case"4g":return"fast";case"3g":return"slow";case"2g":return"slow";case"slow-2g":return"slow";default:return"fast"}return t.downlink!==void 0?t.downlink>1.5?"fast":"slow":"fast"})()}},A$=()=>{const[t,e]=w.useState(!1);T$();const{user:r,initialized:n}=Nn();return null},I$=()=>{},_g=(t,e)=>{console.error(`[CRITICAL][${t}]`,e),console.warn("Production error detected:",{context:t,error:e})};function hA(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=hA(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Le(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=hA(t))&&(n&&(n+=" "),n+=e);return n}const Eg="-",S$=t=>{const e=C$(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(Eg);return o[0]===""&&o.length!==1&&o.shift(),fA(o,e)||P$(s)},getConflictingClassGroupIds:(s,o)=>{const c=r[s]||[];return o&&n[s]?[...c,...n[s]]:c}}},fA=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?fA(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(Eg);return e.validators.find(({validator:s})=>s(a))?.classGroupId},Zb=/^\[(.+)\]$/,P$=t=>{if(Zb.test(t)){const e=Zb.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},C$=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return N$(Object.entries(t.classGroups),r).forEach(([a,s])=>{Pm(s,n,a,e)}),n},Pm=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:Qb(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(k$(i)){Pm(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{Pm(s,Qb(e,a),r,n)})})},Qb=(t,e)=>{let r=t;return e.split(Eg).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},k$=t=>t.isThemeGetter,N$=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,j$=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},mA="!",O$=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const c=[];let l=0,u=0,h;for(let g=0;g<o.length;g++){let _=o[g];if(l===0){if(_===i&&(n||o.slice(g,g+a)===e)){c.push(o.slice(u,g)),u=g+a;continue}if(_==="/"){h=g;continue}}_==="["?l++:_==="]"&&l--}const m=c.length===0?o:o.substring(u),p=m.startsWith(mA),v=p?m.substring(1):m,b=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},R$=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},D$=t=>({cache:j$(t.cacheSize),parseClassName:O$(t),...S$(t)}),M$=/\s+/,L$=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(M$);let o="";for(let c=s.length-1;c>=0;c-=1){const l=s[c],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=r(l);let v=!!p,b=n(v?m.substring(0,p):m);if(!b){if(!v){o=l+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=l+(o.length>0?" "+o:o);continue}v=!1}const g=R$(u).join(":"),_=h?g+mA:g,T=_+b;if(a.includes(T))continue;a.push(T);const E=i(b,v);for(let j=0;j<E.length;++j){const R=E[j];a.push(_+R)}o=l+(o.length>0?" "+o:o)}return o};function $$(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=pA(e))&&(n&&(n+=" "),n+=r);return n}const pA=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=pA(t[n]))&&(r&&(r+=" "),r+=e);return r};function V$(t,...e){let r,n,i,a=s;function s(c){const l=e.reduce((u,h)=>h(u),t());return r=D$(l),n=r.cache.get,i=r.cache.set,a=o,o(c)}function o(c){const l=n(c);if(l)return l;const u=L$(c,r);return i(c,u),u}return function(){return a($$.apply(null,arguments))}}const He=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},gA=/^\[(?:([a-z-]+):)?(.+)\]$/i,F$=/^\d+\/\d+$/,z$=new Set(["px","full","screen"]),U$=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,B$=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,q$=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,H$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,W$=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Mn=t=>Ss(t)||z$.has(t)||F$.test(t),mi=t=>Xs(t,"length",eV),Ss=t=>!!t&&!Number.isNaN(Number(t)),gf=t=>Xs(t,"number",Ss),vo=t=>!!t&&Number.isInteger(Number(t)),K$=t=>t.endsWith("%")&&Ss(t.slice(0,-1)),ve=t=>gA.test(t),pi=t=>U$.test(t),G$=new Set(["length","size","percentage"]),Y$=t=>Xs(t,G$,yA),Z$=t=>Xs(t,"position",yA),Q$=new Set(["image","url"]),X$=t=>Xs(t,Q$,rV),J$=t=>Xs(t,"",tV),bo=()=>!0,Xs=(t,e,r)=>{const n=gA.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},eV=t=>B$.test(t)&&!q$.test(t),yA=()=>!1,tV=t=>H$.test(t),rV=t=>W$.test(t),nV=()=>{const t=He("colors"),e=He("spacing"),r=He("blur"),n=He("brightness"),i=He("borderColor"),a=He("borderRadius"),s=He("borderSpacing"),o=He("borderWidth"),c=He("contrast"),l=He("grayscale"),u=He("hueRotate"),h=He("invert"),m=He("gap"),p=He("gradientColorStops"),v=He("gradientColorStopPositions"),b=He("inset"),g=He("margin"),_=He("opacity"),T=He("padding"),E=He("saturate"),j=He("scale"),R=He("sepia"),D=He("skew"),I=He("space"),A=He("translate"),P=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",ve,e],C=()=>[ve,e],k=()=>["",Mn,mi],J=()=>["auto",Ss,ve],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],he=()=>["start","end","center","between","around","evenly","stretch"],ye=()=>["","0",ve],Be=()=>["auto","avoid","all","avoid-page","page","left","right","column"],se=()=>[Ss,ve];return{cacheSize:500,separator:":",theme:{colors:[bo],spacing:[Mn,mi],blur:["none","",pi,ve],brightness:se(),borderColor:[t],borderRadius:["none","","full",pi,ve],borderSpacing:C(),borderWidth:k(),contrast:se(),grayscale:ye(),hueRotate:se(),invert:ye(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[K$,mi],inset:N(),margin:N(),opacity:se(),padding:C(),saturate:se(),scale:se(),sepia:ye(),skew:se(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ve]}],container:["container"],columns:[{columns:[pi]}],"break-after":[{"break-after":Be()}],"break-before":[{"break-before":Be()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),ve]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",vo,ve]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ve]}],grow:[{grow:ye()}],shrink:[{shrink:ye()}],order:[{order:["first","last","none",vo,ve]}],"grid-cols":[{"grid-cols":[bo]}],"col-start-end":[{col:["auto",{span:["full",vo,ve]},ve]}],"col-start":[{"col-start":J()}],"col-end":[{"col-end":J()}],"grid-rows":[{"grid-rows":[bo]}],"row-start-end":[{row:["auto",{span:[vo,ve]},ve]}],"row-start":[{"row-start":J()}],"row-end":[{"row-end":J()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ve]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ve]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...he()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...he(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...he(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ve,e]}],"min-w":[{"min-w":[ve,e,"min","max","fit"]}],"max-w":[{"max-w":[ve,e,"none","full","min","max","fit","prose",{screen:[pi]},pi]}],h:[{h:[ve,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ve,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ve,e,"auto","min","max","fit"]}],"font-size":[{text:["base",pi,mi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gf]}],"font-family":[{font:[bo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ve]}],"line-clamp":[{"line-clamp":["none",Ss,gf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Mn,ve]}],"list-image":[{"list-image":["none",ve]}],"list-style-type":[{list:["none","disc","decimal",ve]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[_]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[_]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Mn,mi]}],"underline-offset":[{"underline-offset":["auto",Mn,ve]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[_]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),Z$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Y$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},X$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[_]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[_]}],"divide-style":[{divide:X()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[Mn,ve]}],"outline-w":[{outline:[Mn,mi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[_]}],"ring-offset-w":[{"ring-offset":[Mn,mi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",pi,J$]}],"shadow-color":[{shadow:[bo]}],opacity:[{opacity:[_]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",pi,ve]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[_]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ve]}],duration:[{duration:se()}],ease:[{ease:["linear","in","out","in-out",ve]}],delay:[{delay:se()}],animate:[{animate:["none","spin","ping","pulse","bounce",ve]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[vo,ve]}],"translate-x":[{"translate-x":[A]}],"translate-y":[{"translate-y":[A]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ve]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Mn,mi,gf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},iV=V$(nV),Tt=null,aV=Object.freeze(Object.defineProperty({__proto__:null,supabase:Tt},Symbol.toStringTag,{value:"Module"}));function Oe(...t){return iV(Le(t))}const Et={auth:"/auth",dashboard:"/",camera:"/camera",settings:"/settings",gardenChat:"/garden-chat",plantDetail:t=>`/plant/${t}`,plantChat:t=>`/plant/${t}/chat`},vt={toDashboard:()=>Et.dashboard,toCamera:()=>Et.camera,toSettings:()=>Et.settings,toGardenChat:()=>Et.gardenChat,toPlantDetail:t=>Et.plantDetail(t),toPlantChat:t=>Et.plantChat(t),toAuth:()=>Et.auth},sV=(t,e)=>t===e?!0:e===Et.dashboard?t==="/"||t.startsWith("/plant/"):e===Et.gardenChat?t===Et.gardenChat||t.includes("/chat")||t.includes("/garden-chat"):e===Et.settings?t.startsWith("/settings"):!1;let Sl;const oV=new Uint8Array(16);function cV(){if(!Sl&&(Sl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Sl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sl(oV)}const Lt=[];for(let t=0;t<256;++t)Lt.push((t+256).toString(16).slice(1));function lV(t,e=0){return Lt[t[e+0]]+Lt[t[e+1]]+Lt[t[e+2]]+Lt[t[e+3]]+"-"+Lt[t[e+4]]+Lt[t[e+5]]+"-"+Lt[t[e+6]]+Lt[t[e+7]]+"-"+Lt[t[e+8]]+Lt[t[e+9]]+"-"+Lt[t[e+10]]+Lt[t[e+11]]+Lt[t[e+12]]+Lt[t[e+13]]+Lt[t[e+14]]+Lt[t[e+15]]}const uV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xb={randomUUID:uV};function dV(t,e,r){if(Xb.randomUUID&&!t)return Xb.randomUUID();t=t||{};const n=t.random||(t.rng||cV)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,lV(n)}const vA=5,hV=vA*1024*1024,bA=t=>{if(!t||typeof t!="string")throw new Error("URL de imagen inválida");const e=t.split(",")[1];if(!e)throw new Error("Formato de imagen inválido");const r=e.length*3/4;if(r>hV){const n=(r/1048576).toFixed(1);throw new Error(`La imagen es demasiado grande (${n}MB). El límite máximo es ${vA}MB. Por favor, usa una imagen más pequeña.`)}console.log(`[imageService] Image size validation passed: ${(r/(1024*1024)).toFixed(2)}MB`)},fV=t=>{if(!t||typeof t!="string")throw new Error("Invalid data URL: input is not a string");if(!t.startsWith("data:"))throw new Error('Invalid data URL: does not start with "data:"');const e=t.split(",");if(e.length!==2)throw new Error("Invalid data URL: incorrect format");const r=e[0].match(/:(.*?);/);if(!r)throw new Error("Invalid data URL: could not extract MIME type");const n=r[1];if(!n.startsWith("image/"))throw new Error(`Invalid data URL: not an image MIME type (${n})`);try{const i=atob(e[1]);let a=i.length;const s=new Uint8Array(a);for(;a--;)s[a]=i.charCodeAt(a);return new Blob([s],{type:n})}catch(i){throw new Error(`Invalid data URL: failed to decode base64 data - ${i instanceof Error?i.message:"Unknown error"}`)}},xA=async(t,e,r)=>{try{bA(t);const n=fV(t),i=n.type.split("/")[1],a=`${r}/${dV()}.${i}`,{error:s}=await Tt.storage.from(e).upload(a,n,{cacheControl:"3600",upsert:!1});if(s)throw console.error("Error uploading image to Supabase Storage:",s),new Error(`Storage error: ${s.message}`);const{data:o}=Tt.storage.from(e).getPublicUrl(a);if(!o||!o.publicUrl)throw new Error("Could not get public URL for uploaded image.");return o.publicUrl}catch(n){throw console.error("Failed to upload image:",n),n instanceof Error?new Error(`Image upload failed: ${n.message}`):new Error("An unknown error occurred during image upload.")}};function z(t,e,r){function n(o,c){var l;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(l=o._zod).traits??(l.traits=new Set),o._zod.traits.add(t),e(o,c);for(const u in s.prototype)u in o||Object.defineProperty(o,u,{value:s.prototype[u].bind(o)});o._zod.constr=s,o._zod.def=c}const i=r?.Parent??Object;class a extends i{}Object.defineProperty(a,"name",{value:t});function s(o){var c;const l=r?.Parent?new a:this;n(l,o),(c=l._zod).deferred??(c.deferred=[]);for(const u of l._zod.deferred)u();return l}return Object.defineProperty(s,"init",{value:n}),Object.defineProperty(s,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(t)}),Object.defineProperty(s,"name",{value:t}),s}class dc extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const wA={};function $a(t){return wA}function mV(t){const e=Object.values(t).filter(n=>typeof n=="number");return Object.entries(t).filter(([n,i])=>e.indexOf(+n)===-1).map(([n,i])=>i)}function pV(t,e){return typeof e=="bigint"?e.toString():e}function _A(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Tg(t){return t==null}function Ag(t){const e=t.startsWith("^")?1:0,r=t.endsWith("$")?t.length-1:t.length;return t.slice(e,r)}function gV(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=r>n?r:n,a=Number.parseInt(t.toFixed(i).replace(".","")),s=Number.parseInt(e.toFixed(i).replace(".",""));return a%s/10**i}function Ye(t,e,r){Object.defineProperty(t,e,{get(){{const n=r();return t[e]=n,n}},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function Ig(t,e,r){Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0})}function xo(t){return JSON.stringify(t)}const EA=Error.captureStackTrace?Error.captureStackTrace:(...t)=>{};function Cm(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const yV=_A(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function km(t){if(Cm(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(Cm(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}const vV=new Set(["string","number","symbol"]);function qd(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Qa(t,e,r){const n=new t._zod.constr(e??t._zod.def);return(!e||r?.parent)&&(n._zod.parent=t),n}function ie(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function bV(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const xV={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function wV(t,e){const r={},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Qa(t,{...t._zod.def,shape:r,checks:[]})}function _V(t,e){const r={...t._zod.def.shape},n=t._zod.def;for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Qa(t,{...t._zod.def,shape:r,checks:[]})}function EV(t,e){if(!km(e))throw new Error("Invalid input to extend: expected a plain object");const r={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return Ig(this,"shape",n),n},checks:[]};return Qa(t,r)}function TV(t,e){return Qa(t,{...t._zod.def,get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return Ig(this,"shape",r),r},catchall:e._zod.def.catchall,checks:[]})}function AV(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in n))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=t?new t({type:"optional",innerType:n[a]}):n[a])}else for(const a in n)i[a]=t?new t({type:"optional",innerType:n[a]}):n[a];return Qa(e,{...e._zod.def,shape:i,checks:[]})}function IV(t,e,r){const n=e._zod.def.shape,i={...n};if(r)for(const a in r){if(!(a in i))throw new Error(`Unrecognized key: "${a}"`);r[a]&&(i[a]=new t({type:"nonoptional",innerType:n[a]}))}else for(const a in n)i[a]=new t({type:"nonoptional",innerType:n[a]});return Qa(e,{...e._zod.def,shape:i,checks:[]})}function Go(t,e=0){for(let r=e;r<t.issues.length;r++)if(t.issues[r]?.continue!==!0)return!0;return!1}function Sg(t,e){return e.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(t),r})}function Pl(t){return typeof t=="string"?t:t?.message}function Va(t,e,r){const n={...t,path:t.path??[]};if(!t.message){const i=Pl(t.inst?._zod.def?.error?.(t))??Pl(e?.error?.(t))??Pl(r.customError?.(t))??Pl(r.localeError?.(t))??"Invalid input";n.message=i}return delete n.inst,delete n.continue,e?.reportInput||delete n.input,n}function Pg(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function hc(...t){const[e,r,n]=t;return typeof e=="string"?{message:e,code:"custom",input:r,inst:n}:{...e}}const TA=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),Object.defineProperty(t,"message",{get(){return JSON.stringify(e,pV,2)},enumerable:!0}),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},AA=z("$ZodError",TA),IA=z("$ZodError",TA,{Parent:Error});function SV(t,e=r=>r.message){const r={},n=[];for(const i of t.issues)i.path.length>0?(r[i.path[0]]=r[i.path[0]]||[],r[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:r}}function PV(t,e){const r=e||function(a){return a.message},n={_errors:[]},i=a=>{for(const s of a.issues)if(s.code==="invalid_union"&&s.errors.length)s.errors.map(o=>i({issues:o}));else if(s.code==="invalid_key")i({issues:s.issues});else if(s.code==="invalid_element")i({issues:s.issues});else if(s.path.length===0)n._errors.push(r(s));else{let o=n,c=0;for(;c<s.path.length;){const l=s.path[c];c===s.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(r(s))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return i(t),n}const CV=t=>(e,r,n,i)=>{const a=n?Object.assign(n,{async:!1}):{async:!1},s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise)throw new dc;if(s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>Va(c,a,$a())));throw EA(o,i?.callee),o}return s.value},kV=t=>async(e,r,n,i)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let s=e._zod.run({value:r,issues:[]},a);if(s instanceof Promise&&(s=await s),s.issues.length){const o=new(i?.Err??t)(s.issues.map(c=>Va(c,a,$a())));throw EA(o,i?.callee),o}return s.value},SA=t=>(e,r,n)=>{const i=n?{...n,async:!1}:{async:!1},a=e._zod.run({value:r,issues:[]},i);if(a instanceof Promise)throw new dc;return a.issues.length?{success:!1,error:new(t??AA)(a.issues.map(s=>Va(s,i,$a())))}:{success:!0,data:a.value}},NV=SA(IA),PA=t=>async(e,r,n)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let a=e._zod.run({value:r,issues:[]},i);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new t(a.issues.map(s=>Va(s,i,$a())))}:{success:!0,data:a.value}},jV=PA(IA),OV=/^[cC][^\s-]{8,}$/,RV=/^[0-9a-z]+$/,DV=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,MV=/^[0-9a-vA-V]{20}$/,LV=/^[A-Za-z0-9]{27}$/,$V=/^[a-zA-Z0-9_-]{21}$/,VV=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,FV=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Jb=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,zV=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,UV="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function BV(){return new RegExp(UV,"u")}const qV=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,HV=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,WV=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,KV=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,GV=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,CA=/^[A-Za-z0-9_-]*$/,YV=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,ZV=/^\+(?:[0-9]){6,14}[0-9]$/,kA="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",QV=new RegExp(`^${kA}$`);function NA(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function XV(t){return new RegExp(`^${NA(t)}$`)}function JV(t){const e=NA({precision:t.precision}),r=["Z"];t.local&&r.push(""),t.offset&&r.push("([+-]\\d{2}:\\d{2})");const n=`${e}(?:${r.join("|")})`;return new RegExp(`^${kA}T(?:${n})$`)}const e5=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},t5=/^\d+$/,r5=/^-?\d+(?:\.\d+)?/i,n5=/true|false/i,i5=/^[^A-Z]*$/,a5=/^[^a-z]*$/,hr=z("$ZodCheck",(t,e)=>{var r;t._zod??(t._zod={}),t._zod.def=e,(r=t._zod).onattach??(r.onattach=[])}),jA={number:"number",bigint:"bigint",object:"date"},OA=z("$ZodCheckLessThan",(t,e)=>{hr.init(t,e);const r=jA[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.maximum:i.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?i.maximum=e.value:i.exclusiveMaximum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value<=e.value:n.value<e.value)||n.issues.push({origin:r,code:"too_big",maximum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),RA=z("$ZodCheckGreaterThan",(t,e)=>{hr.init(t,e);const r=jA[typeof e.value];t._zod.onattach.push(n=>{const i=n._zod.bag,a=(e.inclusive?i.minimum:i.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?i.minimum=e.value:i.exclusiveMinimum=e.value)}),t._zod.check=n=>{(e.inclusive?n.value>=e.value:n.value>e.value)||n.issues.push({origin:r,code:"too_small",minimum:e.value,input:n.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),s5=z("$ZodCheckMultipleOf",(t,e)=>{hr.init(t,e),t._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=e.value)}),t._zod.check=r=>{if(typeof r.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%e.value===BigInt(0):gV(r.value,e.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:e.value,input:r.value,inst:t,continue:!e.abort})}}),o5=z("$ZodCheckNumberFormat",(t,e)=>{hr.init(t,e),e.format=e.format||"float64";const r=e.format?.includes("int"),n=r?"int":"number",[i,a]=xV[e.format];t._zod.onattach.push(s=>{const o=s._zod.bag;o.format=e.format,o.minimum=i,o.maximum=a,r&&(o.pattern=t5)}),t._zod.check=s=>{const o=s.value;if(r){if(!Number.isInteger(o)){s.issues.push({expected:n,format:e.format,code:"invalid_type",input:o,inst:t});return}if(!Number.isSafeInteger(o)){o>0?s.issues.push({input:o,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort}):s.issues.push({input:o,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:n,continue:!e.abort});return}}o<i&&s.issues.push({origin:"number",input:o,code:"too_small",minimum:i,inclusive:!0,inst:t,continue:!e.abort}),o>a&&s.issues.push({origin:"number",input:o,code:"too_big",maximum:a,inst:t})}}),c5=z("$ZodCheckMaxLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<i&&(n._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const i=n.value;if(i.length<=e.maximum)return;const s=Pg(i);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),l5=z("$ZodCheckMinLength",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>i&&(n._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const i=n.value;if(i.length>=e.minimum)return;const s=Pg(i);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:i,inst:t,continue:!e.abort})}}),u5=z("$ZodCheckLengthEquals",(t,e)=>{var r;hr.init(t,e),(r=t._zod.def).when??(r.when=n=>{const i=n.value;return!Tg(i)&&i.length!==void 0}),t._zod.onattach.push(n=>{const i=n._zod.bag;i.minimum=e.length,i.maximum=e.length,i.length=e.length}),t._zod.check=n=>{const i=n.value,a=i.length;if(a===e.length)return;const s=Pg(i),o=a>e.length;n.issues.push({origin:s,...o?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Hd=z("$ZodCheckStringFormat",(t,e)=>{var r,n;hr.init(t,e),t._zod.onattach.push(i=>{const a=i._zod.bag;a.format=e.format,e.pattern&&(a.patterns??(a.patterns=new Set),a.patterns.add(e.pattern))}),e.pattern?(r=t._zod).check??(r.check=i=>{e.pattern.lastIndex=0,!e.pattern.test(i.value)&&i.issues.push({origin:"string",code:"invalid_format",format:e.format,input:i.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(n=t._zod).check??(n.check=()=>{})}),d5=z("$ZodCheckRegex",(t,e)=>{Hd.init(t,e),t._zod.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),h5=z("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=i5),Hd.init(t,e)}),f5=z("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=a5),Hd.init(t,e)}),m5=z("$ZodCheckIncludes",(t,e)=>{hr.init(t,e);const r=qd(e.includes),n=new RegExp(typeof e.position=="number"?`^.{${e.position}}${r}`:r);e.pattern=n,t._zod.onattach.push(i=>{const a=i._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(n)}),t._zod.check=i=>{i.value.includes(e.includes,e.position)||i.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:i.value,inst:t,continue:!e.abort})}}),p5=z("$ZodCheckStartsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`^${qd(e.prefix)}.*`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),g5=z("$ZodCheckEndsWith",(t,e)=>{hr.init(t,e);const r=new RegExp(`.*${qd(e.suffix)}$`);e.pattern??(e.pattern=r),t._zod.onattach.push(n=>{const i=n._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),y5=z("$ZodCheckOverwrite",(t,e)=>{hr.init(t,e),t._zod.check=r=>{r.value=e.tx(r.value)}});class v5{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const n=e.split(`
`).filter(s=>s),i=Math.min(...n.map(s=>s.length-s.trimStart().length)),a=n.map(s=>s.slice(i)).map(s=>" ".repeat(this.indent*2)+s);for(const s of a)this.content.push(s)}compile(){const e=Function,r=this?.args,i=[...(this?.content??[""]).map(a=>`  ${a}`)];return new e(...r,i.join(`
`))}}const b5={major:4,minor:0,patch:5},Je=z("$ZodType",(t,e)=>{var r;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=b5;const n=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&n.unshift(t);for(const i of n)for(const a of i._zod.onattach)a(t);if(n.length===0)(r=t._zod).deferred??(r.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const i=(a,s,o)=>{let c=Go(a),l;for(const u of s){if(u._zod.def.when){if(!u._zod.def.when(a))continue}else if(c)continue;const h=a.issues.length,m=u._zod.check(a);if(m instanceof Promise&&o?.async===!1)throw new dc;if(l||m instanceof Promise)l=(l??Promise.resolve()).then(async()=>{await m,a.issues.length!==h&&(c||(c=Go(a,h)))});else{if(a.issues.length===h)continue;c||(c=Go(a,h))}}return l?l.then(()=>a):a};t._zod.run=(a,s)=>{const o=t._zod.parse(a,s);if(o instanceof Promise){if(s.async===!1)throw new dc;return o.then(c=>i(c,n,s))}return i(o,n,s)}}t["~standard"]={validate:i=>{try{const a=NV(t,i);return a.success?{value:a.data}:{issues:a.error?.issues}}catch{return jV(t,i).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}}),Cg=z("$ZodString",(t,e)=>{Je.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??e5(t._zod.bag),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Qe=z("$ZodStringFormat",(t,e)=>{Hd.init(t,e),Cg.init(t,e)}),x5=z("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=FV),Qe.init(t,e)}),w5=z("$ZodUUID",(t,e)=>{if(e.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(n===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Jb(n))}else e.pattern??(e.pattern=Jb());Qe.init(t,e)}),_5=z("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=zV),Qe.init(t,e)}),E5=z("$ZodURL",(t,e)=>{Qe.init(t,e),t._zod.check=r=>{try{const n=r.value,i=new URL(n),a=i.href;e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(i.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:YV.source,input:r.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(i.protocol.endsWith(":")?i.protocol.slice(0,-1):i.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:r.value,inst:t,continue:!e.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:t,continue:!e.abort})}}}),T5=z("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=BV()),Qe.init(t,e)}),A5=z("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=$V),Qe.init(t,e)}),I5=z("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=OV),Qe.init(t,e)}),S5=z("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=RV),Qe.init(t,e)}),P5=z("$ZodULID",(t,e)=>{e.pattern??(e.pattern=DV),Qe.init(t,e)}),C5=z("$ZodXID",(t,e)=>{e.pattern??(e.pattern=MV),Qe.init(t,e)}),k5=z("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=LV),Qe.init(t,e)}),N5=z("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=JV(e)),Qe.init(t,e)}),j5=z("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=QV),Qe.init(t,e)}),O5=z("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=XV(e)),Qe.init(t,e)}),R5=z("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=VV),Qe.init(t,e)}),D5=z("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=qV),Qe.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),M5=z("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=HV),Qe.init(t,e),t._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),t._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:t,continue:!e.abort})}}}),L5=z("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=WV),Qe.init(t,e)}),$5=z("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=KV),Qe.init(t,e),t._zod.check=r=>{const[n,i]=r.value.split("/");try{if(!i)throw new Error;const a=Number(i);if(`${a}`!==i)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:t,continue:!e.abort})}}});function DA(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const V5=z("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=GV),Qe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),t._zod.check=r=>{DA(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:t,continue:!e.abort})}});function F5(t){if(!CA.test(t))return!1;const e=t.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=e.padEnd(Math.ceil(e.length/4)*4,"=");return DA(r)}const z5=z("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=CA),Qe.init(t,e),t._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),t._zod.check=r=>{F5(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:t,continue:!e.abort})}}),U5=z("$ZodE164",(t,e)=>{e.pattern??(e.pattern=ZV),Qe.init(t,e)});function B5(t,e=null){try{const r=t.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const i=JSON.parse(atob(n));return!("typ"in i&&i?.typ!=="JWT"||!i.alg||e&&(!("alg"in i)||i.alg!==e))}catch{return!1}}const q5=z("$ZodJWT",(t,e)=>{Qe.init(t,e),t._zod.check=r=>{B5(r.value,e.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:t,continue:!e.abort})}}),MA=z("$ZodNumber",(t,e)=>{Je.init(t,e),t._zod.pattern=t._zod.bag.pattern??r5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=Number(r.value)}catch{}const i=r.value;if(typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i))return r;const a=typeof i=="number"?Number.isNaN(i)?"NaN":Number.isFinite(i)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:i,inst:t,...a?{received:a}:{}}),r}}),H5=z("$ZodNumber",(t,e)=>{o5.init(t,e),MA.init(t,e)}),W5=z("$ZodBoolean",(t,e)=>{Je.init(t,e),t._zod.pattern=n5,t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=!!r.value}catch{}const i=r.value;return typeof i=="boolean"||r.issues.push({expected:"boolean",code:"invalid_type",input:i,inst:t}),r}}),K5=z("$ZodUnknown",(t,e)=>{Je.init(t,e),t._zod.parse=r=>r}),G5=z("$ZodNever",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:t}),r)}),Y5=z("$ZodDate",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{if(e.coerce)try{r.value=new Date(r.value)}catch{}const i=r.value,a=i instanceof Date;return a&&!Number.isNaN(i.getTime())||r.issues.push({expected:"date",code:"invalid_type",input:i,...a?{received:"Invalid Date"}:{},inst:t}),r}});function ex(t,e,r){t.issues.length&&e.issues.push(...Sg(r,t.issues)),e.value[r]=t.value}const Z5=z("$ZodArray",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({expected:"array",code:"invalid_type",input:i,inst:t}),r;r.value=Array(i.length);const a=[];for(let s=0;s<i.length;s++){const o=i[s],c=e.element._zod.run({value:o,issues:[]},n);c instanceof Promise?a.push(c.then(l=>ex(l,r,s))):ex(c,r,s)}return a.length?Promise.all(a).then(()=>r):r}});function Cl(t,e,r){t.issues.length&&e.issues.push(...Sg(r,t.issues)),e.value[r]=t.value}function tx(t,e,r,n){t.issues.length?n[r]===void 0?r in n?e.value[r]=void 0:e.value[r]=t.value:e.issues.push(...Sg(r,t.issues)):t.value===void 0?r in n&&(e.value[r]=void 0):e.value[r]=t.value}const Q5=z("$ZodObject",(t,e)=>{Je.init(t,e);const r=_A(()=>{const h=Object.keys(e.shape);for(const p of h)if(!(e.shape[p]instanceof Je))throw new Error(`Invalid element at key "${p}": expected a Zod schema`);const m=bV(e.shape);return{shape:e.shape,keys:h,keySet:new Set(h),numKeys:h.length,optionalKeys:new Set(m)}});Ye(t._zod,"propValues",()=>{const h=e.shape,m={};for(const p in h){const v=h[p]._zod;if(v.values){m[p]??(m[p]=new Set);for(const b of v.values)m[p].add(b)}}return m});const n=h=>{const m=new v5(["shape","payload","ctx"]),p=r.value,v=T=>{const E=xo(T);return`shape[${E}]._zod.run({ value: input[${E}], issues: [] }, ctx)`};m.write("const input = payload.value;");const b=Object.create(null);let g=0;for(const T of p.keys)b[T]=`key_${g++}`;m.write("const newResult = {}");for(const T of p.keys)if(p.optionalKeys.has(T)){const E=b[T];m.write(`const ${E} = ${v(T)};`);const j=xo(T);m.write(`
        if (${E}.issues.length) {
          if (input[${j}] === undefined) {
            if (${j} in input) {
              newResult[${j}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${E}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${j}, ...iss.path] : [${j}],
              }))
            );
          }
        } else if (${E}.value === undefined) {
          if (${j} in input) newResult[${j}] = undefined;
        } else {
          newResult[${j}] = ${E}.value;
        }
        `)}else{const E=b[T];m.write(`const ${E} = ${v(T)};`),m.write(`
          if (${E}.issues.length) payload.issues = payload.issues.concat(${E}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${xo(T)}, ...iss.path] : [${xo(T)}]
          })));`),m.write(`newResult[${xo(T)}] = ${E}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const _=m.compile();return(T,E)=>_(h,T,E)};let i;const a=Cm,s=!wA.jitless,c=s&&yV.value,l=e.catchall;let u;t._zod.parse=(h,m)=>{u??(u=r.value);const p=h.value;if(!a(p))return h.issues.push({expected:"object",code:"invalid_type",input:p,inst:t}),h;const v=[];if(s&&c&&m?.async===!1&&m.jitless!==!0)i||(i=n(e.shape)),h=i(h,m);else{h.value={};const E=u.shape;for(const j of u.keys){const R=E[j],D=R._zod.run({value:p[j],issues:[]},m),I=R._zod.optin==="optional"&&R._zod.optout==="optional";D instanceof Promise?v.push(D.then(A=>I?tx(A,h,j,p):Cl(A,h,j))):I?tx(D,h,j,p):Cl(D,h,j)}}if(!l)return v.length?Promise.all(v).then(()=>h):h;const b=[],g=u.keySet,_=l._zod,T=_.def.type;for(const E of Object.keys(p)){if(g.has(E))continue;if(T==="never"){b.push(E);continue}const j=_.run({value:p[E],issues:[]},m);j instanceof Promise?v.push(j.then(R=>Cl(R,h,E))):Cl(j,h,E)}return b.length&&h.issues.push({code:"unrecognized_keys",keys:b,input:p,inst:t}),v.length?Promise.all(v).then(()=>h):h}});function rx(t,e,r,n){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:r,errors:t.map(i=>i.issues.map(a=>Va(a,n,$a())))}),e}const X5=z("$ZodUnion",(t,e)=>{Je.init(t,e),Ye(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),Ye(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),Ye(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),Ye(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(n=>n._zod.pattern);return new RegExp(`^(${r.map(n=>Ag(n.source)).join("|")})$`)}}),t._zod.parse=(r,n)=>{let i=!1;const a=[];for(const s of e.options){const o=s._zod.run({value:r.value,issues:[]},n);if(o instanceof Promise)a.push(o),i=!0;else{if(o.issues.length===0)return o;a.push(o)}}return i?Promise.all(a).then(s=>rx(s,r,t,n)):rx(a,r,t,n)}}),J5=z("$ZodIntersection",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=r.value,a=e.left._zod.run({value:i,issues:[]},n),s=e.right._zod.run({value:i,issues:[]},n);return a instanceof Promise||s instanceof Promise?Promise.all([a,s]).then(([c,l])=>nx(r,c,l)):nx(r,a,s)}});function Nm(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(km(t)&&km(e)){const r=Object.keys(e),n=Object.keys(t).filter(a=>r.indexOf(a)!==-1),i={...t,...e};for(const a of n){const s=Nm(t[a],e[a]);if(!s.valid)return{valid:!1,mergeErrorPath:[a,...s.mergeErrorPath]};i[a]=s.data}return{valid:!0,data:i}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<t.length;n++){const i=t[n],a=e[n],s=Nm(i,a);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};r.push(s.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function nx(t,e,r){if(e.issues.length&&t.issues.push(...e.issues),r.issues.length&&t.issues.push(...r.issues),Go(t))return t;const n=Nm(e.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return t.value=n.data,t}const eF=z("$ZodEnum",(t,e)=>{Je.init(t,e);const r=mV(e.entries);t._zod.values=new Set(r),t._zod.pattern=new RegExp(`^(${r.filter(n=>vV.has(typeof n)).map(n=>typeof n=="string"?qd(n):n.toString()).join("|")})$`),t._zod.parse=(n,i)=>{const a=n.value;return t._zod.values.has(a)||n.issues.push({code:"invalid_value",values:r,input:a,inst:t}),n}}),tF=z("$ZodTransform",(t,e)=>{Je.init(t,e),t._zod.parse=(r,n)=>{const i=e.transform(r.value,r);if(n.async)return(i instanceof Promise?i:Promise.resolve(i)).then(s=>(r.value=s,r));if(i instanceof Promise)throw new dc;return r.value=i,r}}),rF=z("$ZodOptional",(t,e)=>{Je.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ye(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ye(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${Ag(r.source)})?$`):void 0}),t._zod.parse=(r,n)=>e.innerType._zod.optin==="optional"?e.innerType._zod.run(r,n):r.value===void 0?r:e.innerType._zod.run(r,n)}),nF=z("$ZodNullable",(t,e)=>{Je.init(t,e),Ye(t._zod,"optin",()=>e.innerType._zod.optin),Ye(t._zod,"optout",()=>e.innerType._zod.optout),Ye(t._zod,"pattern",()=>{const r=e.innerType._zod.pattern;return r?new RegExp(`^(${Ag(r.source)}|null)$`):void 0}),Ye(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(r,n)=>r.value===null?r:e.innerType._zod.run(r,n)}),iF=z("$ZodDefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ye(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{if(r.value===void 0)return r.value=e.defaultValue,r;const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>ix(a,e)):ix(i,e)}});function ix(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const aF=z("$ZodPrefault",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ye(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>(r.value===void 0&&(r.value=e.defaultValue),e.innerType._zod.run(r,n))}),sF=z("$ZodNonOptional",(t,e)=>{Je.init(t,e),Ye(t._zod,"values",()=>{const r=e.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>ax(a,t)):ax(i,t)}});function ax(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const oF=z("$ZodCatch",(t,e)=>{Je.init(t,e),t._zod.optin="optional",Ye(t._zod,"optout",()=>e.innerType._zod.optout),Ye(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(a=>(r.value=a.value,a.issues.length&&(r.value=e.catchValue({...r,error:{issues:a.issues.map(s=>Va(s,n,$a()))},input:r.value}),r.issues=[]),r)):(r.value=i.value,i.issues.length&&(r.value=e.catchValue({...r,error:{issues:i.issues.map(a=>Va(a,n,$a()))},input:r.value}),r.issues=[]),r)}}),cF=z("$ZodPipe",(t,e)=>{Je.init(t,e),Ye(t._zod,"values",()=>e.in._zod.values),Ye(t._zod,"optin",()=>e.in._zod.optin),Ye(t._zod,"optout",()=>e.out._zod.optout),Ye(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(r,n)=>{const i=e.in._zod.run(r,n);return i instanceof Promise?i.then(a=>sx(a,e,n)):sx(i,e,n)}});function sx(t,e,r){return Go(t)?t:e.out._zod.run({value:t.value,issues:t.issues},r)}const lF=z("$ZodReadonly",(t,e)=>{Je.init(t,e),Ye(t._zod,"propValues",()=>e.innerType._zod.propValues),Ye(t._zod,"values",()=>e.innerType._zod.values),Ye(t._zod,"optin",()=>e.innerType._zod.optin),Ye(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(r,n)=>{const i=e.innerType._zod.run(r,n);return i instanceof Promise?i.then(ox):ox(i)}});function ox(t){return t.value=Object.freeze(t.value),t}const uF=z("$ZodCustom",(t,e)=>{hr.init(t,e),Je.init(t,e),t._zod.parse=(r,n)=>r,t._zod.check=r=>{const n=r.value,i=e.fn(n);if(i instanceof Promise)return i.then(a=>cx(a,r,n,t));cx(i,r,n,t)}});function cx(t,e,r,n){if(!t){const i={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(i.params=n._zod.def.params),e.issues.push(hc(i))}}class dF{constructor(){this._map=new Map,this._idmap=new Map}add(e,...r){const n=r[0];if(this._map.set(e,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const r=this._map.get(e);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(e),this}get(e){const r=e._zod.parent;if(r){const n={...this.get(r)??{}};return delete n.id,{...n,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function hF(){return new dF}const kl=hF();function fF(t,e){return new t({type:"string",...ie(e)})}function mF(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...ie(e)})}function lx(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...ie(e)})}function pF(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...ie(e)})}function gF(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ie(e)})}function yF(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ie(e)})}function vF(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ie(e)})}function bF(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...ie(e)})}function xF(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...ie(e)})}function wF(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...ie(e)})}function _F(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...ie(e)})}function EF(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...ie(e)})}function TF(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...ie(e)})}function AF(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...ie(e)})}function IF(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...ie(e)})}function SF(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...ie(e)})}function PF(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...ie(e)})}function CF(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ie(e)})}function kF(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ie(e)})}function NF(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...ie(e)})}function jF(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...ie(e)})}function OF(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...ie(e)})}function RF(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...ie(e)})}function DF(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ie(e)})}function MF(t,e){return new t({type:"string",format:"date",check:"string_format",...ie(e)})}function LF(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...ie(e)})}function $F(t,e){return new t({type:"string",format:"duration",check:"string_format",...ie(e)})}function VF(t,e){return new t({type:"number",checks:[],...ie(e)})}function FF(t,e){return new t({type:"number",coerce:!0,checks:[],...ie(e)})}function zF(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...ie(e)})}function UF(t,e){return new t({type:"boolean",...ie(e)})}function BF(t){return new t({type:"unknown"})}function qF(t,e){return new t({type:"never",...ie(e)})}function HF(t,e){return new t({type:"date",...ie(e)})}function ux(t,e){return new OA({check:"less_than",...ie(e),value:t,inclusive:!1})}function iu(t,e){return new OA({check:"less_than",...ie(e),value:t,inclusive:!0})}function dx(t,e){return new RA({check:"greater_than",...ie(e),value:t,inclusive:!1})}function au(t,e){return new RA({check:"greater_than",...ie(e),value:t,inclusive:!0})}function hx(t,e){return new s5({check:"multiple_of",...ie(e),value:t})}function LA(t,e){return new c5({check:"max_length",...ie(e),maximum:t})}function Ru(t,e){return new l5({check:"min_length",...ie(e),minimum:t})}function $A(t,e){return new u5({check:"length_equals",...ie(e),length:t})}function WF(t,e){return new d5({check:"string_format",format:"regex",...ie(e),pattern:t})}function KF(t){return new h5({check:"string_format",format:"lowercase",...ie(t)})}function GF(t){return new f5({check:"string_format",format:"uppercase",...ie(t)})}function YF(t,e){return new m5({check:"string_format",format:"includes",...ie(e),includes:t})}function ZF(t,e){return new p5({check:"string_format",format:"starts_with",...ie(e),prefix:t})}function QF(t,e){return new g5({check:"string_format",format:"ends_with",...ie(e),suffix:t})}function Mc(t){return new y5({check:"overwrite",tx:t})}function XF(t){return Mc(e=>e.normalize(t))}function JF(){return Mc(t=>t.trim())}function e3(){return Mc(t=>t.toLowerCase())}function t3(){return Mc(t=>t.toUpperCase())}function r3(t,e,r){return new t({type:"array",element:e,...ie(r)})}function n3(t,e,r){return new t({type:"custom",check:"custom",fn:e,...ie(r)})}const i3=z("ZodISODateTime",(t,e)=>{N5.init(t,e),et.init(t,e)});function a3(t){return DF(i3,t)}const s3=z("ZodISODate",(t,e)=>{j5.init(t,e),et.init(t,e)});function o3(t){return MF(s3,t)}const c3=z("ZodISOTime",(t,e)=>{O5.init(t,e),et.init(t,e)});function l3(t){return LF(c3,t)}const u3=z("ZodISODuration",(t,e)=>{R5.init(t,e),et.init(t,e)});function d3(t){return $F(u3,t)}const VA=(t,e)=>{AA.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:r=>PV(t,r)},flatten:{value:r=>SV(t,r)},addIssue:{value:r=>t.issues.push(r)},addIssues:{value:r=>t.issues.push(...r)},isEmpty:{get(){return t.issues.length===0}}})},h3=z("ZodError",VA),Wd=z("ZodError",VA,{Parent:Error}),f3=CV(Wd),m3=kV(Wd),p3=SA(Wd),g3=PA(Wd),ut=z("ZodType",(t,e)=>(Je.init(t,e),t.def=e,Object.defineProperty(t,"_def",{value:e}),t.check=(...r)=>t.clone({...e,checks:[...e.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]}),t.clone=(r,n)=>Qa(t,r,n),t.brand=()=>t,t.register=(r,n)=>(r.add(t,n),t),t.parse=(r,n)=>f3(t,r,n,{callee:t.parse}),t.safeParse=(r,n)=>p3(t,r,n),t.parseAsync=async(r,n)=>m3(t,r,n,{callee:t.parseAsync}),t.safeParseAsync=async(r,n)=>g3(t,r,n),t.spa=t.safeParseAsync,t.refine=(r,n)=>t.check(c6(r,n)),t.superRefine=r=>t.check(l6(r)),t.overwrite=r=>t.check(Mc(r)),t.optional=()=>gx(t),t.nullable=()=>yx(t),t.nullish=()=>gx(yx(t)),t.nonoptional=r=>e6(t,r),t.array=()=>_e(t),t.or=r=>q3([t,r]),t.and=r=>W3(t,r),t.transform=r=>vx(t,G3(r)),t.default=r=>Q3(t,r),t.prefault=r=>J3(t,r),t.catch=r=>r6(t,r),t.pipe=r=>vx(t,r),t.readonly=()=>a6(t),t.describe=r=>{const n=t.clone();return kl.add(n,{description:r}),n},Object.defineProperty(t,"description",{get(){return kl.get(t)?.description},configurable:!0}),t.meta=(...r)=>{if(r.length===0)return kl.get(t);const n=t.clone();return kl.add(n,r[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),FA=z("_ZodString",(t,e)=>{Cg.init(t,e),ut.init(t,e);const r=t._zod.bag;t.format=r.format??null,t.minLength=r.minimum??null,t.maxLength=r.maximum??null,t.regex=(...n)=>t.check(WF(...n)),t.includes=(...n)=>t.check(YF(...n)),t.startsWith=(...n)=>t.check(ZF(...n)),t.endsWith=(...n)=>t.check(QF(...n)),t.min=(...n)=>t.check(Ru(...n)),t.max=(...n)=>t.check(LA(...n)),t.length=(...n)=>t.check($A(...n)),t.nonempty=(...n)=>t.check(Ru(1,...n)),t.lowercase=n=>t.check(KF(n)),t.uppercase=n=>t.check(GF(n)),t.trim=()=>t.check(JF()),t.normalize=(...n)=>t.check(XF(...n)),t.toLowerCase=()=>t.check(e3()),t.toUpperCase=()=>t.check(t3())}),y3=z("ZodString",(t,e)=>{Cg.init(t,e),FA.init(t,e),t.email=r=>t.check(mF(v3,r)),t.url=r=>t.check(bF(b3,r)),t.jwt=r=>t.check(RF(R3,r)),t.emoji=r=>t.check(xF(x3,r)),t.guid=r=>t.check(lx(fx,r)),t.uuid=r=>t.check(pF(Nl,r)),t.uuidv4=r=>t.check(gF(Nl,r)),t.uuidv6=r=>t.check(yF(Nl,r)),t.uuidv7=r=>t.check(vF(Nl,r)),t.nanoid=r=>t.check(wF(w3,r)),t.guid=r=>t.check(lx(fx,r)),t.cuid=r=>t.check(_F(_3,r)),t.cuid2=r=>t.check(EF(E3,r)),t.ulid=r=>t.check(TF(T3,r)),t.base64=r=>t.check(NF(N3,r)),t.base64url=r=>t.check(jF(j3,r)),t.xid=r=>t.check(AF(A3,r)),t.ksuid=r=>t.check(IF(I3,r)),t.ipv4=r=>t.check(SF(S3,r)),t.ipv6=r=>t.check(PF(P3,r)),t.cidrv4=r=>t.check(CF(C3,r)),t.cidrv6=r=>t.check(kF(k3,r)),t.e164=r=>t.check(OF(O3,r)),t.datetime=r=>t.check(a3(r)),t.date=r=>t.check(o3(r)),t.time=r=>t.check(l3(r)),t.duration=r=>t.check(d3(r))});function K(t){return fF(y3,t)}const et=z("ZodStringFormat",(t,e)=>{Qe.init(t,e),FA.init(t,e)}),v3=z("ZodEmail",(t,e)=>{_5.init(t,e),et.init(t,e)}),fx=z("ZodGUID",(t,e)=>{x5.init(t,e),et.init(t,e)}),Nl=z("ZodUUID",(t,e)=>{w5.init(t,e),et.init(t,e)}),b3=z("ZodURL",(t,e)=>{E5.init(t,e),et.init(t,e)}),x3=z("ZodEmoji",(t,e)=>{T5.init(t,e),et.init(t,e)}),w3=z("ZodNanoID",(t,e)=>{A5.init(t,e),et.init(t,e)}),_3=z("ZodCUID",(t,e)=>{I5.init(t,e),et.init(t,e)}),E3=z("ZodCUID2",(t,e)=>{S5.init(t,e),et.init(t,e)}),T3=z("ZodULID",(t,e)=>{P5.init(t,e),et.init(t,e)}),A3=z("ZodXID",(t,e)=>{C5.init(t,e),et.init(t,e)}),I3=z("ZodKSUID",(t,e)=>{k5.init(t,e),et.init(t,e)}),S3=z("ZodIPv4",(t,e)=>{D5.init(t,e),et.init(t,e)}),P3=z("ZodIPv6",(t,e)=>{M5.init(t,e),et.init(t,e)}),C3=z("ZodCIDRv4",(t,e)=>{L5.init(t,e),et.init(t,e)}),k3=z("ZodCIDRv6",(t,e)=>{$5.init(t,e),et.init(t,e)}),N3=z("ZodBase64",(t,e)=>{V5.init(t,e),et.init(t,e)}),j3=z("ZodBase64URL",(t,e)=>{z5.init(t,e),et.init(t,e)}),O3=z("ZodE164",(t,e)=>{U5.init(t,e),et.init(t,e)}),R3=z("ZodJWT",(t,e)=>{q5.init(t,e),et.init(t,e)}),kg=z("ZodNumber",(t,e)=>{MA.init(t,e),ut.init(t,e),t.gt=(n,i)=>t.check(dx(n,i)),t.gte=(n,i)=>t.check(au(n,i)),t.min=(n,i)=>t.check(au(n,i)),t.lt=(n,i)=>t.check(ux(n,i)),t.lte=(n,i)=>t.check(iu(n,i)),t.max=(n,i)=>t.check(iu(n,i)),t.int=n=>t.check(mx(n)),t.safe=n=>t.check(mx(n)),t.positive=n=>t.check(dx(0,n)),t.nonnegative=n=>t.check(au(0,n)),t.negative=n=>t.check(ux(0,n)),t.nonpositive=n=>t.check(iu(0,n)),t.multipleOf=(n,i)=>t.check(hx(n,i)),t.step=(n,i)=>t.check(hx(n,i)),t.finite=()=>t;const r=t._zod.bag;t.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),t.isFinite=!0,t.format=r.format??null});function Fa(t){return VF(kg,t)}const D3=z("ZodNumberFormat",(t,e)=>{H5.init(t,e),kg.init(t,e)});function mx(t){return zF(D3,t)}const M3=z("ZodBoolean",(t,e)=>{W5.init(t,e),ut.init(t,e)});function zA(t){return UF(M3,t)}const L3=z("ZodUnknown",(t,e)=>{K5.init(t,e),ut.init(t,e)});function px(){return BF(L3)}const $3=z("ZodNever",(t,e)=>{G5.init(t,e),ut.init(t,e)});function V3(t){return qF($3,t)}const F3=z("ZodDate",(t,e)=>{Y5.init(t,e),ut.init(t,e),t.min=(n,i)=>t.check(au(n,i)),t.max=(n,i)=>t.check(iu(n,i));const r=t._zod.bag;t.minDate=r.minimum?new Date(r.minimum):null,t.maxDate=r.maximum?new Date(r.maximum):null});function _n(t){return HF(F3,t)}const z3=z("ZodArray",(t,e)=>{Z5.init(t,e),ut.init(t,e),t.element=e.element,t.min=(r,n)=>t.check(Ru(r,n)),t.nonempty=r=>t.check(Ru(1,r)),t.max=(r,n)=>t.check(LA(r,n)),t.length=(r,n)=>t.check($A(r,n)),t.unwrap=()=>t.element});function _e(t,e){return r3(z3,t,e)}const U3=z("ZodObject",(t,e)=>{Q5.init(t,e),ut.init(t,e),Ye(t,"shape",()=>e.shape),t.keyof=()=>De(Object.keys(t._zod.def.shape)),t.catchall=r=>t.clone({...t._zod.def,catchall:r}),t.passthrough=()=>t.clone({...t._zod.def,catchall:px()}),t.loose=()=>t.clone({...t._zod.def,catchall:px()}),t.strict=()=>t.clone({...t._zod.def,catchall:V3()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=r=>EV(t,r),t.merge=r=>TV(t,r),t.pick=r=>wV(t,r),t.omit=r=>_V(t,r),t.partial=(...r)=>AV(UA,t,r[0]),t.required=(...r)=>IV(BA,t,r[0])});function Ce(t,e){const r={type:"object",get shape(){return Ig(this,"shape",{...t}),this.shape},...ie(e)};return new U3(r)}const B3=z("ZodUnion",(t,e)=>{X5.init(t,e),ut.init(t,e),t.options=e.options});function q3(t,e){return new B3({type:"union",options:t,...ie(e)})}const H3=z("ZodIntersection",(t,e)=>{J5.init(t,e),ut.init(t,e)});function W3(t,e){return new H3({type:"intersection",left:t,right:e})}const jm=z("ZodEnum",(t,e)=>{eF.init(t,e),ut.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const r=new Set(Object.keys(e.entries));t.extract=(n,i)=>{const a={};for(const s of n)if(r.has(s))a[s]=e.entries[s];else throw new Error(`Key ${s} not found in enum`);return new jm({...e,checks:[],...ie(i),entries:a})},t.exclude=(n,i)=>{const a={...e.entries};for(const s of n)if(r.has(s))delete a[s];else throw new Error(`Key ${s} not found in enum`);return new jm({...e,checks:[],...ie(i),entries:a})}});function De(t,e){const r=Array.isArray(t)?Object.fromEntries(t.map(n=>[n,n])):t;return new jm({type:"enum",entries:r,...ie(e)})}const K3=z("ZodTransform",(t,e)=>{tF.init(t,e),ut.init(t,e),t._zod.parse=(r,n)=>{r.addIssue=a=>{if(typeof a=="string")r.issues.push(hc(a,r.value,e));else{const s=a;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=r.value),s.inst??(s.inst=t),s.continue??(s.continue=!0),r.issues.push(hc(s))}};const i=e.transform(r.value,r);return i instanceof Promise?i.then(a=>(r.value=a,r)):(r.value=i,r)}});function G3(t){return new K3({type:"transform",transform:t})}const UA=z("ZodOptional",(t,e)=>{rF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function gx(t){return new UA({type:"optional",innerType:t})}const Y3=z("ZodNullable",(t,e)=>{nF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function yx(t){return new Y3({type:"nullable",innerType:t})}const Z3=z("ZodDefault",(t,e)=>{iF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function Q3(t,e){return new Z3({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const X3=z("ZodPrefault",(t,e)=>{aF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function J3(t,e){return new X3({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():e}})}const BA=z("ZodNonOptional",(t,e)=>{sF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType});function e6(t,e){return new BA({type:"nonoptional",innerType:t,...ie(e)})}const t6=z("ZodCatch",(t,e)=>{oF.init(t,e),ut.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function r6(t,e){return new t6({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const n6=z("ZodPipe",(t,e)=>{cF.init(t,e),ut.init(t,e),t.in=e.in,t.out=e.out});function vx(t,e){return new n6({type:"pipe",in:t,out:e})}const i6=z("ZodReadonly",(t,e)=>{lF.init(t,e),ut.init(t,e)});function a6(t){return new i6({type:"readonly",innerType:t})}const s6=z("ZodCustom",(t,e)=>{uF.init(t,e),ut.init(t,e)});function o6(t){const e=new hr({check:"custom"});return e._zod.check=t,e}function c6(t,e={}){return n3(s6,t,e)}function l6(t){const e=o6(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(hc(n,r.value,e._zod.def));else{const i=n;i.fatal&&(i.continue=!1),i.code??(i.code="custom"),i.input??(i.input=r.value),i.inst??(i.inst=e),i.continue??(i.continue=!e._zod.def.abort),r.issues.push(hc(i))}},t(r.value,r)));return e}function fn(t){return FF(kg,t)}const qA=Ce({type:De(["overwatering","underwatering","pest","disease","nutrient","light","other"]),severity:De(["low","medium","high"]),description:K().min(1),treatment:K().min(1)}),HA=Ce({overallHealth:De(["excellent","good","fair","poor"]),issues:_e(qA),recommendations:_e(K()),moistureLevel:fn().min(0).max(100),growthStage:De(["seedling","juvenile","mature","flowering","dormant"]),confidence:fn().min(0).max(100)}),WA=Ce({wateringFrequency:fn().positive(),sunlightRequirement:De(["low","medium","high"]),humidityPreference:De(["low","medium","high"]),temperatureRange:Ce({min:fn(),max:fn()}),fertilizingFrequency:fn().positive(),soilType:K().min(1),specialCare:_e(K()).optional()}),KA=Ce({traits:_e(K()).min(1),communicationStyle:De(["cheerful","wise","dramatic","calm","playful"]),catchphrases:_e(K()),moodFactors:Ce({health:fn().min(0).max(1),care:fn().min(0).max(1),attention:fn().min(0).max(1)})}),u6=Ce({species:K(),commonName:K(),variety:K().nullable().optional(),confidence:fn().min(0).max(100),generalDescription:K().min(20),funFacts:_e(K()),plantEnvironment:De(["interior","exterior","ambos"]),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]),health:HA,careProfile:WA,personality:KA}),GA=Ce({type:De(["info","warning","tip","alert"]),title:K(),message:K()}),d6=_e(GA),h6=Object.freeze(Object.defineProperty({__proto__:null,AIAnalysisResponseSchema:u6,CareProfileSchema:WA,HealthAnalysisSchema:HA,HealthIssueSchema:qA,InsightResponseSchema:d6,InsightSchema:GA,PlantPersonalitySchema:KA},Symbol.toStringTag,{value:"Module"})),{HealthAnalysisSchema:f6,CareProfileSchema:m6,PlantPersonalitySchema:p6,InsightResponseSchema:g6}=h6,y6=Ce({id:K().min(1,"Image ID is required"),url:K().url("Must be a valid URL"),timestamp:_n(),healthAnalysis:f6.optional(),isProfileImage:zA()}),v6=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","plant","system"]),content:K().min(1,"Message content cannot be empty"),timestamp:_n(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]).optional(),context:Ce({insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),b6=Ce({id:K().min(1,"Notification ID is required"),type:De(["watering","fertilizing","health_check","general"]),title:K().min(1,"Title is required"),message:K().min(1,"Message is required"),priority:De(["low","medium","high"]),scheduledFor:_n(),completed:zA()}),x6=Ce({id:K().uuid(),name:K(),species:K(),variety:K().optional(),nickname:K().optional(),description:K().optional(),funFacts:_e(K()).optional(),location:K(),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),dateAdded:_n(),lastWatered:_n().optional(),lastFertilized:_n().optional(),images:_e(y6),healthScore:Fa().min(0).max(100),careProfile:m6,personality:p6,chatHistory:_e(v6),notifications:_e(b6)}),w6=Ce({id:K().min(1,"Plant ID is required"),name:K().min(1,"Plant name is required"),nickname:K().optional(),species:K().min(1,"Species is required"),location:K().min(1,"Location is required"),plantEnvironment:De(["interior","exterior","ambos"]).optional(),lightRequirements:De(["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"]).optional(),healthScore:Fa().min(0).max(100),profileImageUrl:K().url().optional(),lastWatered:_n().optional(),wateringFrequency:Fa().positive().optional()});Ce({content:K(),emotion:De(["alegre","triste","enojado","neutral","juguetón","agradecido","happy","sad","excited","worried","grateful"]),mood:K().optional()});Ce({changes:_e(K()),healthImprovement:Fa(),recommendations:_e(K()),newHealthScore:Fa().min(0).max(100)});x6.omit({id:!0,dateAdded:!0,chatHistory:!0,notifications:!0}).partial({images:!0,healthScore:!0,careProfile:!0,personality:!0});Ce({fullName:K().min(3,"El nombre debe tener al menos 3 caracteres"),email:K().email("Email inválido"),password:K().min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:K().min(6)}).refine(t=>t.password===t.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]});Ce({email:K().email(),password:K().min(1,"Password is required")});const _6=Ce({id:K().min(1,"Message ID is required"),sender:De(["user","ai"]),content:K().min(1,"Message content cannot be empty"),timestamp:_n(),context:Ce({plantsAnalyzed:_e(K()).optional(),queryType:De(["general","health_analysis","care_comparison","disease_prevention","growth_tracking"]).optional(),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()}).optional()}),E6=Ce({totalPlants:Fa(),plantsData:_e(w6),averageHealthScore:Fa(),commonIssues:_e(K()),careScheduleSummary:Ce({needsWatering:_e(K()),needsFertilizing:_e(K()),healthConcerns:_e(K())}),environmentalFactors:Ce({locations:_e(K()),lightConditions:_e(K()),humidityNeeds:_e(K())})});Ce({id:K().uuid(),userId:K().uuid(),messages:_e(_6),createdAt:_n(),updatedAt:_n(),context:E6.optional()});Ce({content:K().min(1),insights:_e(Ce({type:De(["tip","warning","observation","recommendation"]),title:K(),description:K(),affectedPlants:_e(K()).optional()})).optional(),suggestedActions:_e(Ce({action:K(),priority:De(["low","medium","high"]),plantIds:_e(K()).optional()})).optional()});const T6=async t=>{try{const{data:{session:e},error:r}=await Tt.auth.getSession();if(r||!e?.access_token)throw console.error("User session not available:",r),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:n,error:i}=await Tt.functions.invoke("generate-plant-insights",{body:{plant:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i)throw new Error(`Failed to generate insights: ${i.message}`);return g6.parse(n)}catch(e){throw console.error("[insightService] Error generating insights:",e),e instanceof h3?new Error(`Invalid data structure for insights: ${e.message}`):e}},YA=async t=>{bA(t);const{data:{session:e},error:r}=await Tt.auth.getSession();if(r||!e)throw new Error("User must be authenticated to analyze images");const{data:n,error:i}=await Tt.functions.invoke("analyze-image",{body:{imageDataUrl:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(i){if(console.error("Error invoking analyze-image function:",i),i.message?.includes("unsupported image"))throw new Error("La imagen no es válida. Por favor, asegúrate de que sea una foto clara de una planta.");if(i.message?.includes("OpenAI API key"))throw new Error("Servicio de análisis temporalmente no disponible. Intenta de nuevo más tarde.");const a=i.context?.msg?JSON.parse(i.context.msg).error:i.message;throw new Error(`Failed to analyze image: ${a}`)}if(n&&n.error)throw console.error("Image analysis failed with a specific error:",n.error),new Error(n.error);return n},bx=async(t,e)=>{const r="cálido, simpático, motivador, y con un toque de humor ligero",n=(t.images||[]).map(m=>({url:m.url,timestamp:m.timestamp instanceof Date?m.timestamp.toISOString():m.timestamp,...m.healthAnalysis?{healthAnalysis:m.healthAnalysis}:{}})).sort((m,p)=>new Date(m.timestamp).getTime()-new Date(p.timestamp).getTime());let i=[];try{i=await T6(t)}catch(m){console.warn("[generatePlantResponse] No se pudieron generar insights para la planta:",m),i=[]}const a={...t,images:n},{data:{session:s},error:o}=await Tt.auth.getSession();if(o||!s?.access_token)throw console.error("User session not available:",o),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:c,error:l}=await Tt.functions.invoke("generate-plant-response",{body:{plant:a,userMessage:e,tonePersona:r,insights:i},headers:{Authorization:`Bearer ${s.access_token}`}});if(l)throw console.error("Error calling generate-plant-response function:",l),new Error("Failed to generate plant response: "+l.message);const u=(c?.content||"").toLowerCase();return(!c?.content||u.includes("no sé")||u.includes("no tengo información")||u.includes("no puedo ayudarte")||u.length<20)&&Bd.warning("Respuesta genérica","La respuesta de la planta fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{...c,insights:c?.insights||i||[],suggestedActions:c?.suggestedActions||[]}},A6=async(t,e)=>{const{data:{session:r},error:n}=await Tt.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await Tt.functions.invoke("complete-plant-info",{body:{species:t,commonName:e},headers:{Authorization:`Bearer ${r.access_token}`}});if(a)throw console.error("💥 [API] Error en complete-plant-info function:",a),new Error("Failed to complete plant info: "+a.message);const s=["interior","exterior","ambos"],o=["poca_luz","luz_indirecta","luz_directa_parcial","pleno_sol"];return{plantEnvironment:s.includes(i.plantEnvironment)?i.plantEnvironment:"interior",lightRequirements:o.includes(i.lightRequirements)?i.lightRequirements:"luz_indirecta",description:i.description||void 0,funFacts:Array.isArray(i.funFacts)?i.funFacts:void 0}},wo=(t,e,r,n)=>({id:t.id,name:t.name,species:t.species,variety:t.variety||void 0,nickname:t.nickname||void 0,description:t.description||void 0,funFacts:t.fun_facts||[],location:t.location,plantEnvironment:t.plant_environment,lightRequirements:t.light_requirements,dateAdded:new Date(t.date_added),lastWatered:t.last_watered?new Date(t.last_watered):void 0,lastFertilized:t.last_fertilized?new Date(t.last_fertilized):void 0,images:e,healthScore:t.health_score||85,careProfile:t.care_profile,personality:t.personality,chatHistory:r,notifications:n});class Ng{constructor(e=Tt){yr(this,"supabase");this.supabase=e}async getUserPlantSummaries(e){try{if(!this.supabase){const s=BL(Im,"plants"),o=r4(s,n4("userId","==",e),i4("createdAt","desc")),c=await l4(o),l=[];return c.forEach(u=>{const h=u.data();l.push({id:u.id,name:h.name,nickname:h.nickname,species:h.species,location:h.location,plantEnvironment:h.plantEnvironment,lightRequirements:h.lightRequirements,healthScore:h.healthScore??85,profileImageUrl:h.profileImageUrl,lastWatered:h.lastWatered?new Date(h.lastWatered):void 0,wateringFrequency:h.careProfile?.wateringFrequency})}),l}const{data:r,error:n}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          care_profile
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;let i=new Map;if(r.length>0){const s=r.map(l=>l.id),{data:o,error:c}=await this.supabase.from("plant_images").select("plant_id, url").in("plant_id",s).eq("is_profile_image",!0);c?console.warn("[plantService] Error fetching profile images:",c):i=new Map((o||[]).map(l=>[l.plant_id,l.url]))}return r.map(s=>({id:s.id,name:s.name,nickname:s.nickname||void 0,species:s.species,location:s.location,plantEnvironment:s.plant_environment,lightRequirements:s.light_requirements,healthScore:s.health_score||85,profileImageUrl:i.get(s.id),lastWatered:s.last_watered?new Date(s.last_watered):void 0,wateringFrequency:s.care_profile?.wateringFrequency}))}catch(r){throw console.error("Error fetching plant summaries:",r),r}}async getUserPlants(e){try{const{data:r,error:n}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return r.map(a=>{const s=(a.plant_images||[]).map(l=>({id:l.id,url:l.url,timestamp:new Date(l.created_at),healthAnalysis:l.health_analysis,isProfileImage:l.is_profile_image||!1})),o=(a.chat_messages||[]).map(l=>({id:l.id,sender:l.sender,content:l.content,timestamp:new Date(l.created_at),emotion:l.emotion})),c=(a.plant_notifications||[]).map(l=>({id:l.id,type:l.type,title:l.title,message:l.message,priority:l.priority||"medium",scheduledFor:new Date(l.scheduled_for),completed:l.completed||!1}));return wo(a,s,o,c)})}catch(r){throw console.error("Error fetching plants:",r),r}}async getPlantById(e,r){try{const{data:n,error:i}=await this.supabase.from("plants").select(`
          *,
          plant_images ( * ),
          chat_messages ( * ),
          plant_notifications ( * )
        `).eq("id",e).eq("user_id",r).single();if(i){if(i.code==="PGRST116")return null;throw i}if(!n)return null;const a=(n.plant_images||[]).map(c=>({id:c.id,url:c.url,timestamp:new Date(c.created_at),healthAnalysis:c.health_analysis,isProfileImage:c.is_profile_image||!1})),s=(n.chat_messages||[]).map(c=>({id:c.id,sender:c.sender,content:c.content,timestamp:new Date(c.created_at),emotion:c.emotion})),o=(n.plant_notifications||[]).map(c=>({id:c.id,type:c.type,title:c.title,message:c.message,priority:c.priority||"medium",scheduledFor:new Date(c.scheduled_for),completed:c.completed||!1}));return wo(n,a,s,o)}catch(n){throw console.error("Error fetching plant by ID:",n),n}}async addPlantFromAnalysis(e,r,n){try{console.log("[PlantService] Iniciando análisis IA...");const i=await YA(r);console.log("[PlantService] Resultado IA:",i);const a={name:i.commonName,species:i.species,description:i.generalDescription,funFacts:i.funFacts,variety:i.variety??void 0,nickname:i.commonName,location:n,plantEnvironment:i.plantEnvironment,lightRequirements:i.lightRequirements,dateAdded:new Date,healthScore:i.health.confidence,careProfile:i.careProfile,personality:i.personality};console.log("[PlantService] Payload a createPlant:",a);const s=await this.createPlant(a,e);return console.log("[PlantService] Planta creada:",s),(async()=>{let o=!1,c=!1;try{console.log(`[PlantService] Starting image upload for plant ${s.id}`);const l=await xA(r,"plant-images",`${e}/${s.id}`);console.log("[PlantService] Imagen subida:",l),await this.addPlantImage(s.id,{url:l,timestamp:new Date,isProfileImage:!0,healthAnalysis:i.health},e),o=!0,console.log(`[PlantService] Image upload completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Image upload failed for plant ${s.id}:`,l),alert("Error subiendo imagen: "+(l instanceof Error?l.message:JSON.stringify(l)))}try{console.log(`[PlantService] Starting chat initialization for plant ${s.id}`);const l=await bx(s,"¡Hola! Acabo de llegar. ¿Cómo te llamas?");console.log("[PlantService] Respuesta IA chat:",l),await this.addChatMessage(s.id,{sender:"plant",content:l.content,timestamp:new Date,emotion:l.emotion},e),c=!0,console.log(`[PlantService] Chat initialization completed for plant ${s.id}`)}catch(l){console.error(`[PlantService] Chat initialization failed for plant ${s.id}:`,l),alert("Error inicializando chat: "+(l instanceof Error?l.message:JSON.stringify(l)))}o&&c?console.log(`[PlantService] All background tasks for plant ${s.id} completed successfully.`):(o||c)&&console.log(`[PlantService] Background tasks for plant ${s.id} partially completed.`)})().catch(o=>{console.error(`[PlantService] Error during background tasks for plant ${s.id}:`,o),alert("Error en tareas de fondo: "+(o instanceof Error?o.message:JSON.stringify(o)))}),s}catch(i){throw console.error("Error adding plant from analysis:",i),alert("Error creando planta: "+(i instanceof Error?i.message:JSON.stringify(i))),i}}async createPlant(e,r){try{const n={user_id:r,name:e.name,species:e.species,variety:e.variety||null,nickname:e.nickname||null,description:e.description||null,fun_facts:e.funFacts||null,location:e.location,plant_environment:e.plantEnvironment||null,light_requirements:e.lightRequirements||null,date_added:e.dateAdded.toISOString(),last_watered:null,last_fertilized:null,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,updated_at:null};console.log("[PlantService] Payload a Supabase:",n);const{data:i,error:a}=await this.supabase.from("plants").insert(n).select("*").single();if(console.log("[PlantService] Respuesta Supabase:",i,a),a)throw console.error("Supabase error:",{message:a.message,details:a.details,code:a.code}),alert("Error Supabase: "+a.message),new Error(`Supabase error creating plant: ${a.message}`);if(!i)throw alert("No se pudo crear la planta en la base de datos, no se devolvieron datos."),new Error("Failed to create plant in the database, no data returned.");return wo(i,[],[],[])}catch(n){throw console.error("Error creating plant:",n),alert("Error creando planta: "+(n instanceof Error?n.message:JSON.stringify(n))),n}}async updatePlantInfo(e,r,n){try{const i={};n.plantEnvironment!==void 0&&(i.plant_environment=n.plantEnvironment),n.lightRequirements!==void 0&&(i.light_requirements=n.lightRequirements),n.description!==void 0&&(i.description=n.description),n.funFacts!==void 0&&(i.fun_facts=n.funFacts);const{data:a,error:s}=await this.supabase.from("plants").update(i).eq("id",e).eq("user_id",r).select("*").single();if(s)throw console.error("Supabase error updating plant:",s),new Error(`Error updating plant: ${s.message}`);if(!a)throw new Error("Plant not found or not updated.");return wo(a,[],[],[])}catch(i){throw console.error("Error updating plant info:",i),i}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await this.supabase.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await this.supabase.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}async updatePlant(e,r){try{const n={name:e.name,species:e.species,variety:e.variety,nickname:e.nickname,description:e.description,fun_facts:e.funFacts,location:e.location,health_score:e.healthScore,care_profile:e.careProfile,personality:e.personality,last_watered:e.lastWatered?.toISOString(),last_fertilized:e.lastFertilized?.toISOString()},{data:i,error:a}=await this.supabase.from("plants").update(n).eq("id",e.id).eq("user_id",r).select().single();if(a)throw a;return wo(i,e.images,e.chatHistory,e.notifications)}catch(n){throw console.error("Error updating plant:",n),n}}async deletePlant(e,r){try{const{error:n}=await this.supabase.from("plants").delete().eq("id",e).eq("user_id",r);if(n)throw n}catch(n){throw console.error("Error deleting plant:",n),n}}async sendChatMessageAndGetResponse(e,r,n){const i=await this.addChatMessage(e.id,r,n),a=await bx(e,r.content),s={};a.insights&&(s.insights=a.insights),a.suggestedActions&&(s.suggestedActions=a.suggestedActions);const o={sender:"plant",content:a.content,emotion:a.emotion,timestamp:new Date,...Object.keys(s).length>0?{context:s}:{}},c=await this.addChatMessage(e.id,o,n);return[i,c]}async addChatMessage(e,r,n){try{const i={plant_id:e,user_id:n,sender:r.sender,content:r.content,emotion:r.emotion||null};r.context&&(i.context=r.context);const{data:a,error:s}=await this.supabase.from("chat_messages").insert(i).select().single();if(s)throw console.error("❌ Supabase error:",s),s;return{id:a.id,sender:a.sender,content:a.content,timestamp:new Date(a.created_at),emotion:a.emotion,context:a.context||void 0}}catch(i){throw console.error("Error adding chat message:",i),i}}async addPlantImage(e,r,n){try{const i=r.url;let a="";try{const l=new URL(i).pathname.split("/"),u=l.findIndex(h=>h==="object");u!==-1&&u+2<l.length&&(a=l.slice(u+2).join("/"))}catch{console.warn("Could not extract storage path from URL:",i),a=`${n}/${e}/${Date.now()}.jpg`}const{data:s,error:o}=await this.supabase.from("plant_images").insert({plant_id:e,user_id:n,url:i,storage_path:a,is_profile_image:r.isProfileImage,health_analysis:r.healthAnalysis}).select().single();if(o)throw o;if(!s.url)throw new Error("Image URL not returned from database.");return{id:s.id,url:s.url,timestamp:new Date(s.created_at),isProfileImage:s.is_profile_image||!1,healthAnalysis:s.health_analysis}}catch(i){throw console.error("Error adding plant image:",i),new Error(`Image upload failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async setProfileImage(e,r,n){try{await this.supabase.from("plant_images").update({is_profile_image:!1}).eq("plant_id",e).eq("user_id",n);const{error:i}=await this.supabase.from("plant_images").update({is_profile_image:!0}).eq("id",r).eq("user_id",n);if(i)throw i}catch(i){throw console.error("Error setting profile image:",i),i}}async deleteImage(e,r){try{const{data:n,error:i}=await this.supabase.from("plant_images").select("storage_path").eq("id",e).eq("user_id",r).single();if(i)throw i;n?.storage_path&&await this.supabase.storage.from("plant-images").remove([n.storage_path]);const{error:a}=await this.supabase.from("plant_images").delete().eq("id",e).eq("user_id",r);if(a)throw a}catch(n){throw console.error("Error deleting image:",n),n}}}const vs=new Ng(Tt);class I6{constructor(){yr(this,"cache",new Map);yr(this,"CACHE_DURATIONS",{GARDEN_CONTEXT:5*60*1e3,GARDEN_SUMMARY:3*60*1e3,SUGGESTED_QUESTIONS:10*60*1e3,PLANT_DATA:2*60*1e3})}getCacheKey(e,r){return`${e}:${r}`}isValidCache(e){return e?Date.now()<e.expiresAt:!1}getCachedData(e){const r=this.cache.get(e);return this.isValidCache(r)?r.data:(r&&this.cache.delete(e),null)}setCachedData(e,r,n){const i={data:r,timestamp:Date.now(),expiresAt:Date.now()+n};this.cache.set(e,i),console.log(`[GardenCache] Cache SET for key: ${e}, expires in ${n/1e3}s`)}getGardenContext(e){const r=this.getCacheKey(e,"garden_context");return this.getCachedData(r)}setGardenContext(e,r){const n=this.getCacheKey(e,"garden_context");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_CONTEXT)}getGardenSummary(e){const r=this.getCacheKey(e,"garden_summary");return this.getCachedData(r)}setGardenSummary(e,r){const n=this.getCacheKey(e,"garden_summary");this.setCachedData(n,r,this.CACHE_DURATIONS.GARDEN_SUMMARY)}getSuggestedQuestions(e){const r=this.getCacheKey(e,"suggested_questions");return this.getCachedData(r)}setSuggestedQuestions(e,r){const n=this.getCacheKey(e,"suggested_questions");this.setCachedData(n,r,this.CACHE_DURATIONS.SUGGESTED_QUESTIONS)}getPlantData(e){const r=this.getCacheKey(e,"plant_data");return this.getCachedData(r)}setPlantData(e,r){const n=this.getCacheKey(e,"plant_data");this.setCachedData(n,r,this.CACHE_DURATIONS.PLANT_DATA)}invalidateCache(e,r){r?r.forEach(n=>{const i=this.getCacheKey(e,n);this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)}):Array.from(this.cache.keys()).filter(i=>i.startsWith(`${e}:`)).forEach(i=>{this.cache.delete(i),console.log(`[GardenCache] Invalidated cache for key: ${i}`)})}invalidateOnPlantChange(e){console.log("[GardenCache] Plant data changed, invalidating related caches"),this.invalidateCache(e,["garden_context","garden_summary","plant_data","suggested_questions"])}getCacheStats(e){const r=Array.from(this.cache.keys()),n=r.filter(s=>s.startsWith(`${e}:`));let i=0,a=0;return n.forEach(s=>{const o=this.cache.get(s);o&&(this.isValidCache(o)?i++:a++)}),{totalEntries:r.length,userEntries:n.length,validEntries:i,expiredEntries:a}}cleanup(){const e=Date.now(),r=[];this.cache.forEach((n,i)=>{e>=n.expiresAt&&r.push(i)}),r.forEach(n=>{this.cache.delete(n)}),r.length>0&&console.log(`[GardenCache] Cleaned up ${r.length} expired entries`)}clearAll(){this.cache.size,this.cache.clear()}}const Yo=new I6;typeof window<"u"&&setInterval(()=>{Yo.cleanup()},5*60*1e3);const _o=new Ng,Eo={isLoading:!1,error:null},Kn=Pp((t,e)=>({plants:[],operationStates:{add:{...Eo},update:{...Eo},delete:{...Eo},addImage:{...Eo},chat:{...Eo}},selectedPlantId:null,getOperationState:r=>e().operationStates[r],getPlantById:r=>e().plants.find(n=>n.id===r),setPlant:r=>{t(Ie(n=>{const i=n.plants.findIndex(a=>a.id===r.id);i!==-1?n.plants[i]=r:n.plants.push(r)}))},addPlant:async(r,n,i)=>{t(Ie(a=>{a.operationStates.add.isLoading=!0,a.operationStates.add.error=null,a.operationStates.add.lastOperation="addPlant"}));try{const a=await _o.addPlantFromAnalysis(i,r,n);return t(Ie(s=>{s.plants.unshift(a),s.operationStates.add.isLoading=!1})),Yo.invalidateOnPlantChange(i),a}catch(a){const s=a instanceof Error?a.message:"Failed to add plant";throw t(Ie(o=>{o.operationStates.add.isLoading=!1,o.operationStates.add.error=s})),a}},updatePlant:async(r,n)=>{t(Ie(i=>{i.operationStates.update.isLoading=!0,i.operationStates.update.error=null,i.operationStates.update.lastOperation=`updatePlant-${r.id}`}));try{const i=await _o.updatePlant(r,n);t(Ie(a=>{const s=a.plants.findIndex(o=>o.id===i.id);s!==-1&&(a.plants[s]=i),a.operationStates.update.isLoading=!1})),Yo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to update plant";throw t(Ie(s=>{s.operationStates.update.isLoading=!1,s.operationStates.update.error=a})),i}},deletePlant:async(r,n)=>{t(Ie(i=>{i.operationStates.delete.isLoading=!0,i.operationStates.delete.error=null,i.operationStates.delete.lastOperation=`deletePlant-${r}`}));try{await _o.deletePlant(r,n),t(Ie(i=>{i.plants=i.plants.filter(a=>a.id!==r),i.operationStates.delete.isLoading=!1})),Yo.invalidateOnPlantChange(n)}catch(i){const a=i instanceof Error?i.message:"Failed to delete plant";throw t(Ie(s=>{s.operationStates.delete.isLoading=!1,s.operationStates.delete.error=a})),i}},addChatMessage:async(r,n,i)=>{t(Ie(o=>{o.operationStates.chat.isLoading=!0,o.operationStates.chat.error=null,o.operationStates.chat.lastOperation=`addChatMessage-${r}`}));const a=e().getPlantById(r);if(!a){t(Ie(o=>{o.operationStates.chat.isLoading=!1,o.operationStates.chat.error="Plant not found to add message"}));return}const s={id:`temp-user-${Date.now()}`,sender:"user",content:n,timestamp:new Date};t(Ie(o=>{o.plants.find(c=>c.id===r)?.chatHistory.push(s)}));try{const[o,c]=await _o.sendChatMessageAndGetResponse(a,{sender:"user",content:n,timestamp:s.timestamp},i);t(Ie(l=>{const u=l.plants.find(h=>h.id===r);u&&(u.chatHistory=[...u.chatHistory.filter(h=>h.id!==s.id),o,c]),l.operationStates.chat.isLoading=!1}))}catch(o){const c=o instanceof Error?o.message:"Failed to send message";t(Ie(l=>{l.operationStates.chat.isLoading=!1,l.operationStates.chat.error=c}))}},addPlantImage:async(r,n,i)=>{t(Ie(a=>{a.operationStates.addImage.isLoading=!0,a.operationStates.addImage.error=null,a.operationStates.addImage.lastOperation=`addImage-${r}`}));try{const a=await _o.addPlantImage(r,{url:n,timestamp:new Date,isProfileImage:!1},i);t(Ie(s=>{const o=s.plants.find(c=>c.id===r);o&&o.images.push(a),s.operationStates.addImage.isLoading=!1}))}catch(a){const s=a instanceof Error?a.message:"Failed to add image";throw t(Ie(o=>{o.operationStates.addImage.isLoading=!1,o.operationStates.addImage.error=s})),a}},selectPlant:r=>t({selectedPlantId:r}),clearError:r=>{t(Ie(r?n=>{n.operationStates[r].error=null}:n=>{Object.keys(n.operationStates).forEach(i=>{n.operationStates[i].error=null})}))},clearPlants:()=>t({plants:[],selectedPlantId:null})}));class S6{async updatePlantHealthDiagnosis(e){if(!e.images||e.images.length===0)throw new Error("Esta planta no tiene imágenes para analizar. Toma una foto primero.");const r=[...e.images].sort((a,s)=>s.timestamp.getTime()-a.timestamp.getTime())[0],{data:{session:n},error:i}=await Tt.auth.getSession();if(i||!n?.access_token)throw console.error("💥 [Health] User session not available:",i),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");try{const a=await fetch(r.url,{method:"HEAD"});if(!a.ok)throw new Error(`Imagen no accesible: ${a.status}`)}catch(a){throw console.error("💥 [Health] Error verificando acceso a imagen:",a),new Error("La imagen de la planta no está disponible. Intenta tomar una nueva foto.")}console.log("🔬 [Health] Llamando a update-health-diagnosis...");try{const{data:a,error:s}=await Tt.functions.invoke("update-health-diagnosis",{body:{imageUrl:r.url,plantName:e.name,species:e.species},headers:{Authorization:`Bearer ${n.access_token}`}});if(s)throw console.error("💥 [Health] Error en función update-health-diagnosis:",s),new Error(`Error en análisis: ${s.message}`);if(!a||!a.overallHealth)throw console.error("💥 [Health] Datos incompletos del análisis:",a),new Error("El análisis no devolvió información de salud válida.");console.log("🎯 [Health] Análisis de salud completado exitosamente:",{overallHealth:a.overallHealth,confidence:a.confidence,issuesCount:a.issues?.length||0,recommendationsCount:a.recommendations?.length||0});const c={excellent:95,good:80,fair:60,poor:30}[a.overallHealth]||a.confidence||60;return console.log("📊 [Health] Nuevo score de salud calculado:",{overallHealth:a.overallHealth,numericScore:c,confidence:a.confidence}),{healthScore:c,healthAnalysis:a,updatedImage:{...r,healthAnalysis:a}}}catch(a){console.error("💥 [Health] Error en diagnóstico primario:",a),console.log("🔄 [Health] Intentando análisis de fallback...");try{if(r.healthAnalysis&&r.healthAnalysis.overallHealth){console.log("🎯 [Health] Usando análisis existente de la imagen");const s=r.healthAnalysis;return{healthScore:{excellent:95,good:80,fair:60,poor:30}[s.overallHealth]||60,healthAnalysis:s,updatedImage:r}}}catch(s){console.error("💥 [Health] Error en fallback:",s)}throw new Error("No se pudo actualizar el diagnóstico de salud. Verifica tu conexión a internet e intenta nuevamente.")}}async updatePlantHealthScore(e,r,n,i,a){try{console.log("🏥 [DB] Actualizando health score en BD:",{plantId:e,healthScore:n,hasAnalysis:!!i});const{error:s}=await Tt.from("plants").update({health_score:n}).eq("id",e).eq("user_id",r);if(s)throw console.error("💥 [DB] Error actualizando health score:",s),new Error(`Error updating plant health score: ${s.message}`);if(i&&a){console.log("📸 [DB] Actualizando análisis de salud en imagen:",a);const{error:o}=await Tt.from("plant_images").update({health_analysis:i}).eq("id",a).eq("user_id",r);o&&console.warn("⚠️ [DB] Error actualizando análisis en imagen:",o)}console.log("✅ [DB] Health score actualizado exitosamente")}catch(s){throw console.error("💥 [DB] Error en updatePlantHealthScore:",s),s}}}const xx=new S6,Kd=()=>{const t=pd(),{addPlant:e,updatePlant:r,deletePlant:n}=Kn.getState(),a=Nn(h=>h.user)?.id,{addToast:s}=Qs(),o=Ai({mutationFn:h=>{if(!a)throw new Error("User not authenticated");const{imageDataUrl:m,location:p}=h;return e(m,p,a)},onSuccess:h=>{t.invalidateQueries({queryKey:["plants",a]})},onError:h=>{console.error("Failed to create plant:",h)}}),c=Ai({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return r(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.map(p=>p.id===h.id?h:p)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:h=>{t.invalidateQueries({queryKey:["plants",a]})}}),l=Ai({mutationFn:async({plant:h,userId:m})=>{console.log("🩺 [Mutation] Iniciando actualización de diagnóstico...");const p=await xx.updatePlantHealthDiagnosis(h);return await xx.updatePlantHealthScore(h.id,m,p.healthScore,p.healthAnalysis,p.updatedImage.id),console.log("✅ [Mutation] Diagnóstico actualizado exitosamente"),p},onSuccess:(h,{plant:m})=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",m.id]}),s({type:"success",title:"Diagnóstico Actualizado",message:`Nuevo estado de salud: ${h.healthScore}%`})},onError:h=>{console.error("💥 [Mutation] Error actualizando diagnóstico:",h),s({type:"error",title:"Error en Diagnóstico",message:h.message})}}),u=Ai({mutationFn:h=>{if(!a)throw new Error("User not authenticated");return n(h,a)},onMutate:async h=>{await t.cancelQueries({queryKey:["plants",a]});const m=t.getQueryData(["plants",a]);return m&&t.setQueryData(["plants",a],m.filter(p=>p.id!==h)),{previousPlants:m}},onError:(h,m,p)=>{p?.previousPlants&&t.setQueryData(["plants",a],p.previousPlants)},onSettled:()=>{t.invalidateQueries({queryKey:["plants",a]})}});return{createPlant:o.mutate,isCreatingPlant:o.isPending,updatePlant:c.mutate,isUpdatingPlant:c.isPending,updatePlantHealthMutation:l.mutate,isUpdatingPlantHealth:l.isPending,deletePlant:u.mutate,isDeletingPlant:u.isPending}},P6=()=>{const[t,e]=w.useState(!1),r=sr(),{createPlant:n,isCreatingPlant:i}=Kd();w.useEffect(()=>{const o=c=>{c.key==="Escape"&&e(!1)};return t&&document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[t]);const a=[{id:"camera",icon:Yn,label:"Tomar Foto",color:"bg-blue-500",action:()=>{e(!1),r(vt.toCamera())}},{id:"gallery",icon:Ap,label:"Galería",color:"bg-purple-500",action:()=>s()}],s=w.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async c=>{const l=c.target.files?.[0];if(l){const u=new FileReader;u.onload=async h=>{const m=h.target?.result;if(m){e(!1);const p=new Promise((v,b)=>{n({imageDataUrl:m,location:"Interior"},{onSuccess:g=>{g?.id&&r(vt.toPlantDetail(g.id)),v(g)},onError:g=>{console.error("Failed to create plant:",g),b(g)}})});uA.promise(p,{loading:"Analizando imagen... La IA está trabajando.",success:v=>`¡Planta "${v.name}" creada con éxito!`,error:v=>`Error: ${v.message}`})}},u.readAsDataURL(l)}},o.click()},[n,r]);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative flex items-center",children:[d.jsx(L.button,{onClick:()=>e(!t),className:"w-12 h-12 bg-primary-500 hover:bg-primary-600 disabled:bg-primary-300 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center disabled:cursor-not-allowed",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},disabled:i,"aria-label":t?"Cerrar menú":"Agregar planta","aria-expanded":t,children:d.jsx(ke,{mode:"wait",children:i?d.jsx(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:d.jsx(wa,{className:"w-6 h-6 animate-spin"})},"loading"):d.jsx(L.div,{initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:t?45:0},exit:{opacity:0,rotate:180},transition:{duration:.2},children:d.jsx(Tp,{className:"w-6 h-6"})},"plus")})}),t&&d.jsx(L.span,{initial:{opacity:0,x:10},animate:{opacity:1,x:16},exit:{opacity:0,x:10},transition:{duration:.2},className:"ml-3 px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-xs font-medium shadow-md whitespace-nowrap z-50",children:"Agregar planta"})]}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"absolute bottom-16 right-0 flex flex-col gap-3",initial:"closed",animate:"open",exit:"closed",variants:{open:{transition:{staggerChildren:.1,delayChildren:.1}},closed:{transition:{staggerChildren:.05,staggerDirection:-1}}},children:a.map((o,c)=>d.jsxs(L.button,{onClick:o.action,className:`w-12 h-12 ${o.color} hover:scale-105 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group relative`,variants:{open:{opacity:1,scale:1,y:0,transition:{delay:c*.1}},closed:{opacity:0,scale:.3,y:20,transition:{delay:(a.length-c)*.05}}},whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":o.label,children:[d.jsx(o.icon,{className:"w-5 h-5"}),d.jsx("div",{className:"absolute right-full mr-3 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:d.jsxs("div",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded-lg whitespace-nowrap",children:[o.label,d.jsx("div",{className:"absolute left-full top-1/2 -translate-y-1/2 w-0 h-0 border-l-4 border-r-0 border-t-2 border-b-2 border-transparent border-l-gray-900"})]})})]},o.id))})}),d.jsx(ke,{children:t&&d.jsx(L.div,{className:"fixed inset-0 z-[-1]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>e(!1)})})]})},C6=[{icon:cu,path:Et.dashboard,label:"Inicio",description:"Tu jardín personal"},{icon:Xo,path:Et.gardenChat,label:"Chat IA",description:"Asistente de plantas"},{icon:gN,path:Et.settings,label:"Ajustes",description:"Configuración"}],k6=()=>{const t=lE(),e=t.pathname.startsWith("/plant/");return d.jsxs(d.Fragment,{children:[d.jsx("nav",{className:"safe-bottom fixed bottom-0 left-0 right-0 z-50 glass-enhanced border-t border-contrast","data-tour":"bottom-navigation",children:d.jsx("div",{className:"flex justify-around items-center h-20 max-w-lg mx-auto px-2",children:C6.map(r=>{const n=sV(t.pathname,r.path);return d.jsx(L.div,{className:"relative flex-1 h-full",whileTap:{scale:.92},whileHover:{scale:1.02},children:d.jsxs(fN,{to:r.path,className:Oe("touch-target relative flex flex-col items-center justify-center w-full h-full rounded-2xl transition-all duration-200","focus-contrast",n?"text-primary-700 dark:text-primary-400":"text-neutral-700 dark:text-neutral-300 hover:text-primary-600 dark:hover:text-primary-400"),"aria-label":`${r.label} - ${r.description}`,...n?{"aria-current":"page"}:{},...r.path===Et.gardenChat?{"data-tour":"chat-tab"}:{},onClick:i=>{const a=document.startViewTransition?.bind(document);a&&(i.preventDefault(),a(()=>{window.history.pushState({},"",r.path),window.dispatchEvent(new PopStateEvent("popstate"))}))},children:[d.jsx(ke,{children:n&&d.jsx(L.div,{layoutId:"nav-background",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{type:"spring",stiffness:400,damping:30},className:"absolute inset-1 bg-primary-500/10 dark:bg-primary-400/10 rounded-xl"})}),d.jsx(L.div,{animate:{scale:n?1.1:1,y:n?-2:0},transition:{duration:.2},className:Oe("relative z-10",n?"text-[#2A7F3E]":"text-[#888]"),children:d.jsx(r.icon,{size:24,strokeWidth:n?2.5:2,className:"drop-shadow-sm"})}),d.jsx(L.span,{animate:{scale:n?1.05:1,fontWeight:n?600:500},transition:{duration:.2},className:"text-xs mt-1 relative z-10",children:r.label}),d.jsx(ke,{children:n&&d.jsx(L.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{delay:.1},className:"absolute left-1/2 -translate-x-1/2 w-1 h-1 bg-primary-500 dark:bg-primary-400 rounded-full mt-1.5"})})]})},r.path)})})}),!e&&d.jsx("div",{className:"fixed bottom-20 sm:bottom-24 right-4 sm:right-6 z-40","data-tour":"add-plant-fab",children:d.jsx(P6,{})})]})},N6=()=>{const[t,e]=w.useState(navigator.onLine);return w.useEffect(()=>{const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),t},j6=()=>{const t=N6();return d.jsxs(ke,{children:[!t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",children:d.jsx("div",{className:"bg-red-500 text-white px-4 py-2 text-center text-sm font-medium",children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(yN,{size:16}),d.jsx("span",{children:"Sin conexión - Modo offline"})]})})}),t&&d.jsx(L.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"fixed top-0 left-0 right-0 z-50 safe-area-top",onAnimationComplete:()=>{setTimeout(()=>{const e=document.querySelector("[data-online-indicator]");e&&e.remove()},2e3)},children:d.jsx("div",{className:"bg-green-500 text-white px-4 py-2 text-center text-sm font-medium","data-online-indicator":!0,children:d.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[d.jsx(dE,{size:16}),d.jsx("span",{children:"Conexión restaurada"})]})})})]})},O6="1.0.0",R6="2025-08-07T22:09:52.404Z",D6="7 de agosto de 2025, 18:09",pa={name:"Plantitas",version:O6,buildDate:D6,buildTimestamp:R6,author:"Felipe Aurelio",repository:"https://github.com/felipeaurelio13/plantitas-app"},M6=()=>`${pa.name} v${pa.version} (${pa.buildDate})`,L6=({className:t="",showVersion:e=!0,showBuildInfo:r=!1})=>d.jsxs("footer",{className:`text-center py-4 text-sm text-muted-foreground ${t}`,children:[e&&d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:"font-medium text-foreground",children:pa.name}),d.jsx("p",{className:"text-xs opacity-75",children:M6()})]}),r&&d.jsxs("div",{className:"mt-2 text-xs opacity-50",children:[d.jsxs("p",{children:["Build: ",pa.buildTimestamp]}),d.jsxs("p",{children:["Repo: ",pa.repository]})]}),d.jsx("div",{className:"mt-2 text-xs opacity-60",children:d.jsxs("p",{children:["© 2024 ",pa.author,". Todos los derechos reservados."]})})]});function $6(t,e){let r;try{r=t()}catch{return}return{getItem:i=>{var a;const s=c=>c===null?null:JSON.parse(c,void 0),o=(a=r.getItem(i))!=null?a:null;return o instanceof Promise?o.then(s):s(o)},setItem:(i,a)=>r.setItem(i,JSON.stringify(a,void 0)),removeItem:i=>r.removeItem(i)}}const Om=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Om(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Om(n)(r)}}}},V6=(t,e)=>(r,n,i)=>{let a={storage:$6(()=>localStorage),partialize:b=>b,version:0,merge:(b,g)=>({...g,...b}),...e},s=!1;const o=new Set,c=new Set;let l=a.storage;if(!l)return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},n,i);const u=()=>{const b=a.partialize({...n()});return l.setItem(a.name,{state:b,version:a.version})},h=i.setState;i.setState=(b,g)=>{h(b,g),u()};const m=t((...b)=>{r(...b),u()},n,i);i.getInitialState=()=>m;let p;const v=()=>{var b,g;if(!l)return;s=!1,o.forEach(T=>{var E;return T((E=n())!=null?E:m)});const _=((g=a.onRehydrateStorage)==null?void 0:g.call(a,(b=n())!=null?b:m))||void 0;return Om(l.getItem.bind(l))(a.name).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==a.version){if(a.migrate){const E=a.migrate(T.state,T.version);return E instanceof Promise?E.then(j=>[!0,j]):[!0,E]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,T.state];return[!1,void 0]}).then(T=>{var E;const[j,R]=T;if(p=a.merge(R,(E=n())!=null?E:m),r(p,!0),j)return u()}).then(()=>{_?.(p,void 0),p=n(),s=!0,c.forEach(T=>T(p))}).catch(T=>{_?.(void 0,T)})};return i.persist={setOptions:b=>{a={...a,...b},b.storage&&(l=b.storage)},clearStorage:()=>{l?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>v(),hasHydrated:()=>s,onHydrate:b=>(o.add(b),()=>{o.delete(b)}),onFinishHydration:b=>(c.add(b),()=>{c.delete(b)})},a.skipHydration||v(),p||m},F6=V6,z6=Pp()(F6((t,e)=>({isDark:typeof window<"u"?window.matchMedia("(prefers-color-scheme: dark)").matches:!1,toggleTheme:()=>{const{isDark:r}=e(),n=!r;t({isDark:n}),yf(n),"vibrate"in navigator&&navigator.vibrate(50)},setTheme:r=>{t({isDark:r}),yf(r)}}),{name:"theme-storage",onRehydrateStorage:()=>t=>{t&&yf(t.isDark)}})),yf=t=>{if(typeof window>"u")return;const e=t?"dark":"light";document.documentElement.setAttribute("data-theme",e),t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},U6=()=>{const t=lE(),{isDark:e}=z6(),r=t.pathname==="/camera",n=()=>{const a={"/":"Página de inicio - Tu jardín personal","/camera":"Cámara - Agregar nueva planta","/chat":"Chat con IA - Asistente de plantas","/garden-chat":"Chat del jardín - Consultas generales","/settings":"Configuración - Ajustes de la aplicación"},s=t.pathname.includes("/plant/")?"/plant":t.pathname,o=a[s]||a[t.pathname]||"Página",c=document.createElement("div");c.setAttribute("aria-live","polite"),c.setAttribute("aria-atomic","true"),c.setAttribute("class","sr-only"),c.textContent=`Navegando a ${o}`,document.body.appendChild(c),setTimeout(()=>{document.body.removeChild(c)},1e3)};w.useEffect(()=>{n(),document.startViewTransition&&document.startViewTransition?.(()=>{})},[t.pathname]),w.useEffect(()=>{const a=e?"dark":"light";document.documentElement.setAttribute("data-theme",a)},[e]);const i=()=>d.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only fixed top-4 left-4 z-50 bg-primary-600 text-white px-4 py-2 rounded-md font-medium transition-all duration-200 focus:shadow-lg",onFocus:a=>{a.currentTarget.scrollIntoView({behavior:"smooth"})},children:"Saltar al contenido principal"});return d.jsxs("div",{className:"min-h-screen bg-background text-text-primary",style:{viewTransitionName:"app-root"},children:[d.jsx(i,{}),d.jsx("h1",{className:"sr-only",children:"Plantitas - Aplicación de cuidado de plantas"}),d.jsx("main",{id:"main-content",role:"main","aria-label":"Contenido principal",className:"pb-28 min-h-screen focus:outline-none",tabIndex:-1,children:d.jsx(ke,{mode:"wait",children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"w-full h-full",children:d.jsx(mN,{})},t.pathname)})}),d.jsx("aside",{role:"complementary","aria-label":"Información de estado",children:d.jsx(j6,{})}),!r&&d.jsx("nav",{role:"navigation","aria-label":"Navegación inferior",children:d.jsx(k6,{})}),!r&&d.jsx(L6,{className:"mt-auto pt-4 pb-20",showVersion:!0,showBuildInfo:!1}),d.jsx("style",{children:`
        @media (prefers-contrast: high) {
          :root {
            --color-background: #000000;
            --color-surface: #111111;
            --color-text-primary: #ffffff;
            --color-text-secondary: #ffffff;
            --color-border: #ffffff;
            --color-accent: #00ff00;
          }
        }

        @media (prefers-reduced-motion: reduce) {
          * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
          }
        }

        /* Screen reader only utility */
        .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
        }

        .sr-only.focus\\:not-sr-only:focus {
          position: static;
          width: auto;
          height: auto;
          padding: inherit;
          margin: inherit;
          overflow: visible;
          clip: auto;
          white-space: normal;
        }

        /* Enhanced focus indicators */
        *:focus-visible {
          outline: 3px solid var(--color-accent) !important;
          outline-offset: 2px !important;
          border-radius: 4px;
        }

        /* High contrast focus ring */
        @media (prefers-contrast: high) {
          *:focus-visible {
            outline: 4px solid #00ff00 !important;
            outline-offset: 3px !important;
          }
        }
      `})]})};class B6 extends w.Component{constructor(r){super(r);yr(this,"handleReload",()=>{window.location.reload()});yr(this,"handleGoHome",()=>{window.location.href="/plantitas-app/"});this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){this.setState({error:r,errorInfo:n});const i={userAgent:navigator.userAgent,platform:navigator.platform,isOnline:navigator.onLine,viewport:{width:window.innerWidth,height:window.innerHeight},url:window.location.href,timestamp:new Date().toISOString()};console.error("[ErrorBoundary] Error caught:",{error:r.message,stack:r.stack,errorInfo:n,mobileInfo:i}),console.warn("[ErrorBoundary] Production error detected:",{message:r.message,mobile:i})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:d.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-md w-full",children:d.jsxs("div",{className:"glass-effect rounded-2xl p-8 text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:d.jsx(Tn,{size:32,className:"text-red-500"})}),d.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"¡Oops! Algo salió mal"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Ha ocurrido un error inesperado. No te preocupes, tus plantas están seguras."}),!1,d.jsxs("div",{className:"space-y-3",children:[d.jsxs("button",{onClick:this.handleReload,className:"w-full px-4 py-3 bg-primary-500 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(Oi,{size:18}),d.jsx("span",{children:"Recargar Página"})]}),d.jsxs("button",{onClick:this.handleGoHome,className:"w-full px-4 py-3 bg-gray-600 text-white rounded-xl font-medium ios-button flex items-center justify-center space-x-2",children:[d.jsx(cu,{size:18}),d.jsx("span",{children:"Ir al Inicio"})]})]}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-4",children:"Si el problema persiste, intenta limpiar el caché del navegador."})]})})}):this.props.children}}const q6=()=>{const t=Nn(e=>e.user);return sE({queryKey:["plants",t?.id],queryFn:async()=>t?vs.getUserPlantSummaries(t.id):Promise.resolve([]),enabled:!!t,staleTime:vi.QUERY.STALE_TIME.MEDIUM,gcTime:vi.QUERY.GC_TIME.LONG,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!0,placeholderData:[]})},wx=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,_x=Le,jg=(t,e)=>r=>{var n;if(e?.variants==null)return _x(t,r?.class,r?.className);const{variants:i,defaultVariants:a}=e,s=Object.keys(i).map(l=>{const u=r?.[l],h=a?.[l];if(u===null)return null;const m=wx(u)||wx(h);return i[l][m]}),o=r&&Object.entries(r).reduce((l,u)=>{let[h,m]=u;return m===void 0||(l[h]=m),l},{}),c=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((l,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...a,...o}[b]):{...a,...o}[b]===g})?[...l,h,m]:l},[]);return _x(t,s,c,r?.class,r?.className)},H6=jg("overflow-hidden transition-all duration-300",{variants:{variant:{default:["bg-white/90 border border-neutral-200","dark:bg-neutral-900/90 dark:border-neutral-700","shadow-md hover:shadow-lg"],glass:["glass","hover:shadow-glass-lg","border-neutral-200/50 dark:border-neutral-700/50"],elevated:["bg-white border border-neutral-100","dark:bg-neutral-800 dark:border-neutral-700","shadow-lg hover:shadow-xl"],outline:["bg-transparent border-2 border-neutral-200","dark:border-neutral-700","hover:border-primary-300 dark:hover:border-primary-600"],ghost:["bg-transparent border-none","hover:bg-neutral-50 dark:hover:bg-neutral-900/50"]},size:{sm:"p-4",default:"p-6",lg:"p-8",xl:"p-10"},radius:{none:"rounded-none",sm:"rounded-lg",default:"rounded-xl",lg:"rounded-2xl",full:"rounded-3xl"},interactive:{true:"cursor-pointer",false:""}},defaultVariants:{variant:"default",size:"default",radius:"default",interactive:!1}}),Pr=q.forwardRef(({className:t,variant:e,size:r,radius:n,interactive:i,hover:a=!1,loading:s=!1,children:o,ariaLabel:c,...l},u)=>d.jsx(L.div,{whileHover:i&&!s?{scale:a?1.02:1.01,y:a?-4:-2}:void 0,whileTap:i&&!s?{scale:.98}:void 0,transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe(H6({variant:e,size:r,radius:n,interactive:i}),s&&"animate-pulse",t),ref:u,...l,children:s?d.jsxs("div",{className:"space-y-4",children:[d.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded animate-shimmer"}),d.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded w-4/5 animate-shimmer"})]})]}):o}));Pr.displayName="Card";const Gd=q.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex flex-col space-y-1.5 pb-4",t),...e}));Gd.displayName="CardHeader";const Og=q.forwardRef(({className:t,...e},r)=>d.jsx("h3",{ref:r,className:Oe("text-xl font-semibold leading-tight text-neutral-900 dark:text-neutral-100",t),...e}));Og.displayName="CardTitle";const W6=q.forwardRef(({className:t,...e},r)=>d.jsx("p",{ref:r,className:Oe("text-sm text-neutral-600 dark:text-neutral-400 leading-relaxed",t),...e}));W6.displayName="CardDescription";const ti=q.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("",t),...e}));ti.displayName="CardContent";const ZA=q.forwardRef(({className:t,...e},r)=>d.jsx("div",{ref:r,className:Oe("flex items-center pt-4 mt-4 border-t border-neutral-200 dark:border-neutral-700",t),...e}));ZA.displayName="CardFooter";const To=new Set,jl=new Map,Rg=({src:t,alt:e,className:r="",fallback:n,onLoad:i,onError:a,priority:s=!1,sizes:o="(max-width: 768px) 100vw, 50vw",srcSet:c,blurDataUrl:l})=>{const[u,h]=w.useState(()=>To.has(t)),[m,p]=w.useState(!1),[v,b]=w.useState(s),g=w.useRef(null),_=w.useRef(null);w.useEffect(()=>{if(s)return;const j=new IntersectionObserver(([R])=>{R.isIntersecting&&(b(!0),j.disconnect())},{rootMargin:"50px",threshold:.1});return _.current&&j.observe(_.current),()=>j.disconnect()},[s]),w.useEffect(()=>{if(s&&!To.has(t)&&!jl.has(t)){const j=new Image;j.src=t,j.onload=()=>{To.add(t),jl.set(t,j)},j.onerror=()=>{jl.delete(t)},jl.set(t,j)}},[t,s]);const T=w.useCallback(()=>{To.add(t),h(!0),i?.()},[i,t]),E=w.useCallback(()=>{To.delete(t),p(!0),a?.()},[a,t]);return m&&n?d.jsx(d.Fragment,{children:n}):m?d.jsx("div",{className:`bg-gray-200 dark:bg-gray-700 flex items-center justify-center ${r}`,children:d.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})}):d.jsxs("div",{ref:_,className:`relative overflow-hidden ${r}`,style:{backgroundColor:"#f0f0f0"},children:[l&&d.jsx("img",{src:l,alt:"",className:"absolute inset-0 w-full h-full object-cover",style:{filter:"blur(10px)",transform:"scale(1.1)",opacity:u?0:1,transition:"opacity 0.3s ease-in-out"},"aria-hidden":"true"}),d.jsx(ke,{children:!u&&!l&&d.jsx(L.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-pulse"})}),v&&d.jsxs(L.picture,{initial:!1,animate:{opacity:u?1:0},children:[d.jsx("source",{type:"image/avif",srcSet:c||t}),d.jsx("source",{type:"image/webp",srcSet:c||t}),d.jsx("img",{ref:g,src:t,srcSet:c,alt:e,className:`w-full h-full object-cover ${u?"opacity-100":"opacity-0"}`,loading:s?"eager":"lazy",decoding:"async",fetchPriority:s?"high":"low",sizes:o,onLoad:T,onError:E,style:{transition:"opacity 0.3s ease-in-out, filter 0.3s ease-in-out",filter:u?"blur(0)":"blur(2px)"}})]})]})},QA=w.memo(({score:t,healthStatus:e,showDetailedStatus:r=!0,size:n="medium",animated:i=!0})=>{const s={small:{barWidth:"w-16",barHeight:"h-1.5",textSize:"text-xs",iconSize:"w-3 h-3",gap:"gap-1"},medium:{barWidth:"w-24",barHeight:"h-2",textSize:"text-xs",iconSize:"w-4 h-4",gap:"gap-2"},large:{barWidth:"w-32",barHeight:"h-3",textSize:"text-sm",iconSize:"w-5 h-5",gap:"gap-3"}}[n],o=()=>{const l=`${s.iconSize} mr-1`;return t>=80?d.jsx(er,{className:`${l} text-green-400`}):t>=60?d.jsx(_a,{className:`${l} text-yellow-400`}):t>=40?d.jsx(Ec,{className:`${l} text-orange-400`}):d.jsx(Tn,{className:`${l} text-red-400`})};return d.jsxs("div",{className:`flex items-center ${s.gap} w-full`,children:[d.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[d.jsx("div",{className:`relative ${s.barWidth} ${s.barHeight} bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden`,children:i?d.jsx(L.div,{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.5,ease:"easeOut"}}):d.jsx("div",{className:`absolute top-0 left-0 h-full rounded-full ${e.color}`,style:{width:`${t}%`}})}),d.jsxs("span",{className:`${s.textSize} font-semibold text-neutral-500 dark:text-neutral-400`,children:[t,"%"]})]}),r&&d.jsxs("div",{className:`flex items-center ${s.gap.replace("gap-","gap-1")} ${s.textSize} px-2 py-0.5 rounded-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700`,children:[o(),d.jsx("span",{className:e.textColor,children:e.status})]})]})});QA.displayName="PlantHealthIndicator";const K6=(t,e)=>{const r=sr(),n=pd(),i=w.useMemo(()=>{const h=t.lastWatered&&t.wateringFrequency?new Date().getTime()-new Date(t.lastWatered).getTime()>t.wateringFrequency*24*60*60*1e3:!t.lastWatered,m=t.lastWatered?Math.floor((new Date().getTime()-new Date(t.lastWatered).getTime())/(24*60*60*1e3)):0,p=t.healthScore>=80,v=G6(t.healthScore,h,m);return{needsWatering:h,isFavorite:p,daysSinceWatered:m,healthStatus:v}},[t.lastWatered,t.wateringFrequency,t.healthScore]),a=w.useCallback(async()=>{try{await n.prefetchQuery({queryKey:["plant",t.id],queryFn:async()=>{const{supabase:h}=await _p(async()=>{const{supabase:v}=await Promise.resolve().then(()=>aV);return{supabase:v}},void 0),{data:m,error:p}=await h.from("plants").select(`
              *,
              plant_images(*)
            `).eq("id",t.id).single();if(p)throw p.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");return m},staleTime:5*60*1e3})}catch(h){console.warn("Failed to prefetch plant data:",h)}},[t.id,n]),s=w.useCallback(()=>{r(vt.toPlantDetail(t.id))},[r,t.id]),o=w.useCallback(()=>{r(vt.toPlantChat(t.id))},[r,t.id]),c=w.useCallback(()=>{s()},[s]),l=w.useCallback(()=>{a()},[a]);return{state:i,actions:{handleClick:c,handleMouseEnter:l,prefetchPlantData:a,navigateToPlant:s,navigateToChat:o},plant:t}};function G6(t,e,r){let n;if(t>=80?n={color:"bg-green-400",textColor:"text-green-600 dark:text-green-400",status:"Excelente",priority:"low"}:t>=60?n={color:"bg-yellow-300",textColor:"text-yellow-600 dark:text-yellow-400",status:"Buena",priority:"medium"}:n={color:"bg-red-300",textColor:"text-red-600 dark:text-red-400",status:"Atención",priority:"high"},e){if(r>7)return{...n,color:"bg-red-400",textColor:"text-red-700 dark:text-red-300",status:"Necesita agua urgente",priority:"high"};if(r>3)return{...n,color:"bg-orange-400",textColor:"text-orange-700 dark:text-orange-300",status:"Necesita agua",priority:"medium"}}return n}const Y6=t=>({src:t.profileImageUrl||"/placeholder-plant.jpg",alt:`${t.name} - ${t.species}`,className:"w-full h-48 object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),Z6=t=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:Math.min(t*.1,.5)},whileHover:{y:-4,transition:{duration:.2}},whileTap:{scale:.98,transition:{duration:.1}}}),XA=w.memo(({plant:t,index:e})=>{const{state:r,actions:n}=K6(t),{needsWatering:i,isFavorite:a,healthStatus:s}=r,{handleClick:o,handleMouseEnter:c}=n,l=Y6(t),u=Z6(e);return d.jsx(L.div,{...u,className:"group",children:d.jsxs(Pr,{variant:"glass",size:"sm",radius:"lg",interactive:!0,hover:!0,onClick:o,onMouseEnter:c,className:"overflow-hidden border border-green-200/60 hover:border-green-300/80 dark:hover:border-green-600 transition-all duration-300 p-4 mb-4 shadow-sm hover:shadow-lg hover:shadow-green-100/30 bg-white/80 backdrop-blur-sm",children:[d.jsx(Gd,{className:"pb-2 flex-shrink-0 space-y-0",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsxs("div",{className:"relative w-20 h-20 rounded-[8px] overflow-hidden bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-950 dark:to-primary-900 flex-shrink-0 border border-primary-200 dark:border-primary-800",children:[d.jsx(Rg,{...l,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",priority:e<4,sizes:"(max-width: 768px) 20vw, 10vw",fallback:d.jsx("div",{className:"w-full h-full flex items-center justify-center text-primary-400 dark:text-primary-600",children:d.jsx(_a,{size:24})})}),d.jsx(ke,{children:a&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -top-1 -right-1 w-6 h-6 bg-error-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(hE,{size:12,className:"text-white fill-current"})})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"absolute -bottom-1 -right-1 w-6 h-6 bg-warning-500 rounded-full flex items-center justify-center shadow-lg",children:d.jsx(L.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:d.jsx(Ec,{size:12,className:"text-white"})})})})]}),d.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[d.jsx(Og,{className:"text-2xl font-bold text-neutral-900 dark:text-neutral-100 truncate mb-0 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors",title:t.nickname||t.name,children:t.nickname||t.name}),d.jsx("p",{className:"text-xs text-[#555] truncate mb-[6px]",title:t.species,children:t.species}),d.jsx("div",{className:"flex items-center text-xs text-neutral-500 dark:text-neutral-500",children:d.jsxs("span",{className:"px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded-md",children:["📍 ",t.location]})})]})]})}),d.jsxs(ti,{className:"pt-2 pb-0",children:[d.jsx(QA,{score:t.healthScore,healthStatus:s,size:"medium",animated:!0}),t.healthScore<40&&d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 bg-error-100 text-error-700 dark:bg-error-900/30 dark:text-error-300 rounded-full text-xs font-semibold",children:[d.jsx(Tn,{className:"w-3 h-3 mr-1","aria-label":"Atención"}),"¡Atención!"]}),d.jsx("span",{className:"text-xs text-error-600 dark:text-error-300",children:"Salud muy baja"})]})]}),d.jsx(L.div,{className:"absolute inset-0 bg-gradient-to-t from-primary-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",initial:!1})]})})});XA.displayName="PlantCard";function pe({className:t,...e}){return d.jsx("div",{className:Oe("animate-shimmer rounded-md","bg-[linear-gradient(110deg,var(--color-neutral-200)_8%,var(--color-neutral-300)_18%,var(--color-neutral-200)_33%)]","dark:bg-[linear-gradient(110deg,var(--color-neutral-800)_8%,var(--color-neutral-700)_18%,var(--color-neutral-800)_33%)]","bg-[length:200%_100%]",t),...e})}const Q6=()=>d.jsxs(Pr,{variant:"elevated",size:"default",className:"overflow-hidden",children:[d.jsxs("div",{className:"flex items-start p-4 space-x-4",children:[d.jsx(pe,{className:"w-20 h-20 rounded-lg flex-shrink-0"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsxs(Gd,{className:"p-0",children:[d.jsx(pe,{className:"h-6 w-3/4"}),d.jsx(pe,{className:"h-4 w-1/2 mt-2"})]}),d.jsx(ti,{className:"p-0 mt-3",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(pe,{className:"w-16 h-1.5"}),d.jsx(pe,{className:"w-8 h-3"})]})})]})]}),d.jsx(ZA,{className:"bg-neutral-50 dark:bg-neutral-800/50 p-2 border-t border-subtle",children:d.jsxs("div",{className:"flex justify-between items-center w-full",children:[d.jsx(pe,{className:"h-4 w-1/3"}),d.jsx(pe,{className:"w-8 h-8 rounded"})]})})]}),X6=jg("touch-target inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:["bg-gradient-to-r from-green-600 to-emerald-600 text-white","hover:from-green-700 hover:to-emerald-700","active:from-green-800 active:to-emerald-800","focus-visible:ring-green-500/30","shadow-lg shadow-green-200/30 hover:shadow-xl hover:shadow-green-300/40","disabled:bg-neutral-300 disabled:text-neutral-500","dark:from-green-500 dark:to-emerald-500 dark:hover:from-green-400 dark:hover:to-emerald-400","transform hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"],secondary:["bg-neutral-100 text-neutral-800 border border-neutral-300","hover:bg-neutral-200 hover:border-neutral-400","active:bg-neutral-300","focus-visible:ring-neutral-500/30","dark:bg-neutral-800 dark:text-neutral-100 dark:border-neutral-600","dark:hover:bg-neutral-700 dark:hover:border-neutral-500","shadow-sm hover:shadow-md"],outline:["bg-white text-neutral-800 border-2 border-neutral-800","hover:bg-neutral-50 hover:text-neutral-900","active:bg-neutral-100","focus-visible:ring-primary-500/30","dark:bg-neutral-950 dark:text-neutral-100 dark:border-neutral-200","dark:hover:bg-neutral-900 dark:hover:text-neutral-50"],ghost:["bg-transparent text-neutral-700 border border-transparent","hover:bg-neutral-100 hover:text-neutral-800","active:bg-neutral-200","focus-visible:ring-neutral-500/30","dark:text-neutral-300 dark:hover:bg-neutral-800 dark:hover:text-neutral-200","dark:active:bg-neutral-700"],destructive:["bg-error-600 text-white","hover:bg-error-700","active:bg-error-800","focus-visible:ring-error-500/30","shadow-md hover:shadow-lg","dark:bg-error-500 dark:text-black"],success:["bg-success-600 text-white","hover:bg-success-700","active:bg-success-800","focus-visible:ring-success-500/30","shadow-md hover:shadow-lg","dark:bg-success-500 dark:text-black"],warning:["bg-warning-600 text-white","hover:bg-warning-700","active:bg-warning-800","focus-visible:ring-warning-500/30","shadow-md hover:shadow-lg","dark:bg-warning-500 dark:text-black"],glass:["glass-enhanced text-neutral-800 border border-contrast","hover:backdrop-blur-xl hover:bg-contrast-surface","active:scale-[0.98]","focus-visible:ring-primary-500/30","dark:text-neutral-100"]},size:{xs:"h-8 px-3 text-xs rounded-md",sm:"h-10 px-4 text-sm rounded-lg",default:"h-11 px-6 text-base rounded-xl",lg:"h-12 px-8 text-lg rounded-xl",xl:"h-14 px-10 text-xl rounded-2xl",icon:"h-11 w-11 rounded-xl","icon-sm":"h-10 w-10 rounded-lg","icon-lg":"h-12 w-12 rounded-xl"},fullWidth:{true:"w-full",false:"w-auto"}},defaultVariants:{variant:"primary",size:"default",fullWidth:!1}}),me=q.forwardRef(({className:t,variant:e,size:r,fullWidth:n,loading:i=!1,leftIcon:a,rightIcon:s,children:o,disabled:c,...l},u)=>{const h=c||i;return d.jsxs(L.button,{whileTap:h?void 0:{scale:.96},whileHover:h?void 0:{scale:1.02},transition:{duration:.15,ease:[.4,0,.2,1]},className:Oe(X6({variant:e,size:r,fullWidth:n,className:t})),disabled:h,ref:u,...l,children:[i&&d.jsx(L.div,{className:"mr-2",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",children:[d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"32",strokeDashoffset:"32",opacity:"0.3"}),d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})]})}),a&&!i&&d.jsx("span",{className:"mr-2 -ml-1",children:a}),d.jsx("span",{className:Oe("flex items-center justify-center",i&&"opacity-70"),"aria-hidden":i?"true":void 0,children:Array.isArray(o)?o.filter(m=>typeof m=="string"||typeof m=="number"||q.isValidElement(m)):typeof o=="string"||typeof o=="number"||q.isValidElement(o)?o:null}),s&&d.jsx("span",{className:"ml-2 -mr-1",children:s})]})});me.displayName="Button";const J6=jg("w-full transition-all duration-200 outline-none disabled:cursor-not-allowed disabled:opacity-50",{variants:{variant:{default:["bg-white border border-neutral-300","dark:bg-neutral-900 dark:border-neutral-600","focus:border-primary-500 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],filled:["bg-neutral-100 border border-transparent","dark:bg-neutral-800 dark:border-transparent","focus:bg-white focus:border-primary-500","dark:focus:bg-neutral-900 dark:focus:border-primary-400","focus:ring-2 focus:ring-primary-500/20"],glass:["glass border-neutral-200/50","dark:border-neutral-700/50","focus:border-primary-500/70 dark:focus:border-primary-400/70","focus:ring-2 focus:ring-primary-500/20"]},size:{sm:"h-10 px-3 text-sm rounded-lg",default:"h-12 px-4 text-base rounded-xl",lg:"h-14 px-5 text-lg rounded-xl"},state:{default:"",error:"border-error-500 focus:border-error-500 focus:ring-error-500/20",success:"border-success-500 focus:border-success-500 focus:ring-success-500/20",warning:"border-warning-500 focus:border-warning-500 focus:ring-warning-500/20"}},defaultVariants:{variant:"default",size:"default",state:"default"}}),Yd=q.forwardRef(({className:t,variant:e,size:r,state:n,label:i,helperText:a,errorMessage:s,successMessage:o,leftIcon:c,rightIcon:l,loading:u=!1,showPasswordToggle:h=!1,floatingLabel:m=!1,type:p,disabled:v,value:b,defaultValue:g,..._},T)=>{const[E,j]=w.useState(!1),[R,D]=w.useState(!1),[I,A]=w.useState(b||g||""),P=w.useRef(null),O=w.useCallback(he=>{P.current=he,typeof T=="function"?T(he):T&&(T.current=he)},[T]),N=s?"error":o?"success":n,C=!!I||E,k=h?R?"text":"password":p;w.useEffect(()=>{b!==void 0&&A(b)},[b]);const J=he=>{j(!0),_.onFocus?.(he)},oe=he=>{j(!1),_.onBlur?.(he)},X=he=>{A(he.target.value),_.onChange?.(he)},te=()=>{P.current?.focus()};return d.jsxs("div",{className:"w-full",children:[d.jsxs("div",{className:"relative",children:[i&&!m&&d.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2",children:i}),d.jsxs("div",{className:"relative",children:[c&&d.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10",children:c}),i&&m&&d.jsx(L.label,{onClick:te,animate:{scale:C?.85:1,y:C?-24:0,x:C?4:c?36:16},transition:{duration:.2,ease:[.4,0,.2,1]},className:Oe("absolute left-0 top-1/2 -translate-y-1/2 text-neutral-500 dark:text-neutral-400 pointer-events-none z-10 origin-left",C&&"text-primary-600 dark:text-primary-400","cursor-text"),children:i}),d.jsx("input",{ref:O,type:k,value:I,disabled:v||u,className:Oe(J6({variant:e,size:r,state:N}),c&&"pl-10",(l||h||u)&&"pr-10",m&&C&&"pt-6 pb-2",(!r||r==="default")&&"py-[12px]","placeholder-[#777]",t),style:{..._.style},onFocus:J,onBlur:oe,onChange:X,..._}),d.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center space-x-1",children:[u&&d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-4 h-4 text-neutral-500",children:d.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"w-full h-full",children:d.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeDasharray:"8",strokeDashoffset:"8"})})}),!u&&N==="error"&&d.jsx(Jr,{className:"w-4 h-4 text-error-500"}),!u&&N==="success"&&d.jsx(Si,{className:"w-4 h-4 text-success-500"}),h&&!u&&d.jsx("button",{type:"button",onClick:()=>D(!R),className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200 transition-colors",tabIndex:-1,children:R?d.jsx(vN,{className:"w-4 h-4"}):d.jsx(Hf,{className:"w-4 h-4"})}),l&&!u&&d.jsx("div",{className:"text-neutral-500 dark:text-neutral-400",children:l})]})]}),d.jsx(ke,{children:E&&d.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:Oe("absolute inset-0 rounded-xl pointer-events-none",N==="error"&&"ring-2 ring-error-500/20",N==="success"&&"ring-2 ring-success-500/20",N==="default"&&"ring-2 ring-primary-500/20")})})]}),d.jsx(ke,{mode:"wait",children:(a||s||o)&&d.jsxs(L.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2},className:"mt-2 text-sm flex items-center space-x-1",children:[s&&d.jsxs(d.Fragment,{children:[d.jsx(Jr,{className:"w-4 h-4 text-error-500 flex-shrink-0"}),d.jsx("span",{className:"text-error-600 dark:text-error-400",children:s})]}),o&&!s&&d.jsxs(d.Fragment,{children:[d.jsx(Si,{className:"w-4 h-4 text-success-500 flex-shrink-0"}),d.jsx("span",{className:"text-success-600 dark:text-success-400",children:o})]}),a&&!s&&!o&&d.jsx("span",{className:"text-neutral-600 dark:text-neutral-400",children:a})]})})]})});Yd.displayName="Input";const ez={default:wa,ai:pE,camera:Yn,upload:mE,download:_N,sync:wN,search:xN,save:bN,delete:fE,chat:Tc},tz={sm:{icon:"w-4 h-4",text:"text-sm",gap:"gap-2"},md:{icon:"w-5 h-5",text:"text-base",gap:"gap-3"},lg:{icon:"w-6 h-6",text:"text-lg",gap:"gap-4"}},rz=({message:t,type:e="default",size:r="md",className:n=""})=>{const i=ez[e],a=tz[r];return d.jsxs("div",{className:`flex items-center justify-center ${a.gap} ${n}`,children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"flex-shrink-0",children:d.jsx(i,{className:`${a.icon} text-primary-500`})}),d.jsx("span",{className:`${a.text} text-gray-600 dark:text-gray-400 font-medium`,children:t})]})},nz={LoadingPlants:t=>d.jsx(rz,{message:"Cargando tu jardín...",type:"default",...t})},Rm=({children:t,content:e,position:r="top",delay:n=300,disabled:i=!1,className:a=""})=>{const[s,o]=w.useState(!1),[c,l]=w.useState({x:0,y:0}),u=w.useRef(null),h=w.useRef(),m=()=>{i||(h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{if(u.current){const g=u.current.getBoundingClientRect(),_=window.pageYOffset||document.documentElement.scrollTop,T=window.pageXOffset||document.documentElement.scrollLeft;let E,j;switch(r){case"top":E=g.left+T+g.width/2,j=g.top+_-8;break;case"bottom":E=g.left+T+g.width/2,j=g.bottom+_+8;break;case"left":E=g.left+T-8,j=g.top+_+g.height/2;break;case"right":E=g.right+T+8,j=g.top+_+g.height/2;break;default:E=g.left+T+g.width/2,j=g.top+_-8}l({x:E,y:j}),o(!0)}},n))},p=()=>{h.current&&clearTimeout(h.current),o(!1)};w.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const v=()=>{const g="absolute z-[9999] px-2 py-1 text-xs font-medium text-white bg-gray-900 dark:bg-gray-700 rounded-md shadow-lg pointer-events-none max-w-xs";switch(r){case"top":return`${g} -translate-x-1/2 -translate-y-full`;case"bottom":return`${g} -translate-x-1/2`;case"left":return`${g} -translate-x-full -translate-y-1/2`;case"right":return`${g} -translate-y-1/2`;default:return`${g} -translate-x-1/2 -translate-y-full`}},b=()=>{const g="absolute w-2 h-2 bg-gray-900 dark:bg-gray-700 transform rotate-45";switch(r){case"top":return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`;case"bottom":return`${g} left-1/2 -translate-x-1/2 -top-1`;case"left":return`${g} top-1/2 -translate-y-1/2 left-full -translate-x-1/2`;case"right":return`${g} top-1/2 -translate-y-1/2 -left-1`;default:return`${g} left-1/2 -translate-x-1/2 top-full -translate-y-1/2`}};return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:u,onMouseEnter:m,onMouseLeave:p,onFocus:m,onBlur:p,className:`inline-block ${a}`,children:t}),typeof document<"u"&&wp.createPortal(d.jsx(ke,{children:s&&d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.15},className:v(),style:{left:c.x,top:c.y},children:[e,d.jsx("div",{className:b()})]})}),document.body)]})},iz={network:{icon:dE,color:"text-orange-500",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Verificar conexión",action:"help"}]},validation:{icon:Tn,color:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",borderColor:"border-amber-200 dark:border-amber-800",defaultActions:[{label:"Corregir",action:"retry"}]},server:{icon:Tn,color:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",borderColor:"border-red-200 dark:border-red-800",defaultActions:[{label:"Reintentar",action:"retry"},{label:"Reportar problema",action:"help"}]},unknown:{icon:EN,color:"text-gray-500",bgColor:"bg-gray-50 dark:bg-gray-900/20",borderColor:"border-gray-200 dark:border-gray-800",defaultActions:[{label:"Reintentar",action:"retry"}]}},az=({title:t,message:e,type:r="unknown",onRetry:n,onDismiss:i,actions:a,className:s=""})=>{const o=iz[r],c=o.icon,l=h=>{switch(h){case"retry":n?.();break;case"help":console.log("Help requested for error type:",r);break}},u=()=>a?a.map((h,m)=>d.jsx(me,{variant:h.variant||"outline",size:"sm",onClick:h.onClick,children:h.label},m)):o.defaultActions.map((h,m)=>d.jsxs(me,{variant:m===0?"primary":"outline",size:"sm",onClick:()=>l(h.action),disabled:h.action==="retry"&&!n,children:[h.action==="retry"&&d.jsx(Oi,{className:"w-4 h-4 mr-1"}),h.action==="help"&&d.jsx(TN,{className:"w-4 h-4 mr-1"}),h.label]},m));return d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`
        ${o.bgColor} 
        ${o.borderColor} 
        border rounded-lg p-4 
        ${s}
      `,children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:`${o.color} flex-shrink-0 mt-0.5`,children:d.jsx(c,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:t}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e}),d.jsx("div",{className:"flex flex-wrap gap-2",children:u()})]}),i&&d.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar error",children:d.jsx(Wi,{className:"w-4 h-4"})})]})})},sz={LoadingPlantsError:t=>d.jsx(az,{type:"server",title:"Error al Cargar Plantas",message:"No se pudieron cargar tus plantas. Intenta refrescar la página.",...t})},oz=({isOpen:t,onComplete:e,onSkip:r,steps:n})=>{const[i,a]=w.useState(0),[s,o]=w.useState(null),[c,l]=w.useState({x:0,y:0}),u=n[i],h=i===n.length-1,m=i===0;w.useEffect(()=>{if(!t||!u?.target)return;const g=document.querySelector(u.target);if(g){o(g);const _=g.getBoundingClientRect(),T=window.pageYOffset||document.documentElement.scrollTop,E=window.pageXOffset||document.documentElement.scrollLeft;let j,R;switch(u.position){case"top":j=_.left+E+_.width/2,R=_.top+T-20;break;case"bottom":j=_.left+E+_.width/2,R=_.bottom+T+20;break;case"left":j=_.left+E-20,R=_.top+T+_.height/2;break;case"right":j=_.right+E+20,R=_.top+T+_.height/2;break;default:j=window.innerWidth/2,R=window.innerHeight/2}l({x:j,y:R}),g.scrollIntoView({behavior:"smooth",block:"center"})}else o(null),l({x:window.innerWidth/2,y:window.innerHeight/2})},[t,u,i]);const p=()=>{h?e():a(g=>g+1)},v=()=>{m||a(g=>g-1)},b=()=>{if(!u?.position||u.position==="center")return"-translate-x-1/2 -translate-y-1/2";switch(u.position){case"top":return"-translate-x-1/2 -translate-y-full";case"bottom":return"-translate-x-1/2";case"left":return"-translate-x-full -translate-y-1/2";case"right":return"-translate-y-1/2";default:return"-translate-x-1/2 -translate-y-1/2"}};return t?d.jsx(ke,{children:d.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60"}),s&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute pointer-events-none",style:{left:s.getBoundingClientRect().left+window.pageXOffset,top:s.getBoundingClientRect().top+window.pageYOffset,width:s.getBoundingClientRect().width,height:s.getBoundingClientRect().height,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(34, 197, 94, 0.5)",borderRadius:"8px"}}),d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:`absolute bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 max-w-sm ${b()}`,style:{left:c.x,top:c.y},children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(er,{className:"w-5 h-5 text-green-500"}),d.jsxs("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:["Paso ",i+1," de ",n.length]})]}),d.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Omitir tour",children:d.jsx(Wi,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:u.title}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:u.description})]}),u.action&&d.jsx("div",{className:"mb-4",children:d.jsx(me,{variant:"outline",size:"sm",onClick:u.action.onClick,className:"w-full",children:u.action.label})}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs(me,{variant:"ghost",size:"sm",onClick:v,disabled:m,className:"flex items-center gap-1",children:[d.jsx(gE,{className:"w-4 h-4"}),"Anterior"]}),d.jsx("div",{className:"flex gap-1",children:n.map((g,_)=>d.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${_===i?"bg-green-500":_<i?"bg-green-300":"bg-gray-300"}`},_))}),d.jsxs(me,{size:"sm",onClick:p,className:"flex items-center gap-1",children:[h?"Finalizar":"Siguiente",!h&&d.jsx(yE,{className:"w-4 h-4"})]})]}),d.jsx("div",{className:"mt-4 text-center",children:d.jsx("button",{onClick:r,className:"text-xs text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Omitir tour"})})]})]})}):null},Ol="1.0.0",Ex="plantitas-onboarding-state",cz=()=>{const t=sr(),[e,r]=w.useState(()=>{try{const u=localStorage.getItem(Ex);if(u){const h=JSON.parse(u);return h.currentVersion!==Ol?{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Ol}:h}}catch(u){console.warn("Error loading onboarding state:",u)}return{hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Ol}});w.useEffect(()=>{try{localStorage.setItem(Ex,JSON.stringify(e))}catch(u){console.warn("Error saving onboarding state:",u)}},[e]);const n=u=>{r(h=>({...h,...u}))};return{state:e,shouldShowTour:()=>!e.hasCompletedTour,completeTour:()=>{n({hasCompletedTour:!0})},markFirstPlantAdded:()=>{n({hasAddedFirstPlant:!0})},markChatUsed:()=>{n({hasUsedChat:!0})},resetOnboarding:()=>{r({hasCompletedTour:!1,hasAddedFirstPlant:!1,hasUsedChat:!1,currentVersion:Ol})},getTourSteps:()=>[{id:"welcome",title:"¡Bienvenido a Plantitas! 🌱",description:"Tu asistente personal para el cuidado de plantas. Te ayudaremos a mantener tus plantas saludables y felices.",position:"center"},{id:"add-plant",title:"Agrega tu primera planta",description:"Usa el botón flotante para tomar una foto de tu planta. Nuestra IA la identificará automáticamente.",target:'[data-tour="add-plant-fab"]',position:"left",action:{label:"Ir a cámara",onClick:()=>t(vt.toCamera())}},{id:"navigation",title:"Navegación principal",description:"Usa la navegación inferior para moverte entre el jardín, chat IA y configuraciones.",target:'[data-tour="bottom-navigation"]',position:"top"},{id:"chat-ai",title:"Chat con IA experta",description:"Haz preguntas sobre cuidado de plantas, identificación o cualquier duda que tengas.",target:'[data-tour="chat-tab"]',position:"top",action:{label:"Probar chat",onClick:()=>t(vt.toGardenChat())}},{id:"search-filter",title:"Busca y organiza",description:"Usa la búsqueda y filtros para encontrar rápidamente tus plantas cuando tengas muchas.",target:'[data-tour="search-input"]',position:"bottom"},{id:"complete",title:"¡Listo para empezar! 🎉",description:"Ya conoces lo básico. ¡Comienza agregando tu primera planta y explorando todas las funciones!",position:"center"}]}},Tx=({type:t,title:e,message:r,onDismiss:n,autoHide:i=!1,duration:a=8e3,actions:s})=>{const[o,c]=w.useState(!0),l=sr();w.useEffect(()=>{if(i&&a>0){const v=setTimeout(()=>{c(!1),n?.()},a);return()=>clearTimeout(v)}},[i,a,n]);const u=()=>{c(!1),n?.()};if(!o)return null;const m={suggestion:{bg:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-200 dark:border-purple-800",accent:"text-purple-600 dark:text-purple-400",icon:pE},tip:{bg:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-200 dark:border-blue-800",accent:"text-blue-600 dark:text-blue-400",icon:er},welcome:{bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",accent:"text-green-600 dark:text-green-400",icon:Tc}}[t],p=m.icon;return d.jsx(ke,{children:d.jsxs(L.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:`
          ${m.bg} ${m.border}
          border rounded-lg p-4 shadow-md backdrop-blur-sm
          relative overflow-hidden
        `,children:[d.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 opacity-10",children:d.jsx(p,{className:"w-full h-full"})}),d.jsxs("div",{className:"relative flex items-start gap-3",children:[d.jsx("div",{className:`${m.accent} flex-shrink-0 mt-0.5`,children:d.jsx(p,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:`${m.accent} text-sm font-semibold mb-1`,children:e}),d.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-3",children:r}),d.jsx("div",{className:"flex flex-wrap gap-2",children:s?s.map((v,b)=>d.jsx(me,{size:"sm",variant:v.variant||"outline",onClick:v.onClick,className:"text-xs",children:v.label},b)):d.jsxs(me,{size:"sm",variant:"outline",onClick:()=>l(vt.toGardenChat()),className:"text-xs flex items-center gap-1",children:["Probar Chat IA",d.jsx(AN,{className:"w-3 h-3"})]})})]}),n&&d.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1 flex-shrink-0","aria-label":"Cerrar sugerencia",children:d.jsx(Wi,{className:"w-4 h-4"})})]}),i&&a>0&&d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/10 dark:bg-white/10",children:d.jsx(L.div,{initial:{width:"100%"},animate:{width:"0%"},transition:{duration:a/1e3,ease:"linear"},className:`h-full ${m.accent.replace("text-","bg-")}`})})]})})},lz=()=>{const[t,e]=w.useState(()=>{try{const a=localStorage.getItem("dismissed-ai-highlights");return a?JSON.parse(a):[]}catch{return[]}});return{dismissHighlight:a=>{const s=[...t,a];e(s);try{localStorage.setItem("dismissed-ai-highlights",JSON.stringify(s))}catch(o){console.warn("Error saving dismissed highlights:",o)}},shouldShowHighlight:a=>!t.includes(a),resetHighlights:()=>{e([]);try{localStorage.removeItem("dismissed-ai-highlights")}catch(a){console.warn("Error resetting highlights:",a)}}}},uz=()=>{const t=sr();return d.jsxs(L.div,{className:"flex flex-col items-center justify-center text-center py-16 px-6 max-w-lg mx-auto",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},children:[d.jsxs(L.div,{className:"relative w-32 h-32 mb-8",initial:{rotate:-15},animate:{rotate:[15,-10,10,-5,5,0]},transition:{duration:1,ease:"easeInOut"},children:[d.jsx(vE,{className:"absolute top-2 left-2 w-10 h-10 text-sky-400 opacity-60"}),d.jsx(gd,{className:"w-32 h-32 text-green-500"}),d.jsx(Ec,{className:"absolute bottom-2 right-2 w-12 h-12 text-blue-400 opacity-70"})]}),d.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-3",children:"¡Comienza tu jardín digital!"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6 text-lg leading-relaxed",children:"Añade tu primera planta tomando una foto y deja que nuestra IA la identifique y te ayude a cuidarla."}),d.jsxs("div",{className:"mb-8 space-y-3 text-left",children:[d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Identificación automática con IA"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Recordatorios de riego personalizados"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-600 dark:text-gray-400",children:[d.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),d.jsx("span",{children:"Chat con asistente experto en plantas"})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[d.jsxs(me,{size:"lg",onClick:()=>t(vt.toCamera()),className:"flex-1",children:[d.jsx(Tp,{className:"mr-2"}),"Tomar Foto"]}),d.jsx(Rm,{content:"Explora las funciones de chat IA para aprender sobre plantas",children:d.jsxs(me,{size:"lg",variant:"outline",onClick:()=>t(vt.toGardenChat()),className:"flex-1",children:[d.jsx(Tc,{className:"mr-2"}),"Explorar Chat IA"]})})]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-6",children:"💡 Tip: Toma fotos con buena iluminación para mejores resultados"})]})},dz=()=>{const{data:t=[],isLoading:e,error:r}=q6(),[n,i]=w.useState(""),[a,s]=w.useState("name"),{shouldShowTour:o,completeTour:c,getTourSteps:l}=cz(),{shouldShowHighlight:u,dismissHighlight:h}=lz(),m=w.useMemo(()=>[...t].filter(p=>p.name.toLowerCase().includes(n.toLowerCase())||p.species.toLowerCase().includes(n.toLowerCase())).sort((p,v)=>{switch(a){case"health":return(v.healthScore||0)-(p.healthScore||0);case"lastWatered":return(v.lastWatered?.getTime()||0)-(p.lastWatered?.getTime()||0);default:return p.name.localeCompare(v.name)}}),[t,n,a]);return e?d.jsxs("div",{className:"p-4 sm:p-6 space-y-6",children:[d.jsxs("header",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100",children:"Mi Jardín"}),d.jsx(nz.LoadingPlants,{size:"sm"})]}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array.from({length:8}).map((p,v)=>d.jsx(Q6,{},v))})]}):r?d.jsx("div",{className:"flex justify-center items-center min-h-[50vh] p-4",children:d.jsx(sz.LoadingPlantsError,{onRetry:()=>window.location.reload(),className:"max-w-md"})}):d.jsxs("div",{className:"container-spacing element-spacing bg-gradient-to-br from-green-50/30 via-white to-emerald-50/20 min-h-screen",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx("header",{className:"flex items-center justify-between border-b border-green-100/50 bg-white/70 backdrop-blur-sm pb-4 mb-6 rounded-xl px-4 py-3 shadow-sm shadow-green-100/20",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Rm,{content:"Tu jardín personal de plantas",children:d.jsx(gd,{size:20,strokeWidth:2,className:"text-[#2A7F3E] flex-shrink-0"})}),d.jsx("h1",{className:"font-semibold text-[28px] leading-[1.2] text-[#222]",children:"Mi Jardín"}),d.jsx(Rm,{content:`Tienes ${t.length} ${t.length===1?"planta registrada":"plantas registradas"} en tu jardín`,children:d.jsxs("span",{className:"ml-2 bg-[#E0F2E9]/50 text-[#2A7F3E] text-sm font-medium rounded-full px-[6px] py-[2px] cursor-help",children:[t.length," ",t.length===1?"planta":"plantas"]})})]})}),t.length>0&&u("dashboard-ai-welcome")&&d.jsx("div",{className:"mb-4",children:d.jsx(Tx,{type:"welcome",title:"¡Tu asistente IA está disponible!",message:"Haz preguntas sobre el cuidado de tus plantas, identifica problemas o descubre nuevos consejos.",onDismiss:()=>h("dashboard-ai-welcome"),autoHide:!0,duration:1e4})}),t.length>=3&&u("dashboard-ai-tips")&&d.jsx("div",{className:"mb-4",children:d.jsx(Tx,{type:"tip",title:"Consejo del jardinero experto",message:"Con varias plantas, puedes preguntarme sobre rutinas de cuidado personalizadas para optimizar tu tiempo.",onDismiss:()=>h("dashboard-ai-tips"),autoHide:!0,duration:12e3})}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3 mt-6 mb-6",children:[d.jsx(Yd,{type:"text",placeholder:"Buscar por nombre o especie...",value:n,onChange:p=>i(p.target.value),className:"max-w-md w-full mx-auto","data-tour":"search-input"}),d.jsxs("div",{className:"relative w-full max-w-xs",children:[d.jsxs("select",{value:a,onChange:p=>s(p.target.value),className:"appearance-none bg-white border border-green-300 rounded-[8px] px-4 py-2 h-10 text-green-700 font-medium shadow-sm focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors duration-150 w-full pr-8",style:{borderWidth:"1px"},children:[d.jsx("option",{value:"name",children:"Ordenar por Nombre"}),d.jsx("option",{value:"health",children:"Ordenar por Salud"}),d.jsx("option",{value:"lastWatered",children:"Ordenar por Riego"})]}),d.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-green-400 text-base",children:"▼"})]})]}),d.jsx(ke,{children:m.length>0?d.jsx(L.div,{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 element-spacing card--responsive",initial:"hidden",animate:"visible",variants:{visible:{transition:{staggerChildren:.01,delayChildren:0}}},children:m.map((p,v)=>d.jsx(XA,{plant:p,index:Math.min(v,8)},p.id))}):d.jsx(uz,{})}),d.jsx(oz,{isOpen:o()&&t.length===0,onComplete:c,onSkip:c,steps:l()})]})};function Dm(t){"@babel/helpers - typeof";return Dm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dm(t)}function fr(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function At(t){fr(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||Dm(t)==="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var hz={};function fz(){return hz}function Du(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function Ax(t){fr(1,arguments);var e=At(t);return e.setHours(0,0,0,0),e}var mz=864e5;function pz(t,e){fr(2,arguments);var r=Ax(t),n=Ax(e),i=r.getTime()-Du(r),a=n.getTime()-Du(n);return Math.round((i-a)/mz)}function su(t,e){fr(2,arguments);var r=At(t),n=At(e),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function gz(t,e){fr(2,arguments);var r=At(t),n=At(e),i=r.getFullYear()-n.getFullYear(),a=r.getMonth()-n.getMonth();return i*12+a}function Ix(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function yz(t,e){fr(2,arguments);var r=At(t),n=At(e),i=Ix(r,n),a=Math.abs(pz(r,n));r.setDate(r.getDate()-i*a);var s=+(Ix(r,n)===-i),o=i*(a-s);return o===0?0:o}function vz(t,e){return fr(2,arguments),At(t).getTime()-At(e).getTime()}var bz={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},xz="trunc";function wz(t){return bz[xz]}function _z(t){fr(1,arguments);var e=At(t);return e.setHours(23,59,59,999),e}function Ez(t){fr(1,arguments);var e=At(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function Tz(t){fr(1,arguments);var e=At(t);return _z(e).getTime()===Ez(e).getTime()}function Az(t,e){fr(2,arguments);var r=At(t),n=At(e),i=su(r,n),a=Math.abs(gz(r,n)),s;if(a<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*a);var o=su(r,n)===-i;Tz(At(t))&&a===1&&su(t,n)===1&&(o=!1),s=i*(a-Number(o))}return s===0?0:s}function Iz(t,e,r){fr(2,arguments);var n=vz(t,e)/1e3;return wz()(n)}var Sz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Pz=function(e,r,n){var i,a=Sz[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function Ps(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.width?String(e.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var Cz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kz={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Nz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jz={date:Ps({formats:Cz,defaultWidth:"full"}),time:Ps({formats:kz,defaultWidth:"full"}),dateTime:Ps({formats:Nz,defaultWidth:"full"})},Oz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Rz=function(e,r,n,i){return Oz[e]};function dn(t){return function(e,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=r!=null&&r.width?String(r.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var o=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;i=t.values[c]||t.values[o]}var l=t.argumentCallback?t.argumentCallback(e):e;return i[l]}}var Dz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Mz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Lz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},$z={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Vz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Fz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zz=function(e,r){var n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Uz={ordinalNumber:zz,era:dn({values:Dz,defaultWidth:"wide"}),quarter:dn({values:Mz,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:dn({values:Lz,defaultWidth:"wide"}),day:dn({values:$z,defaultWidth:"wide"}),dayPeriod:dn({values:Vz,defaultWidth:"wide",formattingValues:Fz,defaultFormattingWidth:"wide"})};function hn(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],a=e.match(i);if(!a)return null;var s=a[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(o)?qz(o,function(h){return h.test(s)}):Bz(o,function(h){return h.test(s)}),l;l=t.valueCallback?t.valueCallback(c):c,l=r.valueCallback?r.valueCallback(l):l;var u=e.slice(s.length);return{value:l,rest:u}}}function Bz(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function qz(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}function JA(t){return function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.match(t.matchPattern);if(!n)return null;var i=n[0],a=e.match(t.parsePattern);if(!a)return null;var s=t.valueCallback?t.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;var o=e.slice(i.length);return{value:s,rest:o}}}var Hz=/^(\d+)(th|st|nd|rd)?/i,Wz=/\d+/i,Kz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Gz={any:[/^b/i,/^(a|c)/i]},Yz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Zz={any:[/1/i,/2/i,/3/i,/4/i]},Qz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Xz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Jz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},eU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},tU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},rU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},nU={ordinalNumber:JA({matchPattern:Hz,parsePattern:Wz,valueCallback:function(e){return parseInt(e,10)}}),era:hn({matchPatterns:Kz,defaultMatchWidth:"wide",parsePatterns:Gz,defaultParseWidth:"any"}),quarter:hn({matchPatterns:Yz,defaultMatchWidth:"wide",parsePatterns:Zz,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:hn({matchPatterns:Qz,defaultMatchWidth:"wide",parsePatterns:Xz,defaultParseWidth:"any"}),day:hn({matchPatterns:Jz,defaultMatchWidth:"wide",parsePatterns:eU,defaultParseWidth:"any"}),dayPeriod:hn({matchPatterns:tU,defaultMatchWidth:"any",parsePatterns:rU,defaultParseWidth:"any"})},iU={code:"en-US",formatDistance:Pz,formatLong:jz,formatRelative:Rz,localize:Uz,match:nU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function eI(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function aU(t){return eI({},t)}var Sx=1440,sU=2520,vf=43200,oU=86400;function cU(t,e,r){var n,i;fr(2,arguments);var a=fz(),s=(n=(i=r?.locale)!==null&&i!==void 0?i:a.locale)!==null&&n!==void 0?n:iU;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var o=su(t,e);if(isNaN(o))throw new RangeError("Invalid time value");var c=eI(aU(r),{addSuffix:!!r?.addSuffix,comparison:o}),l,u;o>0?(l=At(e),u=At(t)):(l=At(t),u=At(e));var h=Iz(u,l),m=(Du(u)-Du(l))/1e3,p=Math.round((h-m)/60),v;if(p<2)return r!=null&&r.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,c):h<10?s.formatDistance("lessThanXSeconds",10,c):h<20?s.formatDistance("lessThanXSeconds",20,c):h<40?s.formatDistance("halfAMinute",0,c):h<60?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",1,c):p===0?s.formatDistance("lessThanXMinutes",1,c):s.formatDistance("xMinutes",p,c);if(p<45)return s.formatDistance("xMinutes",p,c);if(p<90)return s.formatDistance("aboutXHours",1,c);if(p<Sx){var b=Math.round(p/60);return s.formatDistance("aboutXHours",b,c)}else{if(p<sU)return s.formatDistance("xDays",1,c);if(p<vf){var g=Math.round(p/Sx);return s.formatDistance("xDays",g,c)}else if(p<oU)return v=Math.round(p/vf),s.formatDistance("aboutXMonths",v,c)}if(v=Az(u,l),v<12){var _=Math.round(p/vf);return s.formatDistance("xMonths",_,c)}else{var T=v%12,E=Math.floor(v/12);return T<3?s.formatDistance("aboutXYears",E,c):T<9?s.formatDistance("overXYears",E,c):s.formatDistance("almostXYears",E+1,c)}}function tI(t,e){return fr(1,arguments),cU(t,Date.now(),e)}const lU=async t=>{const{data:e,error:r}=await Tt.from("plants").select(`
      *,
      plant_images(*)
    `).eq("id",t).single();if(r)throw console.error(`Error fetching plant ${t}:`,r),r.code==="PGRST116"?new Error("Planta no encontrada."):new Error("Error al cargar la información de la planta.");const n=e;return{id:n.id,name:n.name,species:n.species,description:n.description??void 0,funFacts:n.fun_facts??void 0,variety:n.variety??void 0,nickname:n.nickname??void 0,location:n.location,plantEnvironment:n.plant_environment,lightRequirements:n.light_requirements,dateAdded:new Date(n.date_added),lastWatered:n.last_watered?new Date(n.last_watered):void 0,lastFertilized:n.last_fertilized?new Date(n.last_fertilized):void 0,healthScore:n.health_score??0,careProfile:n.care_profile,personality:n.personality,images:n.plant_images.map(i=>({id:i.id,url:i.url??"",timestamp:new Date(i.created_at),isProfileImage:i.is_profile_image??!1,healthAnalysis:i.health_analysis})),chatHistory:[],notifications:[]}},Dg=t=>{const{data:e,isLoading:r,error:n}=sE({queryKey:["plant",t],queryFn:async()=>lU(t),enabled:!!t,staleTime:6e5,gcTime:18e5,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1}),i=Kn(o=>o.setPlant),a=Kn(o=>o.selectPlant);w.useEffect(()=>(e&&(i(e),a(e.id)),()=>{a(null)}),[e,i,a]);const s=w.useMemo(()=>{if(!e)return[];const o=[];if(!e.images||e.images.length===0)return o;const c=e.images.map(l=>l.healthAnalysis?.confidence||null).filter(l=>l!==null);if(c.length>=3){const l=c.slice(-3);if(l[0]>l[1]&&l[1]>l[2]){const u=l[0]-l[2];o.push({type:"warning",title:"Tendencia de Salud a la Baja",message:`La salud de tu planta ha disminuido un ${u.toFixed(0)}% en las últimas revisiones.`})}}if(e.lastWatered&&e.careProfile){const l=yz(new Date,new Date(e.lastWatered)),u=e.careProfile.wateringFrequency;l>u&&o.push({type:"tip",title:"Consejo de Riego",message:`Han pasado ${l} días desde el último riego. El intervalo recomendado es de ${u} días.`})}return o},[e]);return{plant:e,insights:s,loading:r,error:n?.message||null}},uU=()=>{const t=pd(),r=Nn(o=>o.user)?.id,{addToast:n}=Qs(),i=Ai({mutationFn:async({plantId:o,imageDataUrl:c,note:l})=>{if(!r)throw new Error("User not authenticated");console.log("🖼️ [Image] Iniciando proceso de subida de imagen..."),console.log("🔬 [Image] Analizando imagen con IA...");const u=await YA(c);console.log("☁️ [Image] Subiendo imagen a Storage...");const h=await xA(c,"plant-images",`${r}/${o}`);console.log("💾 [Image] Guardando registro en base de datos...");const m=await vs.addPlantImage(o,{url:h,timestamp:new Date,isProfileImage:!1,healthAnalysis:u.health},r);return u.health?.confidence&&(console.log("🏥 [Image] Actualizando health score de la planta..."),await vs.updatePlantHealthScore(o,r,u.health.confidence,u.health,m.id)),console.log("✅ [Image] Proceso completado exitosamente"),{image:m,analysis:u,note:l}},onSuccess:(o,c)=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",c.plantId]});const{setPlant:l}=Kn.getState(),u=Kn.getState().getPlantById(c.plantId);if(u){const h={...u,images:[...u.images,o.image],healthScore:o.analysis.health?.confidence||u.healthScore};l(h)}n({type:"success",title:"Nueva imagen añadida",message:`Análisis completado. Salud actual: ${o.analysis.health?.confidence?.toFixed(0)||"N/A"}%`})},onError:o=>{console.error("💥 [Image] Error en proceso de subida:",o),n({type:"error",title:"Error al agregar imagen",message:o.message})}}),a=Ai({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🖼️ [Profile] Cambiando imagen de perfil..."),await vs.setProfileImage(o,c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen de perfil actualizada",message:"La imagen principal de la planta ha sido cambiada"})},onError:o=>{n({type:"error",title:"Error al cambiar imagen de perfil",message:o.message})}}),s=Ai({mutationFn:async({plantId:o,imageId:c})=>{if(!r)throw new Error("User not authenticated");return console.log("🗑️ [Image] Eliminando imagen..."),await vs.deleteImage(c,r),{plantId:o,imageId:c}},onSuccess:o=>{t.invalidateQueries({queryKey:["plants"]}),t.invalidateQueries({queryKey:["plant",o.plantId]}),n({type:"success",title:"Imagen eliminada",message:"La imagen ha sido eliminada de tu planta"})},onError:o=>{n({type:"error",title:"Error al eliminar imagen",message:o.message})}});return{addPlantImage:i.mutate,isAddingImage:i.isPending,setProfileImage:a.mutate,isSettingProfileImage:a.isPending,deleteImage:s.mutate,isDeletingImage:s.isPending}};function dU({images:t}){const[e,r]=w.useState(null);if(!t||t.length===0)return d.jsx(Pr,{className:"mt-4",children:d.jsx(ti,{className:"pt-6",children:d.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[d.jsx(Yn,{className:"w-12 h-12 text-muted-foreground mb-4"}),d.jsx("p",{className:"text-muted-foreground",children:"No hay imágenes para esta planta todavía."}),d.jsx("p",{className:"text-sm text-muted-foreground/70 mt-2",children:"¡Agrega algunas fotos para seguir su progreso!"})]})})});const n=[...t].sort((c,l)=>new Date(l.timestamp).getTime()-new Date(c.timestamp).getTime()),i=c=>{r(c)},a=()=>{r(null)},s=c=>{if(e===null)return;const l=c==="prev"?(e-1+n.length)%n.length:(e+1)%n.length;r(l)},o=c=>(c instanceof Date?c:new Date(c)).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"});return d.jsxs("div",{className:"mt-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("h2",{className:"text-xl font-bold tracking-tight flex items-center",children:[d.jsx(Yn,{className:"w-5 h-5 mr-2 text-primary"}),"Galería de Imágenes"]}),d.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.length," foto",n.length!==1?"s":""]})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:n.map((c,l)=>d.jsxs(L.div,{className:"aspect-square relative rounded-[8px] overflow-hidden cursor-pointer group w-[80px] h-[80px]",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>i(l),children:[d.jsx(Rg,{src:c.url,alt:`Imagen de planta del ${o(c.timestamp)}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 rounded-[8px]"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-3",children:d.jsx("div",{className:"flex items-center text-white text-xs gap-2",children:d.jsxs("span",{className:"flex items-center",children:[d.jsx(lu,{className:"w-3 h-3 mr-1"}),o(c.timestamp)]})})})}),c.isProfileImage&&d.jsx("div",{className:"absolute top-2 right-2 bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full font-medium",children:"Principal"})]},c.id))}),d.jsx(ke,{children:e!==null&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:a,children:d.jsxs(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative max-w-4xl max-h-full",onClick:c=>c.stopPropagation(),children:[d.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(Wi,{className:"w-6 h-6"})}),n.length>1&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>s("prev"),className:"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(gE,{className:"w-6 h-6"})}),d.jsx("button",{onClick:()=>s("next"),className:"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",children:d.jsx(yE,{className:"w-6 h-6"})})]}),d.jsx("img",{src:n[e].url,alt:`Imagen de planta del ${o(n[e].timestamp)}`,className:"max-w-full max-h-full object-contain rounded-lg"}),d.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-black/50 text-white p-4 rounded-lg backdrop-blur-sm",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(lu,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm",children:o(n[e].timestamp)})]}),d.jsxs("span",{className:"text-sm text-white/70",children:[e+1," de ",n.length]})]}),d.jsx("div",{className:"mt-2 text-sm flex items-center gap-2",children:(()=>{const c=n[e].healthAnalysis;if(!c)return d.jsx("span",{className:"italic text-white/60",children:"Sin análisis"});let l="🌱",u="Excelente";switch(c.overallHealth){case"excellent":l="🌱",u="Excelente";break;case"good":l="🌿",u="Buena";break;case"fair":l="🍃",u="Regular";break;case"poor":l="🥀",u="Baja";break;default:l="🌱",u=c.overallHealth}let h;const m={excellent:95,good:80,fair:60,poor:30};return c.overallHealth&&m[c.overallHealth]?h=m[c.overallHealth]:typeof c.confidence=="number"&&(h=c.confidence<=1?c.confidence*100:c.confidence),d.jsxs("span",{children:["Salud: ",d.jsx("span",{className:"font-semibold",children:u})," ",d.jsx("span",{children:l}),h!==void 0&&d.jsxs("span",{className:"ml-2",children:["(",Math.round(h),"%)"]})]})})()}),n[e].isProfileImage&&d.jsx("div",{className:"mt-2",children:d.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:"Imagen Principal"})})]})]})})})]})}const hU=new Ng,fU=()=>{const[t,e]=w.useState(!1),r=pd(),n=Nn(o=>o.user),{addToast:i}=Qs(),a=Ai({mutationFn:async({plantId:o,species:c,commonName:l})=>{if(!n)throw new Error("User not authenticated");e(!0),i({type:"info",title:"🤖 Completando información",message:`Consultando IA para ${l||c}...`,duration:3e3});try{const u=await A6(c,l);return await hU.updatePlantInfo(o,n.id,{plantEnvironment:u.plantEnvironment,lightRequirements:u.lightRequirements,description:u.description,funFacts:u.funFacts})}catch(u){throw console.error("❌ [COMPLETAR IA] Error durante el proceso:",u),u}finally{e(!1)}},onSuccess:o=>{console.log("🔄 [COMPLETAR IA] Refrescando datos en cache..."),i({type:"success",title:"✅ ¡Información completada!",message:`Se agregaron datos de ambiente y luz para ${o.name}`,duration:5e3}),r.invalidateQueries({queryKey:["plant",o.id]}),r.invalidateQueries({queryKey:["plants"]}),console.log("✅ [COMPLETAR IA] Cache actualizado correctamente")},onError:o=>{console.error("💥 [COMPLETAR IA] Error final en la operación:",o),i({type:"error",title:"❌ Error al completar información",message:"No se pudo obtener los datos de IA. Intenta de nuevo.",duration:7e3}),e(!1)}});return{completeInfo:(o,c,l)=>a.mutate({plantId:o,species:c,commonName:l}),isCompleting:t||a.isPending,error:a.error,isSuccess:a.isSuccess}},mU=({isOpen:t,onClose:e,onConfirm:r,title:n,description:i,confirmText:a="Confirmar",cancelText:s="Cancelar",variant:o="warning",isLoading:c=!1,preview:l})=>{const h={danger:{iconColor:"text-red-500",bgColor:"bg-red-50 dark:bg-red-900/20",confirmColor:"destructive"},warning:{iconColor:"text-amber-500",bgColor:"bg-amber-50 dark:bg-amber-900/20",confirmColor:"warning"},info:{iconColor:"text-blue-500",bgColor:"bg-blue-50 dark:bg-blue-900/20",confirmColor:"primary"}}[o];return d.jsx(ke,{children:t&&d.jsx(d.Fragment,{children:d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},onClick:m=>m.stopPropagation(),className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[d.jsx("div",{className:"p-6 pb-4",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:`${h.bgColor} p-3 rounded-full flex-shrink-0`,children:d.jsx(Tn,{className:`w-6 h-6 ${h.iconColor}`})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:n}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm leading-relaxed",children:i})]}),d.jsx("button",{onClick:e,disabled:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1","aria-label":"Cerrar diálogo",children:d.jsx(Wi,{className:"w-5 h-5"})})]})}),l&&d.jsx("div",{className:"px-6 pb-4",children:d.jsx("div",{className:"border dark:border-gray-700 rounded-lg p-3 bg-gray-50 dark:bg-gray-900/50",children:l})}),d.jsxs("div",{className:"px-6 pb-6 flex gap-3 justify-end",children:[d.jsx(me,{variant:"outline",onClick:e,disabled:c,className:"min-w-[80px]",children:s}),d.jsx(me,{variant:h.confirmColor,onClick:r,disabled:c,loading:c,className:"min-w-[80px]",children:a})]})]})})})})},pU=({plant:t,variant:e="primary",size:r="sm",showLabel:n=!0,className:i=""})=>{const{updatePlantHealthMutation:a,isUpdatingPlantHealth:s}=Kd(),o=Nn(p=>p.user),{addToast:c}=Qs(),{plant:l}=Dg(t.id),u=async()=>{if(!o?.id){c({type:"error",title:"Error",message:"Debes estar logueado para actualizar el diagnóstico"});return}if(!l){c({type:"error",title:"Error",message:"No se pudieron cargar los datos de la planta"});return}console.log("🩺 [Button] Actualizando diagnóstico para:",t.name),a({plant:l,userId:o.id})},h=d.jsxs(d.Fragment,{children:[s?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(Oi,{size:r.includes("icon")?16:14})}):d.jsx(bE,{size:r.includes("icon")?16:14}),n&&!r.includes("icon")&&d.jsx("span",{className:"ml-2 text-xs",children:s?"Analizando...":"Analizar"})]}),m=r.includes("icon");return d.jsx(me,{onClick:u,disabled:s||!l,size:r,variant:e,className:i,"aria-label":m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,title:m?`Actualizar diagnóstico de salud para ${t.name}`:void 0,children:h})},gU=({plant:t})=>{const e=sr(),[r,n]=w.useState(!1),[i,a]=w.useState(!1),{deletePlant:s,isDeletingPlant:o}=Kd(),{completeInfo:c,isCompleting:l}=fU(),{scrollY:u}=IN(),h=t0(u,[0,300],[0,150]),m=t0(u,[0,200],[1,.3]),p=t.images?.find(C=>C.isProfileImage)||t.images?.[0],v=!t.plantEnvironment||!t.lightRequirements,b=()=>{a(!0),n(!1)},g=()=>{s(t.id,{onSuccess:()=>{e("/")}})},_=()=>{console.log("🎯 [UI] Usuario solicitó completar información con IA"),console.log("🌱 [UI] Datos de la planta:",{id:t.id,nombre:t.name,especie:t.species,ambienteActual:t.plantEnvironment||"No especificado",luzActual:t.lightRequirements||"No especificado"}),n(!1),a(!0)},T=()=>{console.log("✅ [UI] Usuario confirmó el completado automático"),a(!1),c(t.id,t.species,t.name)},E=()=>{console.log("❌ [UI] Usuario canceló el completado automático"),a(!1)},j=C=>(C instanceof Date?C:new Date(C)).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"}),R=C=>{switch(C){case"interior":return d.jsx(cu,{className:"w-4 h-4 mr-2"});case"exterior":return d.jsx(r0,{className:"w-4 h-4 mr-2"});case"ambos":return d.jsxs(d.Fragment,{children:[d.jsx(cu,{className:"w-3 h-3 mr-1"}),d.jsx(r0,{className:"w-3 h-3 mr-1"})]});default:return null}},D=C=>{switch(C){case"interior":return"Interior";case"exterior":return"Exterior";case"ambos":return"Interior/Exterior";default:return null}},I=C=>{switch(C){case"poca_luz":return d.jsx(SN,{className:"w-4 h-4 mr-2"});case"luz_indirecta":return d.jsx(_a,{className:"w-4 h-4 mr-2 opacity-60"});case"luz_directa_parcial":return d.jsx(_a,{className:"w-4 h-4 mr-2 opacity-80"});case"pleno_sol":return d.jsx(_a,{className:"w-4 h-4 mr-2"});default:return null}},A=C=>{switch(C){case"poca_luz":return"Poca luz";case"luz_indirecta":return"Luz indirecta";case"luz_directa_parcial":return"Sol parcial";case"pleno_sol":return"Pleno sol";default:return null}},P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},O={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",damping:25,stiffness:120}}},N={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6}}};return w.useEffect(()=>{const C=()=>n(!1);if(r)return document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[r]),d.jsxs(L.div,{className:"relative h-96 w-full overflow-hidden",variants:P,initial:"hidden",animate:"visible",children:[d.jsx(L.div,{className:"absolute inset-0 scale-110",style:{y:h,opacity:m},children:p?d.jsx(Rg,{src:p.url,alt:t.name,className:"h-full w-full object-cover"}):d.jsx("div",{className:"h-full w-full bg-gradient-to-br from-green-400 via-green-500 to-green-600",children:d.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='7' cy='7' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})})}),d.jsxs(L.div,{className:"absolute inset-0",variants:N,children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[rgba(0,0,0,0.6)] to-transparent"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/30"}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background/60 to-transparent"})]}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top z-20",children:d.jsxs(L.div,{className:"flex items-center justify-between",variants:O,children:[d.jsx(me,{"aria-label":"Volver atrás",variant:"ghost",size:"icon",onClick:()=>e("/"),className:"bg-black/30 text-white backdrop-blur-lg rounded-full border border-white/20 hover:bg-black/50 transition-all duration-300",children:d.jsx(Ip,{size:20})}),d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("div",{className:"relative",children:[d.jsx(me,{"aria-label":"Más opciones",variant:"ghost",size:"icon",onClick:C=>{C.stopPropagation(),n(k=>!k)},className:"bg-neutral-800/90 text-white backdrop-blur-lg rounded-full border border-neutral-600 hover:bg-neutral-700 transition-all duration-300 dark:bg-neutral-200/90 dark:text-neutral-900 dark:border-neutral-400 dark:hover:bg-neutral-300",children:d.jsx(xE,{size:20})}),d.jsx(ke,{children:r&&d.jsx(L.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15},className:"absolute right-0 mt-2 w-48 origin-top-right rounded-xl bg-background/95 backdrop-blur-lg shadow-xl ring-1 ring-black/10 focus:outline-none z-30 border border-border/50",onClick:C=>C.stopPropagation(),children:d.jsxs("div",{className:"py-2",children:[v&&d.jsxs("button",{onClick:_,disabled:l,className:"flex w-full items-center px-4 py-3 text-sm text-contrast-high hover:bg-contrast-surface transition-colors rounded-lg mx-2",children:[l?d.jsx(wa,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(er,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:l?"Completando...":"Completar con IA"})]}),d.jsx("div",{className:"flex w-full items-center px-2 py-1",children:d.jsx(pU,{plant:t,variant:"outline",size:"sm",showLabel:!0,className:"w-full"})}),d.jsxs("button",{onClick:b,disabled:o,className:"flex w-full items-center px-4 py-3 text-sm text-error-600 dark:text-error-500 hover:bg-error-50 dark:hover:bg-error-900/20 transition-colors rounded-lg mx-2 font-medium",children:[o?d.jsx(wa,{className:"mr-3 h-4 w-4 animate-spin"}):d.jsx(fE,{className:"mr-3 h-4 w-4"}),d.jsx("span",{children:o?"Eliminando...":"Eliminar planta"})]})]})})})]})})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom z-10",children:d.jsxs(L.div,{className:"space-y-4",variants:O,children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(L.h1,{className:"text-[24px] font-bold text-white drop-shadow-lg",variants:O,children:t.nickname||t.name}),d.jsx(L.p,{className:"text-[16px] text-white/90 font-medium",variants:O,children:t.species})]}),d.jsxs(L.div,{className:"flex flex-wrap gap-2 pt-2 max-h-32 overflow-y-auto",variants:O,children:[t.location&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(wE,{className:"w-4 h-4 mr-2"}),d.jsx("span",{className:"text-sm font-medium",children:t.location})]}),t.dateAdded&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[d.jsx(lu,{className:"w-4 h-4 mr-2"}),d.jsxs("span",{className:"text-sm font-medium",children:["Desde ",j(t.dateAdded)]})]}),t.plantEnvironment&&D(t.plantEnvironment)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[R(t.plantEnvironment),d.jsx("span",{className:"text-sm font-medium",children:D(t.plantEnvironment)})]}),t.lightRequirements&&A(t.lightRequirements)&&d.jsxs("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:[I(t.lightRequirements),d.jsx("span",{className:"text-sm font-medium",children:A(t.lightRequirements)})]}),t.images&&t.images.length>0&&d.jsx("div",{className:"flex items-center text-white/80 bg-black/30 backdrop-blur-sm px-3 py-2 rounded-full border border-white/20",children:d.jsxs("span",{className:"text-sm font-medium",children:[t.images.length," foto",t.images.length!==1?"s":""]})})]})]})}),d.jsx(ke,{children:i&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:E,children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:C=>C.stopPropagation(),className:"bg-white dark:bg-gray-900 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[d.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[d.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center",children:d.jsx(er,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Completar con IA"}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Información automática"})]})]}),d.jsxs("div",{className:"space-y-3 mb-6",children:[d.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"¿Quieres que la IA complete la información faltante de esta planta?"}),d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-2",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🌱"}),d.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.name})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-2xl",children:"🔬"}),d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t.species})]})]}),d.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d.jsx("p",{className:"font-medium mb-1",children:"La IA agregará:"}),d.jsxs("ul",{className:"space-y-1",children:[d.jsx("li",{children:"• Ambiente recomendado (interior/exterior)"}),d.jsx("li",{children:"• Necesidades de luz específicas"})]})]})]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx(me,{variant:"outline",onClick:E,className:"flex-1",disabled:l,children:"Cancelar"}),d.jsx(me,{onClick:T,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",disabled:l,children:l?d.jsxs(d.Fragment,{children:[d.jsx(wa,{className:"w-4 h-4 mr-2 animate-spin"}),"Completando..."]}):d.jsxs(d.Fragment,{children:[d.jsx(er,{className:"w-4 h-4 mr-2"}),"Completar"]})})]})]})})}),d.jsx(mU,{isOpen:i,onClose:()=>a(!1),onConfirm:g,title:"Eliminar Planta",description:`¿Estás seguro de que quieres eliminar "${t.nickname||t.name}"? Esta acción es irreversible y se perderán todos los datos, fotos y mensajes de chat asociados.`,confirmText:"Eliminar Definitivamente",cancelText:"Cancelar",variant:"danger",isLoading:o,preview:d.jsxs("div",{className:"flex items-center gap-3",children:[p&&d.jsx("img",{src:p.url,alt:t.name,className:"w-12 h-12 rounded-lg object-cover"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:[t.species," • ",t.images?.length||0," fotos"]})]})]})})]})},yU=({plant:t})=>{const{careProfile:e,personality:r}=t;if(!e)return d.jsx("div",{className:"bg-background p-6 rounded-lg shadow-lg w-full text-center",children:d.jsx("p",{className:"text-muted-foreground",children:"No hay perfil de cuidados disponible para esta planta."})});const n=[{icon:d.jsx(Ec,{size:20,strokeWidth:2,color:"#555"}),label:"RIEGO",value:`Cada ${e.wateringFrequency} días`},{icon:d.jsx(_a,{size:20,strokeWidth:2,color:"#555"}),label:"LUZ SOLAR",value:e.sunlightRequirement},{icon:d.jsx(vE,{size:20,strokeWidth:2,color:"#555"}),label:"HUMEDAD",value:e.humidityPreference},{icon:d.jsx(_E,{size:20,strokeWidth:2,color:"#555"}),label:"TEMPERATURA IDEAL",value:`${e.temperatureRange.min}°C - ${e.temperatureRange.max}°C`},{icon:d.jsx(er,{size:20,strokeWidth:2,color:"#555"}),label:"FERTILIZACIÓN",value:`Cada ${e.fertilizingFrequency} días`},{icon:d.jsx(Sp,{size:20,strokeWidth:2,color:"#555"}),label:"TIPO DE SUELO",value:e.soilType}];return d.jsxs("div",{className:"w-full",style:{lineHeight:"1.4"},children:[d.jsx("div",{className:"grid grid-cols-2 gap-x-4 gap-y-6 mb-4",style:{gap:"24px 16px"},children:n.map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start",children:[d.jsxs("div",{className:"flex items-center mb-1",children:[i.icon,d.jsx("span",{className:"ml-2 text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:i.label})]}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i.value})]},a))}),e.specialCare&&e.specialCare.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Cuidados Especiales"}),d.jsx("ul",{className:"list-none pl-0 ml-4",style:{lineHeight:"1.5"},children:e.specialCare.map((i,a)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:i})]},a))})]}),d.jsx("hr",{className:"my-6",style:{border:"none",borderTop:"1px solid #EEE",margin:"24px 0"}}),r&&d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[d.jsx(Xo,{size:20,strokeWidth:2,color:"#555",className:"mr-2"}),d.jsx("span",{className:"text-[18px] font-semibold text-[#333]",children:"Personalidad de la Planta"})]}),r.communicationStyle&&d.jsx("div",{className:Array.isArray(r.communicationStyle)&&r.communicationStyle.length>1?"grid grid-cols-2 gap-x-4 mb-3":"flex justify-center mb-3",children:(Array.isArray(r.communicationStyle)?r.communicationStyle:[r.communicationStyle]).map((i,a)=>d.jsxs("div",{className:"flex flex-col items-start mb-2",children:[d.jsx("span",{className:"text-[12px] uppercase tracking-[0.4px] text-[#777] font-medium",children:"ESTILO"}),d.jsx("span",{className:"text-[15px] font-semibold text-[#333] mt-1",children:i})]},a))}),r.catchphrases&&r.catchphrases.length>0&&d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mb-2",children:"Frases Típicas"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:r.catchphrases.map((i,a)=>d.jsx("span",{className:"inline-block bg-[#F0FDF6] text-[#046A38] text-[14px] px-2 py-1 rounded-[4px] font-medium",style:{padding:"4px 8px",marginRight:8,marginBottom:8},children:i},a))})]})]})]})},vU=({funFacts:t})=>{const e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsxs(L.div,{className:"bg-white/0 dark:bg-transparent p-3 sm:p-4 w-full",variants:e,initial:"hidden",animate:"visible",children:[t&&t.length>0&&d.jsxs(L.div,{variants:r,children:[d.jsxs("div",{className:"flex items-center mb-6",children:[d.jsx("div",{className:"p-3 bg-yellow-500/10 rounded-full mr-4",children:d.jsx(er,{className:"w-6 h-6 text-yellow-500"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-bold text-foreground",children:"Datos Curiosos"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Descubre cosas increíbles sobre esta planta"})]})]}),d.jsx("div",{className:"grid gap-4",children:t.map((n,i)=>d.jsxs(L.div,{className:"group flex items-start bg-yellow-500/5 hover:bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 transition-all duration-300 hover:shadow-md",variants:r,whileHover:{scale:1.02},whileTap:{scale:.98},children:[d.jsx("div",{className:"flex-shrink-0 mr-4 mt-1",children:d.jsxs("div",{className:"relative",children:[d.jsx(EE,{className:"w-5 h-5 text-yellow-500 group-hover:text-yellow-600 transition-colors"}),d.jsx("div",{className:"absolute -inset-2 bg-yellow-500/20 rounded-full opacity-0 group-hover:opacity-100 transition-opacity pulse"})]})}),d.jsx("p",{className:"text-foreground/90 leading-relaxed font-medium group-hover:text-foreground transition-colors",children:n})]},i))})]}),(!t||t.length===0)&&d.jsx(L.div,{className:"mt-8 flex items-center justify-center p-6 bg-muted/30 rounded-xl border border-dashed border-muted-foreground/20",variants:r,children:d.jsxs("div",{className:"text-center",children:[d.jsx(er,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2"}),d.jsx("p",{className:"text-muted-foreground font-medium",children:"No hay datos curiosos disponibles"}),d.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:"¡Pronto agregaremos información interesante!"})]})})]})},bU=()=>d.jsx(gd,{className:"w-5 h-5 text-[#EF9A9A]","aria-label":"Problema de hoja seca"}),xU=({analysis:t})=>{if(!t)return null;const e=t.issues&&t.issues.length>0;return d.jsxs("div",{className:"w-full",role:"region","aria-label":"Análisis de salud de la planta",style:{lineHeight:"1.4"},children:[e?d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-[16px] text-[#333] mt-3",children:"Problemas Detectados"}),d.jsxs("p",{className:"mb-2 text-[14px] text-[#D32F2F] font-medium",style:{marginTop:12,marginBottom:8},children:[t.issues.length," problema",t.issues.length!==1?"s":""," detectado",t.issues.length!==1?"s":""]}),d.jsx("ul",{className:"",children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start",style:{marginBottom:n<t.issues.length-1?16:0,paddingBottom:n<t.issues.length-1?16:0,borderBottom:n<t.issues.length-1?"1px solid #EEE":"none"},children:[d.jsx("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center mt-1",children:bU()}),d.jsxs("div",{className:"ml-4",children:[d.jsx("p",{className:"font-semibold text-[15px] text-[#333]",children:r.type}),d.jsx("p",{className:"text-[14px] text-[#555] mt-1",children:r.description})]})]},n))}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Tratamientos Sugeridos"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.issues.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r.treatment})]},n))})]})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[d.jsx("span",{className:"text-4xl mb-2",role:"img","aria-label":"Planta saludable",children:"🌱"}),d.jsx(PN,{className:"w-12 h-12 text-green-500 mb-3","aria-label":"Todo en orden"}),d.jsxs("h4",{className:"font-semibold text-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:["¡Todo en orden!",d.jsx("span",{className:"text-base","aria-hidden":"true",children:"🌱"})]}),d.jsx("p",{className:"text-muted-foreground",children:"El análisis inicial no detectó problemas de salud significativos."})]}),t.recommendations&&t.recommendations.length>0&&d.jsxs("div",{className:"mt-4",children:[d.jsx("h4",{className:"font-semibold text-[14px] text-[#333] mt-4 mb-2",children:"Recomendaciones Adicionales"}),d.jsx("ul",{className:"list-none pl-0 ml-3",style:{lineHeight:"1.5"},children:t.recommendations.map((r,n)=>d.jsxs("li",{className:"flex items-start mb-1",children:[d.jsx("span",{className:"mr-2 text-[#2A7F3E] font-bold",style:{fontSize:18,lineHeight:"1"},children:"•"}),d.jsx("span",{className:"text-[14px] text-[#444]",children:r})]},n))})]})]})};var Zd={},rI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==="__proto__"}t.isUnsafeProperty=e})(rI);var Mg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}t.isDeepKey=e})(Mg);var Lg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}t.toKey=e})(Lg);var Qd={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const l=r[a];o?l==="\\"&&a+1<i?(a++,s+=r[a]):l===o?o="":s+=l:c?l==='"'||l==="'"?o=l:l==="]"?(c=!1,n.push(s),s=""):s+=l:l==="["?(c=!0,s&&(n.push(s),s="")):l==="."?s&&(n.push(s),s=""):s+=l,a++}return s&&n.push(s),n}t.toPath=e})(Qd);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=rI,r=Mg,n=Lg,i=Qd;function a(o,c,l){if(o==null)return l;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return l;const u=o[c];return u===void 0?r.isDeepKey(c)?a(o,i.toPath(c),l):l:u}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const u=o[c];return u===void 0?l:u}default:{if(Array.isArray(c))return s(o,c,l);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return l;const u=o[c];return u===void 0?l:u}}}function s(o,c,l){if(c.length===0)return l;let u=o;for(let h=0;h<c.length;h++){if(u==null||e.isUnsafeProperty(c[h]))return l;u=u[c[h]]}return u===void 0?l:u}t.get=a})(Zd);var wU=Zd.get;const za=Hi(wU);var nI={exports:{}},Ve={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g=Symbol.for("react.transitional.element"),Vg=Symbol.for("react.portal"),Xd=Symbol.for("react.fragment"),Jd=Symbol.for("react.strict_mode"),eh=Symbol.for("react.profiler"),th=Symbol.for("react.consumer"),rh=Symbol.for("react.context"),nh=Symbol.for("react.forward_ref"),ih=Symbol.for("react.suspense"),ah=Symbol.for("react.suspense_list"),sh=Symbol.for("react.memo"),oh=Symbol.for("react.lazy"),_U=Symbol.for("react.view_transition"),EU=Symbol.for("react.client.reference");function Ur(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case $g:switch(t=t.type,t){case Xd:case eh:case Jd:case ih:case ah:case _U:return t;default:switch(t=t&&t.$$typeof,t){case rh:case nh:case oh:case sh:return t;case th:return t;default:return e}}case Vg:return e}}}Ve.ContextConsumer=th;Ve.ContextProvider=rh;Ve.Element=$g;Ve.ForwardRef=nh;Ve.Fragment=Xd;Ve.Lazy=oh;Ve.Memo=sh;Ve.Portal=Vg;Ve.Profiler=eh;Ve.StrictMode=Jd;Ve.Suspense=ih;Ve.SuspenseList=ah;Ve.isContextConsumer=function(t){return Ur(t)===th};Ve.isContextProvider=function(t){return Ur(t)===rh};Ve.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===$g};Ve.isForwardRef=function(t){return Ur(t)===nh};Ve.isFragment=function(t){return Ur(t)===Xd};Ve.isLazy=function(t){return Ur(t)===oh};Ve.isMemo=function(t){return Ur(t)===sh};Ve.isPortal=function(t){return Ur(t)===Vg};Ve.isProfiler=function(t){return Ur(t)===eh};Ve.isStrictMode=function(t){return Ur(t)===Jd};Ve.isSuspense=function(t){return Ur(t)===ih};Ve.isSuspenseList=function(t){return Ur(t)===ah};Ve.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Xd||t===eh||t===Jd||t===ih||t===ah||typeof t=="object"&&t!==null&&(t.$$typeof===oh||t.$$typeof===sh||t.$$typeof===rh||t.$$typeof===th||t.$$typeof===nh||t.$$typeof===EU||t.getModuleId!==void 0)};Ve.typeOf=Ur;nI.exports=Ve;var TU=nI.exports,Lr=t=>t===0?0:t>0?1:-1,Vr=t=>typeof t=="number"&&t!=+t,ga=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,re=t=>(typeof t=="number"||t instanceof Number)&&!Vr(t),Sn=t=>re(t)||typeof t=="string",AU=0,fc=t=>{var e=++AU;return"".concat(t||"").concat(e)},zi=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!re(e)&&typeof e!="string")return n;var a;if(ga(e)){if(r==null)return n;var s=e.indexOf("%");a=r*parseFloat(e.slice(0,s))/100}else a=+e;return Vr(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},iI=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,r={},n=0;n<e;n++)if(!r[t[n]])r[t[n]]=!0;else return!0;return!1},Ao=(t,e)=>re(t)&&re(e)?r=>t+r*(e-t):()=>e;function aI(t,e,r){if(!(!t||!t.length))return t.find(n=>n&&(typeof e=="function"?e(n):za(n,e))===r)}var lt=t=>t===null||typeof t>"u",Fg=t=>lt(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),IU=["viewBox","children"],SU=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Px=["points","pathLength"],bf={svg:IU,polygon:Px,polyline:Px},zg=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Ug=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(w.isValidElement(t)&&(r=t.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{zg.includes(i)&&(n[i]=a=>r[i](r,a))}),n},PU=(t,e,r)=>n=>(t(e,r,n),null),CU=(t,e,r)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var n=null;return Object.keys(t).forEach(i=>{var a=t[i];zg.includes(i)&&typeof a=="function"&&(n||(n={}),n[i]=PU(a,e,r))}),n},Cx=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",kx=null,xf=null,sI=t=>{if(t===kx&&Array.isArray(xf))return xf;var e=[];return w.Children.forEach(t,r=>{lt(r)||(TU.isFragment(r)?e=e.concat(sI(r.props.children)):e.push(r))}),xf=e,kx=t,e};function oI(t,e){var r=[],n=[];return Array.isArray(e)?n=e.map(i=>Cx(i)):n=[Cx(e)],sI(t).forEach(i=>{var a=za(i,"type.displayName")||za(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var cI=t=>t&&typeof t=="object"&&"clipDot"in t?!!t.clipDot:!0,kU=(t,e,r,n)=>{var i,a=(i=n&&bf?.[n])!==null&&i!==void 0?i:[];return e.startsWith("data-")||typeof t!="function"&&(n&&a.includes(e)||SU.includes(e))||r&&zg.includes(e)},Ge=(t,e,r)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(w.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;kU((s=n)===null||s===void 0?void 0:s[a],a,e,r)&&(i[a]=n[a])}),i},NU=["children","width","height","viewBox","className","style","title","desc"];function Mm(){return Mm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mm.apply(null,arguments)}function jU(t,e){if(t==null)return{};var r,n,i=OU(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function OU(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var lI=w.forwardRef((t,e)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:c,desc:l}=t,u=jU(t,NU),h=a||{width:n,height:i,x:0,y:0},m=Le("recharts-surface",s);return w.createElement("svg",Mm({},Ge(u,!0,"svg"),{className:m,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:e}),w.createElement("title",null,c),w.createElement("desc",null,l),r)}),RU=["children","className"];function Lm(){return Lm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lm.apply(null,arguments)}function DU(t,e){if(t==null)return{};var r,n,i=MU(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function MU(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var Ui=w.forwardRef((t,e)=>{var{children:r,className:n}=t,i=DU(t,RU),a=Le("recharts-layer",n);return w.createElement("g",Lm({className:a},Ge(i,!0),{ref:e}),r)}),LU=w.createContext(null);function it(t){return function(){return t}}const $m=Math.PI,Vm=2*$m,da=1e-6,$U=Vm-da;function uI(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function VU(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return uI;const r=10**e;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class FU{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?uI:VU(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,i){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,r,n,i,a,s){this._append`C${+e},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(e,r,n,i,a){if(e=+e,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,c=n-e,l=i-r,u=s-e,h=o-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>da)if(!(Math.abs(h*c-l*u)>da)||!a)this._append`L${this._x1=e},${this._y1=r}`;else{let p=n-s,v=i-o,b=c*c+l*l,g=p*p+v*v,_=Math.sqrt(b),T=Math.sqrt(m),E=a*Math.tan(($m-Math.acos((b+m-g)/(2*_*T)))/2),j=E/T,R=E/_;Math.abs(j-1)>da&&this._append`L${e+j*u},${r+j*h}`,this._append`A${a},${a},0,0,${+(h*p>u*v)},${this._x1=e+R*c},${this._y1=r+R*l}`}}arc(e,r,n,i,a,s){if(e=+e,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),c=n*Math.sin(i),l=e+o,u=r+c,h=1^s,m=s?i-a:a-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>da||Math.abs(this._y1-u)>da)&&this._append`L${l},${u}`,n&&(m<0&&(m=m%Vm+Vm),m>$U?this._append`A${n},${n},0,1,${h},${e-o},${r-c}A${n},${n},0,1,${h},${this._x1=l},${this._y1=u}`:m>da&&this._append`A${n},${n},0,${+(m>=$m)},${h},${this._x1=e+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(e,r,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function dI(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new FU(e)}function Bg(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function hI(t){this._context=t}hI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function ch(t){return new hI(t)}function fI(t){return t[0]}function mI(t){return t[1]}function pI(t,e){var r=it(!0),n=null,i=ch,a=null,s=dI(o);t=typeof t=="function"?t:t===void 0?fI:it(t),e=typeof e=="function"?e:e===void 0?mI:it(e);function o(c){var l,u=(c=Bg(c)).length,h,m=!1,p;for(n==null&&(a=i(p=s())),l=0;l<=u;++l)!(l<u&&r(h=c[l],l,c))===m&&((m=!m)?a.lineStart():a.lineEnd()),m&&a.point(+t(h,l,c),+e(h,l,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(t=typeof c=="function"?c:it(+c),o):t},o.y=function(c){return arguments.length?(e=typeof c=="function"?c:it(+c),o):e},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:it(!!c),o):r},o.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),o):i},o.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),o):n},o}function Rl(t,e,r){var n=null,i=it(!0),a=null,s=ch,o=null,c=dI(l);t=typeof t=="function"?t:t===void 0?fI:it(+t),e=typeof e=="function"?e:it(e===void 0?0:+e),r=typeof r=="function"?r:r===void 0?mI:it(+r);function l(h){var m,p,v,b=(h=Bg(h)).length,g,_=!1,T,E=new Array(b),j=new Array(b);for(a==null&&(o=s(T=c())),m=0;m<=b;++m){if(!(m<b&&i(g=h[m],m,h))===_)if(_=!_)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=m-1;v>=p;--v)o.point(E[v],j[v]);o.lineEnd(),o.areaEnd()}_&&(E[m]=+t(g,m,h),j[m]=+e(g,m,h),o.point(n?+n(g,m,h):E[m],r?+r(g,m,h):j[m]))}if(T)return o=null,T+""||null}function u(){return pI().defined(i).curve(s).context(a)}return l.x=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),n=null,l):t},l.x0=function(h){return arguments.length?(t=typeof h=="function"?h:it(+h),l):t},l.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:it(+h),l):n},l.y=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),r=null,l):e},l.y0=function(h){return arguments.length?(e=typeof h=="function"?h:it(+h),l):e},l.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:it(+h),l):r},l.lineX0=l.lineY0=function(){return u().x(t).y(e)},l.lineY1=function(){return u().x(t).y(r)},l.lineX1=function(){return u().x(n).y(e)},l.defined=function(h){return arguments.length?(i=typeof h=="function"?h:it(!!h),l):i},l.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),l):s},l.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),l):a},l}class gI{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function zU(t){return new gI(t,!0)}function UU(t){return new gI(t,!1)}function Mu(){}function Lu(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function yI(t){this._context=t}yI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Lu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Lu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function BU(t){return new yI(t)}function vI(t){this._context=t}vI.prototype={areaStart:Mu,areaEnd:Mu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Lu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function qU(t){return new vI(t)}function bI(t){this._context=t}bI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Lu(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function HU(t){return new bI(t)}function xI(t){this._context=t}xI.prototype={areaStart:Mu,areaEnd:Mu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function WU(t){return new xI(t)}function Nx(t){return t<0?-1:1}function jx(t,e,r){var n=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(n||i<0&&-0),s=(r-t._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(Nx(a)+Nx(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function Ox(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function wf(t,e,r){var n=t._x0,i=t._y0,a=t._x1,s=t._y1,o=(a-n)/3;t._context.bezierCurveTo(n+o,i+o*e,a-o,s-o*r,a,s)}function $u(t){this._context=t}$u.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wf(this,this._t0,Ox(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,wf(this,Ox(this,r=jx(this,t,e)),r);break;default:wf(this,this._t0,r=jx(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function wI(t){this._context=new _I(t)}(wI.prototype=Object.create($u.prototype)).point=function(t,e){$u.prototype.point.call(this,e,t)};function _I(t){this._context=t}_I.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,i,a){this._context.bezierCurveTo(e,t,n,r,a,i)}};function KU(t){return new $u(t)}function GU(t){return new wI(t)}function EI(t){this._context=t}EI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=Rx(t),i=Rx(e),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],t[s],e[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Rx(t){var e,r=t.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function YU(t){return new EI(t)}function lh(t,e){this._context=t,this._t=e}lh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function ZU(t){return new lh(t,.5)}function QU(t){return new lh(t,0)}function XU(t){return new lh(t,1)}function $s(t,e){if((s=t.length)>1)for(var r=1,n,i,a=t[e[0]],s,o=a.length;r<s;++r)for(i=a,a=t[e[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Fm(t){for(var e=t.length,r=new Array(e);--e>=0;)r[e]=e;return r}function JU(t,e){return t[e]}function e9(t){const e=[];return e.key=t,e}function t9(){var t=it([]),e=Fm,r=$s,n=JU;function i(a){var s=Array.from(t.apply(this,arguments),e9),o,c=s.length,l=-1,u;for(const h of a)for(o=0,++l;o<c;++o)(s[o][l]=[0,+n(h,s[o].key,l,a)]).data=h;for(o=0,u=Bg(e(s));o<c;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(t=typeof a=="function"?a:it(Array.from(a)),i):t},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:it(+a),i):n},i.order=function(a){return arguments.length?(e=a==null?Fm:typeof a=="function"?a:it(Array.from(a)),i):e},i.offset=function(a){return arguments.length?(r=a??$s,i):r},i}function r9(t,e){if((n=t.length)>0){for(var r,n,i=0,a=t[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=t[r][i][1]||0;if(s)for(r=0;r<n;++r)t[r][i][1]/=s}$s(t,e)}}function n9(t,e){if((i=t.length)>0){for(var r=0,n=t[e[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=t[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}$s(t,e)}}function i9(t,e){if(!(!((s=t.length)>0)||!((a=(i=t[e[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,c=0,l=0;o<s;++o){for(var u=t[e[o]],h=u[n][1]||0,m=u[n-1][1]||0,p=(h-m)/2,v=0;v<o;++v){var b=t[e[v]],g=b[n][1]||0,_=b[n-1][1]||0;p+=g-_}c+=h,l+=p*h}i[n-1][1]+=i[n-1][0]=r,c&&(r-=l/c)}i[n-1][1]+=i[n-1][0]=r,$s(t,e)}}var TI={},AI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}t.uniqBy=e})(AI);var qg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r}t.identity=e})(qg);var II={},uh={},SI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Number.isSafeInteger(r)&&r>=0}t.isLength=e})(SI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=SI;function r(n){return n!=null&&typeof n!="function"&&e.isLength(n.length)}t.isArrayLike=r})(uh);var PI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="object"&&r!==null}t.isObjectLike=e})(PI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=uh,r=PI;function n(i){return r.isObjectLike(i)&&e.isArrayLike(i)}t.isArrayLikeObject=n})(II);var CI={},kI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zd;function r(n){return function(i){return e.get(i,n)}}t.property=r})(kI);var NI={},_f={},Ef={},Hg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r!==null&&(typeof r=="object"||typeof r=="function")}t.isObject=e})(Hg);var Wg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null||typeof r!="object"&&typeof r!="function"}t.isPrimitive=e})(Wg);var dh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}t.eq=e})(dh);var Dx;function a9(){return Dx||(Dx=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Kg(),r=Hg,n=Wg,i=dh;function a(h,m,p){return typeof p!="function"?e.isMatch(h,m):s(h,m,function v(b,g,_,T,E,j){const R=p(b,g,_,T,E,j);return R!==void 0?!!R:s(b,g,v,j)},new Map)}function s(h,m,p,v){if(m===h)return!0;switch(typeof m){case"object":return o(h,m,p,v);case"function":return Object.keys(m).length>0?s(h,{...m},p,v):i.eq(h,m);default:return r.isObject(h)?typeof m=="string"?m==="":!0:i.eq(h,m)}}function o(h,m,p,v){if(m==null)return!0;if(Array.isArray(m))return l(h,m,p,v);if(m instanceof Map)return c(h,m,p,v);if(m instanceof Set)return u(h,m,p,v);const b=Object.keys(m);if(h==null)return b.length===0;if(b.length===0)return!0;if(v&&v.has(m))return v.get(m)===h;v&&v.set(m,h);try{for(let g=0;g<b.length;g++){const _=b[g];if(!n.isPrimitive(h)&&!(_ in h)||m[_]===void 0&&h[_]!==void 0||m[_]===null&&h[_]!==null||!p(h[_],m[_],_,h,m,v))return!1}return!0}finally{v&&v.delete(m)}}function c(h,m,p,v){if(m.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,g]of m.entries()){const _=h.get(b);if(p(_,g,b,h,m,v)===!1)return!1}return!0}function l(h,m,p,v){if(m.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let g=0;g<m.length;g++){const _=m[g];let T=!1;for(let E=0;E<h.length;E++){if(b.has(E))continue;const j=h[E];let R=!1;if(p(j,_,g,h,m,v)&&(R=!0),R){b.add(E),T=!0;break}}if(!T)return!1}return!0}function u(h,m,p,v){return m.size===0?!0:h instanceof Set?l([...h],[...m],p,v):!1}t.isMatchWith=a,t.isSetMatch=u}(Ef)),Ef}var Mx;function Kg(){return Mx||(Mx=1,function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=a9();function r(n,i){return e.isMatchWith(n,i,()=>{})}t.isMatch=r}(_f)),_f}var jI={},Gg={},Yg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}t.getSymbols=e})(Yg);var hh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}t.getTag=e})(hh);var fh={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",l="[object Set]",u="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",v="[object Error]",b="[object DataView]",g="[object Uint8Array]",_="[object Uint8ClampedArray]",T="[object Uint16Array]",E="[object Uint32Array]",j="[object BigUint64Array]",R="[object Int8Array]",D="[object Int16Array]",I="[object Int32Array]",A="[object BigInt64Array]",P="[object Float32Array]",O="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=m,t.arrayTag=u,t.bigInt64ArrayTag=A,t.bigUint64ArrayTag=j,t.booleanTag=i,t.dataViewTag=b,t.dateTag=o,t.errorTag=v,t.float32ArrayTag=P,t.float64ArrayTag=O,t.functionTag=h,t.int16ArrayTag=D,t.int32ArrayTag=I,t.int8ArrayTag=R,t.mapTag=c,t.numberTag=n,t.objectTag=p,t.regexpTag=e,t.setTag=l,t.stringTag=r,t.symbolTag=s,t.uint16ArrayTag=T,t.uint32ArrayTag=E,t.uint8ArrayTag=g,t.uint8ClampedArrayTag=_})(fh);var OI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}t.isTypedArray=e})(OI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yg,r=hh,n=fh,i=Wg,a=OI;function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,m,p=new Map,v=void 0){const b=v?.(u,h,m,p);if(b!=null)return b;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[_,T]of u)g.set(_,o(T,_,m,p,v));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const _ of u)g.add(o(_,void 0,m,p,v));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(a.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let _=0;_<u.length;_++)g[_]=o(u[_],_,m,p,v);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),c(g,u,m,p,v),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),c(g,u,m,p,v),g}if(u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),c(g,u,m,p,v),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,m,p,v),g}if(typeof u=="object"&&l(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),c(g,u,m,p,v),g}return u}function c(u,h,m=u,p,v){const b=[...Object.keys(h),...e.getSymbols(h)];for(let g=0;g<b.length;g++){const _=b[g],T=Object.getOwnPropertyDescriptor(u,_);(T==null||T.writable)&&(u[_]=o(h[_],_,m,p,v))}}function l(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=s,t.cloneDeepWithImpl=o,t.copyProperties=c})(Gg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Gg;function r(n){return e.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}t.cloneDeep=r})(jI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Kg(),r=jI;function n(i){return i=r.cloneDeep(i),a=>e.isMatch(a,i)}t.matches=n})(NI);var RI={},DI={},MI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Gg,r=fh;function n(i,a){return e.cloneDeepWith(i,(s,o,c,l)=>{const u=a?.(s,o,c,l);if(u!=null)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i?.valueOf());return e.copyProperties(h,i),h}case r.argumentsTag:{const h={};return e.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}t.cloneDeepWith=n})(MI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MI;function r(n){return e.cloneDeepWith(n)}t.cloneDeep=r})(DI);var LI={},Zg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return e.test(n)}}t.isIndex=r})(Zg);var $I={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=hh;function r(n){return n!==null&&typeof n=="object"&&e.getTag(n)==="[object Arguments]"}t.isArguments=r})($I);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Mg,r=Zg,n=$I,i=Qd;function a(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&e.isDeepKey(o)&&s?.[o]==null?c=i.toPath(o):c=[o],c.length===0)return!1;let l=s;for(let u=0;u<c.length;u++){const h=c[u];if((l==null||!Object.hasOwn(l,h))&&!((Array.isArray(l)||n.isArguments(l))&&r.isIndex(h)&&h<l.length))return!1;l=l[h]}return!0}t.has=a})(LI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Kg(),r=Lg,n=DI,i=Zd,a=LI;function s(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(l){const u=i.get(l,o);return u===void 0?a.has(l,o):c===void 0?u===void 0:e.isMatch(u,c)}}t.matchesProperty=s})(RI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=qg,r=kI,n=NI,i=RI;function a(s){if(s==null)return e.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}t.iteratee=a})(CI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=AI,r=qg,n=II,i=CI;function a(s,o=r.identity){return n.isArrayLikeObject(s)?e.uniqBy(Array.from(s),i.iteratee(o)):[]}t.uniqBy=a})(TI);var s9=TI.uniqBy;const Lx=Hi(s9);function o9(t,e,r){return e===!0?Lx(t,r):typeof e=="function"?Lx(t,e):t}var VI={exports:{}},FI={},zI={exports:{}},UI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vs=w;function c9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var l9=typeof Object.is=="function"?Object.is:c9,u9=Vs.useState,d9=Vs.useEffect,h9=Vs.useLayoutEffect,f9=Vs.useDebugValue;function m9(t,e){var r=e(),n=u9({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return h9(function(){i.value=r,i.getSnapshot=e,Tf(i)&&a({inst:i})},[t,r,e]),d9(function(){return Tf(i)&&a({inst:i}),t(function(){Tf(i)&&a({inst:i})})},[t]),f9(r),r}function Tf(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!l9(t,r)}catch{return!0}}function p9(t,e){return e()}var g9=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p9:m9;UI.useSyncExternalStore=Vs.useSyncExternalStore!==void 0?Vs.useSyncExternalStore:g9;zI.exports=UI;var y9=zI.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mh=w,v9=y9;function b9(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var x9=typeof Object.is=="function"?Object.is:b9,w9=v9.useSyncExternalStore,_9=mh.useRef,E9=mh.useEffect,T9=mh.useMemo,A9=mh.useDebugValue;FI.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=_9(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=T9(function(){function c(p){if(!l){if(l=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,x9(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var l=!1,u,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=w9(t,a[0],a[1]);return E9(function(){s.hasValue=!0,s.value=o},[o]),A9(o),o};VI.exports=FI;var I9=VI.exports,Qg=w.createContext(null),S9=t=>t,or=()=>{var t=w.useContext(Qg);return t?t.store.dispatch:S9},ou=()=>{},P9=()=>ou,C9=(t,e)=>t===e;function ae(t){var e=w.useContext(Qg);return I9.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:P9,e?e.store.getState:ou,e?e.store.getState:ou,e?t:ou,C9)}function k9(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function N9(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function j9(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(r=>typeof r=="function")){const r=t.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${r}]`)}}var $x=t=>Array.isArray(t)?t:[t];function O9(t){const e=Array.isArray(t[0])?t[0]:t;return j9(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function R9(t,e){const r=[],{length:n}=t;for(let i=0;i<n;i++)r.push(t[i].apply(null,e));return r}var D9=class{constructor(t){this.value=t}deref(){return this.value}},M9=typeof WeakRef<"u"?WeakRef:D9,L9=0,Vx=1;function Dl(){return{s:L9,v:void 0,o:null,p:null}}function BI(t,e={}){let r=Dl();const{resultEqualityCheck:n}=e;let i,a=0;function s(){let o=r;const{length:c}=arguments;for(let h=0,m=c;h<m;h++){const p=arguments[h];if(typeof p=="function"||typeof p=="object"&&p!==null){let v=o.o;v===null&&(o.o=v=new WeakMap);const b=v.get(p);b===void 0?(o=Dl(),v.set(p,o)):o=b}else{let v=o.p;v===null&&(o.p=v=new Map);const b=v.get(p);b===void 0?(o=Dl(),v.set(p,o)):o=b}}const l=o;let u;if(o.s===Vx)u=o.v;else if(u=t.apply(null,arguments),a++,n){const h=i?.deref?.()??i;h!=null&&n(h,u)&&(u=h,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new M9(u):u}return l.s=Vx,l.v=u,u}return s.clearCache=()=>{r=Dl(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function $9(t,...e){const r=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,n=(...i)=>{let a=0,s=0,o,c={},l=i.pop();typeof l=="object"&&(c=l,l=i.pop()),k9(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const u={...r,...c},{memoize:h,memoizeOptions:m=[],argsMemoize:p=BI,argsMemoizeOptions:v=[]}=u,b=$x(m),g=$x(v),_=O9(i),T=h(function(){return a++,l.apply(null,arguments)},...b),E=p(function(){s++;const R=R9(_,arguments);return o=T.apply(null,R),o},...g);return Object.assign(E,{resultFunc:l,memoizedResultFunc:T,dependencies:_,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var V=$9(BI),V9=Object.assign((t,e=V)=>{N9(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const r=Object.keys(t),n=r.map(a=>t[a]);return e(n,(...a)=>a.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>V9}),qI={},HI={},WI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=e(n),o=e(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};t.compareValues=r})(WI);var KI={},Xg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return typeof r=="symbol"||r instanceof Symbol}t.isSymbol=e})(Xg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Xg,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}t.isKey=i})(KI);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WI,r=KI,n=Qd;function i(a,s,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const l=(p,v)=>{let b=p;for(let g=0;g<v.length&&b!=null;++g)b=b[v[g]];return b},u=(p,v)=>v==null||p==null?v:typeof p=="object"&&"key"in p?Object.hasOwn(v,p.key)?v[p.key]:l(v,p.path):typeof p=="function"?p(v):Array.isArray(p)?l(v,p):typeof v=="object"?v[p]:v,h=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:h.map(v=>u(v,p))})).slice().sort((p,v)=>{for(let b=0;b<h.length;b++){const g=e.compareValues(p.criteria[b],v.criteria[b],o[b]);if(g!==0)return g}return 0}).map(p=>p.original)}t.orderBy=i})(HI);var GI={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=1){const i=[],a=Math.floor(n),s=(o,c)=>{for(let l=0;l<o.length;l++){const u=o[l];Array.isArray(u)&&c<a?s(u,c+1):i.push(u)}};return s(r,0),i}t.flatten=e})(GI);var Jg={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Zg,r=uh,n=Hg,i=dh;function a(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&e.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?i.eq(c[o],s):!1}t.isIterateeCall=a})(Jg);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HI,r=GI,n=Jg;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),e.orderBy(a,r.flatten(s),["asc"])}t.sortBy=i})(qI);var F9=qI.sortBy;const ph=Hi(F9);var YI=t=>t.legend.settings,z9=t=>t.legend.size,U9=t=>t.legend.payload;V([U9,YI],(t,e)=>{var{itemSorter:r}=e,n=t.flat(1);return r?ph(n,r):n});var Ml=1;function B9(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-e.height)>Ml||Math.abs(s.left-e.left)>Ml||Math.abs(s.top-e.top)>Ml||Math.abs(s.width-e.width)>Ml)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,n]}function $t(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var q9=typeof Symbol=="function"&&Symbol.observable||"@@observable",Fx=q9,Af=()=>Math.random().toString(36).substring(7).split("").join("."),H9={INIT:`@@redux/INIT${Af()}`,REPLACE:`@@redux/REPLACE${Af()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Af()}`},Vu=H9;function ey(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function ZI(t,e,r){if(typeof t!="function")throw new Error($t(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error($t(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error($t(1));return r(ZI)(t,e)}let n=t,i=e,a=new Map,s=a,o=0,c=!1;function l(){s===a&&(s=new Map,a.forEach((g,_)=>{s.set(_,g)}))}function u(){if(c)throw new Error($t(3));return i}function h(g){if(typeof g!="function")throw new Error($t(4));if(c)throw new Error($t(5));let _=!0;l();const T=o++;return s.set(T,g),function(){if(_){if(c)throw new Error($t(6));_=!1,l(),s.delete(T),a=null}}}function m(g){if(!ey(g))throw new Error($t(7));if(typeof g.type>"u")throw new Error($t(8));if(typeof g.type!="string")throw new Error($t(17));if(c)throw new Error($t(9));try{c=!0,i=n(i,g)}finally{c=!1}return(a=s).forEach(T=>{T()}),g}function p(g){if(typeof g!="function")throw new Error($t(10));n=g,m({type:Vu.REPLACE})}function v(){const g=h;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error($t(11));function T(){const j=_;j.next&&j.next(u())}return T(),{unsubscribe:g(T)}},[Fx](){return this}}}return m({type:Vu.INIT}),{dispatch:m,subscribe:h,getState:u,replaceReducer:p,[Fx]:v}}function W9(t){Object.keys(t).forEach(e=>{const r=t[e];if(typeof r(void 0,{type:Vu.INIT})>"u")throw new Error($t(12));if(typeof r(void 0,{type:Vu.PROBE_UNKNOWN_ACTION()})>"u")throw new Error($t(13))})}function QI(t){const e=Object.keys(t),r={};for(let a=0;a<e.length;a++){const s=e[a];typeof t[s]=="function"&&(r[s]=t[s])}const n=Object.keys(r);let i;try{W9(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let c=!1;const l={};for(let u=0;u<n.length;u++){const h=n[u],m=r[h],p=s[h],v=m(p,o);if(typeof v>"u")throw o&&o.type,new Error($t(14));l[h]=v,c=c||v!==p}return c=c||n.length!==Object.keys(s).length,c?l:s}}function Fu(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...n)=>e(r(...n)))}function K9(...t){return e=>(r,n)=>{const i=e(r,n);let a=()=>{throw new Error($t(15))};const s={getState:i.getState,dispatch:(c,...l)=>a(c,...l)},o=t.map(c=>c(s));return a=Fu(...o)(i.dispatch),{...i,dispatch:a}}}function XI(t){return ey(t)&&"type"in t&&typeof t.type=="string"}function JI(t){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,t):i(a)}var G9=JI(),Y9=JI,Z9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Fu:Fu.apply(null,arguments)};function Fr(t,e){function r(...n){if(e){let i=e(...n);if(!i)throw new Error(Tr(0));return{type:t,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:t,payload:n[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=n=>XI(n)&&n.type===t,r}var eS=class Fo extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Fo.prototype)}static get[Symbol.species](){return Fo}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Fo(...e[0].concat(this)):new Fo(...e.concat(this))}};function zx(t){return Zn(t)?Ie(t,()=>{}):t}function Ll(t,e,r){return t.has(e)?t.get(e):t.set(e,r(e)).get(e)}function Q9(t){return typeof t=="boolean"}var X9=()=>function(e){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=e??{};let s=new eS;return r&&(Q9(r)?s.push(G9):s.push(Y9(r.extraArgument))),s},J9="RTK_autoBatch",Ux=t=>e=>{setTimeout(e,t)},eB=(t={type:"raf"})=>e=>(...r)=>{const n=e(...r);let i=!0,a=!1,s=!1;const o=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Ux(10):t.type==="callback"?t.queueNotification:Ux(t.timeout),l=()=>{s=!1,a&&(a=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),m=n.subscribe(h);return o.add(u),()=>{m(),o.delete(u)}},dispatch(u){try{return i=!u?.meta?.[J9],a=!i,a&&(s||(s=!0,c(l))),n.dispatch(u)}finally{i=!0}}})},tB=t=>function(r){const{autoBatch:n=!0}=r??{};let i=new eS(t);return n&&i.push(eB(typeof n=="object"?n:void 0)),i};function rB(t){const e=X9(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:a=void 0,enhancers:s=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(ey(r))o=QI(r);else throw new Error(Tr(1));let c;typeof n=="function"?c=n(e):c=e();let l=Fu;i&&(l=Z9({trace:!1,...typeof i=="object"&&i}));const u=K9(...c),h=tB(u);let m=typeof s=="function"?s(h):h();const p=l(...m);return ZI(o,a,p)}function tS(t){const e={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Tr(28));if(o in e)throw new Error(Tr(29));return e[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return t(i),[e,r,n]}function nB(t){return typeof t=="function"}function iB(t,e){let[r,n,i]=tS(e),a;if(nB(t))a=()=>zx(t());else{const o=zx(t);a=()=>o}function s(o=a(),c){let l=[r[c.type],...n.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return l.filter(u=>!!u).length===0&&(l=[i]),l.reduce((u,h)=>{if(h)if(Ca(u)){const p=h(u,c);return p===void 0?u:p}else{if(Zn(u))return Ie(u,m=>h(m,c));{const m=h(u,c);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},o)}return s.getInitialState=a,s}var aB="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",sB=(t=21)=>{let e="",r=t;for(;r--;)e+=aB[Math.random()*64|0];return e},oB=Symbol.for("rtk-slice-createasyncthunk");function cB(t,e){return`${t}/${e}`}function lB({creators:t}={}){const e=t?.asyncThunk?.[oB];return function(n){const{name:i,reducerPath:a=i}=n;if(!i)throw new Error(Tr(11));const s=(typeof n.reducers=="function"?n.reducers(dB()):n.reducers)||{},o=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},l={addCase(E,j){const R=typeof E=="string"?E:E.type;if(!R)throw new Error(Tr(12));if(R in c.sliceCaseReducersByType)throw new Error(Tr(13));return c.sliceCaseReducersByType[R]=j,l},addMatcher(E,j){return c.sliceMatchers.push({matcher:E,reducer:j}),l},exposeAction(E,j){return c.actionCreators[E]=j,l},exposeCaseReducer(E,j){return c.sliceCaseReducersByName[E]=j,l}};o.forEach(E=>{const j=s[E],R={reducerName:E,type:cB(i,E),createNotation:typeof n.reducers=="function"};fB(j)?pB(R,j,l,e):hB(R,j,l)});function u(){const[E={},j=[],R=void 0]=typeof n.extraReducers=="function"?tS(n.extraReducers):[n.extraReducers],D={...E,...c.sliceCaseReducersByType};return iB(n.initialState,I=>{for(let A in D)I.addCase(A,D[A]);for(let A of c.sliceMatchers)I.addMatcher(A.matcher,A.reducer);for(let A of j)I.addMatcher(A.matcher,A.reducer);R&&I.addDefaultCase(R)})}const h=E=>E,m=new Map,p=new WeakMap;let v;function b(E,j){return v||(v=u()),v(E,j)}function g(){return v||(v=u()),v.getInitialState()}function _(E,j=!1){function R(I){let A=I[E];return typeof A>"u"&&j&&(A=Ll(p,R,g)),A}function D(I=h){const A=Ll(m,j,()=>new WeakMap);return Ll(A,I,()=>{const P={};for(const[O,N]of Object.entries(n.selectors??{}))P[O]=uB(N,I,()=>Ll(p,I,g),j);return P})}return{reducerPath:E,getSelectors:D,get selectors(){return D(R)},selectSlice:R}}const T={name:i,reducer:b,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:g,..._(a),injectInto(E,{reducerPath:j,...R}={}){const D=j??a;return E.inject({reducerPath:D,reducer:b},R),{...T,..._(D,!0)}}};return T}}function uB(t,e,r,n){function i(a,...s){let o=e(a);return typeof o>"u"&&n&&(o=r()),t(o,...s)}return i.unwrapped=t,i}var Br=lB();function dB(){function t(e,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...r}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...r){return e(...r)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:r}},asyncThunk:t}}function hB({type:t,reducerName:e,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!mB(n))throw new Error(Tr(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,s?Fr(t,s):Fr(t))}function fB(t){return t._reducerDefinitionType==="asyncThunk"}function mB(t){return t._reducerDefinitionType==="reducerWithPrepare"}function pB({type:t,reducerName:e},r,n,i){if(!i)throw new Error(Tr(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:c,settled:l,options:u}=r,h=i(t,a,u);n.exposeAction(e,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),c&&n.addCase(h.rejected,c),l&&n.addMatcher(h.settled,l),n.exposeCaseReducer(e,{fulfilled:s||$l,pending:o||$l,rejected:c||$l,settled:l||$l})}function $l(){}var gB="task",rS="listener",nS="completed",ty="cancelled",yB=`task-${ty}`,vB=`task-${nS}`,zm=`${rS}-${ty}`,bB=`${rS}-${nS}`,gh=class{constructor(t){yr(this,"name","TaskAbortError");yr(this,"message");this.code=t,this.message=`${gB} ${ty} (reason: ${t})`}},ry=(t,e)=>{if(typeof t!="function")throw new TypeError(Tr(32))},zu=()=>{},iS=(t,e=zu)=>(t.catch(e),t),aS=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),Ta=(t,e)=>{const r=t.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},Aa=t=>{if(t.aborted){const{reason:e}=t;throw new gh(e)}};function sS(t,e){let r=zu;return new Promise((n,i)=>{const a=()=>i(new gh(t.reason));if(t.aborted){a();return}r=aS(t,a),e.finally(()=>r()).then(n,i)}).finally(()=>{r=zu})}var xB=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(r){return{status:r instanceof gh?"cancelled":"rejected",error:r}}finally{e?.()}},Uu=t=>e=>iS(sS(t,e).then(r=>(Aa(t),r))),oS=t=>{const e=Uu(t);return r=>e(new Promise(n=>setTimeout(n,r)))},{assign:Cs}=Object,Bx={},yh="listenerMiddleware",wB=(t,e)=>{const r=n=>aS(t,()=>Ta(n,t.reason));return(n,i)=>{ry(n);const a=new AbortController;r(a);const s=xB(async()=>{Aa(t),Aa(a.signal);const o=await n({pause:Uu(a.signal),delay:oS(a.signal),signal:a.signal});return Aa(a.signal),o},()=>Ta(a,vB));return i?.autoJoin&&e.push(s.catch(zu)),{result:Uu(t)(s),cancel(){Ta(a,yB)}}}},_B=(t,e)=>{const r=async(n,i)=>{Aa(e);let a=()=>{};const o=[new Promise((c,l)=>{let u=t({predicate:n,effect:(h,m)=>{m.unsubscribe(),c([h,m.getState(),m.getOriginalState()])}});a=()=>{u(),l()}})];i!=null&&o.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await sS(e,Promise.race(o));return Aa(e),c}finally{a()}};return(n,i)=>iS(r(n,i))},cS=t=>{let{type:e,actionCreator:r,matcher:n,predicate:i,effect:a}=t;if(e)i=Fr(e).match;else if(r)e=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Tr(21));return ry(a),{predicate:i,type:e,effect:a}},lS=Cs(t=>{const{type:e,predicate:r,effect:n}=cS(t);return{id:sB(),effect:n,type:e,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Tr(22))}}},{withTypes:()=>lS}),qx=(t,e)=>{const{type:r,effect:n,predicate:i}=cS(e);return Array.from(t.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},Um=t=>{t.pending.forEach(e=>{Ta(e,zm)})},EB=t=>()=>{t.forEach(Um),t.clear()},Hx=(t,e,r)=>{try{t(e,r)}catch(n){setTimeout(()=>{throw n},0)}},uS=Cs(Fr(`${yh}/add`),{withTypes:()=>uS}),TB=Fr(`${yh}/removeAll`),dS=Cs(Fr(`${yh}/remove`),{withTypes:()=>dS}),AB=(...t)=>{console.error(`${yh}/error`,...t)},Lc=(t={})=>{const e=new Map,{extra:r,onError:n=AB}=t;ry(n);const i=u=>(u.unsubscribe=()=>e.delete(u.id),e.set(u.id,u),h=>{u.unsubscribe(),h?.cancelActive&&Um(u)}),a=u=>{const h=qx(e,u)??lS(u);return i(h)};Cs(a,{withTypes:()=>a});const s=u=>{const h=qx(e,u);return h&&(h.unsubscribe(),u.cancelActive&&Um(h)),!!h};Cs(s,{withTypes:()=>s});const o=async(u,h,m,p)=>{const v=new AbortController,b=_B(a,v.signal),g=[];try{u.pending.add(v),await Promise.resolve(u.effect(h,Cs({},m,{getOriginalState:p,condition:(_,T)=>b(_,T).then(Boolean),take:b,delay:oS(v.signal),pause:Uu(v.signal),extra:r,signal:v.signal,fork:wB(v.signal,g),unsubscribe:u.unsubscribe,subscribe:()=>{e.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((_,T,E)=>{_!==v&&(Ta(_,zm),E.delete(_))})},cancel:()=>{Ta(v,zm),u.pending.delete(v)},throwIfCancelled:()=>{Aa(v.signal)}})))}catch(_){_ instanceof gh||Hx(n,_,{raisedBy:"effect"})}finally{await Promise.all(g),Ta(v,bB),u.pending.delete(v)}},c=EB(e);return{middleware:u=>h=>m=>{if(!XI(m))return h(m);if(uS.match(m))return a(m.payload);if(TB.match(m)){c();return}if(dS.match(m))return s(m.payload);let p=u.getState();const v=()=>{if(p===Bx)throw new Error(Tr(23));return p};let b;try{if(b=h(m),e.size>0){const g=u.getState(),_=Array.from(e.values());for(const T of _){let E=!1;try{E=T.predicate(m,g,p)}catch(j){E=!1,Hx(n,j,{raisedBy:"predicate"})}E&&o(T,m,u,v)}}}finally{p=Bx}return b},startListening:a,stopListening:s,clearListeners:c}};function Tr(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var IB={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},hS=Br({name:"chartLayout",initialState:IB,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){t.margin.top=e.payload.top,t.margin.right=e.payload.right,t.margin.bottom=e.payload.bottom,t.margin.left=e.payload.left},setScale(t,e){t.scale=e.payload}}}),{setMargin:SB,setLayout:PB,setChartSize:CB,setScale:kB}=hS.actions,NB=hS.reducer;function Wx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kx(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Wx(Object(r),!0).forEach(function(n){jB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Wx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function jB(t,e,r){return(e=OB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OB(t){var e=RB(t,"string");return typeof e=="symbol"?e:e+""}function RB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bu=Math.PI/180,DB=t=>t*180/Math.PI,Ut=(t,e,r,n)=>({x:t+Math.cos(-Bu*n)*r,y:e+Math.sin(-Bu*n)*r}),MB=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},LB=(t,e)=>{var{x:r,y:n}=t,{x:i,y:a}=e;return Math.sqrt((r-i)**2+(n-a)**2)},$B=(t,e)=>{var{x:r,y:n}=t,{cx:i,cy:a}=e,s=LB({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:s,angle:DB(c),angleInRadian:c}},VB=t=>{var{startAngle:e,endAngle:r}=t,n=Math.floor(e/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:e-a*360,endAngle:r-a*360}},FB=(t,e)=>{var{startAngle:r,endAngle:n}=e,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return t+s*360},zB=(t,e)=>{var{x:r,y:n}=t,{radius:i,angle:a}=$B({x:r,y:n},e),{innerRadius:s,outerRadius:o}=e;if(i<s||i>o||i===0)return null;var{startAngle:c,endAngle:l}=VB(e),u=a,h;if(c<=l){for(;u>l;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=l}else{for(;u>c;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=c}return h?Kx(Kx({},e),{},{radius:i,angle:FB(u,e)}):null};function Gx(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Rr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gx(Object(r),!0).forEach(function(n){UB(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gx(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function UB(t,e,r){return(e=BB(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function BB(t){var e=qB(t,"string");return typeof e=="symbol"?e:e+""}function qB(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ar(t,e,r){return lt(t)||lt(e)?r:Sn(e)?za(t,e,r):typeof e=="function"?e(t):r}var HB=(t,e,r,n,i)=>{var a,s=-1,o=(a=e?.length)!==null&&a!==void 0?a:0;if(o<=1||t==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var c=0;c<o;c++){var l=c>0?r[c-1].coordinate:r[o-1].coordinate,u=r[c].coordinate,h=c>=o-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(Lr(u-l)!==Lr(h-u)){var p=[];if(Lr(h-u)===Lr(i[1]-i[0])){m=h;var v=u+i[1]-i[0];p[0]=Math.min(v,(v+l)/2),p[1]=Math.max(v,(v+l)/2)}else{m=l;var b=h+i[1]-i[0];p[0]=Math.min(u,(b+u)/2),p[1]=Math.max(u,(b+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(t>g[0]&&t<=g[1]||t>=p[0]&&t<=p[1]){({index:s}=r[c]);break}}else{var _=Math.min(l,h),T=Math.max(l,h);if(t>(_+u)/2&&t<=(T+u)/2){({index:s}=r[c]);break}}}else if(e){for(var E=0;E<o;E++)if(E===0&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E>0&&E<o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2&&t<=(e[E].coordinate+e[E+1].coordinate)/2||E===o-1&&t>(e[E].coordinate+e[E-1].coordinate)/2){({index:s}=e[E]);break}}return s},WB=(t,e,r)=>{if(e&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=e;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&re(t[a]))return Rr(Rr({},t),{},{[a]:t[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&re(t[s]))return Rr(Rr({},t),{},{[s]:t[s]+(i||0)})}return t},Yi=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",fS=(t,e,r,n)=>{if(n)return t.map(o=>o.coordinate);var i,a,s=t.map(o=>(o.coordinate===e&&(i=!0),o.coordinate===r&&(a=!0),o.coordinate));return i||s.push(e),a||s.push(r),s},mS=(t,e,r)=>{if(!t)return null;var{duplicateDomain:n,type:i,range:a,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:l,tickCount:u,ticks:h,niceTicks:m,axisType:p}=t;if(!s)return null;var v=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,b=i==="category"&&s.bandwidth?s.bandwidth()/v:0;if(b=p==="angleAxis"&&a&&a.length>=2?Lr(a[0]-a[1])*2*b:b,h||m){var g=(h||m||[]).map((_,T)=>{var E=n?n.indexOf(_):_;return{coordinate:s(E)+b,value:_,offset:b,index:T}});return g.filter(_=>!Vr(_.coordinate))}return c&&l?l.map((_,T)=>({coordinate:s(_)+b,value:_,index:T,offset:b})):s.ticks&&u!=null?s.ticks(u).map((_,T)=>({coordinate:s(_)+b,value:_,offset:b,index:T})):s.domain().map((_,T)=>({coordinate:s(_)+b,value:n?n[_]:_,index:T,offset:b}))},Yx=1e-4,KB=t=>{var e=t.domain();if(!(!e||e.length<=2)){var r=e.length,n=t.range(),i=Math.min(n[0],n[1])-Yx,a=Math.max(n[0],n[1])+Yx,s=t(e[0]),o=t(e[r-1]);(s<i||s>a||o<i||o>a)&&t.domain([e[0],e[r-1]])}},GB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0,s=0;s<e;++s){var o=Vr(t[s][r][1])?t[s][r][0]:t[s][r][1];o>=0?(t[s][r][0]=i,t[s][r][1]=i+o,i=t[s][r][1]):(t[s][r][0]=a,t[s][r][1]=a+o,a=t[s][r][1])}},YB=t=>{var e=t.length;if(!(e<=0))for(var r=0,n=t[0].length;r<n;++r)for(var i=0,a=0;a<e;++a){var s=Vr(t[a][r][1])?t[a][r][0]:t[a][r][1];s>=0?(t[a][r][0]=i,t[a][r][1]=i+s,i=t[a][r][1]):(t[a][r][0]=0,t[a][r][1]=0)}},ZB={sign:GB,expand:r9,none:$s,silhouette:n9,wiggle:i9,positive:YB},QB=(t,e,r)=>{var n=ZB[r],i=t9().keys(e).value((a,s)=>+Ar(a,s,0)).order(Fm).offset(n);return i(t)};function XB(t){return t==null?void 0:String(t)}function Zx(t){var{axis:e,ticks:r,bandSize:n,entry:i,index:a,dataKey:s}=t;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!lt(i[e.dataKey])){var o=aI(r,"value",i[e.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=Ar(i,lt(s)?e.dataKey:s);return lt(c)?null:e.scale(c)}var JB=t=>{var e=t.flat(2).filter(re);return[Math.min(...e),Math.max(...e)]},e8=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],t8=(t,e,r)=>{if(t!=null)return e8(Object.keys(t).reduce((n,i)=>{var a=t[i],{stackedData:s}=a,o=s.reduce((c,l)=>{var u=JB(l.slice(e,r+1));return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Qx=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Xx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Bm=(t,e,r)=>{if(t&&t.scale&&t.scale.bandwidth){var n=t.scale.bandwidth();if(!r||n>0)return n}if(t&&e&&e.length>=2){for(var i=ph(e,u=>u.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var c=i[s],l=i[s-1];a=Math.min((c.coordinate||0)-(l.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function Jx(t){var{tooltipEntrySettings:e,dataKey:r,payload:n,value:i,name:a}=t;return Rr(Rr({},e),{},{dataKey:r,payload:n,value:i,name:a})}function pS(t,e){if(t)return String(t);if(typeof e=="string")return e}function r8(t,e,r,n,i){if(r==="horizontal"||r==="vertical"){var a=t>=i.left&&t<=i.left+i.width&&e>=i.top&&e<=i.top+i.height;return a?{x:t,y:e}:null}return n?zB({x:t,y:e},n):null}var n8=(t,e,r,n)=>{var i=e.find(l=>l&&l.index===r);if(i){if(t==="horizontal")return{x:i.coordinate,y:n.y};if(t==="vertical")return{x:n.x,y:i.coordinate};if(t==="centric"){var a=i.coordinate,{radius:s}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:c}=n;return Rr(Rr(Rr({},n),Ut(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},i8=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,ai=t=>t.layout.width,si=t=>t.layout.height,a8=t=>t.layout.scale,gS=t=>t.layout.margin,ny=V(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),iy=V(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),s8="data-recharts-item-index",o8="data-recharts-item-data-key",vh=60;function ew(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function gi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ew(Object(r),!0).forEach(function(n){c8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ew(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function c8(t,e,r){return(e=l8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l8(t){var e=u8(t,"string");return typeof e=="symbol"?e:e+""}function u8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var d8=t=>t.brush.height,qt=V([ai,si,gS,d8,ny,iy,YI,z9],(t,e,r,n,i,a,s,o)=>{var c=a.reduce((v,b)=>{var{orientation:g}=b;if(!b.mirror&&!b.hide){var _=typeof b.width=="number"?b.width:vh;return gi(gi({},v),{},{[g]:v[g]+_})}return v},{left:r.left||0,right:r.right||0}),l=i.reduce((v,b)=>{var{orientation:g}=b;return!b.mirror&&!b.hide?gi(gi({},v),{},{[g]:za(v,"".concat(g))+b.height}):v},{top:r.top||0,bottom:r.bottom||0}),u=gi(gi({},l),c),h=u.bottom;u.bottom+=n,u=WB(u,s,o);var m=t-u.left-u.right,p=e-u.top-u.bottom;return gi(gi({brushBottom:h},u),{},{width:Math.max(m,0),height:Math.max(p,0)})}),h8=V(qt,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),yS=V(ai,si,(t,e)=>({x:0,y:0,width:t,height:e})),f8=w.createContext(null),mr=()=>w.useContext(f8)!=null,bh=t=>t.brush,xh=V([bh,qt,gS],(t,e,r)=>({height:t.height,x:re(t.x)?t.x:e.left,y:re(t.y)?t.y:e.top+e.height+e.brushBottom-(r?.bottom||0),width:re(t.width)?t.width:e.width})),ay=()=>{var t,e=mr(),r=ae(h8),n=ae(xh),i=(t=ae(bh))===null||t===void 0?void 0:t.padding;return!e||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},m8={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},vS=()=>{var t;return(t=ae(qt))!==null&&t!==void 0?t:m8},bS=()=>ae(ai),xS=()=>ae(si),tt=t=>t.layout.layoutType,sy=()=>ae(tt),p8={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},wS=Br({name:"legend",initialState:p8,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var r=Bn(t).payload.indexOf(e.payload);r>-1&&t.payload.splice(r,1)}}}),{setLegendSize:ete,setLegendSettings:tte,addLegendPayload:g8,removeLegendPayload:y8}=wS.actions,v8=wS.reducer;function qm(){return qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qm.apply(null,arguments)}function tw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function If(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tw(Object(r),!0).forEach(function(n){b8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function b8(t,e,r){return(e=x8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x8(t){var e=w8(t,"string");return typeof e=="symbol"?e:e+""}function w8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _8(t){return Array.isArray(t)&&Sn(t[0])&&Sn(t[1])?t.join(" ~ "):t}var E8=t=>{var{separator:e=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:l,label:u,labelFormatter:h,accessibilityLayer:m=!1}=t,p=()=>{if(a&&a.length){var R={padding:0,margin:0},D=(o?ph(a,o):a).map((I,A)=>{if(I.type==="none")return null;var P=I.formatter||s||_8,{value:O,name:N}=I,C=O,k=N;if(P){var J=P(O,N,I,A,a);if(Array.isArray(J))[C,k]=J;else if(J!=null)C=J;else return null}var oe=If({display:"block",paddingTop:4,paddingBottom:4,color:I.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:oe},Sn(k)?w.createElement("span",{className:"recharts-tooltip-item-name"},k):null,Sn(k)?w.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,w.createElement("span",{className:"recharts-tooltip-item-value"},C),w.createElement("span",{className:"recharts-tooltip-item-unit"},I.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:R},D)}return null},v=If({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),b=If({margin:0},i),g=!lt(u),_=g?u:"",T=Le("recharts-default-tooltip",c),E=Le("recharts-tooltip-label",l);g&&h&&a!==void 0&&a!==null&&(_=h(u,a));var j=m?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",qm({className:T,style:v},j),w.createElement("p",{className:E,style:b},w.isValidElement(_)?_:"".concat(_)),p())},Io="recharts-tooltip-wrapper",T8={visibility:"hidden"};function A8(t){var{coordinate:e,translateX:r,translateY:n}=t;return Le(Io,{["".concat(Io,"-right")]:re(r)&&e&&re(e.x)&&r>=e.x,["".concat(Io,"-left")]:re(r)&&e&&re(e.x)&&r<e.x,["".concat(Io,"-bottom")]:re(n)&&e&&re(e.y)&&n>=e.y,["".concat(Io,"-top")]:re(n)&&e&&re(e.y)&&n<e.y})}function rw(t){var{allowEscapeViewBox:e,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:l}=t;if(a&&re(a[n]))return a[n];var u=r[n]-o-(i>0?i:0),h=r[n]+i;if(e[n])return s[n]?u:h;var m=c[n];if(m==null)return 0;if(s[n]){var p=u,v=m;return p<v?Math.max(h,m):Math.max(u,m)}if(l==null)return 0;var b=h+o,g=m+l;return b>g?Math.max(u,m):Math.max(h,m)}function I8(t){var{translateX:e,translateY:r,useTranslate3d:n}=t;return{transform:n?"translate3d(".concat(e,"px, ").concat(r,"px, 0)"):"translate(".concat(e,"px, ").concat(r,"px)")}}function S8(t){var{allowEscapeViewBox:e,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:c}=t,l,u,h;return s.height>0&&s.width>0&&r?(u=rw({allowEscapeViewBox:e,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),h=rw({allowEscapeViewBox:e,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),l=I8({translateX:u,translateY:h,useTranslate3d:o})):l=T8,{cssProperties:l,cssClasses:A8({translateX:u,translateY:h,coordinate:r})}}function nw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Vl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?nw(Object(r),!0).forEach(function(n){Hm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Hm(t,e,r){return(e=P8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P8(t){var e=C8(t,"string");return typeof e=="symbol"?e:e+""}function C8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k8 extends w.PureComponent{constructor(){super(...arguments),Hm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Hm(this,"handleKeyDown",e=>{if(e.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,r;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:c,offset:l,position:u,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:v,lastBoundingBox:b,innerRef:g,hasPortalFromProps:_}=this.props,{cssClasses:T,cssProperties:E}=S8({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:l,position:u,reverseDirection:h,tooltipBox:{height:b.height,width:b.width},useTranslate3d:m,viewBox:p}),j=_?{}:Vl(Vl({transition:c&&e?"transform ".concat(n,"ms ").concat(i):void 0},E),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&o?"visible":"hidden",position:"absolute",top:0,left:0}),R=Vl(Vl({},j),{},{visibility:!this.state.dismissed&&e&&o?"visible":"hidden"},v);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:R,ref:g},a)}}var N8=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),$c={isSsr:N8()},_S=()=>ae(t=>t.rootProps.accessibilityLayer);function rn(t){return Number.isFinite(t)}function qu(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function Wm(){return Wm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wm.apply(null,arguments)}function iw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function aw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?iw(Object(r),!0).forEach(function(n){j8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):iw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function j8(t,e,r){return(e=O8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O8(t){var e=R8(t,"string");return typeof e=="symbol"?e:e+""}function R8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sw={curveBasisClosed:qU,curveBasisOpen:HU,curveBasis:BU,curveBumpX:zU,curveBumpY:UU,curveLinearClosed:WU,curveLinear:ch,curveMonotoneX:KU,curveMonotoneY:GU,curveNatural:YU,curveStep:ZU,curveStepAfter:XU,curveStepBefore:QU},Fl=t=>rn(t.x)&&rn(t.y),So=t=>t.x,Po=t=>t.y,D8=(t,e)=>{if(typeof t=="function")return t;var r="curve".concat(Fg(t));return(r==="curveMonotone"||r==="curveBump")&&e?sw["".concat(r).concat(e==="vertical"?"Y":"X")]:sw[r]||ch},M8=t=>{var{type:e="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=t,s=D8(e,i),o=a?r.filter(Fl):r,c;if(Array.isArray(n)){var l=a?n.filter(h=>Fl(h)):n,u=o.map((h,m)=>aw(aw({},h),{},{base:l[m]}));return i==="vertical"?c=Rl().y(Po).x1(So).x0(h=>h.base.x):c=Rl().x(So).y1(Po).y0(h=>h.base.y),c.defined(Fl).curve(s),c(u)}return i==="vertical"&&re(n)?c=Rl().y(Po).x1(So).x0(n):re(n)?c=Rl().x(So).y1(Po).y0(n):c=pI().x(So).y(Po),c.defined(Fl).curve(s),c(o)},ES=t=>{var{className:e,points:r,path:n,pathRef:i}=t;if((!r||!r.length)&&!n)return null;var a=r&&r.length?M8(t):n;return w.createElement("path",Wm({},Ge(t,!1),Ug(t),{className:Le("recharts-curve",e),d:a===null?void 0:a,ref:i}))},L8=["x","y","top","left","width","height","className"];function Km(){return Km=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Km.apply(null,arguments)}function ow(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function $8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ow(Object(r),!0).forEach(function(n){V8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ow(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function V8(t,e,r){return(e=F8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F8(t){var e=z8(t,"string");return typeof e=="symbol"?e:e+""}function z8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U8(t,e){if(t==null)return{};var r,n,i=B8(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function B8(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var q8=(t,e,r,n,i,a)=>"M".concat(t,",").concat(i,"v").concat(n,"M").concat(a,",").concat(e,"h").concat(r),H8=t=>{var{x:e=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=t,c=U8(t,L8),l=$8({x:e,y:r,top:n,left:i,width:a,height:s},c);return!re(e)||!re(r)||!re(a)||!re(s)||!re(n)||!re(i)?null:w.createElement("path",Km({},Ge(l,!0),{className:Le("recharts-cross",o),d:q8(e,r,a,s,n,i)}))};function W8(t,e,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:r.left+.5,y:t==="horizontal"?r.top+.5:e.y-i,width:t==="horizontal"?n:r.width-1,height:t==="horizontal"?r.height-1:n}}function cw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function K8(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?cw(Object(r),!0).forEach(function(n){G8(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):cw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function G8(t,e,r){return(e=Y8(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y8(t){var e=Z8(t,"string");return typeof e=="symbol"?e:e+""}function Z8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xa(t,e){var r=K8({},t),n=e,i=Object.keys(e),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var TS={},AS={},IS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}t.isPlainObject=e})(IS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=IS,r=Yg,n=hh,i=fh,a=dh;function s(l,u,h){return o(l,u,void 0,void 0,void 0,void 0,h)}function o(l,u,h,m,p,v,b){const g=b(l,u,h,m,p,v);if(g!==void 0)return g;if(typeof l==typeof u)switch(typeof l){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return l===u;case"number":return l===u||Object.is(l,u);case"function":return l===u;case"object":return c(l,u,v,b)}return c(l,u,v,b)}function c(l,u,h,m){if(Object.is(l,u))return!0;let p=n.getTag(l),v=n.getTag(u);if(p===i.argumentsTag&&(p=i.objectTag),v===i.argumentsTag&&(v=i.objectTag),p!==v)return!1;switch(p){case i.stringTag:return l.toString()===u.toString();case i.numberTag:{const _=l.valueOf(),T=u.valueOf();return a.eq(_,T)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(l.valueOf(),u.valueOf());case i.regexpTag:return l.source===u.source&&l.flags===u.flags;case i.functionTag:return l===u}h=h??new Map;const b=h.get(l),g=h.get(u);if(b!=null&&g!=null)return b===u;h.set(l,u),h.set(u,l);try{switch(p){case i.mapTag:{if(l.size!==u.size)return!1;for(const[_,T]of l.entries())if(!u.has(_)||!o(T,u.get(_),_,l,u,h,m))return!1;return!0}case i.setTag:{if(l.size!==u.size)return!1;const _=Array.from(l.values()),T=Array.from(u.values());for(let E=0;E<_.length;E++){const j=_[E],R=T.findIndex(D=>o(j,D,void 0,l,u,h,m));if(R===-1)return!1;T.splice(R,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(l)!==Buffer.isBuffer(u)||l.length!==u.length)return!1;for(let _=0;_<l.length;_++)if(!o(l[_],u[_],_,l,u,h,m))return!1;return!0}case i.arrayBufferTag:return l.byteLength!==u.byteLength?!1:c(new Uint8Array(l),new Uint8Array(u),h,m);case i.dataViewTag:return l.byteLength!==u.byteLength||l.byteOffset!==u.byteOffset?!1:c(new Uint8Array(l),new Uint8Array(u),h,m);case i.errorTag:return l.name===u.name&&l.message===u.message;case i.objectTag:{if(!(c(l.constructor,u.constructor,h,m)||e.isPlainObject(l)&&e.isPlainObject(u)))return!1;const T=[...Object.keys(l),...r.getSymbols(l)],E=[...Object.keys(u),...r.getSymbols(u)];if(T.length!==E.length)return!1;for(let j=0;j<T.length;j++){const R=T[j],D=l[R];if(!Object.hasOwn(u,R))return!1;const I=u[R];if(!o(D,I,R,l,u,h,m))return!1}return!0}default:return!1}}finally{h.delete(l),h.delete(u)}}t.isEqualWith=s})(AS);var SS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(){}t.noop=e})(SS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=AS,r=SS;function n(i,a){return e.isEqualWith(i,a,r.noop)}t.isEqual=n})(TS);var Q8=TS.isEqual;const X8=Hi(Q8);function J8(t){var e={},r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...l]=o;if(typeof c=="number"){i=t.setTimeout(a.bind(null,l),c);return}a(c),i=t.setTimeout(a.bind(null,l));return}typeof s=="object"&&(e=s,r(e)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>t}}var Hu=1e-4,PS=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],CS=(t,e)=>t.map((r,n)=>r*e**n).reduce((r,n)=>r+n),lw=(t,e)=>r=>{var n=PS(t,e);return CS(n,r)},eq=(t,e)=>r=>{var n=PS(t,e),i=[...n.map((a,s)=>a*s).slice(1),0];return CS(i,r)},uw=function(){for(var e,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[e,n,r,i]=[0,0,1,1];break;case"ease":[e,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[e,n,r,i]=[.42,0,1,1];break;case"ease-out":[e,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[e,n,r,i]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([e,n,r,i]=c[1].split(")")[0].split(",").map(v=>parseFloat(v)))}}else s.length===4&&([e,n,r,i]=s);var l=lw(e,r),u=lw(n,i),h=eq(e,r),m=v=>v>1?1:v<0?0:v,p=v=>{for(var b=v>1?1:v,g=b,_=0;_<8;++_){var T=l(g)-b,E=h(g);if(Math.abs(T-b)<Hu||E<Hu)return u(g);g=m(g-T/E)}return u(g)};return p.isStepper=!1,p},tq=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=e,a=(s,o,c)=>{var l=-(s-o)*r,u=c*n,h=c+(l-u)*i/1e3,m=c*i/1e3+s;return Math.abs(m-o)<Hu&&Math.abs(h)<Hu?[o,0]:[m,h]};return a.isStepper=!0,a.dt=i,a},rq=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return uw(t);case"spring":return tq();default:if(t.split("(")[0]==="cubic-bezier")return uw(t)}return typeof t=="function"?t:null};function dw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function hw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dw(Object(r),!0).forEach(function(n){nq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nq(t,e,r){return(e=iq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iq(t){var e=aq(t,"string");return typeof e=="symbol"?e:e+""}function aq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sq=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),oq=(t,e,r)=>t.map(n=>"".concat(sq(n)," ").concat(e,"ms ").concat(r)).join(","),cq=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((r,n)=>r.filter(i=>n.includes(i))),mc=(t,e)=>Object.keys(e).reduce((r,n)=>hw(hw({},r),{},{[n]:t(n,e[n])}),{});function fw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fw(Object(r),!0).forEach(function(n){lq(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lq(t,e,r){return(e=uq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uq(t){var e=dq(t,"string");return typeof e=="symbol"?e:e+""}function dq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wu=(t,e,r)=>t+(e-t)*r,Gm=t=>{var{from:e,to:r}=t;return e!==r},kS=(t,e,r)=>{var n=mc((i,a)=>{if(Gm(a)){var[s,o]=t(a.from,a.to,a.velocity);return Ft(Ft({},a),{},{from:s,velocity:o})}return a},e);return r<1?mc((i,a)=>Gm(a)?Ft(Ft({},a),{},{velocity:Wu(a.velocity,n[i].velocity,r),from:Wu(a.from,n[i].from,r)}):a,e):kS(t,n,r-1)};function hq(t,e,r,n,i,a){var s,o=n.reduce((m,p)=>Ft(Ft({},m),{},{[p]:{from:t[p],velocity:0,to:e[p]}}),{}),c=()=>mc((m,p)=>p.from,o),l=()=>!Object.values(o).filter(Gm).length,u=null,h=m=>{s||(s=m);var p=m-s,v=p/r.dt;o=kS(r,o,v),i(Ft(Ft(Ft({},t),e),c())),s=m,l()||(u=a.setTimeout(h))};return()=>(u=a.setTimeout(h),()=>{u()})}function fq(t,e,r,n,i,a,s){var o=null,c=i.reduce((h,m)=>Ft(Ft({},h),{},{[m]:[t[m],e[m]]}),{}),l,u=h=>{l||(l=h);var m=(h-l)/n,p=mc((b,g)=>Wu(...g,r(m)),c);if(a(Ft(Ft(Ft({},t),e),p)),m<1)o=s.setTimeout(u);else{var v=mc((b,g)=>Wu(...g,r(1)),c);a(Ft(Ft(Ft({},t),e),v))}};return()=>(o=s.setTimeout(u),()=>{o()})}const mq=(t,e,r,n,i,a)=>{var s=cq(t,e);return r.isStepper===!0?hq(t,e,r,s,i,a):fq(t,e,r,n,s,i,a)};class pq{setTimeout(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?e(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}var gq=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Ym(){return Ym=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ym.apply(null,arguments)}function yq(t,e){if(t==null)return{};var r,n,i=vq(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vq(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function mw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function yi(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mw(Object(r),!0).forEach(function(n){ya(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mw(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function ya(t,e,r){return(e=bq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bq(t){var e=xq(t,"string");return typeof e=="symbol"?e:e+""}function xq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wq(){return J8(new pq)}class oy extends w.PureComponent{constructor(e,r){super(e,r),ya(this,"mounted",!1),ya(this,"manager",null),ya(this,"stopJSAnimation",null),ya(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:c,animationManager:l}=this.props;if(this.manager=l,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||c<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:e,canBegin:r}=this.props;this.mounted=!0,!(!e||!r)&&this.runAnimation(this.props)}componentDidUpdate(e){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:c}=this.state;if(n){if(!r){var l={style:i?{[i]:s}:s};this.state&&c&&(i&&c[i]!==s||!i&&c!==s)&&this.setState(l);return}if(!(X8(e.to,s)&&e.canBegin&&e.isActive)){var u=!e.canBegin||!e.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=u||a?o:e.to;if(this.state&&c){var m={style:i?{[i]:h}:h};(i&&c[i]!==h||!i&&c!==h)&&this.setState(m)}this.runAnimation(yi(yi({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:e}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),e&&e()}handleStyleChange(e){this.changeStyle(e)}changeStyle(e){this.mounted&&this.setState({style:e})}runJSAnimation(e){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:c}=e,l=mq(r,n,rq(a),i,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=l()};this.manager.start([c,s,u,i,o])}runAnimation(e){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:c,children:l}=e;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof l=="function"||s==="spring"){this.runJSAnimation(e);return}var u=i?{[i]:a}:a,h=oq(Object.keys(u),n,s);this.manager.start([o,r,yi(yi({},u),{},{transition:h}),n,c])}render(){var e=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:c,to:l,canBegin:u,onAnimationEnd:h,shouldReAnimate:m,onAnimationReStart:p,animationManager:v}=e,b=yq(e,gq),g=w.Children.count(r),_=this.state.style;if(typeof r=="function")return r(_);if(!o||g===0||i<=0)return r;var T=E=>{var{style:j={},className:R}=E.props,D=w.cloneElement(E,yi(yi({},b),{},{style:yi(yi({},j),_),className:R}));return D};return g===1?T(w.Children.only(r)):w.createElement("div",null,w.Children.map(r,E=>T(E)))}}ya(oy,"displayName","Animate");ya(oy,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var _q=w.createContext(null);function Ku(t){var e,r,n=w.useContext(_q);return w.createElement(oy,Ym({},t,{animationManager:(e=(r=t.animationManager)!==null&&r!==void 0?r:n)!==null&&e!==void 0?e:wq()}))}function Gu(){return Gu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Gu.apply(null,arguments)}var pw=(t,e,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,l;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>a?a:i[h];l="M".concat(t,",").concat(e+s*u[0]),u[0]>0&&(l+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(t+o*u[0],",").concat(e)),l+="L ".concat(t+r-o*u[1],",").concat(e),u[1]>0&&(l+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(t+r,",").concat(e+s*u[1])),l+="L ".concat(t+r,",").concat(e+n-s*u[2]),u[2]>0&&(l+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(t+r-o*u[2],",").concat(e+n)),l+="L ".concat(t+o*u[3],",").concat(e+n),u[3]>0&&(l+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(e+n-s*u[3])),l+="Z"}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);l="M ".concat(t,",").concat(e+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+o*p,",").concat(e,`
            L `).concat(t+r-o*p,",").concat(e,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r,",").concat(e+s*p,`
            L `).concat(t+r,",").concat(e+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+r-o*p,",").concat(e+n,`
            L `).concat(t+o*p,",").concat(e+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t,",").concat(e+n-s*p," Z")}else l="M ".concat(t,",").concat(e," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return l},Eq={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Tq=t=>{var e=Xa(t,Eq),r=w.useRef(null),[n,i]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&i(_)}catch{}},[]);var{x:a,y:s,width:o,height:c,radius:l,className:u}=e,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:v,isUpdateAnimationActive:b}=e;if(a!==+a||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var g=Le("recharts-rectangle",u);return b?w.createElement(Ku,{canBegin:n>0,from:{width:o,height:c,x:a,y:s},to:{width:o,height:c,x:a,y:s},duration:m,animationEasing:h,isActive:b},_=>{var{width:T,height:E,x:j,y:R}=_;return w.createElement(Ku,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:p,duration:m,isActive:v,easing:h},w.createElement("path",Gu({},Ge(e,!0),{className:g,d:pw(j,R,T,E,l),ref:r})))}):w.createElement("path",Gu({},Ge(e,!0),{className:g,d:pw(a,s,o,c,l)}))};function NS(t){var{cx:e,cy:r,radius:n,startAngle:i,endAngle:a}=t,s=Ut(e,r,n,i),o=Ut(e,r,n,a);return{points:[s,o],cx:e,cy:r,radius:n,startAngle:i,endAngle:a}}function Zm(){return Zm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zm.apply(null,arguments)}var Aq=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),359.999);return r*n},zl=t=>{var{cx:e,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:c}=t,l=o*(s?1:-1)+n,u=Math.asin(o/l)/Bu,h=c?i:i+a*u,m=Ut(e,r,l,h),p=Ut(e,r,n,h),v=c?i-a*u:i,b=Ut(e,r,l*Math.cos(u*Bu),v);return{center:m,circleTangency:p,lineTangency:b,theta:u}},jS=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=t,o=Aq(a,s),c=a+o,l=Ut(e,r,i,a),u=Ut(e,r,i,c),h="M ".concat(l.x,",").concat(l.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var m=Ut(e,r,n,a),p=Ut(e,r,n,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(e,",").concat(r," Z");return h},Iq=t=>{var{cx:e,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:l}=t,u=Lr(l-c),{circleTangency:h,lineTangency:m,theta:p}=zl({cx:e,cy:r,radius:i,angle:c,sign:u,cornerRadius:a,cornerIsExternal:o}),{circleTangency:v,lineTangency:b,theta:g}=zl({cx:e,cy:r,radius:i,angle:l,sign:-u,cornerRadius:a,cornerIsExternal:o}),_=o?Math.abs(c-l):Math.abs(c-l)-p-g;if(_<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):jS({cx:e,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:l});var T="M ".concat(m.x,",").concat(m.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(b.x,",").concat(b.y,`
  `);if(n>0){var{circleTangency:E,lineTangency:j,theta:R}=zl({cx:e,cy:r,radius:n,angle:c,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:D,lineTangency:I,theta:A}=zl({cx:e,cy:r,radius:n,angle:l,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(c-l):Math.abs(c-l)-R-A;if(P<0&&a===0)return"".concat(T,"L").concat(e,",").concat(r,"Z");T+="L".concat(I.x,",").concat(I.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(u>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(j.x,",").concat(j.y,"Z")}else T+="L".concat(e,",").concat(r,"Z");return T},Sq={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Pq=t=>{var e=Xa(t,Sq),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:u,className:h}=e;if(a<i||l===u)return null;var m=Le("recharts-sector",h),p=a-i,v=zi(s,p,0,!0),b;return v>0&&Math.abs(l-u)<360?b=Iq({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:l,endAngle:u}):b=jS({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:l,endAngle:u}),w.createElement("path",Zm({},Ge(e,!0),{className:m,d:b}))};function Cq(t,e,r){var n,i,a,s;if(t==="horizontal")n=e.x,a=n,i=r.top,s=r.top+r.height;else if(t==="vertical")i=e.y,s=i,n=r.left,a=r.left+r.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:o,cy:c,innerRadius:l,outerRadius:u,angle:h}=e,m=Ut(o,c,l,h),p=Ut(o,c,u,h);n=m.x,i=m.y,a=p.x,s=p.y}else return NS(e);return[{x:n,y:i},{x:a,y:s}]}var OS={},RS={},DS={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Xg;function r(n){return e.isSymbol(n)?NaN:Number(n)}t.toNumber=r})(DS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=DS;function r(n){return n?(n=e.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}t.toFinite=r})(RS);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Jg,r=RS;function n(i,a,s){s&&typeof s!="number"&&e.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),c=new Array(o);for(let l=0;l<o;l++)c[l]=i,i+=s;return c}t.range=n})(OS);var kq=OS.range;const MS=Hi(kq);function ji(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nq(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cy(t){let e,r,n;t.length!==2?(e=ji,r=(o,c)=>ji(t(o),c),n=(o,c)=>t(o)-c):(e=t===ji||t===Nq?t:jq,r=t,n=t);function i(o,c,l=0,u=o.length){if(l<u){if(e(c,c)!==0)return u;do{const h=l+u>>>1;r(o[h],c)<0?l=h+1:u=h}while(l<u)}return l}function a(o,c,l=0,u=o.length){if(l<u){if(e(c,c)!==0)return u;do{const h=l+u>>>1;r(o[h],c)<=0?l=h+1:u=h}while(l<u)}return l}function s(o,c,l=0,u=o.length){const h=i(o,c,l,u-1);return h>l&&n(o[h-1],c)>-n(o[h],c)?h-1:h}return{left:i,center:s,right:a}}function jq(){return 0}function LS(t){return t===null?NaN:+t}function*Oq(t,e){for(let r of t)r!=null&&(r=+r)>=r&&(yield r)}const Rq=cy(ji),Vc=Rq.right;cy(LS).center;class gw extends Map{constructor(e,r=Lq){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(yw(this,e))}has(e){return super.has(yw(this,e))}set(e,r){return super.set(Dq(this,e),r)}delete(e){return super.delete(Mq(this,e))}}function yw({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):r}function Dq({_intern:t,_key:e},r){const n=e(r);return t.has(n)?t.get(n):(t.set(n,r),r)}function Mq({_intern:t,_key:e},r){const n=e(r);return t.has(n)&&(r=t.get(n),t.delete(n)),r}function Lq(t){return t!==null&&typeof t=="object"?t.valueOf():t}function $q(t=ji){if(t===ji)return $S;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function $S(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Vq=Math.sqrt(50),Fq=Math.sqrt(10),zq=Math.sqrt(2);function Yu(t,e,r){const n=(e-t)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=Vq?10:a>=Fq?5:a>=zq?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/s,o=Math.round(t*l),c=Math.round(e*l),o/l<t&&++o,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*s,o=Math.round(t/l),c=Math.round(e/l),o*l<t&&++o,c*l>e&&--c),c<o&&.5<=r&&r<2?Yu(t,e,r*2):[o,c,l]}function Qm(t,e,r){if(e=+e,t=+t,r=+r,!(r>0))return[];if(t===e)return[t];const n=e<t,[i,a,s]=n?Yu(e,t,r):Yu(t,e,r);if(!(a>=i))return[];const o=a-i+1,c=new Array(o);if(n)if(s<0)for(let l=0;l<o;++l)c[l]=(a-l)/-s;else for(let l=0;l<o;++l)c[l]=(a-l)*s;else if(s<0)for(let l=0;l<o;++l)c[l]=(i+l)/-s;else for(let l=0;l<o;++l)c[l]=(i+l)*s;return c}function Xm(t,e,r){return e=+e,t=+t,r=+r,Yu(t,e,r)[2]}function Jm(t,e,r){e=+e,t=+t,r=+r;const n=e<t,i=n?Xm(e,t,r):Xm(t,e,r);return(n?-1:1)*(i<0?1/-i:i)}function vw(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function bw(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function VS(t,e,r=0,n=1/0,i){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(i=i===void 0?$S:$q(i);n>r;){if(n-r>600){const c=n-r+1,l=e-r+1,u=Math.log(c),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(c-h)/c)*(l-c/2<0?-1:1),p=Math.max(r,Math.floor(e-l*h/c+m)),v=Math.min(n,Math.floor(e+(c-l)*h/c+m));VS(t,e,p,v,i)}const a=t[e];let s=r,o=n;for(Co(t,r,e),i(t[n],a)>0&&Co(t,r,n);s<o;){for(Co(t,s,o),++s,--o;i(t[s],a)<0;)++s;for(;i(t[o],a)>0;)--o}i(t[r],a)===0?Co(t,r,o):(++o,Co(t,o,n)),o<=e&&(r=o+1),e<=o&&(n=o-1)}return t}function Co(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function Uq(t,e,r){if(t=Float64Array.from(Oq(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return bw(t);if(e>=1)return vw(t);var n,i=(n-1)*e,a=Math.floor(i),s=vw(VS(t,a).subarray(0,a+1)),o=bw(t.subarray(a+1));return s+(o-s)*(i-a)}}function Bq(t,e,r=LS){if(!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return+r(t[0],0,t);if(e>=1)return+r(t[n-1],n-1,t);var n,i=(n-1)*e,a=Math.floor(i),s=+r(t[a],a,t),o=+r(t[a+1],a+1,t);return s+(o-s)*(i-a)}}function qq(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((e-t)/r))|0,a=new Array(i);++n<i;)a[n]=t+n*r;return a}function qr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function oi(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const ep=Symbol("implicit");function ly(){var t=new gw,e=[],r=[],n=ep;function i(a){let s=t.get(a);if(s===void 0){if(n!==ep)return n;t.set(a,s=e.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new gw;for(const s of a)t.has(s)||t.set(s,e.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return ly(e,r).unknown(n)},qr.apply(i,arguments),i}function uy(){var t=ly().unknown(void 0),e=t.domain,r=t.range,n=0,i=1,a,s,o=!1,c=0,l=0,u=.5;delete t.unknown;function h(){var m=e().length,p=i<n,v=p?i:n,b=p?n:i;a=(b-v)/Math.max(1,m-c+l*2),o&&(a=Math.floor(a)),v+=(b-v-a*(m-c))*u,s=a*(1-c),o&&(v=Math.round(v),s=Math.round(s));var g=qq(m).map(function(_){return v+a*_});return r(p?g.reverse():g)}return t.domain=function(m){return arguments.length?(e(m),h()):e()},t.range=function(m){return arguments.length?([n,i]=m,n=+n,i=+i,h()):[n,i]},t.rangeRound=function(m){return[n,i]=m,n=+n,i=+i,o=!0,h()},t.bandwidth=function(){return s},t.step=function(){return a},t.round=function(m){return arguments.length?(o=!!m,h()):o},t.padding=function(m){return arguments.length?(c=Math.min(1,l=+m),h()):c},t.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),h()):c},t.paddingOuter=function(m){return arguments.length?(l=+m,h()):l},t.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},t.copy=function(){return uy(e(),[n,i]).round(o).paddingInner(c).paddingOuter(l).align(u)},qr.apply(h(),arguments)}function FS(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return FS(e())},t}function Hq(){return FS(uy.apply(null,arguments).paddingInner(1))}function dy(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function zS(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function Fc(){}var pc=.7,Zu=1/pc,ks="\\s*([+-]?\\d+)\\s*",gc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",En="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wq=/^#([0-9a-f]{3,8})$/,Kq=new RegExp(`^rgb\\(${ks},${ks},${ks}\\)$`),Gq=new RegExp(`^rgb\\(${En},${En},${En}\\)$`),Yq=new RegExp(`^rgba\\(${ks},${ks},${ks},${gc}\\)$`),Zq=new RegExp(`^rgba\\(${En},${En},${En},${gc}\\)$`),Qq=new RegExp(`^hsl\\(${gc},${En},${En}\\)$`),Xq=new RegExp(`^hsla\\(${gc},${En},${En},${gc}\\)$`),xw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};dy(Fc,yc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ww,formatHex:ww,formatHex8:Jq,formatHsl:eH,formatRgb:_w,toString:_w});function ww(){return this.rgb().formatHex()}function Jq(){return this.rgb().formatHex8()}function eH(){return US(this).formatHsl()}function _w(){return this.rgb().formatRgb()}function yc(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=Wq.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?Ew(e):r===3?new dr(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?Ul(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?Ul(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Kq.exec(t))?new dr(e[1],e[2],e[3],1):(e=Gq.exec(t))?new dr(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Yq.exec(t))?Ul(e[1],e[2],e[3],e[4]):(e=Zq.exec(t))?Ul(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Qq.exec(t))?Iw(e[1],e[2]/100,e[3]/100,1):(e=Xq.exec(t))?Iw(e[1],e[2]/100,e[3]/100,e[4]):xw.hasOwnProperty(t)?Ew(xw[t]):t==="transparent"?new dr(NaN,NaN,NaN,0):null}function Ew(t){return new dr(t>>16&255,t>>8&255,t&255,1)}function Ul(t,e,r,n){return n<=0&&(t=e=r=NaN),new dr(t,e,r,n)}function tH(t){return t instanceof Fc||(t=yc(t)),t?(t=t.rgb(),new dr(t.r,t.g,t.b,t.opacity)):new dr}function tp(t,e,r,n){return arguments.length===1?tH(t):new dr(t,e,r,n??1)}function dr(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}dy(dr,tp,zS(Fc,{brighter(t){return t=t==null?Zu:Math.pow(Zu,t),new dr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?pc:Math.pow(pc,t),new dr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new dr(Ia(this.r),Ia(this.g),Ia(this.b),Qu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tw,formatHex:Tw,formatHex8:rH,formatRgb:Aw,toString:Aw}));function Tw(){return`#${va(this.r)}${va(this.g)}${va(this.b)}`}function rH(){return`#${va(this.r)}${va(this.g)}${va(this.b)}${va((isNaN(this.opacity)?1:this.opacity)*255)}`}function Aw(){const t=Qu(this.opacity);return`${t===1?"rgb(":"rgba("}${Ia(this.r)}, ${Ia(this.g)}, ${Ia(this.b)}${t===1?")":`, ${t})`}`}function Qu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ia(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function va(t){return t=Ia(t),(t<16?"0":"")+t.toString(16)}function Iw(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,r,n)}function US(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof Fc||(t=yc(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),a=Math.max(e,r,n),s=NaN,o=a-i,c=(a+i)/2;return o?(e===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-e)/o+2:s=(e-r)/o+4,o/=c<.5?a+i:2-a-i,s*=60):o=c>0&&c<1?0:s,new Yr(s,o,c,t.opacity)}function nH(t,e,r,n){return arguments.length===1?US(t):new Yr(t,e,r,n??1)}function Yr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}dy(Yr,nH,zS(Fc,{brighter(t){return t=t==null?Zu:Math.pow(Zu,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?pc:Math.pow(pc,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new dr(Sf(t>=240?t-240:t+120,i,n),Sf(t,i,n),Sf(t<120?t+240:t-120,i,n),this.opacity)},clamp(){return new Yr(Sw(this.h),Bl(this.s),Bl(this.l),Qu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Qu(this.opacity);return`${t===1?"hsl(":"hsla("}${Sw(this.h)}, ${Bl(this.s)*100}%, ${Bl(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Sw(t){return t=(t||0)%360,t<0?t+360:t}function Bl(t){return Math.max(0,Math.min(1,t||0))}function Sf(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const hy=t=>()=>t;function iH(t,e){return function(r){return t+r*e}}function aH(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function sH(t){return(t=+t)==1?BS:function(e,r){return r-e?aH(e,r,t):hy(isNaN(e)?r:e)}}function BS(t,e){var r=e-t;return r?iH(t,r):hy(isNaN(t)?e:t)}const Pw=function t(e){var r=sH(e);function n(i,a){var s=r((i=tp(i)).r,(a=tp(a)).r),o=r(i.g,a.g),c=r(i.b,a.b),l=BS(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=c(u),i.opacity=l(u),i+""}}return n.gamma=t,n}(1);function oH(t,e){e||(e=[]);var r=t?Math.min(e.length,t.length):0,n=e.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=t[i]*(1-a)+e[i]*a;return n}}function cH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function lH(t,e){var r=e?e.length:0,n=t?Math.min(r,t.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Js(t[s],e[s]);for(;s<r;++s)a[s]=e[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function uH(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Xu(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function dH(t,e){var r={},n={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?r[i]=Js(t[i],e[i]):n[i]=e[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var rp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Pf=new RegExp(rp.source,"g");function hH(t){return function(){return t}}function fH(t){return function(e){return t(e)+""}}function mH(t,e){var r=rp.lastIndex=Pf.lastIndex=0,n,i,a,s=-1,o=[],c=[];for(t=t+"",e=e+"";(n=rp.exec(t))&&(i=Pf.exec(e));)(a=i.index)>r&&(a=e.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,c.push({i:s,x:Xu(n,i)})),r=Pf.lastIndex;return r<e.length&&(a=e.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?c[0]?fH(c[0].x):hH(e):(e=c.length,function(l){for(var u=0,h;u<e;++u)o[(h=c[u]).i]=h.x(l);return o.join("")})}function Js(t,e){var r=typeof e,n;return e==null||r==="boolean"?hy(e):(r==="number"?Xu:r==="string"?(n=yc(e))?(e=n,Pw):mH:e instanceof yc?Pw:e instanceof Date?uH:cH(e)?oH:Array.isArray(e)?lH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?dH:Xu)(t,e)}function fy(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}function pH(t,e){e===void 0&&(e=t,t=Js);for(var r=0,n=e.length-1,i=e[0],a=new Array(n<0?0:n);r<n;)a[r]=t(i,i=e[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function gH(t){return function(){return t}}function Ju(t){return+t}var Cw=[0,1];function ar(t){return t}function np(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:gH(isNaN(e)?NaN:.5)}function yH(t,e){var r;return t>e&&(r=t,t=e,e=r),function(n){return Math.max(t,Math.min(e,n))}}function vH(t,e,r){var n=t[0],i=t[1],a=e[0],s=e[1];return i<n?(n=np(i,n),a=r(s,a)):(n=np(n,i),a=r(a,s)),function(o){return a(n(o))}}function bH(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),a=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)i[s]=np(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(o){var c=Vc(t,o,1,n)-1;return a[c](i[c](o))}}function zc(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function wh(){var t=Cw,e=Cw,r=Js,n,i,a,s=ar,o,c,l;function u(){var m=Math.min(t.length,e.length);return s!==ar&&(s=yH(t[0],t[m-1])),o=m>2?bH:vH,c=l=null,h}function h(m){return m==null||isNaN(m=+m)?a:(c||(c=o(t.map(n),e,r)))(n(s(m)))}return h.invert=function(m){return s(i((l||(l=o(e,t.map(n),Xu)))(m)))},h.domain=function(m){return arguments.length?(t=Array.from(m,Ju),u()):t.slice()},h.range=function(m){return arguments.length?(e=Array.from(m),u()):e.slice()},h.rangeRound=function(m){return e=Array.from(m),r=fy,u()},h.clamp=function(m){return arguments.length?(s=m?!0:ar,u()):s!==ar},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,p){return n=m,i=p,u()}}function my(){return wh()(ar,ar)}function xH(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function ed(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function Fs(t){return t=ed(Math.abs(t)),t?t[1]:NaN}function wH(t,e){return function(r,n){for(var i=r.length,a=[],s=0,o=t[0],c=0;i>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(i-=o,i+o)),!((c+=o+1)>n));)o=t[s=(s+1)%t.length];return a.reverse().join(e)}}function _H(t){return function(e){return e.replace(/[0-9]/g,function(r){return t[+r]})}}var EH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vc(t){if(!(e=EH.exec(t)))throw new Error("invalid format: "+t);var e;return new py({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}vc.prototype=py.prototype;function py(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}py.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function TH(t){e:for(var e=t.length,r=1,n=-1,i;r<e;++r)switch(t[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+t[r])break e;n>0&&(n=0);break}return n>0?t.slice(0,n)+t.slice(i+1):t}var qS;function AH(t,e){var r=ed(t,e);if(!r)return t+"";var n=r[0],i=r[1],a=i-(qS=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+ed(t,Math.max(0,e+a-1))[0]}function kw(t,e){var r=ed(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const Nw={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:xH,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>kw(t*100,e),r:kw,s:AH,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function jw(t){return t}var Ow=Array.prototype.map,Rw=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function IH(t){var e=t.grouping===void 0||t.thousands===void 0?jw:wH(Ow.call(t.grouping,Number),t.thousands+""),r=t.currency===void 0?"":t.currency[0]+"",n=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?jw:_H(Ow.call(t.numerals,String)),s=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(h){h=vc(h);var m=h.fill,p=h.align,v=h.sign,b=h.symbol,g=h.zero,_=h.width,T=h.comma,E=h.precision,j=h.trim,R=h.type;R==="n"?(T=!0,R="g"):Nw[R]||(E===void 0&&(E=12),j=!0,R="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var D=b==="$"?r:b==="#"&&/[boxX]/.test(R)?"0"+R.toLowerCase():"",I=b==="$"?n:/[%p]/.test(R)?s:"",A=Nw[R],P=/[defgprs%]/.test(R);E=E===void 0?6:/[gprs]/.test(R)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function O(N){var C=D,k=I,J,oe,X;if(R==="c")k=A(N)+k,N="";else{N=+N;var te=N<0||1/N<0;if(N=isNaN(N)?c:A(Math.abs(N),E),j&&(N=TH(N)),te&&+N==0&&v!=="+"&&(te=!1),C=(te?v==="("?v:o:v==="-"||v==="("?"":v)+C,k=(R==="s"?Rw[8+qS/3]:"")+k+(te&&v==="("?")":""),P){for(J=-1,oe=N.length;++J<oe;)if(X=N.charCodeAt(J),48>X||X>57){k=(X===46?i+N.slice(J+1):N.slice(J))+k,N=N.slice(0,J);break}}}T&&!g&&(N=e(N,1/0));var he=C.length+N.length+k.length,ye=he<_?new Array(_-he+1).join(m):"";switch(T&&g&&(N=e(ye+N,ye.length?_-k.length:1/0),ye=""),p){case"<":N=C+N+k+ye;break;case"=":N=C+ye+N+k;break;case"^":N=ye.slice(0,he=ye.length>>1)+C+N+k+ye.slice(he);break;default:N=ye+C+N+k;break}return a(N)}return O.toString=function(){return h+""},O}function u(h,m){var p=l((h=vc(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(Fs(m)/3)))*3,b=Math.pow(10,-v),g=Rw[8+v/3];return function(_){return p(b*_)+g}}return{format:l,formatPrefix:u}}var ql,gy,HS;SH({thousands:",",grouping:[3],currency:["$",""]});function SH(t){return ql=IH(t),gy=ql.format,HS=ql.formatPrefix,ql}function PH(t){return Math.max(0,-Fs(Math.abs(t)))}function CH(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fs(e)/3)))*3-Fs(Math.abs(t)))}function kH(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Fs(e)-Fs(t))+1}function WS(t,e,r,n){var i=Jm(t,e,r),a;switch(n=vc(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));return n.precision==null&&!isNaN(a=CH(i,s))&&(n.precision=a),HS(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=kH(i,Math.max(Math.abs(t),Math.abs(e))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=PH(i))&&(n.precision=a-(n.type==="%")*2);break}}return gy(n)}function Zi(t){var e=t.domain;return t.ticks=function(r){var n=e();return Qm(n[0],n[n.length-1],r??10)},t.tickFormat=function(r,n){var i=e();return WS(i[0],i[i.length-1],r??10,n)},t.nice=function(r){r==null&&(r=10);var n=e(),i=0,a=n.length-1,s=n[i],o=n[a],c,l,u=10;for(o<s&&(l=s,s=o,o=l,l=i,i=a,a=l);u-- >0;){if(l=Xm(s,o,r),l===c)return n[i]=s,n[a]=o,e(n);if(l>0)s=Math.floor(s/l)*l,o=Math.ceil(o/l)*l;else if(l<0)s=Math.ceil(s*l)/l,o=Math.floor(o*l)/l;else break;c=l}return t},t}function KS(){var t=my();return t.copy=function(){return zc(t,KS())},qr.apply(t,arguments),Zi(t)}function GS(t){var e;function r(n){return n==null||isNaN(n=+n)?e:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(t=Array.from(n,Ju),r):t.slice()},r.unknown=function(n){return arguments.length?(e=n,r):e},r.copy=function(){return GS(t).unknown(e)},t=arguments.length?Array.from(t,Ju):[0,1],Zi(r)}function YS(t,e){t=t.slice();var r=0,n=t.length-1,i=t[r],a=t[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),t[r]=e.floor(i),t[n]=e.ceil(a),t}function Dw(t){return Math.log(t)}function Mw(t){return Math.exp(t)}function NH(t){return-Math.log(-t)}function jH(t){return-Math.exp(-t)}function OH(t){return isFinite(t)?+("1e"+t):t<0?0:t}function RH(t){return t===10?OH:t===Math.E?Math.exp:e=>Math.pow(t,e)}function DH(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Lw(t){return(e,r)=>-t(-e,r)}function yy(t){const e=t(Dw,Mw),r=e.domain;let n=10,i,a;function s(){return i=DH(n),a=RH(n),r()[0]<0?(i=Lw(i),a=Lw(a),t(NH,jH)):t(Dw,Mw),e}return e.base=function(o){return arguments.length?(n=+o,s()):n},e.domain=function(o){return arguments.length?(r(o),s()):r()},e.ticks=o=>{const c=r();let l=c[0],u=c[c.length-1];const h=u<l;h&&([l,u]=[u,l]);let m=i(l),p=i(u),v,b;const g=o==null?10:+o;let _=[];if(!(n%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),l>0){for(;m<=p;++m)for(v=1;v<n;++v)if(b=m<0?v/a(-m):v*a(m),!(b<l)){if(b>u)break;_.push(b)}}else for(;m<=p;++m)for(v=n-1;v>=1;--v)if(b=m>0?v/a(-m):v*a(m),!(b<l)){if(b>u)break;_.push(b)}_.length*2<g&&(_=Qm(l,u,g))}else _=Qm(m,p,Math.min(p-m,g)).map(a);return h?_.reverse():_},e.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=vc(c)).precision==null&&(c.trim=!0),c=gy(c)),o===1/0)return c;const l=Math.max(1,n*o/e.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=l?c(u):""}},e.nice=()=>r(YS(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),e}function ZS(){const t=yy(wh()).domain([1,10]);return t.copy=()=>zc(t,ZS()).base(t.base()),qr.apply(t,arguments),t}function $w(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Vw(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function vy(t){var e=1,r=t($w(e),Vw(e));return r.constant=function(n){return arguments.length?t($w(e=+n),Vw(e)):e},Zi(r)}function QS(){var t=vy(wh());return t.copy=function(){return zc(t,QS()).constant(t.constant())},qr.apply(t,arguments)}function Fw(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function MH(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function LH(t){return t<0?-t*t:t*t}function by(t){var e=t(ar,ar),r=1;function n(){return r===1?t(ar,ar):r===.5?t(MH,LH):t(Fw(r),Fw(1/r))}return e.exponent=function(i){return arguments.length?(r=+i,n()):r},Zi(e)}function xy(){var t=by(wh());return t.copy=function(){return zc(t,xy()).exponent(t.exponent())},qr.apply(t,arguments),t}function $H(){return xy.apply(null,arguments).exponent(.5)}function zw(t){return Math.sign(t)*t*t}function VH(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function XS(){var t=my(),e=[0,1],r=!1,n;function i(a){var s=VH(t(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return t.invert(zw(a))},i.domain=function(a){return arguments.length?(t.domain(a),i):t.domain()},i.range=function(a){return arguments.length?(t.range((e=Array.from(a,Ju)).map(zw)),i):e.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(t.clamp(a),i):t.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return XS(t.domain(),e).round(r).clamp(t.clamp()).unknown(n)},qr.apply(i,arguments),Zi(i)}function JS(){var t=[],e=[],r=[],n;function i(){var s=0,o=Math.max(1,e.length);for(r=new Array(o-1);++s<o;)r[s-1]=Bq(t,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:e[Vc(r,s)]}return a.invertExtent=function(s){var o=e.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:t[0],o<r.length?r[o]:t[t.length-1]]},a.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let o of s)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(ji),i()},a.range=function(s){return arguments.length?(e=Array.from(s),i()):e.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return JS().domain(t).range(e).unknown(n)},qr.apply(a,arguments)}function eP(){var t=0,e=1,r=1,n=[.5],i=[0,1],a;function s(c){return c!=null&&c<=c?i[Vc(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*e-(c-r)*t)/(r+1);return s}return s.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,o()):[t,e]},s.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,o()):i.slice()},s.invertExtent=function(c){var l=i.indexOf(c);return l<0?[NaN,NaN]:l<1?[t,n[0]]:l>=r?[n[r-1],e]:[n[l-1],n[l]]},s.unknown=function(c){return arguments.length&&(a=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return eP().domain([t,e]).range(i).unknown(a)},qr.apply(Zi(s),arguments)}function tP(){var t=[.5],e=[0,1],r,n=1;function i(a){return a!=null&&a<=a?e[Vc(t,a,0,n)]:r}return i.domain=function(a){return arguments.length?(t=Array.from(a),n=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),n=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var s=e.indexOf(a);return[t[s-1],t[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return tP().domain(t).range(e).unknown(r)},qr.apply(i,arguments)}const Cf=new Date,kf=new Date;function St(t,e,r,n){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(t(a=new Date(+a)),a),i.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(e(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const c=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return c;let l;do c.push(l=new Date(+a)),e(a,o),t(a);while(l<a&&a<s);return c},i.filter=a=>St(s=>{if(s>=s)for(;t(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;e(s,-1),!a(s););else for(;--o>=0;)for(;e(s,1),!a(s););}),r&&(i.count=(a,s)=>(Cf.setTime(+a),kf.setTime(+s),t(Cf),t(kf),Math.floor(r(Cf,kf))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const td=St(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);td.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?St(e=>{e.setTime(Math.floor(e/t)*t)},(e,r)=>{e.setTime(+e+r*t)},(e,r)=>(r-e)/t):td);td.range;const zn=1e3,$r=zn*60,Un=$r*60,ri=Un*24,wy=ri*7,Uw=ri*30,Nf=ri*365,ba=St(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*zn)},(t,e)=>(e-t)/zn,t=>t.getUTCSeconds());ba.range;const _y=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getMinutes());_y.range;const Ey=St(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*$r)},(t,e)=>(e-t)/$r,t=>t.getUTCMinutes());Ey.range;const Ty=St(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*zn-t.getMinutes()*$r)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getHours());Ty.range;const Ay=St(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Un)},(t,e)=>(e-t)/Un,t=>t.getUTCHours());Ay.range;const Uc=St(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*$r)/ri,t=>t.getDate()-1);Uc.range;const _h=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ri,t=>t.getUTCDate()-1);_h.range;const rP=St(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ri,t=>Math.floor(t/ri));rP.range;function Ja(t){return St(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,r)=>{e.setDate(e.getDate()+r*7)},(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*$r)/wy)}const Eh=Ja(0),rd=Ja(1),FH=Ja(2),zH=Ja(3),zs=Ja(4),UH=Ja(5),BH=Ja(6);Eh.range;rd.range;FH.range;zH.range;zs.range;UH.range;BH.range;function es(t){return St(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r*7)},(e,r)=>(r-e)/wy)}const Th=es(0),nd=es(1),qH=es(2),HH=es(3),Us=es(4),WH=es(5),KH=es(6);Th.range;nd.range;qH.range;HH.range;Us.range;WH.range;KH.range;const Iy=St(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Iy.range;const Sy=St(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Sy.range;const ni=St(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ni.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r*t)});ni.range;const ii=St(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());ii.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:St(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r*t)});ii.range;function nP(t,e,r,n,i,a){const s=[[ba,1,zn],[ba,5,5*zn],[ba,15,15*zn],[ba,30,30*zn],[a,1,$r],[a,5,5*$r],[a,15,15*$r],[a,30,30*$r],[i,1,Un],[i,3,3*Un],[i,6,6*Un],[i,12,12*Un],[n,1,ri],[n,2,2*ri],[r,1,wy],[e,1,Uw],[e,3,3*Uw],[t,1,Nf]];function o(l,u,h){const m=u<l;m&&([l,u]=[u,l]);const p=h&&typeof h.range=="function"?h:c(l,u,h),v=p?p.range(l,+u+1):[];return m?v.reverse():v}function c(l,u,h){const m=Math.abs(u-l)/h,p=cy(([,,g])=>g).right(s,m);if(p===s.length)return t.every(Jm(l/Nf,u/Nf,h));if(p===0)return td.every(Math.max(Jm(l,u,h),1));const[v,b]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return v.every(b)}return[o,c]}const[GH,YH]=nP(ii,Sy,Th,rP,Ay,Ey),[ZH,QH]=nP(ni,Iy,Eh,Uc,Ty,_y);function jf(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Of(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ko(t,e,r){return{y:t,m:e,d:r,H:0,M:0,S:0,L:0}}function XH(t){var e=t.dateTime,r=t.date,n=t.time,i=t.periods,a=t.days,s=t.shortDays,o=t.months,c=t.shortMonths,l=No(i),u=jo(i),h=No(a),m=jo(a),p=No(s),v=jo(s),b=No(o),g=jo(o),_=No(c),T=jo(c),E={a:te,A:he,b:ye,B:Be,c:null,d:Gw,e:Gw,f:wW,g:NW,G:OW,H:vW,I:bW,j:xW,L:iP,m:_W,M:EW,p:se,q:W,Q:Qw,s:Xw,S:TW,u:AW,U:IW,V:SW,w:PW,W:CW,x:null,X:null,y:kW,Y:jW,Z:RW,"%":Zw},j={a:ee,A:rt,b:Fe,B:ze,c:null,d:Yw,e:Yw,f:$W,g:GW,G:ZW,H:DW,I:MW,j:LW,L:sP,m:VW,M:FW,p:Cr,q:nn,Q:Qw,s:Xw,S:zW,u:UW,U:BW,V:qW,w:HW,W:WW,x:null,X:null,y:KW,Y:YW,Z:QW,"%":Zw},R={a:O,A:N,b:C,B:k,c:J,d:Ww,e:Ww,f:mW,g:Hw,G:qw,H:Kw,I:Kw,j:uW,L:fW,m:lW,M:dW,p:P,q:cW,Q:gW,s:yW,S:hW,u:nW,U:iW,V:aW,w:rW,W:sW,x:oe,X,y:Hw,Y:qw,Z:oW,"%":pW};E.x=D(r,E),E.X=D(n,E),E.c=D(e,E),j.x=D(r,j),j.X=D(n,j),j.c=D(e,j);function D(Y,de){return function(be){var B=[],dt=-1,Te=0,xt=Y.length,wt,nr,ea;for(be instanceof Date||(be=new Date(+be));++dt<xt;)Y.charCodeAt(dt)===37&&(B.push(Y.slice(Te,dt)),(nr=Bw[wt=Y.charAt(++dt)])!=null?wt=Y.charAt(++dt):nr=wt==="e"?" ":"0",(ea=de[wt])&&(wt=ea(be,nr)),B.push(wt),Te=dt+1);return B.push(Y.slice(Te,dt)),B.join("")}}function I(Y,de){return function(be){var B=ko(1900,void 0,1),dt=A(B,Y,be+="",0),Te,xt;if(dt!=be.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(de&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(Te=Of(ko(B.y,0,1)),xt=Te.getUTCDay(),Te=xt>4||xt===0?nd.ceil(Te):nd(Te),Te=_h.offset(Te,(B.V-1)*7),B.y=Te.getUTCFullYear(),B.m=Te.getUTCMonth(),B.d=Te.getUTCDate()+(B.w+6)%7):(Te=jf(ko(B.y,0,1)),xt=Te.getDay(),Te=xt>4||xt===0?rd.ceil(Te):rd(Te),Te=Uc.offset(Te,(B.V-1)*7),B.y=Te.getFullYear(),B.m=Te.getMonth(),B.d=Te.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),xt="Z"in B?Of(ko(B.y,0,1)).getUTCDay():jf(ko(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(xt+5)%7:B.w+B.U*7-(xt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,Of(B)):jf(B)}}function A(Y,de,be,B){for(var dt=0,Te=de.length,xt=be.length,wt,nr;dt<Te;){if(B>=xt)return-1;if(wt=de.charCodeAt(dt++),wt===37){if(wt=de.charAt(dt++),nr=R[wt in Bw?de.charAt(dt++):wt],!nr||(B=nr(Y,be,B))<0)return-1}else if(wt!=be.charCodeAt(B++))return-1}return B}function P(Y,de,be){var B=l.exec(de.slice(be));return B?(Y.p=u.get(B[0].toLowerCase()),be+B[0].length):-1}function O(Y,de,be){var B=p.exec(de.slice(be));return B?(Y.w=v.get(B[0].toLowerCase()),be+B[0].length):-1}function N(Y,de,be){var B=h.exec(de.slice(be));return B?(Y.w=m.get(B[0].toLowerCase()),be+B[0].length):-1}function C(Y,de,be){var B=_.exec(de.slice(be));return B?(Y.m=T.get(B[0].toLowerCase()),be+B[0].length):-1}function k(Y,de,be){var B=b.exec(de.slice(be));return B?(Y.m=g.get(B[0].toLowerCase()),be+B[0].length):-1}function J(Y,de,be){return A(Y,e,de,be)}function oe(Y,de,be){return A(Y,r,de,be)}function X(Y,de,be){return A(Y,n,de,be)}function te(Y){return s[Y.getDay()]}function he(Y){return a[Y.getDay()]}function ye(Y){return c[Y.getMonth()]}function Be(Y){return o[Y.getMonth()]}function se(Y){return i[+(Y.getHours()>=12)]}function W(Y){return 1+~~(Y.getMonth()/3)}function ee(Y){return s[Y.getUTCDay()]}function rt(Y){return a[Y.getUTCDay()]}function Fe(Y){return c[Y.getUTCMonth()]}function ze(Y){return o[Y.getUTCMonth()]}function Cr(Y){return i[+(Y.getUTCHours()>=12)]}function nn(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var de=D(Y+="",E);return de.toString=function(){return Y},de},parse:function(Y){var de=I(Y+="",!1);return de.toString=function(){return Y},de},utcFormat:function(Y){var de=D(Y+="",j);return de.toString=function(){return Y},de},utcParse:function(Y){var de=I(Y+="",!0);return de.toString=function(){return Y},de}}}var Bw={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,JH=/^%/,eW=/[\\^$*+?|[\]().{}]/g;function Pe(t,e,r){var n=t<0?"-":"",i=(n?-t:t)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(e)+i:i)}function tW(t){return t.replace(eW,"\\$&")}function No(t){return new RegExp("^(?:"+t.map(tW).join("|")+")","i")}function jo(t){return new Map(t.map((e,r)=>[e.toLowerCase(),r]))}function rW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.w=+n[0],r+n[0].length):-1}function nW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.u=+n[0],r+n[0].length):-1}function iW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.U=+n[0],r+n[0].length):-1}function aW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.V=+n[0],r+n[0].length):-1}function sW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.W=+n[0],r+n[0].length):-1}function qw(t,e,r){var n=kt.exec(e.slice(r,r+4));return n?(t.y=+n[0],r+n[0].length):-1}function Hw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function oW(t,e,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(r,r+6));return n?(t.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function cW(t,e,r){var n=kt.exec(e.slice(r,r+1));return n?(t.q=n[0]*3-3,r+n[0].length):-1}function lW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.m=n[0]-1,r+n[0].length):-1}function Ww(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.d=+n[0],r+n[0].length):-1}function uW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.m=0,t.d=+n[0],r+n[0].length):-1}function Kw(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.H=+n[0],r+n[0].length):-1}function dW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.M=+n[0],r+n[0].length):-1}function hW(t,e,r){var n=kt.exec(e.slice(r,r+2));return n?(t.S=+n[0],r+n[0].length):-1}function fW(t,e,r){var n=kt.exec(e.slice(r,r+3));return n?(t.L=+n[0],r+n[0].length):-1}function mW(t,e,r){var n=kt.exec(e.slice(r,r+6));return n?(t.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function pW(t,e,r){var n=JH.exec(e.slice(r,r+1));return n?r+n[0].length:-1}function gW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.Q=+n[0],r+n[0].length):-1}function yW(t,e,r){var n=kt.exec(e.slice(r));return n?(t.s=+n[0],r+n[0].length):-1}function Gw(t,e){return Pe(t.getDate(),e,2)}function vW(t,e){return Pe(t.getHours(),e,2)}function bW(t,e){return Pe(t.getHours()%12||12,e,2)}function xW(t,e){return Pe(1+Uc.count(ni(t),t),e,3)}function iP(t,e){return Pe(t.getMilliseconds(),e,3)}function wW(t,e){return iP(t,e)+"000"}function _W(t,e){return Pe(t.getMonth()+1,e,2)}function EW(t,e){return Pe(t.getMinutes(),e,2)}function TW(t,e){return Pe(t.getSeconds(),e,2)}function AW(t){var e=t.getDay();return e===0?7:e}function IW(t,e){return Pe(Eh.count(ni(t)-1,t),e,2)}function aP(t){var e=t.getDay();return e>=4||e===0?zs(t):zs.ceil(t)}function SW(t,e){return t=aP(t),Pe(zs.count(ni(t),t)+(ni(t).getDay()===4),e,2)}function PW(t){return t.getDay()}function CW(t,e){return Pe(rd.count(ni(t)-1,t),e,2)}function kW(t,e){return Pe(t.getFullYear()%100,e,2)}function NW(t,e){return t=aP(t),Pe(t.getFullYear()%100,e,2)}function jW(t,e){return Pe(t.getFullYear()%1e4,e,4)}function OW(t,e){var r=t.getDay();return t=r>=4||r===0?zs(t):zs.ceil(t),Pe(t.getFullYear()%1e4,e,4)}function RW(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Pe(e/60|0,"0",2)+Pe(e%60,"0",2)}function Yw(t,e){return Pe(t.getUTCDate(),e,2)}function DW(t,e){return Pe(t.getUTCHours(),e,2)}function MW(t,e){return Pe(t.getUTCHours()%12||12,e,2)}function LW(t,e){return Pe(1+_h.count(ii(t),t),e,3)}function sP(t,e){return Pe(t.getUTCMilliseconds(),e,3)}function $W(t,e){return sP(t,e)+"000"}function VW(t,e){return Pe(t.getUTCMonth()+1,e,2)}function FW(t,e){return Pe(t.getUTCMinutes(),e,2)}function zW(t,e){return Pe(t.getUTCSeconds(),e,2)}function UW(t){var e=t.getUTCDay();return e===0?7:e}function BW(t,e){return Pe(Th.count(ii(t)-1,t),e,2)}function oP(t){var e=t.getUTCDay();return e>=4||e===0?Us(t):Us.ceil(t)}function qW(t,e){return t=oP(t),Pe(Us.count(ii(t),t)+(ii(t).getUTCDay()===4),e,2)}function HW(t){return t.getUTCDay()}function WW(t,e){return Pe(nd.count(ii(t)-1,t),e,2)}function KW(t,e){return Pe(t.getUTCFullYear()%100,e,2)}function GW(t,e){return t=oP(t),Pe(t.getUTCFullYear()%100,e,2)}function YW(t,e){return Pe(t.getUTCFullYear()%1e4,e,4)}function ZW(t,e){var r=t.getUTCDay();return t=r>=4||r===0?Us(t):Us.ceil(t),Pe(t.getUTCFullYear()%1e4,e,4)}function QW(){return"+0000"}function Zw(){return"%"}function Qw(t){return+t}function Xw(t){return Math.floor(+t/1e3)}var ds,cP,lP;XW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function XW(t){return ds=XH(t),cP=ds.format,ds.parse,lP=ds.utcFormat,ds.utcParse,ds}function JW(t){return new Date(t)}function e7(t){return t instanceof Date?+t:+new Date(+t)}function Py(t,e,r,n,i,a,s,o,c,l){var u=my(),h=u.invert,m=u.domain,p=l(".%L"),v=l(":%S"),b=l("%I:%M"),g=l("%I %p"),_=l("%a %d"),T=l("%b %d"),E=l("%B"),j=l("%Y");function R(D){return(c(D)<D?p:o(D)<D?v:s(D)<D?b:a(D)<D?g:n(D)<D?i(D)<D?_:T:r(D)<D?E:j)(D)}return u.invert=function(D){return new Date(h(D))},u.domain=function(D){return arguments.length?m(Array.from(D,e7)):m().map(JW)},u.ticks=function(D){var I=m();return t(I[0],I[I.length-1],D??10)},u.tickFormat=function(D,I){return I==null?R:l(I)},u.nice=function(D){var I=m();return(!D||typeof D.range!="function")&&(D=e(I[0],I[I.length-1],D??10)),D?m(YS(I,D)):u},u.copy=function(){return zc(u,Py(t,e,r,n,i,a,s,o,c,l))},u}function t7(){return qr.apply(Py(ZH,QH,ni,Iy,Eh,Uc,Ty,_y,ba,cP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function r7(){return qr.apply(Py(GH,YH,ii,Sy,Th,_h,Ay,Ey,ba,lP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ah(){var t=0,e=1,r,n,i,a,s=ar,o=!1,c;function l(h){return h==null||isNaN(h=+h)?c:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([t,e]=h,r=a(t=+t),n=a(e=+e),i=r===n?0:1/(n-r),l):[t,e]},l.clamp=function(h){return arguments.length?(o=!!h,l):o},l.interpolator=function(h){return arguments.length?(s=h,l):s};function u(h){return function(m){var p,v;return arguments.length?([p,v]=m,s=h(p,v),l):[s(0),s(1)]}}return l.range=u(Js),l.rangeRound=u(fy),l.unknown=function(h){return arguments.length?(c=h,l):c},function(h){return a=h,r=h(t),n=h(e),i=r===n?0:1/(n-r),l}}function Qi(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function uP(){var t=Zi(Ah()(ar));return t.copy=function(){return Qi(t,uP())},oi.apply(t,arguments)}function dP(){var t=yy(Ah()).domain([1,10]);return t.copy=function(){return Qi(t,dP()).base(t.base())},oi.apply(t,arguments)}function hP(){var t=vy(Ah());return t.copy=function(){return Qi(t,hP()).constant(t.constant())},oi.apply(t,arguments)}function Cy(){var t=by(Ah());return t.copy=function(){return Qi(t,Cy()).exponent(t.exponent())},oi.apply(t,arguments)}function n7(){return Cy.apply(null,arguments).exponent(.5)}function fP(){var t=[],e=ar;function r(n){if(n!=null&&!isNaN(n=+n))return e((Vc(t,n,1)-1)/(t.length-1))}return r.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let i of n)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(ji),r},r.interpolator=function(n){return arguments.length?(e=n,r):e},r.range=function(){return t.map((n,i)=>e(i/(t.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>Uq(t,a/n))},r.copy=function(){return fP(e).domain(t)},oi.apply(r,arguments)}function Ih(){var t=0,e=.5,r=1,n=1,i,a,s,o,c,l=ar,u,h=!1,m;function p(b){return isNaN(b=+b)?m:(b=.5+((b=+u(b))-a)*(n*b<n*a?o:c),l(h?Math.max(0,Math.min(1,b)):b))}p.domain=function(b){return arguments.length?([t,e,r]=b,i=u(t=+t),a=u(e=+e),s=u(r=+r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p):[t,e,r]},p.clamp=function(b){return arguments.length?(h=!!b,p):h},p.interpolator=function(b){return arguments.length?(l=b,p):l};function v(b){return function(g){var _,T,E;return arguments.length?([_,T,E]=g,l=pH(b,[_,T,E]),p):[l(0),l(.5),l(1)]}}return p.range=v(Js),p.rangeRound=v(fy),p.unknown=function(b){return arguments.length?(m=b,p):m},function(b){return u=b,i=b(t),a=b(e),s=b(r),o=i===a?0:.5/(a-i),c=a===s?0:.5/(s-a),n=a<i?-1:1,p}}function mP(){var t=Zi(Ih()(ar));return t.copy=function(){return Qi(t,mP())},oi.apply(t,arguments)}function pP(){var t=yy(Ih()).domain([.1,1,10]);return t.copy=function(){return Qi(t,pP()).base(t.base())},oi.apply(t,arguments)}function gP(){var t=vy(Ih());return t.copy=function(){return Qi(t,gP()).constant(t.constant())},oi.apply(t,arguments)}function ky(){var t=by(Ih());return t.copy=function(){return Qi(t,ky()).exponent(t.exponent())},oi.apply(t,arguments)}function i7(){return ky.apply(null,arguments).exponent(.5)}const zo=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:uy,scaleDiverging:mP,scaleDivergingLog:pP,scaleDivergingPow:ky,scaleDivergingSqrt:i7,scaleDivergingSymlog:gP,scaleIdentity:GS,scaleImplicit:ep,scaleLinear:KS,scaleLog:ZS,scaleOrdinal:ly,scalePoint:Hq,scalePow:xy,scaleQuantile:JS,scaleQuantize:eP,scaleRadial:XS,scaleSequential:uP,scaleSequentialLog:dP,scaleSequentialPow:Cy,scaleSequentialQuantile:fP,scaleSequentialSqrt:n7,scaleSequentialSymlog:hP,scaleSqrt:$H,scaleSymlog:QS,scaleThreshold:tP,scaleTime:t7,scaleUtc:r7,tickFormat:WS},Symbol.toStringTag,{value:"Module"}));var ts=t=>t.chartData,a7=V([ts],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),yP=(t,e,r,n)=>n?a7(t):ts(t);function Bs(t){if(Array.isArray(t)&&t.length===2){var[e,r]=t;if(rn(e)&&rn(r))return!0}return!1}function Jw(t,e,r){return r?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function s7(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[r,n]=t,i,a;if(rn(r))i=r;else if(typeof r=="function")return;if(rn(n))a=n;else if(typeof n=="function")return;var s=[i,a];if(Bs(s))return s}}function o7(t,e,r){if(!(!r&&e==null)){if(typeof t=="function"&&e!=null)try{var n=t(e,r);if(Bs(n))return Jw(n,e,r)}catch{}if(Array.isArray(t)&&t.length===2){var[i,a]=t,s,o;if(i==="auto")e!=null&&(s=Math.min(...e));else if(re(i))s=i;else if(typeof i=="function")try{e!=null&&(s=i(e?.[0]))}catch{}else if(typeof i=="string"&&Qx.test(i)){var c=Qx.exec(i);if(c==null||e==null)s=void 0;else{var l=+c[1];s=e[0]-l}}else s=e?.[0];if(a==="auto")e!=null&&(o=Math.max(...e));else if(re(a))o=a;else if(typeof a=="function")try{e!=null&&(o=a(e?.[1]))}catch{}else if(typeof a=="string"&&Xx.test(a)){var u=Xx.exec(a);if(u==null||e==null)o=void 0;else{var h=+u[1];o=e[1]+h}}else o=e?.[1];var m=[s,o];if(Bs(m))return e==null?m:Jw(m,e,r)}}}var eo=1e9,c7={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},jy,Ze=!0,zr="[DecimalError] ",Sa=zr+"Invalid argument: ",Ny=zr+"Exponent out of range: ",to=Math.floor,ha=Math.pow,l7=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Er,Ct=1e7,We=7,vP=9007199254740991,id=to(vP/We),Q={};Q.absoluteValue=Q.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};Q.comparedTo=Q.cmp=function(t){var e,r,n,i,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(n=a.d.length,i=t.d.length,e=0,r=n<i?n:i;e<r;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};Q.decimalPlaces=Q.dp=function(){var t=this,e=t.d.length-1,r=(e-t.e)*We;if(e=t.d[e],e)for(;e%10==0;e/=10)r--;return r<0?0:r};Q.dividedBy=Q.div=function(t){return Gn(this,new this.constructor(t))};Q.dividedToIntegerBy=Q.idiv=function(t){var e=this,r=e.constructor;return $e(Gn(e,new r(t),0,1),r.precision)};Q.equals=Q.eq=function(t){return!this.cmp(t)};Q.exponent=function(){return bt(this)};Q.greaterThan=Q.gt=function(t){return this.cmp(t)>0};Q.greaterThanOrEqualTo=Q.gte=function(t){return this.cmp(t)>=0};Q.isInteger=Q.isint=function(){return this.e>this.d.length-2};Q.isNegative=Q.isneg=function(){return this.s<0};Q.isPositive=Q.ispos=function(){return this.s>0};Q.isZero=function(){return this.s===0};Q.lessThan=Q.lt=function(t){return this.cmp(t)<0};Q.lessThanOrEqualTo=Q.lte=function(t){return this.cmp(t)<1};Q.logarithm=Q.log=function(t){var e,r=this,n=r.constructor,i=n.precision,a=i+5;if(t===void 0)t=new n(10);else if(t=new n(t),t.s<1||t.eq(Er))throw Error(zr+"NaN");if(r.s<1)throw Error(zr+(r.s?"NaN":"-Infinity"));return r.eq(Er)?new n(0):(Ze=!1,e=Gn(bc(r,a),bc(t,a),a),Ze=!0,$e(e,i))};Q.minus=Q.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?wP(e,t):bP(e,(t.s=-t.s,t))};Q.modulo=Q.mod=function(t){var e,r=this,n=r.constructor,i=n.precision;if(t=new n(t),!t.s)throw Error(zr+"NaN");return r.s?(Ze=!1,e=Gn(r,t,0,1).times(t),Ze=!0,r.minus(e)):$e(new n(r),i)};Q.naturalExponential=Q.exp=function(){return xP(this)};Q.naturalLogarithm=Q.ln=function(){return bc(this)};Q.negated=Q.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};Q.plus=Q.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?bP(e,t):wP(e,(t.s=-t.s,t))};Q.precision=Q.sd=function(t){var e,r,n,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Sa+t);if(e=bt(i)+1,n=i.d.length-1,r=n*We+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return t&&e>r?e:r};Q.squareRoot=Q.sqrt=function(){var t,e,r,n,i,a,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(zr+"NaN")}for(t=bt(o),Ze=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=mn(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=to((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new c(e)):n=new c(i.toString()),r=c.precision,i=s=r+3;;)if(a=n,n=a.plus(Gn(o,a,s+2)).times(.5),mn(a.d).slice(0,s)===(e=mn(n.d)).slice(0,s)){if(e=e.slice(s-3,s+1),i==s&&e=="4999"){if($e(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(e!="9999")break;s+=4}return Ze=!0,$e(n,r)};Q.times=Q.mul=function(t){var e,r,n,i,a,s,o,c,l,u=this,h=u.constructor,m=u.d,p=(t=new h(t)).d;if(!u.s||!t.s)return new h(0);for(t.s*=u.s,r=u.e+t.e,c=m.length,l=p.length,c<l&&(a=m,m=p,p=a,s=c,c=l,l=s),a=[],s=c+l,n=s;n--;)a.push(0);for(n=l;--n>=0;){for(e=0,i=c+n;i>n;)o=a[i]+p[n]*m[i-n-1]+e,a[i--]=o%Ct|0,e=o/Ct|0;a[i]=(a[i]+e)%Ct|0}for(;!a[--s];)a.pop();return e?++r:a.shift(),t.d=a,t.e=r,Ze?$e(t,h.precision):t};Q.toDecimalPlaces=Q.todp=function(t,e){var r=this,n=r.constructor;return r=new n(r),t===void 0?r:(Pn(t,0,eo),e===void 0?e=n.rounding:Pn(e,0,8),$e(r,t+bt(r)+1,e))};Q.toExponential=function(t,e){var r,n=this,i=n.constructor;return t===void 0?r=Ua(n,!0):(Pn(t,0,eo),e===void 0?e=i.rounding:Pn(e,0,8),n=$e(new i(n),t+1,e),r=Ua(n,!0,t+1)),r};Q.toFixed=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?Ua(i):(Pn(t,0,eo),e===void 0?e=a.rounding:Pn(e,0,8),n=$e(new a(i),t+bt(i)+1,e),r=Ua(n.abs(),!1,t+bt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Q.toInteger=Q.toint=function(){var t=this,e=t.constructor;return $e(new e(t),bt(t)+1,e.rounding)};Q.toNumber=function(){return+this};Q.toPower=Q.pow=function(t){var e,r,n,i,a,s,o=this,c=o.constructor,l=12,u=+(t=new c(t));if(!t.s)return new c(Er);if(o=new c(o),!o.s){if(t.s<1)throw Error(zr+"Infinity");return o}if(o.eq(Er))return o;if(n=c.precision,t.eq(Er))return $e(o,n);if(e=t.e,r=t.d.length-1,s=e>=r,a=o.s,s){if((r=u<0?-u:u)<=vP){for(i=new c(Er),e=Math.ceil(n/We+4),Ze=!1;r%2&&(i=i.times(o),t_(i.d,e)),r=to(r/2),r!==0;)o=o.times(o),t_(o.d,e);return Ze=!0,t.s<0?new c(Er).div(i):$e(i,n)}}else if(a<0)throw Error(zr+"NaN");return a=a<0&&t.d[Math.max(e,r)]&1?-1:1,o.s=1,Ze=!1,i=t.times(bc(o,n+l)),Ze=!0,i=xP(i),i.s=a,i};Q.toPrecision=function(t,e){var r,n,i=this,a=i.constructor;return t===void 0?(r=bt(i),n=Ua(i,r<=a.toExpNeg||r>=a.toExpPos)):(Pn(t,1,eo),e===void 0?e=a.rounding:Pn(e,0,8),i=$e(new a(i),t,e),r=bt(i),n=Ua(i,t<=r||r<=a.toExpNeg,t)),n};Q.toSignificantDigits=Q.tosd=function(t,e){var r=this,n=r.constructor;return t===void 0?(t=n.precision,e=n.rounding):(Pn(t,1,eo),e===void 0?e=n.rounding:Pn(e,0,8)),$e(new n(r),t,e)};Q.toString=Q.valueOf=Q.val=Q.toJSON=Q[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=bt(t),r=t.constructor;return Ua(t,e<=r.toExpNeg||e>=r.toExpPos)};function bP(t,e){var r,n,i,a,s,o,c,l,u=t.constructor,h=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Ze?$e(e,h):e;if(c=t.d,l=e.d,s=t.e,i=e.e,c=c.slice(),a=s-i,a){for(a<0?(n=c,a=-a,o=l.length):(n=l,i=s,o=c.length),s=Math.ceil(h/We),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=l.length,o-a<0&&(a=o,n=l,l=c,c=n),r=0;a;)r=(c[--a]=c[a]+l[a]+r)/Ct|0,c[a]%=Ct;for(r&&(c.unshift(r),++i),o=c.length;c[--o]==0;)c.pop();return e.d=c,e.e=i,Ze?$e(e,h):e}function Pn(t,e,r){if(t!==~~t||t<e||t>r)throw Error(Sa+t)}function mn(t){var e,r,n,i=t.length-1,a="",s=t[0];if(i>0){for(a+=s,e=1;e<i;e++)n=t[e]+"",r=We-n.length,r&&(a+=bi(r)),a+=n;s=t[e],n=s+"",r=We-n.length,r&&(a+=bi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Gn=function(){function t(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%Ct|0,s=a/Ct|0;return s&&n.unshift(s),n}function e(n,i,a,s){var o,c;if(a!=s)c=a>s?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=i[o]){c=n[o]>i[o]?1:-1;break}return c}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*Ct+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,c,l,u,h,m,p,v,b,g,_,T,E,j,R,D,I,A,P=n.constructor,O=n.s==i.s?1:-1,N=n.d,C=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(zr+"Division by zero");for(c=n.e-i.e,I=C.length,R=N.length,p=new P(O),v=p.d=[],l=0;C[l]==(N[l]||0);)++l;if(C[l]>(N[l]||0)&&--c,a==null?T=a=P.precision:s?T=a+(bt(n)-bt(i))+1:T=a,T<0)return new P(0);if(T=T/We+2|0,l=0,I==1)for(u=0,C=C[0],T++;(l<R||u)&&T--;l++)E=u*Ct+(N[l]||0),v[l]=E/C|0,u=E%C|0;else{for(u=Ct/(C[0]+1)|0,u>1&&(C=t(C,u),N=t(N,u),I=C.length,R=N.length),j=I,b=N.slice(0,I),g=b.length;g<I;)b[g++]=0;A=C.slice(),A.unshift(0),D=C[0],C[1]>=Ct/2&&++D;do u=0,o=e(C,b,I,g),o<0?(_=b[0],I!=g&&(_=_*Ct+(b[1]||0)),u=_/D|0,u>1?(u>=Ct&&(u=Ct-1),h=t(C,u),m=h.length,g=b.length,o=e(h,b,m,g),o==1&&(u--,r(h,I<m?A:C,m))):(u==0&&(o=u=1),h=C.slice()),m=h.length,m<g&&h.unshift(0),r(b,h,g),o==-1&&(g=b.length,o=e(C,b,I,g),o<1&&(u++,r(b,I<g?A:C,g))),g=b.length):o===0&&(u++,b=[0]),v[l++]=u,o&&b[0]?b[g++]=N[j]||0:(b=[N[j]],g=1);while((j++<R||b[0]!==void 0)&&T--)}return v[0]||v.shift(),p.e=c,$e(p,s?a+bt(p)+1:a)}}();function xP(t,e){var r,n,i,a,s,o,c=0,l=0,u=t.constructor,h=u.precision;if(bt(t)>16)throw Error(Ny+bt(t));if(!t.s)return new u(Er);for(Ze=!1,o=h,s=new u(.03125);t.abs().gte(.1);)t=t.times(s),l+=5;for(n=Math.log(ha(2,l))/Math.LN10*2+5|0,o+=n,r=i=a=new u(Er),u.precision=o;;){if(i=$e(i.times(t),o),r=r.times(++c),s=a.plus(Gn(i,r,o)),mn(s.d).slice(0,o)===mn(a.d).slice(0,o)){for(;l--;)a=$e(a.times(a),o);return u.precision=h,e==null?(Ze=!0,$e(a,h)):a}a=s}}function bt(t){for(var e=t.e*We,r=t.d[0];r>=10;r/=10)e++;return e}function Rf(t,e,r){if(e>t.LN10.sd())throw Ze=!0,r&&(t.precision=r),Error(zr+"LN10 precision limit exceeded");return $e(new t(t.LN10),e)}function bi(t){for(var e="";t--;)e+="0";return e}function bc(t,e){var r,n,i,a,s,o,c,l,u,h=1,m=10,p=t,v=p.d,b=p.constructor,g=b.precision;if(p.s<1)throw Error(zr+(p.s?"NaN":"-Infinity"));if(p.eq(Er))return new b(0);if(e==null?(Ze=!1,l=g):l=e,p.eq(10))return e==null&&(Ze=!0),Rf(b,l);if(l+=m,b.precision=l,r=mn(v),n=r.charAt(0),a=bt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(t),r=mn(p.d),n=r.charAt(0),h++;a=bt(p),n>1?(p=new b("0."+r),a++):p=new b(n+"."+r.slice(1))}else return c=Rf(b,l+2,g).times(a+""),p=bc(new b(n+"."+r.slice(1)),l-m).plus(c),b.precision=g,e==null?(Ze=!0,$e(p,g)):p;for(o=s=p=Gn(p.minus(Er),p.plus(Er),l),u=$e(p.times(p),l),i=3;;){if(s=$e(s.times(u),l),c=o.plus(Gn(s,new b(i),l)),mn(c.d).slice(0,l)===mn(o.d).slice(0,l))return o=o.times(2),a!==0&&(o=o.plus(Rf(b,l+2,g).times(a+""))),o=Gn(o,new b(h),l),b.precision=g,e==null?(Ze=!0,$e(o,g)):o;o=c,i+=2}}function e_(t,e){var r,n,i;for((r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),n=0;e.charCodeAt(n)===48;)++n;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(n,i),e){if(i-=n,r=r-n-1,t.e=to(r/We),t.d=[],n=(r+1)%We,r<0&&(n+=We),n<i){for(n&&t.d.push(+e.slice(0,n)),i-=We;n<i;)t.d.push(+e.slice(n,n+=We));e=e.slice(n),n=We-e.length}else n-=i;for(;n--;)e+="0";if(t.d.push(+e),Ze&&(t.e>id||t.e<-id))throw Error(Ny+r)}else t.s=0,t.e=0,t.d=[0];return t}function $e(t,e,r){var n,i,a,s,o,c,l,u,h=t.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=e-s,n<0)n+=We,i=e,l=h[u=0];else{if(u=Math.ceil((n+1)/We),a=h.length,u>=a)return t;for(l=a=h[u],s=1;a>=10;a/=10)s++;n%=We,i=n-We+s}if(r!==void 0&&(a=ha(10,s-i-1),o=l/a%10|0,c=e<0||h[u+1]!==void 0||l%a,c=r<4?(o||c)&&(r==0||r==(t.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?i>0?l/ha(10,s-i):0:h[u-1])%10&1||r==(t.s<0?8:7))),e<1||!h[0])return c?(a=bt(t),h.length=1,e=e-a-1,h[0]=ha(10,(We-e%We)%We),t.e=to(-e/We)||0):(h.length=1,h[0]=t.e=t.s=0),t;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=ha(10,We-n),h[u]=i>0?(l/ha(10,s-i)%ha(10,i)|0)*a:0),c)for(;;)if(u==0){(h[0]+=a)==Ct&&(h[0]=1,++t.e);break}else{if(h[u]+=a,h[u]!=Ct)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Ze&&(t.e>id||t.e<-id))throw Error(Ny+bt(t));return t}function wP(t,e){var r,n,i,a,s,o,c,l,u,h,m=t.constructor,p=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Ze?$e(e,p):e;if(c=t.d,h=e.d,n=e.e,l=t.e,c=c.slice(),s=l-n,s){for(u=s<0,u?(r=c,s=-s,o=h.length):(r=h,n=l,o=c.length),i=Math.max(Math.ceil(p/We),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=c.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(c[i]!=h[i]){u=c[i]<h[i];break}s=0}for(u&&(r=c,c=h,h=r,e.s=-e.s),o=c.length,i=h.length-o;i>0;--i)c[o++]=0;for(i=h.length;i>s;){if(c[--i]<h[i]){for(a=i;a&&c[--a]===0;)c[a]=Ct-1;--c[a],c[i]+=Ct}c[i]-=h[i]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=n,Ze?$e(e,p):e):new m(0)}function Ua(t,e,r){var n,i=bt(t),a=mn(t.d),s=a.length;return e?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+bi(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+bi(-i-1)+a,r&&(n=r-s)>0&&(a+=bi(n))):i>=s?(a+=bi(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+bi(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=bi(n))),t.s<0?"-"+a:a}function t_(t,e){if(t.length>e)return t.length=e,!0}function _P(t){var e,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Sa+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return e_(s,a.toString())}else if(typeof a!="string")throw Error(Sa+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,l7.test(a))e_(s,a);else throw Error(Sa+a)}if(i.prototype=Q,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=_P,i.config=i.set=u7,t===void 0&&(t={}),t)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<n.length;)t.hasOwnProperty(r=n[e++])||(t[r]=this[r]);return i.config(t),i}function u7(t){if(!t||typeof t!="object")throw Error(zr+"Object expected");var e,r,n,i=["precision",1,eo,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((n=t[r=i[e]])!==void 0)if(to(n)===n&&n>=i[e+1]&&n<=i[e+2])this[r]=n;else throw Error(Sa+r+": "+n);if((n=t[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Sa+r+": "+n);return this}var jy=_P(c7);Er=new jy(1);const je=jy;var d7=t=>t,EP={},TP=t=>t===EP,r_=t=>function e(){return arguments.length===0||arguments.length===1&&TP(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},AP=(t,e)=>t===1?e:r_(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==EP).length;return a>=t?e(...n):AP(t-a,r_(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var l=n.map(u=>TP(u)?o.shift():u);return e(...l,...o)}))}),Sh=t=>AP(t.length,t),ip=(t,e)=>{for(var r=[],n=t;n<e;++n)r[n-t]=n;return r},h7=Sh((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(r=>e[r]).map(t)),f7=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(!r.length)return d7;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,c)=>c(o),a(...arguments))}},ap=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),IP=t=>{var e=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e&&i.every((s,o)=>{var c;return s===((c=e)===null||c===void 0?void 0:c[o])})||(e=i,r=t(...i)),r}};function SP(t){var e;return t===0?e=1:e=Math.floor(new je(t).abs().log(10).toNumber())+1,e}function PP(t,e,r){for(var n=new je(t),i=0,a=[];n.lt(e)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}Sh((t,e,r)=>{var n=+t,i=+e;return n+r*(i-n)});Sh((t,e,r)=>{var n=e-+t;return n=n||1/0,(r-t)/n});Sh((t,e,r)=>{var n=e-+t;return n=n||1/0,Math.max(0,Math.min(1,(r-t)/n))});var CP=t=>{var[e,r]=t,[n,i]=[e,r];return e>r&&([n,i]=[r,e]),[n,i]},kP=(t,e,r)=>{if(t.lte(0))return new je(0);var n=SP(t.toNumber()),i=new je(10).pow(n),a=t.div(i),s=n!==1?.05:.1,o=new je(Math.ceil(a.div(s).toNumber())).add(r).mul(s),c=o.mul(i);return e?new je(c.toNumber()):new je(Math.ceil(c.toNumber()))},m7=(t,e,r)=>{var n=new je(1),i=new je(t);if(!i.isint()&&r){var a=Math.abs(t);a<1?(n=new je(10).pow(SP(t)-1),i=new je(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new je(Math.floor(t)))}else t===0?i=new je(Math.floor((e-1)/2)):r||(i=new je(Math.floor(t)));var s=Math.floor((e-1)/2),o=f7(h7(c=>i.add(new je(c-s).mul(n)).toNumber()),ip);return o(0,e)},NP=function(e,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-e)/(n-1)))return{step:new je(0),tickMin:new je(0),tickMax:new je(0)};var s=kP(new je(r).sub(e).div(n-1),i,a),o;e<=0&&r>=0?o=new je(0):(o=new je(e).add(r).div(2),o=o.sub(new je(o).mod(s)));var c=Math.ceil(o.sub(e).div(s).toNumber()),l=Math.ceil(new je(r).sub(o).div(s).toNumber()),u=c+l+1;return u>n?NP(e,r,n,i,a+1):(u<n&&(l=r>0?l+(n-u):l,c=r>0?c:c+(n-u)),{step:s,tickMin:o.sub(new je(c).mul(s)),tickMax:o.add(new je(l).mul(s))})};function p7(t){var[e,r]=t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=CP([e,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,...ip(0,n-1).map(()=>1/0)]:[...ip(0,n-1).map(()=>-1/0),o];return e>r?ap(c):c}if(s===o)return m7(s,n,i);var{step:l,tickMin:u,tickMax:h}=NP(s,o,a,i,0),m=PP(u,h.add(new je(.1).mul(l)),l);return e>r?ap(m):m}function g7(t,e){var[r,n]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=CP([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(e,2),c=kP(new je(s).sub(a).div(o-1),i,0),l=[...PP(new je(a),new je(s),c),s];return i===!1&&(l=l.map(u=>Math.round(u))),r>n?ap(l):l}var y7=IP(p7),v7=IP(g7),b7=t=>t.rootProps.barCategoryGap,Ph=t=>t.rootProps.stackOffset,Oy=t=>t.options.chartName,Ry=t=>t.rootProps.syncId,jP=t=>t.rootProps.syncMethod,Dy=t=>t.options.eventEmitter,Ln={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},xr={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Ch=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},x7={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:Ln.reversed,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:Ln.type,unit:void 0},w7={allowDataOverflow:xr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:xr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:xr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:xr.scale,tick:xr.tick,tickCount:xr.tickCount,ticks:void 0,type:xr.type,unit:void 0},_7={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ln.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ln.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ln.scale,tick:Ln.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},E7={allowDataOverflow:xr.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:xr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:xr.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:xr.scale,tick:xr.tick,tickCount:xr.tickCount,ticks:void 0,type:"category",unit:void 0},My=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?_7:x7,Ly=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?E7:w7,kh=t=>t.polarOptions,$y=V([ai,si,qt],MB),OP=V([kh,$y],(t,e)=>{if(t!=null)return zi(t.innerRadius,e,0)}),RP=V([kh,$y],(t,e)=>{if(t!=null)return zi(t.outerRadius,e,e*.8)}),T7=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:r}=t;return[e,r]},DP=V([kh],T7);V([My,DP],Ch);var MP=V([$y,OP,RP],(t,e,r)=>{if(!(t==null||e==null||r==null))return[e,r]});V([Ly,MP],Ch);var A7=V([tt,kh,OP,RP,ai,si],(t,e,r,n,i,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:l}=e;return{cx:zi(s,i,i/2),cy:zi(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:l,clockWise:!1}}}),Nt=(t,e)=>e,Nh=(t,e,r)=>r;function n_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ad(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?n_(Object(r),!0).forEach(function(n){I7(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function I7(t,e,r){return(e=S7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S7(t){var e=P7(t,"string");return typeof e=="symbol"?e:e+""}function P7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sp=[0,"auto"],vr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},ci=(t,e)=>{var r=t.cartesianAxis.xAxis[e];return r??vr},br={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:sp,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:vh},Xi=(t,e)=>{var r=t.cartesianAxis.yAxis[e];return r??br},C7={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Vy=(t,e)=>{var r=t.cartesianAxis.zAxis[e];return r??C7},pr=(t,e,r)=>{switch(e){case"xAxis":return ci(t,r);case"yAxis":return Xi(t,r);case"zAxis":return Vy(t,r);case"angleAxis":return My(t,r);case"radiusAxis":return Ly(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},k7=(t,e,r)=>{switch(e){case"xAxis":return ci(t,r);case"yAxis":return Xi(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},Bc=(t,e,r)=>{switch(e){case"xAxis":return ci(t,r);case"yAxis":return Xi(t,r);case"angleAxis":return My(t,r);case"radiusAxis":return Ly(t,r);default:throw new Error("Unexpected axis type: ".concat(e))}},LP=t=>t.graphicalItems.countOfBars>0;function $P(t,e){return r=>{switch(t){case"xAxis":return"xAxisId"in r&&r.xAxisId===e;case"yAxis":return"yAxisId"in r&&r.yAxisId===e;case"zAxis":return"zAxisId"in r&&r.zAxisId===e;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===e;default:return!1}}}var VP=t=>t.graphicalItems.cartesianItems,N7=V([Nt,Nh],$P),FP=(t,e,r)=>t.filter(r).filter(n=>e?.includeHidden===!0?!0:!n.hide),qc=V([VP,pr,N7],FP),zP=t=>t.filter(e=>e.stackId===void 0),j7=V([qc],zP),UP=t=>t.map(e=>e.data).filter(Boolean).flat(1),O7=V([qc],UP),BP=(t,e)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=e;return t.length>0?t:r.slice(n,i+1)},jh=V([O7,yP],BP),qP=(t,e,r)=>e?.dataKey!=null?t.map(n=>({value:Ar(n,e.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>t.map(i=>({value:Ar(i,n)}))):t.map(n=>({value:n})),Oh=V([jh,pr,qc],qP);function HP(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function rs(t){return t.filter(e=>Sn(e)||e instanceof Date).map(Number).filter(e=>Vr(e)===!1)}function R7(t,e,r){return!r||typeof e!="number"||Vr(e)?[]:r.length?rs(r.flatMap(n=>{var i=Ar(t,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!rn(a)||!rn(s)))return[e-a,e+s]})):[]}var WP=(t,e,r)=>{var n={},i=e.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,c=o.map(l=>l.dataKey);return[s,{stackedData:QB(t,c,r),graphicalItems:o}]}))},D7=V([jh,qc,Ph],WP),KP=(t,e,r)=>{var{dataStartIndex:n,dataEndIndex:i}=e;if(r!=="zAxis"){var a=t8(t,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},M7=V([D7,ts,Nt],KP),GP=(t,e,r,n)=>r.length>0?t.flatMap(i=>r.flatMap(a=>{var s,o,c=(s=a.errorBars)===null||s===void 0?void 0:s.filter(u=>HP(n,u)),l=Ar(i,(o=e.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:l,errorDomain:R7(i,l,c)}})).filter(Boolean):e?.dataKey!=null?t.map(i=>({value:Ar(i,e.dataKey),errorDomain:[]})):t.map(i=>({value:i,errorDomain:[]})),L7=V(jh,pr,j7,Nt,GP);function $7(t){var{value:e}=t;if(Sn(e)||e instanceof Date)return e}var V7=t=>{var e=t.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=rs(e);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},F7=(t,e,r)=>{var n=t.map($7).filter(i=>i!=null);return r&&(e.dataKey==null||e.allowDuplicatedCategory&&iI(n))?MS(0,t.length):e.allowDuplicatedCategory?n:Array.from(new Set(n))},Fy=t=>{var e;if(t==null||!("domain"in t))return sp;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var r=rs(t.ticks);return[Math.min(...r),Math.max(...r)]}if(t.type==="category")return t.ticks.map(String)}return(e=t?.domain)!==null&&e!==void 0?e:sp},zy=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},YP=t=>t.referenceElements.dots,ro=(t,e,r)=>t.filter(n=>n.ifOverflow==="extendDomain").filter(n=>e==="xAxis"?n.xAxisId===r:n.yAxisId===r),z7=V([YP,Nt,Nh],ro),ZP=t=>t.referenceElements.areas,U7=V([ZP,Nt,Nh],ro),QP=t=>t.referenceElements.lines,B7=V([QP,Nt,Nh],ro),XP=(t,e)=>{var r=rs(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},q7=V(z7,Nt,XP),JP=(t,e)=>{var r=rs(t.flatMap(n=>[e==="xAxis"?n.x1:n.y1,e==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},H7=V([U7,Nt],JP),eC=(t,e)=>{var r=rs(t.map(n=>e==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},W7=V(B7,Nt,eC),K7=V(q7,W7,H7,(t,e,r)=>zy(t,r,e)),G7=V([pr],Fy),tC=(t,e,r,n,i)=>{var a=s7(e,t.allowDataOverflow);return a??o7(e,zy(r,i,V7(n)),t.allowDataOverflow)},Y7=V([pr,G7,M7,L7,K7],tC),Z7=[0,1],rC=(t,e,r,n,i,a,s)=>{if(!(t==null||r==null||r.length===0)){var{dataKey:o,type:c}=t,l=Yi(e,a);return l&&o==null?MS(0,r.length):c==="category"?F7(n,t,l):i==="expand"?Z7:s}},Uy=V([pr,tt,jh,Oh,Ph,Nt,Y7],rC),nC=(t,e,r,n,i)=>{if(t!=null){var{scale:a,type:s}=t;if(a==="auto")return e==="radial"&&i==="radiusAxis"?"band":e==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(Fg(a));return o in zo?o:"point"}}},Hc=V([pr,tt,LP,Oy,Nt],nC);function Q7(t){if(t!=null){if(t in zo)return zo[t]();var e="scale".concat(Fg(t));if(e in zo)return zo[e]()}}function By(t,e,r,n){if(!(r==null||n==null)){if(typeof t.scale=="function")return t.scale.copy().domain(r).range(n);var i=Q7(e);if(i!=null){var a=i.domain(r).range(n);return KB(a),a}}}var iC=(t,e,r)=>{var n=Fy(e);if(!(r!=="auto"&&r!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Bs(t))return y7(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&Bs(t))return v7(t,e.tickCount,e.allowDecimals)}},qy=V([Uy,Bc,Hc],iC),aC=(t,e,r,n)=>{if(n!=="angleAxis"&&t?.type==="number"&&Bs(e)&&Array.isArray(r)&&r.length>0){var i=e[0],a=r[0],s=e[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return e},X7=V([pr,Uy,qy,Nt],aC),J7=V(Oh,pr,(t,e)=>{if(!(!e||e.type!=="number")){var r=1/0,n=Array.from(rs(t.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),sC=V(J7,tt,b7,qt,(t,e,r,n)=>n,(t,e,r,n,i)=>{if(!rn(t))return 0;var a=e==="vertical"?n.height:n.width;if(i==="gap")return t*a/2;if(i==="no-gap"){var s=zi(r,t*a),o=t*a/2;return o-s-(o-s)/a*s}return 0}),eK=(t,e)=>{var r=ci(t,e);return r==null||typeof r.padding!="string"?0:sC(t,"xAxis",e,r.padding)},tK=(t,e)=>{var r=Xi(t,e);return r==null||typeof r.padding!="string"?0:sC(t,"yAxis",e,r.padding)},rK=V(ci,eK,(t,e)=>{var r,n;if(t==null)return{left:0,right:0};var{padding:i}=t;return typeof i=="string"?{left:e,right:e}:{left:((r=i.left)!==null&&r!==void 0?r:0)+e,right:((n=i.right)!==null&&n!==void 0?n:0)+e}}),nK=V(Xi,tK,(t,e)=>{var r,n;if(t==null)return{top:0,bottom:0};var{padding:i}=t;return typeof i=="string"?{top:e,bottom:e}:{top:((r=i.top)!==null&&r!==void 0?r:0)+e,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+e}}),iK=V([qt,rK,xh,bh,(t,e,r)=>r],(t,e,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),aK=V([qt,tt,nK,xh,bh,(t,e,r)=>r],(t,e,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:e==="horizontal"?[t.top+t.height-r.bottom,t.top+r.top]:[t.top+r.top,t.top+t.height-r.bottom]}),Wc=(t,e,r,n)=>{var i;switch(e){case"xAxis":return iK(t,r,n);case"yAxis":return aK(t,r,n);case"zAxis":return(i=Vy(t,r))===null||i===void 0?void 0:i.range;case"angleAxis":return DP(t);case"radiusAxis":return MP(t,r);default:return}},oC=V([pr,Wc],Ch),no=V([pr,Hc,X7,oC],By);V(qc,Nt,(t,e)=>t.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>HP(e,r)));function cC(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var Rh=(t,e)=>e,Dh=(t,e,r)=>r,sK=V(ny,Rh,Dh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(cC)),oK=V(iy,Rh,Dh,(t,e,r)=>t.filter(n=>n.orientation===e).filter(n=>n.mirror===r).sort(cC)),lC=(t,e)=>({width:t.width,height:e.height}),cK=(t,e)=>{var r=typeof e.width=="number"?e.width:vh;return{width:r,height:t.height}},lK=V(qt,ci,lC),uK=(t,e,r)=>{switch(e){case"top":return t.top;case"bottom":return r-t.bottom;default:return 0}},dK=(t,e,r)=>{switch(e){case"left":return t.left;case"right":return r-t.right;default:return 0}},hK=V(si,qt,sK,Rh,Dh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=lC(e,o);s==null&&(s=uK(e,n,t));var l=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(l)*c.height,s+=(l?-1:1)*c.height}),a}),fK=V(ai,qt,oK,Rh,Dh,(t,e,r,n,i)=>{var a={},s;return r.forEach(o=>{var c=cK(e,o);s==null&&(s=dK(e,n,t));var l=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(l)*c.width,s+=(l?-1:1)*c.width}),a}),mK=(t,e)=>{var r=qt(t),n=ci(t,e);if(n!=null){var i=hK(t,n.orientation,n.mirror),a=i[e];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},pK=(t,e)=>{var r=qt(t),n=Xi(t,e);if(n!=null){var i=fK(t,n.orientation,n.mirror),a=i[e];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},gK=V(qt,Xi,(t,e)=>{var r=typeof e.width=="number"?e.width:vh;return{width:r,height:t.height}}),uC=(t,e,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=Yi(t,n),c=e.map(l=>l.value);if(s&&o&&a==="category"&&i&&iI(c))return c}},Hy=V([tt,Oh,pr,Nt],uC),dC=(t,e,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=Yi(t,n);if(s&&(i==="number"||a!=="auto"))return e.map(o=>o.value)}},Wy=V([tt,Oh,Bc,Nt],dC),i_=V([tt,k7,Hc,no,Hy,Wy,Wc,qy,Nt],(t,e,r,n,i,a,s,o,c)=>{if(e==null)return null;var l=Yi(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:l,niceTicks:o,range:s,realScaleType:r,scale:n}}),yK=(t,e,r,n,i,a,s,o,c)=>{if(!(e==null||n==null)){var l=Yi(t,c),{type:u,ticks:h,tickCount:m}=e,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=u==="category"&&n.bandwidth?n.bandwidth()/p:0;v=c==="angleAxis"&&a!=null&&a.length>=2?Lr(a[0]-a[1])*2*v:v;var b=h||i;if(b){var g=b.map((_,T)=>{var E=s?s.indexOf(_):_;return{index:T,coordinate:n(E)+v,value:_,offset:v}});return g.filter(_=>!Vr(_.coordinate))}return l&&o?o.map((_,T)=>({coordinate:n(_)+v,value:_,index:T,offset:v})):n.ticks?n.ticks(m).map(_=>({coordinate:n(_)+v,value:_,offset:v})):n.domain().map((_,T)=>({coordinate:n(_)+v,value:s?s[_]:_,index:T,offset:v}))}},hC=V([tt,Bc,Hc,no,qy,Wc,Hy,Wy,Nt],yK),vK=(t,e,r,n,i,a,s)=>{if(!(e==null||r==null||n==null||n[0]===n[1])){var o=Yi(t,s),{tickCount:c}=e,l=0;return l=s==="angleAxis"&&n?.length>=2?Lr(n[0]-n[1])*2*l:l,o&&a?a.map((u,h)=>({coordinate:r(u)+l,value:u,index:h,offset:l})):r.ticks?r.ticks(c).map(u=>({coordinate:r(u)+l,value:u,offset:l})):r.domain().map((u,h)=>({coordinate:r(u)+l,value:i?i[u]:u,index:h,offset:l}))}},fC=V([tt,Bc,no,Wc,Hy,Wy,Nt],vK),Mh=V(pr,no,(t,e)=>{if(!(t==null||e==null))return ad(ad({},t),{},{scale:e})}),bK=V([pr,Hc,Uy,oC],By);V((t,e,r)=>Vy(t,r),bK,(t,e)=>{if(!(t==null||e==null))return ad(ad({},t),{},{scale:e})});var xK=V([tt,ny,iy],(t,e,r)=>{switch(t){case"horizontal":return e.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),mC=t=>t.options.defaultTooltipEventType,pC=t=>t.options.validateTooltipEventTypes;function gC(t,e,r){if(t==null)return e;var n=t?"axis":"item";return r==null?e:r.includes(n)?n:e}function Ky(t,e){var r=mC(t),n=pC(t);return gC(e,r,n)}function wK(t){return ae(e=>Ky(e,t))}var yC=(t,e)=>{var r,n=Number(e);if(!(Vr(n)||e==null))return n>=0?t==null||(r=t[n])===null||r===void 0?void 0:r.value:void 0},_K=t=>t.tooltip.settings,Ti={active:!1,index:null,dataKey:void 0,coordinate:void 0},EK={itemInteraction:{click:Ti,hover:Ti},axisInteraction:{click:Ti,hover:Ti},keyboardInteraction:Ti,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},vC=Br({name:"tooltip",initialState:EK,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var r=Bn(t).tooltipItemPayloads.indexOf(e.payload);r>-1&&t.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:TK,removeTooltipEntrySettings:AK,setTooltipSettingsState:IK,setActiveMouseOverItemIndex:SK,mouseLeaveItem:rte,mouseLeaveChart:bC,setActiveClickItemIndex:nte,setMouseOverAxisIndex:xC,setMouseClickAxisIndex:PK,setSyncInteraction:op,setKeyboardInteraction:cp}=vC.actions,CK=vC.reducer;function a_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Hl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?a_(Object(r),!0).forEach(function(n){kK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function kK(t,e,r){return(e=NK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NK(t){var e=jK(t,"string");return typeof e=="symbol"?e:e+""}function jK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OK(t,e,r){return e==="axis"?r==="click"?t.axisInteraction.click:t.axisInteraction.hover:r==="click"?t.itemInteraction.click:t.itemInteraction.hover}function RK(t){return t.index!=null}var wC=(t,e,r,n)=>{if(e==null)return Ti;var i=OK(t,e,r);if(i==null)return Ti;if(i.active)return i;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(RK(i)){if(a)return Hl(Hl({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return Hl(Hl({},Ti),{},{coordinate:i.coordinate})},Gy=(t,e)=>{var r=t?.index;if(r==null)return null;var n=Number(r);if(!rn(n))return r;var i=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(i,Math.min(n,a)))},_C=(t,e,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var c=s[0],l=c==null?void 0:o(c.positions,a);if(l!=null)return l;var u=i?.[Number(a)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+e)/2};default:return{x:(n.left+t)/2,y:u.coordinate}}}},EC=(t,e,r,n)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=t.itemInteraction.hover.dataKey:i=t.itemInteraction.click.dataKey,i==null&&n!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},Kc=t=>t.options.tooltipPayloadSearcher,io=t=>t.tooltip;function s_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function o_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?s_(Object(r),!0).forEach(function(n){DK(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function DK(t,e,r){return(e=MK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MK(t){var e=LK(t,"string");return typeof e=="symbol"?e:e+""}function LK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $K(t,e,r){return Array.isArray(t)&&t&&e+r!==0?t.slice(e,r+1):t}function VK(t,e){return t??e}var TC=(t,e,r,n,i,a,s)=>{if(!(e==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:l,dataEndIndex:u}=r,h=[];return t.reduce((m,p)=>{var v,{dataDefinedOnItem:b,settings:g}=p,_=VK(b,o),T=$K(_,l,u),E=(v=g?.dataKey)!==null&&v!==void 0?v:n?.dataKey,j=g?.nameKey,R;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?R=aI(T,n.dataKey,i):R=a(T,e,c,j),Array.isArray(R))R.forEach(I=>{var A=o_(o_({},g),{},{name:I.name,unit:I.unit,color:void 0,fill:void 0});m.push(Jx({tooltipEntrySettings:A,dataKey:I.dataKey,payload:I.payload,value:Ar(I.payload,I.dataKey),name:I.name}))});else{var D;m.push(Jx({tooltipEntrySettings:g,dataKey:E,payload:R,value:Ar(R,E),name:(D=Ar(R,j))!==null&&D!==void 0?D:g?.name}))}return m},h)}},jt=t=>{var e=tt(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},ao=t=>t.tooltip.settings.axisId,Ht=t=>{var e=jt(t),r=ao(t);return Bc(t,e,r)},Yy=V([Ht,tt,LP,Oy,jt],nC),FK=V([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),zK=V([jt,ao],$P),Lh=V([FK,Ht,zK],FP),UK=V([Lh],UP),ns=V([UK,ts],BP),Zy=V([ns,Ht,Lh],qP),BK=V([Ht],Fy),qK=V([ns,Lh,Ph],WP),HK=V([qK,ts,jt],KP),WK=V([Lh],zP),KK=V([ns,Ht,WK,jt],GP),GK=V([YP,jt,ao],ro),YK=V([GK,jt],XP),ZK=V([ZP,jt,ao],ro),QK=V([ZK,jt],JP),XK=V([QP,jt,ao],ro),JK=V([XK,jt],eC),eG=V([YK,JK,QK],zy),tG=V([Ht,BK,HK,KK,eG],tC),AC=V([Ht,tt,ns,Zy,Ph,jt,tG],rC),rG=V([AC,Ht,Yy],iC),nG=V([Ht,AC,rG,jt],aC),IC=t=>{var e=jt(t),r=ao(t),n=!1;return Wc(t,e,r,n)},SC=V([Ht,IC],Ch),PC=V([Ht,Yy,nG,SC],By),iG=V([tt,Zy,Ht,jt],uC),aG=V([tt,Zy,Ht,jt],dC),sG=(t,e,r,n,i,a,s,o)=>{if(e){var{type:c}=e,l=Yi(t,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=c==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&i!=null&&i?.length>=2?Lr(i[0]-i[1])*2*h:h,l&&s?s.map((m,p)=>({coordinate:n(m)+h,value:m,index:p,offset:h})):n.domain().map((m,p)=>({coordinate:n(m)+h,value:a?a[m]:m,index:p,offset:h}))}}},li=V([tt,Ht,Yy,PC,IC,iG,aG,jt],sG),Qy=V([mC,pC,_K],(t,e,r)=>gC(r.shared,t,e)),CC=t=>t.tooltip.settings.trigger,Xy=t=>t.tooltip.settings.defaultIndex,$h=V([io,Qy,CC,Xy],wC),xc=V([$h,ns],Gy),kC=V([li,xc],yC),oG=V([$h],t=>{if(t)return t.dataKey}),NC=V([io,Qy,CC,Xy],EC),cG=V([ai,si,tt,qt,li,Xy,NC,Kc],_C),lG=V([$h,cG],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),uG=V([$h],t=>t.active),dG=V([NC,xc,ts,Ht,kC,Kc,Qy],TC),hG=V([dG],t=>{if(t!=null){var e=t.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(e))}});function c_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function l_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?c_(Object(r),!0).forEach(function(n){fG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fG(t,e,r){return(e=mG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mG(t){var e=pG(t,"string");return typeof e=="symbol"?e:e+""}function pG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gG=()=>ae(Ht),yG=()=>{var t=gG(),e=ae(li),r=ae(PC);return Bm(l_(l_({},t),{},{scale:r}),e)},vG=()=>ae(Oy),Jy=(t,e)=>e,jC=(t,e,r)=>r,ev=(t,e,r,n)=>n,bG=V(li,t=>ph(t,e=>e.coordinate)),tv=V([io,Jy,jC,ev],wC),OC=V([tv,ns],Gy),xG=(t,e,r)=>{if(e!=null){var n=io(t);return e==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},RC=V([io,Jy,jC,ev],EC),sd=V([ai,si,tt,qt,li,ev,RC,Kc],_C),wG=V([tv,sd],(t,e)=>{var r;return(r=t.coordinate)!==null&&r!==void 0?r:e}),DC=V(li,OC,yC),_G=V([RC,OC,ts,Ht,DC,Kc,Jy],TC),EG=V([tv],t=>({isActive:t.active,activeIndex:t.index})),TG=(t,e,r,n,i,a,s,o)=>{if(!(!t||!e||!n||!i||!a)){var c=r8(t.chartX,t.chartY,e,r,o);if(c){var l=i8(c,e),u=HB(l,s,a,n,i),h=n8(e,a,u,c);return{activeIndex:String(u),activeCoordinate:h}}}};function lp(){return lp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},lp.apply(null,arguments)}function u_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Wl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?u_(Object(r),!0).forEach(function(n){AG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function AG(t,e,r){return(e=IG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IG(t){var e=SG(t,"string");return typeof e=="symbol"?e:e+""}function SG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PG(t){var{coordinate:e,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:c,chartName:l}=t,u=e,h=r,m=n;if(!o||!u||l!=="ScatterChart"&&c!=="axis")return null;var p,v;if(l==="ScatterChart")p=u,v=H8;else if(l==="BarChart")p=W8(s,u,i,a),v=Tq;else if(s==="radial"){var{cx:b,cy:g,radius:_,startAngle:T,endAngle:E}=NS(u);p={cx:b,cy:g,startAngle:T,endAngle:E,innerRadius:_,outerRadius:_},v=Pq}else p={points:Cq(s,u,i)},v=ES;var j=typeof o=="object"&&"className"in o?o.className:void 0,R=Wl(Wl(Wl(Wl({stroke:"#ccc",pointerEvents:"none"},i),p),Ge(o,!1)),{},{payload:h,payloadIndex:m,className:Le("recharts-tooltip-cursor",j)});return w.isValidElement(o)?w.cloneElement(o,R):w.createElement(v,R)}function CG(t){var e=yG(),r=vS(),n=sy(),i=vG();return w.createElement(PG,lp({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:r,layout:n,tooltipAxisBandSize:e,chartName:i}))}var MC=w.createContext(null),kG=()=>w.useContext(MC),LC={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function a(c,l,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||c,m),v=r?r+l:l;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function s(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)e.call(u,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},o.prototype.listeners=function(l){var u=r?r+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,v=new Array(p);m<p;m++)v[m]=h[m].fn;return v},o.prototype.listenerCount=function(l){var u=r?r+l:l,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(l,u,h,m,p,v){var b=r?r+l:l;if(!this._events[b])return!1;var g=this._events[b],_=arguments.length,T,E;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,m),!0;case 5:return g.fn.call(g.context,u,h,m,p),!0;case 6:return g.fn.call(g.context,u,h,m,p,v),!0}for(E=1,T=new Array(_-1);E<_;E++)T[E-1]=arguments[E];g.fn.apply(g.context,T)}else{var j=g.length,R;for(E=0;E<j;E++)switch(g[E].once&&this.removeListener(l,g[E].fn,void 0,!0),_){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,u);break;case 3:g[E].fn.call(g[E].context,u,h);break;case 4:g[E].fn.call(g[E].context,u,h,m);break;default:if(!T)for(R=1,T=new Array(_-1);R<_;R++)T[R-1]=arguments[R];g[E].fn.apply(g[E].context,T)}}return!0},o.prototype.on=function(l,u,h){return a(this,l,u,h,!1)},o.prototype.once=function(l,u,h){return a(this,l,u,h,!0)},o.prototype.removeListener=function(l,u,h,m){var p=r?r+l:l;if(!this._events[p])return this;if(!u)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===u&&(!m||v.once)&&(!h||v.context===h)&&s(this,p);else{for(var b=0,g=[],_=v.length;b<_;b++)(v[b].fn!==u||m&&!v[b].once||h&&v[b].context!==h)&&g.push(v[b]);g.length?this._events[p]=g.length===1?g[0]:g:s(this,p)}return this},o.prototype.removeAllListeners=function(l){var u;return l?(u=r?r+l:l,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,t.exports=o})(LC);var NG=LC.exports;const jG=Hi(NG);var wc=new jG,up="recharts.syncEvent.tooltip",d_="recharts.syncEvent.brush";function OG(t,e){if(e){var r=Number.parseInt(e,10);if(!Vr(r))return t?.[r]}}var RG={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},$C=Br({name:"options",initialState:RG,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),DG=$C.reducer,{createEventEmitter:MG}=$C.actions;function LG(t){return t.tooltip.syncInteraction}var $G={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},VC=Br({name:"chartData",initialState:$G,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:r,endIndex:n}=e.payload;r!=null&&(t.dataStartIndex=r),n!=null&&(t.dataEndIndex=n)}}}),{setChartData:h_,setDataStartEndIndexes:VG,setComputedData:ite}=VC.actions,FG=VC.reducer,FC=()=>{};function zG(){var t=ae(Ry),e=ae(Dy),r=or(),n=ae(jP),i=ae(li),a=sy(),s=ay(),o=ae(c=>c.rootProps.className);w.useEffect(()=>{if(t==null)return FC;var c=(l,u,h)=>{if(e!==h&&t===l){if(n==="index"){r(u);return}if(i!=null){var m;if(typeof n=="function"){var p={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},v=n(i,p);m=i[v]}else n==="value"&&(m=i.find(D=>String(D.value)===u.payload.label));var{coordinate:b}=u.payload;if(m==null||u.payload.active===!1||b==null||s==null){r(op({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:g,y:_}=b,T=Math.min(g,s.x+s.width),E=Math.min(_,s.y+s.height),j={x:a==="horizontal"?m.coordinate:T,y:a==="horizontal"?E:m.coordinate},R=op({active:u.payload.active,coordinate:j,dataKey:u.payload.dataKey,index:String(m.index),label:u.payload.label});r(R)}}};return wc.on(up,c),()=>{wc.off(up,c)}},[o,r,e,t,n,i,a,s])}function UG(){var t=ae(Ry),e=ae(Dy),r=or();w.useEffect(()=>{if(t==null)return FC;var n=(i,a,s)=>{e!==s&&t===i&&r(VG(a))};return wc.on(d_,n),()=>{wc.off(d_,n)}},[r,e,t])}function BG(){var t=or();w.useEffect(()=>{t(MG())},[t]),zG(),UG()}function qG(t,e,r,n,i,a){var s=ae(m=>xG(m,t,e)),o=ae(Dy),c=ae(Ry),l=ae(jP),u=ae(LG),h=u?.active;w.useEffect(()=>{if(!h&&c!=null&&o!=null){var m=op({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});wc.emit(up,c,m,o)}},[h,r,s,i,n,o,c,l,a])}function f_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function m_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f_(Object(r),!0).forEach(function(n){HG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function HG(t,e,r){return(e=WG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WG(t){var e=KG(t,"string");return typeof e=="symbol"?e:e+""}function KG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GG(t){return t.dataKey}function YG(t,e){return w.isValidElement(t)?w.cloneElement(t,e):typeof t=="function"?w.createElement(t,e):w.createElement(E8,e)}var p_=[],ZG={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!$c.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function g_(t){var e=Xa(t,ZG),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:c,offset:l,payloadUniqBy:u,position:h,reverseDirection:m,useTranslate3d:p,wrapperStyle:v,cursor:b,shared:g,trigger:_,defaultIndex:T,portal:E,axisId:j}=e,R=or(),D=typeof T=="number"?String(T):T;w.useEffect(()=>{R(IK({shared:g,trigger:_,axisId:j,active:r,defaultIndex:D}))},[R,g,_,j,r,D]);var I=ay(),A=_S(),P=wK(g),{activeIndex:O,isActive:N}=ae(Fe=>EG(Fe,P,_,D)),C=ae(Fe=>_G(Fe,P,_,D)),k=ae(Fe=>DC(Fe,P,_,D)),J=ae(Fe=>wG(Fe,P,_,D)),oe=C,X=kG(),te=r??N,[he,ye]=B9([oe,te]),Be=P==="axis"?k:void 0;qG(P,_,J,Be,O,te);var se=E??X;if(se==null)return null;var W=oe??p_;te||(W=p_),o&&W.length&&(W=o9(oe.filter(Fe=>Fe.value!=null&&(Fe.hide!==!0||e.includeHidden)),u,GG));var ee=W.length>0,rt=w.createElement(k8,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:c,active:te,coordinate:J,hasPayload:ee,offset:l,position:h,reverseDirection:m,useTranslate3d:p,viewBox:I,wrapperStyle:v,lastBoundingBox:he,innerRef:ye,hasPortalFromProps:!!E},YG(s,m_(m_({},e),{},{payload:W,label:Be,active:te,coordinate:J,accessibilityLayer:A})));return w.createElement(w.Fragment,null,wp.createPortal(rt,se),te&&w.createElement(CG,{cursor:b,tooltipEventType:P,coordinate:J,payload:oe,index:O}))}var zC={},UC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r,n=0,i={}){typeof i!="object"&&(i={});let a=null,s=null,o=null,c=0,l=null,u;const{leading:h=!1,trailing:m=!0,maxWait:p}=i,v="maxWait"in i,b=v?Math.max(Number(p)||0,n):0,g=I=>(a!==null&&(u=r.apply(s,a)),a=s=null,c=I,u),_=I=>(c=I,l=setTimeout(R,n),h&&a!==null?g(I):u),T=I=>(l=null,m&&a!==null?g(I):u),E=I=>{if(o===null)return!0;const A=I-o,P=A>=n||A<0,O=v&&I-c>=b;return P||O},j=I=>{const A=o===null?0:I-o,P=n-A,O=b-(I-c);return v?Math.min(P,O):P},R=()=>{const I=Date.now();if(E(I))return T(I);l=setTimeout(R,j(I))},D=function(...I){const A=Date.now(),P=E(A);if(a=I,s=this,o=A,P){if(l===null)return _(A);if(v)return clearTimeout(l),l=setTimeout(R,n),g(A)}return l===null&&(l=setTimeout(R,n)),u};return D.cancel=()=>{l!==null&&clearTimeout(l),c=0,o=a=s=l=null},D.flush=()=>l===null?u:T(Date.now()),D}t.debounce=e})(UC);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=UC;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return e.debounce(n,i,{leading:s,maxWait:i,trailing:o})}t.throttle=r})(zC);var QG=zC.throttle;const XG=Hi(QG);var Zo=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function y_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Df(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?y_(Object(r),!0).forEach(function(n){JG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function JG(t,e,r){return(e=eY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eY(t){var e=tY(t,"string");return typeof e=="symbol"?e:e+""}function tY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var v_=w.forwardRef((t,e)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:c,children:l,debounce:u=0,id:h,className:m,onResize:p,style:v={}}=t,b=w.useRef(null),g=w.useRef();g.current=p,w.useImperativeHandle(e,()=>b.current);var[_,T]=w.useState({containerWidth:n.width,containerHeight:n.height}),E=w.useCallback((R,D)=>{T(I=>{var A=Math.round(R),P=Math.round(D);return I.containerWidth===A&&I.containerHeight===P?I:{containerWidth:A,containerHeight:P}})},[]);w.useEffect(()=>{var R=P=>{var O,{width:N,height:C}=P[0].contentRect;E(N,C),(O=g.current)===null||O===void 0||O.call(g,N,C)};u>0&&(R=XG(R,u,{trailing:!0,leading:!1}));var D=new ResizeObserver(R),{width:I,height:A}=b.current.getBoundingClientRect();return E(I,A),D.observe(b.current),()=>{D.disconnect()}},[E,u]);var j=w.useMemo(()=>{var{containerWidth:R,containerHeight:D}=_;if(R<0||D<0)return null;Zo(ga(i)||ga(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),Zo(!r||r>0,"The aspect(%s) must be greater than zero.",r);var I=ga(i)?R:i,A=ga(a)?D:a;return r&&r>0&&(I?A=I/r:A&&(I=A*r),c&&A>c&&(A=c)),Zo(I>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,I,A,i,a,s,o,r),w.Children.map(l,P=>w.cloneElement(P,{width:I,height:A,style:Df({width:I,height:A},P.props.style)}))},[r,l,a,c,o,s,_,i]);return w.createElement("div",{id:h?"".concat(h):void 0,className:Le("recharts-responsive-container",m),style:Df(Df({},v),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:c}),ref:b},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},j))});function b_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function dp(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?b_(Object(r),!0).forEach(function(n){rY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function rY(t,e,r){return(e=nY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nY(t){var e=iY(t,"string");return typeof e=="symbol"?e:e+""}function iY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hs={widthCache:{},cacheCount:0},aY=2e3,sY={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},x_="recharts_measurement_span";function oY(t){var e=dp({},t);return Object.keys(e).forEach(r=>{e[r]||delete e[r]}),e}var Qo=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||$c.isSsr)return{width:0,height:0};var n=oY(r),i=JSON.stringify({text:e,copyStyle:n});if(hs.widthCache[i])return hs.widthCache[i];try{var a=document.getElementById(x_);a||(a=document.createElement("span"),a.setAttribute("id",x_),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var s=dp(dp({},sY),n);Object.assign(a.style,s),a.textContent="".concat(e);var o=a.getBoundingClientRect(),c={width:o.width,height:o.height};return hs.widthCache[i]=c,++hs.cacheCount>aY&&(hs.cacheCount=0,hs.widthCache={}),c}catch{return{width:0,height:0}}},w_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,__=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cY=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,lY=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,BC={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},uY=Object.keys(BC),bs="NaN";function dY(t,e){return t*BC[e]}class lr{static parse(e){var r,[,n,i]=(r=lY.exec(e))!==null&&r!==void 0?r:[];return new lr(parseFloat(n),i??"")}constructor(e,r){this.num=e,this.unit=r,this.num=e,this.unit=r,Vr(e)&&(this.unit=""),r!==""&&!cY.test(r)&&(this.num=NaN,this.unit=""),uY.includes(r)&&(this.num=dY(e,r),this.unit="px")}add(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new lr(NaN,""):new lr(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new lr(NaN,""):new lr(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Vr(this.num)}}function qC(t){if(t.includes(bs))return bs;for(var e=t;e.includes("*")||e.includes("/");){var r,[,n,i,a]=(r=w_.exec(e))!==null&&r!==void 0?r:[],s=lr.parse(n??""),o=lr.parse(a??""),c=i==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return bs;e=e.replace(w_,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var l,[,u,h,m]=(l=__.exec(e))!==null&&l!==void 0?l:[],p=lr.parse(u??""),v=lr.parse(m??""),b=h==="+"?p.add(v):p.subtract(v);if(b.isNaN())return bs;e=e.replace(__,b.toString())}return e}var E_=/\(([^()]*)\)/;function hY(t){for(var e=t,r;(r=E_.exec(e))!=null;){var[,n]=r;e=e.replace(E_,qC(n))}return e}function fY(t){var e=t.replace(/\s+/g,"");return e=hY(e),e=qC(e),e}function mY(t){try{return fY(t)}catch{return bs}}function Mf(t){var e=mY(t.slice(5,-1));return e===bs?"":e}var pY=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],gY=["dx","dy","angle","className","breakAll"];function hp(){return hp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},hp.apply(null,arguments)}function T_(t,e){if(t==null)return{};var r,n,i=yY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function yY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var HC=/[ \f\n\r\t\v\u2028\u2029]+/,WC=t=>{var{children:e,breakAll:r,style:n}=t;try{var i=[];lt(e)||(r?i=e.toString().split(""):i=e.toString().split(HC));var a=i.map(o=>({word:o,width:Qo(o,n).width})),s=r?0:Qo(" ",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},vY=(t,e,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:c}=t,l=re(a),u=s,h=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((C,k)=>{var{word:J,width:oe}=k,X=C[C.length-1];if(X&&(n==null||i||X.width+oe+r<Number(n)))X.words.push(J),X.width+=oe+r;else{var te={words:[J],width:oe};C.push(te)}return C},[])},m=h(e),p=O=>O.reduce((N,C)=>N.width>C.width?N:C);if(!l||i)return m;var v=m.length>a||p(m).width>Number(n);if(!v)return m;for(var b="…",g=O=>{var N=u.slice(0,O),C=WC({breakAll:c,style:o,children:N+b}).wordsWithComputedWidth,k=h(C),J=k.length>a||p(k).width>Number(n);return[J,k]},_=0,T=u.length-1,E=0,j;_<=T&&E<=u.length-1;){var R=Math.floor((_+T)/2),D=R-1,[I,A]=g(D),[P]=g(R);if(!I&&!P&&(_=R+1),I&&P&&(T=R-1),!I&&P){j=A;break}E++}return j||m},A_=t=>{var e=lt(t)?[]:t.toString().split(HC);return[{words:e}]},bY=t=>{var{width:e,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=t;if((e||r)&&!$c.isSsr){var o,c,l=WC({breakAll:a,children:n,style:i});if(l){var{wordsWithComputedWidth:u,spaceWidth:h}=l;o=u,c=h}else return A_(n);return vY({breakAll:a,children:n,maxLines:s,style:i},o,c,e,r)}return A_(n)},I_="#808080",rv=w.forwardRef((t,e)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:l=I_}=t,u=T_(t,pY),h=w.useMemo(()=>bY({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:m,dy:p,angle:v,className:b,breakAll:g}=u,_=T_(u,gY);if(!Sn(r)||!Sn(n))return null;var T=r+(re(m)?m:0),E=n+(re(p)?p:0),j;switch(c){case"start":j=Mf("calc(".concat(a,")"));break;case"middle":j=Mf("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:j=Mf("calc(".concat(h.length-1," * -").concat(i,")"));break}var R=[];if(s){var D=h[0].width,{width:I}=u;R.push("scale(".concat(re(I)?I/D:1,")"))}return v&&R.push("rotate(".concat(v,", ").concat(T,", ").concat(E,")")),R.length&&(_.transform=R.join(" ")),w.createElement("text",hp({},Ge(_,!0),{ref:e,x:T,y:E,className:Le("recharts-text",b),textAnchor:o,fill:l.includes("url")?I_:l}),h.map((A,P)=>{var O=A.words.join(g?"":" ");return w.createElement("tspan",{x:T,dy:P===0?j:i,key:"".concat(O,"-").concat(P)},O)}))});rv.displayName="Text";var xY=["offset"],wY=["labelRef"];function S_(t,e){if(t==null)return{};var r,n,i=_Y(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function _Y(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function P_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function ft(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?P_(Object(r),!0).forEach(function(n){EY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function EY(t,e,r){return(e=TY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TY(t){var e=AY(t,"string");return typeof e=="symbol"?e:e+""}function AY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $n(){return $n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$n.apply(null,arguments)}var IY=t=>{var{value:e,formatter:r}=t,n=lt(t.children)?e:t.children;return typeof r=="function"?r(n):n},nv=t=>t!=null&&typeof t=="function",SY=(t,e)=>{var r=Lr(e-t),n=Math.min(Math.abs(e-t),360);return r*n},PY=(t,e,r)=>{var{position:n,viewBox:i,offset:a,className:s}=t,{cx:o,cy:c,innerRadius:l,outerRadius:u,startAngle:h,endAngle:m,clockWise:p}=i,v=(l+u)/2,b=SY(h,m),g=b>=0?1:-1,_,T;n==="insideStart"?(_=h+g*a,T=p):n==="insideEnd"?(_=m-g*a,T=!p):n==="end"&&(_=m+g*a,T=p),T=b<=0?T:!T;var E=Ut(o,c,v,_),j=Ut(o,c,v,_+(T?1:-1)*359),R="M".concat(E.x,",").concat(E.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(T?0:1,`,
    `).concat(j.x,",").concat(j.y),D=lt(t.id)?fc("recharts-radial-line-"):t.id;return w.createElement("text",$n({},r,{dominantBaseline:"central",className:Le("recharts-radial-bar-label",s)}),w.createElement("defs",null,w.createElement("path",{id:D,d:R})),w.createElement("textPath",{xlinkHref:"#".concat(D)},e))},CY=t=>{var{viewBox:e,offset:r,position:n}=t,{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:c,endAngle:l}=e,u=(c+l)/2;if(n==="outside"){var{x:h,y:m}=Ut(i,a,o+r,u);return{x:h,y:m,textAnchor:h>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:v,y:b}=Ut(i,a,p,u);return{x:v,y:b,textAnchor:"middle",verticalAnchor:"middle"}},kY=(t,e)=>{var{parentViewBox:r,offset:n,position:i}=t,{x:a,y:s,width:o,height:c}=e,l=c>=0?1:-1,u=l*n,h=l>0?"end":"start",m=l>0?"start":"end",p=o>=0?1:-1,v=p*n,b=p>0?"end":"start",g=p>0?"start":"end";if(i==="top"){var _={x:a+o/2,y:s-l*n,textAnchor:"middle",verticalAnchor:h};return ft(ft({},_),r?{height:Math.max(s-r.y,0),width:o}:{})}if(i==="bottom"){var T={x:a+o/2,y:s+c+u,textAnchor:"middle",verticalAnchor:m};return ft(ft({},T),r?{height:Math.max(r.y+r.height-(s+c),0),width:o}:{})}if(i==="left"){var E={x:a-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"};return ft(ft({},E),r?{width:Math.max(E.x-r.x,0),height:c}:{})}if(i==="right"){var j={x:a+o+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"};return ft(ft({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:c}:{})}var R=r?{width:o,height:c}:{};return i==="insideLeft"?ft({x:a+v,y:s+c/2,textAnchor:g,verticalAnchor:"middle"},R):i==="insideRight"?ft({x:a+o-v,y:s+c/2,textAnchor:b,verticalAnchor:"middle"},R):i==="insideTop"?ft({x:a+o/2,y:s+u,textAnchor:"middle",verticalAnchor:m},R):i==="insideBottom"?ft({x:a+o/2,y:s+c-u,textAnchor:"middle",verticalAnchor:h},R):i==="insideTopLeft"?ft({x:a+v,y:s+u,textAnchor:g,verticalAnchor:m},R):i==="insideTopRight"?ft({x:a+o-v,y:s+u,textAnchor:b,verticalAnchor:m},R):i==="insideBottomLeft"?ft({x:a+v,y:s+c-u,textAnchor:g,verticalAnchor:h},R):i==="insideBottomRight"?ft({x:a+o-v,y:s+c-u,textAnchor:b,verticalAnchor:h},R):i&&typeof i=="object"&&(re(i.x)||ga(i.x))&&(re(i.y)||ga(i.y))?ft({x:a+zi(i.x,o),y:s+zi(i.y,c),textAnchor:"end",verticalAnchor:"end"},R):ft({x:a+o/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},R)},NY=t=>"cx"in t&&re(t.cx);function wr(t){var{offset:e=5}=t,r=S_(t,xY),n=ft({offset:e},r),{viewBox:i,position:a,value:s,children:o,content:c,className:l="",textBreakAll:u,labelRef:h}=n,m=ay(),p=i||m;if(!p||lt(s)&&lt(o)&&!w.isValidElement(c)&&typeof c!="function")return null;if(w.isValidElement(c)){var{labelRef:v}=n,b=S_(n,wY);return w.cloneElement(c,b)}var g;if(typeof c=="function"){if(g=w.createElement(c,n),w.isValidElement(g))return g}else g=IY(n);var _=NY(p),T=Ge(n,!0);if(_&&(a==="insideStart"||a==="insideEnd"||a==="end"))return PY(n,g,T);var E=_?CY(n):kY(n,p);return w.createElement(rv,$n({ref:h,className:Le("recharts-label",l)},T,E,{breakAll:u}),g)}wr.displayName="Label";var KC=t=>{var{cx:e,cy:r,angle:n,startAngle:i,endAngle:a,r:s,radius:o,innerRadius:c,outerRadius:l,x:u,y:h,top:m,left:p,width:v,height:b,clockWise:g,labelViewBox:_}=t;if(_)return _;if(re(v)&&re(b)){if(re(u)&&re(h))return{x:u,y:h,width:v,height:b};if(re(m)&&re(p))return{x:m,y:p,width:v,height:b}}if(re(u)&&re(h))return{x:u,y:h,width:0,height:0};if(re(e)&&re(r))return{cx:e,cy:r,startAngle:i||n||0,endAngle:a||n||0,innerRadius:c||0,outerRadius:l||o||s||0,clockWise:g};if(t.viewBox)return t.viewBox},jY=(t,e,r)=>{if(!t)return null;var n={viewBox:e,labelRef:r};return t===!0?w.createElement(wr,$n({key:"label-implicit"},n)):Sn(t)?w.createElement(wr,$n({key:"label-implicit",value:t},n)):w.isValidElement(t)?t.type===wr?w.cloneElement(t,ft({key:"label-implicit"},n)):w.createElement(wr,$n({key:"label-implicit",content:t},n)):nv(t)?w.createElement(wr,$n({key:"label-implicit",content:t},n)):t&&typeof t=="object"?w.createElement(wr,$n({},t,{key:"label-implicit"},n)):null},OY=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var{children:i,labelRef:a}=e,s=KC(e),o=oI(i,wr).map((l,u)=>w.cloneElement(l,{viewBox:r||s,key:"label-".concat(u)}));if(!n)return o;var c=jY(e.label,r||s,a);return[c,...o]};wr.parseViewBox=KC;wr.renderCallByParent=OY;var GC={},YC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return r[r.length-1]}t.last=e})(YC);var ZC={};(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(r){return Array.isArray(r)?r:Array.from(r)}t.toArray=e})(ZC);(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=YC,r=ZC,n=uh;function i(a){if(n.isArrayLike(a))return e.last(r.toArray(a))}t.last=i})(GC);var RY=GC.last;const DY=Hi(RY);var MY=["valueAccessor"],LY=["data","dataKey","clockWise","id","textBreakAll"];function od(){return od=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},od.apply(null,arguments)}function C_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function k_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?C_(Object(r),!0).forEach(function(n){$Y(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function $Y(t,e,r){return(e=VY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VY(t){var e=FY(t,"string");return typeof e=="symbol"?e:e+""}function FY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N_(t,e){if(t==null)return{};var r,n,i=zY(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function zY(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var UY=t=>Array.isArray(t.value)?DY(t.value):t.value;function Pa(t){var{valueAccessor:e=UY}=t,r=N_(t,MY),{data:n,dataKey:i,clockWise:a,id:s,textBreakAll:o}=r,c=N_(r,LY);return!n||!n.length?null:w.createElement(Ui,{className:"recharts-label-list"},n.map((l,u)=>{var h=lt(i)?e(l,u):Ar(l&&l.payload,i),m=lt(s)?{}:{id:"".concat(s,"-").concat(u)};return w.createElement(wr,od({},Ge(l,!0),c,m,{parentViewBox:l.parentViewBox,value:h,textBreakAll:o,viewBox:wr.parseViewBox(lt(a)?l:k_(k_({},l),{},{clockWise:a})),key:"label-".concat(u),index:u}))}))}Pa.displayName="LabelList";function BY(t,e){return t?t===!0?w.createElement(Pa,{key:"labelList-implicit",data:e}):w.isValidElement(t)||nv(t)?w.createElement(Pa,{key:"labelList-implicit",data:e,content:t}):typeof t=="object"?w.createElement(Pa,od({data:e},t,{key:"labelList-implicit"})):null:null}function qY(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var{children:n}=t,i=oI(n,Pa).map((s,o)=>w.cloneElement(s,{data:e,key:"labelList-".concat(o)}));if(!r)return i;var a=BY(t.label,e);return[a,...i]}Pa.renderCallByParent=qY;function fp(){return fp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fp.apply(null,arguments)}var QC=t=>{var{cx:e,cy:r,r:n,className:i}=t,a=Le("recharts-dot",i);return e===+e&&r===+r&&n===+n?w.createElement("circle",fp({},Ge(t,!1),Ug(t),{className:a,cx:e,cy:r,r:n})):null},HY={radiusAxis:{},angleAxis:{}},XC=Br({name:"polarAxis",initialState:HY,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:ate,removeRadiusAxis:ste,addAngleAxis:ote,removeAngleAxis:cte}=XC.actions,WY=XC.reducer,KY={countOfBars:0,cartesianItems:[],polarItems:[]},JC=Br({name:"graphicalItems",initialState:KY,reducers:{addBar(t){t.countOfBars+=1},removeBar(t){t.countOfBars-=1},addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:r,next:n}=e.payload,i=Bn(t).cartesianItems.indexOf(r);i>-1&&(t.cartesianItems[i]=n)},removeCartesianGraphicalItem(t,e){var r=Bn(t).cartesianItems.indexOf(e.payload);r>-1&&t.cartesianItems.splice(r,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var r=Bn(t).polarItems.indexOf(e.payload);r>-1&&t.polarItems.splice(r,1)}}}),{addBar:lte,removeBar:ute,addCartesianGraphicalItem:GY,replaceCartesianGraphicalItem:YY,removeCartesianGraphicalItem:ZY,addPolarGraphicalItem:dte,removePolarGraphicalItem:hte}=JC.actions,QY=JC.reducer;function j_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function O_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?j_(Object(r),!0).forEach(function(n){XY(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XY(t,e,r){return(e=JY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JY(t){var e=eZ(t,"string");return typeof e=="symbol"?e:e+""}function eZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tZ(t){var e=or(),r=w.useRef(null);return w.useEffect(()=>{var n=O_(O_({},t),{},{stackId:XB(t.stackId)});r.current===null?e(GY(n)):r.current!==n&&e(YY({prev:r.current,next:n})),r.current=n},[e,t]),w.useEffect(()=>()=>{r.current&&(e(ZY(r.current)),r.current=null)},[e]),null}function rZ(t){var{fn:e,args:r}=t,n=or(),i=mr();return w.useEffect(()=>{if(!i){var a=e(r);return n(TK(a)),()=>{n(AK(a))}}},[e,r,n,i]),null}var nZ=()=>{};function iZ(t){var{legendPayload:e}=t,r=or(),n=mr();return w.useEffect(()=>n?nZ:(r(g8(e)),()=>{r(y8(e))}),[r,n,e]),null}function aZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(fc(e)),n=w.useRef(t);return n.current!==t&&(r.current=fc(e),n.current=t),r.current}var sZ=V([qt],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),oZ=V([sZ,ai,si],(t,e,r)=>{if(!(!t||e==null||r==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,r-t.top-t.bottom)}}),cZ=t=>{var e=mr();return ae(r=>Mh(r,"xAxis",t,e))},lZ=t=>{var e=mr();return ae(r=>Mh(r,"yAxis",t,e))},iv=()=>ae(oZ),uZ=()=>ae(hG);function R_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function D_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?R_(Object(r),!0).forEach(function(n){dZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dZ(t,e,r){return(e=hZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hZ(t){var e=fZ(t,"string");return typeof e=="symbol"?e:e+""}function fZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mZ=t=>{var{point:e,childIndex:r,mainColor:n,activeDot:i,dataKey:a}=t;if(i===!1||e.x==null||e.y==null)return null;var s=D_(D_({index:r,dataKey:a,cx:e.x,cy:e.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:e.payload,value:e.value},Ge(i,!1)),Ug(i)),o;return w.isValidElement(i)?o=w.cloneElement(i,s):typeof i=="function"?o=i(s):o=w.createElement(QC,s),w.createElement(Ui,{className:"recharts-active-dot"},o)};function pZ(t){var{points:e,mainColor:r,activeDot:n,itemDataKey:i}=t,a=ae(xc),s=uZ();if(e==null||s==null)return null;var o=e.find(c=>s.includes(c.payload));return lt(o)?null:mZ({point:o,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var gZ=["children"];function yZ(t,e){if(t==null)return{};var r,n,i=vZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function vZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var M_=()=>{},ek=w.createContext({addErrorBar:M_,removeErrorBar:M_}),bZ={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},tk=w.createContext(bZ);function xZ(t){var{children:e}=t,r=yZ(t,gZ);return w.createElement(tk.Provider,{value:r},e)}var wZ=()=>w.useContext(tk),_Z=t=>{var{children:e,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,data:s,stackId:o,hide:c,type:l,barSize:u}=t,[h,m]=w.useState([]),p=w.useCallback(g=>{m(_=>[..._,g])},[m]),v=w.useCallback(g=>{m(_=>_.filter(T=>T!==g))},[m]),b=mr();return w.createElement(ek.Provider,{value:{addErrorBar:p,removeErrorBar:v}},w.createElement(tZ,{type:l,data:s,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:a,errorBars:h,stackId:o,hide:c,barSize:u,isPanorama:b}),e)};function EZ(t){var{addErrorBar:e,removeErrorBar:r}=w.useContext(ek);return w.useEffect(()=>(e(t),()=>{r(t)}),[e,r,t]),null}var TZ=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function rk(t,e,r){return(e=AZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AZ(t){var e=IZ(t,"string");return typeof e=="symbol"?e:e+""}function IZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _c(){return _c=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_c.apply(null,arguments)}function SZ(t,e){if(t==null)return{};var r,n,i=PZ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function PZ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function CZ(t){var{direction:e,width:r,dataKey:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o}=t,c=SZ(t,TZ),l=Ge(c,!1),{data:u,dataPointFormatter:h,xAxisId:m,yAxisId:p,errorBarOffset:v}=wZ(),b=cZ(m),g=lZ(p);if(b?.scale==null||g?.scale==null||u==null||e==="x"&&b.type!=="number")return null;var _=u.map(T=>{var{x:E,y:j,value:R,errorVal:D}=h(T,n,e);if(!D)return null;var I=[],A,P;if(Array.isArray(D)?[A,P]=D:A=P=D,e==="x"){var{scale:O}=b,N=j+v,C=N+r,k=N-r,J=O(R-A),oe=O(R+P);I.push({x1:oe,y1:C,x2:oe,y2:k}),I.push({x1:J,y1:N,x2:oe,y2:N}),I.push({x1:J,y1:C,x2:J,y2:k})}else if(e==="y"){var{scale:X}=g,te=E+v,he=te-r,ye=te+r,Be=X(R-A),se=X(R+P);I.push({x1:he,y1:se,x2:ye,y2:se}),I.push({x1:te,y1:Be,x2:te,y2:se}),I.push({x1:he,y1:Be,x2:ye,y2:Be})}var W="".concat(E+v,"px ").concat(j+v,"px");return w.createElement(Ui,_c({className:"recharts-errorBar",key:"bar-".concat(I.map(ee=>"".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)))},l),I.map(ee=>{var rt=i?{transformOrigin:"".concat(ee.x1-5,"px")}:void 0;return w.createElement(Ku,{from:{transform:"scaleY(0)",transformOrigin:W},to:{transform:"scaleY(1)",transformOrigin:W},begin:a,easing:o,isActive:i,duration:s,key:"line-".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2),style:{transformOrigin:W}},w.createElement("line",_c({},ee,{style:rt})))}))});return w.createElement(Ui,{className:"recharts-errorBars"},_)}var nk=w.createContext(void 0);function kZ(t){var e=w.useContext(nk);return t??e??"x"}function NZ(t){var{direction:e,children:r}=t;return w.createElement(nk.Provider,{value:e},r)}var ik={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function jZ(t){var e=kZ(t.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s}=Xa(t,ik);return w.createElement(w.Fragment,null,w.createElement(EZ,{dataKey:t.dataKey,direction:e}),w.createElement(CZ,_c({},t,{direction:e,width:r,isAnimationActive:n,animationBegin:i,animationDuration:a,animationEasing:s})))}class ak extends w.Component{render(){return w.createElement(jZ,this.props)}}rk(ak,"defaultProps",ik);rk(ak,"displayName","ErrorBar");function sk(t,e){var r,n,i=ae(l=>ci(l,t)),a=ae(l=>Xi(l,e)),s=(r=i?.allowDataOverflow)!==null&&r!==void 0?r:vr.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:br.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function OZ(t){var{xAxisId:e,yAxisId:r,clipPathId:n}=t,i=iv(),{needClipX:a,needClipY:s,needClip:o}=sk(e,r);if(!o)return null;var{x:c,y:l,width:u,height:h}=i;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?c:c-u/2,y:s?l:l-h/2,width:a?u:u*2,height:s?h:h*2}))}var RZ=t=>{var{chartData:e}=t,r=or(),n=mr();return w.useEffect(()=>n?()=>{}:(r(h_(e)),()=>{r(h_(void 0))}),[e,r,n]),null},L_={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ok=Br({name:"brush",initialState:L_,reducers:{setBrushSettings(t,e){return e.payload==null?L_:e.payload}}}),{setBrushSettings:fte}=ok.actions,DZ=ok.reducer;function MZ(t,e,r){return(e=LZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LZ(t){var e=$Z(t,"string");return typeof e=="symbol"?e:e+""}function $Z(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class av{static create(e){return new av(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case"start":return this.scale(e);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+s}return this.scale(e)}}isInRange(e){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?e>=n&&e<=i:e>=i&&e<=n}}MZ(av,"EPS",1e-4);function VZ(t){return(t%180+180)%180}var FZ=function(e){var{width:r,height:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=VZ(i),s=a*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},zZ={dots:[],areas:[],lines:[]},ck=Br({name:"referenceElements",initialState:zZ,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var r=Bn(t).dots.findIndex(n=>n===e.payload);r!==-1&&t.dots.splice(r,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var r=Bn(t).areas.findIndex(n=>n===e.payload);r!==-1&&t.areas.splice(r,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var r=Bn(t).lines.findIndex(n=>n===e.payload);r!==-1&&t.lines.splice(r,1)}}}),{addDot:mte,removeDot:pte,addArea:gte,removeArea:yte,addLine:vte,removeLine:bte}=ck.actions,UZ=ck.reducer,BZ=w.createContext(void 0),qZ=t=>{var{children:e}=t,[r]=w.useState("".concat(fc("recharts"),"-clip")),n=iv();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return w.createElement(BZ.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:i,y:a,height:o,width:s}))),e)};function Lf(t,e){for(var r in t)if({}.hasOwnProperty.call(t,r)&&(!{}.hasOwnProperty.call(e,r)||t[r]!==e[r]))return!1;for(var n in e)if({}.hasOwnProperty.call(e,n)&&!{}.hasOwnProperty.call(t,n))return!1;return!0}function lk(t,e,r){if(e<1)return[];if(e===1&&r===void 0)return t;for(var n=[],i=0;i<t.length;i+=e)n.push(t[i]);return n}function HZ(t,e,r){var n={width:t.width+e.width,height:t.height+e.height};return FZ(n,r)}function WZ(t,e,r){var n=r==="width",{x:i,y:a,width:s,height:o}=t;return e===1?{start:n?i:a,end:n?i+s:a+o}:{start:n?i+s:a+o,end:n?i:a}}function cd(t,e,r,n,i){if(t*e<t*n||t*e>t*i)return!1;var a=r();return t*(e-t*a/2-n)>=0&&t*(e+t*a/2-i)<=0}function KZ(t,e){return lk(t,e+1)}function GZ(t,e,r,n,i){for(var a=(n||[]).slice(),{start:s,end:o}=e,c=0,l=1,u=s,h=function(){var v=n?.[c];if(v===void 0)return{v:lk(n,l)};var b=c,g,_=()=>(g===void 0&&(g=r(v,b)),g),T=v.coordinate,E=c===0||cd(t,T,_,u,o);E||(c=0,u=s,l+=1),E&&(u=T+t*(_()/2+i),c+=l)},m;l<=a.length;)if(m=h(),m)return m.v;return[]}function $_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Zt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?$_(Object(r),!0).forEach(function(n){YZ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function YZ(t,e,r){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZZ(t){var e=QZ(t,"string");return typeof e=="symbol"?e:e+""}function QZ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XZ(t,e,r,n,i){for(var a=(n||[]).slice(),s=a.length,{start:o}=e,{end:c}=e,l=function(m){var p=a[m],v,b=()=>(v===void 0&&(v=r(p,m)),v);if(m===s-1){var g=t*(p.coordinate+t*b()/2-c);a[m]=p=Zt(Zt({},p),{},{tickCoord:g>0?p.coordinate-g*t:p.coordinate})}else a[m]=p=Zt(Zt({},p),{},{tickCoord:p.coordinate});var _=cd(t,p.tickCoord,b,o,c);_&&(c=p.tickCoord-t*(b()/2+i),a[m]=Zt(Zt({},p),{},{isShow:!0}))},u=s-1;u>=0;u--)l(u);return a}function JZ(t,e,r,n,i,a){var s=(n||[]).slice(),o=s.length,{start:c,end:l}=e;if(a){var u=n[o-1],h=r(u,o-1),m=t*(u.coordinate+t*h/2-l);s[o-1]=u=Zt(Zt({},u),{},{tickCoord:m>0?u.coordinate-m*t:u.coordinate});var p=cd(t,u.tickCoord,()=>h,c,l);p&&(l=u.tickCoord-t*(h/2+i),s[o-1]=Zt(Zt({},u),{},{isShow:!0}))}for(var v=a?o-1:o,b=function(T){var E=s[T],j,R=()=>(j===void 0&&(j=r(E,T)),j);if(T===0){var D=t*(E.coordinate-t*R()/2-c);s[T]=E=Zt(Zt({},E),{},{tickCoord:D<0?E.coordinate-D*t:E.coordinate})}else s[T]=E=Zt(Zt({},E),{},{tickCoord:E.coordinate});var I=cd(t,E.tickCoord,R,c,l);I&&(c=E.tickCoord+t*(R()/2+i),s[T]=Zt(Zt({},E),{},{isShow:!0}))},g=0;g<v;g++)b(g);return s}function sv(t,e,r){var{tick:n,ticks:i,viewBox:a,minTickGap:s,orientation:o,interval:c,tickFormatter:l,unit:u,angle:h}=t;if(!i||!i.length||!n)return[];if(re(c)||$c.isSsr){var m;return(m=KZ(i,re(c)?c:0))!==null&&m!==void 0?m:[]}var p=[],v=o==="top"||o==="bottom"?"width":"height",b=u&&v==="width"?Qo(u,{fontSize:e,letterSpacing:r}):{width:0,height:0},g=(E,j)=>{var R=typeof l=="function"?l(E.value,j):E.value;return v==="width"?HZ(Qo(R,{fontSize:e,letterSpacing:r}),b,h):Qo(R,{fontSize:e,letterSpacing:r})[v]},_=i.length>=2?Lr(i[1].coordinate-i[0].coordinate):1,T=WZ(a,_,v);return c==="equidistantPreserveStart"?GZ(_,T,g,i,s):(c==="preserveStart"||c==="preserveStartEnd"?p=JZ(_,T,g,i,s,c==="preserveStartEnd"):p=XZ(_,T,g,i,s),p.filter(E=>E.isShow))}var eQ=["viewBox"],tQ=["viewBox"];function xs(){return xs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xs.apply(null,arguments)}function V_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function _t(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?V_(Object(r),!0).forEach(function(n){ov(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function F_(t,e){if(t==null)return{};var r,n,i=rQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function rQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ov(t,e,r){return(e=nQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nQ(t){var e=iQ(t,"string");return typeof e=="symbol"?e:e+""}function iQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ji extends w.Component{constructor(e){super(e),this.tickRefs=w.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(e,r){var{viewBox:n}=e,i=F_(e,eQ),a=this.props,{viewBox:s}=a,o=F_(a,tQ);return!Lf(n,s)||!Lf(i,o)||!Lf(r,this.state)}getTickLineCoord(e){var{x:r,y:n,width:i,height:a,orientation:s,tickSize:o,mirror:c,tickMargin:l}=this.props,u,h,m,p,v,b,g=c?-1:1,_=e.tickSize||o,T=re(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=h=e.coordinate,p=n+ +!c*a,m=p-g*_,b=m-g*l,v=T;break;case"left":m=p=e.coordinate,h=r+ +!c*i,u=h-g*_,v=u-g*l,b=T;break;case"right":m=p=e.coordinate,h=r+ +c*i,u=h+g*_,v=u+g*l,b=T;break;default:u=h=e.coordinate,p=n+ +c*a,m=p+g*_,b=m+g*l,v=T;break}return{line:{x1:u,y1:m,x2:h,y2:p},tick:{x:v,y:b}}}getTickTextAnchor(){var{orientation:e,mirror:r}=this.props,n;switch(e){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:e,mirror:r}=this.props;switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:e,y:r,width:n,height:i,orientation:a,mirror:s,axisLine:o}=this.props,c=_t(_t(_t({},Ge(this.props,!1)),Ge(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var l=+(a==="top"&&!s||a==="bottom"&&s);c=_t(_t({},c),{},{x1:e,y1:r+l*i,x2:e+n,y2:r+l*i})}else{var u=+(a==="left"&&!s||a==="right"&&s);c=_t(_t({},c),{},{x1:e+u*n,y1:r,x2:e+u*n,y2:r+i})}return w.createElement("line",xs({},c,{className:Le("recharts-cartesian-axis-line",za(o,"className"))}))}static renderTickItem(e,r,n){var i,a=Le(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(e))i=w.cloneElement(e,_t(_t({},r),{},{className:a}));else if(typeof e=="function")i=e(_t(_t({},r),{},{className:a}));else{var s="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(s=Le(s,e.className)),i=w.createElement(rv,xs({},r,{className:s}),n)}return i}renderTicks(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:a,tick:s,tickFormatter:o,unit:c}=this.props,l=sv(_t(_t({},this.props),{},{ticks:n}),e,r),u=this.getTickTextAnchor(),h=this.getTickVerticalAnchor(),m=Ge(this.props,!1),p=Ge(s,!1),v=_t(_t({},m),{},{fill:"none"},Ge(i,!1)),b=l.map((g,_)=>{var{line:T,tick:E}=this.getTickLineCoord(g),j=_t(_t(_t(_t({textAnchor:u,verticalAnchor:h},m),{},{stroke:"none",fill:a},p),E),{},{index:_,payload:g,visibleTicksCount:l.length,tickFormatter:o});return w.createElement(Ui,xs({className:"recharts-cartesian-axis-tick",key:"tick-".concat(g.value,"-").concat(g.coordinate,"-").concat(g.tickCoord)},CU(this.props,g,_)),i&&w.createElement("line",xs({},v,T,{className:Le("recharts-cartesian-axis-tick-line",za(i,"className"))})),s&&Ji.renderTickItem(s,j,"".concat(typeof o=="function"?o(g.value,_):g.value).concat(c||"")))});return b.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},b):null}render(){var{axisLine:e,width:r,height:n,className:i,hide:a}=this.props;if(a)return null;var{ticks:s}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:w.createElement(Ui,{className:Le("recharts-cartesian-axis",i),ref:o=>{if(o){var c=o.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(c);var l=c[0];if(l){var u=window.getComputedStyle(l).fontSize,h=window.getComputedStyle(l).letterSpacing;(u!==this.state.fontSize||h!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(l).fontSize,letterSpacing:window.getComputedStyle(l).letterSpacing})}}}},e&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,s),wr.renderCallByParent(this.props))}}ov(Ji,"displayName","CartesianAxis");ov(Ji,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var aQ=["x1","y1","x2","y2","key"],sQ=["offset"],oQ=["xAxisId","yAxisId"],cQ=["xAxisId","yAxisId"];function z_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Jt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?z_(Object(r),!0).forEach(function(n){lQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lQ(t,e,r){return(e=uQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uQ(t){var e=dQ(t,"string");return typeof e=="symbol"?e:e+""}function dQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xa(){return xa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xa.apply(null,arguments)}function ld(t,e){if(t==null)return{};var r,n,i=hQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function hQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var fQ=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:s,ry:o}=t;return w.createElement("rect",{x:n,y:i,ry:o,width:a,height:s,stroke:"none",fill:e,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function uk(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var{x1:n,y1:i,x2:a,y2:s,key:o}=e,c=ld(e,aQ),l=Ge(c,!1),{offset:u}=l,h=ld(l,sQ);r=w.createElement("line",xa({},h,{x1:n,y1:i,x2:a,y2:s,fill:"none",key:o}))}return r}function mQ(t){var{x:e,width:r,horizontal:n=!0,horizontalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=ld(t,oQ),c=i.map((l,u)=>{var h=Jt(Jt({},o),{},{x1:e,y1:l,x2:e+r,y2:l,key:"line-".concat(u),index:u});return uk(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function pQ(t){var{y:e,height:r,vertical:n=!0,verticalPoints:i}=t;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:s}=t,o=ld(t,cQ),c=i.map((l,u)=>{var h=Jt(Jt({},o),{},{x1:l,y1:e,x2:l,y2:e+r,key:"line-".concat(u),index:u});return uk(n,h)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function gQ(t){var{horizontalFill:e,fillOpacity:r,x:n,y:i,width:a,height:s,horizontalPoints:o,horizontal:c=!0}=t;if(!c||!e||!e.length)return null;var l=o.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var u=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%e.length;return w.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:v,width:a,stroke:"none",fill:e[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function yQ(t){var{vertical:e=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:s,height:o,verticalPoints:c}=t;if(!e||!r||!r.length)return null;var l=c.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==l[0]&&l.unshift(0);var u=l.map((h,m)=>{var p=!l[m+1],v=p?i+s-h:l[m+1]-h;if(v<=0)return null;var b=m%r.length;return w.createElement("rect",{key:"react-".concat(m),x:h,y:a,width:v,height:o,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var vQ=(t,e)=>{var{xAxis:r,width:n,height:i,offset:a}=t;return fS(sv(Jt(Jt(Jt({},Ji.defaultProps),r),{},{ticks:mS(r),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,e)},bQ=(t,e)=>{var{yAxis:r,width:n,height:i,offset:a}=t;return fS(sv(Jt(Jt(Jt({},Ji.defaultProps),r),{},{ticks:mS(r),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,e)},xQ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function mp(t){var e=bS(),r=xS(),n=vS(),i=Jt(Jt({},Xa(t,xQ)),{},{x:re(t.x)?t.x:n.left,y:re(t.y)?t.y:n.top,width:re(t.width)?t.width:n.width,height:re(t.height)?t.height:n.height}),{xAxisId:a,yAxisId:s,x:o,y:c,width:l,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,v=mr(),b=ae(P=>i_(P,"xAxis",a,v)),g=ae(P=>i_(P,"yAxis",s,v));if(!re(l)||l<=0||!re(u)||u<=0||!re(o)||o!==+o||!re(c)||c!==+c)return null;var _=i.verticalCoordinatesGenerator||vQ,T=i.horizontalCoordinatesGenerator||bQ,{horizontalPoints:E,verticalPoints:j}=i;if((!E||!E.length)&&typeof T=="function"){var R=m&&m.length,D=T({yAxis:g?Jt(Jt({},g),{},{ticks:R?m:g.ticks}):void 0,width:e,height:r,offset:n},R?!0:h);Zo(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(E=D)}if((!j||!j.length)&&typeof _=="function"){var I=p&&p.length,A=_({xAxis:b?Jt(Jt({},b),{},{ticks:I?p:b.ticks}):void 0,width:e,height:r,offset:n},I?!0:h);Zo(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(j=A)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(fQ,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),w.createElement(gQ,xa({},i,{horizontalPoints:E})),w.createElement(yQ,xa({},i,{verticalPoints:j})),w.createElement(mQ,xa({},i,{offset:n,horizontalPoints:E,xAxis:b,yAxis:g})),w.createElement(pQ,xa({},i,{offset:n,verticalPoints:j,xAxis:b,yAxis:g})))}mp.displayName="CartesianGrid";var dk=(t,e,r,n)=>Mh(t,"xAxis",e,n),hk=(t,e,r,n)=>fC(t,"xAxis",e,n),fk=(t,e,r,n)=>Mh(t,"yAxis",r,n),mk=(t,e,r,n)=>fC(t,"yAxis",r,n),wQ=V([tt,dk,fk,hk,mk],(t,e,r,n,i)=>Yi(t,"xAxis")?Bm(e,n,!1):Bm(r,i,!1)),_Q=(t,e,r,n,i)=>i,EQ=V([VP,_Q],(t,e)=>{if(t.some(r=>r.type==="line"&&e.dataKey===r.dataKey&&e.data===r.data))return e}),TQ=V([tt,dk,fk,hk,mk,EQ,wQ,yP],(t,e,r,n,i,a,s,o)=>{var{chartData:c,dataStartIndex:l,dataEndIndex:u}=o;if(!(a==null||e==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{dataKey:h,data:m}=a,p;if(m!=null&&m.length>0?p=m:p=c?.slice(l,u+1),p!=null)return BQ({layout:t,xAxis:e,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:h,bandSize:s,displayedData:p})}}),AQ=["type","layout","connectNulls","needClip"],IQ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function pk(t,e){if(t==null)return{};var r,n,i=SQ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function SQ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function U_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function Kr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?U_(Object(r),!0).forEach(function(n){Vh(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Vh(t,e,r){return(e=PQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PQ(t){var e=CQ(t,"string");return typeof e=="symbol"?e:e+""}function CQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qs(){return qs=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qs.apply(null,arguments)}var kQ=t=>{var{dataKey:e,name:r,stroke:n,legendType:i,hide:a}=t;return[{inactive:a,dataKey:e,type:i,color:n,value:pS(r,e),payload:t}]};function NQ(t){var{dataKey:e,data:r,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:c}=t;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:e,nameKey:void 0,name:pS(s,e),hide:o,type:t.tooltipType,color:t.stroke,unit:c}}}var gk=(t,e)=>"".concat(e,"px ").concat(t-e,"px");function jQ(t,e){for(var r=t.length%2!==0?[...t,0]:t,n=[],i=0;i<e;++i)n=[...n,...r];return n}var OQ=(t,e,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return gk(e,t);for(var i=Math.floor(t/n),a=t%n,s=e-t,o=[],c=0,l=0;c<r.length;l+=r[c],++c)if(l+r[c]>a){o=[...r.slice(0,c),a-l];break}var u=o.length%2===0?[0,s]:[s];return[...jQ(r,i),...o,...u].map(h=>"".concat(h,"px")).join(", ")};function RQ(t,e){var r;if(w.isValidElement(t))r=w.cloneElement(t,e);else if(typeof t=="function")r=t(e);else{var n=Le("recharts-line-dot",typeof t!="boolean"?t.className:"");r=w.createElement(QC,qs({},e,{className:n}))}return r}function DQ(t,e){return t==null?!1:e?!0:t.length===1}function MQ(t){var{clipPathId:e,points:r,props:n}=t,{dot:i,dataKey:a,needClip:s}=n;if(!DQ(r,i))return null;var o=cI(i),c=Ge(n,!1),l=Ge(i,!0),u=r.map((m,p)=>{var v=Kr(Kr(Kr({key:"dot-".concat(p),r:3},c),l),{},{index:p,cx:m.x,cy:m.y,dataKey:a,value:m.value,payload:m.payload,points:r});return RQ(i,v)}),h={clipPath:s?"url(#clipPath-".concat(o?"":"dots-").concat(e,")"):null};return w.createElement(Ui,qs({className:"recharts-line-dots",key:"dots"},h),u)}function pp(t){var{clipPathId:e,pathRef:r,points:n,strokeDasharray:i,props:a,showLabels:s}=t,{type:o,layout:c,connectNulls:l,needClip:u}=a,h=pk(a,AQ),m=Kr(Kr({},Ge(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(e,")"):null,points:n,type:o,layout:c,connectNulls:l,strokeDasharray:i??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(ES,qs({},m,{pathRef:r})),w.createElement(MQ,{points:n,clipPathId:e,props:a}),s&&Pa.renderCallByParent(a,n))}function LQ(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function $Q(t){var{clipPathId:e,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=t,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:l,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:v,onAnimationEnd:b,onAnimationStart:g}=r,_=i.current,T=aZ(r,"recharts-line-"),[E,j]=w.useState(!1),R=w.useCallback(()=>{typeof b=="function"&&b(),j(!1)},[b]),D=w.useCallback(()=>{typeof g=="function"&&g(),j(!0)},[g]),I=LQ(n.current),A=a.current;return w.createElement(Ku,{begin:l,duration:u,isActive:c,easing:h,from:{t:0},to:{t:1},onAnimationEnd:R,onAnimationStart:D,key:T},P=>{var{t:O}=P,N=Ao(A,I+A),C=Math.min(N(O),I),k;if(o){var J="".concat(o).split(/[,\s]+/gim).map(te=>parseFloat(te));k=OQ(C,I,J)}else k=gk(I,C);if(_){var oe=_.length/s.length,X=O===1?s:s.map((te,he)=>{var ye=Math.floor(he*oe);if(_[ye]){var Be=_[ye],se=Ao(Be.x,te.x),W=Ao(Be.y,te.y);return Kr(Kr({},te),{},{x:se(O),y:W(O)})}if(m){var ee=Ao(p*2,te.x),rt=Ao(v/2,te.y);return Kr(Kr({},te),{},{x:ee(O),y:rt(O)})}return Kr(Kr({},te),{},{x:te.x,y:te.y})});return i.current=X,w.createElement(pp,{props:r,points:X,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})}return O>0&&I>0&&(i.current=s,a.current=C),w.createElement(pp,{props:r,points:s,clipPathId:e,pathRef:n,showLabels:!E,strokeDasharray:k})})}function VQ(t){var{clipPathId:e,props:r}=t,{points:n,isAnimationActive:i}=r,a=w.useRef(null),s=w.useRef(0),o=w.useRef(null),c=a.current;return i&&n&&n.length&&c!==n?w.createElement($Q,{props:r,clipPathId:e,previousPointsRef:a,longestAnimatedLengthRef:s,pathRef:o}):w.createElement(pp,{props:r,points:n,clipPathId:e,pathRef:o,showLabels:!0})}var FQ=(t,e)=>({x:t.x,y:t.y,value:t.value,errorVal:Ar(t.payload,e)});class zQ extends w.Component{constructor(){super(...arguments),Vh(this,"id",fc("recharts-line-"))}render(){var e,{hide:r,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:c,left:l,width:u,height:h,id:m,needClip:p,layout:v}=this.props;if(r)return null;var b=Le("recharts-line",a),g=lt(m)?this.id:m,{r:_=3,strokeWidth:T=2}=(e=Ge(n,!1))!==null&&e!==void 0?e:{r:3,strokeWidth:2},E=cI(n),j=_*2+T;return w.createElement(w.Fragment,null,w.createElement(Ui,{className:b},p&&w.createElement("defs",null,w.createElement(OZ,{clipPathId:g,xAxisId:s,yAxisId:o}),!E&&w.createElement("clipPath",{id:"clipPath-dots-".concat(g)},w.createElement("rect",{x:l-j/2,y:c-j/2,width:u+j,height:h+j}))),w.createElement(VQ,{props:this.props,clipPathId:g}),w.createElement(NZ,{direction:v==="horizontal"?"y":"x"},w.createElement(xZ,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:FQ,errorBarOffset:0},this.props.children))),w.createElement(pZ,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var yk={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!$c.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function UQ(t){var e=Xa(t,yk),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,connectNulls:o,dot:c,hide:l,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:v}=e,b=pk(e,IQ),{needClip:g}=sk(p,v),{height:_,width:T,x:E,y:j}=iv(),R=sy(),D=mr(),I=w.useMemo(()=>({dataKey:t.dataKey,data:t.data}),[t.dataKey,t.data]),A=ae(P=>TQ(P,p,v,D,I));return R!=="horizontal"&&R!=="vertical"?null:w.createElement(zQ,qs({},b,{connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:s,isAnimationActive:u,hide:l,label:h,legendType:m,xAxisId:p,yAxisId:v,points:A,layout:R,height:_,width:T,left:E,top:j,needClip:g}))}function BQ(t){var{layout:e,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:s,bandSize:o,displayedData:c}=t;return c.map((l,u)=>{var h=Ar(l,s);return e==="horizontal"?{x:Zx({axis:r,ticks:i,bandSize:o,entry:l,index:u}),y:lt(h)?null:n.scale(h),value:h,payload:l}:{x:lt(h)?null:r.scale(h),y:Zx({axis:n,ticks:a,bandSize:o,entry:l,index:u}),value:h,payload:l}})}class ud extends w.PureComponent{render(){return w.createElement(_Z,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},w.createElement(iZ,{legendPayload:kQ(this.props)}),w.createElement(rZ,{fn:NQ,args:this.props}),w.createElement(UQ,this.props))}}Vh(ud,"displayName","Line");Vh(ud,"defaultProps",yk);function B_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function q_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?B_(Object(r),!0).forEach(function(n){qQ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qQ(t,e,r){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KQ={xAxis:{},yAxis:{},zAxis:{}},vk=Br({name:"cartesianAxis",initialState:KQ,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:r,width:n}=e.payload;t.yAxis[r]&&(t.yAxis[r]=q_(q_({},t.yAxis[r]),{},{width:n}))}}}),{addXAxis:GQ,removeXAxis:YQ,addYAxis:ZQ,removeYAxis:QQ,addZAxis:xte,removeZAxis:wte,updateYAxisWidth:XQ}=vk.actions,JQ=vk.reducer,eX=["children"],tX=["dangerouslySetInnerHTML","ticks"];function bk(t,e,r){return(e=rX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rX(t){var e=nX(t,"string");return typeof e=="symbol"?e:e+""}function nX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gp(){return gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gp.apply(null,arguments)}function xk(t,e){if(t==null)return{};var r,n,i=iX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function iX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function aX(t){var e=or(),r=w.useMemo(()=>{var{children:a}=t,s=xk(t,eX);return s},[t]),n=ae(a=>ci(a,r.id)),i=r===n;return w.useEffect(()=>(e(GQ(r)),()=>{e(YQ(r))}),[r,e]),i?t.children:null}var sX=t=>{var{xAxisId:e,className:r}=t,n=ae(yS),i=mr(),a="xAxis",s=ae(p=>no(p,a,e,i)),o=ae(p=>hC(p,a,e,i)),c=ae(p=>lK(p,e)),l=ae(p=>mK(p,e));if(c==null||l==null)return null;var{dangerouslySetInnerHTML:u,ticks:h}=t,m=xk(t,tX);return w.createElement(Ji,gp({},m,{scale:s,x:l.x,y:l.y,width:c.width,height:c.height,className:Le("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},oX=t=>{var e,r,n,i,a;return w.createElement(aX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter},w.createElement(sX,t))};class dd extends w.Component{render(){return w.createElement(oX,this.props)}}bk(dd,"displayName","XAxis");bk(dd,"defaultProps",{allowDataOverflow:vr.allowDataOverflow,allowDecimals:vr.allowDecimals,allowDuplicatedCategory:vr.allowDuplicatedCategory,height:vr.height,hide:!1,mirror:vr.mirror,orientation:vr.orientation,padding:vr.padding,reversed:vr.reversed,scale:vr.scale,tickCount:vr.tickCount,type:vr.type,xAxisId:0});var cX=t=>{var{ticks:e,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=t,s=0;if(e){e.forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>s&&(s=h.width)}});var o=r?r.getBoundingClientRect().width:0,c=i+a,l=s+c+o+(r?n:0);return Math.round(l)}return 0},lX=["dangerouslySetInnerHTML","ticks"];function wk(t,e,r){return(e=uX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uX(t){var e=dX(t,"string");return typeof e=="symbol"?e:e+""}function dX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yp(){return yp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yp.apply(null,arguments)}function hX(t,e){if(t==null)return{};var r,n,i=fX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function fX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function mX(t){var e=or();return w.useEffect(()=>(e(ZQ(t)),()=>{e(QQ(t))}),[t,e]),null}var pX=t=>{var e,{yAxisId:r,className:n,width:i,label:a}=t,s=w.useRef(null),o=w.useRef(null),c=ae(yS),l=mr(),u=or(),h="yAxis",m=ae(E=>no(E,h,r,l)),p=ae(E=>gK(E,r)),v=ae(E=>pK(E,r)),b=ae(E=>hC(E,h,r,l));if(w.useLayoutEffect(()=>{var E;if(!(i!=="auto"||!p||nv(a)||w.isValidElement(a))){var j=s.current,R=j==null||(E=j.tickRefs)===null||E===void 0?void 0:E.current,{tickSize:D,tickMargin:I}=j.props,A=cX({ticks:R,label:o.current,labelGapWithTick:5,tickSize:D,tickMargin:I});Math.round(p.width)!==Math.round(A)&&u(XQ({id:r,width:A}))}},[s,s==null||(e=s.current)===null||e===void 0||(e=e.tickRefs)===null||e===void 0?void 0:e.current,p?.width,p,u,a,r,i]),p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=t,T=hX(t,lX);return w.createElement(Ji,yp({},T,{ref:s,labelRef:o,scale:m,x:v.x,y:v.y,width:p.width,height:p.height,className:Le("recharts-".concat(h," ").concat(h),n),viewBox:c,ticks:b}))},gX=t=>{var e,r,n,i,a;return w.createElement(w.Fragment,null,w.createElement(mX,{interval:(e=t.interval)!==null&&e!==void 0?e:"preserveEnd",id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:(r=t.includeHidden)!==null&&r!==void 0?r:!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:(n=t.angle)!==null&&n!==void 0?n:0,minTickGap:(i=t.minTickGap)!==null&&i!==void 0?i:5,tick:(a=t.tick)!==null&&a!==void 0?a:!0,tickFormatter:t.tickFormatter}),w.createElement(pX,t))},yX={allowDataOverflow:br.allowDataOverflow,allowDecimals:br.allowDecimals,allowDuplicatedCategory:br.allowDuplicatedCategory,hide:!1,mirror:br.mirror,orientation:br.orientation,padding:br.padding,reversed:br.reversed,scale:br.scale,tickCount:br.tickCount,type:br.type,width:br.width,yAxisId:0};class hd extends w.Component{render(){return w.createElement(gX,this.props)}}wk(hd,"displayName","YAxis");wk(hd,"defaultProps",yX);var vX={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gc=w;function bX(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xX=typeof Object.is=="function"?Object.is:bX,wX=Gc.useSyncExternalStore,_X=Gc.useRef,EX=Gc.useEffect,TX=Gc.useMemo,AX=Gc.useDebugValue;vX.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=_X(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=TX(function(){function c(p){if(!l){if(l=!0,u=p,p=n(p),i!==void 0&&s.hasValue){var v=s.value;if(i(v,p))return h=v}return h=p}if(v=h,xX(u,p))return v;var b=n(p);return i!==void 0&&i(v,b)?(u=p,v):(u=p,h=b)}var l=!1,u,h,m=r===void 0?null:r;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,r,n,i]);var o=wX(t,a[0],a[1]);return EX(function(){s.hasValue=!0,s.value=o},[o]),AX(o),o};function IX(t){t()}function SX(){let t=null,e=null;return{clear(){t=null,e=null},notify(){IX(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=t;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=e={callback:r,next:null,prev:e};return i.prev?i.prev.next=i:t=i,function(){!n||t===null||(n=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var H_={notify(){},get:()=>[]};function PX(t,e){let r,n=H_,i=0,a=!1;function s(b){u();const g=n.subscribe(b);let _=!1;return()=>{_||(_=!0,g(),h())}}function o(){n.notify()}function c(){v.onStateChange&&v.onStateChange()}function l(){return a}function u(){i++,r||(r=t.subscribe(c),n=SX())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=H_)}function m(){a||(a=!0,u())}function p(){a&&(a=!1,h())}const v={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:l,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return v}var CX=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kX=CX(),NX=()=>typeof navigator<"u"&&navigator.product==="ReactNative",jX=NX(),OX=()=>kX||jX?w.useLayoutEffect:w.useEffect,RX=OX(),$f=Symbol.for("react-redux-context"),Vf=typeof globalThis<"u"?globalThis:{};function DX(){if(!w.createContext)return{};const t=Vf[$f]??(Vf[$f]=new Map);let e=t.get(w.createContext);return e||(e=w.createContext(null),t.set(w.createContext,e)),e}var MX=DX();function LX(t){const{children:e,context:r,serverState:n,store:i}=t,a=w.useMemo(()=>{const c=PX(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),s=w.useMemo(()=>i.getState(),[i]);RX(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,s]);const o=r||MX;return w.createElement(o.Provider,{value:a},e)}var $X=LX,VX=(t,e)=>e,cv=V([VX,tt,A7,jt,SC,li,bG,qt],TG),lv=t=>{var e=t.currentTarget.getBoundingClientRect(),r=e.width/t.currentTarget.offsetWidth,n=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/r),chartY:Math.round((t.clientY-e.top)/n)}},_k=Fr("mouseClick"),Ek=Lc();Ek.startListening({actionCreator:_k,effect:(t,e)=>{var r=t.payload,n=cv(e.getState(),lv(r));n?.activeIndex!=null&&e.dispatch(PK({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var vp=Fr("mouseMove"),Tk=Lc();Tk.startListening({actionCreator:vp,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ky(n,n.tooltip.settings.shared),a=cv(n,lv(r));i==="axis"&&(a?.activeIndex!=null?e.dispatch(xC({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(bC()))}});function FX(t,e){return e instanceof HTMLElement?"HTMLElement <".concat(e.tagName,' class="').concat(e.className,'">'):e===window?"global.window":e}var W_={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Ak=Br({name:"rootProps",initialState:W_,reducers:{updateOptions:(t,e)=>{var r;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(r=e.payload.barGap)!==null&&r!==void 0?r:W_.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),zX=Ak.reducer,{updateOptions:UX}=Ak.actions,Ik=Br({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:_te}=Ik.actions,BX=Ik.reducer,Sk=Fr("keyDown"),Pk=Fr("focus"),uv=Lc();uv.startListening({actionCreator:Sk,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(Gy(i,ns(r))),o=li(r);if(a==="Enter"){var c=sd(r,"axis","hover",String(i.index));e.dispatch(cp({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:c}));return}var l=xK(r),u=l==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,m=s+h*u;if(!(o==null||m>=o.length||m<0)){var p=sd(r,"axis","hover",String(m));e.dispatch(cp({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});uv.startListening({actionCreator:Pk,effect:(t,e)=>{var r=e.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=sd(r,"axis","hover",String(a));e.dispatch(cp({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var Or=Fr("externalEvent"),Ck=Lc();Ck.startListening({actionCreator:Or,effect:(t,e)=>{if(t.payload.handler!=null){var r=e.getState(),n={activeCoordinate:lG(r),activeDataKey:oG(r),activeIndex:xc(r),activeLabel:kC(r),activeTooltipIndex:xc(r),isTooltipActive:uG(r)};t.payload.handler(n,t.payload.reactEvent)}}});var qX=V([io],t=>t.tooltipItemPayloads),HX=V([qX,Kc,(t,e,r)=>e,(t,e,r)=>r],(t,e,r,n)=>{var i=t.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=e(a,r);return s}}}),kk=Fr("touchMove"),Nk=Lc();Nk.startListening({actionCreator:kk,effect:(t,e)=>{var r=t.payload,n=e.getState(),i=Ky(n,n.tooltip.settings.shared);if(i==="axis"){var a=cv(n,lv({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&e.dispatch(xC({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var l=c.getAttribute(s8),u=(s=c.getAttribute(o8))!==null&&s!==void 0?s:void 0,h=HX(e.getState(),l,u);e.dispatch(SK({activeDataKey:u,activeIndex:l,activeCoordinate:h}))}}});var WX=QI({brush:DZ,cartesianAxis:JQ,chartData:FG,graphicalItems:QY,layout:NB,legend:v8,options:DG,polarAxis:WY,polarOptions:BX,referenceElements:UZ,rootProps:zX,tooltip:CK}),KX=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return rB({reducer:WX,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([Ek.middleware,Tk.middleware,uv.middleware,Ck.middleware,Nk.middleware]),devTools:{serialize:{replacer:FX},name:"recharts-".concat(r)}})};function GX(t){var{preloadedState:e,children:r,reduxStoreName:n}=t,i=mr(),a=w.useRef(null);if(i)return r;a.current==null&&(a.current=KX(e,n));var s=Qg;return w.createElement($X,{context:s,store:a.current},r)}function YX(t){var{layout:e,width:r,height:n,margin:i}=t,a=or(),s=mr();return w.useEffect(()=>{s||(a(PB(e)),a(CB({width:r,height:n})),a(SB(i)))},[a,s,e,r,n,i]),null}function ZX(t){var e=or();return w.useEffect(()=>{e(UX(t))},[e,t]),null}var QX=["children"];function XX(t,e){if(t==null)return{};var r,n,i=JX(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function JX(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function fd(){return fd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fd.apply(null,arguments)}var eJ={width:"100%",height:"100%"},tJ=w.forwardRef((t,e)=>{var r=bS(),n=xS(),i=_S();if(!qu(r)||!qu(n))return null;var{children:a,otherAttributes:s,title:o,desc:c}=t,l,u;return typeof s.tabIndex=="number"?l=s.tabIndex:l=i?0:void 0,typeof s.role=="string"?u=s.role:u=i?"application":void 0,w.createElement(lI,fd({},s,{title:o,desc:c,role:u,tabIndex:l,width:r,height:n,style:eJ,ref:e}),a)}),rJ=t=>{var{children:e}=t,r=ae(xh);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return w.createElement(lI,{width:n,height:i,x:s,y:a},e)},K_=w.forwardRef((t,e)=>{var{children:r}=t,n=XX(t,QX),i=mr();return i?w.createElement(rJ,null,r):w.createElement(tJ,fd({ref:e},n),r)});function nJ(){var t=or(),[e,r]=w.useState(null),n=ae(a8);return w.useEffect(()=>{if(e!=null){var i=e.getBoundingClientRect(),a=i.width/e.offsetWidth;rn(a)&&a!==n&&t(kB(a))}},[e,t,n]),r}function G_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function iJ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?G_(Object(r),!0).forEach(function(n){aJ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):G_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function aJ(t,e,r){return(e=sJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sJ(t){var e=oJ(t,"string");return typeof e=="symbol"?e:e+""}function oJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cJ=w.forwardRef((t,e)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:l,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:v,onTouchStart:b,style:g,width:_}=t,T=or(),[E,j]=w.useState(null),[R,D]=w.useState(null);BG();var I=nJ(),A=w.useCallback(W=>{I(W),typeof e=="function"&&e(W),j(W),D(W)},[I,e,j,D]),P=w.useCallback(W=>{T(_k(W)),T(Or({handler:a,reactEvent:W}))},[T,a]),O=w.useCallback(W=>{T(vp(W)),T(Or({handler:l,reactEvent:W}))},[T,l]),N=w.useCallback(W=>{T(bC()),T(Or({handler:u,reactEvent:W}))},[T,u]),C=w.useCallback(W=>{T(vp(W)),T(Or({handler:h,reactEvent:W}))},[T,h]),k=w.useCallback(()=>{T(Pk())},[T]),J=w.useCallback(W=>{T(Sk(W.key))},[T]),oe=w.useCallback(W=>{T(Or({handler:s,reactEvent:W}))},[T,s]),X=w.useCallback(W=>{T(Or({handler:o,reactEvent:W}))},[T,o]),te=w.useCallback(W=>{T(Or({handler:c,reactEvent:W}))},[T,c]),he=w.useCallback(W=>{T(Or({handler:m,reactEvent:W}))},[T,m]),ye=w.useCallback(W=>{T(Or({handler:b,reactEvent:W}))},[T,b]),Be=w.useCallback(W=>{T(kk(W)),T(Or({handler:v,reactEvent:W}))},[T,v]),se=w.useCallback(W=>{T(Or({handler:p,reactEvent:W}))},[T,p]);return w.createElement(MC.Provider,{value:E},w.createElement(LU.Provider,{value:R},w.createElement("div",{className:Le("recharts-wrapper",n),style:iJ({position:"relative",cursor:"default",width:_,height:i},g),onClick:P,onContextMenu:oe,onDoubleClick:X,onFocus:k,onKeyDown:J,onMouseDown:te,onMouseEnter:O,onMouseLeave:N,onMouseMove:C,onMouseUp:he,onTouchEnd:se,onTouchMove:Be,onTouchStart:ye,ref:A},r)))}),lJ=["children","className","width","height","style","compact","title","desc"];function uJ(t,e){if(t==null)return{};var r,n,i=dJ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function dJ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var hJ=w.forwardRef((t,e)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:c,desc:l}=t,u=uJ(t,lJ),h=Ge(u,!1);return o?w.createElement(K_,{otherAttributes:h,title:c,desc:l},r):w.createElement(cJ,{className:n,style:s,width:i,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},w.createElement(K_,{otherAttributes:h,title:c,desc:l,ref:e},w.createElement(qZ,null,r)))}),fJ=["width","height"];function bp(){return bp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},bp.apply(null,arguments)}function mJ(t,e){if(t==null)return{};var r,n,i=pJ(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function pJ(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}var gJ={top:5,right:5,bottom:5,left:5},yJ={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:gJ,reverseStackOrder:!1,syncMethod:"index"},vJ=w.forwardRef(function(e,r){var n,i=Xa(e.categoricalChartProps,yJ),{width:a,height:s}=i,o=mJ(i,fJ);if(!qu(a)||!qu(s))return null;var{chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,categoricalChartProps:m}=e,p={chartName:c,defaultTooltipEventType:l,validateTooltipEventTypes:u,tooltipPayloadSearcher:h,eventEmitter:void 0};return w.createElement(GX,{preloadedState:{options:p},reduxStoreName:(n=m.id)!==null&&n!==void 0?n:c},w.createElement(RZ,{chartData:m.data}),w.createElement(YX,{width:a,height:s,layout:i.layout,margin:i.margin}),w.createElement(ZX,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),w.createElement(hJ,bp({},o,{width:a,height:s,ref:r})))}),bJ=["axis"],Y_=w.forwardRef((t,e)=>w.createElement(vJ,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bJ,tooltipPayloadSearcher:OG,categoricalChartProps:t,ref:e}));function xJ(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})}function wJ(t){const e=typeof t=="string"?new Date(t):t;return e.toLocaleDateString("es-ES",{day:"2-digit",month:"short",year:"2-digit"})+" "+e.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}const _J=({images:t})=>{const[e,r]=w.useState(!1),n=t.map(s=>{let o;const c={excellent:95,good:80,fair:60,poor:30};return s.healthAnalysis?.overallHealth&&c[s.healthAnalysis.overallHealth]?o=c[s.healthAnalysis.overallHealth]:typeof s.healthAnalysis?.confidence=="number"&&(o=s.healthAnalysis.confidence<=1?s.healthAnalysis.confidence*100:s.healthAnalysis.confidence),{id:s.id,date:xJ(s.timestamp),dateTime:wJ(s.timestamp),rawDate:s.timestamp,score:typeof o=="number"?o:null,url:s.url}}).sort((s,o)=>new Date(s.rawDate).getTime()-new Date(o.rawDate).getTime()),i=n.map(s=>({dateTime:s.dateTime,score:s.score})),a=s=>{const{key:o,cx:c,cy:l}=s;return d.jsx("circle",{cx:c,cy:l,r:4,stroke:"#2A7F3E",strokeWidth:2,fill:"#fff"},o)};return d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h3",{className:"text-base font-semibold text-[#2A7F3E]",children:"Evolución de Salud"}),d.jsx(me,{size:"sm",variant:"outline",onClick:()=>r(!0),children:"Ampliar"})]}),d.jsx("div",{className:"w-full h-48",children:d.jsx(v_,{width:"100%",height:"100%",children:d.jsxs(Y_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(mp,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(dd,{dataKey:"dateTime",tick:{fontSize:12,fill:"#888"}}),d.jsx(hd,{domain:[0,100],tick:{fontSize:12,fill:"#888"},width:32}),d.jsx(g_,{contentStyle:{fontSize:13,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(ud,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:6},connectNulls:!1})]})})}),d.jsx("div",{className:"mt-4 overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-10 h-10 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})}),d.jsx(ke,{children:e&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-2",onClick:()=>r(!1),children:d.jsxs(L.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto p-6 relative",onClick:s=>s.stopPropagation(),children:[d.jsx(me,{size:"icon-sm",variant:"ghost",className:"absolute top-2 right-2",onClick:()=>r(!1),children:"×"}),d.jsx("h3",{className:"text-lg font-semibold mb-4 text-[#2A7F3E]",children:"Evolución de Salud (Ampliado)"}),d.jsx("div",{className:"w-full h-72 mb-6",children:d.jsx(v_,{width:"100%",height:"100%",children:d.jsxs(Y_,{data:i,margin:{top:10,right:20,left:0,bottom:0},children:[d.jsx(mp,{strokeDasharray:"3 3",vertical:!1,stroke:"#F0F8F5"}),d.jsx(dd,{dataKey:"dateTime",tick:{fontSize:13,fill:"#888"}}),d.jsx(hd,{domain:[0,100],tick:{fontSize:13,fill:"#888"},width:36}),d.jsx(g_,{contentStyle:{fontSize:14,borderRadius:8},labelFormatter:s=>`Fecha: ${s}`,formatter:s=>`${s}%`}),d.jsx(ud,{type:"monotone",dataKey:"score",stroke:"#2A7F3E",strokeWidth:2,dot:a,activeDot:{r:7},connectNulls:!1})]})})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full text-sm border-separate border-spacing-y-1",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"text-[#666]",children:[d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Fecha"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Imagen"}),d.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Salud"})]})}),d.jsx("tbody",{children:n.map(s=>d.jsxs("tr",{className:"bg-[#F9F9F9] hover:bg-[#F0F8F5] transition-colors",children:[d.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:s.date}),d.jsx("td",{className:"px-2 py-1",children:d.jsx("img",{src:s.url,alt:"miniatura",className:"w-12 h-12 object-cover rounded-md border"})}),d.jsx("td",{className:"px-2 py-1 font-medium text-[#2A7F3E]",children:s.score!==null?`${s.score.toFixed(0)}%`:d.jsx("span",{className:"text-[#bbb]",children:"N/A"})})]},s.id))})]})})]})})})]})},EJ=({plant:t,onAddPhoto:e})=>{const r=w.useMemo(()=>{if(!t.images||t.images.length===0)return[];const a=[...t.images].sort((u,h)=>new Date(u.timestamp).getTime()-new Date(h.timestamp).getTime()),s=[],o=30*24*60*60*1e3;let c=new Date(a[0].timestamp),l=[];return a.forEach((u,h)=>{const m=new Date(u.timestamp);if(m.getTime()-c.getTime()<=o)l.push(u);else{if(l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}c=m,l=[u]}if(h===a.length-1&&l.length>0){const p=l.map(b=>{const g=b.healthAnalysis;if(!g)return;const _={excellent:95,good:80,fair:60,poor:30};if(g.overallHealth&&_[g.overallHealth])return _[g.overallHealth];if(typeof g.confidence=="number")return g.confidence<=1?g.confidence*100:g.confidence}).filter(b=>b!==void 0),v=p.length>0?p.reduce((b,g)=>b+g,0)/p.length:0;s.push({id:`period-${s.length}`,images:[...l],startDate:new Date(l[0].timestamp),endDate:new Date(l[l.length-1].timestamp),avgHealthScore:v,trend:s.length>0?v>s[s.length-1].avgHealthScore?"improving":"declining":"stable",photoCount:l.length})}}),s},[t.images]);function n(a){if(a.length<2)return null;const s=a[a.length-1]-a[0];return s>5?{icon:"⬆️",label:"Mejorando",color:"text-green-600 bg-green-50"}:s<-5?{icon:"⬇️",label:"Declive",color:"text-red-600 bg-red-50"}:{icon:"➡️",label:"Estable",color:"text-gray-600 bg-gray-50"}}if(r.length===0)return d.jsxs(Pr,{className:"mt-6",children:[d.jsx(Gd,{children:d.jsxs(Og,{className:"flex items-center",children:[d.jsx(CN,{className:"w-5 h-5 mr-2 text-primary"}),"Evolución de tu Planta"]})}),d.jsx(ti,{children:d.jsxs("div",{className:"text-center py-8",children:[d.jsx(Yn,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-semibold mb-2",children:"¡Comienza a documentar la evolución!"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:"Agrega más fotos a lo largo del tiempo para ver cómo progresa tu planta."}),d.jsxs(me,{onClick:e,className:"gap-2",children:[d.jsx(Tp,{className:"w-4 h-4"}),"Agregar Primera Foto"]})]})})]});const i=r.map(a=>a.avgHealthScore??0);return n(i),d.jsx(Pr,{className:"mt-6",children:d.jsx(ti,{className:"mt-4 space-y-6",children:d.jsx(_J,{images:t.images||[]})})})},TJ=({isOpen:t,onClose:e,onPhotoAdded:r,plantName:n})=>{const[i,a]=w.useState("choose"),[s,o]=w.useState(null),[c,l]=w.useState(""),[u,h]=w.useState(null),[m,p]=w.useState(!1),v=w.useRef(null),{addToast:b}=Qs(),g=w.useCallback(()=>{a("choose"),o(null),l(""),h(null),p(!1)},[]),_=w.useCallback(()=>{g(),e()},[g,e]),T=w.useCallback(k=>{const J=new FileReader;J.onload=oe=>{const X=oe.target?.result;o(X),a("preview")},J.readAsDataURL(k)},[]),E=w.useCallback(()=>{v.current&&v.current.click()},[]),j=w.useCallback(()=>{E()},[E]),R=w.useCallback(k=>{const J=k.target.files?.[0];if(J){if(!J.type.startsWith("image/")){h("Por favor selecciona un archivo de imagen válido.");return}if(J.size>5*1024*1024){h("La imagen es demasiado grande. Máximo 5MB.");return}T(J)}},[T]),D=w.useCallback(async()=>{if(s)try{a("uploading"),p(!0),await r(s,c.trim()||void 0),a("success"),p(!1),b({type:"success",title:"Foto agregada exitosamente",message:`Nueva imagen añadida a ${n}`}),setTimeout(()=>{_()},1500)}catch(k){h(k instanceof Error?k.message:"Error al subir la imagen"),a("error"),p(!1)}},[s,c,r,n,b,_]),I=()=>(console.log("[AddPhotoModal] Renderizando botón Tomar Foto"),console.log("[AddPhotoModal] Renderizando botón Elegir de Galería"),d.jsxs(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"text-center space-y-6",children:[d.jsxs("div",{children:[d.jsx(Yn,{className:"w-16 h-16 text-primary mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Agregar Nueva Foto"}),d.jsxs("p",{className:"text-muted-foreground",children:["Documenta el progreso de ",d.jsx("span",{className:"font-medium",children:n})]})]}),d.jsxs("div",{className:"grid gap-4",children:[d.jsxs(me,{variant:"primary",size:"lg",onClick:j,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(Yn,{className:"w-6 h-6"}),"Tomar Foto"]}),d.jsxs(me,{variant:"secondary",size:"lg",onClick:E,className:"h-16 gap-3 text-primary-foreground",children:[d.jsx(mE,{className:"w-6 h-6"}),"Elegir de Galería"]})]}),d.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:R,className:"hidden","data-testid":"file-input"})]})),A=()=>d.jsxs(L.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Vista Previa"}),d.jsxs("p",{className:"text-muted-foreground",children:["Revisa la imagen antes de agregar a ",n]})]}),s&&d.jsxs("div",{className:"space-y-4 pb-8 sm:pb-0",children:[d.jsx("div",{className:"aspect-video max-h-80 mx-auto rounded-lg overflow-hidden border",children:d.jsx("img",{src:s,alt:"Vista previa",className:"w-full h-full object-cover"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium",children:"Nota (opcional)"}),d.jsx("textarea",{value:c,onChange:k=>l(k.target.value),placeholder:"Agrega una nota sobre esta foto...",className:"w-full p-3 border border-neutral-200 rounded-lg resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,maxLength:200}),d.jsxs("div",{className:"text-xs text-muted-foreground text-right",children:[c.length,"/200"]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),className:"flex-1",children:"Cambiar Imagen"}),d.jsxs(me,{variant:"primary",onClick:D,className:"flex-1 gap-2",children:[d.jsx(er,{className:"w-4 h-4"}),"Analizar y Guardar"]})]})]})]}),P=()=>d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center space-y-6 py-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx(wa,{className:"w-16 h-16 text-primary mx-auto animate-spin"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:m?"Analizando imagen...":"Subiendo foto..."}),d.jsx("p",{className:"text-muted-foreground",children:m?"La IA está evaluando la salud de tu planta":"Guardando la nueva imagen en tu jardín"})]})]}),d.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2",children:d.jsx("div",{className:"bg-primary h-2 rounded-full animate-pulse",style:{width:"70%"}})})]}),O=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Si,{className:"w-16 h-16 text-success-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"¡Foto agregada!"}),d.jsxs("p",{className:"text-muted-foreground",children:["La nueva imagen ha sido añadida al progreso de ",n]})]})]}),N=()=>d.jsxs(L.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center space-y-6 py-8",children:[d.jsx(Jr,{className:"w-16 h-16 text-error-500 mx-auto"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error al subir"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:u||"Hubo un problema al procesar la imagen"}),d.jsxs("div",{className:"flex gap-3 justify-center",children:[d.jsx(me,{variant:"secondary",onClick:()=>a("choose"),children:"Intentar de Nuevo"}),d.jsx(me,{variant:"primary",onClick:_,children:"Cerrar"})]})]})]}),C=()=>{switch(i){case"choose":return I();case"preview":return A();case"uploading":return P();case"success":return O();case"error":return N();default:return I()}};return d.jsx(ke,{children:t&&d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:k=>{k.target===k.currentTarget&&i!=="uploading"&&_()},children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md",children:d.jsx(Pr,{children:d.jsxs(ti,{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Ap,{className:"w-5 h-5 text-primary"}),d.jsx("span",{className:"font-medium text-sm text-muted-foreground",children:"NUEVA FOTO"})]}),i!=="uploading"&&d.jsx(me,{variant:"ghost",size:"icon-sm",onClick:_,children:d.jsx(Wi,{className:"w-4 h-4"})})]}),C()]})})})})})},AJ=({plant:t})=>{const{careProfile:e,healthScore:r,lastWatered:n,dateAdded:i}=t,a=t.images?.[0]?.healthAnalysis,s=n?Math.floor((Date.now()-new Date(n).getTime())/(1e3*60*60*24)):null,o=Math.floor((Date.now()-new Date(i).getTime())/(1e3*60*60*24)),l=r>=85?{text:"Excelente",color:"text-green-500",icon:Si,emoji:"🌟"}:r>=70?{text:"Buena",color:"text-green-400",icon:Si,emoji:"✅"}:r>=50?{text:"Regular",color:"text-yellow-500",icon:uE,emoji:"⚠️"}:{text:"Necesita atención",color:"text-red-500",icon:Tn,emoji:"🆘"},h=(()=>{if(!s||!e?.wateringFrequency)return{text:"Sin datos",color:"text-gray-500",urgent:!1};const v=s>=e.wateringFrequency;return s>e.wateringFrequency+2?{text:"Riego urgente",color:"text-red-500",urgent:!0}:v?{text:"Necesita riego",color:"text-yellow-500",urgent:!0}:{text:"Bien hidratada",color:"text-green-500",urgent:!1}})(),m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{staggerChildren:.1}}},p={hidden:{opacity:0,y:10},visible:{opacity:1,y:0}};return d.jsx(L.div,{variants:m,initial:"hidden",animate:"visible",children:d.jsxs(Pr,{variant:"glass",className:"content-spacing-sm element-spacing",children:[t.description&&d.jsx("div",{className:"mb-4",children:d.jsx("p",{className:"text-base text-neutral-700 dark:text-neutral-200 leading-relaxed",children:t.description})}),d.jsx(L.div,{variants:p,className:"w-full mb-3",children:d.jsxs("div",{className:"w-full flex items-center justify-between bg-green-100 dark:bg-green-900/30 rounded-lg px-4 py-2 mb-2",children:[d.jsxs("span",{className:"flex items-center gap-2 text-green-700 text-base font-bold",children:[d.jsx(Si,{className:"w-5 h-5"}),r,"% ",l.text]}),d.jsxs("span",{className:"flex items-center gap-1 text-contrast-soft text-sm align-baseline",children:[d.jsx(lu,{className:"w-4 h-4"}),"Día ",o]})]})}),d.jsxs(L.div,{variants:p,className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:Oe("flex items-center space-x-3 p-3 rounded-lg",h.urgent?"bg-yellow-50 dark:bg-yellow-900/20":"bg-green-50 dark:bg-green-900/20"),children:[d.jsx(Ec,{className:Oe("w-5 h-5",h.color)}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Riego"}),d.jsx("p",{className:Oe("font-semibold text-sm",h.color),children:h.text}),s!==null&&d.jsxs("p",{className:"text-xs text-contrast-soft",children:["Hace ",s," día",s!==1?"s":""]})]})]}),d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[d.jsx(_a,{className:"w-5 h-5 text-blue-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Luz"}),d.jsx("p",{className:"font-semibold text-sm text-blue-600 dark:text-blue-400",children:e?.sunlightRequirement||"No especificado"}),t.lightRequirements&&d.jsx("p",{className:"text-xs text-contrast-soft capitalize",children:t.lightRequirements.replace("_"," ")})]})]}),t.plantEnvironment&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-purple-50 dark:bg-purple-900/20",children:[d.jsx(wE,{className:"w-5 h-5 text-purple-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Ambiente"}),d.jsx("p",{className:"font-semibold text-sm text-purple-600 dark:text-purple-400 capitalize",children:t.plantEnvironment==="ambos"?"Interior/Exterior":t.plantEnvironment})]})]}),e?.temperatureRange&&d.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-orange-50 dark:bg-orange-900/20",children:[d.jsx(_E,{className:"w-5 h-5 text-orange-500"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-contrast-soft",children:"Temperatura"}),d.jsxs("p",{className:"font-semibold text-sm text-orange-600 dark:text-orange-400",children:[e.temperatureRange.min,"°-",e.temperatureRange.max,"°C"]})]})]})]}),a?.issues&&a.issues.length>0&&d.jsx(L.div,{variants:p,className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Tn,{className:"w-5 h-5 text-red-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-red-700 dark:text-red-300 text-sm mb-1",children:[a.issues.length," problema",a.issues.length!==1?"s":""," detectado",a.issues.length!==1?"s":""]}),d.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400",children:[a.issues[0].description,a.issues.length>1&&` y ${a.issues.length-1} más...`]})]})]})}),d.jsx("br",{}),t.personality?.communicationStyle&&d.jsx(L.div,{variants:p,className:"p-4 bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg border border-green-200 dark:border-green-800",children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx(Xo,{className:"w-5 h-5 text-green-500 mt-0.5"}),d.jsxs("div",{children:[d.jsxs("p",{className:"font-semibold text-green-700 dark:text-green-300 text-sm mb-1",children:["🤖 Personalidad: ",t.personality.communicationStyle]}),t.personality.catchphrases&&t.personality.catchphrases.length>0&&d.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 italic",children:['"',t.personality.catchphrases[0],'"']})]})]})})]})})},IJ=({plant:t,onAddPhoto:e})=>{const[r,n]=w.useState("evolution"),i=t.images?.[0]?.healthAnalysis,a=i?.issues&&i.issues.length>0,s=t.images&&t.images.length>1,o=[{id:"evolution",title:"Evolución y Progreso",icon:d.jsx(kN,{className:"w-5 h-5"}),badge:s?`${t.images?.length||0} fotos`:"Nueva",component:d.jsx(EJ,{plant:t,onAddPhoto:e}),priority:1},{id:"health",title:"Análisis de Salud",icon:d.jsx(NN,{className:"w-5 h-5"}),badge:a?"Atención":"Saludable",component:d.jsx(xU,{analysis:i}),priority:a?1:3},{id:"care",title:"Perfil de Cuidados",icon:d.jsx(jN,{className:"w-5 h-5"}),badge:t.careProfile?"Completo":"Pendiente",component:d.jsx(yU,{plant:t}),priority:t.careProfile?2:1},...t.funFacts&&t.funFacts.length>0?[{id:"funfacts",title:"Datos Curiosos",icon:d.jsx(er,{className:"w-5 h-5"}),component:d.jsx(vU,{species:t.species,funFacts:t.funFacts}),priority:4}]:[]].filter(c=>c.id==="health"?!!i:!0).sort((c,l)=>c.priority-l.priority);return d.jsx("div",{className:"flex flex-col gap-y-1",children:o.map(c=>{const l=r===c.id,u=c.id==="health";return c.id==="care"?d.jsxs(Pr,{variant:"default",radius:"default",className:Oe("border border-[#E5E5E5] rounded-[8px] transition-all duration-200","bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none","bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),d.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16,transition:"transform .2s"},children:d.jsx(n0,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:l&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,d.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id):d.jsxs(Pr,{variant:"default",radius:"default",className:Oe("border border-[#E0E0E0] rounded-[8px] transition-all duration-200",l&&u?"bg-[#FAFAFA]":"bg-white","p-0 mb-4"),children:[d.jsxs(L.button,{onClick:()=>n(l?"":c.id),className:Oe("w-full flex items-center justify-between px-4 py-3 min-h-12 text-left focus:outline-none",l&&u?"bg-[#FAFAFA]":"bg-white","rounded-t-[8px]"),style:{position:l?"sticky":"static",top:0,zIndex:2},whileTap:{scale:.98},children:[d.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[d.jsx("span",{className:"flex items-center justify-center mr-2",style:{width:20,height:20},children:c.icon}),d.jsx("span",{className:"font-semibold text-[16px] truncate text-neutral-900 dark:text-neutral-100",children:c.title})]}),u&&d.jsx("span",{className:"ml-2 px-[6px] py-[2px] text-xs font-medium rounded-[4px] bg-[#E0F2E9] text-[#2A7F3E] align-middle",style:{lineHeight:"1.2"},children:c.badge}),d.jsx(L.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"flex-shrink-0 ml-2 align-middle",style:{display:"flex",alignItems:"center",marginRight:16},children:d.jsx(n0,{className:"w-6 h-6 text-neutral-600 dark:text-neutral-400"})})]}),d.jsx(ke,{children:l&&d.jsx(L.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:d.jsxs("div",{className:"px-4 pb-3 pt-1 max-h-[60vh] overflow-y-auto",style:{lineHeight:"1.4"},children:[c.component,u&&d.jsx("div",{style:{paddingBottom:8}})]})})})]},c.id)})})},Z_=()=>d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"relative h-96 w-full overflow-hidden bg-gradient-to-br from-muted/50 to-muted",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 via-background/20 to-transparent"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe-top",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(pe,{className:"h-10 w-10 rounded-full"}),d.jsx(pe,{className:"h-10 w-10 rounded-full"})]})]})}),d.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-6 pb-safe-bottom",children:d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-8 w-64"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.jsx(pe,{className:"h-8 w-24 rounded-full"}),d.jsx(pe,{className:"h-8 w-32 rounded-full"}),d.jsx(pe,{className:"h-8 w-20 rounded-full"})]})]})})]}),d.jsxs("div",{className:"p-4 space-y-6 pb-20",children:[d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-6 flex items-center",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-48"}),d.jsx(pe,{className:"h-4 w-64"})]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx(pe,{className:"h-4 w-full"}),d.jsx(pe,{className:"h-4 w-5/6"}),d.jsx(pe,{className:"h-4 w-4/5"}),d.jsx(pe,{className:"h-4 w-3/4"})]}),d.jsxs("div",{className:"mt-8 space-y-4",children:[d.jsxs("div",{className:"flex items-center mb-4",children:[d.jsx(pe,{className:"h-12 w-12 rounded-full mr-4"}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(pe,{className:"h-6 w-32"}),d.jsx(pe,{className:"h-4 w-56"})]})]}),[1,2,3].map(t=>d.jsxs("div",{className:"flex items-start bg-muted/20 rounded-xl p-4",children:[d.jsx(pe,{className:"h-5 w-5 rounded-full mr-4 mt-1"}),d.jsx(pe,{className:"h-4 w-full"})]},t))]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-48"})]}),d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-6",children:[d.jsx(pe,{className:"h-12 w-12 mx-auto mb-3"}),d.jsx(pe,{className:"h-6 w-32 mx-auto mb-2"}),d.jsx(pe,{className:"h-4 w-48 mx-auto"})]})]}),d.jsxs("div",{className:"bg-background p-6 rounded-2xl shadow-lg border border-border/50",children:[d.jsxs("div",{className:"mb-4 flex items-center",children:[d.jsx(pe,{className:"h-6 w-6 mr-3"}),d.jsx(pe,{className:"h-6 w-40"})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(t=>d.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[d.jsx(pe,{className:"h-8 w-8 mb-2"}),d.jsx(pe,{className:"h-4 w-16 mb-1"}),d.jsx(pe,{className:"h-5 w-24"})]},t))})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pe,{className:"h-5 w-5 mr-2"}),d.jsx(pe,{className:"h-6 w-32"})]}),d.jsx(pe,{className:"h-4 w-16"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[1,2,3,4,5,6].map(t=>d.jsx(pe,{className:"aspect-square rounded-xl"},t))})]})]}),d.jsxs("div",{className:"fixed bottom-4 right-4 z-40 flex flex-col-reverse gap-3",children:[[1,2,3].map(t=>d.jsx(pe,{className:"h-14 w-14 rounded-full"},t)),d.jsx(pe,{className:"h-16 w-16 rounded-full"})]})]}),SJ=()=>{const{plantId:t}=Ep(),e=sr(),{plant:r,loading:n,error:i}=Dg(t),{addPlantImage:a}=uU(),[s,o]=w.useState(!1),c=async(l,u)=>{if(!t)throw new Error("Plant ID is required");return new Promise((h,m)=>{a({plantId:t,imageDataUrl:l,note:u},{onSuccess:()=>h(),onError:p=>m(p)})})};return n?d.jsx(Z_,{}):i?d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold text-destructive",children:"Ocurrió un Error"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:i}),d.jsx(me,{onClick:()=>window.location.reload(),className:"mt-4",children:"Intentar de nuevo"})]})}):r?d.jsx(w.Suspense,{fallback:d.jsx(Z_,{}),children:d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[d.jsx(gU,{plant:r}),d.jsxs("main",{className:"p-3 sm:p-4 space-y-3 sm:space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.2},children:d.jsx(AJ,{plant:r})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15,duration:.2},children:d.jsx(IJ,{plant:r,onAddPhoto:()=>o(!0)})}),d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.2},children:d.jsx(dU,{images:r.images})})]}),d.jsxs(L.div,{className:"fixed bottom-24 right-4 z-40 flex flex-col-reverse gap-3",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.25,duration:.2},children:[d.jsxs(L.button,{onClick:()=>o(!0),className:"bg-primary hover:bg-primary/90 text-primary-foreground p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Agregar nueva foto",children:[d.jsx(Yn,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Agregar foto"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Agregar foto"})]}),d.jsxs(L.button,{onClick:()=>e(vt.toPlantChat(r.id)),className:"bg-blue-500 hover:bg-blue-600 text-white p-2.5 sm:p-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 group flex items-center",whileHover:{scale:1.1},whileTap:{scale:.95},title:"Chat con la planta",children:[d.jsx(Tc,{className:"w-4 h-4 sm:w-5 sm:h-5"}),d.jsx("span",{className:"ml-2 text-xs font-medium block sm:hidden",children:"Chat"}),d.jsx("span",{className:"absolute right-full mr-3 top-1/2 -translate-y-1/2 tooltip-contrast text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap shadow-lg hidden sm:block",children:"Chat"})]})]}),d.jsx(TJ,{isOpen:s,onClose:()=>o(!1),onPhotoAdded:c,plantName:r.nickname||r.name})]})}):d.jsx("main",{className:"flex flex-1 flex-col items-center justify-center p-4 text-center h-screen",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[d.jsx(Jr,{className:"w-16 h-16 text-muted-foreground mx-auto"}),d.jsx("h1",{className:"text-2xl font-bold",children:"Planta no encontrada"}),d.jsx("p",{className:"text-muted-foreground max-w-md",children:"No se pudo encontrar la información de la planta solicitada."}),d.jsx(me,{onClick:()=>e(vt.toDashboard()),className:"mt-4",children:"Volver al inicio"})]})})},PJ=({videoRef:t,canvasRef:e})=>{const[r,n]=w.useState(!1),[i,a]=w.useState(null),[s,o]=w.useState("environment"),[c,l]=w.useState(null),u=w.useRef(null),h=w.useCallback(async()=>{try{u.current&&u.current.getTracks().forEach(_=>_.stop()),l(null);const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:s,width:{ideal:1920},height:{ideal:1080},aspectRatio:16/9}});t.current&&(t.current.srcObject=g,u.current=g)}catch(g){console.error("Error accessing camera:",g),g instanceof Error?g.name==="NotAllowedError"||g.message.includes("Permission dismissed")?l("Permiso de cámara denegado. Por favor, actívalo en los ajustes de tu navegador."):l("No se pudo acceder a la cámara. Revisa los permisos y el dispositivo."):l("Ocurrió un error inesperado al acceder a la cámara.")}},[s,t]);w.useEffect(()=>(h(),()=>{u.current&&u.current.getTracks().forEach(g=>g.stop())}),[h]);const m=w.useCallback(()=>{if(!t.current||!e.current)return;const g=t.current,_=e.current,T=_.getContext("2d");if(!T)return;_.width=g.videoWidth,_.height=g.videoHeight,T.drawImage(g,0,0,g.videoWidth,g.videoHeight);const E=_.toDataURL("image/jpeg",.9);a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop()),"vibrate"in navigator&&navigator.vibrate(50)},[t,e]),p=w.useCallback(()=>{a(null),n(!1),h()},[h]);return{isCapturing:r,capturedImage:i,cameraError:c,captureImage:m,retakePhoto:p,switchCamera:()=>{o(g=>g==="user"?"environment":"user")},startCamera:h,selectFromGallery:g=>{if(g&&g.type.startsWith("image/")){const _=new FileReader;_.onload=T=>{const E=T.target?.result;a(E),n(!0),u.current&&u.current.getTracks().forEach(j=>j.stop())},_.readAsDataURL(g)}}}},CJ=({error:t,onRetry:e})=>{const r=sr();return d.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center p-6",children:d.jsx("div",{className:"bg-gray-900 rounded-2xl p-6 max-w-sm w-full mx-4",children:d.jsxs("div",{className:"flex flex-col items-center text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:d.jsx(Jr,{size:32,className:"text-red-400"})}),d.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"Camera Access Required"}),d.jsx("p",{className:"text-gray-300 text-sm mb-6 leading-relaxed",children:t}),d.jsxs("div",{className:"space-y-3 w-full",children:[d.jsxs(me,{onClick:e,children:[d.jsx(Oi,{size:18,className:"mr-2"}),d.jsx("span",{children:"Try Again"})]}),d.jsx(me,{onClick:()=>r(vt.toDashboard()),variant:"secondary",children:"Go Back"})]}),d.jsx("div",{className:"mt-4 p-3 bg-gray-800 rounded-lg",children:d.jsxs("p",{className:"text-gray-400 text-xs",children:[d.jsx("strong",{children:"How to enable camera:"}),d.jsx("br",{}),"1. Click the camera icon in your browser's address bar",d.jsx("br",{}),'2. Select "Allow" for camera access',d.jsx("br",{}),'3. Refresh the page or tap "Try Again"']})})]})})})},kJ=({image:t,isAnalyzing:e,onRetake:r,onAnalyze:n})=>d.jsxs(d.Fragment,{children:[d.jsx(L.img,{src:t,alt:"Captured plant",className:"absolute inset-0 w-full h-full object-cover z-10",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[d.jsx(me,{onClick:r,variant:"secondary",disabled:e,children:"Retake"}),d.jsx(me,{onClick:n,disabled:e,children:e?d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d.jsx("span",{children:"Analyzing..."})]}):"Add Plant"})]}),e&&d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"AI is identifying your plant and creating a care profile..."})]})]}),NJ=({videoRef:t,canvasRef:e,flashEnabled:r,onCapture:n,onSwitchCamera:i,onToggleFlash:a,onSelectFromGallery:s})=>{const o=sr();return d.jsxs(d.Fragment,{children:[d.jsx(L.video,{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5}}),d.jsx("canvas",{ref:e,className:"hidden"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 p-4 safe-area-top z-20",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx(me,{onClick:()=>o(vt.toDashboard()),variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(Wi,{size:20})}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx(me,{onClick:a,variant:"ghost",size:"icon",className:`rounded-full ${r?"bg-yellow-500 text-black hover:bg-yellow-600":"bg-black/50"}`,children:r?d.jsx(er,{size:20}):d.jsx(ON,{size:20})}),d.jsx(me,{onClick:i,variant:"ghost",size:"icon",className:"rounded-full bg-black/50",children:d.jsx(RN,{size:20})})]})]})}),d.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-8 safe-area-bottom z-20",children:[d.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[d.jsx(me,{onClick:s,size:"icon",variant:"ghost",className:"w-14 h-14 rounded-full bg-black/50",children:d.jsx(Ap,{size:24})}),d.jsx(L.button,{onClick:n,className:"w-20 h-20 rounded-full bg-white border-4 border-gray-300 flex items-center justify-center ios-button",whileHover:{scale:1.05},whileTap:{scale:.95},children:d.jsx("div",{className:"w-16 h-16 rounded-full bg-white flex items-center justify-center",children:d.jsx(Yn,{size:24,className:"text-gray-600"})})}),d.jsx("div",{className:"w-14 h-14"})]}),d.jsx("p",{className:"text-center text-white mt-4 text-sm",children:"Position your plant in the frame and tap to capture, or select from gallery"})]}),d.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:d.jsx("div",{className:"w-64 h-64 border-2 border-white/50 rounded-2xl"})})]})},jJ=()=>{const t=sr(),{createPlant:e,isCreatingPlant:r}=Kd(),n=w.useRef(null),i=w.useRef(null),{isCapturing:a,capturedImage:s,cameraError:o,captureImage:c,retakePhoto:l,switchCamera:u,startCamera:h,selectFromGallery:m}=PJ({videoRef:n,canvasRef:i}),[p,v]=w.useState(!1),b=w.useRef(null),g=()=>{if(!s)return;const E="Interior",j=new Promise((R,D)=>{e({imageDataUrl:s,location:E},{onSuccess:I=>{I?.id?t(vt.toPlantDetail(I.id)):t(vt.toDashboard()),R(I)},onError:I=>{D(I)}})});uA.promise(j,{loading:"Analizando imagen con IA...",success:R=>`¡Planta "${R.name}" creada con éxito!`,error:R=>`Error: ${R.message}`})},_=()=>v(E=>!E),T=E=>{const j=E.target.files?.[0];j&&m(j)};return d.jsxs("div",{className:"fixed inset-0 bg-black z-50",children:[d.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:T,className:"hidden",id:"gallery-input"}),d.jsx(ke,{mode:"wait",children:o?d.jsx(CJ,{error:o,onRetry:h},"error"):a?d.jsx(kJ,{image:s,isAnalyzing:r,onRetake:l,onAnalyze:g},"preview"):d.jsx(NJ,{videoRef:n,canvasRef:i,flashEnabled:p,onCapture:c,onSwitchCamera:u,onToggleFlash:_,onSelectFromGallery:()=>b.current?.click()},"capture")})]})},OJ=()=>{const{plantId:t}=Ep(),e=sr(),{user:r}=Nn(),n=Kn(l=>l.getPlantById(t||"")),i=Kn(l=>l.addChatMessage),a=Kn(l=>l.operationStates.chat.isLoading),s=w.useMemo(()=>{if(!n||!n.chatHistory||n.chatHistory.length===0)return!1;const l=n.chatHistory[n.chatHistory.length-1];return a&&l.sender==="user"},[n,a]);return{plant:n,isTyping:s,handleSendMessage:async l=>{if(!(!t||!r||!l.trim()))try{await i(t,l.trim(),r.id)}catch(u){console.error("Failed to send message:",u)}},handleGoBack:()=>{e(`/plant/${t}`)},currentUser:r}},RJ=({plant:t})=>{const e=sr(),r=()=>{const n=t.healthScore/100,i=t.lastWatered?new Date(t.lastWatered).getTime():0,a=i?Math.max(0,1-(Date.now()-i)/(t.careProfile.wateringFrequency*24*60*60*1e3)):0,s=n*.6+a*.4;return s>.8?"radiante":s>.6?"feliz":s>.4?"estable":"necesitada de atención"};return d.jsx("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:d.jsxs("div",{className:"flex items-center gap-2 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>e(vt.toPlantDetail(t.id)),className:"btn btn-ghost btn-circle",children:d.jsx(Ip,{size:20})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h1",{className:"font-bold text-foreground truncate",children:t.nickname||t.name}),d.jsxs("p",{className:"text-xs text-neutral-600 dark:text-neutral-400 capitalize",children:["Se siente ",r()]})]}),d.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-green-600 dark:text-green-400",children:[d.jsx(hE,{className:"w-4 h-4"}),d.jsxs("span",{children:[t.healthScore,"%"]})]})]})})};var DJ={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},MJ=function(e,r,n){var i,a=DJ[e];return typeof a=="string"?i=a:r===1?i=a.one:i=a.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"en "+i:"hace "+i:i},LJ={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},$J={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},VJ={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},FJ={date:Ps({formats:LJ,defaultWidth:"full"}),time:Ps({formats:$J,defaultWidth:"full"}),dateTime:Ps({formats:VJ,defaultWidth:"full"})},zJ={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},UJ={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},BJ=function(e,r,n,i){return r.getUTCHours()!==1?UJ[e]:zJ[e]},qJ={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},HJ={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},WJ={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},KJ={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},GJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},YJ={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},ZJ=function(e,r){var n=Number(e);return n+"º"},QJ={ordinalNumber:ZJ,era:dn({values:qJ,defaultWidth:"wide"}),quarter:dn({values:HJ,defaultWidth:"wide",argumentCallback:function(e){return Number(e)-1}}),month:dn({values:WJ,defaultWidth:"wide"}),day:dn({values:KJ,defaultWidth:"wide"}),dayPeriod:dn({values:GJ,defaultWidth:"wide",formattingValues:YJ,defaultFormattingWidth:"wide"})},XJ=/^(\d+)(º)?/i,JJ=/\d+/i,eee={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},tee={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},ree={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},nee={any:[/1/i,/2/i,/3/i,/4/i]},iee={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},aee={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},see={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},oee={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},cee={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},lee={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},uee={ordinalNumber:JA({matchPattern:XJ,parsePattern:JJ,valueCallback:function(e){return parseInt(e,10)}}),era:hn({matchPatterns:eee,defaultMatchWidth:"wide",parsePatterns:tee,defaultParseWidth:"any"}),quarter:hn({matchPatterns:ree,defaultMatchWidth:"wide",parsePatterns:nee,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:hn({matchPatterns:iee,defaultMatchWidth:"wide",parsePatterns:aee,defaultParseWidth:"any"}),day:hn({matchPatterns:see,defaultMatchWidth:"wide",parsePatterns:oee,defaultParseWidth:"any"}),dayPeriod:hn({matchPatterns:cee,defaultMatchWidth:"any",parsePatterns:lee,defaultParseWidth:"any"})},jk={code:"es",formatDistance:MJ,formatLong:FJ,formatRelative:BJ,localize:QJ,match:uee,options:{weekStartsOn:1,firstWeekContainsDate:1}};const dee=t=>{switch(t){case"happy":case"excited":return"😊";case"grateful":return"🥰";case"worried":return"😟";case"sad":return"😢";default:return"🌱"}},hee=({message:t})=>{const e=t.sender==="user",r=n=>{Bd.success("¡Gracias por tu feedback!",n?"Nos alegra que la respuesta te haya sido útil.":"Trabajaremos para mejorar las respuestas.")};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2",e?"justify-end":"justify-start"),children:[!e&&d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:dee(t.emotion)}),d.jsxs("div",{className:Oe("max-w-xs rounded-2xl px-4 py-2 sm:max-w-sm md:max-w-md shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm":"rounded-bl-lg bg-contrast-surface text-contrast-medium border border-contrast","rounded-[12px]"),children:[d.jsx("p",{className:"text-sm",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((n,i)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[n.type==="warning"&&"⚠️ ",n.type==="tip"&&"💡 ",n.type==="recommendation"&&"🌱 ",n.type==="observation"&&"🔎 ",n.title]}),d.jsx("div",{children:n.description}),n.affectedPlants&&n.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",n.affectedPlants.join(", ")]})]},i))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((n,i)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:n.action}),n.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",n.priority]}),n.plantIds&&n.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",n.plantIds.join(", ")]})]},i))})]}),d.jsx("p",{className:Oe("mt-1 text-xs",e?"text-white/80":"text-contrast-soft","text-[#888] text-[12px]"),children:tI(new Date(t.timestamp),{addSuffix:!0,locale:jk})}),!e&&d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsx("button",{"aria-label":"Respuesta útil",className:"text-green-600 hover:text-green-800 text-lg focus:outline-none",onClick:()=>r(!0),children:"👍"}),d.jsx("button",{"aria-label":"Respuesta no útil",className:"text-red-500 hover:text-red-700 text-lg focus:outline-none",onClick:()=>r(!1),children:"👎"})]})]})]})},fee=({messages:t})=>d.jsx("div",{className:"space-y-4",children:t.map(e=>d.jsx(hee,{message:e},e.id))}),mee=["¿Cómo te sientes hoy?","¿Necesitas agua?","Cuéntame un dato curioso sobre ti"],pee=({onSendMessage:t,isTyping:e})=>{const[r,n]=w.useState(""),i=w.useRef(null),a=()=>{const o=i.current?.value.trim();o&&(t(o),i.current&&(i.current.value=""))},s=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),a())};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Yd,{type:"text",ref:i,onKeyDown:s,placeholder:"Escribe un mensaje...",className:"pr-12",disabled:e}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(TE,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:a,disabled:!r.trim()||e,size:"icon",children:d.jsx(AE,{size:20})})]}),d.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:mee.map(o=>d.jsx(me,{onClick:()=>n(o),disabled:e,variant:"secondary",size:"sm",children:o},o))})]})})},Ok=()=>{const t={initial:{y:0},animate:{y:[0,-4,0],transition:{duration:1,repeat:1/0,ease:"easeInOut"}}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},className:"flex items-end gap-2",children:[d.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-muted text-xl",children:"🌱"}),d.jsxs("div",{className:"flex items-center gap-1 rounded-2xl rounded-bl-lg bg-muted px-4 py-3",children:[d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.2s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"}),d.jsx(L.div,{variants:t,animate:"animate",style:{transitionDelay:"0.4s"},className:"h-2 w-2 rounded-full bg-muted-foreground/50"})]})]})},gee=({plantName:t})=>d.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center text-center p-8",children:[d.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-primary/10 mb-4",children:d.jsx(er,{className:"h-8 w-8 text-primary"})}),d.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Inicia una conversación"}),d.jsxs("p",{className:"text-muted-foreground max-w-xs",children:[t," está esperando para charlar. ¡Pregúntale sobre sus cuidados o simplemente saluda!"]})]}),yee=()=>{const{plantId:t}=Ep(),e=sr(),{loading:r,error:n}=Dg(t),{plant:i,isTyping:a,handleSendMessage:s}=OJ(),o=w.useRef(null);return w.useEffect(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[i?.chatHistory,a]),r?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(wa,{className:"w-12 h-12 animate-spin text-green-500"}),d.jsx("p",{className:"mt-4 text-lg",children:"Cargando chat..."})]}):n?d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-red-500",children:[d.jsxs("p",{className:"mb-4",children:["Error: ",n]}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]}):i?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(RJ,{plant:i}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsx(ke,{children:i.chatHistory.length===0?d.jsx(gee,{plantName:i.nickname||i.name}):d.jsx(fee,{messages:i.chatHistory,plantNickname:i.nickname||i.name})}),a&&d.jsx(Ok,{}),d.jsx("div",{ref:o})]}),d.jsx(pee,{onSendMessage:s,isTyping:a})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx("p",{className:"mb-4",children:"Planta no encontrada."}),d.jsx("button",{onClick:()=>e(-1),className:"btn btn-primary",children:"Volver"})]})};class vee{constructor(e,r){yr(this,"supabase");yr(this,"cache");this.supabase=e,this.cache=r}async sendMessage(e,r,n){try{const{data:{session:i},error:a}=await this.supabase.auth.getSession();if(a||!i?.access_token)throw console.error("User session not available:",a),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:s,error:o}=await this.supabase.functions.invoke("garden-ai-chat",{body:{message:e,sessionId:r,userId:n},headers:{Authorization:`Bearer ${i.access_token}`}});if(o)throw new Error(`Garden AI service error: ${o.message}`);if(!s)throw new Error("No data received from garden AI service");return s}catch(i){throw console.error("Error in garden chat service:",i),i}}async sendMessageToGardenAI(e,r,n){try{const i=await this.buildGardenContext(r),a=n.map(v=>({role:v.sender==="user"?"user":"assistant",content:v.content})),s="amigable, motivador, experto, cálido, y con un toque de humor ligero",{data:{session:o},error:c}=await this.supabase.auth.getSession();if(c||!o?.access_token)throw console.error("User session not available:",c),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:l,error:u}=await this.supabase.functions.invoke("garden-ai-chat",{body:{userMessage:e,gardenContext:i,conversationHistory:a,tonePersona:s},headers:{Authorization:`Bearer ${o.access_token}`}});if(u)throw new Error(`Garden AI service error: ${u.message}`);if(!l)throw new Error("No data received from garden AI service");const h=typeof l=="string"?JSON.parse(l):l,m=(h.content||"").toLowerCase();return(!h.content||m.includes("no sé")||m.includes("no tengo información")||m.includes("no puedo ayudarte")||m.length<30)&&Bd.warning("Respuesta genérica","La respuesta de la IA fue muy genérica o poco útil. Intenta preguntar de otra forma o proporciona más detalles."),{content:h.content||"Lo siento, no pude procesar tu mensaje.",insights:h.insights||[],suggestedActions:h.suggestedActions||[]}}catch(i){throw i}}async verifyFunctionAvailability(){try{const e={userMessage:"ping",gardenContext:{totalPlants:0,plantsData:[],averageHealthScore:0,commonIssues:[],careScheduleSummary:{needsWatering:[],needsFertilizing:[],healthConcerns:[]},environmentalFactors:{locations:["test"]}},conversationHistory:[]},{data:{session:r},error:n}=await this.supabase.auth.getSession();if(n||!r?.access_token)throw console.error("User session not available:",n),new Error("Usuario no autenticado. Por favor inicia sesión nuevamente.");const{data:i,error:a}=await this.supabase.functions.invoke("garden-ai-chat",{body:e,headers:{Authorization:`Bearer ${r.access_token}`}});return a?a.message.includes("404")||a.message.includes("not found")?{available:!1,error:"La función de chat de jardín no está disponible en este momento"}:{available:!1,error:a.message}:i&&typeof i.content=="string"?{available:!0}:{available:!1,error:"Function returned unexpected response format"}}catch(e){return{available:!1,error:e instanceof Error?e.message:"Error desconocido"}}}async getGardenHealthSummary(e){try{const r=this.cache.getGardenSummary(e);if(r)return r;const n=await this.buildGardenContext(e),i=n.plantsData.filter(o=>o.healthScore>=80).length,a=n.careScheduleSummary.needsWatering.length+n.careScheduleSummary.healthConcerns.length,s={totalPlants:n.totalPlants,averageHealth:n.averageHealthScore,urgentActions:a,healthyPlants:i};return this.cache.setGardenSummary(e,s),s}catch(r){throw console.error("Error getting garden health summary:",r),r}}async getSuggestedQuestions(e){try{const r=await this.buildGardenContext(e),n=[];return r.totalPlants===0?(n.push("¿Cómo agrego mi primera planta?"),n.push("¿Qué tipo de planta me recomiendas para empezar?"),n):(n.push("¿Cuántas plantas tengo y cómo están?"),n.push("¿Cuál es la salud promedio de mi jardín?"),r.careScheduleSummary.healthConcerns.length>0&&(n.push("¿Qué plantas necesitan atención especial?"),n.push("¿Qué problemas de salud hay en mi jardín?")),r.plantsData.some(i=>i.healthScore>=80)&&n.push("¿Cuáles de mis plantas están más sanas?"),r.environmentalFactors.locations.length>1&&n.push("¿Cómo afecta la ubicación a mis plantas?"),r.totalPlants>5&&n.push("¿Cómo organizar mejor mi espacio de plantas?"),r.plantsData.some(i=>"lastFertilized"in i&&!!i.lastFertilized)&&n.push("¿Cuándo debo fertilizar mis plantas?"),new Set(r.plantsData.map(i=>i.species)).size>1&&n.push("¿Qué especie de planta es la más resistente en mi jardín?"),n.slice(0,6))}catch(r){return console.error("Error getting suggested questions:",r),["¿Cuántas plantas tengo y cómo están?","¿Cuál es la salud promedio de mi jardín?"]}}async refreshGardenData(e){try{this.invalidateCache(e),await this.buildGardenContext(e),console.log("[GardenChatService] Garden data refreshed for user:",e)}catch(r){throw console.error("Error refreshing garden data:",r),r}}async buildGardenContext(e){try{const r=this.cache.getGardenContext(e);if(r)return r;const{data:n,error:i}=await this.supabase.from("plants").select(`
          id,
          name,
          nickname,
          species,
          location,
          plant_environment,
          light_requirements,
          health_score,
          last_watered,
          last_fertilized,
          care_profile,
          date_added
        `).eq("user_id",e).order("created_at",{ascending:!1});if(i)throw i;const a=n.map(v=>({id:v.id,name:v.name,nickname:v.nickname||void 0,species:v.species,location:v.location,plantEnvironment:v.plant_environment,lightRequirements:v.light_requirements,healthScore:v.health_score||85,lastWatered:v.last_watered?new Date(v.last_watered):void 0,wateringFrequency:v.care_profile?.wateringFrequency})),s=a.length,o=s>0?Math.round(a.reduce((v,b)=>v+b.healthScore,0)/s):0,c=new Date,l=[],u=[],h=[];a.forEach(v=>{if(v.lastWatered&&v.wateringFrequency){const b=new Date(v.lastWatered),g=new Date(b);g.setDate(b.getDate()+v.wateringFrequency),c>g&&l.push(v.id)}v.healthScore<70&&h.push(v.id)});const m=[...new Set(a.map(v=>v.location))],p={totalPlants:s,plantsData:a,averageHealthScore:o,commonIssues:[],careScheduleSummary:{needsWatering:l,needsFertilizing:u,healthConcerns:h},environmentalFactors:{locations:m,lightConditions:[],humidityNeeds:[]}};return this.cache.setGardenContext(e,p),p}catch(r){throw console.error("Error building garden context:",r),r}}invalidateCache(e){this.cache.invalidateCache(e),console.log("Cache invalidated for user:",e)}}const fa=new vee(Tt,Yo),bee=()=>{const{user:t}=Nn(),[e,r]=w.useState([]),[n,i]=w.useState(!1),[a,s]=w.useState(!1),[o,c]=w.useState(null),[l,u]=w.useState(null),[h,m]=w.useState([]),[p,v]=w.useState("");w.useEffect(()=>{t?.id&&b()},[t?.id]);const b=async()=>{if(t?.id){i(!0);try{const[D,I]=await Promise.all([fa.getGardenHealthSummary(t.id),fa.getSuggestedQuestions(t.id)]);if(u(D),m(I),e.length===0&&D.totalPlants>0){const A={id:`welcome-${Date.now()}`,sender:"ai",content:`¡Hola! Soy tu asistente de jardín 🌱 

Veo que tienes ${D.totalPlants} plantas en tu jardín con una salud promedio de ${D.averageHealth}%. ${D.urgentActions>0?`Hay ${D.urgentActions} acciones que podrían necesitar tu atención.`:"¡Todo parece estar en buen estado!"}

¿En qué puedo ayudarte hoy con tu jardín?`,timestamp:new Date,context:{queryType:"general"}};r([A])}}catch(D){console.error("Error loading initial garden data:",D),c("Error al cargar la información del jardín")}finally{i(!1)}}},g=w.useCallback(async D=>{if(!t?.id||!D.trim()||a)return;const I=await fa.verifyFunctionAvailability();if(!I.available){c(`🚧 El chat de jardín no está disponible: ${I.error}`);return}const A={id:`user-${Date.now()}`,sender:"user",content:D.trim(),timestamp:new Date};v(D.trim()),r(P=>[...P,A]),s(!0),c(null);try{const P=await fa.sendMessageToGardenAI(D.trim(),t.id,e),O={id:`ai-${Date.now()}`,sender:"ai",content:P.content,timestamp:new Date,context:{plantsAnalyzed:xee(P),queryType:wee(D),insights:P.insights||[],suggestedActions:P.suggestedActions||[]}};if(r(N=>[...N,O]),P.suggestedActions&&P.suggestedActions.length>0){const N=await fa.getGardenHealthSummary(t.id);u(N)}}catch(P){console.error("Error sending message to garden AI:",P);let O="Error al enviar el mensaje. Por favor intenta de nuevo.";P instanceof Error&&(P.message.includes("función de chat de jardín no está disponible")?O="🚧 El chat de jardín está temporalmente no disponible. Estamos trabajando para solucionarlo.":P.message.includes("CORS")?O="🔧 Error de configuración. Por favor contacta al administrador.":P.message.includes("garden-ai-chat no existe")&&(O="⚠️ Servicio no configurado. El chat de jardín necesita configuración adicional.")),c(O),r(N=>N.slice(0,-1))}finally{s(!1)}},[t?.id,e,a]),_=w.useCallback(async()=>{p&&await g(p)},[p,g]),T=w.useCallback(()=>{r([]),c(null),t?.id&&b()},[t?.id]),E=w.useCallback(async()=>{if(t?.id){i(!0);try{await fa.refreshGardenData(t.id),await b(),console.log("[useGardenChat] Garden data refreshed successfully")}catch(D){console.error("Error refreshing garden data:",D),c("Error al actualizar los datos del jardín")}finally{i(!1)}}},[t?.id]),j=w.useMemo(()=>n,[n]),R=w.useMemo(()=>{},[t?.id,l]);return{messages:e,isLoading:j,isTyping:a,error:o,gardenSummary:l,suggestedQuestions:h,sendMessage:g,clearMessages:T,retryLastMessage:_,refreshGardenData:E,cacheStats:R}};function xee(t){const e=[];return t.insights&&t.insights.forEach(r=>{r.affectedPlants&&e.push(...r.affectedPlants)}),t.suggestedActions&&t.suggestedActions.forEach(r=>{r.plantIds&&e.push(...r.plantIds)}),[...new Set(e)]}function wee(t){const e=t.toLowerCase();return e.includes("salud")||e.includes("problema")||e.includes("enferm")?"health_analysis":e.includes("comparar")||e.includes("diferencia")||e.includes("mejor")?"care_comparison":e.includes("hongo")||e.includes("plaga")||e.includes("prevenir")?"disease_prevention":e.includes("crecimiento")||e.includes("progreso")||e.includes("tiempo")?"growth_tracking":"general"}const _ee=({onClose:t})=>{const[e,r]=w.useState([{name:"garden-ai-chat",available:!1}]),[n,i]=w.useState(!1),a=async()=>{i(!0);const c=[],l=await fa.verifyFunctionAvailability();c.push({name:"garden-ai-chat",available:l.available,error:l.error,lastChecked:new Date}),r(c),i(!1)};w.useEffect(()=>{a()},[]);const s=c=>c.available?d.jsx(Si,{className:"w-5 h-5 text-green-500"}):d.jsx(Jr,{className:"w-5 h-5 text-red-500"}),o=c=>c.available?"Disponible":"No disponible";return d.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:d.jsx(L.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:c=>c.stopPropagation(),className:"w-full max-w-md",children:d.jsxs(Pr,{className:"p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(IE,{className:"w-6 h-6 text-blue-500"}),d.jsx("h3",{className:"text-lg font-semibold",children:"Diagnóstico del Sistema"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Estado de Funciones Edge"}),d.jsx("div",{className:"space-y-3",children:e.map(c=>d.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[s(c),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-sm",children:c.name}),d.jsx("p",{className:"text-xs text-muted-foreground",children:o(c)})]})]}),c.error&&d.jsxs("div",{className:"text-xs text-red-500 max-w-32 text-right",children:[c.error.substring(0,50),"..."]})]},c.name))})]}),e.some(c=>!c.available)&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(Jr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Servicios no disponibles"}),d.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 mt-1",children:"Algunos servicios del chat de jardín no están funcionando. Verifica que las funciones Edge estén desplegadas en Supabase."})]})]})}),d.jsxs("div",{className:"flex gap-3 pt-3",children:[d.jsxs(me,{onClick:a,disabled:n,variant:"outline",size:"sm",className:"flex-1 gap-2",children:[d.jsx(Oi,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Verificar Nuevamente"]}),d.jsx(me,{onClick:t,variant:"secondary",size:"sm",className:"flex-1",children:"Cerrar"})]})]})]})})})},Ff=({gardenSummary:t,onClearChat:e,onRefresh:r,isRefreshing:n=!1})=>{const i=sr(),[a,s]=w.useState(!1),o=l=>l>=80?"text-green-500":l>=60?"text-green-400":"text-red-500",c=l=>l>=80?"Excelente":l>=60?"Buena":"Necesita atención";return d.jsxs("header",{className:"sticky top-0 z-10 bg-background/80 backdrop-blur-sm border-b border-muted",children:[d.jsxs("div",{className:"flex items-center gap-3 p-4 pt-safe-top",children:[d.jsx("button",{onClick:()=>i(vt.toDashboard()),className:"p-2 -ml-2 rounded-full hover:bg-muted transition-colors","aria-label":"Volver al dashboard",children:d.jsx(Ip,{size:20})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-full",children:d.jsx(Sp,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-bold text-foreground tracking-[0.2px]",children:"Asistente de Jardín"}),t&&d.jsxs("div",{className:"flex items-center gap-2 text-xs text-neutral-600 dark:text-neutral-400",children:[d.jsxs("span",{className:"flex items-center gap-1",children:[d.jsx(bE,{size:12}),t.totalPlants," plantas"]}),d.jsx("span",{className:`font-medium ${o(t.averageHealth)} text-xs px-2 py-0.5 rounded-full`,style:{fontSize:"11px",padding:"2px 8px"},children:c(t.averageHealth)}),t.urgentActions>0&&d.jsxs(L.span,{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-0.5 rounded-full text-xs font-medium",style:{fontSize:"11px",padding:"2px 8px"},initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:[t.urgentActions," acciones"]})]})]})]})}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Diagnóstico del sistema",children:d.jsx(IE,{size:18})}),r&&d.jsx("button",{onClick:r,disabled:n,className:"p-2 rounded-full hover:bg-muted transition-colors disabled:opacity-50","aria-label":"Actualizar datos del jardín",children:d.jsx(L.div,{animate:n?{rotate:360}:{},transition:n?{duration:1,repeat:1/0,ease:"linear"}:{},children:d.jsx(Oi,{size:18})})}),d.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Opciones del chat",children:d.jsx(xE,{size:20})})]})]}),d.jsx(ke,{children:a&&d.jsx(_ee,{onClose:()=>s(!1)})})]})},Eee=({message:t})=>{const e=t.sender==="user",r=()=>{if(!t.context?.queryType)return d.jsx(Xo,{size:16});switch(t.context.queryType){case"health_analysis":return d.jsx(Tn,{size:16});case"care_comparison":return d.jsx(Hf,{size:16});case"disease_prevention":return d.jsx(MN,{size:16});case"growth_tracking":return d.jsx(EE,{size:16});default:return d.jsx(Xo,{size:16})}},n=()=>{if(e)return"text-primary-foreground/70";if(!t.context?.queryType)return"text-green-500";switch(t.context.queryType){case"health_analysis":return"text-red-500";case"care_comparison":return"text-blue-500";case"disease_prevention":return"text-orange-500";case"growth_tracking":return"text-purple-500";default:return"text-green-500"}};return d.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:Oe("flex items-end gap-2 max-w-[85%]",e?"justify-end ml-auto":"justify-start"),children:[!e&&d.jsx(L.div,{className:Oe("flex h-8 w-8 items-center justify-center rounded-full","bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900/30 dark:to-green-800/30"),initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx("div",{className:n(),children:r()})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:Oe("rounded-2xl px-4 py-3 break-words shadow-adaptive",e?"rounded-br-lg bg-primary-700 text-white drop-shadow-sm ml-8":"rounded-bl-lg bg-contrast-surface text-contrast-medium mr-8 border border-contrast","rounded-[12px]"),children:[d.jsx("div",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:t.content}),t.context?.insights&&t.context.insights.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-green-700 dark:text-green-300",children:"Recomendaciones y observaciones:"}),d.jsx("ul",{className:"space-y-1",children:t.context.insights.map((i,a)=>d.jsxs("li",{className:"text-xs bg-green-50 dark:bg-green-900/20 rounded-lg p-2 border border-green-200 dark:border-green-800",children:[d.jsxs("div",{className:"font-medium",children:[i.type==="warning"&&"⚠️ ",i.type==="tip"&&"💡 ",i.type==="recommendation"&&"🌱 ",i.type==="observation"&&"🔎 ",i.title]}),d.jsx("div",{children:i.description}),i.affectedPlants&&i.affectedPlants.length>0&&d.jsxs("div",{className:"mt-1 text-[11px] text-green-800 dark:text-green-200",children:["Plantas: ",i.affectedPlants.join(", ")]})]},a))})]}),t.context?.suggestedActions&&t.context.suggestedActions.length>0&&d.jsxs("div",{className:"mt-3 space-y-2",children:[d.jsx("div",{className:"font-semibold text-xs text-blue-700 dark:text-blue-300",children:"Acciones sugeridas:"}),d.jsx("ul",{className:"space-y-1",children:t.context.suggestedActions.map((i,a)=>d.jsxs("li",{className:"text-xs bg-blue-50 dark:bg-blue-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-800",children:[d.jsx("div",{className:"font-medium",children:i.action}),i.priority&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Prioridad: ",i.priority]}),i.plantIds&&i.plantIds.length>0&&d.jsxs("div",{className:"text-[11px] text-blue-800 dark:text-blue-200",children:["Plantas: ",i.plantIds.join(", ")]})]},a))})]}),!e&&t.context?.plantsAnalyzed&&t.context.plantsAnalyzed.length>0&&d.jsxs(L.div,{className:"mt-2 flex items-center gap-1 text-xs opacity-70",initial:{opacity:0},animate:{opacity:.7},transition:{delay:.5},children:[d.jsx(Hf,{size:12}),d.jsxs("span",{children:["Analizó ",t.context.plantsAnalyzed.length," planta(s)"]})]}),d.jsx("div",{className:Oe("mt-2 text-xs",e?"text-primary-foreground/70":"text-muted-foreground/70","text-[#888] text-[12px]"),children:tI(new Date(t.timestamp),{addSuffix:!0,locale:jk})})]})}),e&&d.jsx(L.div,{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10",initial:{scale:0},animate:{scale:1},transition:{delay:.1},children:d.jsx(DN,{size:16,className:"text-primary"})})]})},Tee=({onSendMessage:t,isTyping:e,suggestedQuestions:r,isLoading:n=!1})=>{const[i,a]=w.useState(""),[s,o]=w.useState(!0),c=w.useRef(null),l=async()=>{if(e)return;const p=c.current?.value.trim();p&&(o(!1),c.current&&(c.current.value=""),await t(p))},u=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),l())},h=async p=>{a(""),o(!1),await t(p)},m=()=>{r.length>0&&!i&&o(!0)};return d.jsx("footer",{className:"sticky bottom-0 z-10 bg-background/80 backdrop-blur-sm border-t border-border",children:d.jsxs("div",{className:"p-4 pb-safe-bottom space-y-3",children:[d.jsx(ke,{children:s&&r.length>0&&!n&&d.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-2 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[d.jsx(er,{size:12}),d.jsx("span",{children:"Preguntas sugeridas"})]}),d.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:r.slice(0,4).map((p,v)=>d.jsx(L.button,{onClick:()=>h(p),disabled:e,className:"px-3 py-1.5 text-xs bg-muted hover:bg-[#F0F0F0] active:bg-[#F0F0F0] rounded-full border border-border/50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:v*.1},whileHover:{scale:1.02},whileTap:{scale:.98},children:p},p))})]})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Yd,{type:"text",ref:c,onKeyDown:u,onFocus:m,placeholder:"Pregúntame sobre tu jardín...",className:"pr-12",disabled:e||n}),d.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-muted-foreground",children:d.jsx(TE,{size:16})})]}),d.jsx(me,{"aria-label":"Enviar mensaje",onClick:l,disabled:!i.trim()||e||n,size:"icon",className:"shrink-0",children:e?d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:20})}):d.jsx(AE,{size:20})})]}),n&&d.jsxs(L.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[d.jsx(L.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:d.jsx(er,{size:12})}),d.jsx("span",{children:"Analizando tu jardín..."})]})]})})},Aee={plants:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[d.jsx(L.path,{d:"M60 120 L140 120 L130 100 L70 100 Z",fill:"currentColor",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.2,duration:.5}}),d.jsx(L.g,{initial:{scale:0,rotate:-10},animate:{scale:1,rotate:0},transition:{delay:.5,duration:.8,type:"spring"},children:d.jsx("path",{d:"M80 100 Q85 80 90 85 Q95 75 85 70 Q75 75 80 100",fill:"currentColor",opacity:"0.8"})}),d.jsx(L.g,{initial:{scale:0,rotate:10},animate:{scale:1,rotate:0},transition:{delay:.7,duration:.8,type:"spring"},children:d.jsx("path",{d:"M100 100 Q105 85 110 90 Q115 80 105 75 Q95 80 100 100",fill:"currentColor",opacity:"0.7"})}),d.jsx(L.g,{initial:{scale:0,rotate:-5},animate:{scale:1,rotate:0},transition:{delay:.9,duration:.8,type:"spring"},children:d.jsx("path",{d:"M120 100 Q125 90 130 95 Q135 85 125 80 Q115 85 120 100",fill:"currentColor",opacity:"0.6"})})]})}),search:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.circle,{cx:"80",cy:"70",r:"25",stroke:"currentColor",strokeWidth:"3",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"}}),d.jsx(L.line,{x1:"100",y1:"88",x2:"120",y2:"108",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",initial:{scaleX:0},animate:{scaleX:1},transition:{delay:.6,duration:.4}}),d.jsx(L.circle,{cx:"140",cy:"50",r:"2",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}}),d.jsx(L.circle,{cx:"150",cy:"40",r:"3",fill:"currentColor",initial:{scale:0},animate:{scale:1},transition:{delay:1.2,duration:.3}})]})}),chat:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"50",y:"40",width:"100",height:"60",rx:"20",fill:"currentColor",opacity:"0.8",initial:{scale:0,y:20},animate:{scale:1,y:0},transition:{delay:.2,duration:.6,type:"spring"}}),d.jsx(L.path,{d:"M80 100 L70 115 L95 105 Z",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.5,duration:.4}}),d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.5},children:[d.jsx("circle",{cx:"75",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"100",cy:"70",r:"3",fill:"white"}),d.jsx("circle",{cx:"125",cy:"70",r:"3",fill:"white"})]})]})}),camera:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsx(L.rect,{x:"60",y:"60",width:"80",height:"50",rx:"8",fill:"currentColor",opacity:"0.8",initial:{scale:0},animate:{scale:1},transition:{delay:.2,duration:.5,type:"spring"}}),d.jsx(L.rect,{x:"85",y:"45",width:"30",height:"15",rx:"4",fill:"currentColor",opacity:"0.6",initial:{scaleY:0},animate:{scaleY:1},transition:{delay:.4,duration:.3}}),d.jsx(L.circle,{cx:"100",cy:"85",r:"15",stroke:"white",strokeWidth:"2",fill:"none",initial:{scale:0},animate:{scale:1},transition:{delay:.6,duration:.4,type:"spring"}}),d.jsx(L.circle,{cx:"120",cy:"70",r:"3",fill:"currentColor",opacity:"0.9",initial:{scale:0},animate:{scale:[0,1.2,1]},transition:{delay:.8,duration:.5}})]})}),settings:d.jsx("svg",{viewBox:"0 0 200 150",className:"w-32 h-24 text-primary-300 dark:text-primary-600",children:d.jsxs(L.g,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8},children:[d.jsxs(L.g,{animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},style:{originX:"100px",originY:"75px"},children:[d.jsx("path",{d:"M100 50 L110 60 L120 50 L120 60 L130 70 L120 80 L120 90 L110 90 L100 100 L90 90 L80 90 L80 80 L70 70 L80 60 L80 50 Z",fill:"currentColor",opacity:"0.7"}),d.jsx("circle",{cx:"100",cy:"75",r:"8",fill:"white"})]}),d.jsxs(L.g,{animate:{rotate:-360},transition:{duration:15,repeat:1/0,ease:"linear"},style:{originX:"140px",originY:"95px"},children:[d.jsx("path",{d:"M140 85 L145 90 L150 85 L150 90 L155 95 L150 100 L150 105 L145 105 L140 110 L135 105 L130 105 L130 100 L125 95 L130 90 L130 85 Z",fill:"currentColor",opacity:"0.5"}),d.jsx("circle",{cx:"140",cy:"95",r:"5",fill:"white"})]})]})})},Iee=({icon:t,title:e,description:r,action:n,illustration:i="plants",className:a})=>d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:Oe("flex flex-col items-center justify-center text-center py-12 px-6 max-w-md mx-auto",a),children:[d.jsx(L.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5,ease:"easeOut"},className:"mb-6",children:t||Aee[i]}),d.jsx(L.h3,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},className:"text-xl font-semibold text-neutral-900 dark:text-neutral-100 mb-3",children:e}),d.jsx(L.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},className:"text-neutral-600 dark:text-neutral-400 mb-6 leading-relaxed",children:r}),n&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:d.jsx(me,{onClick:n.onClick,variant:"primary",size:"lg",className:"animate-glow",children:n.label})})]}),See=()=>{const t=sr(),e=Kn(p=>p.plants),{messages:r,isLoading:n,isTyping:i,error:a,gardenSummary:s,suggestedQuestions:o,sendMessage:c,clearMessages:l,retryLastMessage:u,refreshGardenData:h}=bee(),m=w.useRef(null);return w.useEffect(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r,i]),a&&!s?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Ff,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:d.jsxs(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center max-w-md",children:[d.jsx(Jr,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error de conexión"}),d.jsx("p",{className:"text-muted-foreground mb-4",children:a}),d.jsxs(me,{onClick:h,variant:"primary",children:[d.jsx(Oi,{className:"w-4 h-4 mr-2"}),"Reintentar"]})]})})]}):s?.totalPlants===0?d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Ff,{gardenSummary:s}),d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsx(Iee,{illustration:"plants",title:"Tu jardín está vacío",description:"Agrega algunas plantas a tu jardín para poder chatear conmigo sobre su cuidado y salud.",action:{label:"Agregar mi primera planta",onClick:()=>t(vt.toCamera())}})})]}):d.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[d.jsx(Ff,{gardenSummary:s,onClearChat:l,onRefresh:h,isRefreshing:n&&r.length>0}),r.length===0&&e.length>0&&d.jsxs("div",{className:"p-4 border-b border-neutral-200 dark:border-neutral-700",children:[d.jsx("h3",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-3",children:"Chats individuales con tus plantas:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.slice(0,4).map(p=>d.jsx(Pr,{variant:"glass",size:"sm",interactive:!0,className:"cursor-pointer hover:border-primary-300 dark:hover:border-primary-600",onClick:()=>t(vt.toPlantChat(p.id)),children:d.jsx(ti,{className:"p-3",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:d.jsx(Sp,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium truncate",children:p.nickname||p.name}),d.jsx("p",{className:"text-xs text-neutral-500 truncate",children:p.species})]}),d.jsx(Tc,{className:"w-4 h-4 text-neutral-400"})]})})},p.id)),e.length>4&&d.jsx(Pr,{variant:"outline",size:"sm",interactive:!0,className:"cursor-pointer",onClick:()=>t(vt.toDashboard()),children:d.jsx(ti,{className:"p-3 flex items-center justify-center",children:d.jsxs("span",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["+",e.length-4," más"]})})})]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingBottom:"calc(88px + env(safe-area-inset-bottom))"},children:[d.jsxs("div",{className:"p-4 space-y-4 max-w-4xl mx-auto",children:[d.jsx(ke,{children:r.map(p=>d.jsx(Eee,{message:p},p.id))}),i&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:d.jsx(Ok,{})}),a&&r.length>0&&d.jsx(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-center justify-center",children:d.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 max-w-sm",children:[d.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300 text-sm",children:[d.jsx(Jr,{size:16}),d.jsx("span",{children:a})]}),d.jsxs(me,{onClick:u,size:"sm",variant:"outline",className:"mt-2 w-full",children:[d.jsx(Oi,{size:14,className:"mr-1"}),"Reintentar"]})]})}),d.jsx("div",{ref:m})]}),!1]}),d.jsx(Tee,{onSendMessage:c,isTyping:i,suggestedQuestions:o,isLoading:n})]})},Pee=w.lazy(()=>_p(()=>import("./Settings-M4dtofQD.js"),__vite__mapDeps([0,1,2,3,4,5]))),Cee=w.lazy(()=>_p(()=>import("./Auth-D_VIKI1B.js"),__vite__mapDeps([6,1,2,4,5,3]))),kee=new oE({defaultOptions:{queries:{staleTime:vi.QUERY.STALE_TIME.MEDIUM,gcTime:vi.QUERY.GC_TIME.MEDIUM,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:vi.QUERY.RETRY.COUNT,retryDelay:t=>Math.min(vi.QUERY.RETRY.DELAY*2**t,3e4)},mutations:{retry:vi.QUERY.RETRY.COUNT,retryDelay:vi.QUERY.RETRY.DELAY}}}),Q_=({message:t})=>d.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background text-foreground",children:[d.jsx(gd,{className:"w-12 h-12 text-green-500 animate-bounce mb-4"}),d.jsx("p",{className:"text-lg text-muted-foreground",children:t})]}),Nee=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"/":window.location.pathname.startsWith("/plantitas-app")?"/plantitas-app/":"/",jee=()=>{const t=U4();if(w$(),w.useEffect(()=>{console.log("[APP] useEffect running...");try{const r=_$();return()=>{console.log("[APP] Cleanup running..."),r()}}catch(r){throw _g("APP_INITIALIZATION",r),r}},[]),!t.initialized){const r=t.loading?t.progress.message:t.error||"Inicializando...";return d.jsx(Q_,{message:r})}const e=()=>d.jsx(e0,{children:d.jsxs(on,{path:"/",element:d.jsx(U6,{}),children:[d.jsx(on,{index:!0,element:d.jsx(dz,{})}),d.jsx(on,{path:"camera",element:d.jsx(jJ,{})}),d.jsx(on,{path:"settings",element:d.jsx(Pee,{})}),d.jsx(on,{path:"garden-chat",element:d.jsx(See,{})}),d.jsx(on,{path:"plant/:plantId",element:d.jsx(SJ,{})}),d.jsx(on,{path:"plant/:plantId/chat",element:d.jsx(yee,{})}),d.jsx(on,{path:"*",element:d.jsx(Jh,{to:Et.dashboard,replace:!0})})]})});return d.jsx(cE,{client:kee,children:d.jsx(b$,{children:d.jsx(B6,{children:d.jsxs(pN,{basename:Nee(),future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[d.jsx(p$,{position:"top-center",richColors:!0}),d.jsx(A$,{}),d.jsx(w.Suspense,{fallback:d.jsx(Q_,{message:"Cargando..."}),children:d.jsxs(e0,{children:[d.jsx(on,{path:Et.auth,element:t.user?d.jsx(Jh,{to:Et.dashboard,replace:!0}):d.jsx(Cee,{})}),d.jsx(on,{path:"/*",element:t.user?d.jsx(e,{}):d.jsx(Jh,{to:Et.auth,replace:!0})})]})})]})})})})},Oee=w.createContext(void 0),Ree=({children:t,defaultTheme:e="system",storageKey:r="vite-ui-theme"})=>{const[n,i]=w.useState(()=>localStorage.getItem(r)||e),a=w.useMemo(()=>n==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":n,[n]);w.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(a),localStorage.setItem(r,n)},[a,n,r]);const s={theme:n,setTheme:i,resolvedTheme:a};return d.jsx(Oee.Provider,{value:s,children:t})};var xp,Rk=-1,Yc=function(t){addEventListener("pageshow",function(e){e.persisted&&(Rk=e.timeStamp,t(e))},!0)},Dk=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},dv=function(){var t=Dk();return t&&t.activationStart||0},Bi=function(t,e){var r=Dk(),n="navigate";return Rk>=0?n="back-forward-cache":r&&(document.prerendering||dv()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:t,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},Zc=function(t,e,r){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver(function(i){Promise.resolve().then(function(){e(i.getEntries())})});return n.observe(Object.assign({type:t,buffered:!0},r||{})),n}}catch{}},qi=function(t,e,r,n){var i,a;return function(s){e.value>=0&&(s||n)&&((a=e.value-(i||0))||i===void 0)&&(i=e.value,e.delta=a,e.rating=function(o,c){return o>c[1]?"poor":o>c[0]?"needs-improvement":"good"}(e.value,r),t(e))}},hv=function(t){requestAnimationFrame(function(){return requestAnimationFrame(function(){return t()})})},fv=function(t){var e=function(r){r.type!=="pagehide"&&document.visibilityState!=="hidden"||t(r)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},Mk=function(t){var e=!1;return function(r){e||(t(r),e=!0)}},ws=-1,X_=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},md=function(t){document.visibilityState==="hidden"&&ws>-1&&(ws=t.type==="visibilitychange"?t.timeStamp:0,Dee())},J_=function(){addEventListener("visibilitychange",md,!0),addEventListener("prerenderingchange",md,!0)},Dee=function(){removeEventListener("visibilitychange",md,!0),removeEventListener("prerenderingchange",md,!0)},Lk=function(){return ws<0&&(ws=X_(),J_(),Yc(function(){setTimeout(function(){ws=X_(),J_()},0)})),{get firstHiddenTime(){return ws}}},mv=function(t){document.prerendering?addEventListener("prerenderingchange",function(){return t()},!0):t()},eE=[1800,3e3],Mee=function(t,e){e=e||{},mv(function(){var r,n=Lk(),i=Bi("FCP"),a=Zc("paint",function(s){s.forEach(function(o){o.name==="first-contentful-paint"&&(a.disconnect(),o.startTime<n.firstHiddenTime&&(i.value=Math.max(o.startTime-dv(),0),i.entries.push(o),r(!0)))})});a&&(r=qi(t,i,eE,e.reportAllChanges),Yc(function(s){i=Bi("FCP"),r=qi(t,i,eE,e.reportAllChanges),hv(function(){i.value=performance.now()-s.timeStamp,r(!0)})}))})},tE=[.1,.25],Lee=function(t,e){e=e||{},Mee(Mk(function(){var r,n=Bi("CLS",0),i=0,a=[],s=function(c){c.forEach(function(l){if(!l.hadRecentInput){var u=a[0],h=a[a.length-1];i&&l.startTime-h.startTime<1e3&&l.startTime-u.startTime<5e3?(i+=l.value,a.push(l)):(i=l.value,a=[l])}}),i>n.value&&(n.value=i,n.entries=a,r())},o=Zc("layout-shift",s);o&&(r=qi(t,n,tE,e.reportAllChanges),fv(function(){s(o.takeRecords()),r(!0)}),Yc(function(){i=0,n=Bi("CLS",0),r=qi(t,n,tE,e.reportAllChanges),hv(function(){return r()})}),setTimeout(r,0))}))},$k=0,zf=1/0,Kl=0,$ee=function(t){t.forEach(function(e){e.interactionId&&(zf=Math.min(zf,e.interactionId),Kl=Math.max(Kl,e.interactionId),$k=Kl?(Kl-zf)/7+1:0)})},Vk=function(){return xp?$k:performance.interactionCount||0},Vee=function(){"interactionCount"in performance||xp||(xp=Zc("event",$ee,{type:"event",buffered:!0,durationThreshold:0}))},rE=[200,500],Fk=0,nE=function(){return Vk()-Fk},un=[],Uf={},iE=function(t){var e=un[un.length-1],r=Uf[t.interactionId];if(r||un.length<10||t.duration>e.latency){if(r)r.entries.push(t),r.latency=Math.max(r.latency,t.duration);else{var n={id:t.interactionId,latency:t.duration,entries:[t]};Uf[n.id]=n,un.push(n)}un.sort(function(i,a){return a.latency-i.latency}),un.splice(10).forEach(function(i){delete Uf[i.id]})}},Fee=function(t,e){e=e||{},mv(function(){var r;Vee();var n,i=Bi("INP"),a=function(o){o.forEach(function(u){u.interactionId&&iE(u),u.entryType==="first-input"&&!un.some(function(h){return h.entries.some(function(m){return u.duration===m.duration&&u.startTime===m.startTime})})&&iE(u)});var c,l=(c=Math.min(un.length-1,Math.floor(nE()/50)),un[c]);l&&l.latency!==i.value&&(i.value=l.latency,i.entries=l.entries,n())},s=Zc("event",a,{durationThreshold:(r=e.durationThreshold)!==null&&r!==void 0?r:40});n=qi(t,i,rE,e.reportAllChanges),s&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&s.observe({type:"first-input",buffered:!0}),fv(function(){a(s.takeRecords()),i.value<0&&nE()>0&&(i.value=0,i.entries=[]),n(!0)}),Yc(function(){un=[],Fk=Vk(),i=Bi("INP"),n=qi(t,i,rE,e.reportAllChanges)}))})},aE=[2500,4e3],Bf={},zee=function(t,e){e=e||{},mv(function(){var r,n=Lk(),i=Bi("LCP"),a=function(c){var l=c[c.length-1];l&&l.startTime<n.firstHiddenTime&&(i.value=Math.max(l.startTime-dv(),0),i.entries=[l],r())},s=Zc("largest-contentful-paint",a);if(s){r=qi(t,i,aE,e.reportAllChanges);var o=Mk(function(){Bf[i.id]||(a(s.takeRecords()),s.disconnect(),Bf[i.id]=!0,r(!0))});["keydown","click"].forEach(function(c){addEventListener(c,function(){return setTimeout(o,0)},!0)}),fv(o),Yc(function(c){i=Bi("LCP"),r=qi(t,i,aE,e.reportAllChanges),hv(function(){i.value=performance.now()-c.timeStamp,Bf[i.id]=!0,r(!0)})})}})};class Uee{constructor(){yr(this,"endpoint");this.endpoint=null}send(e,r){const n={event:e,payload:r,app:"plantitas-app",env:"production"};if("navigator"in window&&"sendBeacon"in navigator&&this.endpoint)try{const i=new Blob([JSON.stringify(n)],{type:"application/json"});navigator.sendBeacon(this.endpoint,i);return}catch{}this.endpoint&&fetch(this.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},keepalive:!0,body:JSON.stringify(n)}).catch(()=>{})}}const Bee=new Uee;function qf(t){const e={name:t.name,value:t.value,rating:t.rating,id:t.id,navigationType:performance.getEntriesByType("navigation")?.[0]?.type,url:location.href,ts:Date.now()};Bee.send("web-vitals",e)}function qee(){try{zee(qf,{reportAllChanges:!0}),Lee(qf,{reportAllChanges:!0}),Fee(qf,{reportAllChanges:!0})}catch{}}console.log("[MOBILE] 🚨 Main.tsx loading started");console.log("[MOBILE] Location:",window.location.href);console.log("[MOBILE] Pathname:",window.location.pathname);console.log("[MOBILE] User Agent:",navigator.userAgent);window.addEventListener("error",t=>{console.error("[GLOBAL] Uncaught error:",t.error),console.error("[GLOBAL] Error details:",{message:t.message,filename:t.filename,lineno:t.lineno,colno:t.colno,stack:t.error?.stack})});window.addEventListener("unhandledrejection",t=>{console.error("[GLOBAL] Unhandled promise rejection:",t.reason),console.error("[GLOBAL] Promise:",t.promise)});try{I$(),console.log("[MOBILE] Debug system initialized")}catch(t){console.error("[MOBILE] Debug system failed:",t)}const zk=new oE;function Hee(){const{user:t}=Nn();return q.useEffect(()=>{t?.id&&zk.prefetchQuery({queryKey:["plants",t.id],queryFn:()=>vs.getUserPlantSummaries(t.id),staleTime:1e3*60*5})},[t?.id]),null}console.log("[MOBILE] Looking for root container...");const Uk=document.getElementById("root");if(!Uk)throw _g("ROOT_CONTAINER","Root container not found"),new Error("Root container not found");console.log("[MOBILE] Root container found, creating React root...");try{const t=Wf.createRoot(Uk);console.log("[MOBILE] React root created, rendering App..."),t.render(d.jsx(q.StrictMode,{children:d.jsx(Ree,{children:d.jsxs(cE,{client:zk,children:[d.jsx(Hee,{}),d.jsx(jee,{})]})})})),console.log("[MOBILE] App render called successfully")}catch(t){throw _g("REACT_RENDER",t),t}"performance"in window&&qee();export{me as B,Nn as a,q6 as b,Oe as c,M6 as g,z6 as u};
